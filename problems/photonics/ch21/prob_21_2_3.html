<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="light dark" />
  <meta name="theme-color" content="#0b1020" />
  <title>Cascaded Phase Modulators (KDP): Half-Wave Voltage and 9-Plate Composite</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#121a33;
      --text:#eaf0ff;
      --muted:#b8c4ff;
      --line:rgba(255,255,255,.14);
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --radius2: 22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8ff;
        --card:#ffffff;
        --text:#0b1226;
        --muted:#3a4a78;
        --line:rgba(10,20,40,.14);
        --shadow: 0 10px 25px rgba(14, 28, 64, .12);
      }
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family: var(--sans);
      background: radial-gradient(1200px 700px at 15% 10%, rgba(125,211,252,.18), transparent 60%),
                  radial-gradient(900px 600px at 80% 0%, rgba(167,139,250,.18), transparent 55%),
                  var(--bg);
      color: var(--text);
      line-height: 1.55;
    }
    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 28px 18px 80px;
      display: grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items: start;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns: 1fr}
    }

    header.hero{
      grid-column: 1 / -1;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 22px 20px;
      position: relative;
      overflow: hidden;
    }
    header.hero::after{
      content:"";
      position:absolute;
      inset:-80px -120px auto auto;
      width: 360px;
      height: 360px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, rgba(125,211,252,.35), transparent 60%);
      filter: blur(2px);
      transform: rotate(18deg);
      pointer-events:none;
      opacity:.9;
    }
    .kicker{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      color: var(--muted);
      font-size: 13px;
      letter-spacing: .2px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border: 1px solid var(--line);
      border-radius: 999px;
      background: rgba(255,255,255,.04);
      backdrop-filter: blur(6px);
    }
    .hero h1{
      margin: 10px 0 6px;
      font-size: clamp(22px, 3.2vw, 34px);
      letter-spacing: -0.4px;
      line-height: 1.16;
    }
    .hero p{
      margin: 0;
      color: var(--muted);
      max-width: 90ch;
    }

    nav.toc{
      position: sticky;
      top: 14px;
      align-self: start;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 10px;
    }
    @media (max-width: 980px){
      nav.toc{position: relative; top: 0}
    }
    .toc h2{
      font-size: 14px;
      margin: 0 0 10px;
      color: var(--muted);
      letter-spacing:.3px;
      text-transform: uppercase;
    }
    .toc a{
      display:block;
      padding: 8px 10px;
      margin: 2px 0;
      text-decoration:none;
      border-radius: 12px;
      border: 1px solid transparent;
      color: var(--text);
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .toc a:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.25);
      transform: translateX(2px);
    }
    .toc .small{
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed var(--line);
      font-size: 12.5px;
      color: var(--muted);
    }
    .toc .small a{
      display:inline-block;
      padding: 6px 10px;
      margin: 6px 0 0;
      background: rgba(255,255,255,.04);
      border: 1px solid var(--line);
      border-radius: 999px;
    }

    main{
      background: transparent;
      display:flex;
      flex-direction: column;
      gap: 14px;
    }

    section.card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 18px 18px;
      overflow: hidden;
    }
    section.card h2{
      margin: 0 0 10px;
      font-size: 18px;
      letter-spacing: -.2px;
    }
    section.card h3{
      margin: 14px 0 8px;
      font-size: 15.5px;
      letter-spacing: -.1px;
    }
    .muted{color: var(--muted)}
    .grid2{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 14px;
      align-items: start;
    }
    @media (max-width: 980px){
      .grid2{grid-template-columns: 1fr}
    }
    ul{
      margin: 8px 0 0 18px;
      padding: 0;
    }
    li{margin: 6px 0}
    .eq{
      font-family: var(--mono);
      font-size: 13.5px;
      line-height: 1.45;
      background: rgba(0,0,0,.18);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px 12px;
      overflow:auto;
    }
    @media (prefers-color-scheme: light){
      .eq{background: rgba(10,20,40,.04)}
    }
    .eqrow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .copybtn{
      appearance:none;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: var(--text);
      border-radius: 12px;
      padding: 8px 10px;
      font-size: 12.5px;
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      user-select:none;
    }
    .copybtn:hover{
      transform: translateY(-1px);
      border-color: rgba(125,211,252,.35);
      background: rgba(125,211,252,.10);
    }
    .copybtn:active{transform: translateY(0px) scale(.99)}
    .toast{
      position: fixed;
      right: 14px;
      bottom: 14px;
      background: rgba(0,0,0,.65);
      color: #fff;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.16);
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      font-size: 13px;
      opacity: 0;
      transform: translateY(8px);
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      z-index: 50;
      max-width: min(360px, calc(100vw - 28px));
    }
    .toast.show{opacity: 1; transform: translateY(0)}
    .callouts{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 12px;
    }
    @media (max-width: 980px){
      .callouts{grid-template-columns: 1fr}
    }
    .box{
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 12px 12px;
      background: rgba(255,255,255,.03);
      position: relative;
      overflow:hidden;
    }
    .box::before{
      content:"";
      position:absolute;
      left:0; top:0; bottom:0;
      width: 4px;
      background: rgba(125,211,252,.7);
    }
    .box h4{
      margin:0 0 6px;
      font-size: 13.5px;
      letter-spacing: .2px;
      text-transform: uppercase;
      color: var(--muted);
    }
    .box ul{margin-left: 18px}
    .box.warn::before{background: rgba(251,191,36,.9)}
    .box.good::before{background: rgba(52,211,153,.9)}
    .box.bad::before{background: rgba(251,113,133,.9)}
    details{
      border: 1px dashed var(--line);
      border-radius: 18px;
      padding: 10px 12px;
      background: rgba(255,255,255,.02);
      margin-top: 10px;
    }
    summary{
      cursor:pointer;
      color: var(--muted);
      font-weight: 600;
      list-style: none;
    }
    summary::-webkit-details-marker{display:none}
    summary::before{
      content:"▸";
      margin-right: 8px;
      display:inline-block;
      transform: translateY(-1px);
      transition: transform .18s ease;
      color: var(--accent);
      font-weight: 900;
    }
    details[open] summary::before{transform: rotate(90deg) translateX(1px)}
    details .content{margin-top: 10px}
    figure{
      margin: 12px 0 0;
      border: 1px solid var(--line);
      border-radius: 18px;
      background: rgba(255,255,255,.03);
      overflow:hidden;
    }
    figure figcaption{
      padding: 10px 12px 12px;
      color: var(--muted);
      font-size: 13px;
      border-top: 1px solid var(--line);
    }
    canvas{display:block; width: 100%; height: 320px;}
    @media (max-width: 520px){
      canvas{height: 260px;}
    }
    .final{
      border: 1px solid rgba(52,211,153,.35);
      background: linear-gradient(180deg, rgba(52,211,153,.10), rgba(255,255,255,.02));
    }
    .final::before{background: rgba(52,211,153,.9)}
    footer{
      grid-column: 1 / -1;
      margin-top: 8px;
      color: var(--muted);
      font-size: 12.5px;
      text-align: center;
    }
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 999px;
      padding: 8px 12px;
      color: var(--text);
      margin-top: 12px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .backtop:hover{
      transform: translateY(-1px);
      border-color: rgba(167,139,250,.35);
      background: rgba(167,139,250,.10);
    }
    @media print{
      body{background: #fff; color:#000}
      .wrap{max-width: none; grid-template-columns: 1fr; padding: 0}
      nav.toc{display:none}
      header.hero, section.card{
        box-shadow:none;
        background:#fff;
        border:1px solid #bbb;
      }
      .copybtn, .toast, .backtop{display:none !important}
      .eq{border:1px solid #999; background:#fff}
      figure{break-inside: avoid}
      section{break-inside: avoid}
      h2, h3{break-after: avoid}
    }
    @keyframes riseIn{from{opacity:0; transform: translateY(8px)} to{opacity:1; transform: translateY(0)}}
    .hero, .toc, section.card{animation: riseIn .28s ease both}
  </style>
</head>

<body id="top">
  <div class="wrap">
    <header class="hero" role="banner">
      <div class="kicker">
        <span class="pill">Electro-optic (Pockels) effect</span>
        <span class="pill">KDP (42m) longitudinal phase modulator</span>
        <span class="pill">Cascaded plates: coherent addition</span>
      </div>
      <h1>Cascaded Phase Modulators (KDP): Half-Wave Voltage and 9-Crystal Composite</h1>
      <p>
        We compute the <span class="muted">half-wave voltage</span> <span class="muted">Vπ</span> for a longitudinal KDP phase modulator at λ₀ = 633 nm,
        then design a 9-plate cascaded modulator so the phase shifts add instead of cancel.
      </p>
    </header>

    <nav class="toc" aria-label="Table of contents">
      <h2>Contents</h2>
      <a href="#quick">Quick Summary</a>
      <a href="#primer">PART 0 — Concept Primer</a>
      <a href="#analysis">PART 1 — Problem Analysis</a>
      <a href="#strategy">PART 2 — Strategy &amp; Tips</a>
      <a href="#solution">PART 3 — Full Solution</a>
      <a href="#deeper">PART 4 — Deeper Understanding</a>
      <a href="#plotguide">PART 5 — Optional Plot Guide</a>
      <div class="small">
        <div><span class="muted">Tools:</span> copy buttons for equations and final answers.</div>
        <a href="#top" title="Back to the top">Back to top</a>
      </div>
    </nav>

    <main role="main">
      <section class="card" id="quick">
        <h2>Quick Summary</h2>
        <div class="grid2">
          <div>
            <ul>
              <li><strong>What this is about:</strong> finding the voltage required for a <em>π radians</em> phase retardation (half-wave) in a KDP electro-optic phase modulator, and how cascading crystals reduces that voltage.</li>
              <li><strong>Key idea:</strong> the <em>Pockels effect</em> changes refractive indices linearly with the applied electric field, creating voltage-controlled birefringence.</li>
              <li><strong>Governing relation (small-signal):</strong> Δn ≈ −(1/2) n³ r E (valid when |Δn| ≪ n).</li>
              <li><strong>Longitudinal geometry:</strong> wave propagates along optic axis; field is also along optic axis; for KDP (42m) the relevant coefficient is r₆₃ with two modes experiencing ±r₆₃.</li>
              <li><strong>Phase retardation:</strong> Γ = (2π/λ) Δn·L; half-wave means Γ = π.</li>
              <li><strong>Part (a) result (numeric):</strong> Vπ = λ₀ / (2 n₀³ r₆₃) ≈ <strong>8.41 kV</strong> at 633 nm (with n₀ = 1.507, r₆₃ = 11 pm/V).</li>
              <li><strong>Part (b) design rule:</strong> because the electrode bias makes the field alternate direction plate-to-plate, rotate every other crystal by 90° about the propagation axis so each plate’s contribution has the <em>same sign</em>.</li>
              <li><strong>Composite half-wave voltage:</strong> if N plates add coherently, Γ_total = N Γ_single ⇒ Vπ,composite = Vπ,single / N.</li>
              <li><strong>Part (b) numeric:</strong> for N = 9, Vπ,composite ≈ 8.41 kV / 9 ≈ <strong>0.934 kV</strong> (≈ 934 V).</li>
            </ul>
          </div>
          <div class="callouts">
            <div class="box good">
              <h4>Key equation</h4>
              <div class="eqrow">
                <div class="eq" data-copy="Vπ = λ / (2 n0^3 r63)    (longitudinal KDP, d=L)">
                  Vπ = λ / (2 n0^3 r63) &nbsp;&nbsp; (longitudinal KDP, d = L)
                </div>
                <button class="copybtn" data-copy-target="prev">Copy equation</button>
              </div>
            </div>
            <div class="box warn">
              <h4>Design insight</h4>
              <p>Alternating electrode polarity can <em>cancel</em> modulation unless you alternate crystal orientation so the effective sign flips too.</p>
            </div>
          </div>
        </div>
        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section class="card" id="primer">
        <h2>PART 0 — Concept Primer (Theory before solving)</h2>

        <h3>0.1 Core definitions (symbols + SI units)</h3>
        <ul>
          <li><strong>λ</strong> (m): optical vacuum wavelength.</li>
          <li><strong>n</strong> (dimensionless): refractive index of a mode; for KDP we use <strong>n₀</strong> (ordinary index) in this longitudinal configuration.</li>
          <li><strong>r</strong> (m/V): electro-optic (Pockels) coefficient; here the relevant one is <strong>r₆₃</strong> for KDP.</li>
          <li><strong>E</strong> (V/m): applied electric field magnitude in the crystal, typically E = V/d.</li>
          <li><strong>V</strong> (V): applied voltage across electrodes.</li>
          <li><strong>d</strong> (m): electrode spacing (crystal thickness in the field direction).</li>
          <li><strong>L</strong> (m): optical interaction length (propagation distance through the crystal).</li>
          <li><strong>Δn</strong> (dimensionless): induced birefringence between the two eigenmodes (difference in refractive indices).</li>
          <li><strong>Γ</strong> (rad): phase retardation between the two eigenmodes after passing through the crystal.</li>
          <li><strong>Vπ</strong> (V): half-wave voltage, the voltage that produces Γ = π.</li>
        </ul>

        <h3>0.2 Physical meaning (intuition)</h3>
        <ul>
          <li>The Pockels effect makes the crystal’s optical properties change linearly with E, so light polarized along two orthogonal eigenaxes experiences different phase velocities.</li>
          <li>That difference accumulates over length L, producing a relative phase delay Γ proportional to V (in the linear regime).</li>
          <li>Vπ is the voltage needed to create a phase difference of π (half a wave) between eigenmodes.</li>
        </ul>

        <h3>0.3 Key principle and validity conditions</h3>
        <div class="box">
          <h4>Small-signal electro-optic approximation</h4>
          <p class="muted">
            Linear electro-optic theory applies when the induced index change is small: |Δn| ≪ n, and the field is below levels where breakdown or strong nonlinearities appear.
          </p>
        </div>

        <h3>0.4 Standard model used here (why it’s used)</h3>
        <ul>
          <li><strong>Index change model:</strong> Δn ≈ −(1/2) n³ r E.</li>
          <li><strong>Uniform field:</strong> E = V/d.</li>
          <li><strong>Longitudinal geometry:</strong> typically d = L, simplifying Γ(V).</li>
        </ul>

        <h3>0.5 Mini intuition examples</h3>
        <ul>
          <li>Double L (same E) → Γ doubles → Vπ halves.</li>
          <li>Increase r → larger Δn per V → smaller Vπ.</li>
          <li>Cascade N identical plates (constructive) → Vπ reduces by N.</li>
        </ul>

        <h3>0.6 What to watch for (pitfalls)</h3>
        <ul>
          <li>Sign flips from E reversal or plate rotation: add vs cancel.</li>
          <li>Using the wrong index (n₀ vs nₑ) for this configuration.</li>
          <li>Forgetting the geometric factor d/L in non-longitudinal setups.</li>
        </ul>

        <details>
          <summary>Optional deeper note: why Δn ≈ −(1/2) n³ r E</summary>
          <div class="content">
            <p class="muted">
              Start with Δ(1/n²)=rE. For small Δn, expand 1/(n+Δn)² ≈ 1/n² − (2Δn)/n³. Matching terms gives Δn ≈ −(1/2)n³ rE.
            </p>
          </div>
        </details>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section class="card" id="analysis">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>1.1 Restate the problem</h3>
        <ul>
          <li><strong>(a)</strong> For a KDP longitudinal phase modulator at 633 nm in the specified axis/electrode configuration, find Vπ.</li>
          <li><strong>(b)</strong> For 9 plates with alternating electrode bias (alternating E direction), choose relative plate orientations to maximize total phase modulation, then compute composite Vπ.</li>
        </ul>

        <h3>1.2 Given</h3>
        <ul>
          <li>r₄₁ = 8 pm/V, r₆₃ = 11 pm/V.</li>
          <li>n₀ = 1.507, nₑ = 1.467 at λ₀ = 633 nm.</li>
          <li>Longitudinal modulator: propagation along optic axis; field along optic axis; take d = L.</li>
          <li>N = 9 plates; E alternates sign plate-to-plate due to electrode biasing.</li>
        </ul>

        <h3>1.3 Unknowns</h3>
        <ul>
          <li>Vπ (single plate).</li>
          <li>Plate orientation rule; Vπ (9-plate composite).</li>
        </ul>

        <h3>1.4 Applicable principles</h3>
        <ul>
          <li>Linear Pockels effect (given r values).</li>
          <li>Phase retardation from induced birefringence: Γ = (2π/λ)ΔnL.</li>
          <li>Superposition for cascaded plates: Γ_total = Σ Γ_i (if eigenmodes are aligned).</li>
        </ul>

        <div class="callouts">
          <div class="box warn">
            <h4>Assumptions</h4>
            <ul>
              <li>Uniform E in each plate, negligible fringing.</li>
              <li>Small electro-optic perturbation (linear regime).</li>
              <li>Perfect plate alignment so retardations add in same basis.</li>
            </ul>
          </div>
          <div class="box">
            <h4>Key risk</h4>
            <p>If E reverses and plates are identical, Γ alternates sign and cancels. Orientation must compensate the sign flip.</p>
          </div>
        </div>

        <h3>1.5 Approaches</h3>
        <ul>
          <li><strong>Use known KDP longitudinal result:</strong> eigenmodes have r₁ = r₆₃ and r₂ = −r₆₃ → direct Vπ formula.</li>
          <li><strong>General derivation:</strong> compute Δn from Δn ≈ −(1/2)n³rE for both modes, then Γ and set Γ = π.</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section class="card" id="strategy">
        <h2>PART 2 — Strategy &amp; Tips (roadmap only)</h2>

        <ol style="margin:8px 0 0 18px; padding:0;">
          <li>Write mode coefficients: r₁ = r₆₃, r₂ = −r₆₃.</li>
          <li>Use Δn ≈ −(1/2)n₀³ r E to get Δn₁ and Δn₂.</li>
          <li>Form birefringence Δn = n₂ − n₁.</li>
          <li>Compute Γ = (2π/λ)ΔnL, with E = V/d.</li>
          <li>Set Γ = π; in longitudinal geometry take d = L → solve for Vπ.</li>
          <li>For N plates: ensure each plate’s Γ has same sign despite alternating E by alternating plate orientation.</li>
          <li>Then Γ_total = NΓ_single → Vπ,total = Vπ/N.</li>
        </ol>

        <div class="box bad" style="margin-top:12px;">
          <h4>Common mistakes</h4>
          <ul>
            <li>Dropping the factor of 2 from r₁ − r₂ = 2r₆₃.</li>
            <li>Using nₑ instead of n₀ in this specific longitudinal KDP configuration.</li>
            <li>Forgetting that alternating electrode bias flips E sign and can cancel modulation.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section class="card" id="solution">
        <h2>PART 3 — Full Solution (detailed + teaching)</h2>

        <h3>3.1 Qualitative expectation</h3>
        <ul>
          <li>Γ ∝ V (linear Pockels), so Vπ is a constant set by material and geometry.</li>
          <li>Cascading N plates ideally reduces required voltage by N if phase shifts add.</li>
        </ul>

        <h3>3.2 Part (a): Single KDP longitudinal modulator</h3>
        <p class="muted">
          With E applied along the optic axis of KDP (42m), the two eigenmodes in the transverse plane experience opposite electro-optic coefficients:
        </p>

        <div class="eqrow">
          <div class="eq" data-copy="r1 = r63,   r2 = −r63">
            r1 = r63, &nbsp;&nbsp; r2 = −r63
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <p class="muted">For small perturbations, the index change for each mode is:</p>
        <div class="eqrow">
          <div class="eq" data-copy="Δn ≈ −(1/2) n^3 r E">
            Δn ≈ −(1/2) n^3 r E
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <p class="muted">Use n = n0 for both modes (before splitting):</p>
        <div class="eqrow">
          <div class="eq" data-copy="Δn1 ≈ −(1/2) n0^3 r63 E
Δn2 ≈ −(1/2) n0^3 (−r63) E = +(1/2) n0^3 r63 E">
            Δn1 ≈ −(1/2) n0^3 r63 E<br/>
            Δn2 ≈ −(1/2) n0^3 (−r63) E = +(1/2) n0^3 r63 E
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <p class="muted">Thus the induced birefringence is:</p>
        <div class="eqrow">
          <div class="eq" data-copy="Δn = n2 − n1 ≈ Δn2 − Δn1 = n0^3 r63 E">
            Δn = n2 − n1 ≈ Δn2 − Δn1 = n0^3 r63 E
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <p class="muted">Retardation after length L:</p>
        <div class="eqrow">
          <div class="eq" data-copy="Γ = (2π/λ) Δn L = (2π/λ) (n0^3 r63 E) L">
            Γ = (2π/λ) Δn L = (2π/λ) (n0^3 r63 E) L
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <p class="muted">With E = V/d:</p>
        <div class="eqrow">
          <div class="eq" data-copy="Γ = (2π/λ) n0^3 r63 (V/d) L">
            Γ = (2π/λ) n0^3 r63 (V/d) L
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <p class="muted">In the longitudinal configuration here, d = L, so:</p>
        <div class="eqrow">
          <div class="eq" data-copy="Γ = (2π/λ) n0^3 r63 V">
            Γ = (2π/λ) n0^3 r63 V
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <p class="muted">Half-wave condition Γ = π gives:</p>
        <div class="eqrow">
          <div class="eq" data-copy="π = (2π/λ) n0^3 r63 Vπ  ⇒  Vπ = λ / (2 n0^3 r63)">
            π = (2π/λ) n0^3 r63 Vπ  ⇒  Vπ = λ / (2 n0^3 r63)
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <p class="muted">Insert λ = 633 nm, n0 = 1.507, r63 = 11 pm/V:</p>
        <div class="eqrow">
          <div class="eq" data-copy="Vπ = (633e−9) / (2*(1.507)^3*(11e−12)) ≈ 8.41×10^3 V = 8.41 kV">
            Vπ = (633e−9) / (2*(1.507)^3*(11e−12)) ≈ 8.41×10^3 V = 8.41 kV
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <div class="box final" style="margin-top:12px;">
          <h4>Final answer — Part (a)</h4>
          <div class="eqrow">
            <div class="eq" data-copy="Part (a): Vπ = λ0 / (2 n0^3 r63) = 8.41 kV (KDP at 633 nm)">
              Part (a): Vπ = λ0 / (2 n0^3 r63) = <strong>8.41 kV</strong> (KDP at 633 nm)
            </div>
            <button class="copybtn" data-copy-target="prev">Copy final answer</button>
          </div>
        </div>

        <h3>3.3 Part (b): 9-plate cascade</h3>
        <p class="muted">
          The electrode biasing alternates the field direction plate-to-plate: E, −E, E, −E, ....
          Because Γ ∝ E, identical plates would produce alternating ±Γ and cancel.
          To maximize modulation, we must ensure each plate contributes the same-sign retardation in the same lab polarization basis.
        </p>

        <div class="box warn">
          <h4>Orientation rule for maximum addition</h4>
          <p>
            <strong>Rotate every other crystal plate by 90° about the propagation axis</strong> (swap the transverse principal axes),
            so the sign flip from E reversal is compensated by an effective sign flip from the plate orientation.
            Then each plate contributes +Γ_single and the total adds constructively.
          </p>
        </div>

        <p class="muted">With constructive addition:</p>
        <div class="eqrow">
          <div class="eq" data-copy="Γtotal = N Γsingle  ⇒  Vπ,total = Vπ,single / N">
            Γtotal = N Γsingle  ⇒  Vπ,total = Vπ,single / N
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <p class="muted">For N = 9:</p>
        <div class="eqrow">
          <div class="eq" data-copy="Vπ,total = 8.41 kV / 9 ≈ 0.934 kV ≈ 934 V">
            Vπ,total = 8.41 kV / 9 ≈ 0.934 kV ≈ 934 V
          </div>
          <button class="copybtn" data-copy-target="prev">Copy equation</button>
        </div>

        <div class="box final" style="margin-top:12px;">
          <h4>Final answer — Part (b)</h4>
          <div class="eqrow">
            <div class="eq" data-copy="Part (b): Alternate plate orientations (every other plate rotated 90°) so phase shifts add. Composite Vπ = Vπ(single)/9 ≈ 0.934 kV (≈ 934 V).">
              Part (b): Alternate plate orientations (every other plate rotated 90°) so phase shifts add.<br/>
              Composite Vπ = Vπ(single)/9 ≈ <strong>0.934 kV</strong> (≈ 934 V).
            </div>
            <button class="copybtn" data-copy-target="prev">Copy final answer</button>
          </div>
        </div>

        <h3>3.4 Sanity checks</h3>
        <div class="callouts">
          <div class="box good">
            <h4>Units</h4>
            <p>Vπ = λ/(2 n0³ r63): (m)/(m/V) = V. ✔</p>
          </div>
          <div class="box">
            <h4>Limiting cases</h4>
            <ul>
              <li>r63 → 0 ⇒ Vπ → ∞. ✔</li>
              <li>N → larger ⇒ Vπ,total → smaller as 1/N. ✔</li>
            </ul>
          </div>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section class="card" id="deeper">
        <h2>PART 4 — Deeper Understanding</h2>

        <h3>4.1 What each term controls</h3>
        <ul>
          <li><strong>λ:</strong> sets required optical phase scale; longer λ needs larger Vπ.</li>
          <li><strong>n0³:</strong> boosts sensitivity strongly; modest increases in n reduce Vπ significantly.</li>
          <li><strong>r63:</strong> material efficiency; larger r lowers Vπ directly.</li>
          <li><strong>N:</strong> cascade count; in the ideal case Vπ scales as 1/N.</li>
        </ul>

        <h3>4.2 Alternative derivation</h3>
        <p class="muted">
          Start from the perturbed index ellipsoid for 42m crystals under E along the optic axis, diagonalize to find principal indices and axes,
          then compute Γ = (2π/λ)(n2−n1)L and solve Γ=π. This explicitly shows the 45° eigenaxis rotation and yields the same Vπ.
        </p>

        <h3>4.3 Concept checks</h3>
        <ul>
          <li><strong>Q:</strong> If V = Vπ/3, what is Γ? <strong>A:</strong> Γ = π/3.</li>
          <li><strong>Q:</strong> Why does alternating E require alternating plate orientation? <strong>A:</strong> Because Γ ∝ E; without orientation changes, signs alternate and cancel.</li>
          <li><strong>Q:</strong> If you used 18 plates ideally, what happens to Vπ? <strong>A:</strong> It halves again: Vπ/18.</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section class="card" id="plotguide">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p class="muted">
          No plot is necessary to solve this problem because the result follows from a direct linear relationship Γ ∝ V and a single threshold condition Γ = π.
          The key learning point is the formula for Vπ and the 1/N scaling for cascaded plates.
        </p>
        <a class="backtop" href="#top">↑ Back to top</a>
      </section>
    </main>

    <footer role="contentinfo">
      <div>Electro-optic phase modulation in KDP (Pockels effect) — longitudinal geometry and cascaded plate design.</div>
    </footer>
  </div>

  <div class="toast" id="toast" aria-live="polite"></div>

  <script>
    (function(){
      const toast = document.getElementById('toast');
      let tmr = null;

      function showToast(msg){
        toast.textContent = msg;
        toast.classList.add('show');
        clearTimeout(tmr);
        tmr = setTimeout(()=>toast.classList.remove('show'), 1200);
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          showToast("Copied to clipboard.");
        }catch(e){
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          ta.style.top = '0';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          try{
            document.execCommand('copy');
            showToast("Copied to clipboard.");
          }catch(err){
            showToast("Copy failed (browser blocked).");
          }
          document.body.removeChild(ta);
        }
      }

      document.addEventListener('click', (ev)=>{
        const btn = ev.target.closest('.copybtn');
        if(!btn) return;

        if(btn.dataset.copyTarget === 'prev'){
          const parent = btn.parentElement;
          let eq = parent ? parent.querySelector('.eq') : null;
          if(!eq){
            let p = btn.previousElementSibling;
            while(p && !p.classList.contains('eq')) p = p.previousElementSibling;
            eq = p;
          }
          if(eq){
            const txt = eq.getAttribute('data-copy') || eq.innerText.replace(/\u00a0/g,' ').trim();
            copyText(txt);
          }
          return;
        }

        if(btn.dataset.copy){
          copyText(btn.dataset.copy);
        }
      });
    })();
  </script>
</body>
</html>
