<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Plastic Fiber Link Budget: Maximum Length from Attenuation and Receiver Sensitivity</title>
  <style>
    :root{
      --bg:#0b1220;
      --panel:#101a2e;
      --card:#0f1a33;
      --text:#e8eefc;
      --muted:#b9c4e6;
      --faint:#7f8bb3;
      --accent:#7dd3fc;
      --accent2:#a7f3d0;
      --warn:#fbbf24;
      --good:#34d399;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
      --radius2:22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1100px 700px at 15% 10%, rgba(125,211,252,.12), transparent 55%),
        radial-gradient(900px 600px at 85% 20%, rgba(167,243,208,.10), transparent 55%),
        linear-gradient(180deg, #070c16 0%, var(--bg) 40%, #070c16 100%);
      line-height:1.55;
    }

    header{
      position:relative;
      padding: clamp(18px, 3vw, 34px) clamp(16px, 4vw, 44px);
      border-bottom:1px solid var(--line);
      overflow:hidden;
    }
    header::after{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(700px 260px at 50% 0%, rgba(125,211,252,.18), transparent 62%),
        radial-gradient(700px 260px at 25% 110%, rgba(167,243,208,.10), transparent 62%);
      pointer-events:none;
      filter: blur(0px);
      opacity:.9;
    }
    .hero{
      position:relative;
      z-index:1;
      max-width:1200px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.35fr .65fr;
      gap:18px;
      align-items:start;
    }
    .title{
      padding:18px 18px 16px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      transform: translateY(0);
      animation: floatIn .55s ease-out both;
    }
    @keyframes floatIn{
      from{opacity:0; transform: translateY(10px)}
      to{opacity:1; transform: translateY(0)}
    }
    h1{
      margin:0 0 8px;
      font-size: clamp(20px, 2.2vw, 32px);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      font-size: clamp(13px, 1.3vw, 15.5px);
    }
    .meta{
      padding:18px;
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(16,26,46,.55);
      box-shadow: var(--shadow);
      animation: floatIn .55s .06s ease-out both;
    }
    .meta h2{
      margin:0 0 10px;
      font-size: 14px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color: var(--muted);
    }
    .pillrow{
      display:flex; flex-wrap:wrap; gap:8px;
    }
    .pill{
      padding:7px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      font-size:12.5px;
      color:var(--muted);
      white-space:nowrap;
    }

    main{
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px clamp(16px, 4vw, 44px) 44px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
    }

    nav#toc{
      position: sticky;
      top: 14px;
      align-self:start;
      padding: 14px 14px 12px;
      border-radius: var(--radius2);
      border: 1px solid var(--line);
      background: rgba(16,26,46,.62);
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
    }
    nav#toc .tocTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    nav#toc h2{
      margin:0;
      font-size: 13px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color: var(--muted);
    }
    .tocHint{
      font-size:12px;
      color:var(--faint);
    }
    nav#toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      text-decoration:none;
      color:var(--text);
      border:1px solid transparent;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
      font-size: 13.5px;
    }
    nav#toc a:hover{
      background: rgba(255,255,255,.05);
      border-color: rgba(125,211,252,.20);
      transform: translateY(-1px);
    }
    nav#toc .minor{
      color:var(--muted);
      font-size:12.5px;
      padding-left:18px;
    }

    article{
      display:flex;
      flex-direction:column;
      gap: 14px;
      min-width:0;
    }

    section{
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(16,26,46,.42);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    section > header{
      padding: 14px 16px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    }
    section > header h2{
      margin:0;
      font-size: clamp(16px, 1.6vw, 20px);
    }
    .content{
      padding: 14px 16px 18px;
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .grid3{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 980px){
      main{grid-template-columns: 1fr; }
      nav#toc{position:relative; top:auto;}
      .hero{grid-template-columns: 1fr;}
      .grid2,.grid3{grid-template-columns:1fr;}
    }

    .card{
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(255,255,255,.03);
      padding: 12px 12px 12px;
      min-width:0;
    }
    .card h3{
      margin:0 0 8px;
      font-size: 14px;
      color: var(--muted);
      letter-spacing:.02em;
    }

    ul{margin:8px 0 0 18px; padding:0}
    li{margin:6px 0}
    .muted{color:var(--muted)}
    .faint{color:var(--faint)}
    .eqbox{
      border:1px solid rgba(125,211,252,.22);
      background: rgba(125,211,252,.06);
      border-radius: var(--radius);
      padding: 12px;
      overflow:auto;
      position:relative;
    }
    pre, code{
      font-family:var(--mono);
      font-size: 12.8px;
      line-height:1.45;
      color: #eaf2ff;
      margin:0;
      white-space:pre-wrap;
      word-break:break-word;
    }

    .callouts{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 720px){
      .callouts{grid-template-columns:1fr}
    }

    .callout{
      border-radius: var(--radius);
      padding: 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      position:relative;
      overflow:hidden;
    }
    .callout::before{
      content:"";
      position:absolute; left:0; top:0; bottom:0; width:4px;
      background: rgba(125,211,252,.75);
    }
    .callout.assumptions::before{background: rgba(167,243,208,.75)}
    .callout.mistakes::before{background: rgba(251,191,36,.85)}
    .callout.answer::before{background: rgba(52,211,153,.85)}
    .callout h3{
      margin:0 0 8px;
      font-size: 14px;
      color: var(--muted);
    }

    .btnRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    button.copyBtn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--text);
      border-radius: 999px;
      padding: 8px 12px;
      font-size: 12.5px;
      cursor:pointer;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    button.copyBtn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.09);
      border-color: rgba(125,211,252,.28);
    }
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(16,26,46,.92);
      border:1px solid rgba(255,255,255,.14);
      color: var(--text);
      font-size: 12.5px;
      box-shadow: var(--shadow);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      z-index: 999;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(-2px);
    }

    details{
      border:1px dashed rgba(255,255,255,.18);
      border-radius: var(--radius);
      padding: 10px 12px;
      background: rgba(255,255,255,.02);
      margin-top: 10px;
    }
    details summary{
      cursor:pointer;
      color: var(--muted);
      font-weight: 650;
      letter-spacing:.01em;
    }

    figure{
      margin: 12px 0 0;
      border:1px solid var(--line);
      border-radius: var(--radius2);
      overflow:hidden;
      background: rgba(0,0,0,.15);
    }
    .figHeader{
      padding: 10px 12px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:12px;
      background: rgba(255,255,255,.03);
    }
    .figHeader strong{font-size: 13.5px}
    .figHeader span{font-size: 12.5px; color: var(--muted)}
    canvas{
      width: 100%;
      height: 360px;
      display:block;
    }
    @media (max-width: 520px){
      canvas{height: 300px}
    }

    .backTop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      text-decoration:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      color: var(--text);
      font-size: 12.5px;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .backTop:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.09);
      border-color: rgba(125,211,252,.28);
    }

    footer{
      max-width:1200px;
      margin: 0 auto;
      padding: 12px clamp(16px, 4vw, 44px) 30px;
      color: var(--faint);
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, nav#toc, .toast, .btnRow, .backTop {display:none !important}
      main{display:block; padding:0}
      section{box-shadow:none; background:#fff; border:1px solid #ddd}
      section > header{background:#f6f6f6}
      .eqbox{background:#f3fbff; border-color:#a9d9f5}
      pre, code{color:#000}
      a{color:#000; text-decoration:none}
      .pageBreak{break-before: page;}
    }
  </style>
</head>
<body>
  <a id="top"></a>
  <header>
    <div class="hero">
      <div class="title">
        <h1>Performance of a Plastic Fiber Link: Maximum Length from a Power Budget</h1>
        <p class="subtitle">
          Applied physics + industrial engineering lens: turn component specs (LED power, coupler loss, fiber attenuation, receiver sensitivity)
          into a quantitative <span class="muted">link budget</span> that sets the longest usable cable.
        </p>
      </div>
      <aside class="meta" aria-label="Quick metadata">
        <h2>At a glance</h2>
        <div class="pillrow">
          <span class="pill">Topic: Optical link budget</span>
          <span class="pill">Given: 0.5 dB/m fiber</span>
          <span class="pill">LED: 1 mW @ 870 nm</span>
          <span class="pill">Rx sensitivity: −20 dBm</span>
          <span class="pill">Couplers: 3 dB + 3 dB</span>
          <span class="pill">Dispersion neglected</span>
        </div>
      </aside>
    </div>
  </header>

  <main>
    <nav id="toc" aria-label="Table of contents">
      <div class="tocTitle">
        <h2>Contents</h2>
        <div class="tocHint">sticky</div>
      </div>
      <a href="#quick">Quick Summary</a>
      <a href="#primer">PART 0 — Concept Primer</a>
      <a href="#industry">PART 0B — Industry & Applied Physics</a>
      <a href="#analysis">PART 1 — Problem Analysis</a>
      <a href="#strategy">PART 2 — Strategy & Tips</a>
      <a href="#solution">PART 3 — Full Solution</a>
      <a href="#deeper">PART 4 — Deeper Understanding</a>
      <a href="#plotguide">PART 5 — Optional Plot Guide</a>
      <a class="minor" href="#top">Back to top</a>
    </nav>

    <article>
      <!-- Quick Summary -->
      <section id="quick">
        <header><h2>Quick Summary</h2></header>
        <div class="content">
          <ul>
            <li><strong>What this is:</strong> Find the <strong>maximum fiber length</strong> for a plastic optical fiber (POF) link given transmitter power, receiver sensitivity, coupler losses, and fiber attenuation.</li>
            <li><strong>Key physics idea:</strong> Optical power decays along the link; in <strong>dB units</strong> the losses add linearly (easy budgeting).</li>
            <li><strong>Governing equations:</strong>
              <span class="muted">P<sub>rx</sub>(dBm) = P<sub>tx</sub>(dBm) − (sum of losses in dB)</span> and
              <span class="muted">fiber loss = α(dB/m) · L(m).</span>
            </li>
            <li><strong>Given:</strong> P<sub>tx</sub> = 1 mW = <strong>0 dBm</strong>, sensitivity = <strong>−20 dBm</strong>, couplers: 3 dB in + 3 dB out, fiber: 0.5 dB/m.</li>
            <li><strong>Result type:</strong> Numeric (meters).</li>
            <li><strong>Physical meaning:</strong> At the maximum length, the received optical power is exactly at the receiver’s minimum detectable level; beyond that, the link margin is negative.</li>
            <li><strong>Answer:</strong> Maximum length <strong>L<sub>max</sub> = 28 m</strong> (with zero extra margin).</li>
          </ul>

          <div class="callouts" style="margin-top:12px;">
            <div class="callout assumptions">
              <h3>Assumptions (as stated or implied)</h3>
              <ul class="muted">
                <li>Data rate is low → <strong>dispersion ignored</strong> (no bandwidth penalty).</li>
                <li>Losses are <strong>power losses</strong> (not field/amplitude losses).</li>
                <li>LED output is interpreted as launched optical power before the input coupler loss.</li>
                <li>No additional connector/splice/bend losses beyond those specified.</li>
              </ul>
            </div>
            <div class="callout answer">
              <h3>Final Answer (copyable)</h3>
              <div class="eqbox" data-copy="final">
                <pre id="finalText">Maximum link length: L_max = 28 m
(Computed from 20 dB total budget minus 6 dB couplers, with 0.5 dB/m fiber loss.)</pre>
              </div>
              <div class="btnRow">
                <button class="copyBtn" data-copy-btn="final" aria-label="Copy final answer">
                  <span>Copy final answer</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- PART 0 -->
      <section id="primer">
        <header><h2>PART 0 — Concept Primer (Theory Before Solving)</h2></header>
        <div class="content">
          <div class="grid2">
            <div class="card">
              <h3>Core definitions (symbols + SI units)</h3>
              <ul class="muted">
                <li><strong>P</strong> — optical power (W). Commonly mW for short links.</li>
                <li><strong>dBm</strong> — power level referenced to 1 mW:
                  <span class="faint">P(dBm) = 10 log10(P/1 mW)</span>.
                </li>
                <li><strong>Loss (dB)</strong> — ratio of output to input power:
                  <span class="faint">Loss(dB) = 10 log10(P_in / P_out)</span> (positive number for attenuation).
                </li>
                <li><strong>α</strong> — attenuation coefficient in <strong>dB/m</strong> (here 0.5 dB/m).</li>
                <li><strong>L</strong> — fiber length (m).</li>
                <li><strong>S</strong> — receiver sensitivity (dBm), the minimum required received power for acceptable operation.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Physical meaning (intuition)</h3>
              <ul class="muted">
                <li>In real materials, light is reduced by absorption + scattering + imperfect coupling.</li>
                <li>Using <strong>dB</strong> turns multiplicative power ratios into <strong>additive</strong> numbers:
                  losses from multiple components simply <em>sum</em>.</li>
                <li>Receiver sensitivity is like a “minimum fuel level”: if received power falls below it, bit errors rise sharply.</li>
              </ul>
            </div>
          </div>

          <div class="card" style="margin-top:12px;">
            <h3>Key laws / principles and validity conditions</h3>
            <ul class="muted">
              <li><strong>Power budget (link budget):</strong>
                <span class="faint">P_rx(dBm) = P_tx(dBm) − ΣLoss(dB)</span>.
                Valid when losses are independent and specified as <em>power</em> losses.
              </li>
              <li><strong>Distributed fiber loss model:</strong> if α is constant,
                <span class="faint">Loss_fiber(dB) = α(dB/m) · L(m)</span>.
                This is an engineering form of exponential decay in linear power.
              </li>
              <li><strong>Neglecting dispersion:</strong> the problem explicitly says data rate is low enough, so we only check <em>power</em>, not bandwidth.</li>
            </ul>

            <details>
              <summary>Optional deeper note: exponential decay vs dB</summary>
              <div class="muted" style="margin-top:8px;">
                In linear units, fiber power typically decays exponentially:
                <span class="faint">P(L) = P(0) · e^{−γL}</span>.
                Converting to dB produces a linear relationship:
                <span class="faint">10 log10(P(L)) = 10 log10(P(0)) − (constant)·L</span>,
                which is why attenuation is often tabulated as dB per meter (or per kilometer).
              </div>
            </details>
          </div>

          <div class="grid2" style="margin-top:12px;">
            <div class="card">
              <h3>Common models/approximations (and why)</h3>
              <ul class="muted">
                <li><strong>Lumped losses:</strong> connectors/couplers modeled as fixed dB numbers (fast budgeting).</li>
                <li><strong>Constant α:</strong> assume uniform fiber quality and bend conditions along length.</li>
                <li><strong>Ignore reflections:</strong> for short POF links and LED sources, reflection penalties are often small compared to gross attenuation.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Mini intuition examples (minimal algebra)</h3>
              <ul class="muted">
                <li><strong>Example 1:</strong> A 3 dB loss means power is cut in half.</li>
                <li><strong>Example 2:</strong> Two 3 dB losses in series → 6 dB total → power becomes one quarter.</li>
                <li><strong>Example 3:</strong> If α = 0.5 dB/m, then every 2 m costs 1 dB (≈ 20% power drop per 1 dB).</li>
              </ul>
            </div>
          </div>

          <div class="callout mistakes" style="margin-top:12px;">
            <h3>What to watch for (pitfalls)</h3>
            <ul class="muted">
              <li><strong>Mixing units:</strong> don’t add mW directly with dB; convert properly (mW ↔ dBm).</li>
              <li><strong>Sign confusion:</strong> “loss” is positive in dB, but it <em>subtracts</em> from power in dBm.</li>
              <li><strong>Forgetting fixed losses:</strong> couplers/connectors can dominate short links.</li>
              <li><strong>No margin:</strong> a “maximum length” computed from equality gives <em>zero</em> engineering margin; real designs usually shorten the link for reliability.</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- PART 0B -->
      <section id="industry">
        <header><h2>PART 0B — Industry & Applied Physics Perspective</h2></header>
        <div class="content">
          <div class="grid3">
            <div class="card">
              <h3>Where this appears in industry</h3>
              <ul class="muted">
                <li><strong>Automotive:</strong> in-vehicle infotainment/data links (short, robust, EMI-resistant).</li>
                <li><strong>Factory automation:</strong> sensors/actuators where electrical noise is high.</li>
                <li><strong>Consumer devices:</strong> short optical interconnects, isolation links, lighting control networks.</li>
                <li><strong>Medical/industrial instrumentation:</strong> galvanic isolation and noise immunity.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Why engineers care</h3>
              <ul class="muted">
                <li><strong>Performance:</strong> received power drives SNR → bit-error rate.</li>
                <li><strong>Reliability:</strong> aging, temperature, bending, contamination reduce margin.</li>
                <li><strong>Cost:</strong> higher-power sources or better receivers cost more; minimizing overdesign matters.</li>
                <li><strong>Manufacturability:</strong> connector quality and alignment tolerances are major yield factors.</li>
              </ul>
            </div>
            <div class="card">
              <h3>How it’s measured/validated</h3>
              <ul class="muted">
                <li><strong>Optical power meters</strong> (insertion loss tests for couplers/connectors).</li>
                <li><strong>Cutback method</strong> for fiber attenuation (measure P before/after known length changes).</li>
                <li><strong>System BER tests</strong> across temperature and bend-radius conditions.</li>
              </ul>
            </div>
          </div>

          <div class="card" style="margin-top:12px;">
            <h3>Design trade-offs & constraints (real-world non-idealities)</h3>
            <ul class="muted">
              <li><strong>Bend loss:</strong> POF can be sensitive to tight bends; routing constraints reduce effective margin.</li>
              <li><strong>Connector contamination:</strong> dust and scratches add unpredictable dB penalties.</li>
              <li><strong>LED variability:</strong> output power shifts with temperature and aging; production spread matters.</li>
              <li><strong>Receiver sensitivity spec:</strong> depends on bandwidth, noise, and required BER—often worse at higher data rates.</li>
            </ul>

            <details>
              <summary>From lab to product: adapting the idealized model</summary>
              <div class="muted" style="margin-top:8px;">
                In product design, you rarely run at the theoretical maximum length. Instead, you allocate a <strong>link margin</strong>
                (e.g., 3–10 dB depending on environment) to cover aging, temperature drift, connector wear, and installation variability.
                That turns the “maximum length” into a robust <em>design length</em>:
                <span class="faint">L_design = (Budget − FixedLoss − Margin)/α</span>.
              </div>
            </details>
          </div>
        </div>
      </section>

      <!-- PART 1 -->
      <section id="analysis">
        <header><h2>PART 1 — Problem Analysis (No Solving Yet)</h2></header>
        <div class="content">
          <div class="card">
            <h3>Restatement in plain language</h3>
            <p class="muted" style="margin:0;">
              A short optical communication link uses plastic fiber with loss <strong>0.5 dB per meter</strong>.
              An LED launches <strong>1 mW</strong> of optical power (at 870 nm). The photodiode receiver can detect down to
              <strong>−20 dBm</strong>. There is an additional <strong>3 dB loss at the input coupler</strong> and <strong>3 dB at the output coupler</strong>.
              Find the <strong>maximum fiber length</strong> such that received power is at least the sensitivity.
            </p>
          </div>

          <div class="grid2" style="margin-top:12px;">
            <div class="card">
              <h3>Given quantities</h3>
              <ul class="muted">
                <li>Fiber attenuation: α = 0.5 dB/m</li>
                <li>LED optical power: P_tx = 1 mW</li>
                <li>Wavelength: λ = 870 nm (contextual; not needed for the power-only calculation)</li>
                <li>Receiver sensitivity: S = −20 dBm</li>
                <li>Input coupler loss: L_in = 3 dB</li>
                <li>Output coupler loss: L_out = 3 dB</li>
              </ul>
            </div>
            <div class="card">
              <h3>Unknowns / what must be found</h3>
              <ul class="muted">
                <li>Maximum fiber length: L_max (m)</li>
                <li>Implicit: received power vs length, P_rx(L)</li>
              </ul>
            </div>
          </div>

          <div class="card" style="margin-top:12px;">
            <h3>Relevant principles and why they apply</h3>
            <ul class="muted">
              <li><strong>Link budget in dB/dBm:</strong> We have specified component losses in dB and powers in mW/dBm, so summing losses is natural.</li>
              <li><strong>Distributed fiber loss:</strong> α is given directly in dB/m, implying linear accumulation in dB with length.</li>
              <li><strong>Why not dispersion models:</strong> explicitly stated “data rate sufficiently low” → no pulse spreading constraint.</li>
              <li><strong>Why not wavelength dependence:</strong> λ is given but α is already specified; we don’t need material models.</li>
            </ul>
          </div>

          <div class="callouts" style="margin-top:12px;">
            <div class="callout assumptions">
              <h3>Assumptions to state explicitly</h3>
              <ul class="muted">
                <li>Coupler losses are insertion losses and independent of length.</li>
                <li>Fiber attenuation is uniform along L and includes all distributed loss mechanisms.</li>
                <li>Receiver sensitivity is the required minimum received <em>optical</em> power at the photodiode.</li>
                <li>We compute a maximum length at <strong>zero margin</strong>.</li>
              </ul>
            </div>
            <div class="callout">
              <h3>2–3 approaches (pros/cons)</h3>
              <ul class="muted">
                <li><strong>Approach A (dB budget):</strong> Convert to dBm, subtract dB losses, solve for L. <em>Fast, standard in industry.</em></li>
                <li><strong>Approach B (linear power ratios):</strong> Convert each dB to a multiplicative factor and solve in mW. <em>More steps; easier to make arithmetic mistakes.</em></li>
                <li><strong>Approach C (exponential attenuation model):</strong> Start from P(L)=P0 e^{−γL}, then map to dB/m. <em>Conceptually deeper, but unnecessary here since α is given directly.</em></li>
              </ul>
              <p class="muted" style="margin:10px 0 0;"><strong>Best choice:</strong> Approach A (dB budget), because all specs are already in dB/dBm.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- PART 2 -->
      <section id="strategy">
        <header><h2>PART 2 — Strategy & Tips (Roadmap Only)</h2></header>
        <div class="content">
          <div class="card">
            <h3>Plan (step-by-step roadmap)</h3>
            <ol class="muted" style="margin:8px 0 0 18px;">
              <li><strong>Convert transmitter power to dBm</strong> using P(dBm)=10 log10(P/1 mW). (Goal: use a single consistent unit.)</li>
              <li><strong>Compute total allowable loss</strong> = P_tx(dBm) − S(dBm). (Meaning: how many dB the link can “spend.”)</li>
              <li><strong>Subtract fixed coupler losses</strong> (3 dB + 3 dB). (Meaning: remaining budget for the fiber itself.)</li>
              <li><strong>Allocate remaining loss to fiber attenuation</strong>: Loss_fiber = α·L. (Meaning: distributed loss grows with length.)</li>
              <li><strong>Solve for L_max</strong> by setting received power equal to sensitivity (zero margin). (Meaning: longest permissible fiber.)</li>
              <li><strong>Sanity-check</strong> units and reasonableness (e.g., does higher α reduce length linearly?).</li>
            </ol>
          </div>

          <div class="callout mistakes" style="margin-top:12px;">
            <h3>Common mistakes (quick tips)</h3>
            <ul class="muted">
              <li>Forgetting that <strong>1 mW = 0 dBm</strong>.</li>
              <li>Adding coupler losses in mW instead of dB.</li>
              <li>Using 20 log10 instead of 10 log10 (20 log10 is for field/amplitude ratios, not power).</li>
              <li>Calling the computed length “safe” without adding margin for installation/aging/bends.</li>
            </ul>
          </div>

          <div class="eqbox" data-copy="eqs" style="margin-top:12px;">
            <pre id="eqText">Key equations (plain text):

1) Convert mW to dBm:
   P(dBm) = 10 * log10( P(mW) / 1 mW )

2) Link budget:
   P_rx(dBm) = P_tx(dBm) - [ L_in(dB) + L_fiber(dB) + L_out(dB) ]

3) Fiber loss with length:
   L_fiber(dB) = alpha(dB/m) * L(m)

At maximum length (zero margin):
   P_rx(dBm) = S(dBm)</pre>
          </div>
          <div class="btnRow">
            <button class="copyBtn" data-copy-btn="eqs" aria-label="Copy key equations">
              <span>Copy key equations</span>
            </button>
          </div>
        </div>
      </section>

      <!-- PART 3 -->
      <section id="solution">
        <header><h2>PART 3 — Full Solution (Detailed + Teaching)</h2></header>
        <div class="content">
          <div class="card">
            <h3>Qualitative expectation (before calculating)</h3>
            <p class="muted" style="margin:0;">
              Because the fiber attenuation is specified as a constant <strong>0.5 dB per meter</strong>, each additional meter costs the same amount of
              power in dB. So we expect the maximum length to scale <strong>linearly</strong> with the available loss budget:
              more transmitter power or better receiver sensitivity → longer length; higher attenuation or extra connector losses → shorter length.
            </p>
          </div>

          <div class="card" style="margin-top:12px;">
            <h3>Step 1 — Convert transmitter power to dBm</h3>
            <p class="muted">
              The LED generates <strong>P<sub>tx</sub> = 1 mW</strong>. By definition,
              <span class="faint">0 dBm corresponds exactly to 1 mW</span>. We can verify using the formula:
            </p>
            <div class="eqbox">
              <pre>P_tx(dBm) = 10 log10( P_tx / 1 mW )
         = 10 log10( 1 mW / 1 mW )
         = 10 log10(1)
         = 0 dBm</pre>
            </div>
            <p class="muted" style="margin-top:10px;">
              So the transmitter power level for budgeting is:
              <strong>P<sub>tx</sub> = 0 dBm</strong>.
            </p>
          </div>

          <div class="card" style="margin-top:12px;">
            <h3>Step 2 — Determine total allowable loss from sensitivity</h3>
            <p class="muted">
              The receiver sensitivity is <strong>S = −20 dBm</strong>, meaning the received power must satisfy:
              <span class="faint">P<sub>rx</sub>(dBm) ≥ −20 dBm</span>.
              The <em>maximum total loss</em> the link can tolerate (at zero margin) is:
            </p>
            <div class="eqbox">
              <pre>Total allowable loss (dB) = P_tx(dBm) - S(dBm)
                         = 0 - (-20)
                         = 20 dB</pre>
            </div>
            <p class="muted" style="margin-top:10px;">
              Interpretation: the link can "spend" up to <strong>20 dB</strong> of losses (couplers + fiber) before it hits the sensitivity floor.
            </p>
          </div>

          <div class="card" style="margin-top:12px;">
            <h3>Step 3 — Subtract fixed coupler losses to get the fiber-loss allowance</h3>
            <p class="muted">
              There is a <strong>3 dB</strong> power loss at the input coupler and a <strong>3 dB</strong> power loss at the output coupler.
              Fixed losses add directly in dB:
            </p>
            <div class="eqbox">
              <pre>L_couplers = L_in + L_out
           = 3 dB + 3 dB
           = 6 dB</pre>
            </div>
            <p class="muted" style="margin-top:10px;">
              Therefore the remaining loss budget available for the fiber itself is:
            </p>
            <div class="eqbox">
              <pre>Allowable fiber loss = Total allowable loss - L_couplers
                      = 20 dB - 6 dB
                      = 14 dB</pre>
            </div>
          </div>

          <div class="card" style="margin-top:12px;">
            <h3>Step 4 — Use fiber attenuation to solve for maximum length</h3>
            <p class="muted">
              The fiber attenuation coefficient is <strong>α = 0.5 dB/m</strong>. The distributed fiber loss for length <strong>L</strong> is:
              <span class="faint">L<sub>fiber</sub>(dB) = α · L</span>.
              Setting this equal to the allowable fiber loss (14 dB) gives the maximum length.
            </p>
            <div class="eqbox">
              <pre>alpha * L_max = 14 dB
(0.5 dB/m) * L_max = 14 dB

L_max = 14 dB / (0.5 dB/m)
     = 28 m</pre>
            </div>

            <div class="callout answer" style="margin-top:12px;">
              <h3>Final Result (boxed)</h3>
              <div class="eqbox">
                <pre><strong>L_max = 28 m</strong></pre>
              </div>
              <p class="muted" style="margin:10px 0 0;">
                This is the <strong>theoretical maximum</strong> with zero extra margin. In a robust industrial design, you typically reserve several dB of margin,
                which would reduce the allowable length.
              </p>
            </div>
          </div>

          <div class="card" style="margin-top:12px;">
            <h3>Sanity checks</h3>
            <ul class="muted">
              <li><strong>Units:</strong> (dB)/(dB/m) = m ✓</li>
              <li><strong>Limiting case:</strong> If α increases, L_max decreases linearly ✓</li>
              <li><strong>Reasonableness:</strong> POF at 0.5 dB/m is relatively lossy; tens of meters (not kilometers) is typical ✓</li>
              <li><strong>Interpretation:</strong> At L = 28 m, received power equals −20 dBm. Any extra unmodeled loss makes the link fail ✓</li>
            </ul>

            <details>
              <summary>Extra engineering note: adding a margin</summary>
              <div class="muted" style="margin-top:8px;">
                If you allocate a margin M (dB) for bends, aging, and connector variability, then:
                <div class="eqbox" style="margin-top:8px;">
                  <pre>L_design = (P_tx - S - L_in - L_out - M) / alpha</pre>
                </div>
                Example: with M = 6 dB, L_design = (20 − 6 − 6)/0.5 = 16 m.
              </div>
            </details>
          </div>

          <!-- Optional single plot -->
          <figure aria-label="Received power versus fiber length plot">
            <div class="figHeader">
              <strong>Single Plot: Received Power vs Fiber Length (dBm)</strong>
              <span>Shows linear drop in dB and where it hits the sensitivity limit</span>
            </div>
            <canvas id="plot" role="img" aria-label="Plot of received power in dBm versus length in meters"></canvas>
          </figure>
        </div>
      </section>

      <!-- PART 4 -->
      <section id="deeper" class="pageBreak">
        <header><h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2></header>
        <div class="content">
          <div class="card">
            <h3>Re-interpreting the final formula</h3>
            <p class="muted" style="margin:0 0 10px;">
              From the link budget,
              <span class="faint">P_rx(dBm) = P_tx(dBm) − L_in − L_out − αL</span>.
              Setting P_rx = S and solving yields:
            </p>
            <div class="eqbox" data-copy="general">
              <pre id="generalText">General maximum-length formula (zero margin):

L_max = ( P_tx(dBm) - S(dBm) - L_in(dB) - L_out(dB) ) / alpha(dB/m)</pre>
            </div>
            <div class="btnRow">
              <button class="copyBtn" data-copy-btn="general" aria-label="Copy general formula">
                <span>Copy general formula</span>
              </button>
            </div>
            <p class="muted" style="margin-top:10px;">
              Each term has a clean physical role:
            </p>
            <ul class="muted">
              <li><strong>P_tx − S</strong> is the total “loss budget” available from source strength and receiver capability.</li>
              <li><strong>L_in + L_out</strong> are fixed penalties that reduce the budget regardless of length.</li>
              <li><strong>α</strong> converts remaining dB budget into meters; lower α means longer reach.</li>
            </ul>
          </div>

          <div class="grid2" style="margin-top:12px;">
            <div class="card">
              <h3>Parameter dependence (how changes affect L)</h3>
              <ul class="muted">
                <li>Increase LED power by 3 dB (≈ 2× power) → <strong>L</strong> increases by <span class="faint">3/α</span> meters.</li>
                <li>Improve sensitivity by 3 dB (more negative by 3) → same increase <span class="faint">3/α</span>.</li>
                <li>Add 1 dB extra connector loss → length decreases by <span class="faint">1/α</span> meters.</li>
                <li>Reduce α via better fiber/routing → length improves inversely with α.</li>
              </ul>
              <p class="muted" style="margin:10px 0 0;">
                Here α = 0.5 dB/m, so <span class="faint">1 dB ≈ 2 m</span> of length.
              </p>
            </div>
            <div class="card">
              <h3>Alternative derivation idea (brief)</h3>
              <p class="muted" style="margin:0;">
                You can solve in linear power ratios:
                convert 3 dB → factor 1/2 per coupler, and 0.5 dB/m → factor 10^{−0.5L/10} for fiber.
                Then enforce P_rx ≥ P_sens in mW.
                This yields the same result but with more algebra—dB is the industrially preferred representation because it makes budgeting additive.
              </p>
              <details>
                <summary>Concept check: why 10 log10 for power?</summary>
                <div class="muted" style="margin-top:8px;">
                  Optical power is proportional to intensity/energy flow. Decibel is defined for power ratios with 10 log10.
                  The 20 log10 form applies to field amplitudes (like voltage) because power scales as amplitude squared.
                </div>
              </details>
            </div>
          </div>

          <div class="card" style="margin-top:12px;">
            <h3>Concept check (self-test with answers)</h3>
            <ul class="muted">
              <li><strong>Q:</strong> If the receiver sensitivity improves from −20 dBm to −23 dBm, what happens to L_max? <br>
                  <strong>A:</strong> Budget increases by 3 dB → L_max increases by 3/0.5 = 6 m.</li>
              <li><strong>Q:</strong> If you add one extra connector with 1 dB loss, how much length do you lose? <br>
                  <strong>A:</strong> 1/0.5 = 2 m shorter.</li>
              <li><strong>Q:</strong> Why is wavelength given if it doesn’t enter the calculation? <br>
                  <strong>A:</strong> In real design α depends on wavelength and source/receiver spectral response; here α is already specified at the operating conditions.</li>
              <li><strong>Q:</strong> What does “maximum length” mean operationally? <br>
                  <strong>A:</strong> It’s the length where received power just meets sensitivity—zero margin; reliability may be poor in variable environments.</li>
            </ul>
          </div>

          <div class="btnRow" style="margin-top:12px;">
            <a class="backTop" href="#top" aria-label="Back to top">↑ Back to top</a>
          </div>
        </div>
      </section>

      <!-- PART 5 -->
      <section id="plotguide">
        <header><h2>PART 5 — Optional Plot Guide</h2></header>
        <div class="content">
          <div class="card">
            <h3>What the plot shows (and why it helps)</h3>
            <ul class="muted">
              <li><strong>Y-axis:</strong> received optical power <span class="faint">P_rx</span> in dBm.</li>
              <li><strong>X-axis:</strong> fiber length <span class="faint">L</span> in meters.</li>
              <li>The curve is a straight line because in dB units, distributed attenuation is <strong>linear in length</strong>:
                <span class="faint">P_rx(dBm) = P_tx(dBm) − L_in − L_out − αL</span>.
              </li>
              <li>The horizontal dashed line marks the <strong>receiver sensitivity</strong> (−20 dBm). The intersection gives <strong>L_max</strong>.</li>
              <li>Using the actual problem numbers is appropriate here because the problem is numeric (no separate “example values” needed).</li>
            </ul>
          </div>
          <div class="btnRow" style="margin-top:12px;">
            <a class="backTop" href="#top" aria-label="Back to top">↑ Back to top</a>
          </div>
        </div>
      </section>
    </article>
  </main>

  <footer>
    <div style="border-top:1px solid rgba(255,255,255,.10); padding-top:12px;">
      <div class="muted" style="font-size:13px;">
        Built as a self-contained learning article (vanilla HTML/CSS/JS). Copy buttons provided for equations and the final answer.
      </div>
    </div>
  </footer>

  <div class="toast" id="toast" aria-live="polite">Copied.</div>

  <script>
    (function(){
      // ---------- Copy helpers ----------
      const toast = document.getElementById('toast');
      let toastTimer = null;

      function showToast(msg){
        toast.textContent = msg;
        toast.classList.add('show');
        clearTimeout(toastTimer);
        toastTimer = setTimeout(()=>toast.classList.remove('show'), 1100);
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          showToast("Copied to clipboard.");
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          ta.style.top = '0';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          try{
            document.execCommand('copy');
            showToast("Copied to clipboard.");
          }catch(err){
            showToast("Copy failed. Select and copy manually.");
          }
          document.body.removeChild(ta);
        }
      }

      document.querySelectorAll('[data-copy-btn]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const key = btn.getAttribute('data-copy-btn');
          const box = document.querySelector('[data-copy="'+key+'"]');
          if(!box){ showToast("Nothing to copy."); return; }
          const pre = box.querySelector('pre');
          const text = pre ? pre.innerText.trim() : box.innerText.trim();
          copyText(text);
        });
      });

      // ---------- Single static plot (canvas) ----------
      const canvas = document.getElementById('plot');
      const ctx = canvas.getContext('2d');

      // Problem parameters (used for the plot and consistent with the solution)
      const Ptx_dBm = 0;      // 1 mW
      const Lin_dB  = 3;
      const Lout_dB = 3;
      const alpha   = 0.5;    // dB/m
      const S_dBm   = -20;

      // For plotting, choose a length range that includes the intersection
      const Lmax = (Ptx_dBm - S_dBm - Lin_dB - Lout_dB)/alpha; // 28 m
      const LxMax = Math.max(40, Math.ceil(Lmax/5)*5);         // nice axis up to at least 40 m

      function dpr(){
        return Math.max(1, Math.min(2.5, window.devicePixelRatio || 1));
      }

      function resizeCanvas(){
        const rect = canvas.getBoundingClientRect();
        const ratio = dpr();
        canvas.width = Math.round(rect.width * ratio);
        canvas.height = Math.round(rect.height * ratio);
        ctx.setTransform(ratio, 0, 0, ratio, 0, 0); // draw in CSS pixels
        draw();
      }

      function prx(L){
        return Ptx_dBm - Lin_dB - Lout_dB - alpha*L;
      }

      function draw(){
        const W = canvas.getBoundingClientRect().width;
        const H = canvas.getBoundingClientRect().height;

        // Layout
        const padL = 56, padR = 18, padT = 18, padB = 46;
        const x0 = padL, y0 = padT;
        const x1 = W - padR, y1 = H - padB;
        const plotW = x1 - x0, plotH = y1 - y0;

        // Axis ranges
        const xmin = 0, xmax = LxMax;
        // y range: include start power and sensitivity with padding
        const yTop = Math.ceil((prx(0)+2)/2)*2;     // round to 2 dB
        const yBot = Math.floor((S_dBm-4)/2)*2;     // a bit below sensitivity
        const ymin = yBot, ymax = yTop;

        // helpers
        function X(x){ return x0 + (x - xmin) * (plotW/(xmax - xmin)); }
        function Y(y){ return y1 - (y - ymin) * (plotH/(ymax - ymin)); }

        // background
        ctx.clearRect(0,0,W,H);
        ctx.fillStyle = "rgba(0,0,0,0)";
        ctx.fillRect(0,0,W,H);

        // grid
        ctx.lineWidth = 1;
        ctx.strokeStyle = "rgba(255,255,255,0.10)";
        ctx.fillStyle = "rgba(255,255,255,0.85)";
        ctx.font = "12px " + getComputedStyle(document.body).fontFamily;

        // x ticks every 5 or 10
        const xStep = (xmax <= 50) ? 5 : 10;
        for(let x = xmin; x <= xmax+1e-9; x += xStep){
          const xx = X(x);
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y1);
          ctx.stroke();
          // tick label
          ctx.fillStyle = "rgba(185,196,230,0.92)";
          ctx.textAlign = "center";
          ctx.textBaseline = "top";
          ctx.fillText(String(x), xx, y1 + 8);
        }

        // y ticks every 2 dB
        const yStep = 2;
        for(let y = ymin; y <= ymax+1e-9; y += yStep){
          const yy = Y(y);
          ctx.strokeStyle = "rgba(255,255,255,0.10)";
          ctx.beginPath();
          ctx.moveTo(x0, yy);
          ctx.lineTo(x1, yy);
          ctx.stroke();
          // tick label
          ctx.fillStyle = "rgba(185,196,230,0.92)";
          ctx.textAlign = "right";
          ctx.textBaseline = "middle";
          ctx.fillText(String(y), x0 - 8, yy);
        }

        // axes
        ctx.strokeStyle = "rgba(255,255,255,0.35)";
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x0, y1);
        ctx.lineTo(x1, y1);
        ctx.stroke();

        // axis labels
        ctx.fillStyle = "rgba(232,238,252,0.92)";
        ctx.textAlign = "center";
        ctx.textBaseline = "bottom";
        ctx.font = "600 12.5px " + getComputedStyle(document.body).fontFamily;
        ctx.fillText("Fiber length L (m)", (x0+x1)/2, H - 10);

        ctx.save();
        ctx.translate(16, (y0+y1)/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = "center";
        ctx.textBaseline = "top";
        ctx.fillText("Received power P_rx (dBm)", 0, 0);
        ctx.restore();

        // plot line: P_rx(L)
        ctx.lineWidth = 2.2;
        ctx.strokeStyle = "rgba(125,211,252,0.95)";
        ctx.beginPath();
        const N = 240;
        for(let i=0;i<=N;i++){
          const L = xmin + (xmax-xmin)*(i/N);
          const y = prx(L);
          const xx = X(L), yy = Y(y);
          if(i===0) ctx.moveTo(xx,yy);
          else ctx.lineTo(xx,yy);
        }
        ctx.stroke();

        // sensitivity line
        ctx.setLineDash([6,5]);
        ctx.lineWidth = 1.6;
        ctx.strokeStyle = "rgba(251,113,133,0.90)";
        ctx.beginPath();
        ctx.moveTo(x0, Y(S_dBm));
        ctx.lineTo(x1, Y(S_dBm));
        ctx.stroke();
        ctx.setLineDash([]);

        // intersection marker at Lmax
        const ix = X(Lmax);
        const iy = Y(S_dBm);

        // marker
        ctx.fillStyle = "rgba(255,255,255,0.85)";
        ctx.beginPath();
        ctx.arc(ix, iy, 4.6, 0, Math.PI*2);
        ctx.fill();

        // annotation
        ctx.font = "600 12px " + getComputedStyle(document.body).fontFamily;
        ctx.fillStyle = "rgba(232,238,252,0.92)";
        ctx.textAlign = "left";
        ctx.textBaseline = "bottom";
        const label = "L_max ≈ " + (Math.round(Lmax*10)/10) + " m";
        ctx.fillText(label, Math.min(ix + 10, x1 - 90), iy - 8);

        // legend
        const lx = x0 + 10;
        const ly = y0 + 10;
        const lw = 210;
        const lh = 46;

        ctx.fillStyle = "rgba(16,26,46,0.80)";
        ctx.strokeStyle = "rgba(255,255,255,0.14)";
        ctx.lineWidth = 1;
        roundRect(ctx, lx, ly, lw, lh, 12);
        ctx.fill();
        ctx.stroke();

        // legend items
        ctx.font = "12px " + getComputedStyle(document.body).fontFamily;
        ctx.textAlign = "left";
        ctx.textBaseline = "middle";

        // item 1
        ctx.strokeStyle = "rgba(125,211,252,0.95)";
        ctx.lineWidth = 2.2;
        ctx.beginPath();
        ctx.moveTo(lx+12, ly+15);
        ctx.lineTo(lx+44, ly+15);
        ctx.stroke();
        ctx.fillStyle = "rgba(185,196,230,0.92)";
        ctx.fillText("P_rx(L) = 0 − 6 − 0.5L (dBm)", lx+54, ly+15);

        // item 2
        ctx.setLineDash([6,5]);
        ctx.strokeStyle = "rgba(251,113,133,0.90)";
        ctx.lineWidth = 1.6;
        ctx.beginPath();
        ctx.moveTo(lx+12, ly+32);
        ctx.lineTo(lx+44, ly+32);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = "rgba(185,196,230,0.92)";
        ctx.fillText("Sensitivity S = −20 dBm", lx+54, ly+32);
      }

      function roundRect(c, x, y, w, h, r){
        const rr = Math.min(r, w/2, h/2);
        c.beginPath();
        c.moveTo(x+rr, y);
        c.arcTo(x+w, y, x+w, y+h, rr);
        c.arcTo(x+w, y+h, x, y+h, rr);
        c.arcTo(x, y+h, x, y, rr);
        c.arcTo(x, y, x+w, y, rr);
        c.closePath();
      }

      window.addEventListener('resize', resizeCanvas, {passive:true});
      resizeCanvas();
    })();
  </script>
</body>
</html>
