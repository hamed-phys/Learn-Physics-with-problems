<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Wavelength-Routed WDM Ring: 4 Nodes, 6 Channels — Add/Drop Assignment</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#101a33;
      --card:#0f1730;
      --ink:#e9eefc;
      --muted:#b8c2e6;
      --faint:#8ea0d6;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 18px 50px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--ink);
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(125,211,252,.18), transparent 55%),
        radial-gradient(900px 700px at 110% 10%, rgba(167,139,250,.16), transparent 55%),
        radial-gradient(900px 700px at 40% 120%, rgba(52,211,153,.10), transparent 55%),
        linear-gradient(180deg, var(--bg), #060913 70%);
      line-height:1.55;
    }

    header{
      padding: clamp(18px, 3.2vw, 34px) clamp(16px, 4vw, 46px);
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(16,26,51,.85), rgba(16,26,51,.55));
      backdrop-filter: blur(10px);
      position:relative;
    }
    header .kicker{
      color: var(--accent);
      letter-spacing:.12em;
      text-transform:uppercase;
      font-weight:700;
      font-size: .78rem;
    }
    header h1{
      margin:.35rem 0 .6rem 0;
      font-size: clamp(1.55rem, 3.2vw, 2.35rem);
      line-height:1.15;
    }
    header p{
      margin:0;
      color: var(--muted);
      max-width: 72ch;
    }

    main{
      display:grid;
      grid-template-columns: 1fr;
      gap: 18px;
      padding: clamp(14px, 2.4vw, 28px) clamp(14px, 4vw, 46px) 64px;
      max-width: 1100px;
      margin: 0 auto;
    }

    .layout{
      display:grid;
      grid-template-columns: 310px 1fr;
      gap: 18px;
      align-items:start;
    }
    @media (max-width: 920px){
      .layout{grid-template-columns: 1fr}
    }

    nav.toc{
      position: sticky;
      top: 14px;
      align-self:start;
      background: linear-gradient(180deg, rgba(16,26,51,.78), rgba(16,26,51,.58));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 10px;
    }
    nav.toc h2{
      margin:0 0 10px;
      font-size: .95rem;
      letter-spacing:.02em;
      color: var(--ink);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    nav.toc a{
      display:block;
      padding: 8px 10px;
      margin: 4px 0;
      border-radius: 12px;
      color: var(--muted);
      text-decoration:none;
      border: 1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size: .93rem;
    }
    nav.toc a:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.22);
      color: var(--ink);
      transform: translateY(-1px);
    }
    .toc .mini{
      color: var(--faint);
      font-size:.84rem;
      margin: 8px 0 2px;
    }

    article{
      background: linear-gradient(180deg, rgba(16,26,51,.62), rgba(16,26,51,.38));
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .content{
      padding: clamp(16px, 2.4vw, 26px);
    }

    section{
      padding: 4px 0 0;
    }
    section + section{
      margin-top: 18px;
      padding-top: 18px;
      border-top: 1px dashed rgba(255,255,255,.14);
    }
    h2{
      margin: 0 0 10px;
      font-size: clamp(1.15rem, 1.55vw, 1.35rem);
      letter-spacing:.01em;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 1.02rem;
      color: var(--ink);
    }
    p{margin: 8px 0; color: var(--muted)}
    ul{margin: 8px 0 8px 20px; color: var(--muted)}
    li{margin: 6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 780px){ .grid2{grid-template-columns:1fr} }

    .card{
      background: linear-gradient(180deg, rgba(15,23,48,.86), rgba(15,23,48,.62));
      border: 1px solid rgba(255,255,255,.12);
      border-radius: var(--radius);
      padding: 14px 14px 12px;
    }
    .card strong{color: var(--ink)}
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:.82rem;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      color: var(--ink);
      background: rgba(255,255,255,.06);
    }
    .tag .dot{
      width:10px; height:10px; border-radius:50%;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(125,211,252,.14);
    }

    .callout{
      border-radius: var(--radius);
      border: 1px solid rgba(255,255,255,.14);
      padding: 12px 14px;
      background: rgba(255,255,255,.05);
      position:relative;
      overflow:hidden;
    }
    .callout::before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(700px 120px at 10% 10%, rgba(125,211,252,.12), transparent 55%),
                  radial-gradient(700px 120px at 90% 0%, rgba(167,139,250,.10), transparent 55%);
      pointer-events:none;
    }
    .callout > *{position:relative}
    .callout h3{margin-top:0}
    .assumptions{border-color: rgba(52,211,153,.25)}
    .assumptions .tag .dot{background: var(--good); box-shadow: 0 0 0 3px rgba(52,211,153,.16)}
    .mistakes{border-color: rgba(251,191,36,.26)}
    .mistakes .tag .dot{background: var(--warn); box-shadow: 0 0 0 3px rgba(251,191,36,.16)}
    .equations{border-color: rgba(125,211,252,.26)}
    .final{border-color: rgba(52,211,153,.30)}
    .final .tag .dot{background: var(--good); box-shadow: 0 0 0 3px rgba(52,211,153,.16)}

    .eqbox{
      margin-top:10px;
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 14px;
      padding: 10px 10px 10px;
    }
    pre, code{
      font-family: var(--mono);
      font-size: .92rem;
      color: #eef2ff;
      white-space: pre-wrap;
      word-break: break-word;
      margin:0;
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    button.copy{
      appearance:none;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: var(--ink);
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 650;
      font-size: .92rem;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.24);
    }
    button.copy:active{transform: translateY(0px) scale(.99)}
    .toast{
      display:inline-block;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid rgba(52,211,153,.24);
      background: rgba(52,211,153,.10);
      color: var(--ink);
      font-size:.9rem;
      opacity:0;
      transform: translateY(4px);
      transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{opacity:1; transform: translateY(0px)}

    table{
      width:100%;
      border-collapse: collapse;
      margin: 10px 0 0;
      overflow:hidden;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
    }
    th, td{
      padding: 10px 10px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      text-align:left;
      vertical-align:top;
      color: var(--muted);
      font-size:.94rem;
    }
    th{color: var(--ink); background: rgba(255,255,255,.06); font-weight:750}
    tr:last-child td{border-bottom:none}
    .small{font-size:.92rem; color: var(--faint)}
    details{
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      padding: 10px 12px;
      background: rgba(255,255,255,.04);
      margin: 10px 0 0;
    }
    summary{
      cursor:pointer;
      color: var(--ink);
      font-weight: 740;
      letter-spacing:.01em;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    summary::after{
      content:"▾";
      float:right;
      color: var(--faint);
      transition: transform .15s ease;
    }
    details[open] summary::after{transform: rotate(180deg)}
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      color: var(--ink);
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      padding: 10px 12px;
      border-radius: 14px;
      margin-top: 14px;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .backtop:hover{
      transform: translateY(-1px);
      background: rgba(167,139,250,.10);
      border-color: rgba(167,139,250,.24);
    }

    footer{
      max-width:1100px;
      margin: 0 auto;
      padding: 18px clamp(14px, 4vw, 46px) 40px;
      color: var(--faint);
    }

    /* Micro animation */
    @media (prefers-reduced-motion: no-preference){
      .content{animation: fadeUp .35s ease both}
      @keyframes fadeUp{
        from{opacity:.01; transform: translateY(8px)}
        to{opacity:1; transform: translateY(0)}
      }
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, nav.toc{position:static; backdrop-filter:none; box-shadow:none}
      header{background:#fff; border-bottom: 1px solid #bbb}
      article{box-shadow:none; border: 1px solid #bbb; background:#fff}
      .card, .callout, details, .eqbox{background:#fff; border-color:#bbb}
      th{background:#f2f2f2}
      p, li, td{color:#111}
      .actions, .toast, .backtop{display:none !important}
      section{break-inside: avoid-page}
      h2{break-after: avoid}
    }
  </style>
</head>

<body>
  <a id="top"></a>
  <header>
    <div class="kicker">Photonics Networks • WDM Routing • Add–Drop Multiplexing</div>
    <h1>4-Node, 6-Channel WDM Ring: Assign Add/Drop Wavelength Sets So Any Pair Can Communicate</h1>
    <p>
      We design a wavelength plan for a wavelength-routed ring network where each node can add/drop only
      <strong>3</strong> wavelengths out of <strong>6</strong>, while all other wavelengths pass through.
      The goal is full pairwise connectivity with a clean “no intermediate sharing” constraint.
    </p>
  </header>

  <main>
    <div class="layout">
      <nav class="toc" aria-label="Table of contents">
        <h2>Table of Contents <span class="small">sticky</span></h2>
        <div class="mini">Jump to:</div>
        <a href="#quick">Quick Summary</a>
        <a href="#primer">PART 0 — Concept Primer</a>
        <a href="#industry">PART 0B — Industry & Applied Physics</a>
        <a href="#analysis">PART 1 — Problem Analysis</a>
        <a href="#strategy">PART 2 — Strategy & Tips</a>
        <a href="#solution">PART 3 — Full Solution</a>
        <a href="#deeper">PART 4 — Deeper Understanding</a>
        <a href="#plot">PART 5 — Optional Plot Guide</a>
        <a href="#final">Final Answer (copy)</a>
      </nav>

      <article>
        <div class="content">

          <section id="quick">
            <h2>Quick Summary</h2>
            <ul>
              <li><strong>What this is:</strong> A wavelength assignment problem for a <strong>4-node</strong> WDM <strong>ring</strong> with <strong>6 wavelengths</strong> (channels).</li>
              <li><strong>Key physics/engineering idea:</strong> In wavelength routing, a node can communicate on wavelengths it can <em>add/drop</em>; other wavelengths are transparently <em>passed through</em>.</li>
              <li><strong>Constraint:</strong> Each node can add/drop exactly <strong>3</strong> wavelengths; the other <strong>3</strong> must pass through.</li>
              <li><strong>Connectivity requirement:</strong> Every node must share <strong>one</strong> add/drop wavelength with each of the other three nodes (so any pair can talk).</li>
              <li><strong>Routing cleanliness requirement:</strong> The shared wavelength for a pair must <strong>not</strong> be add/dropped by the <em>intermediate</em> node(s) between them on the ring.</li>
              <li><strong>Governing “design equation” (combinatorial):</strong> Map each wavelength to a <strong>unique node pair</strong> (edge labeling of a 4-node complete graph).</li>
              <li><strong>Result type:</strong> <strong>Symbolic/discrete</strong> (a wavelength plan). Physically it means: each pair gets an exclusive optical channel, avoiding unintended add/drop at intermediate nodes.</li>
            </ul>
          </section>

          <section id="primer">
            <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

            <div class="grid2">
              <div class="card">
                <h3>Core definitions (symbols + typical SI units)</h3>
                <ul>
                  <li><strong>WDM channel (wavelength)</strong> λ<sub>k</sub> — optical carrier wavelength (meters, commonly nm in telecom).</li>
                  <li><strong>Ring network</strong> — nodes connected in a cycle; light circulates along fiber spans (length in m; loss in dB).</li>
                  <li><strong>Add–drop multiplexer (ADM)</strong> — device that can <em>extract</em> (“drop”) selected wavelengths and/or <em>insert</em> (“add”) them back.</li>
                  <li><strong>Add/drop set</strong> A(i) — set of wavelengths node <em>i</em> can add/drop (subset of {λ<sub>1</sub>,…,λ<sub>6</sub>}).</li>
                  <li><strong>Pass-through</strong> — wavelengths not in A(i) propagate through node i with minimal disturbance (ideally only insertion loss).</li>
                </ul>
              </div>

              <div class="card">
                <h3>Physical meaning (intuition)</h3>
                <ul>
                  <li>If node i can add/drop λ, it can “touch” that optical channel: insert its own data or receive data carried on λ.</li>
                  <li>If node i cannot add/drop λ, it should behave like a transparent segment for that channel—critical for wavelength routing.</li>
                  <li>Assigning wavelengths is like allocating “dedicated lanes” on a ring highway; ADMs are on-ramps/off-ramps for specific lanes.</li>
                </ul>
              </div>
            </div>

            <div class="callout equations" style="margin-top:14px">
              <div class="tag"><span class="dot"></span><strong>Key design statement</strong></div>
              <p>
                For a pair of nodes (i, j) to communicate directly on a single hop wavelength route, there must exist a wavelength λ such that:
              </p>
              <div class="eqbox">
                <pre id="eq1">λ ∈ A(i) ∩ A(j)  and  for every intermediate node m on the ring path between i and j:  λ ∉ A(m).</pre>
              </div>
              <div class="actions">
                <button class="copy" data-copy-target="eq1">Copy key equation</button>
                <span class="toast" id="toast1" aria-live="polite">Copied.</span>
              </div>
              <p class="small">
                This is a <em>routing cleanliness</em> condition: intermediate nodes must not “steal” (add/drop) the pair’s wavelength.
              </p>
            </div>

            <h3>Validity conditions & common approximations</h3>
            <ul>
              <li><strong>Ideal ADM selectivity:</strong> a wavelength is either add/dropped or perfectly passed through (in practice: finite isolation, leakage).</li>
              <li><strong>No wavelength conversion:</strong> data stays on the same λ end-to-end (classic wavelength-routed WDM).</li>
              <li><strong>Single shared channel per pair:</strong> this problem enforces exactly one common add/drop channel between any two nodes.</li>
            </ul>

            <h3>Mini intuition examples (minimal algebra)</h3>
            <ul>
              <li><strong>Example 1 (good):</strong> If only nodes 1 and 3 can add/drop λ<sub>2</sub>, then any λ<sub>2</sub> traffic between them passes transparently through node 2.</li>
              <li><strong>Example 2 (bad):</strong> If node 2 also can add/drop λ<sub>2</sub>, then node 2 could unintentionally drop/insert on that wavelength, breaking the “exclusive channel” idea.</li>
            </ul>

            <div class="callout mistakes">
              <div class="tag"><span class="dot"></span><strong>What to watch for (pitfalls)</strong></div>
              <ul>
                <li><strong>Accidental triple sharing:</strong> giving the same wavelength to three nodes violates “not common with nodes in-between.”</li>
                <li><strong>Not enough channels:</strong> check counts: each node needs 3 pairwise connections → 3 wavelengths; total pairs in 4 nodes = 6.</li>
                <li><strong>Confusing ring adjacency with pairwise connectivity:</strong> the requirement is for <em>every pair</em>, not only neighbors.</li>
              </ul>
            </div>
          </section>

          <section id="industry">
            <h2>PART 0B — Industry & Applied Physics Perspective</h2>

            <div class="grid2">
              <div class="card">
                <h3>Where this appears in industry (concrete areas)</h3>
                <ul>
                  <li><strong>Metro/access optical rings:</strong> city networks interconnecting central offices, data centers, and aggregation sites.</li>
                  <li><strong>Industrial campuses:</strong> factories/refineries with ring topologies for resilience (failover rerouting).</li>
                  <li><strong>Sensor/monitoring rings:</strong> distributed fiber sensing or instrumentation links that share WDM channels.</li>
                </ul>
              </div>
              <div class="card">
                <h3>Why engineers care</h3>
                <ul>
                  <li><strong>Performance:</strong> fewer collisions/interference when channels are cleanly partitioned.</li>
                  <li><strong>Reliability:</strong> predictable routing reduces troubleshooting complexity; helps meet SLAs.</li>
                  <li><strong>Cost & manufacturability:</strong> limits on ADM ports/filters motivate using only a subset of wavelengths per node.</li>
                </ul>
              </div>
            </div>

            <h3>Typical measurement / validation in practice</h3>
            <ul>
              <li><strong>Optical spectrum analyzer (OSA):</strong> verify which wavelengths are present at each node and check leakage/isolation.</li>
              <li><strong>Insertion loss & isolation tests:</strong> measure pass-through loss per channel and add/drop filter isolation (dB).</li>
              <li><strong>Bit-error-rate (BER) tests:</strong> validate end-to-end channel quality under load.</li>
            </ul>

            <h3>Design trade-offs and constraints (real non-idealities)</h3>
            <ul>
              <li><strong>Filter roll-off & crosstalk:</strong> imperfect channel isolation can cause intermediate nodes to partially tap power.</li>
              <li><strong>Power budget:</strong> each ADM adds insertion loss; more “pass-through” nodes increases loss and OSNR demands.</li>
              <li><strong>Tolerances & drift:</strong> wavelength grid alignment (temperature drift, laser accuracy) affects add/drop selectivity.</li>
            </ul>

            <details>
              <summary>From lab to product: adapting the idealized model</summary>
              <p>
                The textbook “binary” add/drop assumption is upgraded in products to include: finite extinction ratios,
                channel passband ripple, polarization dependence, and dynamic power equalization. Engineers often add
                guard bands, specify tighter laser wavelength tolerances, and validate worst-case cascaded filter responses.
                The assignment strategy here remains valuable because it <em>minimizes unintended interactions</em>
                by keeping a pair’s wavelength exclusive to the two endpoints.
              </p>
            </details>
          </section>

          <section id="analysis">
            <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

            <h3>Restate the problem (in plain words)</h3>
            <p>
              We have a ring with 4 nodes and 6 WDM wavelengths (λ<sub>1</sub>…λ<sub>6</sub>). Each node’s ADM can add/drop
              exactly 3 wavelengths assigned to that node; the other 3 wavelengths must pass through that node.
              Node 1 is given as an example: it may add/drop λ<sub>1</sub>, λ<sub>2</sub>, λ<sub>3</sub> and passes λ<sub>4</sub>, λ<sub>5</sub>, λ<sub>6</sub>.
              We must allocate add/drop sets for nodes 2, 3, and 4 so that:
              (i) any node can communicate with any other node, and
              (ii) each pair of nodes shares exactly one add/drop wavelength that is not shared by intermediate node(s) between them on the ring.
            </p>

            <div class="grid2">
              <div class="card">
                <h3>Given</h3>
                <ul>
                  <li>Nodes: 4 (labeled 1–4) in a ring order 1–2–3–4–1.</li>
                  <li>Wavelengths: 6 channels λ<sub>1</sub>…λ<sub>6</sub>.</li>
                  <li>Per-node capability: each node can add/drop 3 wavelengths.</li>
                  <li>Node 1 add/drop example: A(1) = {λ<sub>1</sub>, λ<sub>2</sub>, λ<sub>3</sub>}.</li>
                </ul>
              </div>
              <div class="card">
                <h3>Unknowns / what must be found</h3>
                <ul>
                  <li>Find A(2), A(3), A(4), each of size 3.</li>
                  <li>Ensure every pair (i,j) shares exactly one wavelength (one element in A(i)∩A(j)).</li>
                  <li>For non-adjacent pairs, ensure intermediate node(s) do not share that wavelength.</li>
                </ul>
              </div>
            </div>

            <h3>Relevant principles (and why they apply)</h3>
            <ul>
              <li><strong>Wavelength routing logic:</strong> communication on wavelength λ between nodes i and j requires λ add/dropped at both endpoints.</li>
              <li><strong>Exclusivity to avoid intermediate access:</strong> if an intermediate node also add/drops λ, it could intercept or perturb that channel—disallowed by the problem.</li>
              <li><strong>Counting/pair structure:</strong> 4 nodes have 6 distinct pairs; we also have 6 wavelengths—suggesting a one-to-one assignment between wavelengths and node pairs.</li>
            </ul>

            <div class="callout assumptions">
              <div class="tag"><span class="dot"></span><strong>Assumptions (explicit)</strong></div>
              <ul>
                <li>Each wavelength can be treated as an independent channel (no nonlinear mixing considered here).</li>
                <li>ADMs are ideal selectors: if λ is not assigned to a node, it passes through unaffected (conceptual model).</li>
                <li>We interpret “one add–drop channel in common with each other node” as <strong>exactly one</strong> shared wavelength per pair.</li>
              </ul>
            </div>

            <h3>Possible approaches (compare 2–3)</h3>
            <ul>
              <li><strong>Approach A: Direct constructive assignment by pairs (best).</strong> Assign each wavelength to exactly one node pair. Then each node’s set is the three wavelengths corresponding to its three pairs.</li>
              <li><strong>Approach B: Trial-and-error set building.</strong> Start from A(1), guess A(2), A(3), A(4) and check intersections—works but is slower and error-prone.</li>
              <li><strong>Approach C: Graph model.</strong> Represent nodes as vertices of K<sub>4</sub>; label each edge with a wavelength. This is equivalent to Approach A but makes the logic clearer.</li>
            </ul>
            <p>
              <strong>Chosen approach:</strong> Approach A/C (edge labeling of K<sub>4</sub>) because it guarantees the “no intermediate sharing” requirement automatically when each wavelength belongs to only one pair.
            </p>
          </section>

          <section id="strategy">
            <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

            <ol>
              <li><strong>Goal:</strong> enforce exactly one shared wavelength per node pair. <br><span class="small">Tool:</span> count node pairs in 4 nodes = 6.</li>
              <li><strong>Goal:</strong> match the 6 wavelengths to the 6 node pairs one-to-one. <br><span class="small">Tool:</span> construct a mapping λ ↔ (i,j).</li>
              <li><strong>Goal:</strong> respect the given node-1 example set. <br><span class="small">Tool:</span> assign λ<sub>1</sub>, λ<sub>2</sub>, λ<sub>3</sub> to the three pairs involving node 1.</li>
              <li><strong>Goal:</strong> assign remaining wavelengths to the remaining pairs among nodes 2,3,4. <br><span class="small">Tool:</span> choose any bijection for λ<sub>4</sub>, λ<sub>5</sub>, λ<sub>6</sub> to (2,3), (2,4), (3,4).</li>
              <li><strong>Goal:</strong> read off each node’s add/drop set A(i) as the three wavelengths on edges incident to node i. <br><span class="small">Meaning:</span> node i can talk to each other node on its corresponding shared wavelength.</li>
              <li><strong>Goal:</strong> verify constraints: set sizes, pairwise intersections, and “intermediate node” condition for non-adjacent pairs.</li>
            </ol>

            <div class="callout mistakes">
              <div class="tag"><span class="dot"></span><strong>Common mistakes</strong></div>
              <ul>
                <li>Reusing a wavelength for two different pairs (breaks uniqueness; creates extra shared channels).</li>
                <li>Accidentally putting the same wavelength in three nodes’ sets (violates “not common with in-between nodes”).</li>
                <li>Forgetting that each node must end up with exactly 3 add/drop wavelengths.</li>
              </ul>
            </div>
          </section>

          <section id="solution">
            <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

            <h3>Qualitative expectation (before calculating)</h3>
            <p>
              Since there are 6 distinct node pairs and exactly 6 wavelengths, the cleanest solution is to give each pair
              its own unique wavelength. Then every node must have exactly 3 wavelengths—one for each neighbor/pair it communicates with.
              This also naturally prevents intermediate nodes from sharing the same wavelength with that pair.
            </p>

            <h3>Step 1: List all node pairs</h3>
            <p>
              With nodes {1,2,3,4}, the distinct unordered pairs are:
            </p>
            <div class="eqbox">
              <pre id="eq2">(1,2), (1,3), (1,4), (2,3), (2,4), (3,4)    ← total = 6 pairs</pre>
            </div>

            <h3>Step 2: Use the given information about node 1</h3>
            <p>
              We are told node 1 can add/drop λ<sub>1</sub>, λ<sub>2</sub>, λ<sub>3</sub>. Since node 1 must share exactly one wavelength with
              each of nodes 2, 3, and 4, we assign those three wavelengths to the three pairs involving node 1:
            </p>
            <div class="callout equations">
              <div class="tag"><span class="dot"></span><strong>Pair–wavelength assignment (anchored by node 1)</strong></div>
              <div class="eqbox">
                <pre id="eq3">Assign:  (1,2) ↔ λ1,   (1,3) ↔ λ2,   (1,4) ↔ λ3</pre>
              </div>
              <div class="actions">
                <button class="copy" data-copy-target="eq3">Copy mapping (node 1 pairs)</button>
                <span class="toast" id="toast3" aria-live="polite">Copied.</span>
              </div>
              <p class="small">
                This guarantees A(1) = {λ1, λ2, λ3} as required, and ensures node 1 shares exactly one wavelength with each other node.
              </p>
            </div>

            <h3>Step 3: Assign the remaining wavelengths to the remaining pairs</h3>
            <p>
              The remaining pairs among nodes 2, 3, and 4 are (2,3), (2,4), (3,4). The remaining wavelengths are λ<sub>4</sub>, λ<sub>5</sub>, λ<sub>6</sub>.
              Any one-to-one assignment works. Choose:
            </p>
            <div class="eqbox">
              <pre id="eq4">Assign:  (2,3) ↔ λ4,   (2,4) ↔ λ5,   (3,4) ↔ λ6</pre>
            </div>

            <h3>Step 4: Read off each node’s add/drop set A(i)</h3>
            <p>
              A node must add/drop exactly the wavelengths on the three pairs (edges) connected to it:
            </p>

            <table aria-label="Add/drop wavelength sets by node">
              <thead>
                <tr>
                  <th>Node i</th>
                  <th>Add/drop set A(i)</th>
                  <th>Pass-through set (the other 3 wavelengths)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>1</strong></td>
                  <td>A(1) = {λ1, λ2, λ3}</td>
                  <td>{λ4, λ5, λ6}</td>
                </tr>
                <tr>
                  <td><strong>2</strong></td>
                  <td>A(2) = {λ1, λ4, λ5}</td>
                  <td>{λ2, λ3, λ6}</td>
                </tr>
                <tr>
                  <td><strong>3</strong></td>
                  <td>A(3) = {λ2, λ4, λ6}</td>
                  <td>{λ1, λ3, λ5}</td>
                </tr>
                <tr>
                  <td><strong>4</strong></td>
                  <td>A(4) = {λ3, λ5, λ6}</td>
                  <td>{λ1, λ2, λ4}</td>
                </tr>
              </tbody>
            </table>

            <h3>Step 5: Verify all constraints</h3>

            <div class="card">
              <h3 style="margin-top:0">Check A: Each node has exactly 3 add/drop wavelengths</h3>
              <p>Each A(i) listed above contains exactly 3 wavelengths. ✔️</p>

              <h3>Check B: Each node pair shares exactly one wavelength</h3>
              <p>
                Compute intersections (conceptually):
              </p>
              <div class="eqbox">
                <pre id="eq5">A(1)∩A(2)={λ1},  A(1)∩A(3)={λ2},  A(1)∩A(4)={λ3},
A(2)∩A(3)={λ4},  A(2)∩A(4)={λ5},  A(3)∩A(4)={λ6}.</pre>
              </div>
              <p>Each intersection is a single wavelength. ✔️</p>

              <h3>Check C: “Not common with nodes in-between” for non-adjacent pairs</h3>
              <ul>
                <li>Nodes 1 and 3 share λ2. The intermediate node on the ring path 1–2–3 is node 2, and λ2 ∉ A(2). ✔️</li>
                <li>Nodes 2 and 4 share λ5. The intermediate node on the ring path 2–3–4 is node 3, and λ5 ∉ A(3). ✔️</li>
              </ul>
              <p class="small">
                For adjacent pairs (1,2), (2,3), (3,4), (4,1) there is no intermediate node, so the condition is automatically satisfied.
              </p>
            </div>

            <div class="callout final" style="margin-top:14px" id="final">
              <div class="tag"><span class="dot"></span><strong>Final Answer</strong></div>
              <p>
                One valid wavelength allocation (consistent with node 1 adding/dropping λ1, λ2, λ3) is:
              </p>
              <div class="eqbox">
                <pre id="ans">A(1) = {λ1, λ2, λ3}
A(2) = {λ1, λ4, λ5}
A(3) = {λ2, λ4, λ6}
A(4) = {λ3, λ5, λ6}</pre>
              </div>
              <div class="actions">
                <button class="copy" data-copy-target="ans">Copy final answer</button>
                <span class="toast" id="toastAns" aria-live="polite">Copied.</span>
              </div>
              <p class="small">
                Interpretation: each wavelength is exclusive to exactly one node pair, so any pair can communicate on its own channel while intermediate nodes remain transparent on that channel.
              </p>
            </div>

            <h3>Sanity checks</h3>
            <ul>
              <li><strong>Counting:</strong> 6 node pairs ↔ 6 wavelengths (perfect match).</li>
              <li><strong>Dimensions/units:</strong> This is a discrete assignment problem; wavelengths label channels (typically in nm), but no numerical propagation calculation is required.</li>
              <li><strong>Limiting-case reasoning:</strong> If you tried to reuse one wavelength for two pairs, some node would either (i) share two common wavelengths with another node (violating “one in common”) or (ii) an intermediate node would share the wavelength (violating the “in-between” rule).</li>
              <li><strong>Physical meaning:</strong> Exclusive pair wavelengths reduce accidental add/drop interactions, similar to dedicated VLANs but in the optical wavelength domain.</li>
            </ul>

            <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
          </section>

          <section id="deeper">
            <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

            <h3>Re-interpretation: what controls what?</h3>
            <ul>
              <li><strong>Edge labels (λ ↔ pair):</strong> determine which two nodes can “touch” a channel.</li>
              <li><strong>Node sets A(i):</strong> are forced by connectivity—each node must include exactly one wavelength per other node.</li>
              <li><strong>Intermediate-node exclusion:</strong> is automatically satisfied when each wavelength is assigned to exactly one pair (no third node can share it).</li>
            </ul>

            <h3>Parameter dependence (qualitative)</h3>
            <ul>
              <li>If the network had <strong>N</strong> nodes, the number of node pairs is N(N−1)/2. A “pair-exclusive wavelength” plan would need that many wavelengths.</li>
              <li>If each node can add/drop only <strong>K</strong> wavelengths, then pair-exclusive designs require K = N−1 at each node (each node must reach all others).</li>
              <li>In real systems, if wavelength count is limited, engineers introduce <strong>spatial reuse</strong> and more complex routing (or wavelength conversion), but then intermediate-node constraints become harder.</li>
            </ul>

            <h3>Alternative derivation idea (brief but meaningful)</h3>
            <p>
              You can view this as a graph problem: create the complete graph K<sub>4</sub> on nodes {1,2,3,4}.
              Label each of its 6 edges with a distinct wavelength. Then A(i) is simply the set of labels on edges incident to node i.
              This guarantees exactly one shared wavelength per pair (the edge between them).
            </p>

            <h3>Concept check (self-test)</h3>
            <ul>
              <li><strong>Q:</strong> Why do we need 6 wavelengths for 4 nodes in this “exclusive pair” plan? <strong>A:</strong> Because there are 6 unique node pairs, and each pair gets a unique channel.</li>
              <li><strong>Q:</strong> What breaks if node 2 also add/drops λ2 in our solution? <strong>A:</strong> Then nodes 1 and 3 would share λ2, but the intermediate node 2 would also share it, violating the “not common with in-between nodes” requirement.</li>
              <li><strong>Q:</strong> Can we permute λ4, λ5, λ6 among pairs (2,3), (2,4), (3,4)? <strong>A:</strong> Yes; any one-to-one assignment works as long as each pair has its own wavelength and node 1’s set remains {λ1,λ2,λ3}.</li>
              <li><strong>Q:</strong> What is the engineering benefit of exclusivity? <strong>A:</strong> Cleaner isolation: intermediate nodes are transparent for that channel, reducing inadvertent drops and simplifying operations.</li>
            </ul>

            <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
          </section>

          <section id="plot">
            <h2>PART 5 — Optional Plot Guide</h2>
            <p>
              A plot is not necessary here because the task is <strong>combinatorial (discrete)</strong> rather than a numerical dependence
              (e.g., loss vs. distance or OSNR vs. number of nodes). The key learning outcome is the wavelength-to-pair mapping and the resulting add/drop sets.
            </p>
          </section>

        </div>
      </article>
    </div>
  </main>

  <footer>
    <div>
      <strong>Note:</strong> Many equivalent solutions exist (any permutation of wavelength labels across the 6 node pairs),
      as long as each pair has exactly one unique wavelength and node 1 retains its given set.
    </div>
  </footer>

  <script>
    (function(){
      function copyTextFromEl(el){
        const text = el ? el.textContent.replace(/\u00A0/g, " ").trim() : "";
        return navigator.clipboard.writeText(text);
      }

      function showToast(toastEl){
        if(!toastEl) return;
        toastEl.classList.add("show");
        clearTimeout(toastEl._t);
        toastEl._t = setTimeout(()=>toastEl.classList.remove("show"), 1200);
      }

      document.querySelectorAll("button.copy").forEach((btn, idx)=>{
        btn.addEventListener("click", async ()=>{
          const id = btn.getAttribute("data-copy-target");
          const target = document.getElementById(id);
          const toast =
            btn.parentElement.querySelector(".toast") ||
            document.getElementById("toastAns") ||
            document.getElementById("toast1");

          try{
            await copyTextFromEl(target);
            showToast(toast);
          }catch(e){
            // Fallback: create temporary textarea
            try{
              const ta = document.createElement("textarea");
              ta.value = (target ? target.textContent : "").trim();
              ta.setAttribute("readonly","");
              ta.style.position="fixed";
              ta.style.left="-9999px";
              document.body.appendChild(ta);
              ta.select();
              document.execCommand("copy");
              document.body.removeChild(ta);
              showToast(toast);
            }catch(_){
              if(toast){
                toast.textContent = "Copy failed (browser blocked).";
                showToast(toast);
                setTimeout(()=>{ toast.textContent="Copied."; }, 1400);
              }
            }
          }
        });
      });
    })();
  </script>
</body>
</html>
