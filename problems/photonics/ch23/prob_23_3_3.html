<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rectangular Pulse Through a Dispersive Fiber: From Rectangle to Sinc (Chirp Filter Model)</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#101827;
      --panel2:#0f1624;
      --text:#e9eef7;
      --muted:#b8c4d9;
      --faint:#7f8aa3;
      --accent:#76b7ff;
      --accent2:#9bffcf;
      --warn:#ffcc66;
      --danger:#ff6b6b;
      --ok:#4be38a;
      --border:rgba(255,255,255,0.10);
      --shadow: 0 18px 50px rgba(0,0,0,0.40);
      --radius:18px;
      --radius2:14px;
      --maxw: 1100px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(118,183,255,0.18), transparent 60%),
        radial-gradient(900px 600px at 85% 12%, rgba(155,255,207,0.10), transparent 55%),
        radial-gradient(900px 700px at 70% 90%, rgba(255,204,102,0.08), transparent 55%),
        linear-gradient(180deg, #070a10 0%, #0b0f17 60%, #060810 100%);
      line-height:1.55;
    }

    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    code, pre{font-family:var(--mono)}
    pre{
      margin:0;
      padding:14px 14px;
      background: rgba(255,255,255,0.05);
      border:1px solid var(--border);
      border-radius:12px;
      overflow:auto;
      white-space:pre-wrap;
      word-break:break-word;
    }

    header{
      position:relative;
      padding: 34px 18px 18px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), transparent);
    }
    .wrap{max-width:var(--maxw); margin:0 auto}
    .hero{
      display:grid;
      grid-template-columns: 1.2fr 0.8fr;
      gap:18px;
      align-items:start;
    }
    h1{
      margin:0 0 10px;
      font-size: clamp(1.45rem, 1.2rem + 1.2vw, 2.25rem);
      letter-spacing:0.2px;
      line-height:1.18;
    }
    .subtitle{
      color:var(--muted);
      margin:0;
      font-size: clamp(0.98rem, 0.95rem + 0.3vw, 1.1rem);
    }
    .meta{
      margin-top:12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      color:var(--faint);
      font-size:0.92rem;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      background: rgba(255,255,255,0.06);
      border:1px solid var(--border);
      box-shadow: 0 10px 25px rgba(0,0,0,0.18);
      backdrop-filter: blur(8px);
    }
    .dot{width:9px;height:9px;border-radius:50%; background:var(--accent)}
    .dot.g{background:var(--accent2)}
    .dot.y{background:var(--warn)}
    .dot.r{background:var(--danger)}

    main{padding: 18px 18px 44px}
    .grid{
      max-width:var(--maxw);
      margin: 0 auto;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap: 18px;
      align-items:start;
    }

    nav.toc{
      position: sticky;
      top: 12px;
      align-self:start;
      border-radius: var(--radius);
      background: rgba(16,24,39,0.72);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(10px);
      transform: translateZ(0);
    }
    .toc-head{
      padding: 14px 14px 10px;
      border-bottom:1px solid var(--border);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .toc-title{
      margin:0;
      font-size:0.98rem;
      color: var(--text);
      letter-spacing:0.2px;
    }
    .toc small{color:var(--faint)}
    .toc ul{list-style:none; padding: 10px 10px 14px; margin:0; display:grid; gap:6px}
    .toc a{
      display:block;
      padding: 8px 10px;
      border-radius: 12px;
      border:1px solid transparent;
      color: var(--muted);
      background: transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .toc a:hover{
      background: rgba(118,183,255,0.10);
      border-color: rgba(118,183,255,0.25);
      transform: translateY(-1px);
      text-decoration:none;
      color: var(--text);
    }

    article{
      border-radius: var(--radius);
      background: rgba(16,24,39,0.62);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }
    .section{
      padding: 18px 18px;
      border-top:1px solid var(--border);
    }
    .section:first-child{border-top:0}
    h2{
      margin:0 0 10px;
      font-size: clamp(1.15rem, 1.0rem + 0.6vw, 1.55rem);
      letter-spacing:0.2px;
    }
    h3{
      margin: 14px 0 8px;
      font-size:1.05rem;
      color:var(--text);
    }
    p{margin: 10px 0; color: var(--muted)}
    .muted{color:var(--muted)}
    .faint{color:var(--faint)}
    .kicker{
      display:inline-flex;
      gap:10px;
      align-items:center;
      margin-bottom:8px;
      color: var(--faint);
      font-size:0.92rem;
      letter-spacing:0.25px;
      text-transform: uppercase;
    }
    .kline{height:1px; flex:1; background: linear-gradient(90deg, rgba(255,255,255,0.15), transparent)}
    .cards{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
      margin-top: 10px;
    }
    .card{
      grid-column: span 12;
      padding: 14px 14px;
      border-radius: var(--radius2);
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.05);
      box-shadow: 0 10px 26px rgba(0,0,0,0.20);
    }
    .card strong{color:var(--text)}
    .card ul{margin: 10px 0 0; padding-left: 18px; color:var(--muted)}
    .card li{margin: 6px 0}

    .callouts{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
      margin-top: 10px;
    }
    .callout{
      grid-column: span 12;
      border-radius: var(--radius2);
      padding: 14px 14px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.04));
      position:relative;
      overflow:hidden;
    }
    .callout::before{
      content:"";
      position:absolute;
      inset:-2px auto -2px -2px;
      width: 6px;
      border-radius: 18px;
      background: var(--accent);
      opacity:0.9;
    }
    .callout.warn::before{background: var(--warn)}
    .callout.danger::before{background: var(--danger)}
    .callout.ok::before{background: var(--ok)}
    .callout h3{margin-top:0}
    .eqrow{
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-top: 10px;
    }
    .btn{
      cursor:pointer;
      user-select:none;
      border:1px solid rgba(255,255,255,0.16);
      background: rgba(255,255,255,0.07);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      font-size:0.9rem;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      display:inline-flex;
      gap:8px;
      align-items:center;
      white-space:nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: rgba(118,183,255,0.35);
      background: rgba(118,183,255,0.10);
    }
    .btn:active{transform: translateY(0px) scale(0.98)}
    .btn svg{width:16px;height:16px; opacity:0.9}

    details{
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
      border-radius: 14px;
      padding: 10px 12px;
      margin: 12px 0;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 650;
      letter-spacing:0.2px;
    }
    details p{margin:10px 0; color:var(--muted)}
    .two{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    figure{
      margin: 14px 0 0;
      padding: 12px;
      border-radius: var(--radius2);
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
    }
    figcaption{
      margin-top: 10px;
      color: var(--faint);
      font-size: 0.92rem;
    }
    canvas{
      width:100%;
      height: 340px;
      display:block;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(10,14,22,0.65);
    }

    .backtop{
      display:flex;
      justify-content:flex-end;
      margin-top: 14px;
    }

    footer{
      max-width:var(--maxw);
      margin: 18px auto 0;
      padding: 12px 18px 28px;
      color: var(--faint);
      font-size:0.92rem;
    }

    /* Responsive */
    @media (max-width: 980px){
      .hero{grid-template-columns: 1fr}
      .grid{grid-template-columns: 1fr}
      nav.toc{position:relative; top:auto}
      canvas{height: 300px}
    }
    @media (max-width: 560px){
      .two{grid-template-columns: 1fr}
      canvas{height: 280px}
      .pill{width:100%; justify-content:space-between}
    }

    /* Micro-animations (subtle) */
    @media (prefers-reduced-motion: no-preference){
      .card, .callout, nav.toc, article{
        animation: pop .28s ease-out both;
      }
      @keyframes pop{
        from{transform: translateY(6px); opacity:0}
        to{transform: translateY(0px); opacity:1}
      }
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, nav.toc, .btn, .backtop, canvas{display:none !important}
      article, .card, .callout, pre, details{box-shadow:none !important; background:#fff !important; color:#000 !important}
      p, li, .muted, .faint{color:#000 !important}
      .section{break-inside:avoid; page-break-inside:avoid}
      a{color:#000; text-decoration:underline}
    }
  </style>
</head>

<body>
<header id="top">
  <div class="wrap">
    <div class="hero">
      <div>
        <h1>Propagation of a Rectangular Pulse Through a Dispersive Optical Fiber (Chirp-Filter Model)</h1>
        <p class="subtitle">
          Show that a time-domain <strong>rectangle</strong> becomes a <strong>sinc</strong> after sufficiently long dispersive propagation,
          and derive the <strong>modified pulse width</strong> in terms of the chirp parameter <code>b</code> (or <code>D<sub>ν</sub> z</code>).
        </p>
        <div class="meta">
          <span class="pill"><span class="dot"></span> Applied photonics • dispersion as a “time lens”</span>
          <span class="pill"><span class="dot g"></span> Key result: sinc-shaped output in the far-dispersion limit</span>
          <span class="pill"><span class="dot y"></span> Width scaling: grows ∝ <code>|b|/τ</code> (or ∝ <code>D<sub>ν</sub> z / τ</code>)</span>
        </div>
      </div>
      <div class="card">
        <div class="kicker"><span>Problem</span><span class="kline"></span></div>
        <p class="muted" style="margin-top:8px">
          A rectangular pulse of width <code>τ</code> travels through an optical fiber modeled as a chirp filter with chirp parameter
          <code>b = D<sub>ν</sub> z / π</code>.
          Show that for sufficiently long distance <code>z</code>, the pulse shape changes from a rectangular function to a sinc function.
          Derive an expression for the modified pulse width.
        </p>
      </div>
    </div>
  </div>
</header>

<main>
  <div class="grid">
    <nav class="toc" aria-label="Table of contents">
      <div class="toc-head">
        <div>
          <p class="toc-title" style="margin:0">Table of Contents</p>
          <small class="faint">Sticky quick navigation</small>
        </div>
        <button class="btn" type="button" id="collapseTocBtn" title="Collapse/expand">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M8 10l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Toggle
        </button>
      </div>
      <ul id="tocList">
        <li><a href="#qs">Quick Summary</a></li>
        <li><a href="#p0">PART 0 — Concept Primer</a></li>
        <li><a href="#p0b">PART 0B — Industry &amp; Applied Physics Perspective</a></li>
        <li><a href="#p1">PART 1 — Problem Analysis</a></li>
        <li><a href="#p2">PART 2 — Strategy &amp; Tips</a></li>
        <li><a href="#p3">PART 3 — Full Solution</a></li>
        <li><a href="#p4">PART 4 — Deeper Understanding</a></li>
        <li><a href="#p5">PART 5 — Optional Plot Guide</a></li>
      </ul>
    </nav>

    <article>
      <!-- Quick Summary -->
      <section class="section" id="qs">
        <div class="kicker"><span>Quick Summary</span><span class="kline"></span></div>
        <ul class="muted" style="margin:10px 0 0; padding-left:18px">
          <li>This problem is about how <strong>chromatic dispersion</strong> in a fiber reshapes a short pulse.</li>
          <li>The fiber is modeled as a <strong>chirp (quadratic-phase) filter</strong> with parameter <code>b = D<sub>ν</sub> z / π</code>.</li>
          <li>In frequency domain, dispersion multiplies the spectrum by a <strong>quadratic phase</strong>:
            <code>H(ω) = exp(-j ω² b / 2)</code> (equivalent form used in many texts).</li>
          <li>For <strong>large |b|</strong> (long propagation), the output envelope becomes a <strong>scaled Fourier transform</strong> of the input (“dispersive Fourier transform”).</li>
          <li>A rectangular pulse has spectrum <code>∝ sinc(ω τ/2)</code>, so the output becomes <strong>sinc-shaped in time</strong>.</li>
          <li><strong>Modified width</strong> (main-lobe, between first zeros): <code>Δt ≈ 4π|b|/τ = 4|D<sub>ν</sub>| z / τ</code>.</li>
          <li>Result is <strong>symbolic</strong>: it tells how dispersion converts time shape and how width scales with <code>z</code>, <code>τ</code>, and dispersion strength.</li>
        </ul>

        <div class="callouts" style="margin-top:14px">
          <div class="callout ok">
            <h3>Key physics idea</h3>
            <p>
              “Long dispersion” turns the output <em>in time</em> into the input’s <em>in frequency</em> shape (up to scaling and chirp).
              That is why a time-rectangle becomes a time-sinc.
            </p>
          </div>
        </div>
      </section>

      <!-- PART 0 -->
      <section class="section" id="p0">
        <div class="kicker"><span>PART 0 — Concept Primer</span><span class="kline"></span></div>

        <h2>Dispersion as a Quadratic-Phase System</h2>

        <div class="cards">
          <div class="card">
            <strong>Core definitions (symbols &amp; SI units)</strong>
            <ul>
              <li><code>t</code> — time (s)</li>
              <li><code>ω</code> — angular frequency offset from carrier (rad/s)</li>
              <li><code>z</code> — propagation distance (m)</li>
              <li><code>τ</code> — input pulse width (s). Here: the rectangle duration.</li>
              <li><code>β(ω)</code> — propagation constant (rad/m)</li>
              <li><code>β''</code> — group-velocity-dispersion (GVD) coefficient: <code>β'' = d²β/dω²</code> (s²/m)</li>
              <li><code>D<sub>ν</sub></code> — “GVD coefficient” used in the prompt (units depend on definition; consistent with <code>b = D<sub>ν</sub> z / π</code>)</li>
              <li><code>b</code> — chirp (dispersion) parameter (s²). In the prompt: <code>b = D<sub>ν</sub> z / π</code>.</li>
              <li><code>rect(t/τ)</code> — rectangular function: 1 for <code>|t| ≤ τ/2</code>, 0 otherwise.</li>
              <li><code>sinc(x)</code> — normalized here as <code>sinc(x) = sin(x)/x</code>.</li>
            </ul>
          </div>

          <div class="card">
            <strong>Physical meaning (intuition)</strong>
            <ul>
              <li><strong>Dispersion</strong> means different frequency components travel with different group delays.</li>
              <li>That creates a <strong>frequency-dependent delay</strong> → equivalently, a <strong>quadratic phase</strong> in the frequency domain.</li>
              <li>Over long distances, the pulse is “spread out” and becomes strongly chirped: time maps to frequency.</li>
            </ul>
          </div>
        </div>

        <div class="callouts" style="margin-top:12px">
          <div class="callout">
            <h3>Key law/model used</h3>
            <p>
              For narrowband envelopes and linear propagation (no Kerr nonlinearity), a dispersive medium acts like a linear time-invariant system
              whose frequency response is a quadratic phase:
            </p>
            <div class="eqrow">
              <pre id="eq0">H(ω) = exp( -j (β'' z / 2) ω^2 )  ≡  exp( -j ω^2 b / 2 )</pre>
              <button class="btn" type="button" data-copy="#eq0" aria-label="Copy equation">
                <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 9h10v10H9V9Z" stroke="currentColor" stroke-width="2"/><path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="2"/></svg>
                Copy
              </button>
            </div>
            <p class="faint" style="margin-top:10px">
              The prompt uses <code>b = D<sub>ν</sub> z / π</code>. Many texts equivalently use <code>b = β'' z</code> up to a conventional scaling.
              What matters here is: <strong>b has units of time²</strong> and grows linearly with <code>z</code>.
            </p>
          </div>

          <div class="callout warn">
            <h3>Validity conditions (assumptions)</h3>
            <ul class="muted">
              <li>Linear propagation (ignore Kerr nonlinearity, Raman, etc.).</li>
              <li>Second-order dispersion dominates (higher-order dispersion neglected).</li>
              <li>Narrowband envelope approximation around the carrier.</li>
              <li>“Sufficiently long distance” means a <strong>far-dispersion / Fraunhofer-like limit</strong>: typically <code>|b| ≫ τ²</code>.</li>
            </ul>
          </div>
        </div>

        <details>
          <summary>Mini intuition examples (fast conceptual checks)</summary>
          <p><strong>Example 1:</strong> If the input is a delta pulse, dispersion produces a broad chirped “impulse response” (a Fresnel kernel).</p>
          <p><strong>Example 2:</strong> If the input is Gaussian, it stays Gaussian but broadens; its width grows with <code>|b|</code>.</p>
          <p><strong>Example 3:</strong> If the input has sharp edges (rectangle), its spectrum has oscillatory sidelobes; in the far-dispersion limit those sidelobes appear in time → a sinc-like waveform.</p>
        </details>

        <div class="callout danger">
          <h3>What to watch for (pitfalls)</h3>
          <ul class="muted">
            <li><strong>sinc definition</strong>: Some authors define <code>sinc(x)=sin(πx)/(πx)</code>. Here we use <code>sin(x)/x</code>. This changes where “first zeros” occur by a factor of <code>π</code>.</li>
            <li><strong>Width definition</strong>: “Pulse width” may mean FWHM, RMS width, or first-null width. We will state clearly which one we use.</li>
            <li><strong>Sign of dispersion</strong>: <code>b</code> can be positive or negative; the <em>magnitude</em> sets broadening. The sign affects chirp phase, not the magnitude envelope.</li>
          </ul>
        </div>
      </section>

      <!-- PART 0B -->
      <section class="section" id="p0b">
        <div class="kicker"><span>PART 0B — Industry &amp; Applied Physics Perspective</span><span class="kline"></span></div>

        <h2>Why Engineers Care: Dispersion as a System-Level Constraint</h2>

        <div class="cards">
          <div class="card">
            <strong>Where this appears in industry (concrete examples)</strong>
            <ul>
              <li><strong>Fiber-optic communications</strong>: pulse spreading causes intersymbol interference (ISI) and limits bit-rate × distance.</li>
              <li><strong>Optical signal processing</strong>: dispersive Fourier transform and time-stretch systems map spectra into time for fast measurements.</li>
              <li><strong>Ultrafast lasers &amp; metrology</strong>: pulse shaping/compression relies on controlling quadratic (and higher) spectral phase.</li>
              <li><strong>Fiber sensing</strong> (distributed sensing, reflectometry): dispersion shapes the received transient and affects resolution.</li>
            </ul>
          </div>

          <div class="card">
            <strong>Why engineers care (performance, cost, reliability)</strong>
            <ul>
              <li><strong>Performance</strong>: determines eye opening, BER, and timing margins in digital links.</li>
              <li><strong>Reliability</strong>: dispersion tolerance affects temperature drift margins and component interchangeability.</li>
              <li><strong>Cost</strong>: can force dispersion compensation modules (DCMs) or coherent DSP (power + complexity).</li>
              <li><strong>Manufacturability</strong>: real fibers vary in dispersion with wavelength and batch tolerances.</li>
            </ul>
          </div>
        </div>

        <div class="callouts">
          <div class="callout">
            <h3>Typical measurement / validation methods</h3>
            <ul class="muted">
              <li><strong>Chromatic dispersion measurement</strong>: phase-shift method, interferometric methods, modulation phase delay vs wavelength.</li>
              <li><strong>Time-domain pulse characterization</strong>: fast photodiodes + sampling scopes; optical cross-correlation; FROG/SPIDER (for ultrafast).</li>
              <li><strong>System validation</strong>: BER vs distance, eye diagrams, coherent receiver DSP estimation of dispersion.</li>
            </ul>
          </div>
          <div class="callout warn">
            <h3>Design trade-offs &amp; constraints (non-idealities)</h3>
            <ul class="muted">
              <li>Higher-order dispersion and PMD can spoil simple quadratic-phase models.</li>
              <li>Nonlinearity (SPM) couples with dispersion → waveform differs from linear sinc prediction.</li>
              <li>Component bandwidth limits (modulators/receivers) may dominate over pure fiber dispersion for short links.</li>
              <li>Pulse shapes aren’t perfectly rectangular; finite rise/fall smooths spectral sidelobes, reducing time-domain ringing.</li>
            </ul>
          </div>
        </div>

        <details>
          <summary>From lab model to product reality (short note)</summary>
          <p>
            In product design, the “chirp filter” model is used as a first-order dispersion block inside a link budget or DSP simulation.
            Engineers then add: (i) measured dispersion vs wavelength (fit to polynomial), (ii) component bandwidth/roll-off,
            (iii) noise and quantization, and (iv) nonlinear penalties for high launch powers. The ideal sinc-like spreading remains a
            powerful intuition for how sharp edges create ringing after strong dispersion.
          </p>
        </details>
      </section>

      <!-- PART 1 -->
      <section class="section" id="p1">
        <div class="kicker"><span>PART 1 — Problem Analysis</span><span class="kline"></span></div>

        <h2>Restating the Problem</h2>
        <p>
          An input envelope is a <strong>rectangular pulse</strong> of duration <code>τ</code>. It propagates through a dispersive fiber that can be treated as a
          <strong>chirp (quadratic-phase) filter</strong> with parameter <code>b = D<sub>ν</sub> z / π</code>.
          You must show that for <strong>sufficiently large</strong> propagation distance <code>z</code> (equivalently large <code>|b|</code>),
          the output waveform becomes proportional to a <strong>sinc function</strong>, and then find the <strong>modified pulse width</strong>.
        </p>

        <div class="two">
          <div class="callout">
            <h3>Given</h3>
            <ul class="muted">
              <li>Input pulse: <code>f(t) = rect(t/τ)</code> (unit amplitude, centered at 0).</li>
              <li>Fiber modeled as chirp filter with <code>b = D<sub>ν</sub> z / π</code>.</li>
              <li>Long-distance regime (“sufficiently long”): large <code>|b|</code>.</li>
            </ul>
          </div>
          <div class="callout ok">
            <h3>Unknowns / what to show</h3>
            <ul class="muted">
              <li>Show output shape approaches <code>sinc(·)</code> (up to scaling and a phase chirp).</li>
              <li>Derive an expression for the <strong>modified width</strong> of the output pulse (state your width definition).</li>
            </ul>
          </div>
        </div>

        <div class="callout warn">
          <h3>Relevant principles (and why)</h3>
          <ul class="muted">
            <li><strong>Linear systems in frequency domain</strong>: output spectrum is input spectrum times <code>H(ω)</code>.</li>
            <li><strong>Dispersive impulse response</strong> is a chirped Gaussian-like kernel; for large <code>|b|</code>, stationary-phase yields a Fourier-transform mapping.</li>
            <li>We do <em>not</em> need nonlinear optics, absorption, or waveguide mode coupling.</li>
          </ul>
        </div>

        <div class="callout">
          <h3>Assumptions (explicit)</h3>
          <ul class="muted">
            <li>Second-order dispersion only; model the fiber as <code>H(ω)=exp(-j ω² b/2)</code>.</li>
            <li>Input is a perfect rectangle (sharp edges).</li>
            <li>“Sufficiently long” means <code>|b| ≫ τ²</code> so the far-dispersion approximation applies.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <div class="cards">
          <div class="card">
            <strong>Approach A — Frequency-domain + far-dispersion (stationary phase)</strong>
            <ul>
              <li><em>Pros:</em> directly shows why output becomes a scaled version of the input spectrum → immediately gives sinc.</li>
              <li><em>Cons:</em> requires accepting/deriving a stationary-phase approximation.</li>
              <li><em>Best when:</em> long-distance regime is explicitly stated (as here).</li>
            </ul>
          </div>
          <div class="card">
            <strong>Approach B — Time-domain convolution with Fresnel kernel</strong>
            <ul>
              <li><em>Pros:</em> very physical; exact integral form exists for any input.</li>
              <li><em>Cons:</em> exact rectangle integral involves Fresnel integrals; more algebra before the far-field limit simplifies it.</li>
              <li><em>Best when:</em> you want full intermediate-distance behavior.</li>
            </ul>
          </div>
          <div class="card">
            <strong>Approach C — Direct analogy to Fraunhofer diffraction</strong>
            <ul>
              <li><em>Pros:</em> strong intuition: rectangle aperture → sinc diffraction pattern; dispersion plays the role of propagation.</li>
              <li><em>Cons:</em> you still need mapping constants to get the correct width scaling.</li>
              <li><em>Best when:</em> building intuition or teaching.</li>
            </ul>
          </div>
        </div>

        <p class="muted">
          We will use <strong>Approach A</strong> (with a brief connection to Approach B) because it cleanly proves “rectangle → sinc”
          and yields the width scaling with minimal overhead.
        </p>
      </section>

      <!-- PART 2 -->
      <section class="section" id="p2">
        <div class="kicker"><span>PART 2 — Strategy &amp; Tips</span><span class="kline"></span></div>

        <h2>Roadmap (no full algebra yet)</h2>
        <ol class="muted" style="margin:10px 0 0; padding-left:18px">
          <li><strong>Model the fiber as a filter</strong>: write <code>G(ω)=F(ω)H(ω)</code> with <code>H(ω)=exp(-jω²b/2)</code>.</li>
          <li><strong>Write the inverse FT</strong> for the output <code>g(t)</code>.</li>
          <li><strong>Apply far-dispersion approximation</strong> (stationary phase / “Fraunhofer”): show <code>g(t)</code> is proportional to <code>F(ω)</code> evaluated at <code>ω=t/b</code>, times a chirp phase.</li>
          <li><strong>Compute input spectrum</strong> of a rectangle: <code>F(ω) ∝ τ sinc(ωτ/2)</code>.</li>
          <li><strong>Substitute ω=t/b</strong> to obtain a time-domain sinc envelope.</li>
          <li><strong>Define pulse width</strong> (we choose first-null width of the main lobe) and solve for the first zeros.</li>
          <li><strong>Express result</strong> in terms of <code>b</code> and then using <code>b=D<sub>ν</sub>z/π</code>.</li>
          <li><strong>Sanity checks</strong>: units, limiting cases, dependence on parameters.</li>
        </ol>

        <div class="callout danger">
          <h3>Common mistakes (quick tips)</h3>
          <ul class="muted">
            <li>Mixing sinc conventions: always track whether zeros are at <code>x=π</code> or <code>x=1</code>.</li>
            <li>Forgetting that width scales like <code>|b|/τ</code> (inverse in <code>τ</code>).</li>
            <li>Dropping the chirp phase and then claiming the field is purely real; usually only the <em>magnitude/envelope</em> is sinc-like.</li>
            <li>Using the far-dispersion result outside its regime; if <code>|b|</code> is not much larger than <code>τ²</code>, the waveform is better described by Fresnel integrals.</li>
          </ul>
        </div>
      </section>

      <!-- PART 3 -->
      <section class="section" id="p3">
        <div class="kicker"><span>PART 3 — Full Solution</span><span class="kline"></span></div>

        <h2>Qualitative expectation (before math)</h2>
        <p>
          A rectangular pulse has sharp edges, which means its spectrum is broad and oscillatory (sinc-shaped). Dispersion adds a frequency-dependent delay,
          so after long propagation, different frequencies “spread out” in time. In the far-dispersion limit, <strong>time becomes a proxy for frequency</strong>.
          Therefore, the output in time should resemble the input spectrum: a <strong>sinc</strong> with sidelobes and a widened main lobe.
        </p>

        <h3>Step 1 — Fiber as a chirp (quadratic-phase) filter</h3>
        <p>
          Let the input complex envelope be <code>f(t)</code> with Fourier transform
          <code>F(ω)=∫ f(t) e^{-jωt} dt</code>.
          A purely dispersive fiber (second-order only) applies the transfer function
          <code>H(ω)=exp(-j ω² b/2)</code>.
          Thus
        </p>
        <div class="eqrow">
          <pre id="eq1">G(ω) = F(ω) H(ω) = F(ω) · exp( -j ω^2 b / 2 )</pre>
          <button class="btn" type="button" data-copy="#eq1" aria-label="Copy equation">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 9h10v10H9V9Z" stroke="currentColor" stroke-width="2"/><path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="2"/></svg>
            Copy
          </button>
        </div>

        <h3>Step 2 — Output in time (inverse FT)</h3>
        <p>
          The output envelope is
        </p>
        <div class="eqrow">
          <pre id="eq2">g(t) = (1/2π) ∫_{-∞}^{∞} F(ω) · exp( -j ω^2 b / 2 ) · exp( j ω t ) dω</pre>
          <button class="btn" type="button" data-copy="#eq2" aria-label="Copy equation">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 9h10v10H9V9Z" stroke="currentColor" stroke-width="2"/><path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="2"/></svg>
            Copy
          </button>
        </div>
        <p class="muted">
          This integral is exact for the quadratic-phase model.
          The “sufficiently long distance” condition tells us to approximate it in the far-dispersion limit.
        </p>

        <h3>Step 3 — Far-dispersion approximation (“dispersive Fourier transform”)</h3>
        <p>
          Combine the phases in the integrand:
        </p>
        <pre id="eq3">Phase(ω) = ω t - (b/2) ω^2</pre>
        <p>
          For large <code>|b|</code>, the integral is dominated by stationary points where <code>d(Phase)/dω = 0</code>:
        </p>
        <pre id="eq4">d/dω [ ω t - (b/2) ω^2 ] = t - b ω = 0  ⇒  ω_s = t / b</pre>
        <p>
          Stationary-phase evaluation gives the classic result (up to a constant phase factor):
        </p>
        <div class="eqrow">
          <pre id="eq5">g(t) ≈ (1/√(j 2π b)) · exp( j t^2 / (2 b) ) · F( ω = t/b )   (for |b| ≫ τ^2)</pre>
          <button class="btn" type="button" data-copy="#eq5" aria-label="Copy equation">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 9h10v10H9V9Z" stroke="currentColor" stroke-width="2"/><path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="2"/></svg>
            Copy
          </button>
        </div>
        <p class="muted">
          Interpretation: <strong>the output magnitude is proportional to the input spectrum evaluated at</strong> <code>ω=t/b</code>.
          The prefactor and <code>exp(j t²/(2b))</code> are mostly phase/chirp; the <strong>envelope shape</strong> comes from <code>F(t/b)</code>.
        </p>

        <details>
          <summary>Connection to the time-domain Fresnel kernel (optional)</summary>
          <p>
            The same model can be written as a convolution:
            <code>g(t) = f(t) * h(t)</code> with
            <code>h(t) = (1/√(j2πb)) exp(j t²/(2b))</code>.
            For a rectangle, the exact convolution produces Fresnel integrals; the far-dispersion limit of those Fresnel integrals reduces to the stationary-phase result above.
          </p>
        </details>

        <h3>Step 4 — Spectrum of a rectangular pulse</h3>
        <p>
          Let the input be a unit-amplitude rectangle:
        </p>
        <pre id="eq6">f(t) = rect(t/τ) = 1 for |t| ≤ τ/2, and 0 otherwise.</pre>
        <p>
          Its Fourier transform is
        </p>
        <div class="eqrow">
          <pre id="eq7">F(ω) = ∫_{-τ/2}^{τ/2} e^{-jωt} dt = (2/ω) sin(ωτ/2) = τ · sinc( ωτ/2 )</pre>
          <button class="btn" type="button" data-copy="#eq7" aria-label="Copy equation">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 9h10v10H9V9Z" stroke="currentColor" stroke-width="2"/><path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="2"/></svg>
            Copy
          </button>
        </div>
        <p class="faint">
          Reminder: here <code>sinc(x)=sin(x)/x</code>.
        </p>

        <h3>Step 5 — Substitute into the far-dispersion mapping</h3>
        <p>
          Using <code>g(t) ≈ (1/√(j2πb)) exp(j t²/(2b)) F(t/b)</code> and the rectangle spectrum above:
        </p>
        <div class="eqrow">
          <pre id="eq8">g(t) ≈ (τ / √(j 2π b)) · exp( j t^2 / (2 b) ) · sinc( (τ/2) · (t/b) )</pre>
          <button class="btn" type="button" data-copy="#eq8" aria-label="Copy equation">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 9h10v10H9V9Z" stroke="currentColor" stroke-width="2"/><path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="2"/></svg>
            Copy
          </button>
        </div>

        <div class="callout ok">
          <h3>Conclusion (shape)</h3>
          <p>
            The output field is a <strong>sinc function of time</strong> (times a chirp phase).
            Therefore, after sufficiently long distance, the pulse shape changes from rectangular in time to <strong>sinc-like in time</strong>.
          </p>
        </div>

        <h3>Step 6 — Modified pulse width</h3>
        <p>
          Because the output has oscillatory sidelobes, “width” must be defined. A common engineering definition for sinc-like pulses is the
          <strong>main-lobe width between the first zeros</strong> (first-null to first-null).
        </p>
        <p>
          Zeros of <code>sinc(x)=sin(x)/x</code> occur at <code>x = ±π, ±2π, ...</code> (excluding <code>x=0</code>).
          For the main lobe, set the argument of the sinc in Eq. (eq8) equal to <code>±π</code>:
        </p>
        <pre id="eq9">(τ/2) · (t/b) = ±π  ⇒  t = ± (2π b / τ)</pre>
        <p>
          Thus the main-lobe first-null-to-first-null width is
        </p>

        <div class="eqrow">
          <pre id="finalAns">Δt_null ≈ ( +2πb/τ ) - ( -2πb/τ ) = 4π|b|/τ.

Using b = Dν z / π:   Δt_null ≈ 4π|Dν z / π| / τ = 4 |Dν| z / τ.</pre>
          <button class="btn" type="button" data-copy="#finalAns" aria-label="Copy final answer">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M9 9h10v10H9V9Z" stroke="currentColor" stroke-width="2"/><path d="M5 15H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1" stroke="currentColor" stroke-width="2"/></svg>
            Copy Final
          </button>
        </div>

        <div class="callout">
          <h3>Sanity checks</h3>
          <ul class="muted">
            <li><strong>Units:</strong> <code>b</code> has units s², so <code>4π|b|/τ</code> has units s. Good.</li>
            <li><strong>Limiting case:</strong> If <code>|b| → 0</code>, far-dispersion assumption fails; the output should approach the original rectangle rather than a sinc.</li>
            <li><strong>Dependence:</strong> Larger distance <code>z</code> → larger <code>|b|</code> → wider output (more spreading). Larger input width <code>τ</code> → narrower sinc in frequency, so in time after mapping it yields a <em>smaller</em> <code>Δt_null</code> (inverse scaling), consistent with the time-to-frequency mapping.</li>
            <li><strong>Sign:</strong> Negative vs positive dispersion changes the chirp phase term <code>exp(j t²/(2b))</code> but not the magnitude width (depends on <code>|b|</code>).</li>
          </ul>
        </div>

        <figure>
          <canvas id="plot" aria-label="Static plot: rectangle vs far-dispersion sinc output"></canvas>
          <figcaption>
            One illustrative static plot (example values) showing the qualitative transformation:
            the input rectangle vs the far-dispersion sinc-shaped output envelope.
            Final formulas above remain fully symbolic.
          </figcaption>
        </figure>

        <div class="backtop">
          <a class="btn" href="#top" title="Back to top">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 5l-7 7h4v7h6v-7h4l-7-7Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
            Back to top
          </a>
        </div>
      </section>

      <!-- PART 4 -->
      <section class="section" id="p4">
        <div class="kicker"><span>PART 4 — Deeper Understanding</span><span class="kline"></span></div>

        <h2>Interpreting the Result</h2>

        <div class="callouts">
          <div class="callout ok">
            <h3>What each factor controls (from Eq. eq8)</h3>
            <ul class="muted">
              <li><code>τ</code> in front: sets overall amplitude scaling of the field in this approximation.</li>
              <li><code>1/√|b|</code>: energy conservation spreads energy over longer time, so peak decreases ~ <code>1/√|b|</code> (field); intensity peak decreases ~ <code>1/|b|</code> in this asymptotic view.</li>
              <li><code>exp(j t²/(2b))</code>: quadratic phase = <strong>chirp</strong> (instantaneous frequency varies with time).</li>
              <li><code>sinc( (τ t)/(2b) )</code>: the envelope shape and width; first zeros set the main-lobe width.</li>
            </ul>
          </div>

          <div class="callout">
            <h3>Parameter dependence (qualitative)</h3>
            <ul class="muted">
              <li>Increase <code>z</code> → increase <code>|b|</code> → wider main lobe: <code>Δt_null ∝ z</code>.</li>
              <li>Increase dispersion coefficient (<code>|D<sub>ν</sub>|</code> or <code>|β''|</code>) → wider output: <code>Δt_null ∝ |D<sub>ν</sub>|</code>.</li>
              <li>Increase input width <code>τ</code> → narrower output sinc main lobe: <code>Δt_null ∝ 1/τ</code>.</li>
            </ul>
          </div>
        </div>

        <details>
          <summary>Alternative derivation idea (brief but meaningful)</summary>
          <p>
            Start from the time-domain impulse response of a dispersive medium:
            <code>h(t) = (1/√(j2πb)) exp(j t²/(2b))</code>.
            Then compute <code>g(t)=∫_{-τ/2}^{τ/2} h(t-t') dt'</code>, which yields Fresnel integrals.
            In the far-dispersion limit <code>|b| ≫ τ²</code>, those Fresnel integrals asymptotically reduce to a sinc envelope,
            recovering the same width <code>Δt_null ≈ 4π|b|/τ</code>.
          </p>
        </details>

        <div class="card">
          <strong>Concept checks (self-test with answers)</strong>
          <ul class="muted">
            <li><strong>Q:</strong> Why does a time rectangle become a time sinc? <br><strong>A:</strong> Because in far dispersion the output time waveform maps to the input spectrum, and the rectangle’s spectrum is sinc.</li>
            <li><strong>Q:</strong> What sets the width of the sinc in time? <br><strong>A:</strong> The scaling <code>t/b</code> inside <code>F(t/b)</code>; larger <code>|b|</code> stretches the waveform.</li>
            <li><strong>Q:</strong> Does the sign of dispersion change the main-lobe width? <br><strong>A:</strong> No—width depends on <code>|b|</code>; sign changes chirp (phase) direction.</li>
            <li><strong>Q:</strong> What if the input rectangle has finite rise time? <br><strong>A:</strong> The spectrum sidelobes are reduced; the output time-domain ringing/sidelobes shrink compared to the ideal sinc.</li>
          </ul>
        </div>

        <div class="backtop">
          <a class="btn" href="#top" title="Back to top">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 5l-7 7h4v7h6v-7h4l-7-7Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
            Back to top
          </a>
        </div>
      </section>

      <!-- PART 5 -->
      <section class="section" id="p5">
        <div class="kicker"><span>PART 5 — Optional Plot Guide</span><span class="kline"></span></div>

        <h2>How to Read the Plot (and why it helps)</h2>
        <p>
          The plot is included only to visually reinforce the core idea:
          <strong>a rectangle evolves into a sinc-like envelope</strong> in the far-dispersion regime.
        </p>
        <div class="callout">
          <h3>Plot definition</h3>
          <ul class="muted">
            <li><strong>x-axis:</strong> time <code>t</code> in nanoseconds (ns).</li>
            <li><strong>y-axis:</strong> normalized amplitude (unitless) — for shape comparison only.</li>
            <li><strong>Curves:</strong> input rectangle vs output sinc-envelope <code>∝ sinc((τ t)/(2b))</code>.</li>
          </ul>
          <p class="faint">
            The plot uses <strong>example values</strong> internally (chosen purely for visualization); the final answer remains symbolic.
          </p>
          <p class="muted">
            Features to notice:
            the output has a broad main lobe and sidelobes (ringing). The first zeros occur at
            <code>t = ± 2πb/τ</code>, so the main-lobe width grows linearly with <code>|b|</code> (and hence with distance <code>z</code>).
          </p>
        </div>

        <div class="backtop">
          <a class="btn" href="#top" title="Back to top">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 5l-7 7h4v7h6v-7h4l-7-7Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
            Back to top
          </a>
        </div>
      </section>
    </article>
  </div>

  <footer>
    <div class="wrap">
      <p style="margin:0">
        <strong>Note on notation:</strong> This article uses <code>sinc(x)=sin(x)/x</code>. If your course/text uses <code>sinc(x)=sin(πx)/(πx)</code>,
        multiply/divide the “first-zero” locations by <code>π</code> accordingly.
      </p>
    </div>
  </footer>
</main>

<script>
  // Smooth scroll for TOC links
  (function(){
    document.querySelectorAll('a[href^="#"]').forEach(a=>{
      a.addEventListener('click', (e)=>{
        const id = a.getAttribute('href');
        if(!id || id.length<2) return;
        const el = document.querySelector(id);
        if(!el) return;
        e.preventDefault();
        el.scrollIntoView({behavior:'smooth', block:'start'});
        history.replaceState(null, "", id);
      });
    });
  })();

  // Copy buttons
  (function(){
    function copyText(txt){
      if(navigator.clipboard && navigator.clipboard.writeText){
        return navigator.clipboard.writeText(txt);
      }
      // fallback
      const ta=document.createElement('textarea');
      ta.value=txt; ta.style.position='fixed'; ta.style.left='-9999px';
      document.body.appendChild(ta);
      ta.select();
      try{ document.execCommand('copy'); }catch(e){}
      document.body.removeChild(ta);
      return Promise.resolve();
    }

    document.querySelectorAll('[data-copy]').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const sel = btn.getAttribute('data-copy');
        const node = document.querySelector(sel);
        if(!node) return;
        const text = node.innerText.trim();
        const old = btn.innerHTML;
        await copyText(text);
        btn.innerHTML = btn.innerHTML.replace('Copy Final','Copied!').replace('Copy','Copied!');
        btn.style.borderColor = 'rgba(75,227,138,0.45)';
        btn.style.background = 'rgba(75,227,138,0.10)';
        setTimeout(()=>{
          btn.innerHTML = old;
          btn.style.borderColor = 'rgba(255,255,255,0.16)';
          btn.style.background = 'rgba(255,255,255,0.07)';
        }, 950);
      });
    });
  })();

  // TOC collapse
  (function(){
    const btn = document.getElementById('collapseTocBtn');
    const list = document.getElementById('tocList');
    let collapsed = false;
    btn.addEventListener('click', ()=>{
      collapsed = !collapsed;
      list.style.display = collapsed ? 'none' : 'grid';
      btn.setAttribute('aria-expanded', String(!collapsed));
    });
  })();

  // Static canvas plot: rectangle vs sinc (example values only)
  (function(){
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    function sinc(x){
      if(Math.abs(x) < 1e-8) return 1;
      return Math.sin(x)/x;
    }

    // Example values (for visualization only)
    // Choose τ and b such that the sinc main lobe is clearly visible.
    const tau = 1.0e-9;     // 1 ns
    const b   = 2.0e-18;    // 2e-18 s^2 (example)
    // Main-lobe first zero: t0 = 2π b / τ
    const t0 = 2*Math.PI*b/tau; // seconds
    const tMax = 4.0*Math.abs(t0); // show several lobes
    const tMin = -tMax;

    function resize(){
      const dpr = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
      const rect = canvas.getBoundingClientRect();
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
      draw();
    }

    function draw(){
      const W = canvas.getBoundingClientRect().width;
      const H = canvas.getBoundingClientRect().height;

      // plot area
      const padL = 56, padR = 16, padT = 28, padB = 44;
      const x0 = padL, y0 = padT, x1 = W-padR, y1 = H-padB;
      const PW = x1-x0, PH = y1-y0;

      // background
      ctx.clearRect(0,0,W,H);
      ctx.fillStyle = "rgba(10,14,22,0.65)";
      ctx.fillRect(0,0,W,H);

      // axes mapping
      const xFromT = (t)=> x0 + ( (t - tMin)/(tMax - tMin) )*PW;
      const yFromA = (a)=> y1 - ( (a - (-0.25))/(1.15 - (-0.25)) )*PH; // show slight negative sidelobes

      // grid
      ctx.lineWidth = 1;
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      const nx = 8, ny = 7;
      for(let i=0;i<=nx;i++){
        const x = x0 + (i/nx)*PW;
        ctx.beginPath(); ctx.moveTo(x,y0); ctx.lineTo(x,y1); ctx.stroke();
      }
      for(let j=0;j<=ny;j++){
        const y = y0 + (j/ny)*PH;
        ctx.beginPath(); ctx.moveTo(x0,y); ctx.lineTo(x1,y); ctx.stroke();
      }

      // axes
      ctx.strokeStyle = "rgba(255,255,255,0.28)";
      ctx.lineWidth = 1.2;
      ctx.beginPath(); ctx.moveTo(x0,y1); ctx.lineTo(x1,y1); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(x0,y0); ctx.lineTo(x0,y1); ctx.stroke();

      // title
      ctx.fillStyle = "rgba(233,238,247,0.92)";
      ctx.font = "700 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.textAlign = "left";
      ctx.textBaseline = "top";
      ctx.fillText("Example: Input rectangle vs far-dispersion output sinc envelope", x0, 8);

      // ticks & labels
      ctx.fillStyle = "rgba(184,196,217,0.92)";
      ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.textBaseline = "middle";

      // x ticks in ns
      for(let i=0;i<=nx;i++){
        const t = tMin + (i/nx)*(tMax - tMin);
        const x = xFromT(t);
        ctx.strokeStyle = "rgba(255,255,255,0.28)";
        ctx.beginPath(); ctx.moveTo(x,y1); ctx.lineTo(x,y1+6); ctx.stroke();
        const ns = t*1e9;
        ctx.textAlign = "center";
        ctx.fillText(ns.toFixed(2), x, y1+18);
      }
      ctx.textAlign = "center";
      ctx.textBaseline = "alphabetic";
      ctx.fillText("time t (ns)", x0 + PW/2, H-10);

      // y ticks
      ctx.textBaseline = "middle";
      for(let j=0;j<=ny;j++){
        const a = (-0.25) + (j/ny)*(1.15 - (-0.25));
        const y = yFromA(a);
        ctx.strokeStyle = "rgba(255,255,255,0.28)";
        ctx.beginPath(); ctx.moveTo(x0-6,y); ctx.lineTo(x0,y); ctx.stroke();
        ctx.textAlign = "right";
        ctx.fillText(a.toFixed(2), x0-10, y);
      }
      // y label
      ctx.save();
      ctx.translate(16, y0 + PH/2);
      ctx.rotate(-Math.PI/2);
      ctx.textAlign = "center";
      ctx.textBaseline = "alphabetic";
      ctx.fillText("normalized amplitude (unitless)", 0, 0);
      ctx.restore();

      // curve 1: rectangle (input)
      ctx.lineWidth = 2.2;
      ctx.strokeStyle = "rgba(155,255,207,0.95)";
      ctx.beginPath();
      const N = 1600;
      for(let i=0;i<=N;i++){
        const t = tMin + (i/N)*(tMax - tMin);
        const a = (Math.abs(t) <= tau/2) ? 1 : 0;
        const x = xFromT(t);
        const y = yFromA(a);
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      }
      ctx.stroke();

      // curve 2: sinc envelope (output magnitude shape, ignoring chirp phase)
      ctx.lineWidth = 2.2;
      ctx.strokeStyle = "rgba(118,183,255,0.95)";
      ctx.beginPath();
      for(let i=0;i<=N;i++){
        const t = tMin + (i/N)*(tMax - tMin);
        const arg = (tau/2)*(t/b);
        const a = sinc(arg);
        const x = xFromT(t);
        const y = yFromA(a);
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      }
      ctx.stroke();

      // legend
      const lx = x1 - 250, ly = y0 + 8;
      ctx.fillStyle = "rgba(255,255,255,0.06)";
      ctx.strokeStyle = "rgba(255,255,255,0.14)";
      ctx.lineWidth = 1;
      ctx.beginPath();
      const rw = 238, rh = 58;
      roundRect(ctx, lx, ly, rw, rh, 12);
      ctx.fill(); ctx.stroke();

      ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.textAlign = "left";
      ctx.textBaseline = "middle";

      ctx.strokeStyle = "rgba(155,255,207,0.95)";
      ctx.lineWidth = 3;
      ctx.beginPath(); ctx.moveTo(lx+14, ly+18); ctx.lineTo(lx+42, ly+18); ctx.stroke();
      ctx.fillStyle = "rgba(233,238,247,0.92)";
      ctx.fillText("Input: rect(t/τ)", lx+52, ly+18);

      ctx.strokeStyle = "rgba(118,183,255,0.95)";
      ctx.lineWidth = 3;
      ctx.beginPath(); ctx.moveTo(lx+14, ly+40); ctx.lineTo(lx+42, ly+40); ctx.stroke();
      ctx.fillStyle = "rgba(233,238,247,0.92)";
      ctx.fillText("Output (far dispersion): sinc(τ t / (2b))", lx+52, ly+40);

      // small note of example values
      ctx.fillStyle = "rgba(184,196,217,0.85)";
      ctx.font = "11px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.textAlign = "left";
      ctx.textBaseline = "alphabetic";
      ctx.fillText("Example values (for plot only): τ = 1 ns, b = 2×10⁻¹⁸ s²", x0, H-28);
    }

    function roundRect(c, x, y, w, h, r){
      const rr = Math.min(r, w/2, h/2);
      c.moveTo(x+rr, y);
      c.arcTo(x+w, y, x+w, y+h, rr);
      c.arcTo(x+w, y+h, x, y+h, rr);
      c.arcTo(x, y+h, x, y, rr);
      c.arcTo(x, y, x+w, y, rr);
      c.closePath();
    }

    window.addEventListener('resize', resize, {passive:true});
    resize();
  })();
</script>
</body>
</html>
