<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mixing of Pulsed Chirped Waves & Chirp Amplification (Three-Wave Mixing)</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#101a33;
      --card:#0f1931;
      --ink:#eaf0ff;
      --muted:#b9c6ff;
      --faint:#95a6e8;
      --accent:#7cf0c6;
      --accent2:#ffcc66;
      --danger:#ff6b8b;
      --line:rgba(255,255,255,0.12);
      --line2:rgba(255,255,255,0.08);
      --shadow: 0 18px 40px rgba(0,0,0,0.35);
      --radius:16px;
      --radius2:22px;
      --maxw: 1120px;
    }

    *{ box-sizing:border-box; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 800px at 15% -10%, rgba(124,240,198,0.20), transparent 60%),
        radial-gradient(900px 700px at 90% 0%, rgba(255,204,102,0.18), transparent 55%),
        radial-gradient(900px 700px at 75% 115%, rgba(124,174,255,0.16), transparent 60%),
        linear-gradient(180deg, #070a14 0%, var(--bg) 60%, #070a14 100%);
      color:var(--ink);
      line-height:1.55;
    }

    a{ color:var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    header{
      padding: 28px 18px 18px;
      border-bottom:1px solid var(--line2);
      position:relative;
      overflow:hidden;
    }
    header::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(900px 200px at 25% 0%, rgba(124,240,198,0.18), transparent 60%),
        radial-gradient(700px 200px at 80% 0%, rgba(255,204,102,0.16), transparent 60%);
      filter: blur(2px);
      opacity:0.9;
      pointer-events:none;
    }

    .wrap{
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 0 16px;
      position:relative;
    }

    .title{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      position:relative;
      z-index:1;
    }
    .title h1{
      margin:0;
      font-size: clamp(1.35rem, 2.6vw, 2.15rem);
      letter-spacing: -0.02em;
    }
    .subtitle{
      color:var(--muted);
      max-width: 78ch;
      font-size: 0.98rem;
    }

    main{
      padding: 18px 18px 42px;
    }

    .layout{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 16px;
      align-items:start;
    }

    nav.toc{
      position: sticky;
      top: 14px;
      align-self:start;
      background: linear-gradient(180deg, rgba(16,26,51,0.92), rgba(16,26,51,0.82));
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 14px 12px;
      backdrop-filter: blur(8px);
    }

    .toc .toc-title{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding: 6px 8px 10px;
      border-bottom: 1px solid var(--line2);
      margin-bottom: 10px;
    }
    .toc .toc-title strong{
      font-size: 0.95rem;
      letter-spacing: 0.01em;
    }
    .pill{
      font-size: 0.72rem;
      color: rgba(234,240,255,0.92);
      background: rgba(124,240,198,0.16);
      border: 1px solid rgba(124,240,198,0.25);
      padding: 3px 8px;
      border-radius: 999px;
      white-space:nowrap;
    }

    .toc ol{
      margin: 0;
      padding-left: 18px;
    }
    .toc li{ margin: 8px 0; }
    .toc a{
      color: rgba(234,240,255,0.92);
      font-size: 0.92rem;
      text-decoration:none;
    }
    .toc a:hover{ color: var(--accent); }

    .content{
      display:flex;
      flex-direction:column;
      gap: 14px;
      min-width: 0;
    }

    section, article{
      background: linear-gradient(180deg, rgba(15,25,49,0.92), rgba(15,25,49,0.78));
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 16px 16px;
      position:relative;
      overflow:hidden;
    }
    section::after, article::after{
      content:"";
      position:absolute;
      inset:-1px;
      background: radial-gradient(700px 240px at 20% 0%, rgba(124,240,198,0.10), transparent 55%);
      opacity:0.8;
      pointer-events:none;
    }
    section > *, article > *{ position:relative; z-index:1; }

    h2{
      margin: 0 0 10px;
      font-size: 1.18rem;
      letter-spacing:-0.01em;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 1.02rem;
      color: rgba(234,240,255,0.96);
    }
    p{ margin: 10px 0; color: rgba(234,240,255,0.92); }
    ul,ol{ margin: 10px 0; color: rgba(234,240,255,0.92); }
    li{ margin: 6px 0; }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .callouts{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .box{
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 12px 12px;
      background: linear-gradient(180deg, rgba(16,26,51,0.55), rgba(16,26,51,0.25));
    }
    .box strong{
      display:flex;
      align-items:center;
      gap:8px;
      letter-spacing:0.01em;
    }
    .tag{
      font-size: 0.72rem;
      padding: 2px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      color: rgba(234,240,255,0.92);
      background: rgba(255,255,255,0.06);
      white-space:nowrap;
    }
    .tag.assump{ border-color: rgba(124,174,255,0.35); background: rgba(124,174,255,0.10); }
    .tag.keyeq{ border-color: rgba(255,204,102,0.35); background: rgba(255,204,102,0.12); }
    .tag.mist{ border-color: rgba(255,107,139,0.35); background: rgba(255,107,139,0.10); }
    .tag.final{ border-color: rgba(124,240,198,0.35); background: rgba(124,240,198,0.12); }

    .eq{
      margin-top: 10px;
      border: 1px dashed rgba(255,255,255,0.18);
      border-radius: 14px;
      padding: 10px 10px;
      background: rgba(0,0,0,0.18);
      overflow:auto;
    }
    .eq pre{
      margin:0;
      white-space: pre-wrap;
      word-break: break-word;
      color: rgba(234,240,255,0.95);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.93rem;
      line-height: 1.35;
    }

    .toolbar{
      display:flex;
      gap: 8px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 8px;
    }
    button.copy{
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.08);
      color: rgba(234,240,255,0.92);
      padding: 7px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 600;
      font-size: 0.86rem;
      transition: transform 0.12s ease, background 0.12s ease, border-color 0.12s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,0.11);
      border-color: rgba(124,240,198,0.35);
    }
    button.copy:active{ transform: translateY(0px) scale(0.99); }

    details{
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 10px 10px;
      background: rgba(255,255,255,0.04);
    }
    details summary{
      cursor:pointer;
      font-weight: 700;
      color: rgba(234,240,255,0.95);
      list-style:none;
    }
    details summary::-webkit-details-marker{ display:none; }
    details summary::after{
      content:"▾";
      float:right;
      color: rgba(234,240,255,0.75);
      transition: transform 0.15s ease;
    }
    details[open] summary::after{ transform: rotate(180deg); }
    details .note{
      color: rgba(234,240,255,0.90);
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid var(--line2);
    }

    figure{
      margin: 12px 0 0;
      padding: 10px 10px 12px;
      border-radius: var(--radius2);
      border: 1px solid var(--line);
      background: rgba(0,0,0,0.18);
    }
    figcaption{
      margin-top: 10px;
      color: rgba(234,240,255,0.78);
      font-size: 0.92rem;
    }
    canvas{
      width: 100%;
      height: auto;
      display:block;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(10,14,28,0.65);
    }

    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top: 10px;
      color: rgba(234,240,255,0.85);
      font-weight: 700;
      text-decoration:none;
      border: 1px solid rgba(255,255,255,0.14);
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
    }
    .backtop:hover{ color: var(--accent); border-color: rgba(124,240,198,0.35); }

    footer{
      padding: 18px 18px 34px;
      border-top: 1px solid var(--line2);
      color: rgba(234,240,255,0.70);
    }
    footer .wrap{
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    /* Responsive */
    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; }
      nav.toc{ position: relative; top: 0; }
    }
    @media (max-width: 720px){
      .grid2{ grid-template-columns: 1fr; }
      section, article{ padding: 14px 12px; }
    }

    /* Print-friendly */
    @media print{
      body{
        background: #fff !important;
        color:#000 !important;
      }
      header, footer, nav.toc, .backtop, button.copy{ display:none !important; }
      main{ padding: 0 !important; }
      section, article, figure, .box{
        box-shadow: none !important;
        background: #fff !important;
        color:#000 !important;
        border: 1px solid #bbb !important;
      }
      .eq{
        background: #fff !important;
        border: 1px dashed #888 !important;
      }
      .eq pre{ color:#000 !important; }
      a{ color:#000 !important; text-decoration: underline !important; }
      h2, h3, p, li{ color:#000 !important; }
      section, article{ break-inside: avoid; page-break-inside: avoid; }
      figure{ break-inside: avoid; }
    }

    /* Subtle micro animation */
    @keyframes floatIn {
      from { transform: translateY(6px); opacity: 0.0; }
      to { transform: translateY(0px); opacity: 1.0; }
    }
    .animate-in{ animation: floatIn 420ms ease-out both; }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap">
      <div class="title animate-in">
        <h1>Mixing of Pulsed Chirped Waves & “Chirp Amplification” in Three-Wave Mixing</h1>
        <div class="subtitle">
          We derive the chirp relations required for efficient second-order (χ(2)) mixing of three collinear pulsed plane waves with
          ω<sub>3</sub> = ω<sub>1</sub> + ω<sub>2</sub>, in a dispersive medium (different n and group velocities u at each carrier).
          Then we show how, because dispersion “splits” the pump chirp between signal and idler, one output can end up with a chirp magnitude larger than the pump—useful for ultrafast and industrial photonics.
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap layout">
      <nav class="toc animate-in" aria-label="Table of contents">
        <div class="toc-title">
          <strong>Table of Contents</strong>
          <span class="pill">sticky</span>
        </div>
        <ol>
          <li><a href="#quick">Quick Summary</a></li>
          <li><a href="#primer">PART 0 — Concept Primer</a></li>
          <li><a href="#industry">PART 0B — Industry & Applied Physics</a></li>
          <li><a href="#analysis">PART 1 — Problem Analysis</a></li>
          <li><a href="#strategy">PART 2 — Strategy & Tips</a></li>
          <li><a href="#solution">PART 3 — Full Solution</a></li>
          <li><a href="#deeper">PART 4 — Deeper Understanding</a></li>
          <li><a href="#plotguide">PART 5 — Optional Plot Guide</a></li>
        </ol>
      </nav>

      <div class="content">
        <section id="quick" class="animate-in">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this problem is about:</strong> chirped ultrafast pulses at ω<sub>1</sub>, ω<sub>2</sub>, ω<sub>3</sub>=ω<sub>1</sub>+ω<sub>2</sub> mixing efficiently in a χ(2) medium.</li>
            <li><strong>Key physics idea:</strong> for “always efficient” mixing, instantaneous <em>energy</em> and <em>momentum</em> (phase matching) must hold at every time t across the pulse.</li>
            <li><strong>Instantaneous frequency model:</strong> ω<sub>j</sub>(t)=ω<sub>j0</sub>+a<sub>j</sub>t (linear chirp; a<sub>j</sub> in rad·s<sup>−2</sup>).</li>
            <li><strong>Dispersion enters through group velocity:</strong> k<sub>j</sub>(ω) ≈ k<sub>j0</sub> + (1/u<sub>j</sub>)(ω−ω<sub>j0</sub>), where u<sub>j</sub> is group velocity at ω<sub>j0</sub>.</li>
            <li><strong>Governing constraints (all t):</strong> ω<sub>3</sub>(t)=ω<sub>1</sub>(t)+ω<sub>2</sub>(t) and k<sub>3</sub>(t)=k<sub>1</sub>(t)+k<sub>2</sub>(t).</li>
            <li><strong>Main symbolic result (chirp relations):</strong> a<sub>3</sub>=a<sub>1</sub>+a<sub>2</sub> and a<sub>3</sub>/u<sub>3</sub>=a<sub>1</sub>/u<sub>1</sub>+a<sub>2</sub>/u<sub>2</sub>.</li>
            <li><strong>Meaning:</strong> the medium’s dispersion “weights” how chirp is shared among waves; it is not purely a<sub>3</sub>=a<sub>1</sub>+a<sub>2</sub>.</li>
            <li><strong>Chirp amplification:</strong> solving the linear system can give |a<sub>signal</sub>| &gt; |a<sub>pump</sub>| or |a<sub>idler</sub>| &gt; |a<sub>pump</sub>| when group velocities are sufficiently mismatched.</li>
            <li><strong>Result type:</strong> fully symbolic; one plot (example values) illustrates chirp gain &gt; 1.</li>
          </ul>

          <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
        </section>

        <article id="primer" class="animate-in">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <h3>0.1 Core definitions (symbols + SI units)</h3>
          <div class="box">
            <ul>
              <li><strong>Angular frequency</strong> ω (rad·s<sup>−1</sup>): carrier oscillation rate.</li>
              <li><strong>Wavevector</strong> k (rad·m<sup>−1</sup>): spatial phase rate along propagation.</li>
              <li><strong>Refractive index</strong> n(ω) (dimensionless): k(ω)=n(ω)ω/c for a plane wave in a dielectric.</li>
              <li><strong>Group velocity</strong> u (m·s<sup>−1</sup>): u = dω/dk, equivalently dk/dω = 1/u.</li>
              <li><strong>Chirp parameter</strong> a (rad·s<sup>−2</sup>): slope of instantaneous frequency vs time for a <em>linear chirp</em>.
                If ω(t)=ω<sub>0</sub>+a t, then dω/dt=a.</li>
              <li><strong>Second-order nonlinearity</strong> χ(2) or coefficient d (SI depends on convention):
                enables three-wave mixing such as sum-frequency generation (SFG) and optical parametric processes.</li>
            </ul>
          </div>

          <h3>0.2 Physical meaning (intuition)</h3>
          <p>
            A chirped pulse is one whose instantaneous color changes during the pulse: early times may be “redder” and later times “bluer” (or vice versa).
            In χ(2) mixing, the nonlinear polarization can combine two waves into a third. If the frequencies vary in time, the mixing is only efficient if, at each time slice,
            the three instantaneous frequencies add correctly <em>and</em> their phases stay matched as they propagate.
          </p>

          <h3>0.3 Key laws/principles and validity conditions</h3>
          <div class="callouts">
            <div class="box">
              <strong><span class="tag keyeq">Key idea</span> Instantaneous conservation for efficient mixing</strong>
              <p>
                The hint asks us to enforce the conservation conditions not just at the carriers, but at every instant of time within the pulse.
                This is an idealized “perfect tracking” condition that neglects finite bandwidth effects beyond first-order dispersion.
              </p>
            </div>

            <div class="box">
              <strong><span class="tag assump">Validity</span> When are first-order expansions reasonable?</strong>
              <ul>
                <li>Pulses are not so broadband that higher-order dispersion (GVD, TOD) dominates.</li>
                <li>Chirp is approximately linear across the relevant temporal window.</li>
                <li>Collinear plane waves: no angular phase matching, no spatial walk-off in transverse direction.</li>
                <li>We focus on phase matching; depletion and nonlinear phase shifts are not the main constraint here.</li>
              </ul>
            </div>
          </div>

          <h3>0.4 Common models/approximations (why used)</h3>
          <ul>
            <li><strong>Linear chirp model:</strong> ω(t)=ω<sub>0</sub>+a t captures a large class of stretched/compressed pulses used in ultrafast systems.</li>
            <li><strong>First-order dispersion:</strong> k(ω) ≈ k<sub>0</sub> + (dk/dω)|<sub>0</sub>(ω−ω<sub>0</sub>) lets us connect phase matching across bandwidth to group velocity u.</li>
            <li><strong>Instantaneous matching:</strong> turns a complicated bandwidth integral into algebraic constraints on chirp slopes.</li>
          </ul>

          <h3>0.5 Mini intuition examples (quick)</h3>
          <ul>
            <li><strong>No dispersion:</strong> if u<sub>1</sub>=u<sub>2</sub>=u<sub>3</sub>, then phase matching “slope” imposes no extra weighting; chirps simply add: a<sub>3</sub>=a<sub>1</sub>+a<sub>2</sub>.</li>
            <li><strong>Strong dispersion:</strong> if u<sub>3</sub> differs strongly, then even if frequencies add, the phase mismatch across the pulse grows unless chirps are shared in a u-weighted way.</li>
            <li><strong>Engineering view:</strong> the condition a/u resembles “time-to-phase mapping”: how quickly the phase-matched k changes as ω sweeps in time.</li>
          </ul>

          <h3>0.6 What to watch for (pitfalls)</h3>
          <div class="box">
            <strong><span class="tag mist">Pitfalls</span> Common misconceptions and sign issues</strong>
            <ul>
              <li><strong>Confusing group velocity u with phase velocity c/n:</strong> phase matching uses k(ω), and its slope uses u.</li>
              <li><strong>Using only carrier phase matching:</strong> here we need matching across the chirped bandwidth (“all instants”).</li>
              <li><strong>Ignoring the definition of chirp parameter:</strong> ensure a has units rad·s<sup>−2</sup> and is dω/dt (not dt/dω).</li>
              <li><strong>Forgetting collinearity assumption:</strong> with non-collinear beams, k-vectors are vectors and constraints change.</li>
            </ul>
          </div>

          <a class="backtop" href="#top">↑ Back to top</a>
        </article>

        <section id="industry" class="animate-in">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>

          <h3>Why engineers care (industrial relevance)</h3>
          <p>
            Three-wave mixing with chirped pulses shows up wherever industry wants <strong>high-power ultrafast light</strong>, <strong>precise wavelength conversion</strong>,
            or <strong>time–frequency shaping</strong> with tight efficiency and reliability constraints. The “chirp amplification” angle is particularly relevant because it can
            produce steeper frequency sweeps without resorting to lossy dispersive elements.
          </p>

          <div class="grid2">
            <div class="box">
              <strong><span class="tag">Applications</span> Where it appears (at least 3)</strong>
              <ul>
                <li><strong>Ultrafast laser systems:</strong> OPA/OPCPA stages for amplifying broadband or chirped pulses.</li>
                <li><strong>Frequency conversion for sensing:</strong> SFG/DFG to reach mid-IR for gas detection, LIDAR bands, or eye-safe wavelengths.</li>
                <li><strong>Telecom & coherent photonics:</strong> wavelength translation, comb manipulation, and time–lens style processing in specialized links.</li>
                <li><strong>Microwave photonics:</strong> optical generation of chirped waveforms used for radar-like sweeps (photonic RF).</li>
              </ul>
            </div>

            <div class="box">
              <strong><span class="tag">Engineering drivers</span> Performance, cost, reliability</strong>
              <ul>
                <li><strong>Efficiency:</strong> phase matching across bandwidth improves conversion and reduces required pump power (cost/thermal load).</li>
                <li><strong>Pulse fidelity:</strong> preserving or tailoring chirp controls compressibility, peak power, and damage risk.</li>
                <li><strong>Manufacturability:</strong> group-velocity constraints translate into material choice, crystal cut, temperature tuning, and tolerances.</li>
              </ul>
            </div>
          </div>

          <h3>Typical measurement/validation methods</h3>
          <ul>
            <li><strong>Spectrum + phase:</strong> optical spectrum analyzers plus phase retrieval (e.g., FROG/SPIDER-style concepts in labs) to verify chirp and bandwidth.</li>
            <li><strong>Cross-correlation / autocorrelation:</strong> timing and pulse-duration checks (especially when compressing after mixing).</li>
            <li><strong>Conversion vs temperature/angle:</strong> mapping efficiency to validate phase matching and dispersion models.</li>
          </ul>

          <h3>Design trade-offs and constraints</h3>
          <ul>
            <li><strong>Material dispersion vs transparency:</strong> you want a medium that is transparent at all three frequencies, but dispersion sets u<sub>j</sub> and affects chirp sharing.</li>
            <li><strong>Walk-off and finite crystal length:</strong> group-velocity mismatch limits interaction length; tighter chirp constraints can reduce effective bandwidth if not managed.</li>
            <li><strong>Damage and thermal effects:</strong> high peak power risks optical damage; chirped operation often reduces peak intensity, improving safety margin.</li>
          </ul>

          <details>
            <summary>From lab to product: adapting the idealized model</summary>
            <div class="note">
              <p>
                Real devices rarely achieve “phase matching at all instants” exactly. Engineers instead optimize a <em>bandwidth-integrated</em> figure of merit:
                maximize conversion while keeping output pulse compressible and stable. This means including:
                (i) higher-order dispersion (GVD/TOD), (ii) spatial walk-off, (iii) temperature gradients, (iv) pump depletion, and (v) coating losses.
                The algebraic chirp conditions derived here become a <strong>design target</strong> or starting point for numerical optimization and tolerance analysis.
              </p>
            </div>
          </details>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <section id="analysis" class="animate-in">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <h3>Problem restatement (clear, in our own words)</h3>
          <p>
            Three collinear pulsed plane waves at carrier angular frequencies ω<sub>1</sub>, ω<sub>2</sub>, and ω<sub>3</sub>=ω<sub>1</sub>+ω<sub>2</sub>
            propagate in a dispersive χ(2) medium. Each wave is linearly chirped with chirp parameter a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>.
            The medium has refractive indices n<sub>1</sub>, n<sub>2</sub>, n<sub>3</sub> and group velocities u<sub>1</sub>, u<sub>2</sub>, u<sub>3</sub> at the carrier frequencies.
          </p>
          <p>
            (a) Find the relation among a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub> for efficient three-wave mixing, assuming energy and momentum conservation are satisfied at all times.
            (b) Show that the chirp of signal and/or idler can exceed that of the pump (“chirp amplification”), and discuss applications.
          </p>

          <div class="grid2">
            <div class="box">
              <strong>Given</strong>
              <ul>
                <li>ω<sub>3</sub> = ω<sub>1</sub> + ω<sub>2</sub> (central frequencies)</li>
                <li>Dispersive medium: n<sub>j</sub>, u<sub>j</sub> at each ω<sub>j</sub></li>
                <li>Linear chirps: a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub></li>
                <li>Collinear plane waves (1D propagation)</li>
              </ul>
            </div>
            <div class="box">
              <strong>Unknowns / tasks</strong>
              <ul>
                <li>Relation between chirps for (a) “always” efficient mixing</li>
                <li>Demonstrate possibility of |a<sub>signal</sub>| or |a<sub>idler</sub>| &gt; |a<sub>pump</sub>|</li>
                <li>Discuss engineering applications of chirp amplification</li>
              </ul>
            </div>
          </div>

          <h3>Relevant principles (and why)</h3>
          <ul>
            <li><strong>Energy conservation in 3-wave mixing:</strong> ω<sub>3</sub> = ω<sub>1</sub> + ω<sub>2</sub>; with chirp, apply to instantaneous ω(t).</li>
            <li><strong>Momentum conservation / phase matching:</strong> k<sub>3</sub> = k<sub>1</sub> + k<sub>2</sub>; with chirp and dispersion, apply to k(ω(t)).</li>
            <li><strong>Dispersion linearization:</strong> dk/dω = 1/u connects frequency sweep to wavevector sweep.</li>
          </ul>
          <p>
            We do <em>not</em> need detailed coupled-wave amplitudes (d, pump depletion) because the question targets chirp relationships under perfect matching assumptions.
          </p>

          <div class="box">
            <strong><span class="tag assump">Assumptions</span> Explicit idealizations used</strong>
            <ul>
              <li>Instantaneous frequency model: ω<sub>j</sub>(t)=ω<sub>j0</sub>+a<sub>j</sub>t (linear chirp, common time coordinate).</li>
              <li>First-order dispersion only: k<sub>j</sub>(ω) ≈ k<sub>j0</sub> + (1/u<sub>j</sub>)(ω−ω<sub>j0</sub>).</li>
              <li>Collinear mixing: scalars k, no angular components.</li>
              <li>Perfect matching required at all times (stronger than practical “good over bandwidth”).</li>
            </ul>
          </div>

          <h3>Possible approaches (compare 2–3)</h3>
          <ol>
            <li><strong>Instantaneous conservation + dispersion linearization (best here):</strong> set ω constraints and k constraints for all t; equate coefficients of t. <em>Pros:</em> fast, analytic, matches hint. <em>Cons:</em> ignores higher-order dispersion.</li>
            <li><strong>Time-domain phase stationary condition:</strong> write phases φ<sub>j</sub>(t,z), require Δφ(t,z)=0 for all t and z; relate chirps via derivatives. <em>Pros:</em> physically transparent; <em>Cons:</em> same algebra, slightly longer.</li>
            <li><strong>Spectral-domain bandwidth phase matching:</strong> enforce Δk(Ω)≈0 over frequency offsets Ω, then map Ω↔t via chirp. <em>Pros:</em> connects to acceptance bandwidth; <em>Cons:</em> heavier than needed.</li>
          </ol>

          <p><strong>Choice:</strong> We use approach (1) because it directly implements “at all instants” matching and cleanly introduces u<sub>j</sub> through dk/dω.</p>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <section id="strategy" class="animate-in">
          <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

          <ol>
            <li><strong>Model the chirp:</strong> write ω<sub>j</sub>(t)=ω<sub>j0</sub>+a<sub>j</sub>t. <em>Meaning:</em> a<sub>j</sub> sets how fast color sweeps in time.</li>
            <li><strong>Apply energy conservation at each time:</strong> ω<sub>3</sub>(t)=ω<sub>1</sub>(t)+ω<sub>2</sub>(t). <em>Meaning:</em> instantaneous frequency addition must hold throughout the pulse.</li>
            <li><strong>Relate k to ω via dispersion:</strong> k<sub>j</sub>(ω) ≈ k<sub>j0</sub> + (dk/dω)<sub>j</sub>(ω−ω<sub>j0</sub>), and use (dk/dω)<sub>j</sub>=1/u<sub>j</sub>. <em>Meaning:</em> frequency sweep implies wavevector sweep controlled by u<sub>j</sub>.</li>
            <li><strong>Impose phase matching for all times:</strong> k<sub>3</sub>(t)=k<sub>1</sub>(t)+k<sub>2</sub>(t). <em>Meaning:</em> the nonlinear polarization stays in phase with generated wave across the chirped bandwidth.</li>
            <li><strong>Match coefficients of t:</strong> since constraints hold ∀t, equate constant and linear terms separately. <em>Meaning:</em> carrier matching + chirp matching.</li>
            <li><strong>Solve the linear system:</strong> express a<sub>signal</sub> and a<sub>idler</sub> in terms of pump chirp and group velocities; examine when ratios exceed 1. <em>Meaning:</em> chirp amplification.</li>
            <li><strong>Interpret physically:</strong> explain how dispersion weights chirp partition; link to applications (compression, waveform generation, ultrafast conversion).</li>
          </ol>

          <div class="box">
            <strong><span class="tag mist">Common mistakes</span></strong>
            <ul>
              <li>Using n instead of u in the “chirp slope” condition (it is dk/dω, not k/ω).</li>
              <li>Assuming a<sub>3</sub>=a<sub>1</sub>+a<sub>2</sub> is sufficient (it is necessary but not sufficient in a dispersive medium).</li>
              <li>Forgetting that “at all instants” implies matching the <em>time-dependent</em> parts (the t coefficients) too.</li>
            </ul>
          </div>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <article id="solution" class="animate-in">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>3.1 Qualitative expectation (before math)</h3>
          <p>
            If each pulse’s color sweeps in time, then at a given instant t the nonlinear polarization “tries” to generate ω<sub>3</sub>(t)=ω<sub>1</sub>(t)+ω<sub>2</sub>(t).
            But efficient buildup along z also requires the generated field to stay phase-aligned with that polarization, i.e., k<sub>3</sub>(t)=k<sub>1</sub>(t)+k<sub>2</sub>(t).
            Because k depends on ω through dispersion, the wavevector sweep with time depends on group velocity. So we anticipate two conditions:
            one from frequency addition (chirps add), and one from matching the ω→k conversion (chirps add with u-weights).
          </p>

          <h3>3.2 Define the chirped instantaneous frequencies</h3>
          <p>
            We use a linear chirp model for each wave:
          </p>
          <div class="eq" id="eq-chirp">
            <pre>
ωj(t) = ωj0 + aj t    for j = 1,2,3
Units: ω (rad/s), t (s), a (rad/s^2)</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-chirp" aria-label="Copy key equation">Copy equation</button>
          </div>
          <p>
            Here ω<sub>j0</sub> is the central angular frequency, and a<sub>j</sub> is the chirp parameter (the instantaneous frequency slope).
          </p>

          <h3>3.3 Apply energy conservation at all times</h3>
          <p>
            The problem states the carrier relation ω<sub>30</sub> = ω<sub>10</sub> + ω<sub>20</sub>. The hint asks us to enforce the same at each time t:
          </p>
          <div class="eq" id="eq-energy">
            <pre>
Energy (instantaneous):  ω3(t) = ω1(t) + ω2(t)</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-energy">Copy equation</button>
          </div>
          <p>
            Substitute ω<sub>j</sub>(t)=ω<sub>j0</sub>+a<sub>j</sub>t:
          </p>
          <div class="eq" id="eq-energy-expand">
            <pre>
ω30 + a3 t = (ω10 + a1 t) + (ω20 + a2 t)
=> (ω30 - ω10 - ω20) + (a3 - a1 - a2)t = 0   for all t</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-energy-expand">Copy equation</button>
          </div>
          <p>
            Since this must hold for every t, both the constant term and the coefficient of t must vanish:
          </p>
          <div class="eq" id="eq-energy-result">
            <pre>
Carrier energy: ω30 = ω10 + ω20   (given)
Chirp (frequency-slope) condition: a3 = a1 + a2</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-energy-result">Copy equation</button>
          </div>

          <h3>3.4 Apply momentum conservation (phase matching) at all times</h3>
          <p>
            For collinear plane waves, momentum conservation is the scalar phase matching condition:
          </p>
          <div class="eq" id="eq-pm">
            <pre>
Phase matching (instantaneous):  k3(t) = k1(t) + k2(t)</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-pm">Copy equation</button>
          </div>

          <h3>3.5 Connect k(t) to ω(t) using first-order dispersion (group velocity)</h3>
          <p>
            In a dispersive medium, k depends on ω. For each wave j, expand k<sub>j</sub>(ω) around ω<sub>j0</sub> to first order:
          </p>
          <div class="eq" id="eq-disp">
            <pre>
kj(ω) ≈ kj0 + (dkj/dω)|ωj0 · (ω - ωj0)

But (dk/dω) = 1/u   (since u = dω/dk)

So:  kj(ω) ≈ kj0 + (1/uj)(ω - ωj0)</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-disp">Copy equation</button>
          </div>

          <p>
            Now evaluate at the instantaneous frequency ω<sub>j</sub>(t)=ω<sub>j0</sub>+a<sub>j</sub>t:
          </p>
          <div class="eq" id="eq-k-of-t">
            <pre>
kj(t) = kj(ωj(t)) ≈ kj0 + (1/uj)(ωj(t) - ωj0)
      = kj0 + (1/uj)(aj t)</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-k-of-t">Copy equation</button>
          </div>

          <h3>3.6 Enforce phase matching for all t and match coefficients</h3>
          <p>
            Substitute k<sub>j</sub>(t) ≈ k<sub>j0</sub> + (a<sub>j</sub>/u<sub>j</sub>)t into k<sub>3</sub>(t)=k<sub>1</sub>(t)+k<sub>2</sub>(t):
          </p>
          <div class="eq" id="eq-pm-expand">
            <pre>
k30 + (a3/u3)t = [k10 + (a1/u1)t] + [k20 + (a2/u2)t]
=> (k30 - k10 - k20) + (a3/u3 - a1/u1 - a2/u2)t = 0  for all t</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-pm-expand">Copy equation</button>
          </div>
          <p>
            Again, because this must hold for every t, both constant and linear terms must vanish:
          </p>
          <div class="eq" id="eq-pm-result">
            <pre>
Carrier phase matching: k30 = k10 + k20

Chirp (k-slope) condition:  a3/u3 = a1/u1 + a2/u2</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-pm-result">Copy equation</button>
          </div>

          <h3>3.7 Combine constraints → chirp relations for efficient mixing (Part a)</h3>
          <p>
            Therefore, the chirp parameters must satisfy two simultaneous conditions:
          </p>
          <div class="eq" id="eq-final-a">
            <pre>
(a) Efficient three-wave mixing with instantaneous energy + momentum conservation requires:

1) a3 = a1 + a2
2) a3/u3 = a1/u1 + a2/u2

(Along with carrier matching: ω30=ω10+ω20 and k30=k10+k20.)</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-final-a">Copy final (part a)</button>
          </div>

          <p>
            A particularly useful rearrangement gives the needed ratio between a<sub>1</sub> and a<sub>2</sub> (eliminate a<sub>3</sub>):
          </p>
          <div class="eq" id="eq-ratio">
            <pre>
From a3 = a1 + a2 and a3/u3 = a1/u1 + a2/u2:

(a1 + a2)/u3 = a1/u1 + a2/u2
=> a1(1/u3 - 1/u1) + a2(1/u3 - 1/u2) = 0
=> a1/a2 = (1/u3 - 1/u2) / (1/u1 - 1/u3)</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-ratio">Copy equation</button>
          </div>

          <div class="box">
            <strong><span class="tag final">Final answer (Part a)</span></strong>
            <p>
              The chirps must satisfy
              <strong>a<sub>3</sub> = a<sub>1</sub> + a<sub>2</sub></strong>
              and
              <strong>a<sub>3</sub>/u<sub>3</sub> = a<sub>1</sub>/u<sub>1</sub> + a<sub>2</sub>/u<sub>2</sub></strong>
              (plus carrier phase matching). Equivalently,
              <strong>a<sub>1</sub>/a<sub>2</sub> = (1/u<sub>3</sub> − 1/u<sub>2</sub>)/(1/u<sub>1</sub> − 1/u<sub>3</sub>)</strong>.
            </p>
          </div>

          <h3>3.8 Part (b): show “chirp amplification” is possible</h3>
          <p>
            In many practical cases, wave 3 is the <strong>pump</strong> (p), wave 1 is the <strong>signal</strong> (s), and wave 2 is the <strong>idler</strong> (i),
            with ω<sub>p</sub>=ω<sub>s</sub>+ω<sub>i</sub>. Rename:
          </p>
          <div class="eq" id="eq-rename">
            <pre>
Pump:   (3) => p,  chirp ap, group velocity up
Signal: (1) => s,  chirp as, group velocity us
Idler:  (2) => i,  chirp ai, group velocity ui</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-rename">Copy</button>
          </div>

          <p>
            The two constraints become a linear system:
          </p>
          <div class="eq" id="eq-system">
            <pre>
ap = as + ai
ap/up = as/us + ai/ui</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-system">Copy</button>
          </div>

          <p>
            Solve for as and ai in terms of ap and group velocities. Substitute ai = ap − as into the second equation:
          </p>
          <div class="eq" id="eq-solve">
            <pre>
ap/up = as/us + (ap - as)/ui
=> ap/up = as(1/us - 1/ui) + ap/ui
=> as(1/us - 1/ui) = ap(1/up - 1/ui)

Therefore:
as = ap * ( (1/up - 1/ui) / (1/us - 1/ui) )

Similarly:
ai = ap - as
   = ap * ( (1/us - 1/up) / (1/us - 1/ui) )</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-solve">Copy equation</button>
          </div>

          <p>
            Define the <strong>chirp gains</strong> (dimensionless) relative to the pump:
          </p>
          <div class="eq" id="eq-gains">
            <pre>
Gs ≡ as/ap = ( (1/up - 1/ui) / (1/us - 1/ui) )
Gi ≡ ai/ap = ( (1/us - 1/up) / (1/us - 1/ui) )

Note: Gs + Gi = 1  (because ap = as + ai)</pre>
          </div>
          <div class="toolbar">
            <button class="copy" data-copy-target="eq-gains">Copy equation</button>
          </div>

          <p>
            Even though G<sub>s</sub>+G<sub>i</sub>=1, either coefficient can exceed 1 in magnitude if the other becomes negative (opposite-signed chirp),
            which can happen depending on the ordering of inverse group velocities (1/u). For example, if 1/u<sub>p</sub> lies outside the interval between 1/u<sub>s</sub> and 1/u<sub>i</sub>,
            then one of the numerators becomes larger than the denominator, potentially producing |G|&gt;1.
          </p>

          <div class="box">
            <strong><span class="tag final">Final answer (Part b)</span></strong>
            <p>
              The output chirps are
              <strong>a<sub>s</sub> = a<sub>p</sub> · ((1/u<sub>p</sub> − 1/u<sub>i</sub>)/(1/u<sub>s</sub> − 1/u<sub>i</sub>))</strong>
              and
              <strong>a<sub>i</sub> = a<sub>p</sub> · ((1/u<sub>s</sub> − 1/u<sub>p</sub>)/(1/u<sub>s</sub> − 1/u<sub>i</sub>))</strong>.
              Depending on u<sub>p</sub>, u<sub>s</sub>, u<sub>i</sub>, either |a<sub>s</sub>| or |a<sub>i</sub>| can exceed |a<sub>p</sub>|
              (chirp amplification), typically with the other output acquiring an opposite-signed chirp so that a<sub>p</sub>=a<sub>s</sub>+a<sub>i</sub> remains true.
            </p>
          </div>

          <h3>3.9 Sanity checks</h3>
          <ul>
            <li><strong>Units:</strong> a has units rad·s<sup>−2</sup>, u has m·s<sup>−1</sup>, so a/u has rad·m<sup>−1</sup>·s<sup>−1</sup>.
              Multiplying by t (s) gives rad·m<sup>−1</sup>, consistent with a wavevector contribution.</li>
            <li><strong>Limiting case (no dispersion differences):</strong> if u<sub>1</sub>=u<sub>2</sub>=u<sub>3</sub>, then (2) reduces to (a<sub>3</sub>=a<sub>1</sub>+a<sub>2</sub>), consistent.</li>
            <li><strong>Physical interpretation:</strong> the second condition ensures the <em>time-dependent</em> part of the phase mismatch stays zero—i.e., the chirped bandwidth remains phase matched, not just the carrier.</li>
          </ul>

          <div class="toolbar">
            <button class="copy" data-copy-target="eq-final-a" aria-label="Copy final answer plain text">Copy final answer (plain)</button>
            <button class="copy" data-copy-target="eq-gains">Copy chirp-gain formulas (plain)</button>
          </div>

          <a class="backtop" href="#top">↑ Back to top</a>
        </article>

        <section id="deeper" class="animate-in">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>4.1 Re-interpret the final formula</h3>
          <p>
            The pair of conditions
            <strong>a<sub>3</sub>=a<sub>1</sub>+a<sub>2</sub></strong> and
            <strong>a<sub>3</sub>/u<sub>3</sub>=a<sub>1</sub>/u<sub>1</sub>+a<sub>2</sub>/u<sub>2</sub></strong>
            can be read as:
          </p>
          <ul>
            <li><strong>Energy constraint:</strong> time-dependent frequencies must add.</li>
            <li><strong>Dispersion-weighted momentum constraint:</strong> time-dependent wavevectors must add, and because dk/dω=1/u, the time-slope of k is a/u.</li>
          </ul>
          <p>
            Engineers often think of this as matching not only Δk(ω<sub>0</sub>)=0 but also the <strong>first derivative</strong> of Δk with respect to frequency across the pulse’s swept bandwidth.
          </p>

          <h3>4.2 Parameter dependence (qualitative)</h3>
          <ul>
            <li>If u<sub>3</sub> is close to u<sub>1</sub>, then the term (1/u<sub>1</sub>−1/u<sub>3</sub>) is small, pushing the ratio a<sub>1</sub>/a<sub>2</sub> to larger magnitude: the system tends to “load” chirp into the other wave to keep k-matching.</li>
            <li>If u<sub>1</sub>≈u<sub>2</sub>, then the denominator (1/u<sub>1</sub>−1/u<sub>3</sub>) and numerator (1/u<sub>3</sub>−1/u<sub>2</sub>) can be comparable, making chirp partition more balanced.</li>
            <li>“Chirp amplification” (|G|&gt;1) becomes likely when 1/u<sub>p</sub> sits outside the range spanned by 1/u<sub>s</sub> and 1/u<sub>i</sub>, forcing one output to take an opposite-signed chirp.</li>
          </ul>

          <details>
            <summary>Alternative derivation idea (brief but meaningful)</summary>
            <div class="note">
              <p>
                You can derive the same chirp conditions by writing each field phase as
                φ<sub>j</sub>(t,z)=k<sub>j</sub>(ω<sub>j</sub>(t))z − ∫ ω<sub>j</sub>(t) dt,
                then forming the phase mismatch Δφ=φ<sub>3</sub>−φ<sub>1</sub>−φ<sub>2</sub>.
                Requiring ∂Δφ/∂z=0 gives k<sub>3</sub>=k<sub>1</sub>+k<sub>2</sub>, and requiring the mismatch not to develop across the pulse gives ∂(Δk)/∂t=0,
                which leads directly to a<sub>3</sub>/u<sub>3</sub>=a<sub>1</sub>/u<sub>1</sub>+a<sub>2</sub>/u<sub>2</sub>.
              </p>
            </div>
          </details>

          <h3>4.3 Concept check (self-test, with answers)</h3>
          <ul>
            <li><strong>Q:</strong> Why does group velocity appear in the chirp condition? <strong>A:</strong> Because to keep phase matching across a frequency sweep, you must match how k changes with ω; dk/dω = 1/u.</li>
            <li><strong>Q:</strong> Is a<sub>3</sub>=a<sub>1</sub>+a<sub>2</sub> enough for efficient mixing in a dispersive medium? <strong>A:</strong> Not in general; you also need a<sub>3</sub>/u<sub>3</sub>=a<sub>1</sub>/u<sub>1</sub>+a<sub>2</sub>/u<sub>2</sub>.</li>
            <li><strong>Q:</strong> How can |a<sub>s</sub>| exceed |a<sub>p</sub>| if a<sub>p</sub>=a<sub>s</sub>+a<sub>i</sub>? <strong>A:</strong> If a<sub>i</sub> has opposite sign, then the sum can remain smaller while one term is larger in magnitude.</li>
            <li><strong>Q:</strong> What non-idealities most quickly break “instantaneous matching”? <strong>A:</strong> Higher-order dispersion (GVD/TOD), group-velocity walk-off, and limited phase-matching bandwidth.</li>
          </ul>

          <h3>4.4 Applied applications of “chirp amplification” (discussion)</h3>
          <div class="grid2">
            <div class="box">
              <strong><span class="tag">Applications</span> What it enables</strong>
              <ul>
                <li><strong>Steeper sweeps for photonic RF:</strong> generate large-chirp optical waveforms that map to wideband chirped microwave signals after detection.</li>
                <li><strong>Pulse compression strategy:</strong> amplify or convert a chirped pulse, then compress with a smaller/lighter dispersive stage because the chirp is larger (or engineered in sign).</li>
                <li><strong>Broadband OPA/OPCPA shaping:</strong> distribute pump chirp into signal/idler in a controlled way to maximize gain bandwidth and compressibility.</li>
              </ul>
            </div>
            <div class="box">
              <strong><span class="tag">Industrial lens</span> Why it’s valuable</strong>
              <ul>
                <li><strong>Efficiency & cost:</strong> achieving waveform shaping in the nonlinear stage can reduce downstream optics count and insertion loss.</li>
                <li><strong>Reliability:</strong> chirped operation lowers peak intensity inside crystals, improving damage margin.</li>
                <li><strong>System integration:</strong> engineered chirp can simplify packaging (shorter compressor, fewer dispersion-sensitive components).</li>
              </ul>
            </div>
          </div>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <section id="plotguide" class="animate-in">
          <h2>PART 5 — Optional Plot Guide</h2>
          <p>
            A plot is useful here because “chirp amplification” is easiest to see by visualizing the chirp gain
            G<sub>s</sub>=a<sub>s</sub>/a<sub>p</sub> and G<sub>i</sub>=a<sub>i</sub>/a<sub>p</sub> as group velocities vary.
            The final answers remain symbolic; the plot uses clearly labeled <em>example values</em>.
          </p>

          <figure>
            <canvas id="plot" width="980" height="520" aria-label="Chirp gain plot (static)"></canvas>
            <figcaption>
              <strong>Static plot (example values):</strong>
              Fix u<sub>s</sub>=1.85×10<sup>8</sup> m/s and u<sub>i</sub>=2.25×10<sup>8</sup> m/s. Sweep u<sub>p</sub> across a range.
              The curves show G<sub>s</sub>=(1/u<sub>p</sub>−1/u<sub>i</sub>)/(1/u<sub>s</sub>−1/u<sub>i</sub>) and G<sub>i</sub>=1−G<sub>s</sub>.
              Regions where G<sub>s</sub>&gt;1 or G<sub>i</sub>&gt;1 correspond to “chirp amplification” (one output chirp magnitude exceeds the pump’s).
            </figcaption>
          </figure>

          <div class="box">
            <strong><span class="tag keyeq">What to notice</span></strong>
            <ul>
              <li><strong>Axes:</strong> x-axis is pump group velocity u<sub>p</sub> (m/s). y-axis is chirp gain (dimensionless).</li>
              <li><strong>Amplification:</strong> when G<sub>s</sub> rises above 1, the signal chirp exceeds pump chirp; then G<sub>i</sub>=1−G<sub>s</sub> becomes negative, meaning idler chirp flips sign.</li>
              <li><strong>Dispersion control knob:</strong> shifting u<sub>p</sub> (via material choice, temperature, wavelength) changes chirp partition.</li>
            </ul>
          </div>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>
      </div>
    </div>
  </main>

  <footer>
    <div class="wrap">
      <div><strong>Takeaway:</strong> For chirped-pulse three-wave mixing in a dispersive medium, “efficient at all instants” requires matching both frequency sums and dispersion-weighted wavevector sums.</div>
      <div>Built with vanilla HTML/CSS/JS. Print-friendly and suitable for technical learning notes.</div>
    </div>
  </footer>

  <script>
    (function(){
      // Copy buttons: copy plain text of the <pre> inside the target element.
      function textFromTarget(id){
        var el = document.getElementById(id);
        if(!el) return "";
        var pre = el.querySelector("pre");
        return (pre ? pre.innerText : el.innerText).trim();
      }

      async function copyText(txt){
        try{
          await navigator.clipboard.writeText(txt);
          return true;
        }catch(e){
          // Fallback
          try{
            var ta = document.createElement("textarea");
            ta.value = txt;
            ta.setAttribute("readonly","");
            ta.style.position="fixed";
            ta.style.left="-9999px";
            document.body.appendChild(ta);
            ta.select();
            document.execCommand("copy");
            document.body.removeChild(ta);
            return true;
          }catch(e2){
            return false;
          }
        }
      }

      document.querySelectorAll("button.copy").forEach(function(btn){
        btn.addEventListener("click", async function(){
          var id = btn.getAttribute("data-copy-target");
          var txt = textFromTarget(id);
          if(!txt) return;
          var ok = await copyText(txt);
          var old = btn.textContent;
          btn.textContent = ok ? "Copied!" : "Copy failed";
          btn.style.borderColor = ok ? "rgba(124,240,198,0.45)" : "rgba(255,107,139,0.45)";
          setTimeout(function(){
            btn.textContent = old;
            btn.style.borderColor = "rgba(255,255,255,0.18)";
          }, 1100);
        });
      });

      // Static plot (responsive redraw) using example values.
      var canvas = document.getElementById("plot");
      if(!canvas) return;

      function draw(){
        var parent = canvas.parentElement;
        var cssW = Math.max(320, parent.clientWidth - 2);
        var cssH = Math.max(260, Math.round(cssW * 0.52));
        var dpr = Math.max(1, Math.min(2.5, window.devicePixelRatio || 1));

        canvas.style.width = cssW + "px";
        canvas.style.height = cssH + "px";
        canvas.width = Math.round(cssW * dpr);
        canvas.height = Math.round(cssH * dpr);

        var ctx = canvas.getContext("2d");
        ctx.setTransform(dpr,0,0,dpr,0,0);
        ctx.clearRect(0,0,cssW,cssH);

        // Example values (clearly stated in caption)
        var us = 1.85e8;
        var ui = 2.25e8;

        // Domain for up
        var xmin = 1.5e8, xmax = 2.6e8;

        // Determine y-range by sampling
        var samples = 400;
        var ys = [];
        for(var i=0;i<=samples;i++){
          var up = xmin + (xmax-xmin)*i/samples;
          var Gs = ((1/up)-(1/ui))/((1/us)-(1/ui));
          var Gi = 1 - Gs;
          ys.push(Gs, Gi);
        }
        var ymin = Math.min.apply(null, ys);
        var ymax = Math.max.apply(null, ys);

        // Pad y-range
        var pad = 0.12*(ymax-ymin || 1);
        ymin -= pad; ymax += pad;

        // Plot area
        var m = {l:64, r:18, t:34, b:54};
        var W = cssW, H = cssH;
        var pw = W - m.l - m.r;
        var ph = H - m.t - m.b;

        function X(x){ return m.l + (x - xmin) * pw / (xmax - xmin); }
        function Y(y){ return m.t + (ymax - y) * ph / (ymax - ymin); }

        // Background panel
        ctx.fillStyle = "rgba(10,14,28,0.35)";
        ctx.fillRect(m.l, m.t, pw, ph);

        // Gridlines
        ctx.strokeStyle = "rgba(255,255,255,0.10)";
        ctx.lineWidth = 1;

        var xTicks = 6;
        for(var tx=0; tx<=xTicks; tx++){
          var x = xmin + (xmax-xmin)*tx/xTicks;
          var xx = X(x);
          ctx.beginPath();
          ctx.moveTo(xx, m.t);
          ctx.lineTo(xx, m.t+ph);
          ctx.stroke();
        }

        var yTicks = 6;
        for(var ty=0; ty<=yTicks; ty++){
          var y = ymin + (ymax-ymin)*ty/yTicks;
          var yy = Y(y);
          ctx.beginPath();
          ctx.moveTo(m.l, yy);
          ctx.lineTo(m.l+pw, yy);
          ctx.stroke();
        }

        // Axes
        ctx.strokeStyle = "rgba(255,255,255,0.22)";
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(m.l, m.t);
        ctx.lineTo(m.l, m.t+ph);
        ctx.lineTo(m.l+pw, m.t+ph);
        ctx.stroke();

        // Labels & ticks text
        ctx.fillStyle = "rgba(234,240,255,0.92)";
        ctx.font = "600 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "top";

        for(var tx2=0; tx2<=xTicks; tx2++){
          var x2 = xmin + (xmax-xmin)*tx2/xTicks;
          var xx2 = X(x2);
          var lab = (x2/1e8).toFixed(2) + "×10^8";
          ctx.fillText(lab, xx2, m.t+ph+10);
        }
        ctx.textAlign = "right";
        ctx.textBaseline = "middle";
        for(var ty2=0; ty2<=yTicks; ty2++){
          var y2 = ymin + (ymax-ymin)*ty2/yTicks;
          var yy2 = Y(y2);
          ctx.fillText(y2.toFixed(2), m.l-10, yy2);
        }

        // Title
        ctx.textAlign = "left";
        ctx.textBaseline = "alphabetic";
        ctx.font = "700 13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillText("Chirp partition (example): Gs = as/ap and Gi = ai/ap vs pump group velocity up", m.l, 18);

        // Axis titles
        ctx.font = "600 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillStyle = "rgba(234,240,255,0.85)";
        ctx.textAlign = "center";
        ctx.fillText("up (m/s)", m.l + pw/2, H - 14);

        // y-axis title (rotated)
        ctx.save();
        ctx.translate(16, m.t + ph/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = "center";
        ctx.fillText("chirp gain (dimensionless)", 0, 0);
        ctx.restore();

        // Draw curves: Gs (accent), Gi (accent2)
        function drawCurve(fn, strokeStyle){
          ctx.strokeStyle = strokeStyle;
          ctx.lineWidth = 2.2;
          ctx.beginPath();
          for(var i=0;i<=samples;i++){
            var up = xmin + (xmax-xmin)*i/samples;
            var y = fn(up);
            var xx = X(up);
            var yy = Y(y);
            if(i===0) ctx.moveTo(xx,yy);
            else ctx.lineTo(xx,yy);
          }
          ctx.stroke();
        }

        drawCurve(function(up){
          return ((1/up)-(1/ui))/((1/us)-(1/ui));
        }, "rgba(124,240,198,0.95)");

        drawCurve(function(up){
          var Gs = ((1/up)-(1/ui))/((1/us)-(1/ui));
          return 1 - Gs;
        }, "rgba(255,204,102,0.95)");

        // Draw y=1 and y=0 reference lines
        function hline(y, style){
          ctx.strokeStyle = style;
          ctx.lineWidth = 1.3;
          ctx.setLineDash([6,6]);
          ctx.beginPath();
          ctx.moveTo(m.l, Y(y));
          ctx.lineTo(m.l+pw, Y(y));
          ctx.stroke();
          ctx.setLineDash([]);
        }
        hline(1, "rgba(255,255,255,0.22)");
        hline(0, "rgba(255,255,255,0.18)");

        // Legend
        var lx = m.l + 12, ly = m.t + 10;
        ctx.fillStyle = "rgba(0,0,0,0.28)";
        ctx.strokeStyle = "rgba(255,255,255,0.14)";
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.roundRect(lx, ly, 210, 58, 12);
        ctx.fill();
        ctx.stroke();

        ctx.font = "600 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillStyle = "rgba(234,240,255,0.90)";
        ctx.textAlign = "left";
        ctx.textBaseline = "middle";

        // Legend items
        function legItem(y, color, text){
          ctx.strokeStyle = color;
          ctx.lineWidth = 3;
          ctx.beginPath();
          ctx.moveTo(lx+12, y);
          ctx.lineTo(lx+42, y);
          ctx.stroke();
          ctx.fillText(text, lx+52, y);
        }
        legItem(ly+20, "rgba(124,240,198,0.95)", "Gs = as/ap (signal)");
        legItem(ly+40, "rgba(255,204,102,0.95)", "Gi = ai/ap (idler)");

        // Note line about example us/ui
        ctx.font = "500 11px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillStyle = "rgba(234,240,255,0.78)";
        ctx.fillText("Example: us=1.85e8 m/s, ui=2.25e8 m/s", m.l+pw-4, m.t+ph-10);
        ctx.textAlign = "right";
      }

      // Polyfill for roundRect if needed
      if(CanvasRenderingContext2D && !CanvasRenderingContext2D.prototype.roundRect){
        CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
          r = Math.max(0, Math.min(r, Math.min(w,h)/2));
          this.beginPath();
          this.moveTo(x+r, y);
          this.arcTo(x+w, y, x+w, y+h, r);
          this.arcTo(x+w, y+h, x, y+h, r);
          this.arcTo(x, y+h, x, y, r);
          this.arcTo(x, y, x+w, y, r);
          this.closePath();
          return this;
        };
      }

      draw();
      var ro = new ResizeObserver(function(){ draw(); });
      ro.observe(canvas.parentElement);

      window.addEventListener("resize", function(){ draw(); }, {passive:true});
    })();
  </script>
</body>
</html>
