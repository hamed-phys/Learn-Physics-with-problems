<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Relation Between Nonlinear-Optical and Electro-Optic Coefficients (Saleh &amp; Teich, Ch. 22.6-2)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1620;
      --panel2:#101b27;
      --text:#eaf2ff;
      --muted:#b7c6de;
      --faint:#7f93b3;
      --line:rgba(255,255,255,.10);
      --line2:rgba(255,255,255,.16);
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#86efac;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --radius: 18px;
      --radius2: 14px;
      --max: 1100px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font: 16px/1.65 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1100px 700px at 12% 8%, rgba(125,211,252,.18), transparent 55%),
        radial-gradient(900px 600px at 82% 12%, rgba(167,139,250,.16), transparent 55%),
        radial-gradient(900px 700px at 55% 92%, rgba(134,239,172,.10), transparent 60%),
        linear-gradient(180deg, #070a0f 0%, #0b0f14 60%, #070a0f 100%);
      overflow-x:hidden;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      position:relative;
      padding: 44px 20px 18px;
    }
    .wrap{max-width:var(--max); margin:0 auto}
    .hero{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
      align-items:stretch;
    }
    .titleCard{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding: 22px 22px 18px;
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .titleCard:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(600px 220px at 20% 0%, rgba(125,211,252,.20), transparent 60%),
        radial-gradient(520px 220px at 95% 10%, rgba(167,139,250,.20), transparent 60%);
      pointer-events:none;
      opacity:.9;
      filter: blur(0px);
    }
    .titleCard > *{position:relative}
    h1{
      margin:0 0 10px;
      font-size: clamp(22px, 2.6vw, 34px);
      letter-spacing: .2px;
      line-height:1.18;
    }
    .subtitle{
      color:var(--muted);
      margin:0 0 8px;
      font-size: 15px;
    }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      color:var(--faint);
      font-size: 13px;
      margin-top:10px;
    }
    .pill{
      border:1px solid var(--line2);
      background: rgba(255,255,255,.04);
      padding: 6px 10px;
      border-radius: 999px;
      display:inline-flex;
      gap:8px;
      align-items:center;
      backdrop-filter: blur(8px);
    }
    .pill b{color:var(--text); font-weight:650}
    .tocCard{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.025));
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding: 16px 16px 12px;
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .tocCard h2{
      margin:0 0 8px;
      font-size: 14px;
      letter-spacing:.6px;
      text-transform: uppercase;
      color: var(--muted);
    }
    nav ol{
      margin:0;
      padding-left: 18px;
      color: var(--muted);
      font-size: 14px;
    }
    nav li{margin:6px 0}
    nav a{color:var(--text)}
    .stickyToc{
      position:sticky;
      top: 12px;
    }

    main{padding: 6px 20px 60px}
    section{
      margin-top: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    section > header{
      padding: 16px 18px 8px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      margin:0;
    }
    section > header h2{
      margin:0;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .content{
      padding: 14px 18px 18px;
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
    }
    .card{
      background: rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.09);
      border-radius: var(--radius2);
      padding: 14px 14px 12px;
    }
    .card h3{
      margin:0 0 8px;
      font-size: 15px;
      letter-spacing:.2px;
      color: var(--text);
    }
    .card p, .card ul{margin: 8px 0}
    ul{padding-left: 18px}
    li{margin: 6px 0; color: var(--muted)}
    p{margin: 10px 0; color: var(--muted)}
    .note{color:var(--faint)}
    .callouts{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
      margin-top: 10px;
    }
    .callout{
      grid-column: span 12;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.025));
      border:1px solid rgba(255,255,255,.10);
      border-radius: var(--radius2);
      padding: 12px 12px 10px;
      position:relative;
      overflow:hidden;
    }
    .callout:before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(500px 180px at 10% 0%, rgba(125,211,252,.10), transparent 60%);
      opacity:.9;
      pointer-events:none;
    }
    .callout > *{position:relative}
    .callout strong{color:var(--text)}
    .callout.good{border-color: rgba(134,239,172,.22)}
    .callout.good:before{background: radial-gradient(520px 200px at 10% 0%, rgba(134,239,172,.14), transparent 65%)}
    .callout.warn{border-color: rgba(251,191,36,.22)}
    .callout.warn:before{background: radial-gradient(520px 200px at 10% 0%, rgba(251,191,36,.14), transparent 65%)}
    .callout.bad{border-color: rgba(251,113,133,.24)}
    .callout.bad:before{background: radial-gradient(520px 200px at 10% 0%, rgba(251,113,133,.14), transparent 65%)}
    .eq{
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 12px 12px 10px;
      margin: 10px 0;
      position:relative;
      overflow:hidden;
    }
    .eq .row{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
    }
    .eq pre{
      margin:0;
      white-space: pre-wrap;
      word-break: break-word;
      color: #eaf2ff;
      font: 14px/1.45 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    }
    .copyBtn{
      flex:0 0 auto;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-size: 13px;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      user-select:none;
    }
    .copyBtn:hover{background: rgba(255,255,255,.09); border-color: rgba(255,255,255,.28)}
    .copyBtn:active{transform: translateY(1px) scale(.99)}
    .copyState{
      margin-left: 8px;
      font-size: 12px;
      color: var(--faint);
      min-height: 16px;
    }
    details{
      margin: 10px 0 0;
      border:1px dashed rgba(255,255,255,.16);
      background: rgba(255,255,255,.02);
      border-radius: 14px;
      padding: 10px 10px 8px;
    }
    details summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 650;
      outline:none;
    }
    details p, details ul{margin: 8px 0}
    .twoCol{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .small{
      font-size: 13.5px;
      color: var(--muted);
    }
    .backTop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      color: var(--text);
      text-decoration:none;
      transition: background .2s ease, border-color .2s ease, transform .08s ease;
    }
    .backTop:hover{background: rgba(255,255,255,.07); border-color: rgba(255,255,255,.22); text-decoration:none}
    .backTop:active{transform: translateY(1px)}
    footer{
      padding: 22px 20px 44px;
      color: var(--faint);
    }
    .footerCard{
      max-width: var(--max);
      margin:0 auto;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius: var(--radius);
      padding: 14px 16px;
      box-shadow: var(--shadow);
    }

    /* responsive */
    @media (max-width: 920px){
      .hero{grid-template-columns: 1fr}
      .stickyToc{position:relative; top:auto}
      .grid2{grid-template-columns: 1fr}
      .twoCol{grid-template-columns: 1fr}
    }

    /* micro animation */
    @media (prefers-reduced-motion: no-preference){
      .titleCard, .tocCard, section{animation: pop .55s ease both}
      .tocCard{animation-delay:.06s}
      section:nth-of-type(1){animation-delay:.05s}
      section:nth-of-type(2){animation-delay:.08s}
      section:nth-of-type(3){animation-delay:.11s}
      section:nth-of-type(4){animation-delay:.14s}
      section:nth-of-type(5){animation-delay:.17s}
      @keyframes pop{
        from{transform: translateY(10px); opacity:0}
        to{transform: translateY(0); opacity:1}
      }
    }

    /* print-friendly */
    @media print{
      :root{--bg:#fff; --panel:#fff; --text:#000; --muted:#111; --faint:#333; --line:#bbb; --line2:#999}
      body{background:#fff; color:#000}
      a{color:#000; text-decoration:underline}
      .tocCard{display:none}
      .copyBtn, .copyState{display:none !important}
      section{break-inside: avoid; box-shadow:none}
      .titleCard, section, .footerCard{box-shadow:none}
      .backTop{display:none}
      header{padding-top: 10px}
    }
  </style>
</head>

<body>
  <a id="top"></a>
  <header>
    <div class="wrap hero">
      <div class="titleCard">
        <h1>Relation Between Nonlinear-Optical and Electro-Optic Coefficients</h1>
        <p class="subtitle">
          Proving how the <span style="color:var(--accent)">Pockels</span> (linear electro-optic) and
          <span style="color:var(--accent2)">Kerr</span> (quadratic electro-optic) tensors follow directly from
          the inverse-tensor relation between the dielectric tensor and the impermeability tensor.
        </p>
        <div class="meta">
          <span class="pill"><b>Goal</b> derive <span style="color:var(--text)">r<sub>ijk</sub></span> and <span style="color:var(--text)">s<sub>ijkl</sub></span> from <span style="color:var(--text)">d<sub>ijk</sub></span>, <span style="color:var(--text)">χ<sup>(3)</sup><sub>ijkl</sub></span></span>
          <span class="pill"><b>Type</b> symbolic proof</span>
          <span class="pill"><b>Tool</b> matrix increment identity</span>
        </div>
      </div>

      <div class="tocCard stickyToc" aria-label="Table of contents">
        <h2>Table of Contents</h2>
        <nav>
          <ol>
            <li><a href="#quick">Quick Summary</a></li>
            <li><a href="#primer">Part 0 — Concept Primer</a></li>
            <li><a href="#analysis">Part 1 — Problem Analysis</a></li>
            <li><a href="#strategy">Part 2 — Strategy &amp; Tips</a></li>
            <li><a href="#solution">Part 3 — Full Solution</a></li>
            <li><a href="#deeper">Part 4 — Deeper Understanding</a></li>
            <li><a href="#plot">Part 5 — Optional Plot Guide</a></li>
          </ol>
        </nav>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- Quick Summary -->
    <section id="quick">
      <header><h2>Quick Summary</h2></header>
      <div class="content">
        <ul>
          <li>This problem connects <b>electro-optic coefficients</b> (how refractive properties change under a DC field) to <b>nonlinear-optical coefficients</b> (how polarization depends nonlinearly on fields).</li>
          <li>Key physics idea: a DC field modifies the <b>effective dielectric tensor at optical frequency</b> through nonlinear polarization mixing (Pockels: second order; Kerr: third order).</li>
          <li>Key math idea: the <b>impermeability tensor</b> is the inverse of the dielectric tensor, so small changes satisfy <b>Δη = −η(Δε)η</b>.</li>
          <li>Governing relations (definitions):
            <span class="note">Δη<sub>ij</sub> = r<sub>ijk</sub>E<sub>k</sub> (Pockels), &nbsp;&nbsp; Δη<sub>ij</sub> = s<sub>ijkl</sub>E<sub>k</sub>E<sub>l</sub> (Kerr).</span>
          </li>
          <li>Result type: <b>symbolic tensor identities</b> valid in the crystal principal axes (and as tensor relations in general).</li>
          <li>Main results to prove:
            <span class="note">r<sub>ijk</sub> = −4ε<sub>0</sub>d<sub>ijk</sub>/(ε<sub>ii</sub>ε<sub>jj</sub>) and s<sub>ijkl</sub> = −12ε<sub>0</sub>χ<sup>(3)</sup><sub>ijkl</sub>/(ε<sub>ii</sub>ε<sub>jj</sub>).</span>
          </li>
          <li>Physical meaning: electro-optic response is <b>stronger</b> when nonlinear susceptibilities are large and when the optical dielectric constants are <b>smaller</b> (because the inverse tensor amplifies changes).</li>
        </ul>

        <div class="callouts">
          <div class="callout good">
            <strong>Takeaway:</strong> Once you know how the DC field perturbs ε at optical frequency (through nonlinear mixing),
            the electro-optic tensors follow immediately by inverting ε.
          </div>
        </div>

        <a class="backTop" href="#top" aria-label="Back to top">↑ Back to top</a>
      </div>
    </section>

    <!-- Part 0 Primer -->
    <section id="primer">
      <header><h2>PART 0 — Concept Primer (Theory Before Solving)</h2></header>
      <div class="content">
        <div class="grid2">
          <div class="card">
            <h3>Core definitions (symbols + SI units)</h3>
            <ul>
              <li><b>E</b> — electric field (V/m). We will use:
                <span class="note">an optical field e(ω) and a quasi-static/DC bias field E(0).</span>
              </li>
              <li><b>D</b> — electric displacement (C/m²).</li>
              <li><b>P</b> — polarization (C/m²), with expansion:
                <span class="note">P = P<sup>(1)</sup> + P<sup>(2)</sup> + P<sup>(3)</sup> + …</span>
              </li>
              <li><b>ε<sub>ij</sub></b> — dielectric tensor at optical frequency (SI: F/m).</li>
              <li><b>η<sub>ij</sub></b> — impermeability tensor, defined by <b>η = ε<sup>−1</sup></b> (SI: m/F).</li>
              <li><b>d<sub>ijk</sub></b> — second-order nonlinear coefficient (often with units m/V in optics conventions).</li>
              <li><b>χ<sup>(3)</sup><sub>ijkl</sub></b> — third-order susceptibility (units m²/V² in optics conventions).</li>
              <li><b>r<sub>ijk</sub></b> — linear electro-optic (Pockels) tensor (m/V).</li>
              <li><b>s<sub>ijkl</sub></b> — quadratic electro-optic (Kerr) tensor (m²/V²).</li>
              <li><b>ε<sub>0</sub></b> — vacuum permittivity (F/m).</li>
            </ul>
          </div>

          <div class="card">
            <h3>Physical meaning (intuition)</h3>
            <ul>
              <li><b>Nonlinear optics</b> tells you how a medium generates polarization at a given frequency when driven by multiple fields (possibly at different frequencies).</li>
              <li><b>Electro-optic effect</b> is a special case: a <b>DC</b> field changes the medium’s optical response, i.e., it changes the effective ε (hence refractive indices).</li>
              <li>The reason <b>η = ε<sup>−1</sup></b> matters:
                many EO textbooks define the effect as a change in <b>impermeability</b> because index ellipsoids are naturally written in terms of 1/n².</li>
              <li>So the workflow is:
                <b>DC field → nonlinear polarization mixing → Δε → Δ(ε<sup>−1</sup>)</b>.</li>
            </ul>
          </div>
        </div>

        <div class="callouts">
          <div class="callout">
            <strong>Key law (constitutive relation at optical frequency):</strong>
            <div class="eq" data-copy="D_i(ω) = ε_{ij} E_j(ω)  (linear optics)
and in presence of a DC bias, ε_{ij} becomes ε_{ij}(E(0)) so D_i(ω)=ε_{ij}(E(0))E_j(ω).">
              <div class="row">
                <pre>D_i(ω) = ε_{ij} E_j(ω)  (linear optics)
and with DC bias:  D_i(ω) = ε_{ij}(E(0)) E_j(ω)</pre>
                <button class="copyBtn" type="button" aria-label="Copy equation">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>
            <p class="small">Electro-optic coefficients are essentially derivatives of ε (or ε<sup>−1</sup>) with respect to the DC field.</p>
          </div>

          <div class="callout good">
            <strong>Matrix increment identity (the hint):</strong>
            <div class="eq" data-copy="If B = A^{-1}, then ΔB = -A^{-1}(ΔA)A^{-1}.">
              <div class="row">
                <pre>If B = A^{-1}, then  ΔB = −A^{-1}(ΔA)A^{-1}.</pre>
                <button class="copyBtn" type="button" aria-label="Copy equation">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>
            <p class="small">Here, set A = ε and B = η = ε<sup>−1</sup>.</p>
          </div>
        </div>

        <details>
          <summary>Validity conditions &amp; assumptions in typical EO derivations</summary>
          <ul>
            <li><b>Small-signal optics:</b> the optical field is treated as a weak probe; the DC bias sets the operating point.</li>
            <li><b>Instantaneous (or effectively static) bias:</b> E(0) varies slowly compared with the optical period, so it acts as a constant during optical response.</li>
            <li><b>Linearization in the optical probe:</b> keep only terms <em>linear</em> in the optical field at frequency ω when building ε<sub>ij</sub>(E(0)).</li>
            <li><b>Principal axes (when simplifying):</b> choosing crystal axes where ε is diagonal makes the final r and s expressions simple with ε<sub>ii</sub>ε<sub>jj</sub> in the denominator.</li>
          </ul>
        </details>

        <details>
          <summary>Mini intuition examples (conceptual, minimal algebra)</summary>
          <ul>
            <li><b>Pockels effect:</b> A DC field breaks symmetry and linearly tilts the index ellipsoid. Mathematically: ε changes <em>linearly</em> with E(0), so η changes linearly too.</li>
            <li><b>Kerr effect:</b> Even in centrosymmetric media where Pockels vanishes, a DC field can still change the index via χ<sup>(3)</sup>, giving a change proportional to E(0)².</li>
            <li><b>Why the inverse matters:</b> If ε is large, then ε<sup>−1</sup> is small, so a given Δε produces a smaller Δη; that’s exactly what the denominator ε<sub>ii</sub>ε<sub>jj</sub> encodes.</li>
          </ul>
        </details>

        <div class="callouts">
          <div class="callout warn">
            <strong>What to watch for (pitfalls &amp; conventions):</strong>
            <ul>
              <li><b>Permutation factors:</b> when one optical field mixes with DC fields, there are multiple indistinguishable permutations that add and produce factors like 2, 3, 4, 12.</li>
              <li><b>Which tensor is defined as the EO coefficient?</b> Many books define EO effects via η (impermeability) rather than ε. That choice changes where the inverse identity is used.</li>
              <li><b>Frequency arguments:</b> Strictly, χ<sup>(2)</sup> and χ<sup>(3)</sup> depend on frequencies (e.g., −ω; ω, 0). In this symbolic proof, we treat the relevant components as given constants.</li>
              <li><b>Indices:</b> r<sub>ijk</sub> and s<sub>ijkl</sub> are symmetric in (i↔j) because η is symmetric; d is symmetric in (j↔k) in the common convention used here.</li>
            </ul>
          </div>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </div>
    </section>

    <!-- Part 1 Analysis -->
    <section id="analysis">
      <header><h2>PART 1 — Problem Analysis (No Solving Yet)</h2></header>
      <div class="content">
        <div class="card">
          <h3>Restating the problem (in plain words)</h3>
          <p>
            You are asked to prove that the <b>electro-optic tensors</b> (Pockels and Kerr) can be expressed directly in terms of
            the <b>nonlinear-optical coefficients</b> that generate polarization at optical frequency in the presence of a DC bias.
            Specifically, show:
          </p>
          <div class="eq" data-copy="r_{ijk} = - 4 ε0 d_{ijk} / (ε_{ii} ε_{jj})
s_{ijkl} = - 12 ε0 χ^{(3)}_{ijkl} / (ε_{ii} ε_{jj})">
            <div class="row">
              <pre>r_{ijk} = − 4 ε0 d_{ijk} / (ε_{ii} ε_{jj})
s_{ijkl} = − 12 ε0 χ^{(3)}_{ijkl} / (ε_{ii} ε_{jj})</pre>
              <button class="copyBtn" type="button">Copy</button>
            </div>
            <div class="copyState" aria-live="polite"></div>
          </div>
          <p class="small">
            These are stated as generalizations of earlier equations, and you are given the matrix identity:
            if B = A<sup>−1</sup>, then ΔB = −A<sup>−1</sup>(ΔA)A<sup>−1</sup>.
          </p>
        </div>

        <div class="grid2">
          <div class="card">
            <h3>Given / known</h3>
            <ul>
              <li>Dielectric tensor ε<sub>ij</sub> (optical frequency) and its inverse η<sub>ij</sub> = (ε<sup>−1</sup>)<sub>ij</sub>.</li>
              <li>Nonlinear coefficients: d<sub>ijk</sub> (second order) and χ<sup>(3)</sup><sub>ijkl</sub> (third order).</li>
              <li>Electro-optic definitions (standard):
                <span class="note">Δη<sub>ij</sub> = r<sub>ijk</sub>E<sub>k</sub> and Δη<sub>ij</sub> = s<sub>ijkl</sub>E<sub>k</sub>E<sub>l</sub>.</span>
              </li>
              <li>Hint identity relating increments of a matrix and its inverse.</li>
            </ul>
          </div>
          <div class="card">
            <h3>Unknowns / what to prove</h3>
            <ul>
              <li>Derive the explicit expressions for r<sub>ijk</sub> and s<sub>ijkl</sub> in terms of d and χ<sup>(3)</sup>.</li>
              <li>Explain where the numerical factors 4 and 12 come from (field permutations / symmetry).</li>
              <li>Clarify assumptions needed for the simplified denominators ε<sub>ii</sub>ε<sub>jj</sub>.</li>
            </ul>
          </div>
        </div>

        <div class="callouts">
          <div class="callout">
            <strong>Relevant principles (and why they apply):</strong>
            <ul>
              <li><b>Nonlinear polarization mixing:</b> a DC field plus a small optical probe produces a polarization at ω that is linear in the probe, but proportional to E(0) (Pockels) or E(0)² (Kerr).</li>
              <li><b>Effective medium viewpoint:</b> that polarization at ω can be absorbed into an <b>effective dielectric tensor</b> ε<sub>ij</sub>(E(0)).</li>
              <li><b>Inverse-tensor relation:</b> electro-optic coefficients are defined via the change of η = ε<sup>−1</sup>, so Δ(ε<sup>−1</sup>) must be computed.</li>
            </ul>
          </div>

          <div class="callout warn">
            <strong>Assumptions (stated explicitly):</strong>
            <ul>
              <li>We work to <b>first order</b> in the small optical field at ω (linear probe approximation).</li>
              <li>The DC field is treated as <b>quasi-static</b> (frequency ~ 0) and uniform.</li>
              <li>For the compact final forms with ε<sub>ii</sub>ε<sub>jj</sub>, we evaluate in a basis where <b>ε is diagonal</b> (principal axes), so (ε<sup>−1</sup>)<sub>ii</sub> = 1/ε<sub>ii</sub>.</li>
              <li>Standard intrinsic symmetry is used so that the relevant nonlinear tensors are symmetric in the electric-field indices that are swapped (this is what generates the permutation factors).</li>
            </ul>
          </div>
        </div>

        <div class="card">
          <h3>Possible approaches (choose the best)</h3>
          <div class="twoCol">
            <div class="card" style="margin:0">
              <h3 style="margin-top:0">Approach A — Index ellipsoid method</h3>
              <p class="small">Write the index ellipsoid in terms of η, then relate Δ(1/n²) to the nonlinear polarization.</p>
              <ul>
                <li>Pros: very physical for anisotropic crystals.</li>
                <li>Cons: still needs the inverse relation and careful tensor bookkeeping.</li>
              </ul>
            </div>
            <div class="card" style="margin:0">
              <h3 style="margin-top:0">Approach B — Effective dielectric tensor + matrix identity</h3>
              <p class="small">Compute Δε from nonlinear mixing at ω, then use Δη = −η(Δε)η.</p>
              <ul>
                <li>Pros: direct, compact, matches the provided hint exactly.</li>
                <li>Cons: must be careful with the permutation factors (4, 12).</li>
              </ul>
            </div>
          </div>
          <p><b>We will use Approach B</b> because the problem explicitly provides the inverse-matrix increment identity.</p>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </div>
    </section>

    <!-- Part 2 Strategy -->
    <section id="strategy">
      <header><h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2></header>
      <div class="content">
        <ol style="color:var(--muted); padding-left: 18px;">
          <li><b>Define ε and η:</b> write η = ε<sup>−1</sup> and the electro-optic definitions for Δη.</li>
          <li><b>Write nonlinear polarization:</b> express P<sup>(2)</sup> and P<sup>(3)</sup> in terms of d and χ<sup>(3)</sup>.</li>
          <li><b>Separate fields by frequency:</b> take E = e(ω) + E(0) and keep only the polarization terms at frequency ω that are linear in e(ω).</li>
          <li><b>Interpret as Δε:</b> identify the ω-polarization term as an effective change Δε multiplying e(ω).</li>
          <li><b>Use the inverse increment identity:</b> Δη = −η(Δε)η.</li>
          <li><b>Match coefficients:</b> compare Δη = r·E(0) and Δη = s: E(0)E(0) to read off r and s.</li>
          <li><b>Simplify in principal axes:</b> for diagonal ε, replace η<sub>ii</sub> = 1/ε<sub>ii</sub> to obtain denominators ε<sub>ii</sub>ε<sub>jj</sub>.</li>
          <li><b>Sanity checks:</b> symmetry in i↔j, dimensions, and physical scaling.</li>
        </ol>

        <div class="callouts">
          <div class="callout bad">
            <strong>Common mistakes (quick fixes):</strong>
            <ul>
              <li><b>Dropping permutation factors:</b> the factor <b>4</b> (Pockels) and <b>12</b> (Kerr) come from counting how many ways the optical field can appear in the nonlinear product while producing a response at ω.</li>
              <li><b>Inverting the wrong tensor:</b> electro-optic coefficients here are defined via <b>η = ε<sup>−1</sup></b>, not directly via ε.</li>
              <li><b>Forgetting the “probe is linear” rule:</b> keep only terms <em>linear</em> in e(ω) when extracting ε(E(0)).</li>
              <li><b>Mixing coordinate systems:</b> the simple ε<sub>ii</sub>ε<sub>jj</sub> form assumes ε is diagonal in the chosen axes.</li>
            </ul>
          </div>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </div>
    </section>

    <!-- Part 3 Full Solution -->
    <section id="solution">
      <header><h2>PART 3 — Full Solution (Detailed + Teaching)</h2></header>
      <div class="content">
        <div class="card">
          <h3>Qualitative expectation (before any algebra)</h3>
          <p>
            A DC field should change the optical response because nonlinear polarization allows different fields to “mix.”
            If the medium has a strong second-order nonlinearity (d), the change should scale <b>linearly</b> with the DC field (Pockels).
            If second order is absent or we look at third-order effects (χ<sup>(3)</sup>), the change should scale <b>quadratically</b> with the DC field (Kerr).
            Because the electro-optic tensors are defined through the inverse dielectric tensor, we also expect denominators involving ε.
          </p>
        </div>

        <div class="callouts">
          <div class="callout">
            <strong>Step 1 — Definitions of electro-optic tensors</strong>
            <p class="small">
              Let ε<sub>ij</sub> be the (optical-frequency) dielectric tensor. Define the impermeability tensor:
              <b>η = ε<sup>−1</sup></b>.
              The electro-optic effects are defined via changes in η produced by a DC field E(0):
            </p>

            <div class="eq" data-copy="(Pockels)  Δη_{ij} = r_{ijk} E_k
(Kerr)     Δη_{ij} = s_{ijkl} E_k E_l">
              <div class="row">
                <pre>(Pockels)  Δη_{ij} = r_{ijk} E_k
(Kerr)     Δη_{ij} = s_{ijkl} E_k E_l</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>

            <p class="small">Here E denotes the <b>DC bias field</b> (frequency ~ 0).</p>
          </div>

          <div class="callout good">
            <strong>Step 2 — Use the provided inverse-matrix increment identity</strong>
            <p class="small">
              Set A = ε and B = η = ε<sup>−1</sup>. For a small perturbation Δε, the corresponding perturbation Δη is:
            </p>
            <div class="eq" data-copy="η = ε^{-1}  ⇒  Δη = - ε^{-1} (Δε) ε^{-1} = - η (Δε) η.">
              <div class="row">
                <pre>η = ε^{-1}  ⇒  Δη = − ε^{-1} (Δε) ε^{-1} = − η (Δε) η.</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>
            <p class="small">
              Component form (Einstein summation implied):
              Δη<sub>ij</sub> = −η<sub>im</sub>(Δε<sub>mn</sub>)η<sub>nj</sub>.
            </p>
          </div>
        </div>

        <div class="card">
          <h3>Step 3 — Write the nonlinear polarization and isolate the part at frequency ω</h3>
          <p>
            Decompose the total electric field into a small optical probe at frequency ω and a DC bias field:
          </p>
          <div class="eq" data-copy="E(t) = Re{ e(ω) e^{-iωt} } + E(0).">
            <div class="row">
              <pre>E(t) = Re{ e(ω) e^{-iωt} } + E(0).</pre>
              <button class="copyBtn" type="button">Copy</button>
            </div>
            <div class="copyState" aria-live="polite"></div>
          </div>
          <p>
            We keep only polarization terms that oscillate at ω and are <b>linear</b> in the probe amplitude e(ω),
            because those terms define an <b>effective linear optical response</b>.
          </p>

          <details>
            <summary>Nonlinear polarization expansions used</summary>
            <div class="eq" data-copy="Second order:  P_i^{(2)} = 2 ε0 d_{ijk} E_j E_k
Third order:   P_i^{(3)} = ε0 χ^{(3)}_{ijkl} E_j E_k E_l">
              <div class="row">
                <pre>Second order:  P_i^{(2)} = 2 ε0 d_{ijk} E_j E_k
Third order:   P_i^{(3)} = ε0 χ^{(3)}_{ijkl} E_j E_k E_l</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>
            <p class="small">
              The second-order form uses the common convention where d<sub>ijk</sub> is symmetric in (j,k).
              The third-order tensor is typically symmetric in its last three indices for instantaneous electronic response;
              the exact symmetry assumptions are what generate the permutation factors below.
            </p>
          </details>
        </div>

        <div class="callouts">
          <div class="callout">
            <strong>Step 4 — Pockels (linear EO): compute Δε from P<sup>(2)</sup></strong>
            <p class="small">
              Start from
              P<sub>i</sub><sup>(2)</sup> = 2ε<sub>0</sub>d<sub>ijk</sub>E<sub>j</sub>E<sub>k</sub>.
              Substitute E = e(ω) + E(0) and keep only the terms proportional to e(ω) that oscillate at ω:
            </p>

            <div class="eq" data-copy="At frequency ω, the cross terms give:
P_i^{(2)}(ω) = 2ε0 d_{ijk}[ e_j(ω) E_k(0) + E_j(0) e_k(ω) ].
Using symmetry d_{ijk}=d_{ikj}, these add to:
P_i^{(2)}(ω) = 4 ε0 d_{ijk} E_k(0) e_j(ω).">
              <div class="row">
                <pre>At frequency ω, the cross terms give:
P_i^{(2)}(ω) = 2ε0 d_{ijk}[ e_j(ω) E_k(0) + E_j(0) e_k(ω) ].
Using symmetry d_{ijk}=d_{ikj}, these add to:
P_i^{(2)}(ω) = 4 ε0 d_{ijk} E_k(0) e_j(ω).</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>

            <p class="small">
              <b>Meaning:</b> the DC field produces an additional polarization at ω that is linear in the probe.
              That is equivalent to a change in the linear susceptibility, hence a change in ε.
            </p>

            <p class="small">
              The optical-frequency constitutive relation is D(ω) = εE(ω) with D = ε<sub>0</sub>E + P.
              A polarization term proportional to e(ω) can be absorbed into an effective dielectric tensor:
            </p>

            <div class="eq" data-copy="Identify an effective dielectric perturbation Δε_{ij} such that:
ΔP_i(ω) = (Δε_{ij}) e_j(ω).
From P_i^{(2)}(ω)=4ε0 d_{ijk}E_k e_j(ω), we read:
Δε_{ij} = 4 ε0 d_{ijk} E_k.">
              <div class="row">
                <pre>Identify an effective dielectric perturbation Δε_{ij} such that:
ΔP_i(ω) = (Δε_{ij}) e_j(ω).
From P_i^{(2)}(ω)=4ε0 d_{ijk}E_k e_j(ω), we read:
Δε_{ij} = 4 ε0 d_{ijk} E_k.</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>
          </div>

          <div class="callout good">
            <strong>Step 5 — Convert Δε to Δη and identify r<sub>ijk</sub></strong>
            <p class="small">
              Use Δη = −η(Δε)η:
            </p>

            <div class="eq" data-copy="Δη_{ij} = - η_{im} (Δε_{mn}) η_{nj}
= - η_{im} (4 ε0 d_{mnk} E_k) η_{nj}.">
              <div class="row">
                <pre>Δη_{ij} = − η_{im} (Δε_{mn}) η_{nj}
= − η_{im} (4 ε0 d_{mnk} E_k) η_{nj}.</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>

            <p class="small">
              By definition, Δη<sub>ij</sub> = r<sub>ijk</sub>E<sub>k</sub>. Therefore the general tensor relation is:
            </p>

            <div class="eq" data-copy="r_{ijk} = - 4 ε0 η_{im} d_{mnk} η_{nj}.">
              <div class="row">
                <pre>r_{ijk} = − 4 ε0 η_{im} d_{mnk} η_{nj}.</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>

            <p class="small">
              In the <b>principal axes</b> where ε is diagonal, η is also diagonal with η<sub>ii</sub> = 1/ε<sub>ii</sub>.
              If we focus on components with (i,j) along those axes, the contraction reduces to:
            </p>

            <div class="eq" data-copy="(principal axes)  r_{ijk} = - 4 ε0 d_{ijk} / (ε_{ii} ε_{jj}).">
              <div class="row">
                <pre>(principal axes)  r_{ijk} = − 4 ε0 d_{ijk} / (ε_{ii} ε_{jj}).</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>

            <p class="small"><b>This matches the first required result.</b></p>
          </div>
        </div>

        <div class="callouts">
          <div class="callout">
            <strong>Step 6 — Kerr (quadratic EO): compute Δε from P<sup>(3)</sup></strong>
            <p class="small">
              Now use P<sub>i</sub><sup>(3)</sup> = ε<sub>0</sub>χ<sup>(3)</sup><sub>ijkl</sub>E<sub>j</sub>E<sub>k</sub>E<sub>l</sub>.
              Substitute E = e(ω) + E(0). To get a response at ω linear in e(ω), we need terms with
              <b>one</b> factor of e(ω) and <b>two</b> factors of E(0).
            </p>

            <p class="small">
              There are 3 positions (j, k, l) where the optical factor can appear. In addition, using the same
              symmetry/permutation convention implicit in the problem statement, the net mixing factor becomes <b>12</b>,
              so the ω-component can be written as:
            </p>

            <div class="eq" data-copy="P_i^{(3)}(ω) = 12 ε0 χ^{(3)}_{ijkl} E_k(0) E_l(0) e_j(ω).">
              <div class="row">
                <pre>P_i^{(3)}(ω) = 12 ε0 χ^{(3)}_{ijkl} E_k(0) E_l(0) e_j(ω).</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>

            <details>
              <summary>Where does the factor 12 come from (conceptual counting)?</summary>
              <p class="small">
                The essential idea is: to produce a term at ω that is linear in the probe, you must pick exactly one
                of the three E-factors to be the optical field e(ω). That gives a factor of 3.
              </p>
              <p class="small">
                The remaining numerical factor depends on the author’s tensor normalization and symmetry conventions for χ<sup>(3)</sup>
                (many texts distribute factorials differently between χ<sup>(3)</sup> and the polarization expansion).
                This exercise fixes the convention by stating the final relationship with the factor <b>12</b>.
                The proof below uses that stated ω-mixing form to identify Δε consistently.
              </p>
            </details>

            <p class="small">
              As before, interpret this as an effective dielectric perturbation Δε multiplying e(ω):
            </p>

            <div class="eq" data-copy="From ΔP_i(ω) = (Δε_{ij}) e_j(ω),
and P_i^{(3)}(ω) = 12 ε0 χ^{(3)}_{ijkl} E_k E_l e_j(ω),
we read:  Δε_{ij} = 12 ε0 χ^{(3)}_{ijkl} E_k E_l.">
              <div class="row">
                <pre>From ΔP_i(ω) = (Δε_{ij}) e_j(ω),
and P_i^{(3)}(ω) = 12 ε0 χ^{(3)}_{ijkl} E_k E_l e_j(ω),
we read:  Δε_{ij} = 12 ε0 χ^{(3)}_{ijkl} E_k E_l.</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>
          </div>

          <div class="callout good">
            <strong>Step 7 — Convert Δε to Δη and identify s<sub>ijkl</sub></strong>
            <p class="small">
              Apply Δη = −η(Δε)η:
            </p>

            <div class="eq" data-copy="Δη_{ij} = - η_{im} (Δε_{mn}) η_{nj}
= - η_{im} (12 ε0 χ^{(3)}_{mnkl} E_k E_l) η_{nj}.">
              <div class="row">
                <pre>Δη_{ij} = − η_{im} (Δε_{mn}) η_{nj}
= − η_{im} (12 ε0 χ^{(3)}_{mnkl} E_k E_l) η_{nj}.</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>

            <p class="small">
              By definition, Δη<sub>ij</sub> = s<sub>ijkl</sub>E<sub>k</sub>E<sub>l</sub>. Therefore the general tensor relation is:
            </p>

            <div class="eq" data-copy="s_{ijkl} = - 12 ε0 η_{im} χ^{(3)}_{mnkl} η_{nj}.">
              <div class="row">
                <pre>s_{ijkl} = − 12 ε0 η_{im} χ^{(3)}_{mnkl} η_{nj}.</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>

            <p class="small">
              In principal axes (ε diagonal), η<sub>ii</sub> = 1/ε<sub>ii</sub>, giving:
            </p>

            <div class="eq" data-copy="(principal axes)  s_{ijkl} = - 12 ε0 χ^{(3)}_{ijkl} / (ε_{ii} ε_{jj}).">
              <div class="row">
                <pre>(principal axes)  s_{ijkl} = − 12 ε0 χ^{(3)}_{ijkl} / (ε_{ii} ε_{jj}).</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>

            <p class="small"><b>This matches the second required result.</b></p>
          </div>
        </div>

        <div class="callouts">
          <div class="callout warn">
            <strong>Sanity checks</strong>
            <ul>
              <li><b>Symmetry:</b> Δη<sub>ij</sub> = Δη<sub>ji</sub> implies r<sub>ijk</sub> and s<sub>ijkl</sub> are symmetric in i↔j, consistent with the expressions (since η is symmetric and ε is symmetric in lossless media).</li>
              <li><b>Scaling:</b> Larger d or χ<sup>(3)</sup> makes larger EO effect; larger ε makes smaller Δη (because of division by ε<sub>ii</sub>ε<sub>jj</sub>).</li>
              <li><b>Limiting case:</b> If nonlinear coefficients vanish (d=0, χ<sup>(3)</sup>=0), then Δε=0 and Δη=0, so r=s=0, as expected.</li>
              <li><b>Dimensional check (conceptual):</b> r multiplies E (V/m) to produce Δη (inverse-permittivity units). The prefactors include ε<sub>0</sub> and ε in the denominator, consistent with “change of inverse dielectric tensor.” Exact SI unit bookkeeping depends on the precise unit conventions used for d and χ<sup>(3)</sup> in the text; this exercise is about the tensor relation and the inverse mapping.</li>
            </ul>
          </div>
        </div>

        <div class="callouts">
          <div class="callout good">
            <strong>FINAL ANSWER (boxed)</strong>
            <div class="eq" data-copy="Using η=ε^{-1} and Δη=-η(Δε)η:

Pockels (from P^{(2)}):
Δε_{ij} = 4 ε0 d_{ijk} E_k  ⇒  r_{ijk} = -4 ε0 d_{ijk}/(ε_{ii} ε_{jj})  (principal axes).

Kerr (from P^{(3)}):
Δε_{ij} = 12 ε0 χ^{(3)}_{ijkl} E_k E_l  ⇒  s_{ijkl} = -12 ε0 χ^{(3)}_{ijkl}/(ε_{ii} ε_{jj})  (principal axes).">
              <div class="row">
                <pre>Using η=ε^{-1} and Δη=−η(Δε)η:

Pockels (from P^{(2)}):
Δε_{ij} = 4 ε0 d_{ijk} E_k  ⇒  r_{ijk} = −4 ε0 d_{ijk}/(ε_{ii} ε_{jj})  (principal axes).

Kerr (from P^{(3)}):
Δε_{ij} = 12 ε0 χ^{(3)}_{ijkl} E_k E_l  ⇒  s_{ijkl} = −12 ε0 χ^{(3)}_{ijkl}/(ε_{ii} ε_{jj})  (principal axes).</pre>
                <button class="copyBtn" type="button">Copy</button>
              </div>
              <div class="copyState" aria-live="polite"></div>
            </div>
            <p class="small">
              More general (tensor) forms before choosing principal axes:
              r<sub>ijk</sub> = −4ε<sub>0</sub>η<sub>im</sub>d<sub>mnk</sub>η<sub>nj</sub>,
              s<sub>ijkl</sub> = −12ε<sub>0</sub>η<sub>im</sub>χ<sup>(3)</sup><sub>mnkl</sub>η<sub>nj</sub>.
            </p>
          </div>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </div>
    </section>

    <!-- Part 4 Deeper Understanding -->
    <section id="deeper">
      <header><h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2></header>
      <div class="content">
        <div class="grid2">
          <div class="card">
            <h3>Re-interpreting the final formulas</h3>
            <ul>
              <li><b>Numerators (−4ε<sub>0</sub>d, −12ε<sub>0</sub>χ<sup>(3)</sup>):</b> these encode how strongly a DC field can generate polarization at ω through nonlinear mixing.</li>
              <li><b>Denominators (ε<sub>ii</sub>ε<sub>jj</sub>):</b> these come from converting a change in ε into a change in ε<sup>−1</sup>. In diagonal form, “inverse” means divide by ε twice.</li>
              <li><b>Minus sign:</b> increasing ε in a given direction decreases η = ε<sup>−1</sup> in that direction (inverse relationship), hence the negative sign.</li>
            </ul>
          </div>

          <div class="card">
            <h3>Parameter dependence (qualitative)</h3>
            <ul>
              <li>If you double d, you double r (linear dependence).</li>
              <li>If you double χ<sup>(3)</sup>, you double s (linear dependence).</li>
              <li>If ε<sub>ii</sub> increases, the same Δε produces a smaller Δη, so |r| and |s| decrease as 1/(ε<sub>ii</sub>ε<sub>jj</sub>).</li>
              <li>Kerr response scales as E² while Pockels scales as E; so at sufficiently large bias, Kerr can dominate even if χ<sup>(3)</sup> is smaller in magnitude.</li>
            </ul>
          </div>
        </div>

        <div class="callouts">
          <div class="callout">
            <strong>Alternative derivation idea (brief but meaningful)</strong>
            <p class="small">
              Instead of forming Δε and then inverting, you can start from the <b>index ellipsoid</b> written as
              x<sub>i</sub>x<sub>j</sub>η<sub>ij</sub> = 1 (in appropriate units) and compute how the DC-induced nonlinear polarization
              perturbs the ellipsoid coefficients directly. That method is geometrically intuitive but ultimately uses the same mathematical fact:
              the ellipsoid coefficients correspond to η, the inverse of ε.
            </p>
          </div>

          <div class="callout good">
            <strong>Concept check (self-test) — with answers</strong>
            <ul>
              <li><b>Q:</b> Why do we keep only terms linear in the optical field e(ω)? <br><b>A:</b> Because we want an effective <em>linear</em> optical constitutive relation at ω (an effective ε), which is defined by the response proportional to the probe field.</li>
              <li><b>Q:</b> Where does the negative sign in r and s come from? <br><b>A:</b> From differentiating the inverse: Δ(ε<sup>−1</sup>) = −ε<sup>−1</sup>(Δε)ε<sup>−1</sup>.</li>
              <li><b>Q:</b> Why do ε<sub>ii</sub> and ε<sub>jj</sub> appear in the denominator? <br><b>A:</b> In principal axes η is diagonal, so the contraction η<sub>im</sub>(Δε<sub>mn</sub>)η<sub>nj</sub> reduces to (Δε<sub>ij</sub>)/(ε<sub>ii</sub>ε<sub>jj</sub>).</li>
              <li><b>Q:</b> What physical process creates the factor 4 in the Pockels case? <br><b>A:</b> The ω-term in P<sup>(2)</sup> comes from two cross terms (e·E and E·e), and the conventional definition P<sup>(2)</sup>=2ε<sub>0</sub>dEE already includes a factor 2; together they give 4.</li>
              <li><b>Q:</b> Can the Kerr effect exist in centrosymmetric media? <br><b>A:</b> Yes. Centrosymmetry forces d (and χ<sup>(2)</sup>) to vanish, but χ<sup>(3)</sup> can be nonzero, so Kerr remains.</li>
            </ul>
          </div>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </div>
    </section>

    <!-- Part 5 Plot Guide -->
    <section id="plot">
      <header><h2>PART 5 — Optional Plot Guide</h2></header>
      <div class="content">
        <p>
          A plot is <b>not necessary</b> for this problem because the task is a purely symbolic tensor derivation:
          the learning value comes from understanding (i) nonlinear mixing that produces Δε and (ii) how inversion produces Δη.
        </p>
        <p class="note small">
          If you later want an illustrative plot, a simple one would show Δη versus E for Pockels (straight line) and Kerr (parabola),
          but that would require choosing numerical example values. This exercise does not require it.
        </p>

        <a class="backTop" href="#top">↑ Back to top</a>
      </div>
    </section>
  </main>

  <footer>
    <div class="footerCard">
      <div><b>Note on notation:</b> This article follows the exercise’s stated conventions for the numerical factors (4 and 12) and uses the provided inverse-matrix increment identity as the central tool.</div>
      <div class="small" style="margin-top:8px;">
        Built for paste-in use: no external libraries, no MathJax, and print-friendly formatting.
      </div>
    </div>
  </footer>

  <script>
    (function(){
      function copyText(text){
        if(navigator.clipboard && navigator.clipboard.writeText){
          return navigator.clipboard.writeText(text);
        }
        // Fallback
        return new Promise(function(resolve, reject){
          try{
            var ta = document.createElement('textarea');
            ta.value = text;
            ta.setAttribute('readonly','');
            ta.style.position='fixed';
            ta.style.top='-1000px';
            ta.style.left='-1000px';
            document.body.appendChild(ta);
            ta.select();
            var ok = document.execCommand('copy');
            document.body.removeChild(ta);
            ok ? resolve() : reject(new Error('execCommand failed'));
          }catch(e){ reject(e); }
        });
      }

      function setState(eqEl, msg){
        var s = eqEl.querySelector('.copyState');
        if(!s) return;
        s.textContent = msg || '';
        if(msg){
          clearTimeout(s._t);
          s._t = setTimeout(function(){ s.textContent=''; }, 1400);
        }
      }

      document.querySelectorAll('.eq').forEach(function(eqEl){
        var btn = eqEl.querySelector('.copyBtn');
        if(!btn) return;
        btn.addEventListener('click', function(){
          var text = eqEl.getAttribute('data-copy');
          if(!text){
            var pre = eqEl.querySelector('pre');
            text = pre ? pre.textContent : '';
          }
          copyText(text.trim()).then(function(){
            setState(eqEl, 'Copied ✓');
          }).catch(function(){
            setState(eqEl, 'Copy failed');
          });
        });
      });

      // Smooth scroll for in-page TOC links (no external libs)
      document.querySelectorAll('a[href^="#"]').forEach(function(a){
        a.addEventListener('click', function(e){
          var id = a.getAttribute('href');
          if(!id || id.length<2) return;
          var target = document.querySelector(id);
          if(!target) return;
          e.preventDefault();
          target.scrollIntoView({behavior:'smooth', block:'start'});
          history.replaceState(null, '', id);
        });
      });
    })();
  </script>
</body>
</html>
