<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Power of a Spatial Soliton — Integrated Intensity ∝ 1/W₀</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#111a33;
      --card:#0f1730;
      --ink:#eaf0ff;
      --muted:#b8c4e6;
      --faint:#7f8bb3;
      --line:rgba(255,255,255,.10);
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#86efac;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background:
        radial-gradient(1200px 600px at 15% 0%, rgba(125,211,252,.18), transparent 55%),
        radial-gradient(900px 500px at 90% 15%, rgba(167,139,250,.18), transparent 55%),
        linear-gradient(180deg, var(--bg), #070b16 70%);
      line-height:1.55;
    }

    header{
      padding: clamp(18px, 3vw, 34px);
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .wrap{
      width:min(1100px, 92vw);
      margin:0 auto;
    }
    .topbar{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
      align-items:end;
    }
    .kicker{
      color:var(--muted);
      letter-spacing:.12em;
      text-transform:uppercase;
      font-size:.78rem;
    }
    h1{
      margin:.15rem 0 0;
      font-size:clamp(1.5rem, 2.6vw, 2.2rem);
      line-height:1.15;
    }
    .subtitle{
      color:var(--muted);
      max-width:75ch;
      margin:.6rem 0 0;
      font-size:1.02rem;
    }

    main{
      padding: clamp(18px, 2.6vw, 30px);
    }

    .grid{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
    }

    nav.toc{
      position: sticky;
      top: 14px;
      align-self:start;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .toc .toc-head{
      padding:14px 14px 10px;
      border-bottom:1px solid var(--line);
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .toc .toc-head strong{font-size:.98rem}
    .pill{
      font-size:.75rem;
      padding:4px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      color:var(--muted);
      background: rgba(255,255,255,.03);
      user-select:none;
    }
    .toc ul{
      list-style:none;
      padding:10px 10px 14px;
      margin:0;
      display:grid;
      gap:6px;
    }
    .toc a{
      display:block;
      padding:9px 10px;
      border-radius:12px;
      color:var(--ink);
      text-decoration:none;
      border:1px solid transparent;
      background: transparent;
      transition: transform .16s ease, background .16s ease, border-color .16s ease;
    }
    .toc a:hover{
      background: rgba(125,211,252,.08);
      border-color: rgba(125,211,252,.25);
      transform: translateY(-1px);
    }

    section{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px 16px 14px;
      margin-bottom: 16px;
      overflow:hidden;
    }
    section h2{
      margin: 0 0 10px;
      font-size: 1.25rem;
    }
    section h3{
      margin: 14px 0 8px;
      font-size: 1.06rem;
      color: var(--ink);
    }
    p{margin:10px 0; color: var(--muted)}
    .tight p{margin:8px 0}
    .hr{
      height:1px;
      background: var(--line);
      margin: 12px 0;
    }

    .callouts{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:10px;
    }
    @media (max-width: 820px){
      .callouts{grid-template-columns:1fr}
    }
    .card{
      background: rgba(0,0,0,.16);
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 12px 12px 10px;
    }
    .card strong{
      display:flex;
      align-items:center;
      gap:10px;
      font-size:.98rem;
      margin-bottom:6px;
      color: var(--ink);
    }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(125,211,252,.15);
      flex:0 0 auto;
    }
    .dot.warn{background: var(--warn); box-shadow: 0 0 0 3px rgba(251,191,36,.15)}
    .dot.good{background: var(--good); box-shadow: 0 0 0 3px rgba(134,239,172,.15)}
    .dot.bad{background: var(--bad); box-shadow: 0 0 0 3px rgba(251,113,133,.15)}
    ul,ol{margin:8px 0 8px 20px; color: var(--muted)}
    li{margin:6px 0}

    .eqbox{
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      padding: 12px;
      margin: 10px 0;
      overflow:auto;
    }
    pre.eq{
      margin:0;
      white-space:pre-wrap;
      font-family: var(--mono);
      font-size: .95rem;
      line-height: 1.45;
      color: #f1f5ff;
    }
    .eqtools{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:flex-end;
      margin-top:10px;
      flex-wrap:wrap;
    }
    button.copy{
      appearance:none;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.05);
      color: var(--ink);
      border-radius: 999px;
      padding: 8px 12px;
      cursor:pointer;
      font-weight:600;
      font-size:.86rem;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    button.copy:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.30);
      transform: translateY(-1px);
    }
    button.copy:active{transform: translateY(0px)}
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(17,26,51,.92);
      border:1px solid rgba(255,255,255,.16);
      color: var(--ink);
      border-radius: 999px;
      padding: 10px 14px;
      box-shadow: var(--shadow);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      font-weight:650;
      font-size:.9rem;
      z-index: 50;
    }
    .toast.show{opacity:1; transform: translateX(-50%) translateY(-4px)}

    details{
      border:1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      padding: 10px 12px;
      background: rgba(0,0,0,.16);
      margin: 12px 0;
    }
    summary{
      cursor:pointer;
      font-weight:700;
      color: var(--ink);
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    summary::after{
      content:"▾";
      float:right;
      color: var(--faint);
      transition: transform .16s ease;
    }
    details[open] summary::after{transform: rotate(180deg)}
    .backtop{
      display:inline-flex;
      gap:10px;
      align-items:center;
      text-decoration:none;
      color: var(--ink);
      border:1px solid rgba(255,255,255,.16);
      border-radius: 999px;
      padding: 8px 12px;
      background: rgba(255,255,255,.05);
      font-weight:700;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .backtop:hover{
      background: rgba(167,139,250,.10);
      border-color: rgba(167,139,250,.30);
      transform: translateY(-1px);
    }

    figure{
      margin: 10px 0 0;
      padding: 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.16);
    }
    figcaption{
      margin-top:8px;
      color: var(--muted);
      font-size:.92rem;
    }
    canvas{
      width:100%;
      height:320px;
      display:block;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      border:1px solid rgba(255,255,255,.08);
    }

    .final{
      border:1px solid rgba(134,239,172,.26);
      background: linear-gradient(180deg, rgba(134,239,172,.10), rgba(0,0,0,.14));
    }

    footer{
      padding: 18px clamp(18px, 2.6vw, 30px) 32px;
      color: var(--faint);
    }

    /* print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, footer{border:none; background:none}
      nav.toc{display:none}
      section{box-shadow:none; border:1px solid #bbb; background:#fff}
      .eqbox, details, figure, .card{background:#fff; border:1px solid #bbb}
      a{color:#000; text-decoration:none}
      button{display:none !important}
      canvas{border:1px solid #aaa}
      section{break-inside: avoid-page}
      h2{break-after: avoid-page}
    }

    /* subtle micro-animation */
    @keyframes glow{
      0%,100%{filter: drop-shadow(0 0 0 rgba(125,211,252,0))}
      50%{filter: drop-shadow(0 0 14px rgba(125,211,252,.18))}
    }
    .glow{animation: glow 3.2s ease-in-out infinite}
  </style>
</head>

<body id="top">
<header>
  <div class="wrap topbar">
    <div class="kicker">Photonics (Saleh &amp; Teich) — Spatial Solitons</div>
    <h1>Power of a Spatial Soliton: integrated intensity and its <span class="glow">1/W₀</span> scaling</h1>
    <p class="subtitle">
      We derive the <em>integrated intensity</em> (power per unit length into the page) of the 1-D Kerr spatial soliton
      described by a <span style="color:var(--ink)">sech</span> profile and show that the total power scales inversely with the beam width <strong>W₀</strong>.
    </p>
  </div>
</header>

<main>
  <div class="wrap grid">
    <nav class="toc" aria-label="Table of contents">
      <div class="toc-head">
        <strong>Table of Contents</strong>
        <span class="pill">sticky</span>
      </div>
      <ul>
        <li><a href="#qs">Quick Summary</a></li>
        <li><a href="#primer">PART 0 — Concept Primer</a></li>
        <li><a href="#analysis">PART 1 — Problem Analysis</a></li>
        <li><a href="#strategy">PART 2 — Strategy &amp; Tips</a></li>
        <li><a href="#solution">PART 3 — Full Solution</a></li>
        <li><a href="#deeper">PART 4 — Deeper Understanding</a></li>
        <li><a href="#plotguide">PART 5 — Optional Plot Guide</a></li>
      </ul>
    </nav>

    <div>
      <section id="qs" class="tight">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this is about:</strong> compute the <em>integrated intensity</em> of a 1-D spatial soliton beam and connect it to soliton self-trapping.</li>
          <li><strong>Key physics idea:</strong> Kerr nonlinearity creates a self-induced index profile that exactly balances diffraction.</li>
          <li><strong>Beam profile:</strong> the fundamental spatial soliton has amplitude <span style="font-family:var(--mono)">sech(x/W₀)</span> and intensity <span style="font-family:var(--mono)">sech²(x/W₀)</span>.</li>
          <li><strong>Governing equation:</strong> the paraxial nonlinear Schrödinger equation (NLSE) for Kerr media.</li>
          <li><strong>What we integrate:</strong> <span style="font-family:var(--mono)">P ≡ ∫ I(x) dx</span> (power per unit length in the invariant transverse direction).</li>
          <li><strong>Core mathematical fact:</strong> <span style="font-family:var(--mono)">∫ sech²(u) du = tanh(u)</span>.</li>
          <li><strong>Why 1/W₀ appears:</strong> soliton existence fixes the peak intensity <span style="font-family:var(--mono)">I₀ ∝ 1/W₀²</span>, so <span style="font-family:var(--mono)">P = 2 I₀ W₀ ∝ 1/W₀</span>.</li>
          <li><strong>Result type:</strong> symbolic; it physically means <em>narrower solitons require more total power</em>.</li>
        </ul>

        <div class="callouts">
          <div class="card">
            <strong><span class="dot good"></span>Takeaway</strong>
            <p>The soliton is not “any sech beam.” The NLSE enforces a specific peak intensity–width relation, which makes the integrated power scale as <strong>1/W₀</strong>.</p>
          </div>
          <div class="card">
            <strong><span class="dot warn"></span>Where students slip</strong>
            <p>Integrating <span style="font-family:var(--mono)">I(x)</span> alone gives <span style="font-family:var(--mono)">2 I₀ W₀</span>. The <strong>inverse</strong> dependence only appears after using the soliton condition that ties <span style="font-family:var(--mono)">I₀</span> to <span style="font-family:var(--mono)">W₀</span>.</p>
          </div>
        </div>

        <div class="hr"></div>
        <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
      </section>

      <section id="primer">
        <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

        <h3>0.1 Core definitions (symbols + SI units)</h3>
        <ul>
          <li><strong>x</strong> — transverse coordinate across the beam (m)</li>
          <li><strong>z</strong> — propagation coordinate (m)</li>
          <li><strong>E(x,z)</strong> — complex electric-field envelope (V/m) in the paraxial approximation</li>
          <li><strong>I(x)</strong> — optical intensity profile (W/m²), time-averaged magnitude of power flow</li>
          <li><strong>I₀</strong> — peak intensity at beam center (W/m²)</li>
          <li><strong>W₀</strong> — soliton transverse width parameter (m)</li>
          <li><strong>n₀</strong> — linear refractive index (dimensionless)</li>
          <li><strong>n₂</strong> — Kerr coefficient (m²/W), defined by <span style="font-family:var(--mono)">n = n₀ + n₂ I</span></li>
          <li><strong>k</strong> — wavenumber in the medium, <span style="font-family:var(--mono)">k = n₀ k₀ = 2π n₀/λ₀</span> (1/m)</li>
          <li><strong>P</strong> — integrated intensity (often called “power” in 1-D models): <span style="font-family:var(--mono)">P = ∫ I(x) dx</span> (W/m), i.e. power per unit length in the invariant y-direction</li>
          <li><strong>ε₀</strong>, <strong>c</strong> — permittivity of free space (F/m) and speed of light (m/s)</li>
        </ul>

        <h3>0.2 Physical meaning (intuition)</h3>
        <p>
          A beam in a linear medium diffracts: its transverse profile broadens with z because different transverse spatial
          frequencies acquire different phase shifts. In a Kerr medium (<span style="font-family:var(--mono)">n = n₀ + n₂ I</span> with <span style="font-family:var(--mono)">n₂ &gt; 0</span>),
          higher intensity raises the index near the beam center, creating a self-written “lens” that focuses the beam.
          A <em>spatial soliton</em> occurs when this self-focusing exactly balances diffraction so the beam profile propagates without changing shape.
        </p>

        <h3>0.3 Governing law: paraxial NLSE and validity conditions</h3>
        <div class="eqbox">
          <pre class="eq" id="eq-nlse">
i ∂E/∂z + (1/(2k)) ∂²E/∂x² + (k n₂ / n₀) |E|² E = 0
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-nlse">Copy equation</button>
          </div>
        </div>
        <ul>
          <li><strong>Paraxial:</strong> the beam varies slowly along z compared with an optical wavelength; angles are small.</li>
          <li><strong>Instantaneous Kerr:</strong> index depends on local intensity, not on past history; absorption neglected.</li>
          <li><strong>Scalar envelope:</strong> polarization effects are ignored (valid when birefringence is negligible or one polarization dominates).</li>
          <li><strong>1-D transverse model:</strong> assumes invariance in the second transverse direction (often a slab geometry).</li>
        </ul>

        <h3>0.4 Common model choices (and why)</h3>
        <ul>
          <li><strong>Sech soliton ansatz:</strong> The NLSE admits a closed-form localized solution with a <span style="font-family:var(--mono)">sech</span> shape; it is the fundamental (lowest-order) soliton.</li>
          <li><strong>Intensity–width constraint:</strong> The solution exists only when peak intensity and width satisfy a specific relation. This is the mechanism behind the asked scaling.</li>
          <li><strong>Integrated intensity:</strong> In 1-D, “power” is taken as <span style="font-family:var(--mono)">∫ I dx</span>; in full 2-D it would be <span style="font-family:var(--mono)">∬ I dx dy</span>.</li>
        </ul>

        <h3>0.5 Mini intuition examples (quick)</h3>
        <ul>
          <li><strong>Example A:</strong> If you halve the width, diffraction tries to spread the beam faster (stronger curvature). To compensate, Kerr focusing must be stronger ⇒ higher peak intensity.</li>
          <li><strong>Example B:</strong> A wider soliton diffracts less, so it can self-trap with lower peak intensity.</li>
          <li><strong>Example C:</strong> Total power is roughly “peak × width.” If peak grows like <span style="font-family:var(--mono)">1/W₀²</span>, then peak×width goes like <span style="font-family:var(--mono)">1/W₀</span>.</li>
        </ul>

        <div class="callouts">
          <div class="card">
            <strong><span class="dot"></span>What to watch for</strong>
            <ul>
              <li>Distinguish <strong>field amplitude</strong> (<span style="font-family:var(--mono)">sech</span>) from <strong>intensity</strong> (<span style="font-family:var(--mono)">sech²</span>).</li>
              <li>Keep track of what “power” means in a 1-D model: units are <strong>W/m</strong>, not W.</li>
              <li>The scaling depends on using the soliton condition linking <span style="font-family:var(--mono)">I₀</span> and <span style="font-family:var(--mono)">W₀</span>.</li>
            </ul>
          </div>
          <div class="card">
            <strong><span class="dot warn"></span>Pitfalls &amp; misconceptions</strong>
            <ul>
              <li>Integrating <span style="font-family:var(--mono)">sech²</span> incorrectly (it’s a standard integral).</li>
              <li>Forgetting the electromagnetic factor converting <span style="font-family:var(--mono)">|E|²</span> to intensity.</li>
              <li>Mixing <span style="font-family:var(--mono)">k₀</span> (vacuum) with <span style="font-family:var(--mono)">k</span> (in-medium).</li>
            </ul>
          </div>
        </div>

        <div class="hr"></div>
        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="analysis">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>1.1 Restate the problem (plain language)</h3>
        <p>
          A spatial soliton has a known transverse intensity profile (from Eq. 22.3-12 in the text). You must:
          (i) compute the integrated intensity (i.e., integrate the soliton intensity over x), and
          (ii) use the soliton condition embedded in that solution to show the integrated intensity is inversely proportional to the beam width <strong>W₀</strong>.
        </p>

        <h3>1.2 Given quantities</h3>
        <ul>
          <li>The soliton profile from Eq. (22.3-12), which (for the fundamental 1-D Kerr spatial soliton) has the form:
            <span style="font-family:var(--mono)">E(x,z) = E₀ sech(x/W₀) · exp(i β z)</span> and hence
            <span style="font-family:var(--mono)">I(x) = I₀ sech²(x/W₀)</span>.
          </li>
          <li>Underlying Kerr medium parameters (<span style="font-family:var(--mono)">n₀, n₂</span>) and the wavenumber <span style="font-family:var(--mono)">k</span>.</li>
        </ul>

        <h3>1.3 Unknowns / what must be shown</h3>
        <ul>
          <li>Find <strong>P</strong> where <span style="font-family:var(--mono)">P ≡ ∫_{-∞}^{∞} I(x) dx</span>.</li>
          <li>Show <strong>P ∝ 1/W₀</strong>.</li>
        </ul>

        <h3>1.4 Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>NLSE balance:</strong> Soliton solutions exist because diffraction (second derivative term) is balanced by Kerr self-focusing (cubic term).</li>
          <li><strong>Intensity definition:</strong> For a harmonic field, <span style="font-family:var(--mono)">I = (n₀ ε₀ c / 2) |E|²</span>.</li>
          <li><strong>Standard integral:</strong> The integral of <span style="font-family:var(--mono)">sech²</span> over the real line is finite and simple.</li>
        </ul>
        <p>
          Other effects (dispersion, absorption, saturable nonlinearity, nonparaxial corrections) are not needed because the given soliton is specifically a Kerr-NLSE solution.
        </p>

        <div class="card">
          <strong><span class="dot"></span>Assumptions (explicit)</strong>
          <ul>
            <li>1-D transverse geometry (slab): the field depends on x and z only.</li>
            <li>Lossless, instantaneous Kerr nonlinearity: <span style="font-family:var(--mono)">n = n₀ + n₂ I</span>, <span style="font-family:var(--mono)">n₂ &gt; 0</span>.</li>
            <li>Steady monochromatic envelope (no temporal dynamics in this “spatial” soliton).</li>
            <li>Paraxial approximation and scalar field envelope.</li>
          </ul>
        </div>

        <h3>1.5 Possible approaches (compare &amp; choose)</h3>
        <ol>
          <li>
            <strong>Direct integration + soliton constraint (best):</strong>
            Integrate <span style="font-family:var(--mono)">I(x) = I₀ sech²(x/W₀)</span> to get <span style="font-family:var(--mono)">P = 2 I₀ W₀</span>,
            then use the soliton condition <span style="font-family:var(--mono)">I₀ ∝ 1/W₀²</span> to conclude <span style="font-family:var(--mono)">P ∝ 1/W₀</span>.
            <em>Pros:</em> shortest, most transparent. <em>Cons:</em> requires recalling/deriving the constraint.
          </li>
          <li>
            <strong>Dimensional scaling from NLSE:</strong>
            Balance diffraction length <span style="font-family:var(--mono)">~ k W₀²</span> with nonlinear length <span style="font-family:var(--mono)">~ 1/(k n₂ I₀/n₀)</span>
            to infer <span style="font-family:var(--mono)">I₀ ∝ 1/W₀²</span>, then same as above.
            <em>Pros:</em> strong intuition. <em>Cons:</em> less “exact” unless carefully normalized.
          </li>
          <li>
            <strong>Full substitution of the soliton into NLSE:</strong>
            Plug the <span style="font-family:var(--mono)">sech</span> ansatz into the NLSE to obtain exact relations among parameters and then integrate.
            <em>Pros:</em> rigorous. <em>Cons:</em> more algebra.
          </li>
        </ol>
        <p><strong>Chosen approach:</strong> (1) with a short, rigorous derivation of the soliton constraint (so the final scaling is fully justified).</p>

        <div class="hr"></div>
        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="strategy">
        <h2>PART 2 — Strategy &amp; Tips (roadmap only)</h2>

        <ol>
          <li>
            <strong>Write the soliton intensity</strong>
            (<span style="font-family:var(--mono)">I(x)=I₀ sech²(x/W₀)</span>).
            <em>Meaning:</em> localized beam with width scale <span style="font-family:var(--mono)">W₀</span>.
          </li>
          <li>
            <strong>Integrate over x</strong> using <span style="font-family:var(--mono)">u=x/W₀</span> and <span style="font-family:var(--mono)">∫ sech²(u) du = tanh(u)</span>.
            <em>Meaning:</em> compute total “power per unit length.”
          </li>
          <li>
            <strong>Derive the soliton constraint</strong> from the NLSE normalization:
            find how <span style="font-family:var(--mono)">|E₀|²</span> must depend on <span style="font-family:var(--mono)">W₀</span>.
            <em>Meaning:</em> only special peak intensities self-trap.
          </li>
          <li>
            <strong>Convert field amplitude to intensity</strong> using <span style="font-family:var(--mono)">I₀ = (n₀ ε₀ c/2)|E₀|²</span>.
            <em>Meaning:</em> connect electromagnetic units to optical power.
          </li>
          <li>
            <strong>Combine results</strong> to show <span style="font-family:var(--mono)">P = 2 I₀ W₀ ∝ 1/W₀</span>.
            <em>Meaning:</em> narrower solitons need higher total power.
          </li>
          <li>
            <strong>Sanity checks</strong>: units (W/m), and limiting trend with width.
          </li>
        </ol>

        <div class="card">
          <strong><span class="dot warn"></span>Common mistakes (quick fixes)</strong>
          <ul>
            <li><strong>Mistake:</strong> claiming <span style="font-family:var(--mono)">P ∝ W₀</span> from the integral alone. <strong>Fix:</strong> insert the soliton condition <span style="font-family:var(--mono)">I₀ ∝ 1/W₀²</span>.</li>
            <li><strong>Mistake:</strong> integrating <span style="font-family:var(--mono)">sech</span> instead of <span style="font-family:var(--mono)">sech²</span>. <strong>Fix:</strong> intensity is proportional to <span style="font-family:var(--mono)">|E|²</span>.</li>
            <li><strong>Mistake:</strong> forgetting this is a 1-D “power” (W/m). <strong>Fix:</strong> interpret it as power per unit y-length (slab geometry).</li>
          </ul>
        </div>

        <div class="hr"></div>
        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="solution">
        <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

        <h3>3.1 Qualitative expectation (before calculating)</h3>
        <p>
          A narrower beam diffracts more strongly (curvature scales like <span style="font-family:var(--mono)">1/W₀²</span>), so to remain self-trapped it must
          generate a stronger Kerr lens, which requires higher peak intensity. That already hints that peak intensity should grow as
          <span style="font-family:var(--mono)">1/W₀²</span>. Since total power in 1-D is roughly “peak × width,” we expect
          <span style="font-family:var(--mono)">P ~ I₀ W₀ ~ (1/W₀²)·W₀ = 1/W₀</span>.
        </p>

        <h3>3.2 Start from the spatial soliton profile (Eq. 22.3-12 form)</h3>
        <p>
          The fundamental 1-D Kerr spatial soliton has an envelope amplitude proportional to <span style="font-family:var(--mono)">sech(x/W₀)</span>,
          so the intensity profile is
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-intensity">
I(x) = I₀ sech²(x/W₀)
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-intensity">Copy equation</button>
          </div>
        </div>

        <h3>3.3 Integrated intensity (power per unit length)</h3>
        <p>
          Define the integrated intensity (often called the soliton “power” in a slab geometry):
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-Pdef">
P ≡ ∫_{-∞}^{∞} I(x) dx
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-Pdef">Copy equation</button>
          </div>
        </div>

        <p>
          Substitute <span style="font-family:var(--mono)">I(x)=I₀ sech²(x/W₀)</span> and use the change of variables <span style="font-family:var(--mono)">u = x/W₀</span> so that
          <span style="font-family:var(--mono)">dx = W₀ du</span>:
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-integral">
P = ∫_{-∞}^{∞} I₀ sech²(x/W₀) dx
  = I₀ W₀ ∫_{-∞}^{∞} sech²(u) du
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-integral">Copy equation</button>
          </div>
        </div>

        <p>
          Use the standard identity <span style="font-family:var(--mono)">d( tanh u )/du = sech² u</span>, hence
          <span style="font-family:var(--mono)">∫ sech²(u) du = tanh(u)</span>. Therefore
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-integral-eval">
∫_{-∞}^{∞} sech²(u) du = [tanh(u)]_{-∞}^{∞} = (1) - (-1) = 2
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-integral-eval">Copy equation</button>
          </div>
        </div>

        <p>
          So the integrated intensity is
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-P-2I0W0">
P = 2 I₀ W₀
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-P-2I0W0">Copy equation</button>
          </div>
        </div>

        <p>
          At this point, <span style="font-family:var(--mono)">P</span> appears to grow with <span style="font-family:var(--mono)">W₀</span> if <span style="font-family:var(--mono)">I₀</span> were independent. But for a soliton,
          <strong>I₀ is not free</strong>: the NLSE fixes <span style="font-family:var(--mono)">I₀</span> as a function of <span style="font-family:var(--mono)">W₀</span>.
        </p>

        <h3>3.4 The soliton constraint: peak intensity scales as 1/W₀²</h3>
        <p>
          Start from the Kerr NLSE (paraxial, 1-D):
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-nlse2">
i ∂E/∂z + (1/(2k)) ∂²E/∂x² + (k n₂ / n₀) |E|² E = 0
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-nlse2">Copy equation</button>
          </div>
        </div>

        <p>
          Use the standard fundamental soliton form (consistent with Eq. 22.3-12 in many photonics texts):
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-ansatz">
E(x,z) = E₀ sech(x/W₀) · exp(i β z)
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-ansatz">Copy equation</button>
          </div>
        </div>

        <p>
          Instead of performing long derivatives, we use a clean normalization argument (rigorous and standard for the NLSE):
          scale coordinates by <span style="font-family:var(--mono)">x = W₀ X</span> and <span style="font-family:var(--mono)">z = (k W₀²) Z</span>. Then
        </p>
        <ul>
          <li><span style="font-family:var(--mono)">∂/∂x = (1/W₀) ∂/∂X</span> so <span style="font-family:var(--mono)">∂²/∂x² = (1/W₀²) ∂²/∂X²</span></li>
          <li><span style="font-family:var(--mono)">∂/∂z = (1/(k W₀²)) ∂/∂Z</span></li>
        </ul>

        <p>
          Substitute into the NLSE and multiply through by <span style="font-family:var(--mono)">k W₀²</span>:
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-scaled">
i ∂E/∂Z + (1/2) ∂²E/∂X² + (k² W₀² n₂ / n₀) |E|² E = 0
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-scaled">Copy equation</button>
          </div>
        </div>

        <p>
          The canonical dimensionless NLSE that has the known fundamental soliton
          <span style="font-family:var(--mono)">sech(X)</span> is
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-canonical">
i ∂U/∂Z + (1/2) ∂²U/∂X² + |U|² U = 0
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-canonical">Copy equation</button>
          </div>
        </div>

        <p>
          To match the scaled equation to this canonical form, define <span style="font-family:var(--mono)">E = Ê U</span>, where <span style="font-family:var(--mono)">Ê</span> is a constant amplitude scale.
          Then the nonlinear coefficient becomes
          <span style="font-family:var(--mono)">(k² W₀² n₂ / n₀) |Ê|²</span>, and we choose <span style="font-family:var(--mono)">Ê</span> so that this coefficient equals 1:
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-Ehat">
(k² W₀² n₂ / n₀) |Ê|² = 1
⇒ |Ê|² = n₀ / (k² n₂ W₀²)
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-Ehat">Copy equation</button>
          </div>
        </div>

        <p>
          For the fundamental soliton, the peak of <span style="font-family:var(--mono)">|U|</span> is 1, so the physical peak field amplitude is
          <span style="font-family:var(--mono)">|E₀|² = |Ê|²</span>. Hence,
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-E0scale">
|E₀|² = n₀ / (k² n₂ W₀²)
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-E0scale">Copy equation</button>
          </div>
        </div>

        <p>
          Convert to peak intensity using the standard electromagnetic relation (for a harmonic wave in a dielectric):
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-I0def">
I₀ = (n₀ ε₀ c / 2) |E₀|²
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-I0def">Copy equation</button>
          </div>
        </div>

        <p>
          Substitute <span style="font-family:var(--mono)">|E₀|²</span> from above:
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-I0scale">
I₀ = (n₀ ε₀ c / 2) · [ n₀ / (k² n₂ W₀²) ]
   = (n₀² ε₀ c) / (2 n₂ k²) · (1/W₀²)
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-I0scale">Copy equation</button>
          </div>
        </div>

        <p>
          This is the key soliton constraint: <strong>I₀ ∝ 1/W₀²</strong>.
        </p>

        <h3>3.5 Combine with the integral to show P ∝ 1/W₀</h3>
        <p>
          We already found <span style="font-family:var(--mono)">P = 2 I₀ W₀</span>. Insert the expression for <span style="font-family:var(--mono)">I₀</span>:
        </p>

        <div class="eqbox final">
          <pre class="eq" id="eq-final">
P = 2 I₀ W₀
  = 2 W₀ · (n₀² ε₀ c) / (2 n₂ k²) · (1/W₀²)
  = (n₀² ε₀ c) / (n₂ k²) · (1/W₀)

Therefore:  P ∝ 1/W₀.
          </pre>
          <div class="eqtools">
            <button class="copy" data-copy="#eq-final">Copy FINAL answer</button>
          </div>
        </div>

        <h3>3.6 Sanity checks</h3>

        <div class="callouts">
          <div class="card">
            <strong><span class="dot good"></span>Units / dimensions</strong>
            <ul>
              <li><span style="font-family:var(--mono)">I₀</span> has units W/m².</li>
              <li><span style="font-family:var(--mono)">P = ∫ I dx</span> has units (W/m²)·m = <strong>W/m</strong> (power per unit length).</li>
              <li>Right-hand side: <span style="font-family:var(--mono)">(ε₀ c)</span> has units of (F/m)(m/s)=F/s; combined with field scaling embedded via <span style="font-family:var(--mono)">n₂</span> and <span style="font-family:var(--mono)">k</span> yields W/m overall (consistent for the standard intensity definition used).</li>
            </ul>
          </div>
          <div class="card">
            <strong><span class="dot"></span>Limiting behavior</strong>
            <ul>
              <li><span style="font-family:var(--mono)">W₀ → large</span>: broad beam diffracts weakly ⇒ needs less nonlinear focusing ⇒ <span style="font-family:var(--mono)">P → 0</span> (for this ideal Kerr NLSE model).</li>
              <li><span style="font-family:var(--mono)">W₀ → small</span>: very narrow beam diffracts strongly ⇒ requires high intensity ⇒ <span style="font-family:var(--mono)">P → ∞</span> (signals breakdown of ideal model before reaching that limit).</li>
            </ul>
          </div>
        </div>

        <p>
          <strong>Physical interpretation:</strong> The soliton’s width is not arbitrary. A narrower soliton demands a higher peak intensity (stronger Kerr lens),
          and despite the beam being narrower, the required peak grows fast enough that the total integrated power increases as <span style="font-family:var(--mono)">1/W₀</span>.
        </p>

        <div class="hr"></div>
        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="deeper">
        <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

        <h3>4.1 Re-interpreting the final formula</h3>
        <p>
          The result can be written as
          <span style="font-family:var(--mono)">P = K / W₀</span>
          where the constant
          <span style="font-family:var(--mono)">K = (n₀² ε₀ c)/(n₂ k²)</span>
          depends on material nonlinearity (<span style="font-family:var(--mono)">n₂</span>) and optical scale (<span style="font-family:var(--mono)">k</span>).
        </p>
        <ul>
          <li><strong>Stronger nonlinearity</strong> (larger <span style="font-family:var(--mono)">n₂</span>) lowers the required power.</li>
          <li><strong>Shorter wavelength</strong> increases <span style="font-family:var(--mono)">k</span>, which lowers <span style="font-family:var(--mono)">K/k²</span> and reduces required power for a given <span style="font-family:var(--mono)">W₀</span> (within the same model).</li>
          <li><strong>Narrower soliton</strong> (smaller <span style="font-family:var(--mono)">W₀</span>) requires larger integrated power.</li>
        </ul>

        <h3>4.2 Parameter dependence (qualitative + quantitative)</h3>
        <div class="card">
          <strong><span class="dot"></span>How each parameter affects P</strong>
          <ul>
            <li><span style="font-family:var(--mono)">P ∝ 1/W₀</span>: halve <span style="font-family:var(--mono)">W₀</span> ⇒ double <span style="font-family:var(--mono)">P</span>.</li>
            <li><span style="font-family:var(--mono)">P ∝ 1/n₂</span>: more nonlinear material ⇒ less power needed.</li>
            <li><span style="font-family:var(--mono)">P ∝ 1/k²</span>: optical scale matters; tighter diffraction scaling is embedded in <span style="font-family:var(--mono)">k</span>.</li>
          </ul>
        </div>

        <details>
          <summary>Optional deeper note: a quick “balance of lengths” derivation (intuition-first)</summary>
          <p>
            Diffraction length for transverse scale <span style="font-family:var(--mono)">W₀</span> is roughly <span style="font-family:var(--mono)">L_D ~ k W₀²</span>.
            The Kerr nonlinear length is <span style="font-family:var(--mono)">L_NL ~ 1/(k n₂ I₀ / n₀)</span>.
            Soliton self-trapping requires <span style="font-family:var(--mono)">L_D ~ L_NL</span>, giving
            <span style="font-family:var(--mono)">k W₀² ~ n₀/(k n₂ I₀)</span> ⇒ <span style="font-family:var(--mono)">I₀ ~ n₀/(k² n₂ W₀²)</span>,
            which matches the exact scaling used above. Then <span style="font-family:var(--mono)">P ~ I₀ W₀ ~ 1/W₀</span>.
          </p>
        </details>

        <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Instead of normalization, you can directly substitute
          <span style="font-family:var(--mono)">E(x,z)=E₀ sech(x/W₀) exp(iβz)</span>
          into the NLSE, compute <span style="font-family:var(--mono)">∂²/∂x²</span> of <span style="font-family:var(--mono)">sech</span>,
          and equate coefficients of <span style="font-family:var(--mono)">sech</span> and <span style="font-family:var(--mono)">sech³</span>.
          This yields the same constraint <span style="font-family:var(--mono)">|E₀|² = n₀/(k² n₂ W₀²)</span> and phase constant <span style="font-family:var(--mono)">β = 1/(2kW₀²)</span>.
        </p>

        <h3>4.4 Concept checks (self-test with answers)</h3>
        <ul>
          <li><strong>Q:</strong> Why doesn’t integrating <span style="font-family:var(--mono)">I(x)</span> alone guarantee <span style="font-family:var(--mono)">P ∝ 1/W₀</span>? <strong>A:</strong> Because <span style="font-family:var(--mono)">I₀</span> is not independent—soliton formation forces <span style="font-family:var(--mono)">I₀ ∝ 1/W₀²</span>.</li>
          <li><strong>Q:</strong> What is the physical meaning of <span style="font-family:var(--mono)">P = ∫ I dx</span> in a 1-D slab model? <strong>A:</strong> It is the optical power per unit length in the invariant transverse direction (units W/m).</li>
          <li><strong>Q:</strong> If the material has larger <span style="font-family:var(--mono)">n₂</span>, do you need more or less soliton power? <strong>A:</strong> Less, since <span style="font-family:var(--mono)">P ∝ 1/n₂</span>.</li>
          <li><strong>Q:</strong> What happens to required power as <span style="font-family:var(--mono)">W₀</span> shrinks? <strong>A:</strong> It grows like <span style="font-family:var(--mono)">1/W₀</span> (in the ideal Kerr-NLSE model).</li>
        </ul>

        <div class="hr"></div>
        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="plotguide">
        <h2>PART 5 — Optional Plot Guide</h2>

        <p>
          A plot is useful here because the key claim is a simple scaling law: <span style="font-family:var(--mono)">P ∝ 1/W₀</span>.
          One curve makes the “inverse” dependence visually obvious (hyperbolic decay).
        </p>

        <figure>
          <canvas id="plot" aria-label="Plot of normalized integrated intensity versus beam width"></canvas>
          <figcaption>
            Static plot of <strong>normalized</strong> integrated intensity <span style="font-family:var(--mono)">P/K</span> vs width <span style="font-family:var(--mono)">W₀</span>, where
            <span style="font-family:var(--mono)">P = K/W₀</span>. <em>Example values:</em> we plot widths from 0.5 to 5 (arbitrary units) and set <span style="font-family:var(--mono)">K=1</span> for normalization only.
          </figcaption>
        </figure>

        <div class="callouts">
          <div class="card">
            <strong><span class="dot"></span>What the axes mean</strong>
            <ul>
              <li><strong>x-axis:</strong> beam width <span style="font-family:var(--mono)">W₀</span> (example units).</li>
              <li><strong>y-axis:</strong> normalized power <span style="font-family:var(--mono)">P/K</span> (dimensionless), equal to <span style="font-family:var(--mono)">1/W₀</span>.</li>
            </ul>
          </div>
          <div class="card">
            <strong><span class="dot warn"></span>Features to notice</strong>
            <ul>
              <li>As <span style="font-family:var(--mono)">W₀</span> increases, <span style="font-family:var(--mono)">P</span> decreases monotonically.</li>
              <li>The curve is not linear; it has stronger change at small widths (hyperbola).</li>
              <li>This matches the physical idea that tight confinement is “expensive” in power.</li>
            </ul>
          </div>
        </div>

        <div class="hr"></div>
        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

    </div>
  </div>
</main>

<footer>
  <div class="wrap">
    <div class="hr"></div>
    <p>
      Built as a self-contained learning article (vanilla HTML/CSS/JS). No external libraries, no interactivity beyond copy buttons.
    </p>
  </div>
</footer>

<div class="toast" id="toast" role="status" aria-live="polite">Copied!</div>

<script>
  (function(){
    const toast = document.getElementById('toast');
    let tmr = null;

    function showToast(msg){
      toast.textContent = msg || "Copied!";
      toast.classList.add('show');
      clearTimeout(tmr);
      tmr = setTimeout(()=>toast.classList.remove('show'), 1100);
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        showToast("Copied to clipboard");
      }catch(e){
        // Fallback: textarea
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        ta.style.top = '0';
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        try{
          document.execCommand('copy');
          showToast("Copied to clipboard");
        }catch(err){
          showToast("Copy failed");
        }
        document.body.removeChild(ta);
      }
    }

    document.querySelectorAll('button.copy').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const sel = btn.getAttribute('data-copy');
        const el = document.querySelector(sel);
        if(!el) return;
        const txt = el.textContent.replace(/\n\s+\n/g, "\n\n").trim();
        copyText(txt);
      });
    });

    // ---------- Plot (single static canvas, DPR-aware, responsive) ----------
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    function draw(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      const W = Math.max(320, Math.floor(rect.width));
      const H = Math.max(260, Math.floor(rect.height));

      canvas.width = Math.floor(W * dpr);
      canvas.height = Math.floor(H * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);

      // Layout
      const padL = 62, padR = 18, padT = 34, padB = 54;
      const x0 = padL, y0 = padT;
      const x1 = W - padR, y1 = H - padB;
      const pw = x1 - x0, ph = y1 - y0;

      // Example ranges (dimensionless for the plot)
      const xmin = 0.5, xmax = 5.0;
      const K = 1.0; // normalization
      // y = 1/x, so y ranges:
      const ymin = 0.0;
      const ymax = 1.0/xmin; // 2

      function X(x){ return x0 + (x - xmin) * pw / (xmax - xmin); }
      function Y(y){ return y1 - (y - ymin) * ph / (ymax - ymin); }

      // Background
      ctx.clearRect(0,0,W,H);
      // soft panel
      ctx.fillStyle = "rgba(255,255,255,0.02)";
      ctx.fillRect(0,0,W,H);

      // Title
      ctx.fillStyle = "rgba(255,255,255,0.92)";
      ctx.font = "700 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.textAlign = "left";
      ctx.textBaseline = "alphabetic";
      ctx.fillText("Normalized integrated intensity vs width (P/K = 1/W₀)", x0, 18);

      // Grid + axes
      const gridX = 9;
      const gridY = 8;

      ctx.lineWidth = 1;

      // gridlines
      ctx.strokeStyle = "rgba(255,255,255,0.08)";
      for(let i=0;i<=gridX;i++){
        const x = x0 + (pw*i/gridX);
        ctx.beginPath();
        ctx.moveTo(x,y0);
        ctx.lineTo(x,y1);
        ctx.stroke();
      }
      for(let j=0;j<=gridY;j++){
        const y = y0 + (ph*j/gridY);
        ctx.beginPath();
        ctx.moveTo(x0,y);
        ctx.lineTo(x1,y);
        ctx.stroke();
      }

      // axes
      ctx.strokeStyle = "rgba(255,255,255,0.35)";
      ctx.lineWidth = 1.2;
      ctx.beginPath();
      ctx.moveTo(x0,y1);
      ctx.lineTo(x1,y1);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(x0,y0);
      ctx.lineTo(x0,y1);
      ctx.stroke();

      // ticks + labels
      ctx.fillStyle = "rgba(255,255,255,0.78)";
      ctx.font = "600 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "top";
      for(let i=0;i<=gridX;i++){
        const x = x0 + (pw*i/gridX);
        const xv = xmin + (xmax-xmin)*(i/gridX);
        ctx.strokeStyle = "rgba(255,255,255,0.30)";
        ctx.beginPath();
        ctx.moveTo(x,y1);
        ctx.lineTo(x,y1+6);
        ctx.stroke();
        ctx.fillText(xv.toFixed(1), x, y1+10);
      }

      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      for(let j=0;j<=gridY;j++){
        const y = y1 - (ph*j/gridY);
        const yv = ymin + (ymax-ymin)*(j/gridY);
        ctx.strokeStyle = "rgba(255,255,255,0.30)";
        ctx.beginPath();
        ctx.moveTo(x0-6,y);
        ctx.lineTo(x0,y);
        ctx.stroke();
        ctx.fillText(yv.toFixed(2), x0-10, y);
      }

      // axis labels
      ctx.fillStyle = "rgba(255,255,255,0.86)";
      ctx.font = "700 13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "alphabetic";
      ctx.fillText("Width W₀ (example units)", x0 + pw/2, H - 16);

      ctx.save();
      ctx.translate(18, y0 + ph/2);
      ctx.rotate(-Math.PI/2);
      ctx.textAlign = "center";
      ctx.fillText("Normalized power P/K (dimensionless)", 0, 0);
      ctx.restore();

      // curve y = K/x
      ctx.lineWidth = 2;
      ctx.strokeStyle = "rgba(125,211,252,0.95)";
      ctx.beginPath();
      const N = 260;
      for(let i=0;i<=N;i++){
        const x = xmin + (xmax-xmin)*(i/N);
        const y = K/x;
        const px = X(x), py = Y(y);
        if(i===0) ctx.moveTo(px,py);
        else ctx.lineTo(px,py);
      }
      ctx.stroke();

      // legend
      const lx = x1 - 168, ly = y0 + 10;
      const lw = 160, lh = 40;
      ctx.fillStyle = "rgba(0,0,0,0.28)";
      ctx.strokeStyle = "rgba(255,255,255,0.14)";
      ctx.lineWidth = 1;
      roundRect(ctx, lx, ly, lw, lh, 12);
      ctx.fill();
      ctx.stroke();

      ctx.strokeStyle = "rgba(125,211,252,0.95)";
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(lx+12, ly+18);
      ctx.lineTo(lx+44, ly+18);
      ctx.stroke();

      ctx.fillStyle = "rgba(255,255,255,0.85)";
      ctx.font = "700 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.textAlign = "left";
      ctx.textBaseline = "middle";
      ctx.fillText("P/K = 1/W₀", lx+54, ly+18);

      ctx.fillStyle = "rgba(255,255,255,0.65)";
      ctx.font = "600 11px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("Example plot (K=1)", lx+54, ly+32);
    }

    function roundRect(c, x, y, w, h, r){
      const rr = Math.min(r, w/2, h/2);
      c.beginPath();
      c.moveTo(x+rr, y);
      c.arcTo(x+w, y, x+w, y+h, rr);
      c.arcTo(x+w, y+h, x, y+h, rr);
      c.arcTo(x, y+h, x, y, rr);
      c.arcTo(x, y, x+w, y, rr);
      c.closePath();
    }

    const ro = new ResizeObserver(()=>draw());
    ro.observe(canvas);
    window.addEventListener('load', draw, {once:true});
  })();
</script>
</body>
</html>
