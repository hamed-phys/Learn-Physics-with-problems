<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Threshold Pump Intensity for Parametric Oscillation (Degenerate OPO)</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#101a33;
      --card2:#0f1730;
      --text:#e9eefc;
      --muted:#b9c3e6;
      --faint:#7f8ab3;
      --accent:#7cf0c5;
      --accent2:#7aa7ff;
      --warn:#ffd37a;
      --bad:#ff7a9e;
      --line:rgba(255,255,255,0.10);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(122,167,255,0.20), transparent 55%),
        radial-gradient(1000px 600px at 85% 20%, rgba(124,240,197,0.14), transparent 60%),
        radial-gradient(900px 600px at 60% 90%, rgba(255,211,122,0.10), transparent 55%),
        linear-gradient(180deg, #070a14 0%, #0b1020 45%, #070a14 100%);
      line-height:1.55;
      overflow-x:hidden;
    }
    a{color:var(--accent2); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      position:relative;
      padding: clamp(18px, 2.6vw, 34px);
      padding-bottom: 10px;
    }
    .topbar{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .titleblock{max-width:980px}
    h1{
      margin:0 0 6px 0;
      font-size: clamp(22px, 2.5vw, 34px);
      letter-spacing:0.2px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      max-width: 80ch;
      font-size: clamp(14px, 1.4vw, 16px);
    }
    .meta{
      margin-top:10px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      color:var(--faint);
      font-size:13px;
    }
    .pill{
      border:1px solid var(--line);
      background: rgba(255,255,255,0.04);
      padding:6px 10px;
      border-radius:999px;
      backdrop-filter: blur(6px);
    }
    main{
      display:grid;
      grid-template-columns: 1fr minmax(240px, 320px);
      gap: 18px;
      padding: 0 clamp(18px, 2.6vw, 34px) 34px;
      align-items:start;
    }
    @media (max-width: 980px){ main{grid-template-columns: 1fr} }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card > .inner{ padding: clamp(14px, 2vw, 20px); }
    .section{ margin: 0 0 18px 0; }
    h2{
      font-size: clamp(16px, 1.7vw, 20px);
      margin: 0 0 10px 0;
      display:flex;
      align-items:center;
      gap:10px;
    }
    h2 .dot{
      width:10px;height:10px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, var(--accent), rgba(124,240,197,0.15));
      box-shadow: 0 0 0 6px rgba(124,240,197,0.08);
      flex:0 0 auto;
    }
    h3{ margin: 14px 0 8px 0; font-size: 15px; color: var(--text); }
    p{margin: 8px 0; color: var(--muted)}
    ul{margin: 8px 0 8px 18px; color: var(--muted)}
    li{margin:6px 0}
    .grid2{ display:grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    @media (max-width: 740px){ .grid2{grid-template-columns:1fr} }
    .callout{
      border: 1px solid var(--line);
      background: rgba(16,26,51,0.55);
      border-radius: 14px;
      padding: 12px 12px;
      margin: 10px 0;
      position:relative;
      overflow:hidden;
    }
    .callout::before{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(800px 120px at 20% 0%, rgba(122,167,255,0.16), transparent 55%),
                  radial-gradient(700px 120px at 80% 0%, rgba(124,240,197,0.14), transparent 60%);
      pointer-events:none;
      opacity:0.8;
    }
    .callout > *{position:relative}
    .callout .label{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-weight:700;
      letter-spacing:0.2px;
      margin-bottom:6px;
      color:var(--text);
      font-size:13px;
    }
    .badge{
      font-size:12px;
      padding: 3px 8px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,0.04);
      color: var(--text);
    }
    .assump{border-left: 4px solid rgba(124,240,197,0.75)}
    .eqs{border-left: 4px solid rgba(122,167,255,0.75)}
    .mist{border-left: 4px solid rgba(255,211,122,0.85)}
    .final{border-left: 4px solid rgba(255,122,158,0.80)}
    .kpi{ display:flex; flex-wrap:wrap; gap:10px; margin-top:10px; }
    .kpi .box{
      flex: 1 1 200px;
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      background: rgba(255,255,255,0.03);
    }
    .kpi .big{ font-size:18px; font-weight:800; color: var(--text); margin: 4px 0 2px; }
    .kpi .small{ font-size:12px; color: var(--faint); margin:0; }
    .eq{
      font-family: var(--mono);
      font-size: 13px;
      color: #eaf1ff;
      background: rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 12px;
      padding: 10px 10px;
      overflow:auto;
      position:relative;
      margin: 10px 0;
      white-space: pre-wrap;
    }
    .eq .btnrow{ display:flex; gap:8px; flex-wrap:wrap; margin-top: 8px; }
    button.copy{
      appearance:none;
      border:1px solid rgba(255,255,255,0.16);
      background: rgba(255,255,255,0.06);
      color: var(--text);
      padding: 7px 10px;
      border-radius: 12px;
      font-weight:700;
      cursor:pointer;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
      font-size:12px;
    }
    button.copy:hover{transform: translateY(-1px); background: rgba(255,255,255,0.10); border-color: rgba(255,255,255,0.24)}
    button.copy:active{transform: translateY(0px) scale(0.98)}
    .copystatus{ font-size:12px; color: var(--faint); margin-left: 2px; min-height: 16px; }
    details{
      border:1px solid var(--line);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(255,255,255,0.03);
      margin: 10px 0;
    }
    details summary{
      cursor:pointer;
      font-weight:800;
      color: var(--text);
      list-style:none;
      display:flex;
      align-items:center;
      gap:10px;
    }
    details summary::-webkit-details-marker{display:none}
    details summary::before{
      content:"▸";
      color: var(--accent2);
      font-weight:900;
      display:inline-block;
      transform: translateY(-1px);
      transition: transform 140ms ease;
    }
    details[open] summary::before{transform: rotate(90deg) translateY(-1px)}
    .toc{ position: sticky; top: 14px; padding: 14px 14px; }
    .toc h2{ margin:0 0 10px 0; font-size: 14px; color: var(--text); }
    .toc a{
      display:block;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid transparent;
      color: var(--muted);
      font-size: 13px;
      transition: background 120ms ease, border-color 120ms ease, transform 120ms ease;
    }
    .toc a:hover{
      background: rgba(255,255,255,0.06);
      border-color: rgba(255,255,255,0.10);
      transform: translateY(-1px);
      text-decoration:none;
    }
    .toc .small{ color: var(--faint); font-size: 12px; margin: 8px 0 0 0; }
    figure{ margin: 12px 0 0 0; border-top: 1px solid var(--line); background: rgba(0,0,0,0.12); }
    .figcap{
      padding: 10px 14px;
      color: var(--faint);
      font-size: 12px;
      border-top: 1px solid var(--line);
    }
    canvas{ width:100%; height: 300px; display:block; }
    .backtop{ display:flex; justify-content:flex-end; margin-top: 10px; }
    .backtop a{
      display:inline-flex; gap:8px; align-items:center;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.04);
      color: var(--muted);
      font-weight:700;
      font-size:12px;
    }
    .backtop a:hover{ background: rgba(255,255,255,0.08); text-decoration:none; }
    footer{ padding: 16px clamp(18px, 2.6vw, 34px) 32px; color: var(--faint); font-size: 12px; }
    @media print{
      body{background:#fff; color:#000}
      .card, .callout, details, .eq{box-shadow:none}
      .toc{display:none}
      a{color:#000; text-decoration:underline}
      header{padding: 14px}
      main{display:block; padding: 0 14px}
      .card{break-inside:avoid; margin: 0 0 14px 0}
      canvas{height: 240px}
      .backtop{display:none}
      button.copy{display:none}
      .eq{border:1px solid #999; background:#f7f7f7; color:#000}
      .callout{border:1px solid #999; background:#f7f7f7}
      p,li{color:#000}
      h1,h2,h3{color:#000}
    }
    @keyframes glowIn{
      from{filter: drop-shadow(0 0 0 rgba(124,240,197,0)); transform: translateY(1px)}
      to{filter: drop-shadow(0 10px 20px rgba(124,240,197,0.08)); transform: translateY(0)}
    }
    .anchor-target:target h2{animation: glowIn 240ms ease}
  </style>
</head>

<body>
  <header id="top">
    <div class="topbar">
      <div class="titleblock">
        <h1>Threshold Pump Intensity for Parametric Oscillation (Degenerate OPO)</h1>
        <p class="subtitle">
          We find the <strong>minimum intracavity pump intensity</strong> needed for a LiNbO<sub>3</sub> crystal to reach
          <strong>parametric oscillation</strong> when the signal and idler are degenerate (equal frequencies).
        </p>
        <div class="meta">
          <span class="pill">Nonlinear optics • χ(2) / three-wave mixing</span>
          <span class="pill">Degenerate OPO threshold • cavity loss vs gain</span>
          <span class="pill">Given: L = 5 cm, n = 2.2, d = 4×10<sup>−23</sup> C/V², R = 0.98</span>
        </div>
      </div>
    </div>
  </header>

  <main>
    <article class="card">
      <div class="inner">

        <section class="section anchor-target" id="quick-summary">
          <h2><span class="dot"></span>Quick Summary</h2>
          <ul>
            <li><strong>What this is about:</strong> an optical parametric oscillator (OPO) in a cavity, pumped at 0.53 μm, oscillating at 1.06 μm (degenerate signal/idler).</li>
            <li><strong>Key physics idea:</strong> oscillation starts when <em>parametric gain per round trip</em> just balances <em>cavity loss per round trip</em>.</li>
            <li><strong>Governing ingredient:</strong> the <strong>χ(2) parametric coupling</strong> makes the signal field grow exponentially with gain coefficient <code>g</code> proportional to the pump field amplitude.</li>
            <li><strong>Threshold condition (core):</strong> <span style="white-space:nowrap">exp(2 g L) × R = 1</span> for a linear cavity round trip (two passes through the crystal; mirror product = R).</li>
            <li><strong>Result type:</strong> numeric intensity threshold <em>inside the crystal</em> (intracavity pump intensity), because no mode area or pump coupling is given.</li>
            <li><strong>Physical meaning:</strong> below threshold, noise is only amplified; at threshold, the cavity supports self-sustained oscillation at 1.06 μm.</li>
            <li><strong>Final number (using given SI definitions):</strong> <strong>I<sub>p,th</sub> ≈ 8.0×10<sup>5</sup> W/m² ≈ 80 W/cm²</strong>.</li>
            <li><strong>Big dependencies:</strong> threshold scales like <strong>I<sub>th</sub> ∝ [ln(1/R)]² / (d² L²)</strong>: higher reflectance, larger nonlinearity, and longer crystal dramatically reduce threshold.</li>
          </ul>

          <div class="kpi">
            <div class="box">
              <p class="small">Pump wavelength (frequency-doubled Nd:YAG)</p>
              <div class="big">λ<sub>p</sub> = 0.53 μm</div>
              <p class="small">Degenerate signal/idler wavelength</p>
              <div class="big">λ<sub>s</sub> = λ<sub>i</sub> = 1.06 μm</div>
            </div>
            <div class="box">
              <p class="small">Threshold pump intensity (intracavity)</p>
              <div class="big">I<sub>p,th</sub> ≈ 8.0×10<sup>5</sup> W/m²</div>
              <p class="small">Equivalent</p>
              <div class="big">≈ 80 W/cm²</div>
            </div>
          </div>
        </section>

        <section class="section anchor-target" id="part0">
          <h2><span class="dot"></span>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <h3>0.1 What is a parametric oscillator?</h3>
          <p>
            A <strong>χ(2) parametric process</strong> converts pump photons into pairs of lower-frequency photons:
            <strong>signal</strong> (ω<sub>s</sub>) and <strong>idler</strong> (ω<sub>i</sub>), constrained by
            <strong>energy conservation</strong>:
          </p>
          <div class="eq" data-copy>
ω_p = ω_s + ω_i
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>
          <p>
            In a <strong>degenerate OPO</strong>, the special case is ω<sub>s</sub> = ω<sub>i</sub> = ω<sub>p</sub>/2,
            so signal and idler have the <em>same frequency</em>.
          </p>

          <h3>0.2 Core definitions (symbols + SI units)</h3>
          <div class="callout eqs">
            <div class="label"><span class="badge">Core symbols</span> what each quantity means</div>
            <ul>
              <li><strong>L</strong> (m): crystal length along propagation.</li>
              <li><strong>n</strong> (dimensionless): refractive index (assumed equal for pump/signal/idler here).</li>
              <li><strong>d</strong> (C/V²): second-order nonlinear coefficient as given, used via <strong>P<sub>NL</sub> = d E²</strong>.</li>
              <li><strong>E</strong> (V/m): electric-field amplitude inside the medium.</li>
              <li><strong>I</strong> (W/m²): intensity, related to field by <strong>I = (1/2) n ε₀ c E²</strong>.</li>
              <li><strong>R</strong> (dimensionless): <em>power</em> reflectance of each mirror; amplitude reflectivity is √R.</li>
              <li><strong>g</strong> (1/m): parametric gain coefficient (exponential growth rate of the resonant field amplitude).</li>
              <li><strong>Δk</strong> (1/m): phase-mismatch. Phase matching means Δk = 0.</li>
            </ul>
          </div>

          <h3>0.3 How χ(2) coupling creates gain</h3>
          <p>
            With the problem’s convention, the second-order nonlinear polarization is:
          </p>
          <div class="eq" data-copy>
P_NL = d E^2
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>
          <p>
            Under <strong>undepleted pump</strong> and <strong>Δk=0</strong>, the resonant field grows approximately as:
          </p>
          <div class="eq" data-copy>
E_s(z) ∝ exp(g z)   where   g ∝ |E_p|
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>

          <h3>0.4 Threshold = gain balances loss</h3>
          <p>
            An OPO reaches threshold when the <strong>round-trip parametric amplification</strong> equals the <strong>round-trip loss</strong>.
          </p>

          <div class="callout assump">
            <div class="label"><span class="badge">Validity conditions</span> when this model is accurate</div>
            <ul>
              <li>Near threshold: <strong>pump depletion negligible</strong>.</li>
              <li><strong>Phase matching satisfied</strong> (Δk = 0), as stated.</li>
              <li>Plane-wave / uniform intensity (no mode area given).</li>
              <li>Only mirror losses included (no absorption/scatter specified).</li>
              <li>Index approximately constant with frequency (given).</li>
            </ul>
          </div>

          <h3>0.5 Mini intuition examples</h3>
          <ul>
            <li><strong>Higher R ⇒ lower threshold:</strong> less loss per round trip means less gain required.</li>
            <li><strong>Longer L ⇒ lower threshold:</strong> gain accumulates over distance; I<sub>th</sub> ∝ 1/L².</li>
            <li><strong>Larger d ⇒ lower threshold:</strong> stronger coupling; I<sub>th</sub> ∝ 1/d².</li>
          </ul>

          <h3>0.6 What to watch for</h3>
          <div class="callout mist">
            <div class="label"><span class="badge">Pitfalls</span></div>
            <ul>
              <li><strong>Amplitude vs power reflectance:</strong> R is power; field reflection is √R.</li>
              <li><strong>Two passes:</strong> linear cavity round trip traverses the crystal twice.</li>
              <li><strong>Meaning of “pump intensity”:</strong> here it means <em>intracavity intensity in the crystal</em>.</li>
              <li><strong>Nonlinear coefficient conventions vary:</strong> this problem gives d in C/V² consistent with P<sub>NL</sub>=dE².</li>
            </ul>
          </div>
        </section>

        <section class="section anchor-target" id="part1">
          <h2><span class="dot"></span>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <h3>1.1 Restate the problem</h3>
          <p>
            A 5 cm LiNbO<sub>3</sub> crystal is placed in a resonator with two identical mirrors (power reflectance R=0.98).
            It is pumped at 0.53 μm (frequency-doubled Nd:YAG), and phase matching holds at degeneracy (signal=idler).
            Find the <strong>minimum pump intensity</strong> required for parametric oscillation.
          </p>

          <div class="grid2">
            <div class="callout">
              <div class="label"><span class="badge">Given</span></div>
              <ul>
                <li>L = 0.05 m</li>
                <li>n = 2.2</li>
                <li>d = 4×10<sup>−23</sup> C/V²</li>
                <li>R = 0.98 (each mirror, power reflectance)</li>
                <li>λ<sub>p</sub>=0.53 μm, λ<sub>s</sub>=λ<sub>i</sub>=1.06 μm</li>
                <li>Δk=0 at degeneracy</li>
              </ul>
            </div>
            <div class="callout">
              <div class="label"><span class="badge">Find</span></div>
              <ul>
                <li>I<sub>p,th</sub> (W/m²) inside the crystal.</li>
              </ul>
              <div class="label" style="margin-top:10px;"><span class="badge">Not determinable from data</span></div>
              <ul>
                <li>Threshold pump power (needs beam area/mode size).</li>
              </ul>
            </div>
          </div>

          <h3>1.2 Principles that apply</h3>
          <ul>
            <li>χ(2) three-wave mixing provides small-signal gain for the resonant wave.</li>
            <li>Cavity threshold occurs when round-trip gain equals round-trip loss.</li>
            <li>Phase matching maximizes gain; given Δk=0, we use the maximum-gain case.</li>
          </ul>

          <h3>1.3 Assumptions</h3>
          <div class="callout assump">
            <div class="label"><span class="badge">Assumptions</span></div>
            <ul>
              <li>Undepleted pump at threshold.</li>
              <li>Perfect phase matching Δk=0.</li>
              <li>Plane-wave uniform intensity through length L.</li>
              <li>Only mirror losses matter.</li>
              <li>Linear two-mirror cavity ⇒ two passes through the crystal per round trip.</li>
            </ul>
          </div>

          <h3>1.4 Approaches</h3>
          <ul>
            <li><strong>Coupled-wave + gain–loss balance:</strong> transparent, matches given data (chosen).</li>
            <li><strong>Memorized OPO threshold formulas:</strong> fast but risky due to convention differences.</li>
            <li><strong>Full eigenvalue (transfer matrix) analysis:</strong> rigorous but unnecessary here.</li>
          </ul>
        </section>

        <section class="section anchor-target" id="part2">
          <h2><span class="dot"></span>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

          <ol style="color:var(--muted); margin: 8px 0 8px 18px;">
            <li>Use frequency doubling + degeneracy to set λ<sub>s</sub> and ω<sub>s</sub>.</li>
            <li>Write the degenerate parametric envelope equation and identify gain coefficient g.</li>
            <li>Impose the linear-cavity threshold condition for a full round trip (two passes + two mirror reflections).</li>
            <li>Solve for E<sub>p,th</sub> from g<sub>th</sub>.</li>
            <li>Convert E<sub>p,th</sub> to intensity I<sub>p,th</sub>.</li>
            <li>Do unit and limiting-case checks.</li>
          </ol>

          <div class="callout mist">
            <div class="label"><span class="badge">Common mistakes</span></div>
            <ul>
              <li>Using ln(R) instead of ln(1/R).</li>
              <li>Forgetting the crystal is traversed twice in a linear cavity round trip.</li>
              <li>Mixing power and field reflection coefficients.</li>
              <li>Reporting “pump power” without mode area information.</li>
            </ul>
          </div>
        </section>

        <section class="section anchor-target" id="part3">
          <h2><span class="dot"></span>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>3.1 Frequencies and degeneracy</h3>
          <p>
            Frequency doubling of a 1.06 μm laser gives:
          </p>
          <div class="eq" data-copy>
λ_p = 1.06 μm / 2 = 0.53 μm
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>
          <p>
            Degenerate operation means ω<sub>s</sub>=ω<sub>i</sub>=ω<sub>p</sub>/2, so:
          </p>
          <div class="eq" data-copy>
λ_s = λ_i = 1.06 μm
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>

          <h3>3.2 Gain coefficient for a degenerate χ(2) amplifier (Δk=0)</h3>
          <p>
            With the convention P<sub>NL</sub>=dE², the degenerate parametric envelope equation can be written as:
          </p>
          <div class="eq" data-copy>
dE_s/dz = g E_s*     with     g = (ω_s d / (n c ε0)) |E_p|
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>
          <p>
            Physically: the pump field “drives” the signal/idler pair creation. The stronger |E<sub>p</sub>| is, the larger g is, and the faster the resonant field grows along z.
          </p>

          <h3>3.3 Round-trip threshold condition</h3>
          <p>
            In a linear two-mirror cavity, the resonant field passes through the crystal twice per round trip, so amplitude gain is exp(2gL).
            Each mirror has power reflectance R, so each has field reflectivity √R; two reflections give a net field factor R.
            Therefore the round-trip field multiplier is:
          </p>
          <div class="eq" data-copy>
(round-trip factor) = R · exp(2 g L)
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>
          <p>
            Threshold occurs when the round-trip factor equals 1:
          </p>
          <div class="eq" data-copy>
R · exp(2 g_th L) = 1
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>
          <p>
            Solve for g<sub>th</sub>:
          </p>
          <div class="eq" data-copy>
2 g_th L = ln(1/R)     ⇒     g_th = ln(1/R) / (2L)
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>

          <h3>3.4 Solve for pump field and intensity at threshold</h3>
          <p>
            From g = (ω<sub>s</sub>d/(n c ε₀))|E<sub>p</sub>|, we get:
          </p>
          <div class="eq" data-copy>
|E_p,th| = g_th · (n c ε0)/(ω_s d)
         = [ln(1/R)]/(2L) · (n c ε0)/(ω_s d)
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>
          <p>
            Convert field to intensity in a dielectric:
          </p>
          <div class="eq" data-copy>
I_p = (1/2) n ε0 c |E_p|^2
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>
          <p>
            Combining gives a compact threshold intensity formula:
          </p>
          <div class="eq" data-copy>
I_p,th = (1/2) n ε0 c · { [ln(1/R)]/(2L) · (n c ε0)/(ω_s d) }^2
       = [n^3 ε0^3 c^3 / (8 ω_s^2 d^2 L^2)] · [ln(1/R)]^2
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy equation</button>
              <span class="copystatus" aria-live="polite"></span>
            </div>
          </div>

          <h3>3.5 Numerical evaluation</h3>
          <ul>
            <li>L = 0.05 m</li>
            <li>n = 2.2</li>
            <li>d = 4×10<sup>−23</sup> C/V²</li>
            <li>R = 0.98 ⇒ ln(1/R) = ln(1/0.98) ≈ 0.0202027</li>
            <li>λ<sub>s</sub>=1.06 μm ⇒ ω<sub>s</sub> = 2πc/λ<sub>s</sub> ≈ 1.777×10<sup>15</sup> rad/s</li>
            <li>ε₀ = 8.854187817×10<sup>−12</sup> F/m, c = 2.99792458×10<sup>8</sup> m/s</li>
          </ul>
          <p>
            Compute g<sub>th</sub>:
            g<sub>th</sub> = 0.0202027/(2×0.05) = 0.202 m<sup>−1</sup>.
            Then |E<sub>p,th</sub>| ≈ 1.66×10<sup>4</sup> V/m, and:
          </p>

          <div class="callout final">
            <div class="label"><span class="badge">Final Answer</span> minimum pump intensity for oscillation</div>
            <div class="eq" data-copy data-final>
I_p,th ≈ 8.0 × 10^5 W/m^2  ≈ 80 W/cm^2   (intracavity pump intensity in the crystal)
              <div class="btnrow">
                <button class="copy" data-copy-btn>Copy final answer</button>
                <span class="copystatus" aria-live="polite"></span>
              </div>
            </div>
            <p style="margin-top:8px;">
              This is the pump intensity <strong>inside</strong> the crystal needed so that the parametric gain per round trip equals mirror loss.
            </p>
          </div>

          <h3>3.6 Sanity checks</h3>
          <div class="grid2">
            <div class="callout">
              <div class="label"><span class="badge">Units</span></div>
              <ul>
                <li>g has units 1/m, and I has units W/m² using I=(1/2)nε₀cE².</li>
              </ul>
            </div>
            <div class="callout">
              <div class="label"><span class="badge">Limiting behavior</span></div>
              <ul>
                <li>R→1 ⇒ ln(1/R)→0 ⇒ I<sub>th</sub>→0.</li>
                <li>L↑ ⇒ I<sub>th</sub>↓ as 1/L².</li>
                <li>d↑ ⇒ I<sub>th</sub>↓ as 1/d².</li>
              </ul>
            </div>
          </div>

          <div class="backtop"><a href="#top">↑ Back to top</a></div>
        </section>

        <section class="section anchor-target" id="part4">
          <h2><span class="dot"></span>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>4.1 What each term controls</h3>
          <ul>
            <li><strong>ln(1/R):</strong> measures how “lossy” the cavity is per round trip; squared dependence makes reflectance very influential.</li>
            <li><strong>L:</strong> interaction length; more length accumulates gain, giving I<sub>th</sub>∝1/L².</li>
            <li><strong>d:</strong> nonlinear strength; stronger χ(2) coupling reduces threshold, I<sub>th</sub>∝1/d².</li>
            <li><strong>ω<sub>s</sub>:</strong> sets coupling scale in the envelope equation; here I<sub>th</sub>∝1/ω<sub>s</sub>².</li>
          </ul>

          <h3>4.2 Alternative derivation (idea)</h3>
          <p>
            You can model one round trip as a linear transformation of the field vector (E, E*) using a 2×2 “squeezing” matrix for the χ(2) pass
            and scalar reflection factors for the mirrors. Threshold occurs when the largest eigenvalue magnitude reaches 1, which reduces to
            R·exp(2gL)=1 at the optimum phase near threshold.
          </p>

          <h3>4.3 Concept check (with answers)</h3>
          <ul>
            <li><strong>Q:</strong> Why do small reflectance changes matter a lot? <strong>A:</strong> I<sub>th</sub> depends on [ln(1/R)]², which collapses quickly as R→1.</li>
            <li><strong>Q:</strong> Why is “pump intensity” the natural output? <strong>A:</strong> No beam area/mode size is provided, so power cannot be determined uniquely.</li>
            <li><strong>Q:</strong> What breaks the undepleted-pump assumption? <strong>A:</strong> Far above threshold, the generated signal/idler extract energy and reduce pump amplitude, saturating gain.</li>
          </ul>

          <div class="backtop"><a href="#top">↑ Back to top</a></div>
        </section>

        <section class="section anchor-target" id="part5">
          <h2><span class="dot"></span>PART 5 — Optional Plot Guide</h2>
          <p>
            A plot is not required to solve the threshold, but it helps visualize how strongly I<sub>th</sub> depends on mirror reflectance.
            We plot I<sub>th</sub>(R) using the derived formula and the problem’s parameters, and mark the point R=0.98.
          </p>

          <figure class="card" style="border-radius:16px;">
            <div class="inner" style="padding:12px 14px;">
              <h3 style="margin:0 0 6px 0;">Threshold intensity vs reflectance R (problem parameters)</h3>
              <p style="margin:0; color:var(--faint); font-size:12px;">
                y-axis in W/cm²; x-axis is mirror power reflectance R. Marked point is R=0.98.
              </p>
            </div>
            <canvas id="plot" aria-label="Threshold intensity versus reflectance plot"></canvas>
            <div class="figcap">
              Notice the rapid drop as R→1 because I<sub>th</sub> ∝ [ln(1/R)]². The marked point corresponds to this problem.
            </div>
          </figure>

          <div class="callout eqs">
            <div class="label"><span class="badge">Plot guide</span></div>
            <ul>
              <li><strong>x-axis:</strong> R (dimensionless).</li>
              <li><strong>y-axis:</strong> I<sub>th</sub> (W/cm²).</li>
              <li><strong>Values used:</strong> L=5 cm, n=2.2, d=4×10<sup>−23</sup> C/V², λ<sub>s</sub>=1.06 μm (from the problem).</li>
              <li><strong>Feature:</strong> curvature becomes extreme near R≈1 because the logarithm shrinks.</li>
            </ul>
          </div>

          <div class="backtop"><a href="#top">↑ Back to top</a></div>
        </section>

      </div>
    </article>

    <aside class="card toc" aria-label="Table of contents">
      <h2>Table of Contents</h2>
      <nav>
        <a href="#quick-summary">Quick Summary</a>
        <a href="#part0">PART 0 — Concept Primer</a>
        <a href="#part1">PART 1 — Problem Analysis</a>
        <a href="#part2">PART 2 — Strategy &amp; Tips</a>
        <a href="#part3">PART 3 — Full Solution</a>
        <a href="#part4">PART 4 — Deeper Understanding</a>
        <a href="#part5">PART 5 — Optional Plot Guide</a>
      </nav>
      <p class="small">
        Tip: Use the “Copy” buttons to grab equations and the final numerical result as plain text.
      </p>
    </aside>
  </main>

  <footer>
    <p>
      Notes: The result is the <strong>intracavity pump intensity</strong> inside the crystal. Converting to external pump power requires beam area,
      focusing, and coupling details not provided. Nonlinear-coefficient conventions vary across texts; this solution follows the problem’s given unit
      (C/V²) consistent with P<sub>NL</sub>=dE².
    </p>
  </footer>

  <script>
    // Smooth scrolling
    (function(){
      document.addEventListener('click', function(e){
        const a = e.target.closest('a[href^="#"]');
        if(!a) return;
        const id = a.getAttribute('href');
        const el = document.querySelector(id);
        if(!el) return;
        e.preventDefault();
        el.scrollIntoView({behavior:'smooth', block:'start'});
        history.replaceState(null, '', id);
      });
    })();

    // Copy buttons (plain text)
    (function(){
      function plainTextFromEq(eqEl){
        const clone = eqEl.cloneNode(true);
        const btnrow = clone.querySelector('.btnrow');
        if(btnrow) btnrow.remove();
        return clone.textContent.replace(/\u00A0/g,' ').replace(/[ \t]+\n/g,'\n').replace(/\n{3,}/g,'\n\n').trim();
      }
      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch(err){
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          ta.style.top = '0';
          document.body.appendChild(ta);
          ta.focus(); ta.select();
          let ok = false;
          try{ ok = document.execCommand('copy'); }catch(e){ ok = false; }
          document.body.removeChild(ta);
          return ok;
        }
      }
      document.querySelectorAll('[data-copy]').forEach(eqEl=>{
        const btn = eqEl.querySelector('[data-copy-btn]');
        const status = eqEl.querySelector('.copystatus');
        if(!btn || !status) return;
        btn.addEventListener('click', async ()=>{
          const text = plainTextFromEq(eqEl);
          const ok = await copyText(text);
          status.textContent = ok ? 'Copied.' : 'Copy failed.';
          status.style.color = ok ? 'var(--accent)' : 'var(--bad)';
          setTimeout(()=>{ status.textContent=''; status.style.color='var(--faint)'; }, 1400);
        });
      });
    })();

    // Static plot: I_th vs R (problem parameters)
    (function(){
      const canvas = document.getElementById('plot');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      const eps0 = 8.854187817e-12;
      const c = 2.99792458e8;
      const n = 2.2;
      const L = 0.05;
      const d = 4e-23;
      const lam_s = 1.06e-6;
      const omega_s = 2*Math.PI*c/lam_s;

      function Ith_Wm2(R){
        const ln = Math.log(1/R);
        const pref = (Math.pow(n,3) * Math.pow(eps0,3) * Math.pow(c,3)) / (8 * Math.pow(omega_s,2) * Math.pow(d,2) * Math.pow(L,2));
        return pref * ln*ln;
      }
      function toWcm2(Wm2){ return Wm2/1e4; }

      function sizeCanvas(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const rect = canvas.getBoundingClientRect();
        canvas.width = Math.round(rect.width * dpr);
        canvas.height = Math.round(rect.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
        draw(rect.width, rect.height);
      }

      function draw(w, h){
        ctx.clearRect(0,0,w,h);

        const padL = 58, padR = 18, padT = 28, padB = 44;
        const x0 = padL, y0 = padT;
        const x1 = w - padR, y1 = h - padB;
        const pw = x1 - x0, ph = y1 - y0;

        const Rmin = 0.90, Rmax = 0.999;
        const N = 320;
        const data = [];
        let yMax = 0;
        for(let i=0;i<N;i++){
          const t = i/(N-1);
          const R = Rmin + (Rmax - Rmin)*t;
          const y = toWcm2(Ith_Wm2(R));
          data.push({R, y});
          if(isFinite(y) && y>yMax) yMax = y;
        }
        yMax *= 1.10;

        function xMap(R){ return x0 + (R - Rmin)/(Rmax - Rmin)*pw; }
        function yMap(y){ return y1 - (y / yMax)*ph; }

        ctx.fillStyle = 'rgba(0,0,0,0.18)';
        ctx.fillRect(x0, y0, pw, ph);

        ctx.lineWidth = 1;
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        const xTicks = 6, yTicks = 5;

        for(let i=0;i<=xTicks;i++){
          const x = x0 + (i/xTicks)*pw;
          ctx.beginPath(); ctx.moveTo(x, y0); ctx.lineTo(x, y1); ctx.stroke();
        }
        for(let j=0;j<=yTicks;j++){
          const y = y0 + (j/yTicks)*ph;
          ctx.beginPath(); ctx.moveTo(x0, y); ctx.lineTo(x1, y); ctx.stroke();
        }

        ctx.strokeStyle = 'rgba(255,255,255,0.35)';
        ctx.lineWidth = 1.2;
        ctx.beginPath(); ctx.moveTo(x0, y1); ctx.lineTo(x1, y1); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(x0, y0); ctx.lineTo(x0, y1); ctx.stroke();

        ctx.fillStyle = 'rgba(233,238,252,0.88)';
        ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;

        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        for(let i=0;i<=xTicks;i++){
          const R = Rmin + (Rmax - Rmin)*(i/xTicks);
          const x = xMap(R);
          ctx.fillText(R.toFixed(i===xTicks?3:2), x, y1 + 8);
        }

        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        for(let j=0;j<=yTicks;j++){
          const yVal = (yMax)*(j/yTicks);
          const y = yMap(yVal);
          const label = (yVal >= 1000) ? (yVal/1000).toFixed(1) + 'k' : yVal.toFixed(0);
          ctx.fillText(label, x0 - 8, y);
        }

        ctx.fillStyle = 'rgba(233,238,252,0.92)';
        ctx.font = '700 12px ' + getComputedStyle(document.body).fontFamily;

        ctx.textAlign = 'center';
        ctx.textBaseline = 'bottom';
        ctx.fillText('Mirror power reflectance, R (dimensionless)', x0 + pw/2, h - 12);

        ctx.save();
        ctx.translate(16, y0 + ph/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        ctx.fillText('Threshold pump intensity, I_th (W/cm²)', 0, 0);
        ctx.restore();

        ctx.font = '800 13px ' + getComputedStyle(document.body).fontFamily;
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.fillText('I_th vs R (problem parameters)', x0 + 10, y0 + 8);

        ctx.strokeStyle = 'rgba(124,240,197,0.90)';
        ctx.lineWidth = 2.2;
        ctx.beginPath();
        data.forEach((pt, idx)=>{
          const x = xMap(pt.R);
          const y = yMap(pt.y);
          if(idx===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
        });
        ctx.stroke();

        const Rstar = 0.98;
        const ystar = toWcm2(Ith_Wm2(Rstar));
        const xs = xMap(Rstar);
        const ys = yMap(ystar);

        ctx.fillStyle = 'rgba(255,255,255,0.92)';
        ctx.beginPath(); ctx.arc(xs, ys, 4.6, 0, Math.PI*2); ctx.fill();

        ctx.font = '700 12px ' + getComputedStyle(document.body).fontFamily;
        ctx.textAlign = 'left';
        ctx.textBaseline = 'bottom';
        const txt = 'R = 0.98 → I_th ≈ ' + (ystar>=1000 ? (ystar/1000).toFixed(2)+'k' : ystar.toFixed(1)) + ' W/cm²';

        const bx = Math.min(xs + 10, x1 - 190);
        const by = Math.max(ys - 8, y0 + 30);
        const bw = 190, bh = 28;

        ctx.fillStyle = 'rgba(0,0,0,0.55)';
        ctx.strokeStyle = 'rgba(255,255,255,0.16)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        roundRect(ctx, bx, by - bh, bw, bh, 8);
        ctx.fill(); ctx.stroke();

        ctx.fillStyle = 'rgba(233,238,252,0.92)';
        ctx.fillText(txt, bx + 10, by - 8);

        // Legend
        const lx = x1 - 140, ly = y0 + 12;
        ctx.fillStyle = 'rgba(0,0,0,0.45)';
        ctx.strokeStyle = 'rgba(255,255,255,0.14)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        roundRect(ctx, lx, ly, 126, 34, 10);
        ctx.fill(); ctx.stroke();

        ctx.strokeStyle = 'rgba(124,240,197,0.90)';
        ctx.lineWidth = 3;
        ctx.beginPath(); ctx.moveTo(lx + 10, ly + 17); ctx.lineTo(lx + 34, ly + 17); ctx.stroke();

        ctx.fillStyle = 'rgba(233,238,252,0.88)';
        ctx.font = '700 12px ' + getComputedStyle(document.body).fontFamily;
        ctx.textAlign = 'left';
        ctx.textBaseline = 'middle';
        ctx.fillText('I_th(R)', lx + 42, ly + 17);

        function roundRect(c, x, y, w, h, r){
          const rr = Math.min(r, w/2, h/2);
          c.moveTo(x+rr, y);
          c.arcTo(x+w, y, x+w, y+h, rr);
          c.arcTo(x+w, y+h, x, y+h, rr);
          c.arcTo(x, y+h, x, y, rr);
          c.arcTo(x, y, x+w, y, rr);
          c.closePath();
        }
      }

      window.addEventListener('resize', sizeCanvas, {passive:true});
      sizeCanvas();
    })();
  </script>
</body>
</html>
