<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Coupled-Wave Equations for Degenerate Four-Wave Mixing (χ(3)) — Collinear, Phase Matched</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1620;
      --card:#111b27;
      --ink:#eaf1ff;
      --muted:#b7c4da;
      --faint:#7f91ad;
      --line:rgba(255,255,255,.10);
      --line2:rgba(255,255,255,.16);
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 14px;
      --max: 1180px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 12% 10%, rgba(125,211,252,.15), transparent 60%),
        radial-gradient(900px 600px at 88% 16%, rgba(167,139,250,.14), transparent 62%),
        radial-gradient(900px 700px at 40% 92%, rgba(52,211,153,.10), transparent 60%),
        linear-gradient(180deg, var(--bg), #070a0f);
      line-height:1.55;
    }
    a{color:inherit}
    .wrap{
      max-width:var(--max);
      margin:0 auto;
      padding:28px 18px 60px;
    }
    header{
      padding:26px 18px 18px;
      border:1px solid var(--line);
      border-radius:var(--radius);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    header:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(800px 250px at 20% 20%, rgba(125,211,252,.18), transparent 60%),
                  radial-gradient(700px 260px at 80% 30%, rgba(167,139,250,.16), transparent 60%);
      filter: blur(2px);
      opacity:.75;
      pointer-events:none;
    }
    header > *{position:relative}
    h1{
      margin:0 0 8px;
      font-size: clamp(1.35rem, 2.3vw, 2.15rem);
      letter-spacing:.2px;
    }
    .sub{
      margin:0;
      color:var(--muted);
      max-width: 70ch;
    }
    .meta{
      display:flex; flex-wrap:wrap; gap:10px 12px;
      margin-top:14px;
      color:var(--faint);
      font-size:.92rem;
    }
    .pill{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:6px 10px;
      border-radius:999px;
    }

    main{
      margin-top:18px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width: 980px){
      main{grid-template-columns:1fr}
    }

    aside{
      position:sticky;
      top:14px;
      border:1px solid var(--line);
      border-radius:var(--radius);
      background:rgba(255,255,255,.03);
      box-shadow: var(--shadow);
      padding:14px 14px 10px;
    }
    @media (max-width: 980px){
      aside{position:relative; top:auto}
    }
    .tocTitle{
      margin:0 0 8px;
      font-size:1rem;
      color:var(--muted);
      letter-spacing:.2px;
    }
    .toc a{
      display:block;
      text-decoration:none;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid transparent;
      color:var(--ink);
      opacity:.92;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size:.95rem;
    }
    .toc a:hover{
      background:rgba(125,211,252,.08);
      border-color:rgba(125,211,252,.22);
      transform: translateY(-1px);
    }

    article{
      border:1px solid var(--line);
      border-radius:var(--radius);
      background:rgba(255,255,255,.03);
      box-shadow: var(--shadow);
      padding:18px;
      overflow:hidden;
    }

    section{
      margin: 18px 0 0;
      padding-top: 8px;
    }
    section:first-of-type{margin-top:0}
    h2{
      margin: 0 0 10px;
      font-size: 1.25rem;
      letter-spacing:.2px;
    }
    h3{
      margin: 16px 0 10px;
      font-size: 1.05rem;
      color: var(--muted);
    }
    p{margin: 10px 0; color: rgba(234,241,255,.94)}
    ul,ol{margin:10px 0 10px 22px; color: rgba(234,241,255,.93)}
    li{margin:6px 0}
    .grid2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    @media (max-width: 760px){
      .grid2{grid-template-columns:1fr}
    }

    .card{
      border:1px solid var(--line);
      border-radius:var(--radius2);
      padding:12px 12px 10px;
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.025));
    }
    .callout{
      border-left:4px solid var(--accent);
      background: rgba(125,211,252,.06);
      padding:12px 12px 10px;
      border-radius: 14px;
      border:1px solid rgba(125,211,252,.20);
    }
    .callout.warn{
      border-left-color: var(--warn);
      background: rgba(251,191,36,.06);
      border-color: rgba(251,191,36,.20);
    }
    .callout.good{
      border-left-color: var(--good);
      background: rgba(52,211,153,.06);
      border-color: rgba(52,211,153,.20);
    }
    .callout.bad{
      border-left-color: var(--bad);
      background: rgba(251,113,133,.06);
      border-color: rgba(251,113,133,.20);
    }

    .eq{
      position:relative;
      border:1px solid var(--line2);
      border-radius: 16px;
      background: rgba(0,0,0,.22);
      padding:12px 12px 10px;
      overflow:auto;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06);
    }
    .eq pre{
      margin:0;
      font-family: var(--mono);
      font-size: .96rem;
      line-height: 1.45;
      color: rgba(234,241,255,.96);
      white-space: pre;
    }
    .copyRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin: 10px 0 0;
    }
    .btn{
      appearance:none;
      border:1px solid var(--line2);
      background: rgba(255,255,255,.04);
      color: var(--ink);
      padding:8px 11px;
      border-radius: 12px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-weight:600;
      font-size:.92rem;
    }
    .btn:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.30);
      transform: translateY(-1px);
    }
    .btn:active{transform: translateY(0px) scale(.99)}
    .btn.small{padding:6px 9px; font-size:.88rem}
    .toast{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:7px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(0,0,0,.18);
      color: var(--muted);
      font-size:.9rem;
      opacity:0;
      transform: translateY(4px);
      transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{
      opacity:1;
      transform: translateY(0);
    }
    details{
      border:1px solid var(--line);
      border-radius: 14px;
      padding:10px 12px;
      background: rgba(255,255,255,.03);
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      font-weight:700;
      color: var(--muted);
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    summary:after{
      content:"▾";
      float:right;
      color: var(--faint);
      transition: transform .12s ease;
    }
    details[open] summary:after{transform: rotate(180deg)}
    .backTop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      color: var(--muted);
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      padding:8px 10px;
      border-radius: 999px;
      margin-top: 14px;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .backTop:hover{
      background: rgba(167,139,250,.09);
      border-color: rgba(167,139,250,.28);
      transform: translateY(-1px);
    }

    footer{
      margin-top:16px;
      color: var(--faint);
      font-size:.92rem;
      text-align:center;
      padding: 10px 0 0;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, article, aside{box-shadow:none; background:#fff}
      aside{position:relative; border:1px solid #ddd}
      .btn, .toast{display:none !important}
      a{color:#000; text-decoration:none}
      .eq{background:#fff; border:1px solid #bbb}
      .callout, .card{background:#fff; border-color:#bbb}
      section{break-inside:avoid-page}
      h2,h3{break-after:avoid-page}
    }
  </style>
</head>
<body>
  <div class="wrap" id="top">
    <header>
      <h1>Coupled-Wave Equations for Degenerate Four-Wave Mixing (χ(3))</h1>
      <p class="sub">
        We derive the <em>slowly-varying</em> coupled amplitude equations for collinear four-wave mixing in a third-order nonlinear medium,
        in the <strong>degenerate</strong> case ω<sub>4</sub>=ω<sub>3</sub> and ω<sub>1</sub>+ω<sub>2</sub>=2ω<sub>3</sub>, assuming perfect phase matching.
      </p>
      <div class="meta">
        <span class="pill">Topic: nonlinear optics (χ(3))</span>
        <span class="pill">Regime: SVEA, plane waves, collinear</span>
        <span class="pill">Case: degenerate FWM (signal=idler)</span>
        <span class="pill">Assumption: Δk = 0</span>
      </div>
    </header>

    <main>
      <aside aria-label="Table of contents">
        <div class="tocTitle">Table of Contents</div>
        <nav class="toc">
          <a href="#quick">Quick Summary</a>
          <a href="#primer">PART 0 — Concept Primer</a>
          <a href="#analysis">PART 1 — Problem Analysis</a>
          <a href="#strategy">PART 2 — Strategy & Tips</a>
          <a href="#solution">PART 3 — Full Solution</a>
          <a href="#deeper">PART 4 — Deeper Understanding</a>
          <a href="#plot">PART 5 — Optional Plot Guide</a>
        </nav>
        <div style="margin-top:12px;border-top:1px solid var(--line);padding-top:10px">
          <button class="btn small" data-scroll="#top" aria-label="Back to top (button)">↑ Back to top</button>
        </div>
      </aside>

      <article>
        <section id="quick">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this problem is about:</strong> writing coupled-wave equations for <em>collinear</em> four-wave mixing in a χ(3) medium.</li>
            <li><strong>Degenerate condition:</strong> ω<sub>4</sub>=ω<sub>3</sub> and energy conservation ω<sub>1</sub>+ω<sub>2</sub>=2ω<sub>3</sub>.</li>
            <li><strong>Key physics idea:</strong> the third-order nonlinear polarization at each frequency is driven by <em>products</em> of the other fields.</li>
            <li><strong>Governing equation:</strong> the wave equation with nonlinear source, reduced under the <em>slowly-varying envelope approximation</em> (SVEA).</li>
            <li><strong>Phase matching:</strong> Δk ≡ k<sub>1</sub>+k<sub>2</sub>−k<sub>3</sub>−k<sub>4</sub>; here Δk = k<sub>1</sub>+k<sub>2</sub>−2k<sub>3</sub>=0.</li>
            <li><strong>Result type:</strong> symbolic coupled ODEs for complex envelopes A<sub>1</sub>(z), A<sub>2</sub>(z), A<sub>3</sub>(z).</li>
            <li><strong>Physical meaning:</strong> the “mixing terms” exchange energy among waves; in the degenerate case the ω<sub>3</sub> equation gets a <em>factor 2</em> from degeneracy.</li>
            <li><strong>Extra detail:</strong> self- and cross-phase modulation terms can be included; they mainly shift phases and can often be absorbed into effective propagation constants.</li>
          </ul>

          <div class="callout good">
            <strong>Takeaway:</strong> In degenerate FWM, the nonlinear source at ω<sub>1</sub> is ∝ A<sub>2</sub><sup>*</sup>A<sub>3</sub><sup>2</sup>, at ω<sub>2</sub> is ∝ A<sub>1</sub><sup>*</sup>A<sub>3</sub><sup>2</sup>, and at ω<sub>3</sub> is ∝ 2A<sub>1</sub>A<sub>2</sub>A<sub>3</sub><sup>*</sup> (perfect phase match).
          </div>
        </section>

        <section id="primer">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <div class="grid2">
            <div class="card">
              <h3>Core definitions (symbols + SI units)</h3>
              <ul>
                <li><strong>E(z,t)</strong>: real electric field (V/m).</li>
                <li><strong>A<sub>j</sub>(z)</strong>: complex slowly-varying envelope of wave j (same units as E unless rescaled).</li>
                <li><strong>ω<sub>j</sub></strong>: angular frequency (rad/s); <strong>k<sub>j</sub></strong>: wavenumber (1/m), typically k<sub>j</sub>=n<sub>j</sub>ω<sub>j</sub>/c.</li>
                <li><strong>n<sub>j</sub></strong>: refractive index at ω<sub>j</sub> (dimensionless); <strong>c</strong>: speed of light (m/s).</li>
                <li><strong>P<sub>NL</sub></strong>: nonlinear polarization density (C/m²).</li>
                <li><strong>χ<sup>(3)</sup></strong>: third-order nonlinear susceptibility (SI units: m²/V²).</li>
                <li><strong>Δk</strong>: phase mismatch (1/m).</li>
              </ul>
            </div>

            <div class="card">
              <h3>Physical meaning (intuition)</h3>
              <ul>
                <li><strong>χ(3)</strong> means polarization responds like P ≈ ε<sub>0</sub>(χ(1)E + χ(3)E³ + …).</li>
                <li>The E³ term contains “beat products” at new frequencies (sum/difference mixing).</li>
                <li><strong>Four-wave mixing</strong> is the process where three waves drive a fourth via χ(3).</li>
                <li><strong>Phase matching</strong> ensures the generated wave builds coherently along z (constructive addition).</li>
              </ul>
            </div>
          </div>

          <div class="callout">
            <h3 style="margin:0 0 8px">Key laws/principles + validity conditions</h3>
            <ul>
              <li><strong>Wave equation with source:</strong> ∂²E/∂z² − (n²/c²)∂²E/∂t² = (1/ε<sub>0</sub>c²)∂²P<sub>NL</sub>/∂t² (in 1D, isotropic medium).</li>
              <li><strong>SVEA:</strong> envelopes vary slowly: |d²A/dz²| ≪ |k dA/dz|, and bandwidth is narrow around ω<sub>j</sub>.</li>
              <li><strong>Plane-wave, collinear:</strong> transverse effects, diffraction, walk-off neglected.</li>
              <li><strong>Undepleted vs depleted pumps:</strong> not assumed unless stated; coupled equations allow depletion.</li>
              <li><strong>Instantaneous Kerr response:</strong> χ(3) treated as frequency-independent and instantaneous (good for many glasses over modest bandwidths).</li>
            </ul>
          </div>

          <details>
            <summary>Common models/approximations (and why)</summary>
            <ul>
              <li><strong>Scalar, isotropic χ(3):</strong> simplifies tensor contractions to a single effective coefficient. In anisotropic crystals, polarization dependence and tensor components matter.</li>
              <li><strong>Keep only “phase-matched” terms:</strong> fast-oscillating contributions average out (rotating-wave / slowly-varying interaction picture).</li>
              <li><strong>Group-velocity effects neglected:</strong> justified for continuous-wave or long pulses compared to walk-off length.</li>
              <li><strong>SPM/XPM optional:</strong> included when nonlinear phase shifts matter; omitted when focusing on energy transfer/gain structure only.</li>
            </ul>
          </details>

          <div class="grid2">
            <div class="card">
              <h3>Mini intuition examples (conceptual)</h3>
              <ul>
                <li><strong>Nonlinear index:</strong> in Kerr media, n = n<sub>0</sub> + n<sub>2</sub>I. This produces self-phase modulation (SPM).</li>
                <li><strong>Mixing picture:</strong> if E has components at ω<sub>1</sub>, ω<sub>2</sub>, ω<sub>3</sub>, then E³ contains terms like e^{-i(ω1+ω2-ω3)t} which can equal e^{-iω3 t} when ω1+ω2=2ω3.</li>
                <li><strong>Coherence length:</strong> if Δk≠0, growth oscillates with z; if Δk=0, growth is monotonic (in ideal lossless case).</li>
              </ul>
            </div>

            <div class="card">
              <h3>What to watch for (pitfalls)</h3>
              <ul>
                <li><strong>Sign conventions:</strong> whether fields are written as e^{i(kz−ωt)} or e^{i(ωt−kz)} changes signs in coupled equations.</li>
                <li><strong>Complex conjugates:</strong> the generated term at ω<sub>j</sub> typically involves a product with one conjugated envelope to enforce energy conservation.</li>
                <li><strong>Degeneracy factors:</strong> when ω<sub>3</sub>=ω<sub>4</sub>, some terms appear twice (combinatorial factor 2).</li>
                <li><strong>Normalization:</strong> A<sub>j</sub> might represent E-field, power, or photon flux depending on the book; coefficients change accordingly.</li>
                <li><strong>SPM/XPM vs mixing:</strong> phase-modulation terms do not directly transfer energy but can affect phase matching and gain.</li>
              </ul>
            </div>
          </div>
        </section>

        <section id="analysis">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <p>
            <strong>Restated problem:</strong> We have collinear four-wave mixing in a χ(3) medium. In the degenerate case,
            ω<sub>4</sub>=ω<sub>3</sub> and ω<sub>1</sub>+ω<sub>2</sub>=2ω<sub>3</sub>. Derive the coupled-wave equations for the complex
            amplitudes A<sub>1</sub>, A<sub>2</sub>, A<sub>3</sub>, assuming the phase-matching condition is met.
          </p>

          <div class="grid2">
            <div class="card">
              <h3>Given</h3>
              <ul>
                <li>Third-order nonlinear medium (χ<sup>(3)</sup> process).</li>
                <li>Collinear propagation along z.</li>
                <li>Degenerate frequencies: ω<sub>4</sub>=ω<sub>3</sub>.</li>
                <li>Energy conservation: ω<sub>1</sub>+ω<sub>2</sub>=2ω<sub>3</sub>.</li>
                <li>Perfect phase matching: Δk=0.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Unknowns / must find</h3>
              <ul>
                <li>Coupled differential equations (in z) for complex envelopes A<sub>1</sub>(z), A<sub>2</sub>(z), A<sub>3</sub>(z).</li>
                <li>Correct dependence on conjugates and the degeneracy factor.</li>
                <li>(Optionally) include SPM/XPM terms and clarify when they can be absorbed into phases.</li>
              </ul>
            </div>
          </div>

          <div class="callout">
            <h3 style="margin:0 0 8px">Relevant principles (and why they apply)</h3>
            <ul>
              <li><strong>Maxwell wave equation with nonlinear polarization</strong> is the starting point because χ(3) enters through P<sub>NL</sub>.</li>
              <li><strong>Frequency-domain bookkeeping</strong> (keeping only resonant terms) is essential to extract the ω<sub>j</sub>-component that drives each wave.</li>
              <li><strong>SVEA</strong> converts the second-order wave equation into first-order coupled envelope equations.</li>
              <li>We do <em>not</em> need diffraction or boundary conditions because the question is local in z for plane waves.</li>
            </ul>
          </div>

          <div class="callout warn">
            <h3 style="margin:0 0 8px">Assumptions (explicit)</h3>
            <ul>
              <li>Scalar fields (single polarization) and isotropic effective χ<sup>(3)</sup>.</li>
              <li>Continuous-wave or narrowband so envelopes are slowly varying (SVEA).</li>
              <li>No linear loss or dispersion beyond using k<sub>j</sub> and n<sub>j</sub> at each frequency (unless folded into k<sub>j</sub>).</li>
              <li>Perfect phase matching: Δk = k<sub>1</sub> + k<sub>2</sub> − 2k<sub>3</sub> = 0.</li>
            </ul>
          </div>

          <h3>Possible approaches (compare)</h3>
          <ol>
            <li>
              <strong>Direct nonlinear polarization method (recommended):</strong>
              Write E as a sum of monochromatic components, compute P<sub>NL</sub> ∝ E³, keep only terms oscillating at each ω<sub>j</sub>, then insert into SVEA.
              <br/><span style="color:var(--faint)">Pros: transparent origin of conjugates and degeneracy factor; matches textbook derivations. Cons: algebraic bookkeeping.</span>
            </li>
            <li>
              <strong>Coupled-mode / Hamiltonian (photon picture):</strong>
              Use an interaction Hamiltonian for FWM and derive Heisenberg-like equations for envelopes.
              <br/><span style="color:var(--faint)">Pros: highlights energy/photon conservation; easy to discuss gain. Cons: requires extra formalism; still must map to classical amplitudes.</span>
            </li>
            <li>
              <strong>Use known general FWM equations and specialize to ω<sub>3</sub>=ω<sub>4</sub>:</strong>
              Start from standard nondegenerate FWM coupled equations and set A<sub>4</sub>=A<sub>3</sub>.
              <br/><span style="color:var(--faint)">Pros: fast. Cons: easy to miss the factor of 2 from degeneracy unless careful.</span>
            </li>
          </ol>

          <p>
            <strong>Choice:</strong> We use the <em>direct nonlinear polarization</em> route, because it cleanly shows (i) which terms survive,
            (ii) the required complex conjugates, and (iii) why degeneracy produces a factor 2 in the ω<sub>3</sub> equation.
          </p>
        </section>

        <section id="strategy">
          <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

          <ol>
            <li><strong>Write the field decomposition:</strong> express E(z,t) as a sum of three carrier waves (ω<sub>1</sub>, ω<sub>2</sub>, ω<sub>3</sub>) with complex envelopes A<sub>j</sub>(z).</li>
            <li><strong>State the nonlinear polarization model:</strong> P<sub>NL</sub>(t)=ε<sub>0</sub>χ<sup>(3)</sup>E³(t) (scalar, instantaneous).</li>
            <li><strong>Extract the ω<sub>1</sub>, ω<sub>2</sub>, ω<sub>3</sub> components:</strong> in E³, keep only terms ∝ e^{i(k<sub>j</sub>z−ω<sub>j</sub>t)} for each j (rotating-wave selection).</li>
            <li><strong>Identify the mixing terms:</strong> show that degeneracy implies a driving product A<sub>2</sub><sup>*</sup>A<sub>3</sub>² for ω<sub>1</sub>, A<sub>1</sub><sup>*</sup>A<sub>3</sub>² for ω<sub>2</sub>, and 2A<sub>1</sub>A<sub>2</sub>A<sub>3</sub><sup>*</sup> for ω<sub>3</sub>.</li>
            <li><strong>Insert into SVEA:</strong> convert wave equation to first-order envelope ODEs: dA<sub>j</sub>/dz = i(ω<sub>j</sub> / (2n<sub>j</sub>cε<sub>0</sub>)) P<sub>NL,j</sub> e^{-i(k<sub>j</sub>z−ω<sub>j</sub>t)} (after standard steps).</li>
            <li><strong>Apply phase matching:</strong> set e^{iΔkz}=1 since Δk=0.</li>
            <li><strong>(Optional) Add SPM/XPM:</strong> note the |A|²A terms and how they shift phases.</li>
            <li><strong>Sanity checks:</strong> conjugation structure, dimensional consistency of coupling coefficients, and limiting cases (no mixing if one pump is zero).</li>
          </ol>

          <div class="callout bad">
            <h3 style="margin:0 0 8px">Common mistakes (quick tips)</h3>
            <ul>
              <li>Dropping the complex conjugate on the “difference-frequency” participant (you need it for ω bookkeeping).</li>
              <li>Missing the <strong>factor 2</strong> in the ω<sub>3</sub> equation for degenerate FWM.</li>
              <li>Mixing amplitude conventions: if A is normalized to power, coefficients differ from E-field normalization.</li>
              <li>Confusing <em>phase matching</em> (Δk=0) with <em>energy conservation</em> (ω relations); both are required for strong buildup.</li>
            </ul>
          </div>
        </section>

        <section id="solution">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>Qualitative intuition before math</h3>
          <p>
            In χ(3) media, the nonlinear polarization behaves like a “source” whose oscillation at a given frequency can be created by beating
            other waves. For four-wave mixing, the key source term at ω<sub>j</sub> is a product of three fields whose frequencies add/subtract
            to ω<sub>j</sub>. If the generated field stays in phase with the source (Δk=0), the effect accumulates along z, leading to energy exchange
            (and, in some regimes, parametric gain).
          </p>

          <h3>Step 1 — Write the field with slowly varying envelopes</h3>
          <p>
            Use the standard carrier-envelope form (collinear plane waves, single polarization):
          </p>
          <div class="eq" id="eq-field">
<pre>E(z,t) = (1/2) Σ_{j=1}^{3} [ A_j(z) e^{ i(k_j z - ω_j t) } + A_j*(z) e^{ -i(k_j z - ω_j t) } ]</pre>
          </div>
          <div class="copyRow">
            <button class="btn" data-copy-target="#eq-field">Copy key equation</button>
            <span class="toast" id="toast1">Copied ✓</span>
          </div>

          <p>
            Here A<sub>j</sub>(z) varies slowly compared to the carrier e^{ik<sub>j</sub>z}, and k<sub>j</sub>≈n<sub>j</sub>ω<sub>j</sub>/c.
            The “fourth” wave is degenerate with the third: ω<sub>4</sub>=ω<sub>3</sub>, so we only need one envelope A<sub>3</sub>.
          </p>

          <h3>Step 2 — Nonlinear polarization model and frequency selection</h3>
          <p>
            For a scalar instantaneous χ(3) nonlinearity,
          </p>
          <div class="eq" id="eq-pnl">
<pre>P_NL(z,t) = ε0 χ^(3) [E(z,t)]^3</pre>
          </div>
          <div class="copyRow">
            <button class="btn" data-copy-target="#eq-pnl">Copy key equation</button>
            <span class="toast" id="toast2">Copied ✓</span>
          </div>

          <p>
            When we cube E, we get many oscillating terms. Under the rotating-wave / SVEA selection rule, only terms oscillating at
            e^{i(k<sub>j</sub>z−ω<sub>j</sub>t)} contribute efficiently to the evolution of A<sub>j</sub>.
          </p>

          <details>
            <summary>How to “read off” the mixing term quickly</summary>
            <p>
              Look for products of three exponentials whose time-dependence equals e^{-iω<sub>j</sub>t}. For example,
              A<sub>2</sub><sup>*</sup> e^{+iω<sub>2</sub>t} times A<sub>3</sub> e^{-iω<sub>3</sub>t} times A<sub>3</sub> e^{-iω<sub>3</sub>t}
              gives e^{-i(2ω<sub>3</sub>−ω<sub>2</sub>)t}. Using ω<sub>1</sub>=2ω<sub>3</sub>−ω<sub>2</sub> (from ω<sub>1</sub>+ω<sub>2</sub>=2ω<sub>3</sub>),
              this is exactly the ω<sub>1</sub> component. The corresponding z-phase factor becomes e^{i(k_3+k_3-k_2-k_1)z}=e^{-iΔkz}.
            </p>
          </details>

          <h3>Step 3 — Identify the phase mismatch for the degenerate process</h3>
          <p>
            In general nondegenerate FWM, the phase mismatch is
          </p>
          <div class="eq" id="eq-dk">
<pre>Δk ≡ k1 + k2 - k3 - k4</pre>
          </div>
          <p>
            With ω<sub>4</sub>=ω<sub>3</sub> (so k<sub>4</sub>=k<sub>3</sub> at the same frequency/polarization),
          </p>
          <div class="eq" id="eq-dk-deg">
<pre>Δk = k1 + k2 - 2k3</pre>
          </div>
          <div class="copyRow">
            <button class="btn" data-copy-target="#eq-dk-deg">Copy key equation</button>
            <span class="toast" id="toast3">Copied ✓</span>
          </div>

          <p>
            The problem states that the phase-matching condition is met, so we will set Δk=0 at the end (making the interaction coherent along z).
          </p>

          <h3>Step 4 — The resonant nonlinear polarization components</h3>
          <p>
            Expanding E³ and keeping only the components oscillating at ω<sub>1</sub>, ω<sub>2</sub>, and ω<sub>3</sub> yields two types of terms:
          </p>
          <ul>
            <li><strong>Phase modulation terms</strong> (SPM/XPM): proportional to |A|²A at the same frequency.</li>
            <li><strong>Mixing (energy-transfer) terms</strong>: products of three distinct envelopes that satisfy frequency matching.</li>
          </ul>

          <p>
            For an isotropic scalar χ(3), the resonant components can be written compactly (grouping numerical degeneracy factors into the coefficients).
            A common and convenient form is:
          </p>

          <div class="eq" id="eq-pnl-components">
<pre>At ω1:  P_NL,1 ∝  3ε0 χ^(3) [ (|A1|^2 + 2|A2|^2 + 2|A3|^2)A1  +  A2* A3^2 e^{-iΔk z} ]

At ω2:  P_NL,2 ∝  3ε0 χ^(3) [ (|A2|^2 + 2|A1|^2 + 2|A3|^2)A2  +  A1* A3^2 e^{-iΔk z} ]

At ω3:  P_NL,3 ∝  3ε0 χ^(3) [ (|A3|^2 + 2|A1|^2 + 2|A2|^2)A3  +  2 A1 A2 A3* e^{+iΔk z} ]</pre>
          </div>

          <p style="color:var(--muted)">
            Notes: (i) the factors “1” and “2” in front of |A|² come from tensor/permutation counting in isotropic Kerr media (SPM vs XPM),
            and (ii) the <strong>factor 2</strong> multiplying A<sub>1</sub>A<sub>2</sub>A<sub>3</sub><sup>*</sup> reflects the degeneracy ω<sub>3</sub>=ω<sub>4</sub>.
          </p>

          <details>
            <summary>Why does degeneracy give a factor 2 in the ω3 mixing term?</summary>
            <p>
              In nondegenerate FWM, the ω<sub>3</sub> evolution is driven by a product like A<sub>1</sub>A<sub>2</sub>A<sub>4</sub><sup>*</sup>.
              If ω<sub>4</sub> is distinct, that’s one term. In the degenerate case ω<sub>4</sub>=ω<sub>3</sub>, the role of “wave 4” is played by the same field as wave 3.
              When you expand E³ and collect terms at ω<sub>3</sub>, there are two indistinguishable permutations that contribute coherently, effectively doubling that source term.
            </p>
          </details>

          <h3>Step 5 — Convert the wave equation to coupled envelope equations (SVEA)</h3>
          <p>
            Under SVEA for a plane wave at ω<sub>j</sub>, the envelope equation can be written in the standard form
          </p>

          <div class="eq" id="eq-svea">
<pre>dA_j/dz = i (ω_j / (2 n_j c ε0))  P̂_NL,j</pre>
          </div>

          <p>
            where P̂<sub>NL,j</sub> is the complex amplitude of the nonlinear polarization at ω<sub>j</sub> (the coefficient of e^{i(k<sub>j</sub>z−ω<sub>j</sub>t)}).
            Substituting the components above gives coupled ODEs. It is convenient to define coupling strengths
          </p>

          <div class="eq" id="eq-gamma">
<pre>γ_j ≡ (3 ω_j χ^(3)) / (8 n_j c)     (scalar, plane-wave envelope convention used here)</pre>
          </div>

          <p>
            With this definition, the coupled-wave equations become (still allowing Δk explicitly for clarity):
          </p>

          <div class="eq" id="eq-coupled-general">
<pre>dA1/dz = i γ1 [ (|A1|^2 + 2|A2|^2 + 2|A3|^2)A1  +  A2* A3^2 e^{-iΔk z} ]

dA2/dz = i γ2 [ (|A2|^2 + 2|A1|^2 + 2|A3|^2)A2  +  A1* A3^2 e^{-iΔk z} ]

dA3/dz = i γ3 [ (|A3|^2 + 2|A1|^2 + 2|A2|^2)A3  +  2 A1 A2 A3* e^{+iΔk z} ]</pre>
          </div>

          <div class="copyRow">
            <button class="btn" data-copy-target="#eq-coupled-general">Copy key equations</button>
            <span class="toast" id="toast4">Copied ✓</span>
          </div>

          <div class="callout warn">
            <strong>About normalization:</strong> Different textbooks define A<sub>j</sub> differently (electric-field amplitude, power-normalized amplitude, etc.).
            If your A<sub>j</sub> is power-normalized, the <em>structure</em> of the equations (products and conjugates) is unchanged, but the numerical prefactor in γ<sub>j</sub> changes.
          </div>

          <h3>Step 6 — Apply perfect phase matching (Δk=0) and present the final result</h3>
          <p>
            The problem states the phase-matching condition is met, so set Δk=0 ⇒ e^{±iΔkz}=1. The degenerate FWM coupled-wave equations for
            A<sub>1</sub>, A<sub>2</sub>, A<sub>3</sub> are:
          </p>

          <div class="eq" id="eq-final">
<pre>Δk = k1 + k2 - 2k3 = 0

dA1/dz = i γ1 [ (|A1|^2 + 2|A2|^2 + 2|A3|^2)A1  +  A2* A3^2 ]

dA2/dz = i γ2 [ (|A2|^2 + 2|A1|^2 + 2|A3|^2)A2  +  A1* A3^2 ]

dA3/dz = i γ3 [ (|A3|^2 + 2|A1|^2 + 2|A2|^2)A3  +  2 A1 A2 A3* ]

with   γ_j = (3 ω_j χ^(3)) / (8 n_j c)   (for the envelope convention used above).</pre>
          </div>

          <div class="copyRow">
            <button class="btn" data-copy-target="#eq-final">Copy final answer (plain text)</button>
            <span class="toast" id="toast5">Copied ✓</span>
          </div>

          <div class="callout good">
            <strong>Interpretation in one sentence:</strong>
            The <em>mixing terms</em> (A<sub>2</sub><sup>*</sup>A<sub>3</sub><sup>2</sup>, A<sub>1</sub><sup>*</sup>A<sub>3</sub><sup>2</sup>, 2A<sub>1</sub>A<sub>2</sub>A<sub>3</sub><sup>*</sup>)
            exchange energy among the waves, while the |A|²A terms mainly add nonlinear phase shifts (SPM/XPM).
          </div>

          <h3>Sanity checks</h3>
          <div class="grid2">
            <div class="card">
              <h3 style="margin-top:0">1) Frequency bookkeeping (conjugates)</h3>
              <ul>
                <li>For ω<sub>1</sub>: the product A<sub>2</sub><sup>*</sup>A<sub>3</sub>² corresponds to (−ω<sub>2</sub> + ω<sub>3</sub> + ω<sub>3</sub>) = ω<sub>1</sub>.</li>
                <li>For ω<sub>2</sub>: A<sub>1</sub><sup>*</sup>A<sub>3</sub>² gives (−ω<sub>1</sub> + 2ω<sub>3</sub>) = ω<sub>2</sub>.</li>
                <li>For ω<sub>3</sub>: A<sub>1</sub>A<sub>2</sub>A<sub>3</sub><sup>*</sup> gives (ω<sub>1</sub> + ω<sub>2</sub> − ω<sub>3</sub>) = ω<sub>3</sub>.</li>
              </ul>
            </div>
            <div class="card">
              <h3 style="margin-top:0">2) Limiting cases (physics)</h3>
              <ul>
                <li>If A<sub>1</sub>=0 or A<sub>2</sub>=0, the ω<sub>3</sub> mixing source vanishes ⇒ no parametric energy exchange.</li>
                <li>If A<sub>3</sub>=0 initially, the pump equations’ mixing terms vanish (they need A<sub>3</sub>²), consistent with the idea that degenerate FWM requires a seed (or quantum noise, not in classical model) to start.</li>
                <li>SPM/XPM terms remain even without mixing, representing Kerr phase shifts.</li>
              </ul>
            </div>
          </div>

          <div class="card">
            <h3 style="margin-top:0">3) Units/dimensions (quick check)</h3>
            <p style="color:var(--muted)">
              With A defined as an electric-field envelope (V/m), χ<sup>(3)</sup> has units m²/V² in SI.
              Then γ has units 1/(m·(V/m)²) = m/V², so γ|A|² is 1/m, matching dA/dz ∼ (1/m)A. Different envelope normalizations shift γ accordingly.
            </p>
          </div>

          <a class="backTop" href="#top" aria-label="Back to top link">↑ Back to top</a>
        </section>

        <section id="deeper">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>Re-interpreting the final formula: what controls what?</h3>
          <ul>
            <li><strong>γ<sub>j</sub> ∝ ω<sub>j</sub>χ(3)/n<sub>j</sub>:</strong> stronger nonlinearity and higher frequency increase coupling; higher index reduces it (for this convention).</li>
            <li><strong>Mixing terms:</strong> set the rate of <em>energy transfer</em>. For example, larger |A<sub>3</sub>| boosts the pump-side source terms because they scale like A<sub>3</sub>².</li>
            <li><strong>SPM/XPM terms:</strong> modify phases through intensity-dependent propagation constants. These can change effective phase matching in more complete models (especially when Δk is not exactly zero).</li>
            <li><strong>Degenerate factor 2 (in dA<sub>3</sub>/dz):</strong> means the “feedback” from pumps into the ω<sub>3</sub> wave is stronger than in the nondegenerate case (all else equal).</li>
          </ul>

          <div class="callout">
            <h3 style="margin:0 0 8px">Parameter dependence (qualitative)</h3>
            <ul>
              <li>Increase χ(3) → faster evolution with z (stronger mixing and stronger nonlinear phase shifts).</li>
              <li>Increase pump amplitudes |A<sub>1</sub>|, |A<sub>2</sub>| → stronger drive of A<sub>3</sub> via 2A<sub>1</sub>A<sub>2</sub>A<sub>3</sub><sup>*</sup>.</li>
              <li>Increase |A<sub>3</sub>| → increases the back-action on pumps via A<sub>3</sub>² terms and increases SPM/XPM on itself.</li>
              <li>If Δk were nonzero, the mixing terms would acquire oscillatory factors e^{±iΔkz}, reducing net buildup over long z.</li>
            </ul>
          </div>

          <h3>Alternative derivation idea (brief but meaningful)</h3>
          <p>
            Start from the known <em>nondegenerate</em> FWM coupled equations for four distinct envelopes A<sub>1</sub>…A<sub>4</sub>:
            the mixing terms look like A<sub>2</sub><sup>*</sup>A<sub>3</sub>A<sub>4</sub>, A<sub>1</sub><sup>*</sup>A<sub>3</sub>A<sub>4</sub>, A<sub>4</sub><sup>*</sup>A<sub>1</sub>A<sub>2</sub>, A<sub>3</sub><sup>*</sup>A<sub>1</sub>A<sub>2</sub>.
            Then set ω<sub>4</sub>=ω<sub>3</sub> and enforce A<sub>4</sub>=A<sub>3</sub>. The ω<sub>3</sub> equation receives two identical contributions
            (from the “A<sub>3</sub>” and “A<sub>4</sub>” channels), producing the factor 2.
          </p>

          <h3>Concept check (self-test with answers)</h3>
          <ul>
            <li><strong>Q:</strong> Why do conjugates appear in the mixing terms? <strong>A:</strong> They enforce frequency (energy) bookkeeping, e.g., ω<sub>1</sub>=ω<sub>3</sub>+ω<sub>3</sub>−ω<sub>2</sub> requires the ω<sub>2</sub> factor to be complex-conjugated.</li>
            <li><strong>Q:</strong> What happens if Δk≠0? <strong>A:</strong> The mixing terms oscillate as e^{±iΔkz}, reducing coherent buildup and causing z-oscillatory energy exchange (finite coherence length).</li>
            <li><strong>Q:</strong> Do SPM/XPM terms transfer energy between waves? <strong>A:</strong> Not directly; they primarily shift phases (but those phase shifts can indirectly affect mixing efficiency through phase matching).</li>
            <li><strong>Q:</strong> In this classical model, can A<sub>3</sub> grow from exactly zero without noise? <strong>A:</strong> No; the mixing term in dA<sub>3</sub>/dz is ∝ A<sub>3</sub><sup>*</sup>, so an exactly zero seed stays zero. In reality, quantum noise can seed growth (parametric fluorescence).</li>
          </ul>

          <a class="backTop" href="#top" aria-label="Back to top link">↑ Back to top</a>
        </section>

        <section id="plot">
          <h2>PART 5 — Optional Plot Guide</h2>
          <div class="card">
            <p style="margin:0;color:var(--muted)">
              No plot is included because this problem is primarily <strong>symbolic</strong>: the main learning objective is the correct coupled-wave
              structure (products, conjugates, and degeneracy/phase-matching factors). A plot would require picking arbitrary “example values” and solving
              the ODEs, which would be a simulation-like step and is not necessary for deriving the equations.
            </p>
          </div>
        </section>

        <footer>
          <p style="margin:0">
            Built as a self-contained learning article (vanilla HTML/CSS/JS). Copy buttons export plain-text equations for notes and reports.
          </p>
        </footer>
      </article>
    </main>
  </div>

  <script>
    (function(){
      const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      function showToast(el){
        if(!el) return;
        el.classList.add('show');
        window.setTimeout(()=>el.classList.remove('show'), 900);
      }

      function getPlainTextFromEq(eqEl){
        const pre = eqEl ? eqEl.querySelector('pre') : null;
        return pre ? pre.textContent.trim() : '';
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.setAttribute('readonly','');
          ta.style.position='fixed';
          ta.style.opacity='0';
          ta.style.pointerEvents='none';
          document.body.appendChild(ta);
          ta.select();
          let ok = false;
          try{ ok = document.execCommand('copy'); }catch(_e){ ok = false; }
          document.body.removeChild(ta);
          return ok;
        }
      }

      document.querySelectorAll('[data-copy-target]').forEach((btn, idx) => {
        btn.addEventListener('click', async () => {
          const sel = btn.getAttribute('data-copy-target');
          const eq = document.querySelector(sel);
          const text = getPlainTextFromEq(eq);
          const ok = await copyText(text);
          const toast = document.getElementById('toast' + (idx+1));
          if(ok) showToast(toast);
          else alert('Copy failed in this browser. You can manually select the equation text.');
        });
      });

      document.querySelectorAll('[data-scroll]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const target = document.querySelector(btn.getAttribute('data-scroll'));
          if(!target) return;
          if(prefersReduced){
            target.scrollIntoView();
          }else{
            target.scrollIntoView({behavior:'smooth', block:'start'});
          }
        });
      });

      // Subtle micro-animation on section entry (non-essential; respects reduced motion)
      if(!prefersReduced){
        const sections = document.querySelectorAll('article section');
        const io = new IntersectionObserver((entries)=>{
          entries.forEach(en=>{
            if(en.isIntersecting){
              en.target.animate(
                [{opacity:0, transform:'translateY(6px)'},{opacity:1, transform:'translateY(0px)'}],
                {duration:260, easing:'ease-out', fill:'both'}
              );
              io.unobserve(en.target);
            }
          });
        }, {threshold:0.08});
        sections.forEach(s=>io.observe(s));
      }
    })();
  </script>
</body>
</html>
