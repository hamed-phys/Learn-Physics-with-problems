<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gain of a Parametric Amplifier (KDP, 4 cm): Gain Coefficient and Overall Gain</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#0f1624;
      --card:#121c2e;
      --text:#e8eefc;
      --muted:#a9b6d3;
      --line:rgba(255,255,255,.10);
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 18px 40px rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background:
        radial-gradient(1200px 700px at 12% 10%, rgba(125,211,252,.12), transparent 55%),
        radial-gradient(900px 600px at 80% 20%, rgba(167,139,250,.12), transparent 55%),
        radial-gradient(900px 700px at 50% 95%, rgba(52,211,153,.08), transparent 60%),
        var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding: clamp(18px, 2.6vw, 34px) 18px 14px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
      position:relative;
      overflow:hidden;
    }
    header::before{
      content:"";
      position:absolute;
      inset:-2px -2px auto -2px;
      height: 130px;
      background: linear-gradient(90deg, rgba(125,211,252,.20), rgba(167,139,250,.14), transparent 65%);
      filter: blur(18px);
      opacity:.55;
      pointer-events:none;
    }
    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 0 18px 40px;
    }
    .title{
      position:relative;
      display:grid;
      gap:10px;
      z-index:1;
    }
    .title h1{
      margin:0;
      font-size: clamp(22px, 3.2vw, 38px);
      letter-spacing:.2px;
    }
    .subtitle{
      color:var(--muted);
      font-size: clamp(13px, 1.7vw, 16px);
      max-width: 80ch;
    }

    .layout{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
      margin-top: 18px;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns:1fr}
    }

    /* Sticky TOC */
    nav.toc{
      position: sticky;
      top: 14px;
      align-self:start;
      background: rgba(18,28,46,.72);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      animation: fadeUp .5s ease both;
    }
    nav.toc header{
      padding: 14px 14px 10px;
      border:0;
      background: linear-gradient(180deg, rgba(255,255,255,.05), transparent);
    }
    nav.toc header h2{
      margin:0;
      font-size: 14px;
      color: var(--text);
      letter-spacing:.4px;
      text-transform:uppercase;
    }
    .toc .links{
      padding: 6px 10px 12px;
      display:grid;
      gap:6px;
    }
    .toc a{
      display:block;
      padding: 9px 10px;
      border-radius: 12px;
      color: var(--muted);
      border: 1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease, color .12s ease;
      font-size: 14px;
    }
    .toc a:hover{
      background: rgba(125,211,252,.08);
      border-color: rgba(125,211,252,.18);
      color: var(--text);
      transform: translateY(-1px);
      text-decoration:none;
    }

    main{
      display:grid;
      gap: 14px;
      animation: fadeUp .55s ease both;
    }

    section, article{
      background: rgba(18,28,46,.62);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    section > .pad, article > .pad{
      padding: 18px 18px 16px;
    }
    h2{
      margin: 0 0 10px;
      font-size: clamp(18px, 2.2vw, 24px);
      letter-spacing:.2px;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 16px;
      color: #dfe8ff;
    }
    p{margin: 10px 0}
    ul{margin: 8px 0 10px 20px}
    li{margin: 6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 820px){
      .grid2{grid-template-columns:1fr}
    }

    .callouts{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 10px;
    }
    @media (max-width: 820px){
      .callouts{grid-template-columns:1fr}
    }
    .box{
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      padding: 12px 12px 10px;
      position:relative;
      overflow:hidden;
    }
    .box::before{
      content:"";
      position:absolute;
      inset:0 auto 0 0;
      width: 4px;
      background: rgba(125,211,252,.55);
      opacity:.9;
    }
    .box.warn::before{background: rgba(251,191,36,.70)}
    .box.good::before{background: rgba(52,211,153,.70)}
    .box.bad::before{background: rgba(251,113,133,.70)}
    .box h4{
      margin:0 0 6px;
      font-size: 13px;
      letter-spacing:.35px;
      text-transform:uppercase;
      color: var(--muted);
    }
    .box p, .box ul{margin: 6px 0}
    .mono{
      font-family: var(--mono);
      font-size: 13px;
      color: #d7e5ff;
      white-space: pre-wrap;
      overflow-wrap:anywhere;
    }

    .eq{
      border: 1px dashed rgba(125,211,252,.25);
      background: rgba(11,15,23,.55);
      border-radius: 14px;
      padding: 12px 12px 10px;
      margin: 10px 0;
      position:relative;
    }
    .eq .row{
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    pre{
      margin:0;
      font-family: var(--mono);
      font-size: 13px;
      line-height:1.45;
      color:#eaf2ff;
    }
    .btn{
      appearance:none;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 12px;
      padding: 8px 10px;
      font-size: 13px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.22);
    }
    .btn:active{transform: translateY(0px) scale(.99)}
    .btn.small{padding:7px 9px; font-size:12.5px}
    .btn.goodish{border-color: rgba(52,211,153,.22); background: rgba(52,211,153,.08)}
    .btn.goodish:hover{background: rgba(52,211,153,.12); border-color: rgba(52,211,153,.28)}
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      font-size: 12.5px;
      margin-top: 4px;
    }
    .pill b{color: var(--text); font-weight:650}

    details{
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(11,15,23,.38);
      padding: 10px 12px;
      margin: 10px 0 0;
    }
    summary{
      cursor:pointer;
      font-weight: 650;
      color: #dfe8ff;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    summary::after{
      content:"▾";
      float:right;
      color: var(--muted);
      transition: transform .15s ease;
    }
    details[open] summary::after{transform: rotate(180deg)}
    .backTop{
      display:flex;
      justify-content:flex-end;
      padding: 0 18px 18px;
    }
    .backTop a{
      color: var(--muted);
      font-size: 13px;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      transition: background .12s ease, transform .12s ease, border-color .12s ease;
    }
    .backTop a:hover{
      background: rgba(167,139,250,.10);
      border-color: rgba(167,139,250,.22);
      transform: translateY(-1px);
      text-decoration:none;
    }

    footer{
      margin-top: 16px;
      padding: 18px 18px 26px;
      color: var(--muted);
      border-top: 1px solid var(--line);
      background: linear-gradient(180deg, transparent, rgba(255,255,255,.03));
      border-radius: var(--radius);
    }

    .kpi{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    @media (max-width: 820px){
      .kpi{grid-template-columns:1fr}
    }
    .kpi .tile{
      border: 1px solid var(--line);
      border-radius: 16px;
      background: rgba(11,15,23,.42);
      padding: 12px 12px 10px;
    }
    .tile .label{
      color: var(--muted);
      font-size: 12px;
      letter-spacing:.25px;
      text-transform:uppercase;
    }
    .tile .value{
      margin-top: 6px;
      font-size: 18px;
      font-weight: 750;
      letter-spacing:.2px;
      color: var(--text);
    }
    .tile .sub{
      margin-top: 2px;
      font-size: 12.5px;
      color: var(--muted);
    }

    .final{
      border: 1px solid rgba(52,211,153,.22);
      background: linear-gradient(180deg, rgba(52,211,153,.10), rgba(255,255,255,.02));
    }
    .final::before{background: rgba(52,211,153,.75)}

    .hr{
      height:1px;
      background: var(--line);
      margin: 12px 0;
    }

    @keyframes fadeUp{
      from{opacity:0; transform: translateY(8px)}
      to{opacity:1; transform: translateY(0)}
    }

    /* Print-friendly */
    @media print{
      :root{--bg:#fff; --panel:#fff; --card:#fff; --text:#000; --muted:#111; --line:#bbb; --shadow:none}
      body{background:#fff}
      nav.toc{display:none}
      header::before{display:none}
      section, article{break-inside: avoid; page-break-inside: avoid; background:#fff; box-shadow:none}
      .btn{display:none}
      details{border:1px solid #bbb; background:#fff}
      a{color:#000; text-decoration:underline}
      .eq{background:#fff}
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="wrap title">
      <h1>Gain of a Parametric Amplifier (KDP, 4 cm)</h1>
      <div class="subtitle">
        We compute the <b>small-signal gain coefficient</b> and the <b>overall (power) gain</b> for a collinear,
        undepleted-pump optical parametric amplifier using a KDP crystal.
      </div>
      <div class="pill" aria-label="Problem snapshot">
        <span>Given: <b>L = 4 cm</b>, <b>λ<sub>s</sub> = 550 nm</b>, <b>λ<sub>p</sub> = 335 nm</b>, <b>I<sub>p</sub> = 10<sup>6</sup> W/cm²</b>, <b>n ≈ 1.49</b>, <b>d = 8.3×10<sup>−24</sup> C/V²</b></span>
      </div>
    </div>
  </header>

  <div class="wrap layout">
    <nav class="toc" aria-label="Table of Contents">
      <header><h2>Table of Contents</h2></header>
      <div class="links">
        <a href="#quick">Quick Summary</a>
        <a href="#part0">PART 0 — Concept Primer</a>
        <a href="#part1">PART 1 — Problem Analysis</a>
        <a href="#part2">PART 2 — Strategy &amp; Tips</a>
        <a href="#part3">PART 3 — Full Solution</a>
        <a href="#part4">PART 4 — Deeper Understanding</a>
        <a href="#part5">PART 5 — Optional Plot Guide</a>
      </div>
    </nav>

    <main>
      <section id="quick">
        <div class="pad">
          <h2>Quick Summary</h2>
          <ul>
            <li><b>What this is about:</b> an <b>optical parametric amplifier (OPA)</b> transfers energy from a strong pump to a weaker signal via a second-order nonlinearity (χ(2)).</li>
            <li><b>Key idea:</b> with an undepleted pump and phase matching, the signal grows <b>exponentially</b> in field amplitude: <span class="mono">E_s(z) ~ cosh(g z)</span>.</li>
            <li><b>Frequency relation:</b> energy conservation requires <span class="mono">ω_p = ω_s + ω_i</span> (idler frequency <span class="mono">ω_i</span> is created automatically).</li>
            <li><b>Phase matching:</b> collinear waves with the same refractive index approximation give <span class="mono">Δk = k_p − k_s − k_i ≈ 0</span>, enabling strong gain.</li>
            <li><b>Governing coupled-wave model:</b> first-order ODEs for complex field envelopes; for Δk=0 they reduce to a simple second-order growth equation.</li>
            <li><b>Gain coefficient:</b> <span class="mono">g = (d_eff |E_p| / c) √(ω_s ω_i /(n_s n_i))</span> (units: 1/m).</li>
            <li><b>Overall gain (power):</b> for an unseeded idler input, <span class="mono">G = I_s(L)/I_s(0) = cosh²(gL)</span>.</li>
            <li><b>Numeric result here:</b> <span class="mono">g ≈ 12.95 m⁻¹</span>, so <span class="mono">gL ≈ 0.518</span> and <span class="mono">G ≈ 1.29</span> (about <span class="mono">1.12 dB</span>).</li>
            <li><b>Physical meaning:</b> this pump intensity produces a modest amplification over 4 cm; larger <span class="mono">I_p</span>, longer <span class="mono">L</span>, or larger <span class="mono">d_eff</span> increases gain.</li>
          </ul>

          <div class="kpi" role="group" aria-label="Key numeric outputs">
            <div class="tile">
              <div class="label">Idler wavelength</div>
              <div class="value"><span class="mono">λ_i ≈ 857 nm</span></div>
              <div class="sub">from ω_p = ω_s + ω_i</div>
            </div>
            <div class="tile">
              <div class="label">Gain coefficient</div>
              <div class="value"><span class="mono">g ≈ 12.95 m⁻¹</span></div>
              <div class="sub">small-signal, Δk≈0</div>
            </div>
            <div class="tile">
              <div class="label">Overall power gain</div>
              <div class="value"><span class="mono">G ≈ 1.29</span></div>
              <div class="sub">≈ 1.12 dB over 4 cm</div>
            </div>
          </div>
        </div>
        <div class="backTop"><a href="#top">Back to top ↑</a></div>
      </section>

      <article id="part0">
        <div class="pad">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <h3>0.1 What is a parametric amplifier?</h3>
          <p>
            An <b>optical parametric amplifier</b> (OPA) uses a nonlinear crystal with a <b>second-order polarization</b>
            to couple three waves:
            a strong <b>pump</b> (p), a weak <b>signal</b> (s), and a generated <b>idler</b> (i).
            Energy flows from the pump into the signal and idler while respecting:
          </p>

          <div class="eq" role="group" aria-label="Key equation: energy conservation">
            <div class="row">
              <pre>Energy (frequency) matching:  ω_p = ω_s + ω_i</pre>
              <button class="btn small" data-copy="Energy (frequency) matching:  ω_p = ω_s + ω_i">Copy</button>
            </div>
          </div>

          <h3>0.2 Core definitions and units</h3>
          <div class="grid2">
            <div class="box">
              <h4>Symbols (with SI units)</h4>
              <ul>
                <li><span class="mono">λ</span>: vacuum wavelength (m)</li>
                <li><span class="mono">ω = 2πc/λ</span>: angular frequency (rad/s)</li>
                <li><span class="mono">k = n ω / c</span>: wave number in medium (rad/m)</li>
                <li><span class="mono">I</span>: intensity (W/m²)</li>
                <li><span class="mono">E</span>: electric-field amplitude (V/m)</li>
                <li><span class="mono">L</span>: crystal length (m)</li>
                <li><span class="mono">d_eff</span>: effective χ(2) coefficient (m/V)</li>
                <li><span class="mono">Δk = k_p − k_s − k_i</span>: phase mismatch (rad/m)</li>
                <li><span class="mono">g</span>: gain coefficient (1/m)</li>
              </ul>
            </div>
            <div class="box">
              <h4>Physical meaning (intuition)</h4>
              <ul>
                <li><b>Phase matching</b> (Δk≈0) means the nonlinear polarization stays “in step” with the generated fields, so growth adds coherently along z.</li>
                <li><b>Undepleted pump</b> means pump amplitude stays (approximately) constant: the simplest high-signal-to-noise small-signal model.</li>
                <li><b>Gain coefficient g</b> sets the exponential scale: larger <span class="mono">g</span> or longer <span class="mono">L</span> gives much larger gain because of the hyperbolic functions.</li>
              </ul>
            </div>
          </div>

          <h3>0.3 The key laws/principles and when they apply</h3>
          <div class="callouts">
            <div class="box good">
              <h4>Model used here</h4>
              <ul>
                <li>Three-wave mixing in a χ(2) medium</li>
                <li>Continuous-wave (or quasi-CW) plane waves</li>
                <li>Collinear propagation</li>
                <li>Undepleted pump</li>
                <li>Neglect absorption and walk-off</li>
              </ul>
            </div>
            <div class="box warn">
              <h4>Validity conditions</h4>
              <ul>
                <li>Pump must be strong enough that signal/idler do not significantly deplete it over length L.</li>
                <li>Bandwidth effects (group-velocity mismatch) are ignored; for ultrashort pulses the gain is reduced.</li>
                <li>Phase matching is crucial; if Δk is large, gain drops dramatically.</li>
              </ul>
            </div>
          </div>

          <h3>0.4 Standard approximation: coupled-wave equations</h3>
          <p>
            For slowly varying complex field envelopes (plane waves), a common form is:
          </p>

          <div class="eq" role="group" aria-label="Coupled-wave equations">
            <div class="row">
              <pre>Undepleted pump, χ(2) OPA (one common form):
dE_s/dz = i (ω_s d_eff /(n_s c)) E_p E_i*  e^{iΔkz}
dE_i/dz = i (ω_i d_eff /(n_i c)) E_p E_s*  e^{iΔkz}</pre>
              <button class="btn small" data-copy="Undepleted pump, χ(2) OPA (one common form):
dE_s/dz = i (ω_s d_eff /(n_s c)) E_p E_i*  e^{iΔkz}
dE_i/dz = i (ω_i d_eff /(n_i c)) E_p E_s*  e^{iΔkz}">Copy</button>
            </div>
          </div>

          <p>
            If <span class="mono">Δk = 0</span> and the pump amplitude <span class="mono">E_p</span> is constant, differentiating once more gives:
          </p>
          <div class="eq" role="group" aria-label="Second-order growth equation">
            <div class="row">
              <pre>d²E_s/dz² = g² E_s,  where  g = (d_eff |E_p| / c) √(ω_s ω_i /(n_s n_i))</pre>
              <button class="btn small" data-copy="d²E_s/dz² = g² E_s,  where  g = (d_eff |E_p| / c) √(ω_s ω_i /(n_s n_i))">Copy</button>
            </div>
          </div>

          <h3>0.5 Mini intuition examples (no heavy algebra)</h3>
          <ul>
            <li><b>Double the pump intensity:</b> since <span class="mono">|E_p| ∝ √I_p</span>, the gain coefficient scales as <span class="mono">g ∝ √I_p</span>. So gain rises fast with pump power.</li>
            <li><b>Longer crystal:</b> gain depends on <span class="mono">gL</span>. Even modest <span class="mono">g</span> can produce large gain if <span class="mono">L</span> is large enough.</li>
            <li><b>Phase mismatch:</b> if <span class="mono">Δk</span> is not near zero, the growth becomes oscillatory or strongly reduced rather than exponential.</li>
          </ul>

          <h3>0.6 What to watch for (pitfalls)</h3>
          <div class="box bad">
            <h4>Common pitfalls</h4>
            <ul>
              <li><b>Mixing definitions of d:</b> some books use <span class="mono">d_eff</span> in <span class="mono">m/V</span>, others give a polarization coefficient in <span class="mono">C/V²</span>. You must convert consistently.</li>
              <li><b>Confusing wavelength matching with phase matching:</b> <span class="mono">ω_p = ω_s + ω_i</span> is always required, but <span class="mono">Δk≈0</span> depends on refractive indices and propagation directions.</li>
              <li><b>Power vs field gain:</b> field amplitude gain is <span class="mono">cosh(gL)</span>, power gain is <span class="mono">cosh²(gL)</span> (for unseeded idler).</li>
            </ul>
          </div>

          <details>
            <summary>Deeper note: why hyperbolic functions appear</summary>
            <p>
              The coupled equations link <span class="mono">E_s</span> to the complex conjugate of <span class="mono">E_i</span>.
              Under perfect phase matching and constant pump, the system behaves like a “pair creation” process in classical waves:
              solutions are linear combinations of <span class="mono">e^{+gz}</span> and <span class="mono">e^{-gz}</span>, which combine into
              <span class="mono">cosh(gz)</span> and <span class="mono">sinh(gz)</span> when applying physically relevant boundary conditions.
            </p>
          </details>
        </div>
        <div class="backTop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="part1">
        <div class="pad">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <h3>1.1 Restate the problem (in plain words)</h3>
          <p>
            A 4-cm KDP crystal (refractive index <span class="mono">n ≈ 1.49</span>) is used as a χ(2) parametric amplifier.
            A pump at <span class="mono">λ_p = 335 nm</span> with intensity <span class="mono">I_p = 10^6 W/cm²</span> amplifies a signal at
            <span class="mono">λ_s = 550 nm</span>. Assuming pump, signal, and idler are collinear, find:
            (1) the <b>gain coefficient</b> <span class="mono">g</span>, and (2) the <b>overall gain</b> after propagating through the crystal.
          </p>

          <div class="callouts">
            <div class="box">
              <h4>Given</h4>
              <ul>
                <li><span class="mono">L = 4 cm = 0.04 m</span></li>
                <li><span class="mono">n ≈ 1.49</span> (use same n for all three waves, per problem simplification)</li>
                <li><span class="mono">d = 8.3 × 10⁻24 C/V²</span> (nonlinear coefficient as stated)</li>
                <li><span class="mono">λ_s = 550 nm</span></li>
                <li><span class="mono">λ_p = 335 nm</span></li>
                <li><span class="mono">I_p = 10⁶ W/cm² = 10¹⁰ W/m²</span></li>
              </ul>
            </div>
            <div class="box good">
              <h4>Unknowns to find</h4>
              <ul>
                <li><span class="mono">λ_i</span> (idler wavelength, implied by energy conservation)</li>
                <li><span class="mono">g</span> (gain coefficient, 1/m)</li>
                <li><span class="mono">G</span> (overall gain; we will report power gain <span class="mono">I_s(L)/I_s(0)</span>)</li>
              </ul>
            </div>
          </div>

          <h3>1.2 Which principles apply (and which don’t)?</h3>
          <ul>
            <li><b>Applies:</b> three-wave mixing in χ(2), undepleted pump approximation, phase matching (Δk≈0) enabled by collinear geometry and equal-n assumption.</li>
            <li><b>Not used here:</b> full pump depletion, dispersion engineering, birefringent walk-off, group-velocity mismatch, cavity enhancement (none stated).</li>
          </ul>

          <div class="box warn">
            <h4>Assumptions (made explicit)</h4>
            <ul>
              <li><b>Undepleted pump:</b> pump amplitude constant along z.</li>
              <li><b>Plane waves / uniform cross section:</b> intensity relates to field as <span class="mono">I = (1/2) n ε0 c |E|²</span>.</li>
              <li><b>Collinear + same n:</b> take <span class="mono">n_s ≈ n_i ≈ n_p ≈ 1.49</span>, which makes <span class="mono">Δk ≈ 0</span> automatically when <span class="mono">ω_p = ω_s + ω_i</span>.</li>
              <li><b>Unseeded idler at input:</b> <span class="mono">E_i(0)=0</span>, the common “amplifier gain” convention unless otherwise stated.</li>
            </ul>
          </div>

          <h3>1.3 Candidate solution approaches (compare and choose)</h3>
          <div class="grid2">
            <div class="box">
              <h4>Approach A: Full coupled-wave solution (best)</h4>
              <p>
                Use standard OPA coupled equations, convert pump intensity to pump field amplitude, compute <span class="mono">g</span>,
                then compute <span class="mono">G = cosh²(gL)</span>.
              </p>
              <ul>
                <li><b>Pros:</b> physically transparent; directly gives gain coefficient and overall gain.</li>
                <li><b>Cons:</b> must be careful with coefficient conventions and unit conversions.</li>
              </ul>
            </div>
            <div class="box">
              <h4>Approach B: Use a memorized “g vs intensity” formula</h4>
              <p>
                Some texts provide a compact expression <span class="mono">g ∝ d_eff √I_p</span>.
              </p>
              <ul>
                <li><b>Pros:</b> fastest if you trust the exact convention.</li>
                <li><b>Cons:</b> easy to mismatch factors of 2, n, or ε0.</li>
              </ul>
            </div>
          </div>

          <div class="box good">
            <h4>Chosen approach</h4>
            <p>
              We use <b>Approach A</b> to stay consistent: start from the coupled-wave model,
              then translate the given <span class="mono">d</span> and <span class="mono">I_p</span> carefully into <span class="mono">g</span> and <span class="mono">G</span>.
            </p>
          </div>
        </div>
        <div class="backTop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="part2">
        <div class="pad">
          <h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

          <ol>
            <li><b>Find idler frequency:</b> use <span class="mono">ω_i = ω_p − ω_s</span> (energy conservation). Physically: determines the third wave that must be created.</li>
            <li><b>Convert wavelengths to angular frequencies:</b> <span class="mono">ω = 2πc/λ</span>. Physically: OPA is naturally written in frequency space.</li>
            <li><b>Argue phase matching:</b> compute/justify <span class="mono">Δk ≈ 0</span> under “collinear + same n” assumption. Physically: enables exponential growth.</li>
            <li><b>Convert pump intensity to pump field amplitude:</b> <span class="mono">I_p = (1/2) n ε0 c |E_p|²</span>. Physically: χ(2) coupling is driven by the pump field.</li>
            <li><b>Convert the given coefficient:</b> interpret the stated <span class="mono">d</span> (C/V²) as a polarization coefficient and convert to <span class="mono">d_eff</span> (m/V) using <span class="mono">d_eff = d/ε0</span>. Physically: different but equivalent χ(2) conventions.</li>
            <li><b>Compute the gain coefficient:</b> <span class="mono">g = (d_eff |E_p| / c) √(ω_s ω_i /(n_s n_i))</span>. Physically: sets growth per meter.</li>
            <li><b>Compute overall gain over length L:</b> with unseeded idler, <span class="mono">G = cosh²(gL)</span>. Physically: power amplification of the signal.</li>
            <li><b>Sanity checks:</b> units (g in 1/m), limiting cases (g→0 gives G→1), scaling (G increases with √I_p and L).</li>
          </ol>

          <div class="box bad">
            <h4>Common mistakes (quick tips)</h4>
            <ul>
              <li><b>Intensity units:</b> <span class="mono">10⁶ W/cm² = 10¹⁰ W/m²</span> (multiply by 10⁴).</li>
              <li><b>Power vs field:</b> if you compute amplitude gain <span class="mono">cosh(gL)</span>, remember power gain is its square.</li>
              <li><b>Coefficient convention:</b> using <span class="mono">d</span> (C/V²) directly in a formula meant for <span class="mono">d_eff</span> (m/V) will be wrong by ~<span class="mono">1/ε0</span>.</li>
            </ul>
          </div>
        </div>
        <div class="backTop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="part3">
        <div class="pad">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>3.1 Qualitative expectation (before calculating)</h3>
          <p>
            The gain should increase with:
            (i) stronger pump (<span class="mono">I_p</span>), (ii) larger nonlinearity (<span class="mono">d_eff</span>), and (iii) longer crystal (<span class="mono">L</span>).
            Here <span class="mono">L = 4 cm</span> is not very long, so we expect a <b>modest</b> gain unless the pump is extremely strong.
          </p>

          <div class="hr"></div>

          <h3>3.2 Step 1 — Find the idler wavelength</h3>
          <p>
            Energy conservation for parametric amplification:
          </p>
          <div class="eq" role="group" aria-label="Energy matching again">
            <div class="row">
              <pre>ω_p = ω_s + ω_i  ⇒  ω_i = ω_p − ω_s</pre>
              <button class="btn small" data-copy="ω_p = ω_s + ω_i  ⇒  ω_i = ω_p − ω_s">Copy</button>
            </div>
          </div>
          <p>
            Convert each given wavelength to frequency using <span class="mono">ω = 2πc/λ</span>.
            Since <span class="mono">c</span> is the speed of light in vacuum and frequency is conserved across media, we can use the vacuum wavelengths.
          </p>

          <div class="eq" role="group" aria-label="Compute idler wavelength relation">
            <div class="row">
              <pre>ω = 2πc/λ  ⇒  ω_i = 2πc(1/λ_p − 1/λ_s)

Equivalently in wavelengths:
1/λ_i = 1/λ_p − 1/λ_s</pre>
              <button class="btn small" data-copy="ω = 2πc/λ  ⇒  ω_i = 2πc(1/λ_p − 1/λ_s)

Equivalently in wavelengths:
1/λ_i = 1/λ_p − 1/λ_s">Copy</button>
            </div>
          </div>

          <p>
            Now insert numbers (<span class="mono">λ_p = 335 nm</span>, <span class="mono">λ_s = 550 nm</span>):
          </p>
          <div class="eq">
            <pre>1/λ_i = 1/(335 nm) − 1/(550 nm)
      ≈ 2.985×10^6 m⁻1 − 1.818×10^6 m⁻1
      ≈ 1.167×10^6 m⁻1

⇒ λ_i ≈ 1 / (1.167×10^6 m⁻1) ≈ 8.57×10^-7 m = 857 nm</pre>
          </div>
          <p class="mono"><b>Result:</b> λ<sub>i</sub> ≈ 857 nm.</p>

          <div class="hr"></div>

          <h3>3.3 Step 2 — Phase matching under the problem’s assumptions</h3>
          <p>
            Phase mismatch is:
          </p>
          <div class="eq" role="group" aria-label="Phase mismatch definition">
            <div class="row">
              <pre>Δk = k_p − k_s − k_i,  where  k_j = n_j ω_j / c</pre>
              <button class="btn small" data-copy="Δk = k_p − k_s − k_i,  where  k_j = n_j ω_j / c">Copy</button>
            </div>
          </div>
          <p>
            The problem gives a single refractive index <span class="mono">n ≈ 1.49</span> and states collinear waves.
            Using <span class="mono">n_p ≈ n_s ≈ n_i ≈ n</span>, we get:
          </p>
          <div class="eq">
            <pre>Δk ≈ (n/c)(ω_p − ω_s − ω_i) = (n/c)(0) = 0</pre>
          </div>
          <p>
            So, within the intended approximation of the exercise, we treat the interaction as <b>perfectly phase matched</b>.
          </p>

          <div class="hr"></div>

          <h3>3.4 Step 3 — Convert pump intensity to pump field amplitude</h3>
          <p>
            For a monochromatic plane wave in a dielectric (time-averaged intensity):
          </p>
          <div class="eq" role="group" aria-label="Intensity to field relation">
            <div class="row">
              <pre>I = (1/2) n ε0 c |E|²  ⇒  |E| = √( 2I / (n ε0 c) )</pre>
              <button class="btn small" data-copy="I = (1/2) n ε0 c |E|²  ⇒  |E| = √( 2I / (n ε0 c) )">Copy</button>
            </div>
          </div>
          <p>
            First convert intensity units:
          </p>
          <div class="eq">
            <pre>I_p = 10^6 W/cm² = 10^6 × 10^4 W/m² = 10^10 W/m²</pre>
          </div>
          <p>
            Now compute the pump field amplitude using <span class="mono">n = 1.49</span>, <span class="mono">ε0 = 8.854×10^-12 F/m</span>, <span class="mono">c = 2.998×10^8 m/s</span>:
          </p>
          <div class="eq">
            <pre>|E_p| = √( 2(10^10) / (1.49 × 8.854×10^-12 × 2.998×10^8) )
     ≈ 2.25×10^6 V/m</pre>
          </div>
          <p class="mono"><b>Result:</b> |E<sub>p</sub>| ≈ 2.25×10<sup>6</sup> V/m.</p>

          <div class="hr"></div>

          <h3>3.5 Step 4 — Convert the given nonlinear coefficient into d<sub>eff</sub> (m/V)</h3>
          <p>
            Many OPA formulas are written using <span class="mono">d_eff</span> in units of <span class="mono">m/V</span>,
            defined through the nonlinear polarization in the common form:
          </p>
          <div class="eq" role="group" aria-label="Nonlinear polarization convention">
            <div class="row">
              <pre>P^(2) = ε0 χ^(2) E^2  and often  d_eff ≡ χ^(2)/2  (so P^(2) = 2ε0 d_eff E^2)</pre>
              <button class="btn small" data-copy="P^(2) = ε0 χ^(2) E^2  and often  d_eff ≡ χ^(2)/2  (so P^(2) = 2ε0 d_eff E^2)">Copy</button>
            </div>
          </div>
          <p>
            This problem provides <span class="mono">d = 8.3×10^-24 C/V²</span>, which has the units of polarization per field-squared:
            <span class="mono">P = d E²</span>.
            To connect to a <span class="mono">d_eff (m/V)</span> convention used in the wave coupling equations, a consistent conversion is:
          </p>
          <div class="eq" role="group" aria-label="Conversion to deff">
            <div class="row">
              <pre>d_eff = d / ε0</pre>
              <button class="btn small" data-copy="d_eff = d / ε0">Copy</button>
            </div>
          </div>
          <p>
            Numerically:
          </p>
          <div class="eq">
            <pre>d_eff = (8.3×10^-24) / (8.854×10^-12) ≈ 9.38×10^-13 m/V</pre>
          </div>
          <p class="mono"><b>Result:</b> d<sub>eff</sub> ≈ 9.38×10<sup>−13</sup> m/V.</p>

          <div class="hr"></div>

          <h3>3.6 Step 5 — Compute the gain coefficient g</h3>
          <p>
            Under undepleted pump and perfect phase matching (Δk=0), the growth constant is:
          </p>
          <div class="eq" role="group" aria-label="Gain coefficient expression">
            <div class="row">
              <pre>g = (d_eff |E_p| / c) √(ω_s ω_i /(n_s n_i))</pre>
              <button class="btn small" data-copy="g = (d_eff |E_p| / c) √(ω_s ω_i /(n_s n_i))">Copy</button>
            </div>
          </div>
          <p>
            Compute angular frequencies:
          </p>
          <div class="eq">
            <pre>ω_s = 2πc/λ_s ≈ 3.425×10^15 rad/s
ω_p = 2πc/λ_p ≈ 5.622×10^15 rad/s
ω_i = ω_p − ω_s ≈ 2.197×10^15 rad/s</pre>
          </div>
          <p>
            Insert values (<span class="mono">n_s≈n_i≈1.49</span>):
          </p>
          <div class="eq">
            <pre>g ≈ ( (9.38×10^-13)(2.25×10^6) / (2.998×10^8) ) × √( (3.425×10^15)(2.197×10^15) / (1.49^2) )
  ≈ 12.95 m^-1</pre>
          </div>

          <div class="box good">
            <h4>Gain coefficient (answer 1)</h4>
            <div class="eq" style="margin:8px 0 0;">
              <div class="row">
                <pre>g ≈ 12.95 m⁻¹</pre>
                <button class="btn small goodish" data-copy="g ≈ 12.95 m^-1">Copy</button>
              </div>
            </div>
          </div>

          <h3>3.7 Step 6 — Overall gain over L = 4 cm</h3>
          <p>
            For unseeded idler at input, the signal power gain is:
          </p>
          <div class="eq" role="group" aria-label="Power gain formula">
            <div class="row">
              <pre>G ≡ I_s(L)/I_s(0) = cosh²(gL)</pre>
              <button class="btn small" data-copy="G ≡ I_s(L)/I_s(0) = cosh^2(gL)">Copy</button>
            </div>
          </div>

          <div class="eq">
            <pre>gL = (12.95)(0.04) ≈ 0.518
G = cosh²(0.518) ≈ 1.29   (≈ 1.12 dB)</pre>
          </div>

          <div class="box final">
            <h4>Final answer (copy-friendly)</h4>
            <div class="eq" style="margin:8px 0 0;">
              <div class="row">
                <pre>Idler wavelength: λ_i ≈ 857 nm

Gain coefficient: g ≈ 12.95 m⁻¹

Overall signal power gain (L = 4 cm):
G = I_s(L)/I_s(0) = cosh²(gL) ≈ cosh²(0.518) ≈ 1.29  (≈ 1.12 dB)

(Reference) Field-amplitude gain: cosh(gL) ≈ 1.14</pre>
                <button class="btn small goodish" data-copy="Idler wavelength: λ_i ≈ 857 nm

Gain coefficient: g ≈ 12.95 m^-1

Overall signal power gain (L = 4 cm):
G = I_s(L)/I_s(0) = cosh^2(gL) ≈ cosh^2(0.518) ≈ 1.29  (≈ 1.12 dB)

(Reference) Field-amplitude gain: cosh(gL) ≈ 1.14">Copy</button>
              </div>
            </div>
          </div>

          <h3>3.8 Sanity checks</h3>
          <div class="callouts">
            <div class="box">
              <h4>Units</h4>
              <p>
                <span class="mono">d_eff E_p</span> is dimensionless, <span class="mono">√(ω_s ω_i)</span> is 1/s, divide by <span class="mono">c</span> (m/s) → 1/m. ✅
              </p>
            </div>
            <div class="box">
              <h4>Limiting behavior</h4>
              <p>
                Small gain: <span class="mono">G ≈ 1 + (gL)²</span> → as <span class="mono">I_p→0</span>, <span class="mono">g→0</span>, so <span class="mono">G→1</span>. ✅
              </p>
            </div>
          </div>
        </div>
        <div class="backTop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="part4">
        <div class="pad">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>4.1 What each factor controls</h3>
          <ul>
            <li><b>d_eff:</b> sets the intrinsic strength of three-wave mixing in the crystal.</li>
            <li><b>|E_p| ∝ √I_p:</b> pump intensity enters as a square-root in g, but gain can be very sensitive because <span class="mono">G = cosh²(gL)</span>.</li>
            <li><b>ω_s, ω_i:</b> higher optical frequencies generally increase coupling in this envelope model.</li>
            <li><b>n_s, n_i:</b> larger refractive indices reduce g through the denominator.</li>
            <li><b>L:</b> gain accumulates over distance through <span class="mono">gL</span>.</li>
          </ul>

          <div class="box">
            <h4>Scaling summary</h4>
            <div class="eq" style="margin:8px 0 0;">
              <pre>g ∝ d_eff √I_p
G = cosh²(gL)  ≈ 1 + (gL)²  (small gL)  and  ≈ (1/4) e^{2gL}  (large gL)</pre>
            </div>
          </div>

          <h3>4.2 Alternative derivation idea (brief)</h3>
          <p>
            Start from the wave equation with a nonlinear source polarization at ω<sub>s</sub>.
            Under the slowly varying envelope approximation, the source term generates the coupled-wave equations.
            Perfect phase matching keeps the source term in phase, turning what would be oscillatory exchange into steady growth.
          </p>

          <h3>4.3 Concept check Q&amp;A</h3>
          <ul>
            <li><b>Q:</b> If <span class="mono">I_p</span> increases by 9×, how does <span class="mono">g</span> change? <b>A:</b> <span class="mono">g</span> increases by 3×.</li>
            <li><b>Q:</b> Why can <span class="mono">G</span> become huge even if <span class="mono">g</span> is only moderate? <b>A:</b> Because <span class="mono">G</span> depends on <span class="mono">cosh²(gL)</span>, which becomes exponential for large <span class="mono">gL</span>.</li>
            <li><b>Q:</b> What breaks the undepleted pump approximation? <b>A:</b> When significant energy is transferred so the pump intensity drops along z.</li>
            <li><b>Q:</b> What would Δk ≠ 0 do? <b>A:</b> It reduces effective gain and can lead to oscillatory behavior instead of monotonic amplification.</li>
          </ul>

          <details>
            <summary>Optional nuance: phase-sensitive vs phase-insensitive amplification</summary>
            <p>
              In a fully phase-resolved treatment, an OPA can be phase-sensitive: the relative phase between signal and idler matters.
              The commonly quoted intensity gain <span class="mono">cosh²(gL)</span> corresponds to the usual case where the idler is not seeded at the input.
            </p>
          </details>
        </div>
        <div class="backTop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="part5">
        <div class="pad">
          <h2>PART 5 — Optional Plot Guide</h2>
          <p>
            No plot is included because the problem is fully determined numerically and the requested outputs (<span class="mono">g</span> and <span class="mono">G</span>)
            follow directly from closed-form expressions. A plot would only be for trend-visualization, not needed for this specific computation.
          </p>
        </div>
        <div class="backTop"><a href="#top">Back to top ↑</a></div>
      </article>

      <footer>
        <div class="pad" style="padding:0">
          <p style="margin:0 0 8px">
            <b>Summary of results:</b>
            <span class="mono">λ_i ≈ 857 nm</span>,
            <span class="mono">g ≈ 12.95 m⁻¹</span>,
            <span class="mono">G ≈ 1.29</span> (≈ <span class="mono">1.12 dB</span>) for <span class="mono">L = 4 cm</span>.
          </p>
          <p style="margin:0;color:var(--muted)">
            Assumptions: undepleted pump, collinear propagation, and <span class="mono">n_p≈n_s≈n_i≈1.49</span> (so Δk≈0).
          </p>
        </div>
      </footer>
    </main>
  </div>

  <script>
    (function(){
      const toast = (() => {
        const el = document.createElement('div');
        el.style.position = 'fixed';
        el.style.left = '50%';
        el.style.bottom = '18px';
        el.style.transform = 'translateX(-50%)';
        el.style.padding = '10px 12px';
        el.style.borderRadius = '14px';
        el.style.border = '1px solid rgba(255,255,255,.14)';
        el.style.background = 'rgba(18,28,46,.85)';
        el.style.backdropFilter = 'blur(10px)';
        el.style.color = 'rgba(232,238,252,.95)';
        el.style.font = '600 13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        el.style.boxShadow = '0 14px 30px rgba(0,0,0,.35)';
        el.style.opacity = '0';
        el.style.pointerEvents = 'none';
        el.style.transition = 'opacity .16s ease, transform .16s ease';
        el.style.zIndex = '9999';
        document.body.appendChild(el);
        let t = null;
        return (msg) => {
          el.textContent = msg;
          el.style.opacity = '1';
          el.style.transform = 'translateX(-50%) translateY(-2px)';
          clearTimeout(t);
          t = setTimeout(() => {
            el.style.opacity = '0';
            el.style.transform = 'translateX(-50%) translateY(0px)';
          }, 1100);
        };
      })();

      async function copyText(txt){
        try{
          await navigator.clipboard.writeText(txt);
          toast('Copied');
        }catch(e){
          const ta = document.createElement('textarea');
          ta.value = txt;
          ta.setAttribute('readonly','');
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand('copy'); toast('Copied'); }
          catch(err){ toast('Copy failed'); }
          document.body.removeChild(ta);
        }
      }

      document.addEventListener('click', (ev) => {
        const btn = ev.target.closest('button[data-copy]');
        if(!btn) return;
        const txt = btn.getAttribute('data-copy') || '';
        copyText(txt);
      });
    })();
  </script>
</body>
</html>
