<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SHG in a Third-Order Nonlinear Medium via a Static Electric Field (EFISH)</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#101a33;
      --card2:#0f1730;
      --text:#eaf0ff;
      --muted:#b7c3e6;
      --muted2:#93a2cc;
      --line:rgba(255,255,255,.12);
      --line2:rgba(255,255,255,.08);
      --accent:#7dd3fc;
      --accent2:#a7f3d0;
      --warn:#fbbf24;
      --good:#34d399;
      --bad:#fb7185;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --shadow2: 0 10px 26px rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 12% -10%, rgba(125,211,252,.18), transparent 60%),
        radial-gradient(1100px 650px at 95% 10%, rgba(167,243,208,.12), transparent 55%),
        radial-gradient(900px 600px at 50% 110%, rgba(251,191,36,.08), transparent 60%),
        linear-gradient(180deg, #070a14, var(--bg));
      line-height:1.55;
    }

    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{
      max-width:1180px;
      margin:0 auto;
      padding:28px 18px 54px;
    }

    header{
      padding:18px 18px 8px;
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0));
      border:1px solid var(--line2);
      border-radius:calc(var(--radius) + 6px);
      box-shadow:var(--shadow2);
      backdrop-filter: blur(10px);
    }

    .titleRow{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }

    h1{
      margin:0;
      font-size: clamp(1.35rem, 1.2rem + 1.4vw, 2.25rem);
      letter-spacing:-.02em;
    }
    .subtitle{
      margin:6px 0 0;
      color:var(--muted);
      max-width:72ch;
      font-size:1.02rem;
    }
    .badgeRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(16,26,51,.55);
      color:var(--muted);
      font-size:.9rem;
      white-space:nowrap;
    }
    .dot{
      width:8px;height:8px;border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 0 3px rgba(125,211,252,.18);
    }

    main{
      margin-top:18px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:16px;
      align-items:start;
    }

    @media (max-width: 980px){
      main{grid-template-columns:1fr}
    }

    nav{
      position:sticky;
      top:14px;
      align-self:start;
      border-radius:var(--radius);
      background:linear-gradient(180deg, rgba(16,26,51,.72), rgba(15,23,48,.62));
      border:1px solid var(--line2);
      box-shadow:var(--shadow2);
      padding:14px;
      overflow:hidden;
    }
    nav .tocTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    nav h2{
      margin:0;
      font-size:1rem;
      letter-spacing:.02em;
      color:var(--text);
    }
    .miniHint{
      font-size:.82rem;
      color:var(--muted2);
    }
    .toc{
      margin:10px 0 0;
      padding:0;
      list-style:none;
      display:grid;
      gap:6px;
    }
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid transparent;
      color:var(--muted);
      background:rgba(255,255,255,0);
      transition:transform .15s ease, background .15s ease, border-color .15s ease;
    }
    .toc a:hover{
      background:rgba(125,211,252,.08);
      border-color:rgba(125,211,252,.18);
      transform:translateY(-1px);
      text-decoration:none;
      color:var(--text);
    }
    .toc a.active{
      background:rgba(125,211,252,.12);
      border-color:rgba(125,211,252,.25);
      color:var(--text);
    }

    article{
      border-radius:var(--radius);
      background:linear-gradient(180deg, rgba(16,26,51,.65), rgba(15,23,48,.55));
      border:1px solid var(--line2);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    .content{
      padding:18px 18px 10px;
    }

    section{
      padding:18px;
      border-top:1px solid var(--line2);
    }
    section:first-of-type{border-top:0}
    section h2{
      margin:0 0 10px;
      font-size:1.25rem;
      letter-spacing:-.01em;
    }
    section h3{
      margin:14px 0 8px;
      font-size:1.05rem;
      color:var(--text);
    }
    p{margin:8px 0; color:var(--muted)}
    ul,ol{margin:8px 0 8px 20px; color:var(--muted)}
    li{margin:6px 0}
    .grid2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    @media (max-width: 760px){
      .grid2{grid-template-columns:1fr}
    }

    .card{
      border:1px solid var(--line2);
      border-radius:var(--radius2);
      background:rgba(10,16,34,.55);
      padding:12px 12px;
      box-shadow: 0 10px 22px rgba(0,0,0,.28);
    }
    .callout{
      border-left:4px solid rgba(125,211,252,.65);
      background:linear-gradient(90deg, rgba(125,211,252,.10), rgba(255,255,255,0));
    }
    .callout.warn{border-left-color:rgba(251,191,36,.75); background:linear-gradient(90deg, rgba(251,191,36,.10), rgba(255,255,255,0));}
    .callout.good{border-left-color:rgba(52,211,153,.75); background:linear-gradient(90deg, rgba(52,211,153,.10), rgba(255,255,255,0));}
    .callout.bad{border-left-color:rgba(251,113,133,.75); background:linear-gradient(90deg, rgba(251,113,133,.10), rgba(255,255,255,0));}

    .kicker{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    .kicker strong{color:var(--text)}
    .small{
      font-size:.92rem;
      color:var(--muted2);
    }

    .eq{
      margin:10px 0;
      border:1px dashed rgba(125,211,252,.35);
      border-radius:14px;
      background:rgba(125,211,252,.06);
      overflow:hidden;
    }
    .eqTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 10px 0;
    }
    .eqLabel{
      font-size:.9rem;
      color:var(--muted2);
      letter-spacing:.02em;
    }
    .eq pre{
      margin:0;
      padding:10px;
      font-family:var(--mono);
      font-size:.95rem;
      color:var(--text);
      white-space:pre-wrap;
      word-break:break-word;
      line-height:1.45;
    }
    .btn{
      border:1px solid var(--line);
      background:rgba(16,26,51,.7);
      color:var(--text);
      padding:7px 10px;
      border-radius:12px;
      font-size:.86rem;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      background:rgba(125,211,252,.10);
      border-color:rgba(125,211,252,.25);
    }
    .btn:active{transform:translateY(0)}
    .btnRow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
      padding:0 10px 10px;
    }
    .toast{
      position:fixed;
      right:16px;
      bottom:16px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--line2);
      background:rgba(10,16,34,.82);
      box-shadow:var(--shadow2);
      color:var(--text);
      font-size:.92rem;
      opacity:0;
      transform: translateY(10px);
      transition: opacity .18s ease, transform .18s ease;
      pointer-events:none;
      z-index:9999;
      max-width:min(360px, calc(100vw - 32px));
    }
    .toast.show{
      opacity:1;
      transform: translateY(0);
    }

    details{
      border:1px solid var(--line2);
      border-radius:var(--radius2);
      background:rgba(10,16,34,.46);
      padding:10px 10px;
      margin:10px 0;
    }
    summary{
      cursor:pointer;
      color:var(--text);
      font-weight:650;
      letter-spacing:.01em;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    summary:after{
      content:"▸";
      float:right;
      color:var(--muted2);
      transform: translateY(1px);
      transition: transform .16s ease;
    }
    details[open] summary:after{transform: rotate(90deg) translateX(-2px)}
    details .inside{margin-top:8px; color:var(--muted)}

    figure{
      margin:0;
      padding:14px 18px 18px;
      border-top:1px solid var(--line2);
      background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0));
    }
    figcaption{
      margin-top:10px;
      color:var(--muted2);
      font-size:.93rem;
    }
    canvas{
      width:100%;
      height:auto;
      display:block;
      border-radius:16px;
      border:1px solid var(--line2);
      background:rgba(10,16,34,.52);
    }

    .backTop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:9px 12px;
      border-radius:14px;
      border:1px solid var(--line2);
      background:rgba(16,26,51,.55);
      color:var(--text);
      margin:14px 0 0;
      text-decoration:none;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .backTop:hover{
      transform:translateY(-1px);
      background:rgba(125,211,252,.10);
      border-color:rgba(125,211,252,.25);
      text-decoration:none;
    }

    footer{
      margin-top:14px;
      padding:14px 18px 18px;
      color:var(--muted2);
      font-size:.92rem;
      border-top:1px solid var(--line2);
      background:rgba(0,0,0,.12);
    }

    /* Print-friendly */
    @media print{
      :root{ --bg:#ffffff; --text:#000000; --muted:#111111; --muted2:#222222; --card:#ffffff; --card2:#ffffff; --line:#dddddd; --line2:#e6e6e6; --shadow:none; --shadow2:none; }
      body{background:#fff}
      nav{display:none}
      main{grid-template-columns:1fr}
      header, article{box-shadow:none; background:#fff}
      .btn, .toast{display:none !important}
      a{color:#000; text-decoration:underline}
      canvas{border:1px solid #ccc; background:#fff}
      section{break-inside:avoid-page}
      h2, h3{break-after:avoid-page}
      .eq{border-style:solid}
    }

    /* Subtle micro-animation: breathe on accent cards */
    @media (prefers-reduced-motion: no-preference){
      .breath{
        animation: breathe 5.5s ease-in-out infinite;
      }
      @keyframes breathe{
        0%,100%{transform: translateY(0)}
        50%{transform: translateY(-2px)}
      }
    }
  </style>
</head>

<body>
  <div class="wrap" id="top">
    <header>
      <div class="titleRow">
        <div>
          <h1>Second-Harmonic Generation in a <span style="color:var(--accent)">Third-Order</span> Medium via a Static Electric Field (EFISH)</h1>
          <p class="subtitle">
            Show that a material with only <span style="color:var(--accent2)">χ(3)</span> nonlinearity can still generate light at <strong>2ω</strong> when a
            <strong>DC (static) electric field</strong> is applied, and identify the physical parameters that control the conversion efficiency.
          </p>
        </div>
        <div class="badgeRow">
          <span class="badge"><span class="dot"></span>Nonlinear optics</span>
          <span class="badge"><span class="dot" style="background:var(--accent2); box-shadow:0 0 0 3px rgba(167,243,208,.16)"></span>EFISH: χ(2) from χ(3)</span>
          <span class="badge"><span class="dot" style="background:var(--warn); box-shadow:0 0 0 3px rgba(251,191,36,.16)"></span>Symbolic result</span>
        </div>
      </div>
    </header>

    <main>
      <nav aria-label="Table of Contents">
        <div class="tocTitle">
          <h2>Table of Contents</h2>
          <div class="miniHint">Sticky • click to jump</div>
        </div>
        <ul class="toc" id="tocList">
          <li><a href="#quick-summary">Quick Summary</a></li>
          <li><a href="#part0">PART 0 — Concept Primer</a></li>
          <li><a href="#part1">PART 1 — Problem Analysis</a></li>
          <li><a href="#part2">PART 2 — Strategy &amp; Tips</a></li>
          <li><a href="#part3">PART 3 — Full Solution</a></li>
          <li><a href="#part4">PART 4 — Deeper Understanding</a></li>
          <li><a href="#part5">PART 5 — Optional Plot Guide</a></li>
        </ul>
      </nav>

      <article>
        <div class="content">
          <section id="quick-summary">
            <h2>Quick Summary</h2>
            <div class="card callout breath">
              <ul>
                <li><strong>What this is about:</strong> Generating the <strong>second harmonic</strong> (frequency 2ω) in a material that is “normally” only <strong>third-order</strong> nonlinear.</li>
                <li><strong>Key physics idea:</strong> A <strong>static electric field</strong> breaks inversion symmetry and mixes with χ(3), producing an <strong>effective χ(2)</strong> (the EFISH effect).</li>
                <li><strong>Governing expansion:</strong> P = ε0[ χ(1)E + χ(2):EE + χ(3)::EEE + … ]. In a centrosymmetric medium, χ(2)=0 but χ(3)≠0.</li>
                <li><strong>Core result:</strong> The nonlinear polarization at 2ω becomes
                  <em>P(2ω) ∝ 3 ε0 χ(3): E<sub>DC</sub> E<sub>ω</sub> E<sub>ω</sub></em>, which has the same structure as ordinary SHG.</li>
                <li><strong>Effective second-order coefficient:</strong> For a scalar (one-polarization) case, <strong>d<sub>eff</sub> = (3/2) χ(3) E<sub>DC</sub></strong> (tensor contractions determine the exact component).</li>
                <li><strong>Efficiency scaling:</strong> In the undepleted-pump, plane-wave limit,
                  I<sub>2ω</sub> ∝ d<sub>eff</sub><sup>2</sup> I<sub>ω</sub><sup>2</sup> L<sub>eff</sub><sup>2</sup> sinc<sup>2</sup>(ΔkL/2), hence <strong>I<sub>2ω</sub> ∝ χ(3)<sup>2</sup> E<sub>DC</sub><sup>2</sup> I<sub>ω</sub><sup>2</sup></strong>.</li>
                <li><strong>What it physically means:</strong> The DC field “biases” the medium so the oscillating optical field experiences a quadratic-like response and can radiate at 2ω.</li>
                <li><strong>Result type:</strong> Mostly <strong>symbolic</strong>; you can plug in material and beam parameters for numbers.</li>
              </ul>
            </div>
          </section>

          <section id="part0">
            <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

            <div class="grid2">
              <div class="card">
                <div class="kicker">
                  <strong>Core definitions (symbols + SI units)</strong>
                  <span class="small">nonlinear polarization framework</span>
                </div>
                <ul>
                  <li><strong>E</strong>: electric field (V/m). For optics, usually E(t) = Re{E<sub>ω</sub> e<sup>-iωt</sup>}.</li>
                  <li><strong>P</strong>: polarization density (C/m²). Acts as a source term for electromagnetic waves.</li>
                  <li><strong>ε0</strong>: vacuum permittivity (F/m).</li>
                  <li><strong>χ(1)</strong>: linear susceptibility (dimensionless). Related to refractive index n.</li>
                  <li><strong>χ(2)</strong>: second-order susceptibility (SI: m/V in common effective scalar conventions; as a tensor, components are often quoted in pm/V for d).</li>
                  <li><strong>χ(3)</strong>: third-order susceptibility (SI: m²/V² in common effective scalar conventions; also a 4th-rank tensor).</li>
                  <li><strong>ω</strong>: fundamental angular frequency (rad/s). Second harmonic is 2ω.</li>
                  <li><strong>Δk</strong> = k(2ω) − 2k(ω): phase mismatch (1/m), with k = n(ω) ω / c.</li>
                  <li><strong>L</strong>: interaction length (m). <strong>L<sub>eff</sub></strong> includes absorption or effective overlap.</li>
                </ul>
              </div>

              <div class="card">
                <div class="kicker">
                  <strong>Physical meaning (intuition)</strong>
                  <span class="small">why DC fields matter</span>
                </div>
                <ul>
                  <li><strong>SHG needs a “quadratic” source:</strong> A polarization oscillating at 2ω must exist to radiate a 2ω wave.</li>
                  <li><strong>Centrosymmetric materials:</strong> Inversion symmetry forces χ(2)=0 (electric-dipole approximation), so ordinary SHG is forbidden.</li>
                  <li><strong>Third-order mixing:</strong> χ(3) can mix <em>three</em> fields. If one of those fields is DC (0 frequency), then ω + ω + 0 = 2ω, which creates a 2ω polarization.</li>
                  <li><strong>Symmetry breaking:</strong> The applied DC field defines a direction and breaks inversion symmetry, allowing a χ(2)-like response.</li>
                </ul>
              </div>
            </div>

            <div class="card callout" style="margin-top:12px">
              <div class="kicker">
                <strong>Key laws/principles + validity conditions</strong>
                <span class="small">what must be true for the derivation</span>
              </div>
              <ul>
                <li><strong>Constitutive expansion (weak nonlinearity):</strong> valid when nonlinear polarization is small compared to the linear term (no strong depletion unless treated explicitly).</li>
                <li><strong>Electric-dipole regime:</strong> we neglect magnetic-dipole/electric-quadrupole SHG sources (often small but can matter near surfaces or in strongly dispersive media).</li>
                <li><strong>Monochromatic pump approximation:</strong> a narrowband fundamental at ω.</li>
                <li><strong>Slowly varying envelope approximation (SVEA):</strong> allows coupled-wave equations for SHG efficiency.</li>
                <li><strong>Uniform DC bias field (idealization):</strong> assumes electrodes/geometry produce approximately constant E<sub>DC</sub> across the optical mode.</li>
              </ul>
            </div>

            <details>
              <summary>Common models/approximations used (and why)</summary>
              <div class="inside">
                <ul>
                  <li><strong>Plane-wave SHG formula:</strong> simplest analytic efficiency scaling; good for understanding parameter dependence.</li>
                  <li><strong>Undepleted pump:</strong> assumes I<sub>2ω</sub> ≪ I<sub>ω</sub> so the fundamental amplitude is nearly constant.</li>
                  <li><strong>Scalar effective coefficients:</strong> replaces tensor contractions by a single d<sub>eff</sub> for a given polarization/propagation geometry. Real crystals require tensor bookkeeping.</li>
                  <li><strong>Absorption via L<sub>eff</sub>:</strong> if α is absorption coefficient, the effective length saturates around 1/α rather than growing indefinitely.</li>
                </ul>
              </div>
            </details>

            <div class="grid2">
              <div class="card">
                <h3>Mini intuition examples (minimal algebra)</h3>
                <ul>
                  <li><strong>Example 1 (frequency bookkeeping):</strong> χ(3) allows outputs at sums of three input frequencies. With inputs (ω, ω, 0), the sum is 2ω → a second harmonic source exists.</li>
                  <li><strong>Example 2 (symmetry):</strong> In a centrosymmetric medium, flipping E → −E should flip P → −P. A quadratic term would not flip sign, so it must vanish unless symmetry is broken. A DC bias picks a preferred direction, so the “flip symmetry” no longer applies.</li>
                  <li><strong>Example 3 (scaling):</strong> If the SH polarization is proportional to E<sub>DC</sub> E<sub>ω</sub><sup>2</sup>, then SH intensity scales as E<sub>DC</sub><sup>2</sup> I<sub>ω</sub><sup>2</sup>.</li>
                </ul>
              </div>

              <div class="card callout warn">
                <h3>What to watch for (pitfalls)</h3>
                <ul>
                  <li><strong>Tensor factors:</strong> the factor “3” arises from permutations of fields in χ(3); in full tensor form, which component matters depends on polarization and crystal symmetry.</li>
                  <li><strong>DC field is not a wave:</strong> it does not need phase matching by itself, but it changes the effective nonlinear source and can slightly modify refractive indices (electro-optic effects).</li>
                  <li><strong>Phase matching still matters:</strong> even with EFISH, you still need Δk ≈ 0 (or quasi-phase-matching) for high efficiency.</li>
                  <li><strong>Breakdown limits:</strong> E<sub>DC</sub> is limited by dielectric breakdown and electrode design; heating and optical damage limit I<sub>ω</sub>.</li>
                </ul>
              </div>
            </div>

            <a class="backTop" href="#top" aria-label="Back to top">↑ Back to top</a>
          </section>

          <section id="part1">
            <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

            <div class="card">
              <div class="kicker">
                <strong>Problem restatement (in plain language)</strong>
                <span class="small">what we must show</span>
              </div>
              <p>
                You have a medium whose leading nonlinearity is <strong>third-order</strong> (χ(3) ≠ 0). Normally, such a medium might not produce
                second harmonic light because it lacks an intrinsic second-order response (χ(2) = 0 in centrosymmetric materials).
                You apply a <strong>static electric field</strong> E<sub>DC</sub>. Show that the medium can then generate a polarization oscillating at
                <strong>2ω</strong>, enabling SHG. Finally, identify which physical parameters control the efficiency of this EFISH-based SHG.
              </p>
            </div>

            <div class="grid2" style="margin-top:12px">
              <div class="card">
                <h3>Given / setup</h3>
                <ul>
                  <li>A fundamental optical field at frequency ω with complex amplitude E<sub>ω</sub>.</li>
                  <li>A static (DC) field E<sub>DC</sub> applied to the medium.</li>
                  <li>A third-order nonlinear susceptibility χ(3) (generally a tensor).</li>
                  <li>Propagation over length L in a dispersive medium with indices n(ω), n(2ω) and possible absorption.</li>
                </ul>
              </div>

              <div class="card">
                <h3>Unknowns / what must be found</h3>
                <ul>
                  <li>Show existence of a nonlinear polarization term P(2ω) in a χ(3) medium under DC bias.</li>
                  <li>Express an effective χ(2) or d<sub>eff</sub> produced by χ(3) and E<sub>DC</sub>.</li>
                  <li>Identify the efficiency-determining parameters (material + wave + geometry).</li>
                </ul>
              </div>
            </div>

            <div class="card callout" style="margin-top:12px">
              <h3>Relevant principles (and why they apply)</h3>
              <ul>
                <li><strong>Nonlinear polarization as a source:</strong> Maxwell’s equations show that wave generation at new frequencies is driven by P(ω') at those frequencies.</li>
                <li><strong>Third-order mixing:</strong> χ(3) couples three fields. A DC field counts as a field at 0 frequency, allowing ω + ω + 0 → 2ω.</li>
                <li><strong>Coupled-wave SHG theory:</strong> once P(2ω) is known, standard SHG formulas apply with an effective nonlinear coefficient and phase mismatch Δk.</li>
              </ul>
              <p class="small">
                We do <em>not</em> need a full microscopic model; a macroscopic susceptibility expansion is sufficient and is exactly what this problem targets.
              </p>
            </div>

            <div class="card callout warn" style="margin-top:12px">
              <h3>Assumptions (explicit)</h3>
              <ul>
                <li>Optical field is monochromatic at ω (narrowband).</li>
                <li>Nonlinearity is weak: undepleted pump approximation is acceptable for an efficiency expression.</li>
                <li>DC field is approximately uniform in the region sampled by the optical beam.</li>
                <li>We neglect surface SHG and higher multipole contributions (electric-dipole dominant bulk response).</li>
                <li>We use a single effective polarization geometry (tensor effects summarized by an effective coefficient).</li>
              </ul>
            </div>

            <div class="card" style="margin-top:12px">
              <h3>Possible approaches (compare + choose)</h3>
              <ol>
                <li>
                  <strong>Frequency-domain susceptibility expansion (best for this problem):</strong>
                  Expand P in powers of E, insert E = E<sub>DC</sub> + optical field, and extract the component oscillating at 2ω.
                  <br><span class="small">Pros: direct, shows the “why” clearly; minimal machinery. Cons: needs careful factor counting.</span>
                </li>
                <li>
                  <strong>Coupled-wave derivation from Maxwell equations:</strong>
                  Start from wave equation with nonlinear source and derive SHG growth rate.
                  <br><span class="small">Pros: gives explicit efficiency formula. Cons: longer; still needs P(2ω) from χ(3)+DC.</span>
                </li>
                <li>
                  <strong>Symmetry argument + effective χ(2):</strong>
                  Use inversion symmetry breaking by DC field to argue χ(2)<sub>eff</sub> ∝ χ(3)E<sub>DC</sub>.
                  <br><span class="small">Pros: excellent intuition. Cons: does not by itself provide prefactors or full efficiency dependence.</span>
                </li>
              </ol>
              <p><strong>Choice:</strong> We will do (1) to prove SHG exists and obtain χ(2)<sub>eff</sub>, then plug into (2) briefly to state the standard SHG efficiency dependencies.</p>
            </div>

            <a class="backTop" href="#top">↑ Back to top</a>
          </section>

          <section id="part2">
            <h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

            <div class="card">
              <ol>
                <li><strong>Write the field decomposition:</strong> E(t) = E<sub>DC</sub> + Re{E<sub>ω</sub> e<sup>-iωt</sup>}.</li>
                <li><strong>Start from the third-order polarization:</strong> P^(3)(t) = ε0 χ(3)::E(t)E(t)E(t).</li>
                <li><strong>Expand the cube:</strong> collect all terms; identify those oscillating as e<sup>-i2ωt</sup>.</li>
                <li><strong>Read off P(2ω):</strong> show it is proportional to E<sub>DC</sub> E<sub>ω</sub><sup>2</sup> (with a permutation factor 3).</li>
                <li><strong>Define an effective χ(2) or d<sub>eff</sub>:</strong> match P(2ω) to the usual SHG form P(2ω)=2ε0 d<sub>eff</sub> E<sub>ω</sub><sup>2</sup>.</li>
                <li><strong>State the SHG intensity formula:</strong> I<sub>2ω</sub> in terms of d<sub>eff</sub>, indices, L, Δk, and pump intensity.</li>
                <li><strong>List efficiency parameters:</strong> identify what in that formula can be tuned physically (material, fields, phase matching, mode overlap, losses, damage limits).</li>
                <li><strong>Sanity checks:</strong> verify scaling (E<sub>DC</sub>→0 kills SHG; Δk→0 maximizes; units consistent).</li>
              </ol>
            </div>

            <div class="card callout bad" style="margin-top:12px">
              <h3>Common mistakes (quick tips)</h3>
              <ul>
                <li><strong>Missing the factor of 3:</strong> P(2ω) arises from three equivalent placements of E<sub>DC</sub> among the three fields in χ(3).</li>
                <li><strong>Confusing χ(3) units/conventions:</strong> some texts quote χ(3) in esu; here we assume SI and keep expressions symbolic.</li>
                <li><strong>Ignoring phase mismatch:</strong> even with χ(2)<sub>eff</sub>, poor phase matching makes SHG oscillate and average out.</li>
                <li><strong>Forgetting tensor selection rules:</strong> polarization directions and symmetry determine which χ(3) component contributes.</li>
              </ul>
            </div>

            <a class="backTop" href="#top">↑ Back to top</a>
          </section>

          <section id="part3">
            <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

            <div class="card callout">
              <h3>Physical intuition first: what should happen?</h3>
              <p>
                A χ(3) medium can create new frequencies by mixing three fields. If you apply a <strong>DC bias</strong>, that field acts like a
                “constant multiplier.” Then the nonlinear polarization contains a term proportional to <strong>E<sub>DC</sub> × (optical field)²</strong>.
                Squaring a sinusoid produces a component at <strong>2ω</strong>, so the medium acquires an SHG-driving source even if χ(2)=0 intrinsically.
              </p>
            </div>

            <h3>Step 1: Write the nonlinear polarization expansion</h3>
            <p>
              In macroscopic nonlinear optics, the polarization is expanded as a power series in the electric field:
            </p>

            <div class="eq" data-copy="eq1">
              <div class="eqTop">
                <div class="eqLabel">Key equation (constitutive expansion)</div>
                <button class="btn" data-copy-btn="eq1">Copy</button>
              </div>
              <pre id="eq1">P(t) = ε0 [ χ(1)·E(t) + χ(2):E(t)E(t) + χ(3)::E(t)E(t)E(t) + ... ]</pre>
              <div class="btnRow">
                <span class="small">“:” and “::” indicate tensor contractions.</span>
              </div>
            </div>

            <p>
              In many centrosymmetric materials (glasses, many liquids, many semiconductors in bulk), the <strong>electric-dipole</strong>
              second-order susceptibility vanishes:
              <strong>χ(2)=0</strong>. But <strong>χ(3) generally does not vanish</strong>.
              So the leading nonlinear term is:
            </p>

            <div class="eq" data-copy="eq2">
              <div class="eqTop">
                <div class="eqLabel">Key equation (third-order polarization)</div>
                <button class="btn" data-copy-btn="eq2">Copy</button>
              </div>
              <pre id="eq2">P^(3)(t) = ε0 χ(3)::E(t)E(t)E(t)</pre>
            </div>

            <h3>Step 2: Decompose the total field into DC + optical</h3>
            <p>
              Let the applied static field be E<sub>DC</sub> (time-independent). Let the optical fundamental field be monochromatic at ω:
            </p>

            <div class="eq" data-copy="eq3">
              <div class="eqTop">
                <div class="eqLabel">Field decomposition</div>
                <button class="btn" data-copy-btn="eq3">Copy</button>
              </div>
              <pre id="eq3">E(t) = E_DC + Re{ E_ω e^{-iωt} }
(Equivalent complex form: E(t) = E_DC + (1/2)E_ω e^{-iωt} + (1/2)E_ω* e^{+iωt})</pre>
            </div>

            <p>
              The explicit complex form is useful because frequency components are easy to identify: products of exponentials add frequencies.
            </p>

            <h3>Step 3: Expand the cubic term and isolate the 2ω component</h3>
            <p>
              Insert E(t)=E<sub>DC</sub>+E<sub>opt</sub>(t) into P^(3) ∝ [E(t)]³. Symbolically:
            </p>

            <div class="eq" data-copy="eq4">
              <div class="eqTop">
                <div class="eqLabel">Cubic expansion (structure)</div>
                <button class="btn" data-copy-btn="eq4">Copy</button>
              </div>
              <pre id="eq4">E^3 = (E_DC + E_opt)^3
    = E_DC^3 + 3 E_DC^2 E_opt + 3 E_DC E_opt^2 + E_opt^3</pre>
            </div>

            <p>
              Which term can generate <strong>2ω</strong>?
            </p>
            <ul>
              <li>E<sub>DC</sub><sup>3</sup> is DC only (0 frequency).</li>
              <li>3E<sub>DC</sub><sup>2</sup>E<sub>opt</sub> oscillates at ω (just modifies the linear response at ω).</li>
              <li><strong>3E<sub>DC</sub>E<sub>opt</sub><sup>2</sup></strong> contains the square of an ω-oscillation, which has a component at <strong>2ω</strong>.</li>
              <li>E<sub>opt</sub><sup>3</sup> produces components at ω and 3ω (third-harmonic generation), but not primarily 2ω for a single-frequency pump.</li>
            </ul>

            <p>
              Therefore, the SHG-driving polarization comes from the cross term:
              <strong>P(2ω) ∝ 3 ε0 χ(3) :: E<sub>DC</sub> E<sub>ω</sub> E<sub>ω</sub></strong>.
              The factor <strong>3</strong> reflects the number of equivalent permutations of the DC field among the three factors in χ(3).
            </p>

            <div class="eq" data-copy="eq5">
              <div class="eqTop">
                <div class="eqLabel">Nonlinear polarization at 2ω (EFISH source term)</div>
                <button class="btn" data-copy-btn="eq5">Copy</button>
              </div>
              <pre id="eq5">P_NL(2ω) = 3 ε0 [ χ(3) :: (E_DC)(E_ω)(E_ω) ]</pre>
              <div class="btnRow">
                <span class="small">In full tensor form: P_i(2ω) = 3 ε0 Σ_{jkl} χ^{(3)}_{ijkl}(2ω; ω, ω, 0) (E_DC)_j (E_ω)_k (E_ω)_l.</span>
              </div>
            </div>

            <h3>Step 4: Map this onto the standard SHG form and define χ(2)<sub>eff</sub> or d<sub>eff</sub></h3>
            <p>
              In ordinary second-order SHG (with intrinsic χ(2)), the nonlinear polarization at 2ω is often written (for a chosen geometry) as:
            </p>

            <div class="eq" data-copy="eq6">
              <div class="eqTop">
                <div class="eqLabel">Standard SHG polarization form</div>
                <button class="btn" data-copy-btn="eq6">Copy</button>
              </div>
              <pre id="eq6">P_NL(2ω) = ε0 χ_eff(2) : E_ω E_ω
(Equivalent common scalar form: P_NL(2ω) = 2 ε0 d_eff E_ω^2)</pre>
            </div>

            <p>
              Comparing EFISH with standard SHG shows that the DC-biased χ(3) medium behaves as if it had an effective second-order susceptibility:
            </p>

            <div class="eq" data-copy="eq7">
              <div class="eqTop">
                <div class="eqLabel">Effective second-order susceptibility induced by DC field</div>
                <button class="btn" data-copy-btn="eq7">Copy</button>
              </div>
              <pre id="eq7">χ_eff(2) = 3 χ(3) · E_DC
(“·” indicates contraction of one χ(3) index with the DC-field direction.)</pre>
            </div>

            <p>
              In the common scalar SHG convention P(2ω)=2ε0 d<sub>eff</sub> E<sub>ω</sub><sup>2</sup>, equating
              2ε0 d<sub>eff</sub> E<sub>ω</sub><sup>2</sup> to 3ε0 χ(3) E<sub>DC</sub> E<sub>ω</sub><sup>2</sup> gives:
            </p>

            <div class="eq" data-copy="eq8">
              <div class="eqTop">
                <div class="eqLabel">Effective d-coefficient (scalar, single-polarization case)</div>
                <button class="btn" data-copy-btn="eq8">Copy</button>
              </div>
              <pre id="eq8">d_eff = (3/2) χ(3) E_DC</pre>
              <div class="btnRow">
                <span class="small">In practice, “χ(3)” here means the relevant tensor component for your polarization/geometry.</span>
              </div>
            </div>

            <h3>Step 5: Efficiency—use the standard SHG intensity scaling with d<sub>eff</sub></h3>
            <p>
              Once an effective d<sub>eff</sub> exists, the <strong>usual SHG theory</strong> applies. In the plane-wave, undepleted-pump limit,
              a common intensity-level expression is:
            </p>

            <div class="eq" data-copy="eq9">
              <div class="eqTop">
                <div class="eqLabel">SH intensity in terms of d_eff (undepleted pump, plane waves)</div>
                <button class="btn" data-copy-btn="eq9">Copy</button>
              </div>
              <pre id="eq9">I_(2ω) = [ 2 ω^2 d_eff^2 / (n_ω^2 n_(2ω) ε0 c^3) ] · I_ω^2 · L_eff^2 · sinc^2(Δk L / 2)

where sinc(x) = sin(x)/x,  Δk = k_(2ω) - 2k_ω,  k = n(ω) ω / c.</pre>
            </div>

            <p>
              Substituting d<sub>eff</sub> = (3/2)χ(3)E<sub>DC</sub> makes the EFISH scaling explicit:
            </p>

            <div class="eq" data-copy="eq10">
              <div class="eqTop">
                <div class="eqLabel">EFISH-SHG scaling (key dependence)</div>
                <button class="btn" data-copy-btn="eq10">Copy</button>
              </div>
              <pre id="eq10">I_(2ω) ∝ [χ(3)]^2 · E_DC^2 · I_ω^2 · L_eff^2 · sinc^2(Δk L / 2)
(with additional dependence on n_ω, n_(2ω), and ω as in the SHG prefactor)</pre>
            </div>

            <div class="card callout good">
              <h3>Final Answer (boxed)</h3>
              <div class="eq" data-copy="final">
                <div class="eqTop">
                  <div class="eqLabel">Copy-ready final result (plain text)</div>
                  <button class="btn" data-copy-btn="final">Copy</button>
                </div>
                <pre id="final">EFISH enables SHG in a χ(3) medium because a DC bias field produces a nonlinear polarization at 2ω:

P_NL(2ω) = 3 ε0 [ χ(3) :: (E_DC)(E_ω)(E_ω) ].

This is equivalent to ordinary SHG with an effective second-order susceptibility:
χ_eff(2) = 3 χ(3) · E_DC,
or in the scalar SHG convention P_NL(2ω)=2ε0 d_eff E_ω^2:
d_eff = (3/2) χ(3) E_DC.

Thus the SHG efficiency scales like:
I_(2ω) = [ 2 ω^2 d_eff^2 / (n_ω^2 n_(2ω) ε0 c^3) ] · I_ω^2 · L_eff^2 · sinc^2(Δk L / 2)
⇒ I_(2ω) ∝ [χ(3)]^2 E_DC^2 I_ω^2 L_eff^2 sinc^2(Δk L / 2).</pre>
              </div>

              <p class="small">
                Physical parameters controlling efficiency: χ(3) tensor component (and polarization geometry), DC field magnitude and uniformity,
                pump intensity and beam overlap, interaction length/effective length (including absorption), refractive indices and dispersion through Δk,
                and practical limits like breakdown field and optical damage.
              </p>
            </div>

            <h3>Sanity checks</h3>
            <div class="grid2">
              <div class="card">
                <h3 style="margin-top:0">1) Limiting cases</h3>
                <ul>
                  <li><strong>E<sub>DC</sub> → 0:</strong> d<sub>eff</sub> → 0 ⇒ P(2ω) → 0 ⇒ no EFISH-SHG (as expected).</li>
                  <li><strong>Δk → 0:</strong> sinc²(ΔkL/2) → 1 ⇒ maximal coherent buildup with L.</li>
                  <li><strong>L small:</strong> I<sub>2ω</sub> ∝ L² (coherent growth).</li>
                  <li><strong>Strong absorption:</strong> L<sub>eff</sub> saturates, preventing indefinite growth.</li>
                </ul>
              </div>
              <div class="card">
                <h3 style="margin-top:0">2) Units/dimensions (quick)</h3>
                <p>
                  In the scalar convention, χ(3) has SI units of m²/V², so χ(3)E<sub>DC</sub> has units m/V, matching χ(2) (or equivalently d).
                  Then SHG intensity depends on d<sub>eff</sub><sup>2</sup>, as standard.
                </p>
                <details>
                  <summary>Note on conventions</summary>
                  <div class="inside">
                    <p>
                      Different texts distribute numerical factors between χ(2) and d (e.g., χ(2)=2d). The key physical point is unchanged:
                      <strong>the induced second-order response is linear in E<sub>DC</sub> and proportional to χ(3)</strong>.
                      Prefactors (2 vs 3/2, etc.) depend on the precise definition and tensor symmetrization used.
                    </p>
                  </div>
                </details>
              </div>
            </div>

            <a class="backTop" href="#top">↑ Back to top</a>
          </section>

          <section id="part4">
            <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

            <div class="card">
              <h3>Re-interpret the final formula: what controls what?</h3>
              <ul>
                <li><strong>χ(3) (material strength):</strong> bigger χ(3) means larger induced χ(2)<sub>eff</sub> and stronger SHG. Resonances can enhance χ(3), but may also increase absorption.</li>
                <li><strong>E<sub>DC</sub> (bias field):</strong> χ(2)<sub>eff</sub> ∝ E<sub>DC</sub>, so <strong>efficiency ∝ E<sub>DC</sub><sup>2</sup></strong>. Limited by dielectric breakdown and electrode spacing.</li>
                <li><strong>I<sub>ω</sub> (pump intensity):</strong> for undepleted pump, <strong>I<sub>2ω</sub> ∝ I<sub>ω</sub><sup>2</sup></strong>. Limited by optical damage, heating, and nonlinear losses.</li>
                <li><strong>Phase matching (Δk):</strong> governs coherent buildup. Even strong χ(2)<sub>eff</sub> is wasted if sinc²(ΔkL/2) ≪ 1.</li>
                <li><strong>Length L and losses:</strong> ideal growth is L², but with absorption or walk-off, the useful length becomes L<sub>eff</sub>.</li>
                <li><strong>Polarization/geometry (tensor projections):</strong> the effective coefficient is a particular contraction of χ(3) with E<sub>DC</sub> and optical polarizations; alignment can change efficiency drastically.</li>
              </ul>
            </div>

            <div class="card callout warn" style="margin-top:12px">
              <h3>What physical parameters determine EFISH-SHG efficiency? (organized list)</h3>
              <div class="grid2">
                <div>
                  <ul>
                    <li><strong>Material:</strong> relevant χ(3) tensor component; dispersion n(ω), n(2ω); absorption α(ω), α(2ω); damage threshold.</li>
                    <li><strong>Bias field system:</strong> magnitude E<sub>DC</sub>, spatial uniformity across mode, electrode losses/heating, breakdown limits, dielectric constant (affects field distribution).</li>
                    <li><strong>Optical beam:</strong> intensity I<sub>ω</sub>, mode overlap with biased region, focusing (effective area), polarization relative to χ(3) tensor.</li>
                  </ul>
                </div>
                <div>
                  <ul>
                    <li><strong>Wave propagation:</strong> phase mismatch Δk (including temperature tuning), group-velocity mismatch (pulses), walk-off (birefringent media).</li>
                    <li><strong>Interaction length:</strong> physical L, plus L<sub>eff</sub> set by loss and coherence length.</li>
                    <li><strong>Boundary/surface effects:</strong> can add extra SHG contributions; usually separate from EFISH bulk term but can matter in thin films.</li>
                  </ul>
                </div>
              </div>
            </div>

            <details>
              <summary>Alternative derivation idea (brief but meaningful)</summary>
              <div class="inside">
                <p>
                  You can view EFISH as a <strong>symmetry-breaking perturbation</strong>. In a centrosymmetric medium, the free-energy density must be
                  invariant under E → −E, so only even powers contribute to the energy and only odd powers to P (since P = −∂F/∂E).
                  Applying a static field shifts the expansion point: write E = E<sub>DC</sub> + δE. Expanding P(E) about E<sub>DC</sub> generates an
                  <strong>effective quadratic response in δE</strong> with coefficient proportional to χ(3)E<sub>DC</sub>. This yields the same
                  χ(2)<sub>eff</sub> ∝ χ(3)E<sub>DC</sub> result without explicit frequency algebra.
                </p>
              </div>
            </details>

            <div class="card" style="margin-top:12px">
              <h3>Concept check (self-test with answers)</h3>
              <ul>
                <li><strong>Q:</strong> Why does a DC field enable SHG in a χ(3) medium? <strong>A:</strong> χ(3) mixes three fields; with one at 0 frequency, ω+ω+0 = 2ω, producing P(2ω).</li>
                <li><strong>Q:</strong> How does SH power scale with E<sub>DC</sub>? <strong>A:</strong> P(2ω) ∝ E<sub>DC</sub>, so intensity/power ∝ E<sub>DC</sub><sup>2</sup>.</li>
                <li><strong>Q:</strong> Does EFISH remove the need for phase matching? <strong>A:</strong> No. The generated 2ω wave still must stay in phase with the nonlinear source for efficient buildup.</li>
                <li><strong>Q:</strong> If χ(3) is large near a resonance, is EFISH always improved? <strong>A:</strong> Not necessarily; resonances often increase absorption, reducing L<sub>eff</sub> and harming net efficiency.</li>
              </ul>
            </div>

            <a class="backTop" href="#top">↑ Back to top</a>
          </section>
        </div>

        <figure id="plotBlock" aria-label="Optional plot: quadratic scaling with DC field">
          <canvas id="plot" width="980" height="480" aria-label="Quadratic dependence plot"></canvas>
          <figcaption>
            <strong>Optional learning plot (example values):</strong> EFISH-SHG conversion scales quadratically with the applied DC field:
            η ∝ E<sub>DC</sub><sup>2</sup> (for fixed χ(3), intensity, phase matching, and length). The curve below is a normalized example to visualize the scaling.
          </figcaption>
        </figure>

        <section id="part5">
          <h2>PART 5 — Optional Plot Guide</h2>

          <div class="card">
            <h3>What the plot shows (and why it’s useful)</h3>
            <p>
              The plot visualizes the hallmark EFISH prediction:
              because d<sub>eff</sub> ∝ E<sub>DC</sub>, the SHG efficiency (or generated SH intensity) scales as <strong>E<sub>DC</sub><sup>2</sup></strong>.
              Seeing the quadratic curve helps you quickly distinguish EFISH-SHG from effects that scale linearly with field or exponentially with length.
            </p>

            <h3>Axes and units</h3>
            <ul>
              <li><strong>x-axis:</strong> E<sub>DC</sub> in MV/m (example range).</li>
              <li><strong>y-axis:</strong> normalized efficiency η/η<sub>0</sub> (dimensionless), with η/η<sub>0</sub> = (E<sub>DC</sub>/E<sub>0</sub>)².</li>
            </ul>

            <h3>Example values (only for the plot)</h3>
            <ul>
              <li>E<sub>0</sub> = 1 MV/m is chosen purely as a normalization reference.</li>
              <li>This plot does <em>not</em> fix χ(3), I<sub>ω</sub>, Δk, or L; those are held “constant” implicitly to isolate the E<sub>DC</sub> dependence.</li>
            </ul>

            <h3>Features to notice</h3>
            <ul>
              <li><strong>Curvature:</strong> doubling E<sub>DC</sub> multiplies η by 4.</li>
              <li><strong>Intercept:</strong> at E<sub>DC</sub>=0, η=0 (no EFISH-SHG).</li>
              <li><strong>Practical note:</strong> real devices stop following the curve at high fields due to breakdown, heating, or other nonlinear losses.</li>
            </ul>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <footer>
          <div class="card" style="background:rgba(10,16,34,.35)">
            <strong>Takeaway:</strong> A DC electric field “activates” SHG in a χ(3) medium by inducing an effective χ(2):
            χ(2)<sub>eff</sub> = 3 χ(3)·E<sub>DC</sub>. Efficiency is set by material χ(3), DC field strength, pump intensity, phase matching, losses, and mode overlap.
          </div>
        </footer>
      </article>
    </main>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite">Copied.</div>

  <script>
    // ---------- Copy buttons ----------
    (function(){
      const toast = document.getElementById('toast');

      function showToast(msg){
        toast.textContent = msg;
        toast.classList.add('show');
        clearTimeout(showToast._t);
        showToast._t = setTimeout(()=>toast.classList.remove('show'), 1200);
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          showToast("Copied to clipboard.");
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          ta.style.top = '0';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          try{
            document.execCommand('copy');
            showToast("Copied (fallback).");
          }catch(err){
            showToast("Copy failed. Please select text manually.");
          }
          document.body.removeChild(ta);
        }
      }

      document.querySelectorAll('[data-copy-btn]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.getAttribute('data-copy-btn');
          const pre = document.getElementById(id);
          if(pre) copyText(pre.innerText.trim());
        });
      });
    })();

    // ---------- Sticky TOC active highlight ----------
    (function(){
      const links = Array.from(document.querySelectorAll('#tocList a'));
      const sections = links.map(a => document.querySelector(a.getAttribute('href'))).filter(Boolean);

      function setActive(){
        const y = window.scrollY || document.documentElement.scrollTop;
        const offset = 110;
        let idx = 0;
        for(let i=0;i<sections.length;i++){
          const s = sections[i];
          if(s.offsetTop - offset <= y) idx = i;
        }
        links.forEach((a,i)=>a.classList.toggle('active', i===idx));
      }

      window.addEventListener('scroll', setActive, {passive:true});
      window.addEventListener('resize', setActive);
      setActive();
    })();

    // ---------- One static canvas plot (non-interactive), crisp with devicePixelRatio ----------
    (function(){
      const canvas = document.getElementById('plot');
      const block = document.getElementById('plotBlock');

      function draw(){
        const ctx = canvas.getContext('2d');
        const dpr = Math.max(1, window.devicePixelRatio || 1);

        // Responsive sizing
        const cssWidth = block.clientWidth - 36; // approximate padding breathing room
        const cssHeight = Math.max(320, Math.min(520, Math.round(cssWidth * 0.48)));

        canvas.style.width = cssWidth + "px";
        canvas.style.height = cssHeight + "px";

        canvas.width = Math.round(cssWidth * dpr);
        canvas.height = Math.round(cssHeight * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        // Plot area
        const W = cssWidth, H = cssHeight;
        const padL = 64, padR = 18, padT = 44, padB = 54;
        const x0 = padL, y0 = H - padB, x1 = W - padR, y1 = padT;
        const pw = x1 - x0, ph = y0 - y1;

        // Colors (no external styles; keep subtle)
        const colGrid = "rgba(255,255,255,0.10)";
        const colAxis = "rgba(255,255,255,0.55)";
        const colText = "rgba(234,240,255,0.92)";
        const colMuted = "rgba(183,195,230,0.85)";
        const colCurve = "rgba(125,211,252,0.95)";
        const colCurve2 = "rgba(167,243,208,0.90)";

        // Background
        ctx.clearRect(0,0,W,H);
        ctx.fillStyle = "rgba(10,16,34,0.35)";
        ctx.fillRect(0,0,W,H);

        // Example model: normalized eta = (E/E0)^2 with E0=1 MV/m
        const xmin = 0, xmax = 5; // MV/m
        const E0 = 1;             // MV/m (example normalization)
        const ymin = 0, ymax = Math.pow(xmax/E0,2); // 25

        function X(x){ return x0 + (x - xmin) * pw / (xmax - xmin); }
        function Y(y){ return y0 - (y - ymin) * ph / (ymax - ymin); }

        // Gridlines + ticks
        const xTicks = 6; // 0..5
        const yTicks = 6; // 0..25 step 5
        ctx.lineWidth = 1;

        // Grid: vertical
        for(let i=0;i<xTicks;i++){
          const xv = xmin + i*(xmax-xmin)/(xTicks-1);
          const xx = X(xv);
          ctx.strokeStyle = colGrid;
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y1);
          ctx.stroke();
        }
        // Grid: horizontal
        for(let i=0;i<yTicks;i++){
          const yv = ymin + i*(ymax-ymin)/(yTicks-1);
          const yy = Y(yv);
          ctx.strokeStyle = colGrid;
          ctx.beginPath();
          ctx.moveTo(x0, yy);
          ctx.lineTo(x1, yy);
          ctx.stroke();
        }

        // Axes
        ctx.strokeStyle = colAxis;
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x1, y0);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x0, y1);
        ctx.stroke();

        // Tick labels
        ctx.fillStyle = colMuted;
        ctx.font = "600 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "top";
        for(let i=0;i<xTicks;i++){
          const xv = xmin + i*(xmax-xmin)/(xTicks-1);
          const xx = X(xv);
          ctx.fillText(xv.toFixed(0), xx, y0 + 10);
        }

        ctx.textAlign = "right";
        ctx.textBaseline = "middle";
        for(let i=0;i<yTicks;i++){
          const yv = ymin + i*(ymax-ymin)/(yTicks-1);
          const yy = Y(yv);
          ctx.fillText(yv.toFixed(0), x0 - 10, yy);
        }

        // Titles
        ctx.fillStyle = colText;
        ctx.textAlign = "left";
        ctx.textBaseline = "top";
        ctx.font = "700 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillText("EFISH-SHG: normalized efficiency scales as η ∝ E_DC² (example)", x0, 14);

        // Axis labels
        ctx.fillStyle = colMuted;
        ctx.font = "650 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "bottom";
        ctx.fillText("E_DC (MV/m)", x0 + pw/2, H - 12);

        ctx.save();
        ctx.translate(16, y1 + ph/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = "center";
        ctx.textBaseline = "top";
        ctx.fillText("Normalized efficiency  η/η0  (dimensionless)", 0, 0);
        ctx.restore();

        // Curve: eta = (E/E0)^2
        ctx.lineWidth = 2.2;
        ctx.strokeStyle = colCurve;
        ctx.beginPath();
        const N = 240;
        for(let i=0;i<=N;i++){
          const x = xmin + (xmax-xmin)*i/N;
          const y = Math.pow(x/E0,2);
          const xx = X(x), yy = Y(y);
          if(i===0) ctx.moveTo(xx,yy);
          else ctx.lineTo(xx,yy);
        }
        ctx.stroke();

        // Secondary dashed line: linear scaling (for comparison only, normalized to meet at xmax)
        // This helps learning: show quadratic vs linear, but still a single plot.
        ctx.setLineDash([6,5]);
        ctx.lineWidth = 2;
        ctx.strokeStyle = colCurve2;
        ctx.beginPath();
        for(let i=0;i<=N;i++){
          const x = xmin + (xmax-xmin)*i/N;
          const yLin = (ymax/xmax) * x; // line reaching same top at xmax
          const xx = X(x), yy = Y(yLin);
          if(i===0) ctx.moveTo(xx,yy);
          else ctx.lineTo(xx,yy);
        }
        ctx.stroke();
        ctx.setLineDash([]);

        // Legend
        const lx = x0 + pw*0.62, ly = y1 + 12;
        const lw = Math.min(300, x1 - lx - 6), lh = 52;
        ctx.fillStyle = "rgba(10,16,34,0.55)";
        ctx.strokeStyle = "rgba(255,255,255,0.14)";
        ctx.lineWidth = 1;
        ctx.beginPath();
        roundRect(ctx, lx, ly, lw, lh, 12);
        ctx.fill();
        ctx.stroke();

        ctx.font = "600 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillStyle = colText;
        // item 1
        ctx.strokeStyle = colCurve;
        ctx.lineWidth = 2.2;
        ctx.beginPath();
        ctx.moveTo(lx+14, ly+18);
        ctx.lineTo(lx+48, ly+18);
        ctx.stroke();
        ctx.fillText("η/η0 = (E_DC/E0)² (EFISH prediction)", lx+56, ly+12);

        // item 2
        ctx.strokeStyle = colCurve2;
        ctx.lineWidth = 2;
        ctx.setLineDash([6,5]);
        ctx.beginPath();
        ctx.moveTo(lx+14, ly+38);
        ctx.lineTo(lx+48, ly+38);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = colText;
        ctx.fillText("Linear reference (same endpoint)", lx+56, ly+32);

        // Helper: rounded rectangle path
        function roundRect(c, x, y, w, h, r){
          const rr = Math.min(r, w/2, h/2);
          c.moveTo(x+rr, y);
          c.arcTo(x+w, y, x+w, y+h, rr);
          c.arcTo(x+w, y+h, x, y+h, rr);
          c.arcTo(x, y+h, x, y, rr);
          c.arcTo(x, y, x+w, y, rr);
          c.closePath();
        }
      }

      let raf = 0;
      function schedule(){
        cancelAnimationFrame(raf);
        raf = requestAnimationFrame(draw);
      }
      window.addEventListener('resize', schedule, {passive:true});
      schedule();
    })();
  </script>
</body>
</html>
