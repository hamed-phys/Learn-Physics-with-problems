<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>AWG as a 2×2 Wavelength Router — Routing Conditions via Optical Pathlength Differences</title>
  <style>
    :root{
      --bg:#0b0f16;
      --card:#111827;
      --card2:#0f172a;
      --text:#e5e7eb;
      --muted:#a7b0bf;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius:18px;
      --max: 1150px;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 10% -20%, rgba(125,211,252,.15), transparent 60%),
        radial-gradient(1200px 700px at 110% 10%, rgba(167,139,250,.12), transparent 55%),
        linear-gradient(180deg, #070a10, var(--bg) 40%, #070a10);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:34px 18px 14px;
      border-bottom:1px solid var(--line);
      position:relative;
      overflow:hidden;
    }
    header .wrap{
      max-width:var(--max);
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
      align-items:start;
    }
    h1{
      margin:0;
      font-size: clamp(1.55rem, 1.25rem + 1.2vw, 2.35rem);
      letter-spacing:.2px;
      line-height:1.18;
    }
    .sub{
      margin-top:10px;
      color:var(--muted);
      font-size:1.02rem;
      max-width: 70ch;
    }
    .meta{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:14px 14px 12px;
      box-shadow: var(--shadow);
    }
    .meta strong{color:#fff}
    .meta ul{margin:10px 0 0; padding-left:18px; color:var(--muted)}
    .meta li{margin:6px 0}
    main{
      max-width:var(--max);
      margin:0 auto;
      padding:22px 18px 44px;
      display:grid;
      grid-template-columns: 270px 1fr;
      gap:18px;
      align-items:start;
    }
    nav#toc{
      position:sticky;
      top:14px;
      align-self:start;
      background:linear-gradient(180deg, rgba(17,24,39,.85), rgba(15,23,42,.70));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:12px 12px 10px;
      backdrop-filter: blur(8px);
    }
    nav#toc .title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    nav#toc .title span{
      font-weight:700;
      letter-spacing:.25px;
      font-size:.98rem;
    }
    .tocmini{
      color:var(--muted);
      font-size:.86rem;
    }
    nav#toc ol{
      margin:10px 0 0;
      padding-left:18px;
    }
    nav#toc li{
      margin:7px 0;
      font-size:.95rem;
      color:var(--muted);
    }
    nav#toc a{color:var(--text)}
    nav#toc a .dot{
      display:inline-block; width:8px; height:8px; border-radius:99px; margin-right:8px;
      background:rgba(125,211,252,.35);
      transform:translateY(-1px);
    }
    nav#toc a.active .dot{background:rgba(125,211,252,.95)}
    nav#toc a.active{color:var(--accent)}
    article{min-width:0;}
    section{
      background:linear-gradient(180deg, rgba(17,24,39,.78), rgba(15,23,42,.55));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:18px 18px 16px;
      margin-bottom:16px;
      overflow:hidden;
    }
    section h2{margin:0 0 10px; font-size:1.28rem; letter-spacing:.2px;}
    section h3{margin:16px 0 8px; font-size:1.08rem; color:#fff;}
    p{margin:10px 0; color:var(--text)}
    .muted{color:var(--muted)}
    .grid2{display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-top:10px;}
    .grid3{display:grid; grid-template-columns: 1fr 1fr 1fr; gap:12px; margin-top:10px;}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: 16px;
      padding:12px 12px 10px;
    }
    .callout{
      border-left:4px solid rgba(125,211,252,.9);
      padding:12px 12px 10px;
      background:linear-gradient(180deg, rgba(125,211,252,.12), rgba(125,211,252,.05));
      border-radius: 14px;
      border:1px solid rgba(125,211,252,.25);
      margin:12px 0;
    }
    .callout.warn{
      border-left-color: rgba(251,191,36,.95);
      background:linear-gradient(180deg, rgba(251,191,36,.13), rgba(251,191,36,.05));
      border-color: rgba(251,191,36,.25);
    }
    .callout.good{
      border-left-color: rgba(52,211,153,.95);
      background:linear-gradient(180deg, rgba(52,211,153,.12), rgba(52,211,153,.05));
      border-color: rgba(52,211,153,.25);
    }
    .callout.bad{
      border-left-color: rgba(251,113,133,.95);
      background:linear-gradient(180deg, rgba(251,113,133,.12), rgba(251,113,133,.05));
      border-color: rgba(251,113,133,.25);
    }
    ul,ol{margin:10px 0; padding-left:20px}
    li{margin:6px 0; color:var(--text)}
    .eq{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:.96rem;
      background: rgba(0,0,0,.28);
      border:1px solid var(--line);
      border-radius: 14px;
      padding:10px 10px 9px;
      overflow:auto;
      margin:10px 0 8px;
      position:relative;
      white-space:pre-wrap;
    }
    .eq .label{
      position:absolute;
      top:10px; right:10px;
      font-family:inherit;
      font-size:.78rem;
      color:var(--muted);
      opacity:.85;
    }
    .btnrow{display:flex; flex-wrap:wrap; gap:8px; margin:8px 0 0;}
    button.copy{
      appearance:none;
      border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      color:var(--text);
      border-radius: 12px;
      padding:8px 10px;
      font-weight:650;
      font-size:.92rem;
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    button.copy:hover{transform: translateY(-1px); border-color: rgba(125,211,252,.45)}
    button.copy:active{transform: translateY(0px)}
    .toast{
      position:fixed;
      left:50%;
      bottom:16px;
      transform:translateX(-50%);
      background:rgba(17,24,39,.92);
      border:1px solid var(--line);
      border-radius: 999px;
      padding:10px 14px;
      box-shadow: var(--shadow);
      color:var(--text);
      font-weight:650;
      font-size:.92rem;
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      backdrop-filter: blur(8px);
      z-index:50;
    }
    .toast.show{opacity:1; transform:translateX(-50%) translateY(-2px)}
    details{
      margin:10px 0;
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius: 16px;
      padding:10px 12px 10px;
    }
    summary{
      cursor:pointer;
      font-weight:700;
      color:#fff;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    summary::after{
      content:"▾";
      float:right;
      color:var(--muted);
      transition: transform .15s ease;
    }
    details[open] summary::after{transform: rotate(180deg)}
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:8px;
      font-weight:700;
      color:var(--accent);
    }
    .hr{height:1px; background: var(--line); margin:14px 0;}
    footer{
      max-width:var(--max);
      margin:0 auto;
      padding: 0 18px 30px;
      color:var(--muted);
      font-size:.95rem;
    }
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:999px;
      padding:6px 10px;
      font-size:.86rem;
      color:var(--muted);
    }
    .tag b{color:var(--text)}
    .kpi{display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px;}
    .kpi .card{padding:12px 12px 10px;}
    .kpi .num{font-size:1.15rem; font-weight:800; letter-spacing:.2px; color:#fff;}
    .kpi .desc{color:var(--muted); font-size:.9rem; margin-top:2px}
    @media (max-width: 980px){
      header .wrap{grid-template-columns:1fr}
      main{grid-template-columns:1fr}
      nav#toc{position:relative; top:auto}
      .grid2,.grid3,.kpi{grid-template-columns:1fr}
    }
    @media print{
      :root{
        --bg:#ffffff;
        --card:#ffffff;
        --card2:#ffffff;
        --text:#000000;
        --muted:#222222;
        --line:#cccccc;
      }
      body{background:#fff}
      nav#toc, .toast, button.copy{display:none !important}
      section{box-shadow:none}
      a{color:#000; text-decoration:underline}
      section{break-inside:avoid; page-break-inside:avoid}
      h2{page-break-after:avoid}
    }
  </style>
</head>

<body>
<header id="top">
  <div class="wrap">
    <div>
      <h1>AWG as a 2×2 Wavelength Router: Routing Conditions Using Optical Pathlength Differences</h1>
      <p class="sub">
        We design a 2×2 wavelength router that <em>transposes</em> channels between outputs by imposing
        wavelength-dependent interference conditions in the multipath interferometers connecting each input to each output.
      </p>
      <div class="btnrow" aria-label="Quick actions">
        <span class="tag"><b>Topic:</b> Arrayed Waveguide Gratings (AWGs) / Multipath Interferometers</span>
        <span class="tag"><b>Result:</b> Symbolic routing conditions</span>
      </div>
    </div>

    <aside class="meta" aria-label="Problem statement">
      <strong>Problem (rewritten from prompt)</strong>
      <ul>
        <li>Input port 1 carries two channels: λ1, λ2.</li>
        <li>Input port 2 carries two channels: λ3, λ4.</li>
        <li>Goal (transpose): send λ1 and λ3 → output port 1; send λ2 and λ4 → output port 2.</li>
        <li>Write routing conditions in terms of optical pathlength differences: Δd11, Δd12, Δd21, Δd22.</li>
      </ul>
    </aside>
  </div>
</header>

<main>
  <nav id="toc" aria-label="Table of contents">
    <div class="title">
      <span>Contents</span>
      <span class="tocmini">sticky</span>
    </div>
    <ol>
      <li><a href="#quick" class="toclink"><span class="dot"></span>Quick Summary</a></li>
      <li><a href="#primer" class="toclink"><span class="dot"></span>Part 0 — Concept Primer</a></li>
      <li><a href="#industry" class="toclink"><span class="dot"></span>Part 0B — Industry Perspective</a></li>
      <li><a href="#analysis" class="toclink"><span class="dot"></span>Part 1 — Problem Analysis</a></li>
      <li><a href="#strategy" class="toclink"><span class="dot"></span>Part 2 — Strategy &amp; Tips</a></li>
      <li><a href="#solution" class="toclink"><span class="dot"></span>Part 3 — Full Solution</a></li>
      <li><a href="#deeper" class="toclink"><span class="dot"></span>Part 4 — Deeper Understanding</a></li>
      <li><a href="#plot" class="toclink"><span class="dot"></span>Part 5 — Optional Plot Guide</a></li>
    </ol>
  </nav>

  <article>
    <section id="quick">
      <h2>Quick Summary</h2>
      <ul>
        <li><b>What this is about:</b> A 2×2 AWG/router that directs four wavelength channels to two outputs in a prescribed pattern.</li>
        <li><b>Key physics idea:</b> Wavelength-dependent <em>interference</em>: outputs correspond to different phase conditions of a multipath interferometer.</li>
        <li><b>Governing relation:</b> Phase from an optical pathlength difference Δd is Δφ(λ) = 2π Δd / λ (if Δd is an <em>optical</em> pathlength difference).</li>
        <li><b>Routing principle:</b> “Pass” a wavelength when Δφ is an integer multiple of 2π (constructive); “reject” when it is an odd multiple of π (destructive), giving complementary outputs.</li>
        <li><b>What you will produce:</b> Four conditions—one for each connection (input i → output j)—written as integer/half-integer multiples of the corresponding wavelengths.</li>
        <li><b>Result type:</b> Symbolic constraints (integer design equations) that specify allowable Δd11, Δd12, Δd21, Δd22.</li>
        <li><b>Physical meaning:</b> Each Δd sets a spectral “comb” of transmission peaks; the router is designed so the desired channels land on peaks of the correct output.</li>
        <li><b>Industrial relevance:</b> These conditions are the starting point for WDM switching blocks—then corrected for dispersion, fabrication tolerances, and thermal drift.</li>
      </ul>

      <div class="callout good">
        <b>Key takeaway:</b> Designing the router is fundamentally about choosing <b>optical pathlength differences</b> so that the desired wavelengths experience <b>constructive interference</b> at their target output and <b>destructive interference</b> at the other.
      </div>

      <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
    </section>

    <section id="primer">
      <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

      <h3>0.1 Core definitions (symbols + SI units)</h3>
      <div class="grid2">
        <div class="card">
          <ul>
            <li><b>λ</b>: vacuum wavelength of an optical channel (m).</li>
            <li><b>Δd</b>: <em>optical</em> pathlength difference between adjacent paths in a multipath interferometer (m of OPL).</li>
            <li><b>Δφ(λ)</b>: phase difference induced by Δd at wavelength λ (rad).</li>
            <li><b>m</b>: integer interference order (dimensionless).</li>
          </ul>
        </div>
        <div class="card">
          <ul>
            <li><b>i</b>: input port index (i = 1,2).</li>
            <li><b>j</b>: output port index (j = 1,2).</li>
            <li><b>Δd<sub>ij</sub></b>: optical pathlength difference for the interferometric connection from input i to output j (m of OPL).</li>
          </ul>
        </div>
      </div>

      <details>
        <summary>What does “optical pathlength difference” mean exactly?</summary>
        <p class="muted">
          In waveguides, phase accumulation is set by the propagation constant β(λ) ≈ 2π n<sub>eff</sub>(λ)/λ.
          If two physical paths differ in length by ΔL (m), their <em>optical</em> pathlength difference is approximately
          Δd = n<sub>eff</sub>(λ)·ΔL. Many photonics texts use Δd directly because it is the quantity that appears in the phase.
          In this problem statement, Δd is explicitly called “optical pathlength difference,” so we treat it as already including the refractive-index effect.
        </p>
      </details>

      <h3>0.2 Physical meaning (intuition)</h3>
      <p>
        A multipath interferometer (including AWG-like phased arrays) sums many replicas of the optical field that have
        incremental pathlength differences. The relative phase between paths depends on λ. At certain wavelengths, the
        fields line up (constructive interference) and power exits a particular port. At other wavelengths, the fields
        cancel there and emerge at the other port (complementary response).
      </p>

      <h3>0.3 Governing principle and validity conditions</h3>
      <div class="callout">
        <b>Interference phase law (for optical pathlength difference Δd):</b>
        <div class="eq" id="eq-phase"><span class="label">Eq. (1)</span>
Δφ(λ) = 2π · Δd / λ</div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq-phase">Copy Eq. (1)</button>
        </div>
      </div>

      <p>For an interferometric output to be a <em>pass</em> at λ, we typically impose:</p>
      <div class="eq" id="eq-constructive"><span class="label">Eq. (2)</span>
Constructive (peak): Δφ(λ) = 2π m  ⇔  Δd = m λ</div>
      <div class="eq" id="eq-destructive"><span class="label">Eq. (3)</span>
Destructive (null): Δφ(λ) = (2m+1)π  ⇔  Δd = (m + 1/2) λ</div>
      <div class="btnrow">
        <button class="copy" data-copy-target="eq-constructive">Copy Eq. (2)</button>
        <button class="copy" data-copy-target="eq-destructive">Copy Eq. (3)</button>
      </div>

      <div class="callout warn">
        <b>Validity / assumptions behind these clean conditions:</b>
        <ul>
          <li>We treat Δd as an <em>effective optical</em> pathlength difference (index already accounted for).</li>
          <li>We assume coherent interference and stable phases (no rapid phase noise across the array).</li>
          <li>We assume the two outputs are complementary (typical for balanced coupler-based combining) so “peak vs null” is meaningful.</li>
          <li>We ignore detailed amplitude apodization, diffraction, and phase errors—appropriate for a first-pass routing condition.</li>
        </ul>
      </div>

      <h3>0.4 Common models/approximations and why used</h3>
      <ul>
        <li><b>Ideal phase-only design:</b> pick Δd to place wavelengths on constructive/destructive points. Used for initial architecture.</li>
        <li><b>Linearized dispersion (engineering refinement):</b> replace 2πΔd/λ by β(λ)ΔL and expand β(λ) around a center wavelength to predict channel spacing and FSR.</li>
        <li><b>Complementary outputs assumption:</b> in a 2×2 router, often realized by a symmetric combiner so one port gets cos² response and the other sin².</li>
      </ul>

      <h3>0.5 Mini intuition examples (minimal algebra)</h3>
      <div class="grid3">
        <div class="card"><b>Example A (one peak)</b><p class="muted">If Δd = mλ, then each path adds in phase → maximum at that output.</p></div>
        <div class="card"><b>Example B (one null)</b><p class="muted">If Δd = (m+1/2)λ, adjacent paths differ by π → cancellation → minimum.</p></div>
        <div class="card"><b>Example C (routing)</b><p class="muted">Choose Δd so λ1 lands on a peak at output 1 while λ2 lands on a null there (hence peak at output 2).</p></div>
      </div>

      <h3>0.6 What to watch for (pitfalls)</h3>
      <div class="callout bad">
        <b>Pitfalls &amp; sign conventions:</b>
        <ul>
          <li><b>Δd vs ΔL:</b> do not confuse physical length difference with optical pathlength difference.</li>
          <li><b>Integer ambiguity:</b> many integer orders m satisfy the same condition; practical designs choose m to fit footprint and FSR constraints.</li>
          <li><b>Dispersion:</b> if n<sub>eff</sub>(λ) varies significantly, peak locations shift; real AWGs must account for this.</li>
          <li><b>Thermal drift:</b> Δd changes with temperature (thermo-optic + thermal expansion), shifting routing.</li>
        </ul>
      </div>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="industry">
      <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>
      <h3>Why this matters in real engineering</h3>
      <p>
        A 2×2 wavelength router is a minimal building block for wavelength-division multiplexing (WDM) systems. In industry,
        the “physics homework” design equations become the first step in meeting product requirements:
        insertion loss budgets, crosstalk specs, temperature range, yield, and manufacturability.
      </p>

      <h3>Where it appears (concrete applications)</h3>
      <div class="grid2">
        <div class="card"><b>1) Datacenter interconnects (DWDM/CWDM)</b><p class="muted">Channel routing and add/drop functions in PICs for fiber links and co-packaged optics.</p></div>
        <div class="card"><b>2) Metro/long-haul telecom</b><p class="muted">AWG-based multiplexers/routers for wavelength management in reconfigurable networks.</p></div>
      </div>
      <div class="grid2">
        <div class="card"><b>3) Sensing and instrumentation</b><p class="muted">Spectral slicing and channel selection in interrogators (FBG arrays, spectroscopy subsystems).</p></div>
        <div class="card"><b>4) Test &amp; measurement</b><p class="muted">On-chip wavelength demux blocks used in lab validation of lasers, modulators, and filters.</p></div>
      </div>

      <h3>Why engineers care (performance &amp; constraints)</h3>
      <div class="kpi">
        <div class="card"><div class="num">Low crosstalk</div><div class="desc">Wrong wavelength at wrong port must be suppressed (often &lt; −20 to −30 dB).</div></div>
        <div class="card"><div class="num">Low insertion loss</div><div class="desc">Each dB affects link margin, power, and ultimately cost and thermal headroom.</div></div>
        <div class="card"><div class="num">High yield</div><div class="desc">Δd depends on lithography/etch control; sensitivity drives wafer-to-wafer variability.</div></div>
        <div class="card"><div class="num">Thermal stability</div><div class="desc">Routing must remain correct across the specified operating temperature range.</div></div>
      </div>

      <h3>Typical measurement/validation methods</h3>
      <ul>
        <li><b>Swept-laser transmission</b> to map spectra of each output (peaks, nulls, passband shape).</li>
        <li><b>Optical spectrum analyzer (OSA)</b> to check channel isolation and insertion loss across wavelengths.</li>
        <li><b>Wafer-level test</b> using grating couplers/edge couplers and automated probing to estimate yield distribution of peak wavelengths.</li>
        <li><b>Thermal characterization</b> to measure wavelength shift vs temperature (nm/°C), informing control loops/heaters.</li>
      </ul>

      <h3>Design trade-offs (real materials, tolerances, non-idealities)</h3>
      <ul>
        <li><b>Large Δd</b> increases spectral selectivity but often reduces FSR and increases footprint (and phase-error sensitivity).</li>
        <li><b>Small Δd</b> improves FSR but can broaden peaks and worsen channel isolation.</li>
        <li><b>Index dispersion &amp; fabrication</b> shift the effective Δd; designers often include trims (heaters) or calibrate channel grids.</li>
      </ul>

      <details>
        <summary>From lab to product: adapting the idealized model</summary>
        <p class="muted">
          In a real AWG/router, the “integer multiples of λ” design is translated into geometry using
          n<sub>eff</sub>(λ) and group index n<sub>g</sub>, then verified by full-wave/beam-propagation simulation,
          then corrected for systematic fabrication biases (linewidth, etch depth). A final product often includes
          thermal tuning elements to align peaks to the ITU channel grid and compensate environmental drift.
        </p>
      </details>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="analysis">
      <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

      <h3>1.1 Restate the problem in plain language</h3>
      <p>
        We have two inputs and two outputs. Each input carries two wavelength channels. We want the device to route
        wavelengths so that output 1 receives the “first” channel from each input (λ1 from input 1 and λ3 from input 2),
        while output 2 receives the “second” channel from each input (λ2 from input 1 and λ4 from input 2).
        The router is implemented by interferometric paths characterized by optical pathlength differences Δd<sub>ij</sub>.
        We must express the routing requirements as phase/pathlength conditions on these Δd<sub>ij</sub>.
      </p>

      <h3>1.2 Given, unknowns, and target</h3>
      <div class="grid2">
        <div class="card">
          <b>Given</b>
          <ul>
            <li>Four wavelengths: λ1, λ2 at input 1; λ3, λ4 at input 2.</li>
            <li>Two outputs: port 1 and port 2.</li>
            <li>Four interferometric connections with optical pathlength differences: Δd11, Δd12, Δd21, Δd22.</li>
          </ul>
        </div>
        <div class="card">
          <b>Unknowns / what we must write</b>
          <ul>
            <li>Routing (interference) conditions that Δd11, Δd12, Δd21, Δd22 must satisfy.</li>
            <li>Conditions must ensure desired wavelengths are constructive at their intended output and suppressed at the other.</li>
          </ul>
        </div>
      </div>

      <h3>1.3 Relevant principles and why they apply</h3>
      <ul>
        <li><b>Interference phase condition</b> (Δφ = 2πΔd/λ): because the device is a multipath interferometer (AWG-like behavior).</li>
        <li><b>Constructive vs destructive routing</b>: because a 2×2 device can be designed so one output is a peak when the other is a null (complementary transfer).</li>
      </ul>
      <p class="muted">
        We do not need electromagnetic field solvers here because the question asks only for the <em>routing conditions</em> in terms of Δd<sub>ij</sub>,
        which are the standard phase-quantization constraints.
      </p>

      <div class="callout warn">
        <b>Assumptions (explicit):</b>
        <ul>
          <li>Δd<sub>ij</sub> are <em>optical</em> pathlength differences (already include effective index effects).</li>
          <li>Each input-to-output connection behaves like an interferometric transfer with well-defined constructive/null conditions.</li>
          <li>We use ideal conditions (exact peaks/nulls) to express routing; practical designs allow finite crosstalk.</li>
        </ul>
      </div>

      <h3>1.4 Possible approaches (compare)</h3>
      <div class="grid3">
        <div class="card"><b>Approach A: Direct phase quantization</b><p class="muted">Impose Δφ(λ) = 2πm for pass and (2m+1)π for reject. Fast, symbolic, matches what problem asks.</p></div>
        <div class="card"><b>Approach B: FSR/channel-spacing method</b><p class="muted">Use FSR ≈ λ²/Δd and require channel separation equals half-period for complementary ports. Useful if channel spacing is specified.</p></div>
        <div class="card"><b>Approach C: Full AWG grating equation</b><p class="muted">Relate array order and free propagation region geometry. Overkill here because the question is only in terms of Δd<sub>ij</sub>.</p></div>
      </div>

      <p><b>Best choice:</b> Approach A, because the question explicitly requests routing conditions <em>in terms of</em> Δd<sub>ij</sub>.</p>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="strategy">
      <h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

      <ol>
        <li><b>Define the phase law</b>: write Δφ(λ)=2πΔd/λ and identify how “pass” and “reject” map to phase values.</li>
        <li><b>Translate routing targets into pass/reject statements</b>: e.g., input 1: λ1 must pass to output 1 and reject at output 2.</li>
        <li><b>Write pass conditions</b>: for each desired mapping, set Δd<sub>ij</sub> = m·λ (integer m).</li>
        <li><b>Write reject conditions</b>: for each undesired mapping, set Δd<sub>ij</sub> = (m+1/2)·λ (half-integer multiple).</li>
        <li><b>Group into four interferometers</b>: (1→1), (1→2), (2→1), (2→2), each with its own Δd<sub>ij</sub>.</li>
        <li><b>Sanity-check complementarity</b>: ensure each Δd<sub>ij</sub> gives a peak at the intended wavelength and a null at the other wavelength from the same input.</li>
      </ol>

      <div class="callout bad">
        <b>Common mistakes (quick tips):</b>
        <ul>
          <li>Mixing up which wavelengths belong to which input port (input 1: λ1, λ2; input 2: λ3, λ4).</li>
          <li>Forgetting that integer orders can differ for different links (m<sub>11</sub>, m<sub>12</sub>, … are independent integers).</li>
          <li>Confusing “optical pathlength difference” with “physical length difference.”</li>
          <li>Not enforcing complementary behavior (peak at one output should correspond to null at the other for the same input/wavelength set).</li>
        </ul>
      </div>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="solution">
      <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

      <h3>3.1 Qualitative expectation (before equations)</h3>
      <p>
        For each input, we want its two wavelengths to split: one to output 1 and the other to output 2.
        Interferometric devices naturally produce alternating maxima/minima versus wavelength. So we will choose
        each Δd<sub>ij</sub> such that the <em>desired</em> wavelength lands on a constructive point for that output, while the
        <em>other</em> wavelength from the same input lands on a destructive point for that output (and therefore appears at the other output).
      </p>

      <div class="callout">
        <b>Phase model used throughout:</b>
        <div class="eq" id="eq-model">Δφ(λ) = 2π · Δd / λ,  where Δd is the optical pathlength difference</div>
        <div class="btnrow"><button class="copy" data-copy-target="eq-model">Copy phase model</button></div>
      </div>

      <h3>3.2 Define “pass” and “reject” conditions</h3>
      <p>We adopt the standard ideal interference conditions:</p>
      <div class="grid2">
        <div class="card">
          <b>Pass (constructive)</b>
          <div class="eq" id="eq-pass">Δφ(λ) = 2π m  ⇔  Δd = m λ,  m ∈ ℤ</div>
          <div class="btnrow"><button class="copy" data-copy-target="eq-pass">Copy pass condition</button></div>
        </div>
        <div class="card">
          <b>Reject (destructive)</b>
          <div class="eq" id="eq-reject">Δφ(λ) = (2m+1)π  ⇔  Δd = (m + 1/2) λ,  m ∈ ℤ</div>
          <div class="btnrow"><button class="copy" data-copy-target="eq-reject">Copy reject condition</button></div>
        </div>
      </div>

      <details>
        <summary>Why is “reject” a half-integer multiple of λ?</summary>
        <p class="muted">
          If adjacent paths differ by π (instead of 2π), their phasors oppose each other. In a symmetric combiner, this produces
          cancellation at one output and enhancement at the complementary output.
        </p>
      </details>

      <h3>3.3 Apply to the required routing</h3>
      <div class="eq" id="eq-map">Input 1: λ1 → Output 1,  λ2 → Output 2
Input 2: λ3 → Output 1,  λ4 → Output 2</div>
      <div class="btnrow"><button class="copy" data-copy-target="eq-map">Copy routing target</button></div>

      <h3>3.3.1 Interferometer (Input 1 → Output 1): Δd11</h3>
      <p>Want output 1 to <b>pass λ1</b> and <b>reject λ2</b> (from input 1).</p>
      <div class="eq" id="eq-d11">Δd11 = m11 · λ1   (constructive at λ1)
Δd11 = (k11 + 1/2) · λ2   (destructive at λ2)
where m11, k11 ∈ ℤ</div>
      <div class="btnrow"><button class="copy" data-copy-target="eq-d11">Copy Δd11 conditions</button></div>

      <h3>3.3.2 Interferometer (Input 1 → Output 2): Δd12</h3>
      <p>For output 2: <b>pass λ2</b>, <b>reject λ1</b>.</p>
      <div class="eq" id="eq-d12">Δd12 = m12 · λ2   (constructive at λ2)
Δd12 = (k12 + 1/2) · λ1   (destructive at λ1)
where m12, k12 ∈ ℤ</div>
      <div class="btnrow"><button class="copy" data-copy-target="eq-d12">Copy Δd12 conditions</button></div>

      <h3>3.3.3 Interferometer (Input 2 → Output 1): Δd21</h3>
      <p>For input 2 at output 1: <b>pass λ3</b>, <b>reject λ4</b>.</p>
      <div class="eq" id="eq-d21">Δd21 = m21 · λ3   (constructive at λ3)
Δd21 = (k21 + 1/2) · λ4   (destructive at λ4)
where m21, k21 ∈ ℤ</div>
      <div class="btnrow"><button class="copy" data-copy-target="eq-d21">Copy Δd21 conditions</button></div>

      <h3>3.3.4 Interferometer (Input 2 → Output 2): Δd22</h3>
      <p>For input 2 at output 2: <b>pass λ4</b>, <b>reject λ3</b>.</p>
      <div class="eq" id="eq-d22">Δd22 = m22 · λ4   (constructive at λ4)
Δd22 = (k22 + 1/2) · λ3   (destructive at λ3)
where m22, k22 ∈ ℤ</div>
      <div class="btnrow"><button class="copy" data-copy-target="eq-d22">Copy Δd22 conditions</button></div>

      <div class="hr"></div>

      <h3>3.4 Final answer (boxed)</h3>
      <div class="callout good">
        <b>Final routing conditions (ideal interference design):</b>
        <div class="eq" id="eq-final">For output port 1:
  Δd11 = m11·λ1  and  Δd11 = (k11 + 1/2)·λ2
  Δd21 = m21·λ3  and  Δd21 = (k21 + 1/2)·λ4

For output port 2:
  Δd12 = m12·λ2  and  Δd12 = (k12 + 1/2)·λ1
  Δd22 = m22·λ4  and  Δd22 = (k22 + 1/2)·λ3

with m11,m12,m21,m22,k11,k12,k21,k22 ∈ ℤ, and Δφ(λ)=2πΔd/λ.</div>
        <div class="btnrow"><button class="copy" data-copy-target="eq-final">Copy final answer</button></div>
      </div>

      <h3>3.5 Sanity checks</h3>
      <div class="grid2">
        <div class="card">
          <b>Units / dimensions</b>
          <ul>
            <li>Δd has units of length (m).</li>
            <li>Right-hand sides are multiples of λ (m). ✔</li>
            <li>Δφ(λ)=2πΔd/λ is dimensionless (rad). ✔</li>
          </ul>
        </div>
        <div class="card">
          <b>Limiting / consistency reasoning</b>
          <ul>
            <li>If Δd grows, spectral features become more rapidly varying vs λ (denser peaks). ✔</li>
            <li>Switching between outputs corresponds to shifting phase by π (half-wavelength in OPL). ✔</li>
          </ul>
        </div>
      </div>

      <details>
        <summary>Engineering note: feasibility and integer choices</summary>
        <p class="muted">
          Because the conditions equate the same Δd to multiples of different wavelengths (e.g., m11·λ1 = (k11+1/2)·λ2),
          exact satisfaction depends on wavelength ratios. In practice, designers pick Δd to satisfy the conditions
          approximately within acceptable crosstalk, leveraging finite passband width, then use trimming (thermal tuning).
        </p>
      </details>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="deeper">
      <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

      <h3>4.1 Re-interpret the final constraints</h3>
      <p>
        Each Δd<sub>ij</sub> defines a periodic spectral response: wavelengths for which Δd<sub>ij</sub>/λ is an integer produce constructive interference.
        The router is designed so that output 1 passes {λ1, λ3} and rejects {λ2, λ4}, while output 2 does the opposite.
      </p>

      <h3>4.2 Parameter dependence (qualitative)</h3>
      <div class="grid2">
        <div class="card">
          <b>Effect of increasing Δd</b>
          <p class="muted">
            More rapid phase change with wavelength: peaks are closer in λ (smaller effective period). Helps selectivity but
            increases sensitivity to fabrication and temperature.
          </p>
        </div>
        <div class="card">
          <b>Effect of wavelength spacing</b>
          <p class="muted">
            Closer wavelengths require larger Δd (or accept less isolation) to place one on a peak and the other on a null.
          </p>
        </div>
      </div>

      <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
      <p>
        Engineers often impose a π phase difference between two channels to swap complementary outputs:
      </p>
      <div class="eq" id="eq-alt">Δφ(λa) − Δφ(λb) ≈ π
2πΔd(1/λa − 1/λb) ≈ π
Δd ≈ 1 / (2(1/λa − 1/λb))</div>
      <div class="btnrow"><button class="copy" data-copy-target="eq-alt">Copy alternative idea</button></div>

      <h3>4.4 Concept check (self-test with answers)</h3>
      <ul>
        <li><b>Q:</b> What does Δd control? <b>A:</b> The wavelength-dependent phase difference and thus peak/null locations.</li>
        <li><b>Q:</b> Why half-integer multiples for a null? <b>A:</b> They impose an odd-π phase mismatch causing cancellation.</li>
        <li><b>Q:</b> Are the integers unique? <b>A:</b> No; many orders satisfy constraints; choose based on footprint/FSR/tolerance.</li>
        <li><b>Q:</b> Biggest practical issues? <b>A:</b> Dispersion, fabrication phase errors, and temperature drift.</li>
      </ul>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="plot">
      <h2>PART 5 — Optional Plot Guide</h2>
      <p class="muted">
        A plot is not necessary because the problem is symbolic: it asks for interference routing conditions (integer/half-integer constraints),
        not numerical spectra. Real designs would plot transmission vs wavelength using device-specific parameters, which are not provided.
      </p>
      <a class="backtop" href="#top">↑ Back to top</a>
    </section>
  </article>
</main>

<footer>
  <div class="hr"></div>
  <p>
    <b>Notation note:</b> Δd<sub>ij</sub> is treated as an <em>optical</em> pathlength difference (index already included), matching the problem wording.
    If using physical length difference ΔL, use Δφ(λ)=β(λ)ΔL with β(λ)=2πn<sub>eff</sub>(λ)/λ.
  </p>
  <p class="muted">Print mode hides the TOC and copy buttons.</p>
</footer>

<div class="toast" id="toast" role="status" aria-live="polite">Copied</div>

<script>
  (function(){
    const toast = document.getElementById('toast');

    function showToast(msg){
      toast.textContent = msg || "Copied";
      toast.classList.add('show');
      window.clearTimeout(showToast._t);
      showToast._t = window.setTimeout(()=>toast.classList.remove('show'), 1200);
    }

    function getPlainTextFromEl(el){
      let t = el.innerText || el.textContent || "";
      t = t.replace(/\bEq\.\s*\(\d+\)\s*/g, "").trim();
      return t;
    }

    document.querySelectorAll('button.copy').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const id = btn.getAttribute('data-copy-target');
        const el = document.getElementById(id);
        if(!el){ showToast("Nothing to copy"); return; }
        const text = getPlainTextFromEl(el);
        try{
          await navigator.clipboard.writeText(text);
          showToast("Copied to clipboard");
        }catch(e){
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position='fixed';
          ta.style.left='-9999px';
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand('copy'); showToast("Copied"); }
          catch(err){ showToast("Copy failed"); }
          document.body.removeChild(ta);
        }
      });
    });

    const links = Array.from(document.querySelectorAll('.toclink'));
    const sections = links.map(a => document.querySelector(a.getAttribute('href'))).filter(Boolean);

    function onScroll(){
      const y = window.scrollY || document.documentElement.scrollTop;
      let bestIndex = 0;
      for(let i=0;i<sections.length;i++){
        const s = sections[i];
        const top = s.getBoundingClientRect().top + y;
        if(y + 140 >= top) bestIndex = i;
      }
      links.forEach((a,i)=>a.classList.toggle('active', i===bestIndex));
    }
    window.addEventListener('scroll', onScroll, {passive:true});
    onScroll();
  })();
</script>
</body>
</html>
