<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Electromagnetic Gaussian Wave Packet in Free Space (E and B Fields)</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#101a33;
      --card2:#0f1730;
      --text:#e9eefc;
      --muted:#b9c5ee;
      --accent:#7aa8ff;
      --accent2:#7dffcf;
      --warn:#ffd37a;
      --ok:#9cff7a;
      --danger:#ff7aa2;
      --line:rgba(255,255,255,.12);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:26px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background: radial-gradient(1200px 700px at 15% 10%, rgba(122,168,255,.18), transparent 60%),
                  radial-gradient(1000px 600px at 85% 15%, rgba(125,255,207,.12), transparent 55%),
                  radial-gradient(900px 700px at 60% 90%, rgba(255,122,162,.10), transparent 60%),
                  var(--bg);
      color:var(--text);
      font-family:var(--sans);
      line-height:1.55;
    }
    a{color:var(--accent)}
    header{
      padding:28px 18px 14px;
      max-width:1100px;
      margin:0 auto;
    }
    .title{
      display:flex; gap:14px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap;
    }
    h1{
      margin:0;
      font-size: clamp(1.35rem, 2.2vw + 1rem, 2.4rem);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:6px 0 0;
      color:var(--muted);
      max-width:72ch;
    }

    .layout{
      max-width:1100px;
      margin:0 auto;
      padding: 0 18px 56px;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns: 1fr}
    }

    .toc{
      position: sticky;
      top: 14px;
      background: linear-gradient(180deg, rgba(16,26,51,.92), rgba(16,26,51,.78));
      border:1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding:14px;
      backdrop-filter: blur(10px);
    }
    .toc h2{
      font-size: .95rem;
      margin:0 0 10px;
      color:var(--muted);
      letter-spacing:.25px;
      text-transform:uppercase;
    }
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      text-decoration:none;
      color:var(--text);
      border:1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size:.96rem;
    }
    .toc a:hover{
      background: rgba(122,168,255,.10);
      border-color: rgba(122,168,255,.25);
      transform: translateX(2px);
    }
    .toc .mini{
      margin-top:10px;
      padding-top:10px;
      border-top:1px dashed var(--line);
      color:var(--muted);
      font-size:.92rem;
    }

    main{
      display:flex;
      flex-direction:column;
      gap:18px;
      min-width:0;
    }
    section, article{
      background: linear-gradient(180deg, rgba(16,26,51,.88), rgba(15,23,48,.78));
      border:1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding:18px 18px;
      backdrop-filter: blur(10px);
      min-width:0;
    }
    section h2, article h2{
      margin:0 0 10px;
      font-size:1.25rem;
      letter-spacing:.15px;
    }
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
    }
    @media (max-width: 900px){
      .grid2{grid-template-columns: 1fr}
    }

    .callouts{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:14px;
      align-items:stretch;
    }
    @media (max-width: 900px){
      .callouts{grid-template-columns:1fr}
    }

    .card{
      background: rgba(0,0,0,.18);
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:14px;
      overflow:hidden;
    }
    .card h3{
      margin:0 0 8px;
      font-size:1.05rem;
      color:var(--muted);
      letter-spacing:.2px;
    }
    ul{margin:8px 0 0 18px}
    li{margin:6px 0}
    .eq{
      font-family: var(--mono);
      background: rgba(122,168,255,.12);
      border:1px solid rgba(122,168,255,.22);
      padding:10px 10px;
      border-radius:14px;
      overflow:auto;
      white-space:nowrap;
    }
    .eq small{color:var(--muted)}
    .btnrow{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px;
    }
    button.copy{
      appearance:none;
      border:none;
      background: linear-gradient(180deg, rgba(122,168,255,.95), rgba(122,168,255,.75));
      color:#071026;
      font-weight:700;
      padding:9px 12px;
      border-radius: 14px;
      cursor:pointer;
      box-shadow: 0 10px 18px rgba(122,168,255,.18);
      transition: transform .12s ease, filter .12s ease;
    }
    button.copy:hover{transform: translateY(-1px); filter:saturate(1.1)}
    button.copy:active{transform: translateY(0px); filter:saturate(1.0)}
    .pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.16);
      color:var(--muted);
      font-size:.92rem;
    }
    .badge{
      font-family:var(--mono);
      font-size:.9rem;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--text);
    }

    .vizWrap{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
      align-items:stretch;
    }
    @media (max-width: 950px){ .vizWrap{grid-template-columns:1fr} }

    figure{
      margin:0;
      background: rgba(0,0,0,.16);
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:12px;
      overflow:hidden;
    }
    figcaption{
      margin-top:10px;
      color:var(--muted);
      font-size:.92rem;
    }

    canvas{
      width:100%;
      height:310px;
      display:block;
      border-radius: 14px;
      background: rgba(8,12,24,.55);
      border:1px solid rgba(255,255,255,.08);
    }
    .controls{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:10px;
    }
    @media (max-width: 760px){ .controls{grid-template-columns:1fr} }
    .control{
      background: rgba(0,0,0,.14);
      border:1px solid var(--line);
      border-radius: 16px;
      padding:12px;
    }
    .control label{
      display:flex;
      justify-content:space-between;
      gap:10px;
      color:var(--muted);
      font-size:.95rem;
      margin-bottom:8px;
    }
    input[type="range"]{ width:100%;}
    .help{
      color:var(--muted);
      font-size:.92rem;
      margin-top:8px;
    }

    .final{
      border:1px solid rgba(125,255,207,.35);
      background: linear-gradient(180deg, rgba(125,255,207,.12), rgba(0,0,0,.14));
      border-radius: var(--radius);
      padding:14px;
    }
    .final h3{
      margin:0 0 8px;
      color: var(--accent2);
      letter-spacing:.2px;
    }
    .check{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    @media (max-width: 900px){ .check{grid-template-columns:1fr} }
    .check .item{
      padding:12px;
      border-radius:16px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.12);
    }
    .check .item strong{display:block; margin-bottom:6px}
    footer{
      max-width:1100px;
      margin: 0 auto;
      padding: 0 18px 30px;
      color: var(--muted);
      font-size: .92rem;
    }

    /* Print-friendly */
    @media print{
      :root{ --bg:#fff; --text:#000; --muted:#333; --card:#fff; --card2:#fff; --line:#ddd; }
      body{ background:#fff; }
      .toc{ display:none; }
      section, article, figure{ box-shadow:none; backdrop-filter:none; }
      button.copy{ display:none; }
      canvas{ border:1px solid #ccc; background:#fff; }
    }

    /* Subtle entrance animation */
    @keyframes rise {
      from{opacity:0; transform: translateY(6px);}
      to{opacity:1; transform: translateY(0);}
    }
    section, article, .toc{ animation: rise .35s ease both; }
  </style>
</head>

<body>
<header>
  <div class="title">
    <div>
      <h1>Electromagnetic Gaussian Wave Packet in Free Space</h1>
      <p class="subtitle">
        Given an electric field of the form <span class="badge">E = f(t - z/c‚ÇÄ) xÃÇ</span> with
        <span class="badge">f(t)=exp(-t¬≤/œÑ¬≤)¬∑exp(j2œÄŒΩ‚ÇÄt)</span>, we identify the wave‚Äôs physical nature and derive the magnetic field.
      </p>
    </div>
    <div class="pill" title="Key idea">
      <span aria-hidden="true">üß≠</span>
      Plane wave, +z propagation, transverse fields
    </div>
  </div>
</header>

<div class="layout">
  <nav class="toc" aria-label="Table of contents">
    <h2>Contents</h2>
    <a href="#quick" data-scroll>Quick Summary</a>
    <a href="#part1" data-scroll>Part 1 ‚Äî Problem Analysis</a>
    <a href="#part2" data-scroll>Part 2 ‚Äî Strategy &amp; Tips</a>
    <a href="#part3" data-scroll>Part 3 ‚Äî Full Solution</a>
    <a href="#viz" data-scroll>Interactive Visualizations</a>
    <div class="mini">
      Tip: Use the sliders to see how the pulse width (œÑ) and carrier frequency (ŒΩ‚ÇÄ) affect both the time waveform and spectrum.
    </div>
  </nav>

  <main>
    <section id="quick">
      <h2>Quick Summary</h2>
      <div class="callouts">
        <div class="card">
          <h3>What this field represents</h3>
          <ul>
            <li><strong>Plane wave</strong> traveling in the <strong>+z</strong> direction because it depends on <span class="badge">t ‚àí z/c‚ÇÄ</span>.</li>
            <li><strong>Linear polarization</strong> along <strong>xÃÇ</strong> (electric field is transverse).</li>
            <li><strong>Gaussian-modulated carrier</strong>: a short pulse (envelope width set by <span class="badge">œÑ</span>) with carrier frequency <span class="badge">ŒΩ‚ÇÄ</span>.</li>
            <li>In free space: <span class="badge">B</span> is transverse, orthogonal to <span class="badge">E</span> and propagation direction; magnitudes satisfy <span class="badge">|E| = c‚ÇÄ|B|</span>.</li>
          </ul>
        </div>
        <div class="card final">
          <h3>Final Field Relation (Free Space)</h3>
          <div class="eq" id="eq-final">
B(z,t) = (1/c‚ÇÄ) (kÃÇ √ó E)  with kÃÇ = zÃÇ  ‚áí  B(z,t) = (1/c‚ÇÄ) f(t ‚àí z/c‚ÇÄ) yÃÇ
H(z,t) = (1/Œ∑‚ÇÄ) f(t ‚àí z/c‚ÇÄ) yÃÇ,   where Œ∑‚ÇÄ = ‚àö(Œº‚ÇÄ/Œµ‚ÇÄ)
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-final">Copy final answer</button>
            <span class="pill"><span aria-hidden="true">‚úÖ</span> Transverse &amp; right-handed</span>
          </div>
        </div>
      </div>
    </section>

    <article id="part1">
      <h2>PART 1 ‚Äî Problem Analysis (no solving yet)</h2>

      <div class="card">
        <h3>Restate the problem (in my own words)</h3>
        <p>
          You are given an electric field in free space:
          <span class="badge">E(z,t) = f(t ‚àí z/c‚ÇÄ) xÃÇ</span>,
          where <span class="badge">f(t)=e^{-t¬≤/œÑ¬≤} e^{j2œÄŒΩ‚ÇÄt}</span>.
          Describe what kind of electromagnetic wave this is (direction, polarization, pulse nature),
          and find the corresponding magnetic-field vector that is consistent with Maxwell‚Äôs equations in vacuum.
        </p>
      </div>

      <div class="grid2">
        <div class="card">
          <h3>Given quantities</h3>
          <ul>
            <li>Wave is in <strong>free space</strong> (vacuum): constants <span class="badge">Œµ‚ÇÄ</span>, <span class="badge">Œº‚ÇÄ</span>, speed <span class="badge">c‚ÇÄ = 1/‚àö(Œº‚ÇÄŒµ‚ÇÄ)</span>.</li>
            <li>Electric field:
              <div class="eq" id="eq-given">
E(z,t) = f(t ‚àí z/c‚ÇÄ) xÃÇ
f(t) = exp(‚àít¬≤/œÑ¬≤) ¬∑ exp(j2œÄŒΩ‚ÇÄ t)
              </div>
              <div class="btnrow">
                <button class="copy" data-copy-target="eq-given">Copy given field</button>
              </div>
            </li>
            <li><span class="badge">œÑ</span> is a constant setting pulse duration; <span class="badge">ŒΩ‚ÇÄ</span> is the carrier frequency.</li>
          </ul>
        </div>

        <div class="card">
          <h3>Unknowns</h3>
          <ul>
            <li>Physical description: propagation direction, polarization, waveform type (pulse vs continuous), bandwidth intuition.</li>
            <li>Magnetic field vector (either <span class="badge">B</span> or <span class="badge">H</span>, but ‚Äúmagnetic-field vector‚Äù often means <span class="badge">B</span>).</li>
          </ul>

          <h3 style="margin-top:14px;">What must be found</h3>
          <ul>
            <li>Nature of the wave (plane wave / wave packet).</li>
            <li>Expression for <span class="badge">B(z,t)</span> consistent with vacuum Maxwell equations.</li>
          </ul>
        </div>
      </div>

      <div class="card">
        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>Wave propagation form</strong>: A field depending on <span class="badge">t ‚àí z/c‚ÇÄ</span> is a traveling wave moving in <strong>+z</strong> at speed <span class="badge">c‚ÇÄ</span>.</li>
          <li><strong>Maxwell‚ÄìFaraday law</strong>:
            <span class="badge">‚àá√óE = ‚àí‚àÇB/‚àÇt</span>.
            It links spatial variation of <span class="badge">E</span> to time variation of <span class="badge">B</span>.</li>
          <li><strong>Maxwell‚ÄìAmp√®re law in vacuum</strong>:
            <span class="badge">‚àá√óB = Œº‚ÇÄŒµ‚ÇÄ ‚àÇE/‚àÇt</span>.
            It links spatial variation of <span class="badge">B</span> to time variation of <span class="badge">E</span>.</li>
          <li><strong>Plane-wave orthogonality</strong> in free space:
            <span class="badge">E ‚üÇ B ‚üÇ k</span> and <span class="badge">|E| = c‚ÇÄ|B|</span>.</li>
        </ul>
      </div>

      <div class="card">
        <h3>Possible approaches (compare 2‚Äì3)</h3>
        <ul>
          <li><strong>Approach A: Use plane-wave field relations</strong><br/>
            For a vacuum plane wave: <span class="badge">B = (1/c‚ÇÄ)(kÃÇ√óE)</span> and <span class="badge">H=(1/Œ∑‚ÇÄ)(kÃÇ√óE)</span>.
            Fast and conceptually direct if we correctly identify <span class="badge">kÃÇ</span>.</li>
          <li><strong>Approach B: Derive from Maxwell curl equations</strong><br/>
            Compute <span class="badge">‚àá√óE</span>, integrate for <span class="badge">B</span>, then verify with <span class="badge">‚àá√óB</span>.
            More algebra, but shows the physics explicitly.</li>
          <li><strong>Approach C: Use phasor/complex representation</strong><br/>
            Treat <span class="badge">e^{j2œÄŒΩ‚ÇÄt}</span> as a complex carrier and take real part at the end.
            Useful for interpretation; must be careful because the envelope is time-dependent (not a single-frequency phasor).</li>
        </ul>
        <p class="help">
          <strong>Best choice:</strong> Combine A + a short B-style verification.
          The field‚Äôs dependence <span class="badge">t ‚àí z/c‚ÇÄ</span> is the hallmark of a plane wave in +z,
          so the cross-product relation gives <span class="badge">B</span> immediately, and a curl check ensures correctness.
        </p>
      </div>
    </article>

    <article id="part2">
      <h2>PART 2 ‚Äî Strategy &amp; Tips (roadmap only)</h2>

      <div class="card">
        <h3>Plan (5‚Äì10 steps)</h3>
        <ol>
          <li><strong>Identify propagation direction</strong>: recognize <span class="badge">t ‚àí z/c‚ÇÄ</span> as a +z traveling wave at speed <span class="badge">c‚ÇÄ</span>.</li>
          <li><strong>Identify polarization</strong>: <span class="badge">E ‚à• xÃÇ</span> ‚áí linear x-polarized, transverse.</li>
          <li><strong>Interpret waveform</strong>: <span class="badge">e^{-t¬≤/œÑ¬≤}</span> is a Gaussian envelope; <span class="badge">e^{j2œÄŒΩ‚ÇÄt}</span> sets a carrier frequency.</li>
          <li><strong>Use plane-wave relation</strong>:
            apply <span class="badge">B = (1/c‚ÇÄ)(kÃÇ √ó E)</span> with <span class="badge">kÃÇ = zÃÇ</span>.</li>
          <li><strong>Optional verification</strong>:
            compute <span class="badge">‚àá√óE</span> and confirm it matches <span class="badge">‚àí‚àÇB/‚àÇt</span>.</li>
          <li><strong>State final vector expression</strong> for <span class="badge">B(z,t)</span> (and optionally <span class="badge">H(z,t)</span>).</li>
          <li><strong>Sanity checks</strong>:
            orthogonality, right-handed triad, and magnitude relation <span class="badge">|E|=c‚ÇÄ|B|</span>.</li>
        </ol>
      </div>

      <div class="grid2">
        <div class="card">
          <h3>Common mistakes</h3>
          <ul>
            <li>Mixing up direction: <span class="badge">t ‚àí z/c‚ÇÄ</span> is +z; <span class="badge">t + z/c‚ÇÄ</span> is ‚àíz.</li>
            <li>Wrong cross-product order: it is <span class="badge">kÃÇ √ó E</span>, not <span class="badge">E √ó kÃÇ</span>.</li>
            <li>Confusing <span class="badge">B</span> with <span class="badge">H</span>: in vacuum <span class="badge">B=Œº‚ÇÄH</span> and <span class="badge">|E|=Œ∑‚ÇÄ|H|</span>.</li>
            <li>Forgetting the physical (real) field is typically the <strong>real part</strong> if complex notation is used.</li>
          </ul>
        </div>
        <div class="card">
          <h3>Quick tips</h3>
          <ul>
            <li>Right-handed rule: if the wave goes +z and <span class="badge">E</span> is +x, then <span class="badge">B</span> must be +y so that <span class="badge">E √ó B</span> points +z.</li>
            <li>Pulse bandwidth intuition: shorter <span class="badge">œÑ</span> ‚áí broader spectrum around <span class="badge">ŒΩ‚ÇÄ</span>.</li>
            <li>Magnitude relation in vacuum: <span class="badge">B = E/c‚ÇÄ</span> (in magnitudes).</li>
          </ul>
        </div>
      </div>
    </article>

    <article id="part3">
      <h2>PART 3 ‚Äî Full Solution</h2>

      <section class="card" aria-label="Physical intuition">
        <h3>Physical intuition first</h3>
        <p>
          The electric field is
          <span class="badge">E(z,t)=f(t-z/c‚ÇÄ)xÃÇ</span>.
          Any function of the form <span class="badge">g(t - z/v)</span> is a waveform that moves in the <strong>+z</strong> direction
          at speed <span class="badge">v</span>, because keeping the argument constant implies <span class="badge">z = vt + const</span>.
          Here <span class="badge">v=c‚ÇÄ</span>, the speed of light in free space.
        </p>
        <p>
          The factor <span class="badge">e^{-t¬≤/œÑ¬≤}</span> is a <strong>Gaussian envelope</strong> (a pulse),
          while <span class="badge">e^{j2œÄŒΩ‚ÇÄt}</span> is a complex sinusoidal carrier at frequency <span class="badge">ŒΩ‚ÇÄ</span>.
          So this is a <strong>Gaussian wave packet</strong> (a short pulse) riding on a carrier oscillation, propagating along +z.
          The polarization is <strong>linear in x</strong> because the field points along <span class="badge">xÃÇ</span>.
        </p>
      </section>

      <section class="card" aria-label="Detailed derivation">
        <h3>Step-by-step derivation of the magnetic field</h3>

        <p><strong>1) Write the given electric field.</strong></p>
        <div class="eq" id="eq1">
E(z,t) = xÃÇ f(u),   where u = t ‚àí z/c‚ÇÄ
f(u) = exp(‚àíu¬≤/œÑ¬≤) ¬∑ exp(j2œÄŒΩ‚ÇÄ u)
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq1">Copy equation</button>
        </div>

        <p style="margin-top:14px;">
          <strong>2) Use the free-space plane-wave geometry.</strong>
          The dependence on <span class="badge">u = t ‚àí z/c‚ÇÄ</span> indicates a wave traveling in <strong>+z</strong>,
          so the propagation unit vector is:
        </p>
        <div class="eq" id="eq2">kÃÇ = zÃÇ</div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq2">Copy</button>
        </div>

        <p style="margin-top:14px;">
          <strong>3) Apply the vacuum plane-wave relation between E and B.</strong><br/>
          For an electromagnetic plane wave in free space,
          the magnetic flux density satisfies:
        </p>
        <div class="eq" id="eq3">
B = (1/c‚ÇÄ) (kÃÇ √ó E)
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq3">Copy</button>
        </div>

        <p style="margin-top:14px;">
          <strong>4) Compute the cross product.</strong><br/>
          With <span class="badge">kÃÇ = zÃÇ</span> and <span class="badge">E = xÃÇ f(u)</span>,
        </p>
        <div class="eq" id="eq4">
kÃÇ √ó E = zÃÇ √ó (xÃÇ f(u)) = (zÃÇ √ó xÃÇ) f(u)
Using the right-hand rule: zÃÇ √ó xÃÇ = yÃÇ
‚áí kÃÇ √ó E = yÃÇ f(u)
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq4">Copy</button>
        </div>

        <p style="margin-top:14px;">
          <strong>5) Therefore the magnetic field is</strong>:
        </p>
        <div class="eq" id="eq5">
B(z,t) = (1/c‚ÇÄ) yÃÇ f(t ‚àí z/c‚ÇÄ)
       = (1/c‚ÇÄ) yÃÇ exp(‚àí(t ‚àí z/c‚ÇÄ)¬≤/œÑ¬≤) ¬∑ exp(j2œÄŒΩ‚ÇÄ (t ‚àí z/c‚ÇÄ))
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq5">Copy B-field</button>
        </div>

        <p style="margin-top:14px;">
          <strong>Optional: magnetic field intensity H.</strong>
          In free space, <span class="badge">B = Œº‚ÇÄ H</span> and the impedance is <span class="badge">Œ∑‚ÇÄ = ‚àö(Œº‚ÇÄ/Œµ‚ÇÄ)</span>,
          so equivalently:
        </p>
        <div class="eq" id="eq6">
H(z,t) = (1/Œ∑‚ÇÄ) yÃÇ f(t ‚àí z/c‚ÇÄ)
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq6">Copy H-field</button>
        </div>
      </section>

      <section class="final" aria-label="Final result">
        <h3>‚úÖ Boxed Final Result</h3>
        <div class="eq" id="eq-box">
Electric field:
E(z,t) = xÃÇ exp(‚àí(t ‚àí z/c‚ÇÄ)¬≤/œÑ¬≤) ¬∑ exp(j2œÄŒΩ‚ÇÄ (t ‚àí z/c‚ÇÄ))

Magnetic field (vacuum):
B(z,t) = (1/c‚ÇÄ) yÃÇ exp(‚àí(t ‚àí z/c‚ÇÄ)¬≤/œÑ¬≤) ¬∑ exp(j2œÄŒΩ‚ÇÄ (t ‚àí z/c‚ÇÄ))

(Equivalently: H(z,t) = (1/Œ∑‚ÇÄ) yÃÇ exp(‚àí(t ‚àí z/c‚ÇÄ)¬≤/œÑ¬≤) ¬∑ exp(j2œÄŒΩ‚ÇÄ (t ‚àí z/c‚ÇÄ)))
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq-box">Copy boxed result</button>
          <span class="pill"><span aria-hidden="true">üìå</span> Real physical field = Re{‚Ä¶} if using complex notation</span>
        </div>

        <div class="check">
          <div class="item">
            <strong>Units check</strong>
            <div>
              If <span class="badge">E</span> is in V/m, then <span class="badge">B</span> must be in T.
              Since <span class="badge">c‚ÇÄ</span> has units m/s, the relation <span class="badge">B = E/c‚ÇÄ</span> matches the known vacuum plane-wave scaling.
            </div>
          </div>
          <div class="item">
            <strong>Limiting cases</strong>
            <div>
              As <span class="badge">œÑ ‚Üí ‚àû</span>, the envelope becomes nearly constant, approaching a monochromatic plane wave at frequency <span class="badge">ŒΩ‚ÇÄ</span>.
              As <span class="badge">œÑ</span> decreases, the pulse shortens and its spectrum broadens.
            </div>
          </div>
          <div class="item">
            <strong>Physical interpretation</strong>
            <div>
              The energy flow direction is given by the Poynting vector <span class="badge">S ‚àù E √ó H</span>.
              With <span class="badge">E ‚à• xÃÇ</span> and <span class="badge">H ‚à• yÃÇ</span>, <span class="badge">E √ó H ‚à• zÃÇ</span>, consistent with propagation in +z.
            </div>
          </div>
        </div>
      </section>
    </article>

    <section id="viz">
      <h2>Interactive Visualizations</h2>
      <div class="vizWrap">
        <figure>
          <canvas id="cnvDiagram" aria-label="Wave geometry diagram"></canvas>
          <figcaption>
            <strong>Diagram:</strong> A linearly polarized plane wave packet propagating in +z. The fields satisfy
            <span class="badge">E ‚üÇ B ‚üÇ zÃÇ</span> and <span class="badge">E √ó B ‚à• +zÃÇ</span>.
          </figcaption>
        </figure>

        <figure>
          <canvas id="cnvTime" aria-label="Time-domain plot"></canvas>
          <figcaption>
            <strong>Main plot:</strong> Time-domain waveform at a fixed position (example values). Shows the Gaussian envelope and the oscillating carrier.
          </figcaption>
        </figure>

        <figure style="grid-column: 1 / -1;">
          <canvas id="cnvSpec" aria-label="Spectrum plot"></canvas>
          <figcaption>
            <strong>Secondary plot:</strong> Magnitude spectrum vs frequency. Shorter œÑ (narrower in time) produces a broader spectrum around ŒΩ‚ÇÄ.
          </figcaption>
        </figure>
      </div>

      <div class="controls" aria-label="Interactive controls">
        <div class="control">
          <label for="tau">
            <span>Pulse width œÑ (example)</span>
            <span class="badge" id="tauRead">2.00 ns</span>
          </label>
          <input id="tau" type="range" min="0.2" max="8.0" step="0.05" value="2.0" />
          <div class="help">
            Smaller œÑ ‚Üí shorter pulse ‚Üí broader spectrum.
          </div>
        </div>
        <div class="control">
          <label for="nu0">
            <span>Carrier frequency ŒΩ‚ÇÄ (example)</span>
            <span class="badge" id="nuRead">1.00 GHz</span>
          </label>
          <input id="nu0" type="range" min="0.2" max="3.0" step="0.01" value="1.0" />
          <div class="help">
            Shifts the oscillation frequency and the spectrum center.
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:14px;">
        <h3>Example values used in the plots (not required by the symbolic solution)</h3>
        <ul>
          <li><span class="badge">c‚ÇÄ = 2.99792458√ó10‚Å∏ m/s</span> (speed of light)</li>
          <li>We plot the <strong>real part</strong> of the complex field: <span class="badge">Re{E}</span>.</li>
          <li>Position is fixed at <span class="badge">z = 0</span> for the time plot (so <span class="badge">u = t</span>).</li>
          <li>For the spectrum, we compute a discrete FFT of the sampled waveform (demonstration-quality).</li>
        </ul>
      </div>
    </section>

  </main>
</div>

<footer>
  <p>
    Built with vanilla HTML/CSS/JS. Complex notation is used for compactness; the measurable field is typically the real part.
  </p>
</footer>

<script>
(function(){
  "use strict";

  // ---------- Smooth scroll for TOC ----------
  document.querySelectorAll('[data-scroll]').forEach(a=>{
    a.addEventListener('click', (e)=>{
      e.preventDefault();
      const id = a.getAttribute('href');
      const el = document.querySelector(id);
      if(!el) return;
      el.scrollIntoView({behavior:'smooth', block:'start'});
    });
  });

  // ---------- Copy buttons ----------
  async function copyText(text){
    try{
      await navigator.clipboard.writeText(text);
      return true;
    }catch(err){
      // Fallback
      const ta = document.createElement('textarea');
      ta.value = text;
      ta.style.position='fixed';
      ta.style.left='-9999px';
      document.body.appendChild(ta);
      ta.select();
      let ok=false;
      try{ ok = document.execCommand('copy'); }catch(e){ ok=false; }
      document.body.removeChild(ta);
      return ok;
    }
  }
  document.querySelectorAll('button.copy').forEach(btn=>{
    btn.addEventListener('click', async ()=>{
      const id = btn.getAttribute('data-copy-target');
      const el = document.getElementById(id);
      if(!el) return;
      const text = el.textContent.replace(/\n\s+\n/g,"\n\n").trim();
      const ok = await copyText(text);
      const old = btn.textContent;
      btn.textContent = ok ? "Copied!" : "Copy failed";
      setTimeout(()=>btn.textContent=old, 900);
    });
  });

  // ---------- Canvas utilities ----------
  function setupHiDPICanvas(canvas){
    const dpr = Math.max(1, window.devicePixelRatio || 1);
    const rect = canvas.getBoundingClientRect();
    const w = Math.max(10, Math.floor(rect.width * dpr));
    const h = Math.max(10, Math.floor(rect.height * dpr));
    if(canvas.width !== w || canvas.height !== h){
      canvas.width = w;
      canvas.height = h;
    }
    const ctx = canvas.getContext('2d');
    ctx.setTransform(1,0,0,1,0,0);
    ctx.scale(dpr, dpr);
    return {ctx, dpr, cssW: rect.width, cssH: rect.height};
  }

  function clear(ctx, w, h){
    ctx.clearRect(0,0,w,h);
  }

  function drawRoundRect(ctx,x,y,w,h,r){
    const rr = Math.min(r, w/2, h/2);
    ctx.beginPath();
    ctx.moveTo(x+rr,y);
    ctx.arcTo(x+w,y,x+w,y+h,rr);
    ctx.arcTo(x+w,y+h,x,y+h,rr);
    ctx.arcTo(x,y+h,x,y,rr);
    ctx.arcTo(x,y,x+w,y,rr);
    ctx.closePath();
  }

  function niceTicks(min, max, approxCount){
    const span = max - min;
    if(span <= 0) return {step:1, ticks:[min]};
    const raw = span / Math.max(1, approxCount);
    const pow = Math.pow(10, Math.floor(Math.log10(raw)));
    const candidates = [1,2,5,10].map(m=>m*pow);
    let step = candidates[0];
    for(const s of candidates){
      if(raw <= s){ step = s; break; }
      step = s;
    }
    const start = Math.ceil(min/step)*step;
    const ticks = [];
    for(let v=start; v<=max+1e-12; v+=step) ticks.push(v);
    return {step, ticks};
  }

  function drawAxes(ctx, box, xMin, xMax, yMin, yMax, xLabel, yLabel, title){
    const {x,y,w,h} = box;

    // background panel
    ctx.save();
    ctx.globalAlpha = 0.9;
    drawRoundRect(ctx, x, y, w, h, 12);
    ctx.fillStyle = "rgba(0,0,0,0.18)";
    ctx.fill();
    ctx.restore();

    // margins for plot area
    const mL = 58, mR = 18, mT = 34, mB = 46;
    const px = x + mL, py = y + mT;
    const pw = w - mL - mR, ph = h - mT - mB;

    // grid + ticks
    const xT = niceTicks(xMin, xMax, 6);
    const yT = niceTicks(yMin, yMax, 5);

    ctx.save();
    ctx.translate(0.5,0.5); // crisp lines
    // grid
    ctx.strokeStyle = "rgba(255,255,255,0.10)";
    ctx.lineWidth = 1;

    // vertical grid + x ticks
    xT.ticks.forEach(v=>{
      const t = (v - xMin)/(xMax - xMin);
      const gx = px + t*pw;
      ctx.beginPath();
      ctx.moveTo(gx, py);
      ctx.lineTo(gx, py+ph);
      ctx.stroke();
    });
    // horizontal grid + y ticks
    yT.ticks.forEach(v=>{
      const t = (v - yMin)/(yMax - yMin);
      const gy = py + (1-t)*ph;
      ctx.beginPath();
      ctx.moveTo(px, gy);
      ctx.lineTo(px+pw, gy);
      ctx.stroke();
    });

    // axis border
    ctx.strokeStyle = "rgba(255,255,255,0.22)";
    ctx.lineWidth = 1.2;
    ctx.strokeRect(px, py, pw, ph);

    // tick labels
    ctx.fillStyle = "rgba(233,238,252,0.82)";
    ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.textAlign = "center";
    ctx.textBaseline = "top";
    xT.ticks.forEach(v=>{
      const t = (v - xMin)/(xMax - xMin);
      const gx = px + t*pw;
      ctx.fillText(formatNum(v), gx, py+ph+8);
    });

    ctx.textAlign = "right";
    ctx.textBaseline = "middle";
    yT.ticks.forEach(v=>{
      const t = (v - yMin)/(yMax - yMin);
      const gy = py + (1-t)*ph;
      ctx.fillText(formatNum(v), px-8, gy);
    });

    // labels & title
    ctx.fillStyle = "rgba(233,238,252,0.90)";
    ctx.textAlign = "center";
    ctx.textBaseline = "top";
    ctx.font = "13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.fillText(xLabel, px + pw/2, y + h - 20);

    ctx.save();
    ctx.translate(x + 18, py + ph/2);
    ctx.rotate(-Math.PI/2);
    ctx.textAlign = "center";
    ctx.textBaseline = "top";
    ctx.fillText(yLabel, 0, 0);
    ctx.restore();

    ctx.fillStyle = "rgba(233,238,252,0.96)";
    ctx.textAlign = "left";
    ctx.textBaseline = "top";
    ctx.font = "600 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.fillText(title, x + 14, y + 10);

    ctx.restore();

    return {plot:{x:px, y:py, w:pw, h:ph}, xMin, xMax, yMin, yMax};
  }

  function formatNum(v){
    const av = Math.abs(v);
    if(av >= 1000 || (av > 0 && av < 0.001)) return v.toExponential(2);
    return (Math.round(v*1000)/1000).toString();
  }

  function plotLine(ctx, plot, xMin, xMax, yMin, yMax, xs, ys, style){
    ctx.save();
    ctx.strokeStyle = style.stroke || "rgba(122,168,255,0.95)";
    ctx.lineWidth = style.width || 2;
    ctx.globalAlpha = style.alpha ?? 1;
    ctx.beginPath();
    for(let i=0;i<xs.length;i++){
      const xt = (xs[i]-xMin)/(xMax-xMin);
      const yt = (ys[i]-yMin)/(yMax-yMin);
      const x = plot.x + xt*plot.w;
      const y = plot.y + (1-yt)*plot.h;
      if(i===0) ctx.moveTo(x,y);
      else ctx.lineTo(x,y);
    }
    ctx.stroke();
    ctx.restore();
  }

  function drawLegend(ctx, box, items){
    const pad=10;
    const x = box.x + box.w - 10;
    const y = box.y + 10;

    ctx.save();
    ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.textAlign = "right";
    ctx.textBaseline = "top";
    let yy = y;
    items.forEach(it=>{
      ctx.fillStyle = "rgba(233,238,252,0.90)";
      ctx.fillText(it.label, x, yy);
      ctx.strokeStyle = it.color;
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(x-90, yy+7);
      ctx.lineTo(x-50, yy+7);
      ctx.stroke();
      yy += 18;
    });
    ctx.restore();
  }

  // ---------- Physics model (example plotting) ----------
  const c0 = 299792458; // m/s
  const TWO_PI = 2*Math.PI;

  function fComplex(u, tau, nu0){
    // u in seconds, tau in seconds, nu0 in Hz
    const env = Math.exp(-(u*u)/(tau*tau));
    const ph = TWO_PI*nu0*u;
    return {re: env*Math.cos(ph), im: env*Math.sin(ph), env};
  }

  // FFT (simple Cooley-Tukey iterative, power-of-two)
  function fftRadix2(re, im){
    const n = re.length;
    const levels = Math.log2(n);
    if(Math.floor(levels) !== levels) throw new Error("FFT length must be power of two");

    // bit reversal
    for(let i=0;i<n;i++){
      let j=0;
      for(let k=0;k<levels;k++){
        j = (j<<1) | ((i>>>k)&1);
      }
      if(j>i){
        [re[i], re[j]] = [re[j], re[i]];
        [im[i], im[j]] = [im[j], im[i]];
      }
    }

    for(let size=2; size<=n; size<<=1){
      const half = size>>>1;
      const tabStep = TWO_PI/size;
      for(let i=0;i<n;i+=size){
        for(let j=0;j<half;j++){
          const k = j*tabStep;
          const wr = Math.cos(-k);
          const wi = Math.sin(-k);
          const l = i+j;
          const r = l+half;
          const tr = wr*re[r] - wi*im[r];
          const ti = wr*im[r] + wi*re[r];
          re[r] = re[l] - tr;
          im[r] = im[l] - ti;
          re[l] = re[l] + tr;
          im[l] = im[l] + ti;
        }
      }
    }
    return {re, im};
  }

  function computeSpectrum(tau, nu0){
    // time window set by tau so we capture pulse
    const N = 2048; // power of two
    const span = 10 * tau; // +/- 5 tau
    const dt = span / N;
    const t0 = -span/2;

    const re = new Array(N);
    const im = new Array(N);
    for(let n=0;n<N;n++){
      const t = t0 + n*dt;
      const z = 0; // fixed
      const u = t - z/c0;
      const fc = fComplex(u, tau, nu0);
      re[n] = fc.re; // real part (example)
      im[n] = 0;
    }

    const out = fftRadix2(re.slice(), im.slice());
    const mags = new Array(N);
    for(let i=0;i<N;i++){
      const a = out.re[i], b = out.im[i];
      mags[i] = Math.sqrt(a*a + b*b);
    }

    // frequency axis (Hz), FFT bins 0..N-1
    const df = 1/(N*dt);
    const freq = new Array(N);
    // shift to centered spectrum
    const fshift = new Array(N);
    const mshift = new Array(N);
    for(let i=0;i<N;i++){
      const k = (i + N/2) % N;
      const f = (k - N/2)*df;
      fshift[i] = f;
      mshift[i] = mags[k];
    }

    // normalize magnitude to max=1 for display
    let maxm = 0;
    for(const m of mshift) if(m>maxm) maxm=m;
    for(let i=0;i<N;i++) mshift[i] = maxm>0 ? mshift[i]/maxm : 0;

    return {freq:fshift, mag:mshift};
  }

  // ---------- Drawing: Diagram ----------
  function drawDiagram(){
    const canvas = document.getElementById('cnvDiagram');
    const {ctx, cssW:w, cssH:h} = setupHiDPICanvas(canvas);
    clear(ctx, w, h);

    // frame
    ctx.save();
    drawRoundRect(ctx, 10, 10, w-20, h-20, 14);
    ctx.fillStyle = "rgba(0,0,0,0.15)";
    ctx.fill();
    ctx.strokeStyle = "rgba(255,255,255,0.12)";
    ctx.lineWidth = 1;
    ctx.stroke();
    ctx.restore();

    // coordinate axes
    const cx = w*0.18, cy = h*0.72;
    const scale = Math.min(w,h)*0.22;

    function arrow(x1,y1,x2,y2,color,label){
      ctx.save();
      ctx.strokeStyle = color;
      ctx.fillStyle = color;
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(x1,y1);
      ctx.lineTo(x2,y2);
      ctx.stroke();
      const ang = Math.atan2(y2-y1, x2-x1);
      const ah = 10;
      ctx.beginPath();
      ctx.moveTo(x2,y2);
      ctx.lineTo(x2 - ah*Math.cos(ang-0.5), y2 - ah*Math.sin(ang-0.5));
      ctx.lineTo(x2 - ah*Math.cos(ang+0.5), y2 - ah*Math.sin(ang+0.5));
      ctx.closePath();
      ctx.fill();
      ctx.font = "13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.textAlign = "left";
      ctx.textBaseline = "middle";
      ctx.fillText(label, x2+8, y2);
      ctx.restore();
    }

    // Propagation direction +z
    arrow(cx, cy, cx + scale*1.6, cy, "rgba(125,255,207,0.95)", "kÃÇ, +z (propagation)");

    // E in +x (draw upward on screen)
    arrow(cx, cy, cx, cy - scale*1.2, "rgba(122,168,255,0.95)", "E (xÃÇ polarization)");

    // B in +y (draw out-of-plane symbol)
    // Represent +y as a dot in a circle (coming out of page).
    ctx.save();
    const bx = cx + scale*0.85;
    const by = cy - scale*0.60;
    ctx.strokeStyle = "rgba(255,211,122,0.95)";
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.arc(bx, by, 16, 0, TWO_PI);
    ctx.stroke();
    ctx.fillStyle = "rgba(255,211,122,0.95)";
    ctx.beginPath();
    ctx.arc(bx, by, 5.5, 0, TWO_PI);
    ctx.fill();
    ctx.fillStyle = "rgba(233,238,252,0.92)";
    ctx.font = "13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.textAlign = "left";
    ctx.textBaseline = "middle";
    ctx.fillText("B (yÃÇ), out of page", bx + 24, by);
    ctx.restore();

    // Pulse envelope sketch along z
    ctx.save();
    const x0 = w*0.18;
    const y0 = h*0.34;
    const ww = w*0.70;
    const hh = h*0.18;
    ctx.strokeStyle = "rgba(255,255,255,0.16)";
    ctx.strokeRect(x0, y0, ww, hh);

    // draw gaussian envelope
    ctx.beginPath();
    for(let i=0;i<=220;i++){
      const t = i/220;
      const xx = x0 + t*ww;
      const u = (t-0.5)*4;
      const env = Math.exp(-u*u);
      const yy = y0 + hh*(1 - 0.85*env);
      if(i===0) ctx.moveTo(xx,yy);
      else ctx.lineTo(xx,yy);
    }
    ctx.strokeStyle = "rgba(122,168,255,0.75)";
    ctx.lineWidth = 2;
    ctx.stroke();

    // carrier wiggles
    ctx.beginPath();
    for(let i=0;i<=600;i++){
      const t = i/600;
      const xx = x0 + t*ww;
      const u = (t-0.5)*4;
      const env = Math.exp(-u*u);
      const carrier = Math.cos(2*Math.PI*(12*t));
      const yy = y0 + hh*(1 - 0.50*env*carrier - 0.05);
      if(i===0) ctx.moveTo(xx,yy);
      else ctx.lineTo(xx,yy);
    }
    ctx.strokeStyle = "rgba(255,211,122,0.65)";
    ctx.lineWidth = 1.6;
    ctx.stroke();

    ctx.fillStyle = "rgba(233,238,252,0.88)";
    ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.textAlign = "left";
    ctx.fillText("Gaussian-modulated carrier traveling in +z", x0+8, y0+8);
    ctx.restore();
  }

  // ---------- Drawing: Plots ----------
  function drawTimePlot(tau, nu0){
    const canvas = document.getElementById('cnvTime');
    const {ctx, cssW:w, cssH:h} = setupHiDPICanvas(canvas);
    clear(ctx, w, h);

    const box = {x:10,y:10,w:w-20,h:h-20};

    // time window
    const span = 10 * tau; // seconds
    const tMin = -span/2;
    const tMax = +span/2;

    // sample
    const N = 900;
    const xs = new Array(N);
    const yRe = new Array(N);
    const yEnv = new Array(N);

    for(let i=0;i<N;i++){
      const t = tMin + (tMax-tMin)*i/(N-1);
      const u = t; // z=0
      const fc = fComplex(u, tau, nu0);
      xs[i] = t * 1e9; // ns for display
      yRe[i] = fc.re;
      yEnv[i] = fc.env;
    }

    // axis limits
    const xMin = xs[0], xMax = xs[N-1];
    const yMin = -1.05, yMax = 1.05;

    const axes = drawAxes(
      ctx, box,
      xMin, xMax, yMin, yMax,
      "time t (ns) at z = 0",
      "field amplitude (arb.)",
      "Time-domain field: Re{E‚Çì(t)} and envelope"
    );

    // plot real part and envelope
    plotLine(ctx, axes.plot, xMin, xMax, yMin, yMax, xs, yRe, {stroke:"rgba(122,168,255,0.95)", width:2.4});
    plotLine(ctx, axes.plot, xMin, xMax, yMin, yMax, xs, yEnv, {stroke:"rgba(125,255,207,0.85)", width:2.0, alpha:0.95});
    plotLine(ctx, axes.plot, xMin, xMax, yMin, yMax, xs, yEnv.map(v=>-v), {stroke:"rgba(125,255,207,0.55)", width:1.6, alpha:0.9});

    drawLegend(ctx, box, [
      {label:"Re{E‚Çì} (example)", color:"rgba(122,168,255,0.95)"},
      {label:"¬± envelope exp(‚àít¬≤/œÑ¬≤)", color:"rgba(125,255,207,0.85)"}
    ]);
  }

  function drawSpecPlot(tau, nu0){
    const canvas = document.getElementById('cnvSpec');
    const {ctx, cssW:w, cssH:h} = setupHiDPICanvas(canvas);
    clear(ctx, w, h);

    const box = {x:10,y:10,w:w-20,h:h-20};
    const spec = computeSpectrum(tau, nu0);

    // Display frequency in GHz
    const xs = spec.freq.map(f=>f*1e-9);
    const ys = spec.mag;

    // Focus window around carrier: +/- 2 GHz for readability, but adapt
    const center = nu0*1e-9;
    const halfWin = Math.max(1.2, 2.2*(1/(Math.PI*tau))*1e-9 * 6); // heuristic scaling
    const xMin = Math.max(-5, center - halfWin);
    const xMax = Math.min( 5, center + halfWin);

    // clip data to window for plotting
    const xPlot = [];
    const yPlot = [];
    for(let i=0;i<xs.length;i++){
      if(xs[i] >= xMin && xs[i] <= xMax){
        xPlot.push(xs[i]);
        yPlot.push(ys[i]);
      }
    }

    const axes = drawAxes(
      ctx, box,
      xMin, xMax, 0, 1.05,
      "frequency ŒΩ (GHz)",
      "|F(ŒΩ)| (normalized)",
      "Spectrum magnitude (FFT demo): centered near ŒΩ‚ÇÄ"
    );

    plotLine(ctx, axes.plot, xMin, xMax, 0, 1.05, xPlot, yPlot, {stroke:"rgba(255,211,122,0.95)", width:2.4});

    // vertical line at nu0
    ctx.save();
    ctx.strokeStyle = "rgba(122,168,255,0.8)";
    ctx.lineWidth = 2;
    const xnu = axes.plot.x + ((center - xMin)/(xMax-xMin))*axes.plot.w;
    ctx.beginPath();
    ctx.moveTo(xnu, axes.plot.y);
    ctx.lineTo(xnu, axes.plot.y + axes.plot.h);
    ctx.stroke();
    ctx.fillStyle = "rgba(233,238,252,0.88)";
    ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.textAlign = "left";
    ctx.textBaseline = "top";
    ctx.fillText("ŒΩ‚ÇÄ", xnu+6, axes.plot.y+6);
    ctx.restore();

    drawLegend(ctx, box, [
      {label:"|Spectrum| (normalized)", color:"rgba(255,211,122,0.95)"},
      {label:"Carrier ŒΩ‚ÇÄ marker", color:"rgba(122,168,255,0.80)"}
    ]);
  }

  // ---------- Controls & render loop ----------
  const tauSlider = document.getElementById('tau');
  const nuSlider = document.getElementById('nu0');
  const tauRead = document.getElementById('tauRead');
  const nuRead = document.getElementById('nuRead');

  function getParams(){
    const tau_ns = parseFloat(tauSlider.value);
    const nu_GHz = parseFloat(nuSlider.value);
    return {
      tau_ns,
      nu_GHz,
      tau: tau_ns * 1e-9,
      nu0: nu_GHz * 1e9
    };
  }

  function render(){
    const p = getParams();
    tauRead.textContent = p.tau_ns.toFixed(2) + " ns";
    nuRead.textContent = p.nu_GHz.toFixed(2) + " GHz";

    drawDiagram();
    drawTimePlot(p.tau, p.nu0);
    drawSpecPlot(p.tau, p.nu0);
  }

  let raf = null;
  function scheduleRender(){
    if(raf) cancelAnimationFrame(raf);
    raf = requestAnimationFrame(render);
  }

  tauSlider.addEventListener('input', scheduleRender);
  nuSlider.addEventListener('input', scheduleRender);
  window.addEventListener('resize', scheduleRender);

  // initial
  render();

})();
</script>
</body>
</html>
