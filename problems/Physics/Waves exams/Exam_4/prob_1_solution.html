<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>Plasma Wave Dispersion — Complete Structured Solution</title>

  <!-- SEO / Social -->
  <meta name="description" content="Expert-level, beginner-friendly solution: plasma wave equation dispersion, k(ω), phase & group velocities, and evanescent decay κ(ω)." />
  <meta property="og:title" content="Plasma Wave Dispersion — Complete Structured Solution" />
  <meta property="og:description" content="Derivation + intuition + sanity checks. Includes interactive plots for k(ω), vph(ω), vg(ω), and κ(ω)." />

  <!-- MathJax for LaTeX -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(','\\)'],['$','$']], displayMath: [['\\[','\\]'],['$$','$$']] },
      options: { skipHtmlTags: ['script','noscript','style','textarea','pre','code'] }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <style>
    :root{
      --bg0: #070910;
      --bg1: #0b1020;
      --card: rgba(255,255,255,.06);
      --card2: rgba(255,255,255,.085);
      --stroke: rgba(255,255,255,.12);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --faint: rgba(255,255,255,.55);
      --accent: #7c5cff;
      --accent2:#00d7ff;
      --good: #2fe07a;
      --warn: #ffcc66;
      --bad:  #ff5c7a;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --radius: 18px;
      --radius2: 26px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --serif: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg0:#f7f8ff;
        --bg1:#ffffff;
        --card: rgba(10,20,60,.06);
        --card2: rgba(10,20,60,.085);
        --stroke: rgba(10,20,60,.12);
        --text: rgba(10,20,60,.92);
        --muted: rgba(10,20,60,.70);
        --faint: rgba(10,20,60,.55);
        --shadow: 0 18px 50px rgba(10,20,60,.12);
      }
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      color:var(--text);
      background:
        radial-gradient(1100px 700px at 20% 10%, rgba(124,92,255,.30), transparent 60%),
        radial-gradient(900px 600px at 80% 10%, rgba(0,215,255,.22), transparent 60%),
        radial-gradient(1000px 800px at 50% 90%, rgba(47,224,122,.14), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 40%, var(--bg0));
      line-height:1.55;
      overflow-x:hidden;
    }

    /* Subtle animated grain */
    .grain{
      pointer-events:none;
      position:fixed; inset:0;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='180' height='180' filter='url(%23n)' opacity='.25'/%3E%3C/svg%3E");
      mix-blend-mode: overlay;
      opacity:.10;
      animation: drift 10s linear infinite;
    }
    @keyframes drift{ from{ transform:translate3d(0,0,0);} to{ transform:translate3d(-80px,60px,0);} }

    header{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(14px);
      background: linear-gradient(180deg, rgba(0,0,0,.30), rgba(0,0,0,0));
      border-bottom: 1px solid rgba(255,255,255,.06);
    }

    .topbar{
      max-width: 1120px;
      margin:0 auto;
      padding: 14px 18px;
      display:flex;
      gap:14px;
      align-items:center;
      justify-content:space-between;
    }

    .brand{
      display:flex; align-items:center; gap:12px;
      user-select:none;
      text-decoration:none; color:inherit;
    }
    .logo{
      width:44px; height:44px; border-radius:14px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.9), rgba(255,255,255,.0) 55%),
        conic-gradient(from 180deg, var(--accent), var(--accent2), var(--good), var(--accent));
      box-shadow: 0 12px 28px rgba(0,0,0,.25);
      position:relative;
      overflow:hidden;
    }
    .logo::after{
      content:"";
      position:absolute; inset:-40%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.25), transparent);
      transform: rotate(25deg);
      animation: sheen 3.2s ease-in-out infinite;
    }
    @keyframes sheen{
      0%,60%{ transform: translateX(-40%) rotate(25deg); opacity:0;}
      70%{opacity:1;}
      100%{ transform: translateX(40%) rotate(25deg); opacity:0;}
    }
    .brand strong{ font-weight:800; letter-spacing:.2px; }
    .brand small{ display:block; color:var(--muted); margin-top:2px; font-weight:550; }

    .controls{
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
    }
    .pill{
      display:flex; align-items:center; gap:10px;
      padding: 10px 12px;
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: 999px;
      box-shadow: var(--shadow);
    }
    .pill label{ color:var(--muted); font-size:12px; font-weight:650; letter-spacing:.2px; }
    .pill input[type="range"]{ width:160px; }
    .pill output{
      font-family: var(--mono);
      font-size: 12px;
      color: var(--text);
      min-width: 60px;
      text-align:right;
    }
    button.icon{
      border:none;
      background: var(--card);
      border: 1px solid var(--stroke);
      color: var(--text);
      border-radius: 14px;
      padding: 10px 12px;
      cursor:pointer;
      transition: transform .12s ease, background .2s ease, border-color .2s ease;
    }
    button.icon:hover{ transform: translateY(-1px); background: var(--card2); border-color: rgba(255,255,255,.18); }
    button.icon:active{ transform: translateY(0px) scale(.99); }

    main{
      max-width: 1120px;
      margin: 0 auto;
      padding: 22px 18px 70px;
    }

    .hero{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 18px;
      align-items:stretch;
      margin-top: 14px;
    }
    @media (max-width: 980px){
      .hero{ grid-template-columns: 1fr; }
      .pill input[type="range"]{ width:140px; }
    }

    .card{
      border-radius: var(--radius2);
      background: linear-gradient(180deg, var(--card2), var(--card));
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .card .inner{ padding: 18px 18px; }
    .card h1{
      margin: 4px 0 10px;
      font-size: clamp(24px, 3.2vw, 36px);
      line-height: 1.12;
      letter-spacing: -.35px;
    }
    .card p{ color: var(--muted); margin: 8px 0 0; }
    .tags{
      display:flex; gap:8px; flex-wrap:wrap;
      margin-top: 12px;
    }
    .tag{
      font-size:12px;
      color: var(--text);
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
    }
    .tag b{ font-family: var(--mono); font-weight:800; }

    .toc{
      display:flex; flex-direction:column; gap:12px;
      padding: 18px;
    }
    .toc h2{
      margin:0;
      font-size: 14px;
      letter-spacing:.4px;
      text-transform: uppercase;
      color: var(--muted);
    }
    .toc a{
      text-decoration:none;
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid transparent;
      background: rgba(255,255,255,.04);
      transition: transform .12s ease, background .2s ease, border-color .2s ease;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .toc a:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.14);
    }
    .toc a span{
      color: var(--muted);
      font-family: var(--mono);
      font-size: 12px;
    }

    section{
      margin-top: 18px;
      scroll-margin-top: 92px;
    }
    .section-title{
      display:flex; align-items:flex-end; justify-content:space-between;
      margin: 10px 0 10px;
      gap:12px;
    }
    .section-title h2{
      margin:0;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .section-title p{
      margin:0;
      color: var(--muted);
      font-size: 13px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
    }

    .content{
      padding: 16px 18px;
    }

    .kicker{
      font-family: var(--mono);
      font-size: 12px;
      color: var(--muted);
      letter-spacing: .5px;
      text-transform: uppercase;
      margin: 0 0 8px;
    }

    .mathblock{
      border-radius: 16px;
      background: rgba(0,0,0,.14);
      border: 1px solid rgba(255,255,255,.10);
      padding: 14px 14px;
      margin: 12px 0;
    }
    @media (prefers-color-scheme: light){
      .mathblock{ background: rgba(10,20,60,.06); }
    }

    .callout{
      border-radius: 18px;
      padding: 14px 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(124,92,255,.14), rgba(0,215,255,.06));
      position:relative;
      overflow:hidden;
    }
    .callout::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(circle at 20% 20%, rgba(124,92,255,.25), transparent 55%);
      opacity:.7;
      pointer-events:none;
    }
    .callout .row{
      position:relative;
      display:flex; gap:10px; align-items:flex-start;
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      margin-top:6px;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      box-shadow: 0 0 0 6px rgba(124,92,255,.16);
      flex:0 0 auto;
    }
    .callout h3{ margin:0 0 6px; font-size: 14px; letter-spacing:.2px; }
    .callout p{ margin:0; color: var(--muted); }

    .list{
      margin: 10px 0 0;
      padding-left: 18px;
      color: var(--muted);
    }
    .list li{ margin: 6px 0; }

    details{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      padding: 10px 12px;
      margin: 10px 0;
    }
    details summary{
      cursor:pointer;
      font-weight:750;
      letter-spacing:.1px;
      color: var(--text);
      list-style:none;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    details summary::-webkit-details-marker{ display:none; }
    details summary::after{
      content:"▾";
      color: var(--muted);
      font-size: 14px;
      transform: translateY(-1px);
    }
    details[open] summary::after{ content:"▴"; }

    .mono{
      font-family: var(--mono);
      font-size: 0.95em;
    }

    .box-result{
      border-radius: 20px;
      border: 1px solid rgba(47,224,122,.22);
      background: linear-gradient(180deg, rgba(47,224,122,.14), rgba(47,224,122,.04));
      padding: 14px 14px;
      margin: 12px 0 0;
    }
    .box-result h4{
      margin: 0 0 8px;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: .55px;
      color: rgba(47,224,122,.92);
    }

    .canvas-wrap{
      padding: 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    canvas{
      width:100%;
      height:360px;
      border-radius: 18px;
      background: rgba(0,0,0,.14);
      border: 1px solid rgba(255,255,255,.10);
    }
    @media (prefers-color-scheme: light){
      canvas{ background: rgba(10,20,60,.06); }
    }

    .legend{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
      justify-content:space-between;
      color: var(--muted);
      font-size: 12px;
      user-select:none;
    }
    .legend .keys{
      display:flex; flex-wrap:wrap; gap:10px; align-items:center;
    }
    .key{
      display:flex; align-items:center; gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
    }
    .sw{
      width:12px; height:12px; border-radius: 4px;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
    }
    .sw.green{ background: linear-gradient(180deg, var(--good), rgba(47,224,122,.4)); }
    .sw.warn{ background: linear-gradient(180deg, var(--warn), rgba(255,204,102,.35)); }
    .legend .note{ font-family: var(--mono); }

    footer{
      max-width: 1120px;
      margin: 24px auto 0;
      padding: 20px 18px 44px;
      color: var(--muted);
      text-align:center;
      font-size: 13px;
    }
    footer .sep{
      height:1px;
      background: rgba(255,255,255,.10);
      margin: 12px auto 14px;
      max-width: 760px;
    }

    /* Print-friendly */
    @media print{
      header, .grain, .controls, .toc { display:none !important; }
      body{ background:white; color:black; }
      .card, .mathblock, .callout, details, canvas{ box-shadow:none !important; }
      canvas{ display:none; }
      a{ color:black; text-decoration:none; }
    }
  </style>
</head>

<body>
  <div class="grain"></div>

  <header>
    <div class="topbar">
      <a class="brand" href="#top">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <strong>Plasma Wave Dispersion</strong>
          <small>Wave equation • cutoff • phase & group velocity • evanescence</small>
        </div>
      </a>

      <div class="controls" aria-label="Interactive controls">
        <div class="pill" title="Adjust the plasma frequency ωp (dimensionless for plotting)">
          <label for="wp">ωp</label>
          <input id="wp" type="range" min="0.4" max="2.2" step="0.02" value="1.00" />
          <output id="wpOut">1.00</output>
        </div>

        <div class="pill" title="Adjust the speed c (dimensionless for plotting)">
          <label for="cval">c</label>
          <input id="cval" type="range" min="0.5" max="2.5" step="0.02" value="1.00" />
          <output id="cOut">1.00</output>
        </div>

        <button class="icon" id="recenter" type="button" title="Reset sliders">
          Reset
        </button>

        <button class="icon" id="copyLink" type="button" title="Copy link to this article">
          Copy link
        </button>
      </div>
    </div>
  </header>

  <main id="top">
    <div class="hero">
      <article class="card">
        <div class="inner">
          <p class="kicker">Complete, structured tutor solution</p>
          <h1>Charge-Density Waves in a Plasma: Dispersion, Cutoff, and Evanescent Decay</h1>
          <p>
            We analyze the 1D plasma wave equation
            \(\rho_{tt}=c^2\rho_{xx}-\omega_p^2\rho\),
            derive \(\omega(k)\), invert to \(k(\omega)\), compute phase & group velocities,
            and show how \(\omega&lt;\omega_p\) produces exponentially decaying solutions.
          </p>
          <div class="tags" aria-label="Key equations">
            <span class="tag"><b>\(\omega^2\)</b> \(=c^2k^2+\omega_p^2\)</span>
            <span class="tag"><b>\(k(\omega)\)</b> \(=\tfrac{1}{c}\sqrt{\omega^2-\omega_p^2}\)</span>
            <span class="tag"><b>\(\kappa(\omega)\)</b> \(=\tfrac{1}{c}\sqrt{\omega_p^2-\omega^2}\)</span>
            <span class="tag"><b>\(v_g\)</b> \(=d\omega/dk\)</span>
          </div>
        </div>
      </article>

      <nav class="card toc" aria-label="Table of contents">
        <h2>On this page</h2>
        <a href="#part1">PART 1 — Problem Analysis <span>00</span></a>
        <a href="#part2">PART 2 — Strategy & Tips <span>01</span></a>
        <a href="#part3">PART 3 — Full Solution <span>02</span></a>
        <a href="#plots">Interactive Graphs <span>03</span></a>
        <a href="#sanity">Sanity Checks <span>04</span></a>
      </nav>
    </div>

    <!-- PART 1 -->
    <section id="part1" class="card">
      <div class="content">
        <div class="section-title">
          <h2>PART 1 — Problem Analysis (no solving yet)</h2>
          <p>Clarify givens, unknowns, principles, and best approach.</p>
        </div>

        <div class="grid">
          <div>
            <div class="callout">
              <div class="row">
                <div class="dot" aria-hidden="true"></div>
                <div>
                  <h3>Restatement</h3>
                  <p>
                    Given the 1D plasma wave equation
                    \(\rho_{tt}=c^2\rho_{xx}-\omega_p^2\rho\),
                    (a) find the dispersion relation for traveling waves \(\rho=a\sin(kx-\omega t)\),
                    (b) invert to \(k(\omega)\) and determine phase/group velocities,
                    and (c) show the equation also admits evanescent solutions
                    \(\rho=a\cos(\omega t)e^{-\kappa x}\) and find \(\kappa(\omega)\).
                  </p>
                </div>
              </div>
            </div>

            <details>
              <summary>Given quantities</summary>
              <ul class="list">
                <li>\(\rho(x,t)\): charge density fluctuation</li>
                <li>\(c\): speed of light (constant parameter)</li>
                <li>\(\omega_p\): plasma frequency (constant parameter)</li>
                <li>PDE: \(\rho_{tt}=c^2\rho_{xx}-\omega_p^2\rho\)</li>
              </ul>
            </details>

            <details>
              <summary>Unknowns / What must be found</summary>
              <ul class="list">
                <li>Dispersion: \(\omega(k)\)</li>
                <li>Inverse: \(k(\omega)\)</li>
                <li>Phase velocity: \(v_{\text{ph}}=\omega/k\)</li>
                <li>Group velocity: \(v_g=d\omega/dk\)</li>
                <li>Evanescent decay constant: \(\kappa(\omega)\)</li>
              </ul>
            </details>

            <details>
              <summary>Physical principles (why they apply)</summary>
              <ul class="list">
                <li><b>Normal modes / plane waves:</b> the PDE is linear with constant coefficients, so Fourier modes evolve independently.</li>
                <li><b>Dispersion:</b> the \(-\omega_p^2\rho\) term introduces a cutoff and makes \(\omega\) depend on \(k\) nonlinearly.</li>
                <li><b>Evanescence:</b> below cutoff, \(k\) becomes imaginary → exponential spatial decay characterized by \(\kappa\).</li>
              </ul>
            </details>
          </div>

          <div>
            <div class="mathblock">
              <p class="kicker">Core equation</p>
              \[
                \frac{\partial^2\rho}{\partial t^2}
                =c^2\frac{\partial^2\rho}{\partial x^2}-\omega_p^2\rho
              \]
              <p style="margin:10px 0 0;color:var(--muted)">
                Think “wave equation + restoring term” → cutoff at \(\omega=\omega_p\).
              </p>
            </div>

            <div class="callout" style="margin-top:12px">
              <div class="row">
                <div class="dot" aria-hidden="true"></div>
                <div>
                  <h3>Approach options</h3>
                  <ul class="list" style="margin-top:8px">
                    <li><b>Direct substitution</b> of trial solutions (fastest; matches the question forms).</li>
                    <li><b>Fourier transform</b> (most general; reveals mode decoupling).</li>
                    <li><b>Separation of variables</b> (works but longer).</li>
                  </ul>
                  <p style="margin-top:8px">
                    <b>Best:</b> direct substitution, because the problem explicitly gives the ansätze.
                  </p>
                </div>
              </div>
            </div>

            <div class="box-result" style="margin-top:12px">
              <h4>Target deliverables</h4>
              <div class="mono" style="color:var(--muted)">
                (a) \(\omega(k)\) • (b) \(k(\omega),\, v_{\text{ph}},\, v_g\) • (c) \(\kappa(\omega)\)
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- PART 2 -->
    <section id="part2" class="card">
      <div class="content">
        <div class="section-title">
          <h2>PART 2 — Strategy & Tips (roadmap only)</h2>
          <p>Minimal plan + common mistakes (no algebra yet).</p>
        </div>

        <div class="grid">
          <div>
            <ol class="list" style="padding-left:22px">
              <li><b>Differentiate</b> the traveling-wave trial \(\rho=a\sin(kx-\omega t)\) twice in \(t\) and \(x\).<br><span class="mono">Tool:</span> second-derivative identities for sine.</li>
              <li><b>Substitute</b> into the PDE and cancel the common factor \(\rho\).<br><span class="mono">Tool:</span> linearity and coefficient matching.</li>
              <li><b>Solve</b> the resulting algebraic relation for \(\omega(k)\).<br><span class="mono">Tool:</span> algebra + physical branch \(\omega\ge 0\).</li>
              <li><b>Invert</b> to \(k(\omega)\) and determine when \(k\) is real (propagating) vs imaginary (evanescent).<br><span class="mono">Tool:</span> square-root reality condition.</li>
              <li><b>Compute</b> \(v_{\text{ph}}=\omega/k\).<br><span class="mono">Tool:</span> definition of phase speed.</li>
              <li><b>Compute</b> \(v_g=d\omega/dk\).<br><span class="mono">Tool:</span> differentiate dispersion relation.</li>
              <li><b>For evanescence</b>, differentiate \(\rho=a\cos(\omega t)e^{-\kappa x}\), substitute, and solve for \(\kappa(\omega)\).<br><span class="mono">Tool:</span> \(d^2/dx^2(e^{-\kappa x})=\kappa^2 e^{-\kappa x}\).</li>
              <li><b>Sketch/graph</b> \(k(\omega)\) for \(\omega\ge\omega_p\) and \(\kappa(\omega)\) for \(\omega<\omega_p\).<br><span class="mono">Tool:</span> intercepts, asymptotes, cutoff behavior.</li>
            </ol>
          </div>

          <div>
            <div class="callout">
              <div class="row">
                <div class="dot" aria-hidden="true"></div>
                <div>
                  <h3>Common mistakes (and fixes)</h3>
                  <ul class="list" style="margin-top:8px">
                    <li><b>Sign slip:</b> traveling wave gives \(\rho_{xx}=-k^2\rho\), but decaying exponential gives \(\rho_{xx}=+\kappa^2\rho\).</li>
                    <li><b>Ignoring cutoff:</b> \(k(\omega)\) is real only if \(\omega\ge\omega_p\). Below that, use \(\kappa(\omega)\).</li>
                    <li><b>Phase vs group:</b> \(v_{\text{ph}}=\omega/k\) (crest speed), \(v_g=d\omega/dk\) (packet speed).</li>
                    <li><b>Relativity confusion:</b> \(v_{\text{ph}}>c\) can happen without sending information faster than \(c\); here \(v_g\le c\).</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="mathblock" style="margin-top:12px">
              <p class="kicker">Hint for plotting</p>
              <p style="margin:0;color:var(--muted)">
                The curve \(k(\omega)\) starts at \((\omega_p,0)\) and approaches \(k\approx \omega/c\) as \(\omega\to\infty\).
                Meanwhile \(\kappa(\omega)\) starts at \(\kappa(0)=\omega_p/c\) and drops to \(0\) at \(\omega=\omega_p\).
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- PART 3 -->
    <section id="part3" class="card">
      <div class="content">
        <div class="section-title">
          <h2>PART 3 — Full Solution</h2>
          <p>Intuition → derivations → boxed results.</p>
        </div>

        <div class="grid">
          <div>
            <div class="callout">
              <div class="row">
                <div class="dot" aria-hidden="true"></div>
                <div>
                  <h3>Physical intuition</h3>
                  <p>
                    The term \(-\omega_p^2\rho\) acts like a “restoring force in time” that prevents low-frequency propagation.
                    Result: a <b>cutoff</b> at \(\omega=\omega_p\). Above cutoff, waves propagate; below cutoff, solutions become
                    <b>evanescent</b> and decay exponentially with \(x\).
                  </p>
                </div>
              </div>
            </div>

            <details open>
              <summary>(a) Dispersion relation \(\omega(k)\)</summary>
              <p style="color:var(--muted);margin:10px 0 0">
                Use \(\rho(x,t)=a\sin(kx-\omega t)\). Let \(\theta=kx-\omega t\).
              </p>

              <div class="mathblock">
                <p class="kicker">Second derivatives</p>
                \[
                \rho_{tt}=\frac{\partial^2}{\partial t^2}\big(a\sin\theta\big)
                =-\,\omega^2\,a\sin\theta=-\omega^2\rho
                \]
                \[
                \rho_{xx}=\frac{\partial^2}{\partial x^2}\big(a\sin\theta\big)
                =-\,k^2\,a\sin\theta=-k^2\rho
                \]
              </div>

              <div class="mathblock">
                <p class="kicker">Substitute into PDE</p>
                \[
                -\omega^2\rho=c^2(-k^2\rho)-\omega_p^2\rho
                =-(c^2k^2+\omega_p^2)\rho
                \]
                Cancel \(\rho\neq 0\):
                \[
                \omega^2=c^2k^2+\omega_p^2
                \]
              </div>

              <div class="box-result">
                <h4>Result (a)</h4>
                \[
                \boxed{\;\omega(k)=\sqrt{c^2k^2+\omega_p^2}\;,\quad \omega\ge 0\;}
                \]
              </div>
            </details>

            <details open>
              <summary>(b) \(k(\omega)\), phase velocity, group velocity</summary>

              <div class="mathblock">
                <p class="kicker">Invert \(\omega^2=c^2k^2+\omega_p^2\)</p>
                \[
                c^2k^2=\omega^2-\omega_p^2
                \quad\Rightarrow\quad
                k(\omega)=\frac{1}{c}\sqrt{\omega^2-\omega_p^2}
                \]
                Reality condition:
                \[
                \omega^2-\omega_p^2\ge 0\;\Rightarrow\;\boxed{\omega\ge \omega_p}
                \]
              </div>

              <div class="mathblock">
                <p class="kicker">Phase velocity</p>
                \[
                v_{\text{ph}}=\frac{\omega}{k}
                =\frac{\omega}{(1/c)\sqrt{\omega^2-\omega_p^2}}
                =c\,\frac{\omega}{\sqrt{\omega^2-\omega_p^2}}
                \]
              </div>

              <div class="mathblock">
                <p class="kicker">Group velocity</p>
                From \(\omega(k)=\sqrt{c^2k^2+\omega_p^2}\):
                \[
                v_g=\frac{d\omega}{dk}
                =\frac{1}{2}(c^2k^2+\omega_p^2)^{-1/2}(2c^2k)
                =\frac{c^2k}{\omega}
                \]
                In terms of \(\omega\):
                \[
                v_g=c\sqrt{1-\left(\frac{\omega_p}{\omega}\right)^2}
                \]
              </div>

              <div class="box-result">
                <h4>Results (b)</h4>
                \[
                \boxed{\;k(\omega)=\frac{1}{c}\sqrt{\omega^2-\omega_p^2}\;,\quad \omega\ge\omega_p\;}
                \]
                \[
                \boxed{\;v_{\text{ph}}(\omega)=c\frac{\omega}{\sqrt{\omega^2-\omega_p^2}}\;>\;c\;}
                \]
                \[
                \boxed{\;v_g(\omega)=c\sqrt{1-\left(\frac{\omega_p}{\omega}\right)^2}\;\le\;c\;}
                \]
                \[
                \boxed{\;v_{\text{ph}}v_g=c^2\;}
                \]
              </div>
            </details>

            <details open>
              <summary>(c) Evanescent solution and \(\kappa(\omega)\)</summary>

              <p style="color:var(--muted);margin:10px 0 0">
                Try \(\rho(x,t)=a\cos(\omega t)e^{-\kappa x}\). Time oscillates, space decays.
              </p>

              <div class="mathblock">
                <p class="kicker">Second derivatives</p>
                \[
                \rho_{tt}=-\omega^2\rho
                \]
                For the spatial part:
                \[
                \rho_x=-\kappa\rho,\qquad
                \rho_{xx}=+\kappa^2\rho
                \]
              </div>

              <div class="mathblock">
                <p class="kicker">Substitute into PDE</p>
                \[
                -\omega^2\rho=c^2(\kappa^2\rho)-\omega_p^2\rho
                \Rightarrow
                -\omega^2=c^2\kappa^2-\omega_p^2
                \]
                \[
                c^2\kappa^2=\omega_p^2-\omega^2
                \Rightarrow
                \kappa(\omega)=\frac{1}{c}\sqrt{\omega_p^2-\omega^2}
                \]
              </div>

              <div class="box-result">
                <h4>Result (c)</h4>
                \[
                \boxed{\;\kappa(\omega)=\frac{1}{c}\sqrt{\omega_p^2-\omega^2}\;,\quad \omega<\omega_p\;}
                \]
                <p style="margin:8px 0 0;color:var(--muted)">
                  This is exactly the “imaginary wavenumber” regime:
                  if \(\omega&lt;\omega_p\), then \(k=i\kappa\).
                </p>
              </div>
            </details>
          </div>

          <aside>
            <div class="card" style="border-radius:var(--radius2)">
              <div class="canvas-wrap">
                <div class="section-title" style="margin:0">
                  <h2>Quick visual summary</h2>
                  <p>Propagating vs evanescent</p>
                </div>

                <div class="callout">
                  <div class="row">
                    <div class="dot" aria-hidden="true"></div>
                    <div>
                      <h3>Cutoff behavior</h3>
                      <p>
                        \(\omega=\omega_p\) is the threshold.
                        <br />
                        <b>Above:</b> \(k\) is real → traveling waves.
                        <br />
                        <b>Below:</b> \(k\) is imaginary → decay with \(\kappa\).
                      </p>
                    </div>
                  </div>
                </div>

                <div class="mathblock">
                  <p class="kicker">One-line map</p>
                  \[
                    \omega^2-\omega_p^2
                    \begin{cases}
                      \ge 0 \Rightarrow k=\frac{1}{c}\sqrt{\omega^2-\omega_p^2}\in\mathbb{R} & (\text{propagate})\\[6pt]
                      < 0 \Rightarrow k=i\kappa,\ \kappa=\frac{1}{c}\sqrt{\omega_p^2-\omega^2}\in\mathbb{R} & (\text{evanescent})
                    \end{cases}
                  \]
                </div>

                <div class="box-result">
                  <h4>Interpretation</h4>
                  <p style="margin:0;color:var(--muted)">
                    Low-frequency oscillations cannot sustain a traveling density wave in this model;
                    instead they are spatially screened over the length scale \(1/\kappa\).
                  </p>
                </div>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <!-- INTERACTIVE PLOTS -->
    <section id="plots" class="card">
      <div class="content">
        <div class="section-title">
          <h2>Interactive Graphs</h2>
          <p>Plots update with the sliders (dimensionless plotting units).</p>
        </div>

        <div class="grid">
          <div class="card" style="border-radius:var(--radius2)">
            <div class="canvas-wrap">
              <div class="legend">
                <div class="keys">
                  <span class="key"><span class="sw"></span> \(k(\omega)\) for \(\omega\ge \omega_p\)</span>
                  <span class="key"><span class="sw green"></span> \(\kappa(\omega)\) for \(\omega<\omega_p\)</span>
                </div>
                <span class="note mono">x-axis: \(\omega\) • y-axis: \(k\) or \(\kappa\)</span>
              </div>
              <canvas id="plotK" aria-label="Plot of k(omega) and kappa(omega)"></canvas>
            </div>
          </div>

          <div class="card" style="border-radius:var(--radius2)">
            <div class="canvas-wrap">
              <div class="legend">
                <div class="keys">
                  <span class="key"><span class="sw warn"></span> \(v_{\text{ph}}(\omega)\)</span>
                  <span class="key"><span class="sw green"></span> \(v_g(\omega)\)</span>
                </div>
                <span class="note mono">x-axis: \(\omega\) • y-axis: velocity</span>
              </div>
              <canvas id="plotV" aria-label="Plot of phase and group velocity"></canvas>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SANITY CHECKS -->
    <section id="sanity" class="card">
      <div class="content">
        <div class="section-title">
          <h2>Sanity Checks</h2>
          <p>Units • limits • physical meaning.</p>
        </div>

        <div class="grid">
          <div>
            <details open>
              <summary>Units</summary>
              <ul class="list">
                <li>\(\omega,\omega_p\) have units \(s^{-1}\); \(k,\kappa\) have units \(m^{-1}\); \(c\) has units \(m/s\).</li>
                <li>\(\omega^2=c^2k^2+\omega_p^2\): \(c^2k^2\sim (m^2/s^2)(1/m^2)=1/s^2\) matches \(\omega^2\).</li>
                <li>\(\kappa=(1/c)\sqrt{\omega_p^2-\omega^2}\): \((s/m)(1/s)=1/m\).</li>
              </ul>
            </details>

            <details open>
              <summary>Limiting cases</summary>
              <ul class="list">
                <li><b>\(\omega\gg\omega_p\):</b> \(k\approx \omega/c\), \(v_{\text{ph}}\to c\), \(v_g\to c\).</li>
                <li><b>\(\omega\to\omega_p^+\):</b> \(k\to 0\), \(v_g\to 0\), \(v_{\text{ph}}\to \infty\).</li>
                <li><b>\(\omega<\omega_p\):</b> propagation stops; decay appears with \(\kappa>0\).</li>
              </ul>
            </details>
          </div>

          <div>
            <div class="callout">
              <div class="row">
                <div class="dot" aria-hidden="true"></div>
                <div>
                  <h3>Physical interpretation</h3>
                  <p>
                    \(\omega_p\) acts as a <b>cutoff frequency</b>.
                    Above cutoff, a real wavenumber exists and waves propagate.
                    Below cutoff, the wavenumber becomes imaginary and the solution decays as \(e^{-\kappa x}\),
                    with screening length \(1/\kappa\).
                  </p>
                </div>
              </div>
            </div>

            <div class="box-result" style="margin-top:12px">
              <h4>Final boxed set</h4>
              \[
              \boxed{\omega^2=c^2k^2+\omega_p^2}
              \]
              \[
              \boxed{k(\omega)=\frac{1}{c}\sqrt{\omega^2-\omega_p^2}\quad(\omega\ge \omega_p)}
              \]
              \[
              \boxed{v_{\text{ph}}=c\frac{\omega}{\sqrt{\omega^2-\omega_p^2}},\quad
              v_g=c\sqrt{1-\left(\frac{\omega_p}{\omega}\right)^2}}
              \]
              \[
              \boxed{\kappa(\omega)=\frac{1}{c}\sqrt{\omega_p^2-\omega^2}\quad(\omega<\omega_p)}
              \]
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <footer>
    <div class="sep"></div>
    <div>
      Built as a clean article component: MathJax-rendered derivations + interactive graphs (Canvas).
      <br />
      Tip: your CMS can safely inline this page; for partial embedding, copy just the <span class="mono">&lt;main&gt;</span> section.
    </div>
  </footer>

  <script>
    // -----------------------------
    // Utilities: formatting + theme-aware colors
    // -----------------------------
    const $ = (sel) => document.querySelector(sel);
    const fmt = (x) => (Math.abs(x) >= 10 ? x.toFixed(2) : x.toFixed(3));

    function cssVar(name){
      return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
    }

    // Convert CSS color to RGBA with alpha (limited: expects rgb/rgba/hex; we use computed vars -> rgb/rgba in most browsers)
    function withAlpha(color, a){
      // hex
      if(color.startsWith('#')){
        const hex = color.replace('#','');
        const v = hex.length === 3
          ? hex.split('').map(ch=>ch+ch).join('')
          : hex;
        const r = parseInt(v.slice(0,2),16);
        const g = parseInt(v.slice(2,4),16);
        const b = parseInt(v.slice(4,6),16);
        return `rgba(${r},${g},${b},${a})`;
      }
      // rgb/rgba
      const m = color.match(/rgba?\(([^)]+)\)/i);
      if(!m) return color;
      const parts = m[1].split(',').map(s=>s.trim());
      const r = parts[0], g = parts[1], b = parts[2];
      return `rgba(${r},${g},${b},${a})`;
    }

    // -----------------------------
    // Physics functions (dimensionless plotting)
    // -----------------------------
    function k_of_omega(omega, wp, c){
      // real for omega >= wp
      if(omega < wp) return NaN;
      return (1/c)*Math.sqrt(Math.max(0, omega*omega - wp*wp));
    }
    function kappa_of_omega(omega, wp, c){
      // real for omega < wp
      if(omega >= wp) return NaN;
      return (1/c)*Math.sqrt(Math.max(0, wp*wp - omega*omega));
    }
    function vph_of_omega(omega, wp, c){
      // defined for omega > wp
      if(omega <= wp) return NaN;
      return c * omega / Math.sqrt(Math.max(0, omega*omega - wp*wp));
    }
    function vg_of_omega(omega, wp, c){
      // defined for omega >= wp
      if(omega < wp) return NaN;
      return c * Math.sqrt(Math.max(0, 1 - (wp*wp)/(omega*omega)));
    }

    // -----------------------------
    // Simple plotting on canvas
    // -----------------------------
    function plotAxes(ctx, W, H, pad, xLabel, yLabel){
      const stroke = withAlpha(cssVar('--stroke') || 'rgba(255,255,255,.12)', 1);
      const text = cssVar('--muted') || 'rgba(255,255,255,.7)';

      ctx.save();
      ctx.lineWidth = 1;
      ctx.strokeStyle = stroke;

      // axes
      ctx.beginPath();
      ctx.moveTo(pad, H - pad);
      ctx.lineTo(W - pad, H - pad);
      ctx.moveTo(pad, H - pad);
      ctx.lineTo(pad, pad);
      ctx.stroke();

      ctx.fillStyle = text;
      ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace';
      ctx.fillText(xLabel, W - pad - ctx.measureText(xLabel).width, H - pad + 22);
      ctx.save();
      ctx.translate(14, pad + ctx.measureText(yLabel).width);
      ctx.rotate(-Math.PI/2);
      ctx.fillText(yLabel, 0, 0);
      ctx.restore();

      ctx.restore();
    }

    function plotCurves(canvas, curves, opts){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);

      const ctx = canvas.getContext('2d');
      ctx.scale(dpr, dpr);

      const W = rect.width, H = rect.height;
      const pad = opts.pad ?? 44;

      // Background grid
      ctx.clearRect(0,0,W,H);
      const grid = withAlpha(cssVar('--stroke') || 'rgba(255,255,255,.12)', 0.45);
      ctx.strokeStyle = grid;
      ctx.lineWidth = 1;

      const nx = 6, ny = 5;
      for(let i=1;i<nx;i++){
        const x = pad + (W-2*pad)*i/nx;
        ctx.beginPath(); ctx.moveTo(x, pad); ctx.lineTo(x, H-pad); ctx.stroke();
      }
      for(let j=1;j<ny;j++){
        const y = pad + (H-2*pad)*j/ny;
        ctx.beginPath(); ctx.moveTo(pad, y); ctx.lineTo(W-pad, y); ctx.stroke();
      }

      // Axes + labels
      plotAxes(ctx, W, H, pad, opts.xLabel, opts.yLabel);

      // Map from data to pixel
      const xMin = opts.xMin, xMax = opts.xMax;
      const yMin = opts.yMin, yMax = opts.yMax;

      function X(x){ return pad + (x - xMin) * (W - 2*pad) / (xMax - xMin); }
      function Y(y){ return (H - pad) - (y - yMin) * (H - 2*pad) / (yMax - yMin); }

      // Draw cutoff line at omega = wp if provided
      if(typeof opts.cutoff === 'number'){
        const xC = X(opts.cutoff);
        ctx.save();
        ctx.setLineDash([6,6]);
        ctx.strokeStyle = withAlpha(cssVar('--muted') || 'rgba(255,255,255,.7)', 0.6);
        ctx.beginPath(); ctx.moveTo(xC, pad); ctx.lineTo(xC, H-pad); ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = cssVar('--muted') || 'rgba(255,255,255,.7)';
        ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace';
        const label = 'ω = ωp';
        ctx.fillText(label, Math.min(W - pad - ctx.measureText(label).width, xC + 6), pad + 14);
        ctx.restore();
      }

      // Draw curves
      curves.forEach(curve=>{
        const col = curve.color;
        ctx.save();
        ctx.strokeStyle = col;
        ctx.lineWidth = 2.2;
        ctx.beginPath();

        let started = false;
        for(let i=0;i<curve.xs.length;i++){
          const x = curve.xs[i];
          const y = curve.ys[i];
          if(!isFinite(y)) { started = false; continue; }
          const px = X(x);
          const py = Y(y);
          if(!started){
            ctx.moveTo(px, py);
            started = true;
          }else{
            ctx.lineTo(px, py);
          }
        }
        ctx.stroke();

        // glow
        ctx.globalAlpha = 0.18;
        ctx.lineWidth = 6;
        ctx.stroke();
        ctx.restore();
      });

      // Caption
      if(opts.caption){
        ctx.save();
        ctx.fillStyle = cssVar('--muted') || 'rgba(255,255,255,.7)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText(opts.caption, pad, H - 12);
        ctx.restore();
      }
    }

    // -----------------------------
    // Build data for plots
    // -----------------------------
    function linspace(a,b,n){
      const out = [];
      const step = (b-a)/(n-1);
      for(let i=0;i<n;i++) out.push(a + step*i);
      return out;
    }

    function update(){
      const wp = parseFloat($('#wp').value);
      const c  = parseFloat($('#cval').value);
      $('#wpOut').value = wp.toFixed(2);
      $('#cOut').value  = c.toFixed(2);

      // Choose omega range relative to wp
      const wMin = 0.0;
      const wMax = Math.max(3.2, 2.8*wp);
      const xs = linspace(wMin, wMax, 600);

      // k / kappa
      const kVals = xs.map(w => k_of_omega(w, wp, c));
      const kapVals = xs.map(w => kappa_of_omega(w, wp, c));

      // velocities (clip for plotting)
      const vphVals = xs.map(w => vph_of_omega(w, wp, c));
      const vgVals  = xs.map(w => vg_of_omega(w, wp, c));

      // Determine y ranges
      const kMax = Math.max(...kVals.filter(Number.isFinite), ...kapVals.filter(Number.isFinite), 0.001);
      const vFinite = [...vphVals, ...vgVals].filter(Number.isFinite);
      // phase velocity can blow up near cutoff; cap for plotting
      const vCap = Math.max(c*2.8, (wp>0? c*3.5: c*2.8));
      const vMax = Math.max(Math.min(Math.max(...vFinite, 0.001), vCap), c);

      const accent = cssVar('--accent') || '#7c5cff';
      const accent2 = cssVar('--accent2') || '#00d7ff';
      const good = cssVar('--good') || '#2fe07a';
      const warn = cssVar('--warn') || '#ffcc66';

      // Gradient-like strokes as solid colors (canvas doesn't easily do per-curve gradient here)
      const colK = `linear-gradient(${accent},${accent2})`; // for legend only; use accent2-ish line
      const colKStroke = accent2;
      const colKapStroke = good;
      const colVphStroke = warn;
      const colVgStroke  = good;

      plotCurves($('#plotK'), [
        { xs, ys: kVals, color: colKStroke },
        { xs, ys: kapVals, color: colKapStroke }
      ],{
        xMin: wMin, xMax: wMax,
        yMin: 0, yMax: kMax*1.15,
        pad: 46,
        xLabel: 'ω',
        yLabel: 'k / κ',
        cutoff: wp,
        caption: 'Propagating: k(ω) for ω ≥ ωp   •   Evanescent: κ(ω) for ω < ωp'
      });

      // For vph, avoid plotting huge spikes: clip to vCap
      const vphClip = vphVals.map(v => (isFinite(v) ? Math.min(v, vCap) : NaN));
      plotCurves($('#plotV'), [
        { xs, ys: vphClip, color: colVphStroke },
        { xs, ys: vgVals,  color: colVgStroke }
      ],{
        xMin: wMin, xMax: wMax,
        yMin: 0, yMax: vMax*1.15,
        pad: 46,
        xLabel: 'ω',
        yLabel: 'velocity',
        cutoff: wp,
        caption: 'Near ω→ωp+: vph diverges (clipped here), while vg→0'
      });
    }

    // -----------------------------
    // UI events
    // -----------------------------
    function resetSliders(){
      $('#wp').value = '1.00';
      $('#cval').value = '1.00';
      update();
    }

    $('#wp').addEventListener('input', update);
    $('#cval').addEventListener('input', update);
    $('#recenter').addEventListener('click', resetSliders);

    $('#copyLink').addEventListener('click', async () => {
      try{
        await navigator.clipboard.writeText(location.href);
        $('#copyLink').textContent = 'Copied!';
        setTimeout(()=>$('#copyLink').textContent='Copy link', 900);
      }catch(e){
        $('#copyLink').textContent = 'Copy failed';
        setTimeout(()=>$('#copyLink').textContent='Copy link', 900);
      }
    });

    // Re-render plots on resize or theme changes
    window.addEventListener('resize', () => update());
    if (window.matchMedia){
      const mq = window.matchMedia('(prefers-color-scheme: light)');
      mq.addEventListener?.('change', () => setTimeout(update, 60));
    }

    // Initial
    update();
  </script>
</body>
</html>
