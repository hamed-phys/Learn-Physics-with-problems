<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#0b1020" />
  <title>Hexagonal Space Lattice: Primitive Cell, Reciprocal Lattice, and First Brillouin Zone</title>
  <style>
    :root{
      --bg:#070a12;
      --panel:#0c1222;
      --panel2:#0a1020;
      --text:#e9eefc;
      --muted:#b6c0dd;
      --faint:#7f8bb0;
      --accent:#74c0fc;
      --accent2:#63e6be;
      --warn:#ffd43b;
      --danger:#ff6b6b;
      --border:rgba(255,255,255,.10);
      --shadow: 0 14px 40px rgba(0,0,0,.45);
      --shadow2: 0 10px 28px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:14px;
      --max: 1100px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family: var(--sans);
      line-height:1.55;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(116,192,252,.18), transparent 60%),
        radial-gradient(900px 600px at 110% 10%, rgba(99,230,190,.14), transparent 55%),
        radial-gradient(700px 500px at 30% 110%, rgba(255,212,59,.10), transparent 60%),
        var(--bg);
    }

    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    code, pre{font-family:var(--mono)}
    pre{
      margin:0;
      white-space:pre-wrap;
      word-break:break-word;
      background: rgba(255,255,255,.03);
      border:1px solid var(--border);
      border-radius: 12px;
      padding: 12px 12px;
      overflow:auto;
    }

    header{
      position:relative;
      padding: 32px 18px 18px;
    }

    .wrap{
      width: min(var(--max), calc(100% - 32px));
      margin: 0 auto;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
    }

    .hero{
      grid-column: 1 / -1;
      background: linear-gradient(135deg, rgba(116,192,252,.12), rgba(99,230,190,.08));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 18px;
      overflow:hidden;
      position:relative;
    }

    .hero::after{
      content:"";
      position:absolute;
      inset:-40px -80px auto auto;
      width:260px;
      height:260px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, rgba(116,192,252,.25), transparent 55%);
      filter: blur(2px);
      transform: rotate(18deg);
      pointer-events:none;
    }

    h1{
      font-size: clamp(1.35rem, 2.2vw, 2.05rem);
      margin: 0 0 6px;
      letter-spacing: .2px;
    }
    .subtitle{
      margin: 0;
      color: var(--muted);
      max-width: 72ch;
    }
    .meta{
      margin-top: 10px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      color: var(--faint);
      font-size: .95rem;
    }
    .pill{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      padding: 6px 10px;
      border-radius: 999px;
      backdrop-filter: blur(6px);
    }

    nav.toc{
      position:sticky;
      top: 14px;
      background: rgba(12,18,34,.86);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow2);
      padding: 14px 12px;
      overflow:hidden;
    }
    nav.toc h2{
      margin: 0 0 10px;
      font-size: 1rem;
      color: var(--muted);
      display:flex;
      justify-content:space-between;
      align-items:center;
      letter-spacing:.3px;
    }
    .toc a{
      display:block;
      padding: 8px 10px;
      border-radius: 12px;
      color: var(--text);
      border: 1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size: .98rem;
    }
    .toc a:hover{
      background: rgba(116,192,252,.08);
      border-color: rgba(116,192,252,.22);
      transform: translateX(1px);
      text-decoration:none;
    }
    .toc a.active{
      background: rgba(99,230,190,.10);
      border-color: rgba(99,230,190,.28);
    }

    main{
      padding: 0 0 44px;
    }

    section{
      background: rgba(12,18,34,.78);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow2);
      padding: 16px 16px;
      margin-bottom: 16px;
      position:relative;
      overflow:hidden;
    }

    section .kicker{
      color: var(--faint);
      font-size:.9rem;
      letter-spacing:.18em;
      text-transform:uppercase;
      margin:0 0 6px;
    }
    section h2{
      margin: 0 0 10px;
      font-size: clamp(1.1rem, 1.6vw, 1.45rem);
    }
    section h3{
      margin: 14px 0 8px;
      font-size: 1.05rem;
      color: var(--muted);
    }

    ul{margin: 10px 0 0 18px}
    li{margin: 6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns: 1fr}
      nav.toc{position:relative; top:0}
      .grid2{grid-template-columns: 1fr}
    }

    .callout{
      border-radius: var(--radius2);
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
      padding: 12px 12px;
      margin: 12px 0;
      position:relative;
    }
    .callout .title{
      display:flex;
      align-items:center;
      gap:8px;
      font-weight: 700;
      margin-bottom: 6px;
      color: var(--muted);
    }
    .badge{
      font-size: .8rem;
      letter-spacing:.08em;
      text-transform:uppercase;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
      color: var(--muted);
    }
    .assump{border-left: 4px solid rgba(255,212,59,.75)}
    .keyeq{border-left: 4px solid rgba(116,192,252,.78)}
    .mist{border-left: 4px solid rgba(255,107,107,.75)}
    .final{border-left: 4px solid rgba(99,230,190,.75)}

    .eqrow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .eq{
      flex: 1 1 480px;
      min-width: 280px;
    }

    .btn{
      appearance:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      color: var(--text);
      border-radius: 12px;
      padding: 9px 10px;
      cursor:pointer;
      font-weight:600;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      box-shadow: 0 8px 16px rgba(0,0,0,.20);
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(116,192,252,.08);
      border-color: rgba(116,192,252,.25);
    }
    .btn:active{transform: translateY(0px) scale(.99)}
    .btn.small{padding: 7px 9px; font-size:.9rem; border-radius: 11px}

    details{
      border:1px solid var(--border);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.02);
      padding: 10px 12px;
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      font-weight: 700;
      color: var(--muted);
      outline:none;
    }
    summary::marker{color: var(--accent)}
    .backtop{
      display:inline-block;
      margin-top: 8px;
      padding: 7px 10px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      font-weight:600;
      transition: background .12s ease, transform .12s ease;
    }
    .backtop:hover{
      background: rgba(99,230,190,.08);
      transform: translateY(-1px);
      text-decoration:none;
    }

    .hr{
      height:1px;
      background: var(--border);
      margin: 10px 0;
    }

    .twoCols{
      columns: 2;
      column-gap: 22px;
    }
    @media (max-width: 820px){ .twoCols{columns:1} }

    .muted{color: var(--muted)}
    .faint{color: var(--faint)}
    .tight p{margin: 8px 0}
    p{margin: 10px 0}
    .mono{font-family: var(--mono)}
    .nowrap{white-space:nowrap}

    /* subtle micro-animation for section entrance (respects reduced motion) */
    @media (prefers-reduced-motion: no-preference){
      section{animation: rise .28s ease both}
      @keyframes rise{
        from{opacity:.0; transform: translateY(8px)}
        to{opacity:1; transform: translateY(0)}
      }
    }

    /* Print */
    @media print{
      body{background:#fff; color:#000}
      nav.toc{display:none}
      .wrap{width: 100%; grid-template-columns: 1fr}
      section, .hero{box-shadow:none; background:#fff; border:1px solid #bbb}
      a{color:#000; text-decoration:underline}
      .btn{display:none}
      details{break-inside:avoid}
      section{break-inside:avoid; page-break-inside:avoid}
      .pagebreak{break-before:page; page-break-before:always}
    }
  </style>
</head>
<body>
  <a id="top"></a>
  <header>
    <div class="wrap">
      <div class="hero">
        <h1>Hexagonal Space Lattice: Primitive Cell Volume, Reciprocal Lattice, and the First Brillouin Zone</h1>
        <p class="subtitle">
          A mathematically rigorous, physics-friendly derivation using vector calculus and symmetry—plus why this matters in applied physics and industrial engineering.
        </p>
        <div class="meta">
          <span class="pill">Topic: Crystallography &amp; reciprocal space</span>
          <span class="pill">Tools: dot/cross products, ∇ operators (context), Bloch k-space</span>
          <span class="pill">Result: symbolic proofs + BZ geometry</span>
        </div>
      </div>

      <nav class="toc" aria-label="Table of Contents">
        <h2>
          <span>Contents</span>
          <button class="btn small" id="btnCollapseToc" type="button" title="Collapse/expand the TOC">↕</button>
        </h2>
        <div id="tocLinks">
          <a href="#qs">Quick Summary</a>
          <a href="#p0">PART 0 — Concept Primer</a>
          <a href="#p0b">PART 0B — Industry &amp; Applied Physics</a>
          <a href="#p1">PART 1 — Problem Analysis</a>
          <a href="#p2">PART 2 — Strategy &amp; Tips</a>
          <a href="#p3">PART 3 — Full Solution</a>
          <a href="#p4">PART 4 — Deeper Understanding</a>
          <a href="#p5">PART 5 — Optional Plot Guide</a>
        </div>
      </nav>

      <main>
        <section id="qs">
          <p class="kicker">Quick Summary</p>
          <h2>What you will prove and what it means</h2>
          <ul>
            <li><strong>Goal:</strong> For a hexagonal Bravais lattice with given primitive vectors <span class="mono">a₁, a₂, a₃</span>, compute the <strong>primitive cell volume</strong> and the <strong>reciprocal lattice primitive vectors</strong> <span class="mono">b₁, b₂, b₃</span>, then <strong>describe the first Brillouin zone</strong>.</li>
            <li><strong>Key physics idea:</strong> Real-space periodicity implies reciprocal-space discreteness; wave phenomena (electrons/phonons/photons) naturally live in <span class="mono">k</span>-space, where the <strong>first Brillouin zone (BZ)</strong> is the fundamental domain.</li>
            <li><strong>Governing definitions:</strong>
              <span class="mono">V = a₁ · (a₂ × a₃)</span> and
              <span class="mono">bᵢ · aⱼ = 2π δᵢⱼ</span>.
            </li>
            <li><strong>Mathematical model:</strong> Lattice translations form a discrete additive group in ℝ³; the reciprocal lattice is its dual under the inner product (Fourier duality).</li>
            <li><strong>Main symbolic results:</strong>
              <span class="mono">V = (3^{1/2}/2) a² c</span>, and
              <span class="mono">b₁ = (2π/(√3 a)) x̂ + (2π/a) ŷ</span>,
              <span class="mono">b₂ = −(2π/(√3 a)) x̂ + (2π/a) ŷ</span>,
              <span class="mono">b₃ = (2π/c) ẑ</span>.
            </li>
            <li><strong>Geometric meaning:</strong> The reciprocal lattice is again hexagonal (same type), but its basal-plane axes are rotated relative to real space.</li>
            <li><strong>BZ shape:</strong> A <strong>hexagonal prism</strong> in <span class="mono">k</span>-space: hexagon in the <span class="mono">kₓ–kᵧ</span> plane, extruded between <span class="mono">k_z = ±π/c</span>.</li>
            <li><strong>Applied takeaway:</strong> Band structures, diffraction peak positions, and anisotropic transport are all organized by this reciprocal geometry.</li>
          </ul>
          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="p0">
          <p class="kicker">PART 0 — Concept Primer</p>
          <h2>Reciprocal space, dual lattices, and why they matter</h2>

          <div class="grid2">
            <article class="tight">
              <h3>Core definitions (symbols + SI units)</h3>
              <ul>
                <li><span class="mono">a</span> — basal-plane lattice parameter (meters).</li>
                <li><span class="mono">c</span> — lattice parameter along the hexagonal axis (meters).</li>
                <li><span class="mono">a₁, a₂, a₃</span> — real-space primitive translation vectors (meters).</li>
                <li><span class="mono">V</span> — primitive cell volume (m³), defined by the scalar triple product.</li>
                <li><span class="mono">b₁, b₂, b₃</span> — reciprocal lattice primitive vectors (1/m).</li>
                <li><span class="mono">G</span> — reciprocal lattice vector: <span class="mono">G = h b₁ + k b₂ + ℓ b₃</span> with integers <span class="mono">h,k,ℓ</span> (1/m).</li>
                <li><span class="mono">k</span> — wavevector (1/m), used in Bloch waves <span class="mono">e^{i k·r}</span>.</li>
              </ul>
            </article>

            <article class="tight">
              <h3>Physical meaning (intuition)</h3>
              <ul>
                <li><strong>Real lattice:</strong> describes spatial periodicity of atoms and material properties.</li>
                <li><strong>Reciprocal lattice:</strong> describes periodicity in Fourier space; it tells you where diffraction peaks occur and how waves “fit” the periodic medium.</li>
                <li><strong>First Brillouin zone:</strong> the “unit cell” in reciprocal space; unique wavevectors live there.</li>
                <li><strong>Hexagonal symmetry:</strong> implies sixfold rotational features in the basal plane and a special axis along <span class="mono">ẑ</span>.</li>
              </ul>
            </article>
          </div>

          <div class="callout keyeq">
            <div class="title"><span class="badge">Key equations</span> Definitions you will use repeatedly</div>
            <div class="eqrow">
              <div class="eq">
                <pre id="eqKey1">Primitive cell volume:  V = a1 · (a2 × a3)</pre>
              </div>
              <button class="btn small" type="button" data-copy="#eqKey1">Copy equation</button>
            </div>
            <div class="hr"></div>
            <div class="eqrow">
              <div class="eq">
                <pre id="eqKey2">Reciprocal basis condition:  bi · aj = 2π δij</pre>
              </div>
              <button class="btn small" type="button" data-copy="#eqKey2">Copy equation</button>
            </div>
            <div class="hr"></div>
            <div class="eqrow">
              <div class="eq">
                <pre id="eqKey3">Constructive formula:  b1 = 2π (a2×a3)/V,  b2 = 2π (a3×a1)/V,  b3 = 2π (a1×a2)/V</pre>
              </div>
              <button class="btn small" type="button" data-copy="#eqKey3">Copy equation</button>
            </div>
          </div>

          <h3>Key laws/principles and validity conditions</h3>
          <ul>
            <li><strong>Fourier duality:</strong> A periodic function <span class="mono">f(r + R) = f(r)</span> expands in discrete Fourier components <span class="mono">exp(i G·r)</span> where <span class="mono">G</span> is a reciprocal lattice vector.</li>
            <li><strong>Bloch theorem (context):</strong> For a periodic potential <span class="mono">V(r+R)=V(r)</span>, solutions of the eigenvalue PDE
              <span class="mono">[−(ħ²/2m)∇² + V(r)]ψ = Eψ</span>
              take the form <span class="mono">ψ_k(r)=u_k(r)e^{i k·r}</span> with <span class="mono">u_k</span> periodic. This makes the first BZ the natural domain for <span class="mono">k</span>.</li>
            <li><strong>Vector calculus identities:</strong> Triple products and cross products are valid in Euclidean ℝ³ with standard orthonormal basis <span class="mono">(x̂, ŷ, ẑ)</span>.</li>
          </ul>

          <h3>Common models/approximations (and why)</h3>
          <ul>
            <li><strong>Ideal Bravais lattice:</strong> perfect periodicity, infinite extent; captures symmetry cleanly and is the standard starting point for diffraction and band theory.</li>
            <li><strong>Periodic boundary conditions (PBCs):</strong> often used in simulations: restrict the domain to a cell and identify opposite faces; this discretizes <span class="mono">k</span> and links naturally to the reciprocal lattice.</li>
          </ul>

          <h3>Mini intuition examples (minimal algebra)</h3>
          <ul>
            <li><strong>1D analogy:</strong> If spacing is <span class="mono">a</span>, then reciprocal spacing is <span class="mono">2π/a</span>. Hexagonal 3D is the higher-dimensional analog with angles.</li>
            <li><strong>Diffraction:</strong> A peak occurs when <span class="mono">Δk = G</span>. So knowing <span class="mono">bᵢ</span> tells you peak positions.</li>
          </ul>

          <div class="callout mist">
            <div class="title"><span class="badge">What to watch for</span> Pitfalls and sign conventions</div>
            <ul>
              <li><strong>Order matters:</strong> <span class="mono">a₁·(a₂×a₃)</span> changes sign if you swap vectors; volume is <span class="mono">|V|</span>.</li>
              <li><strong>Units check:</strong> <span class="mono">aᵢ</span> in meters ⇒ <span class="mono">V</span> in m³ ⇒ <span class="mono">bᵢ</span> in 1/m (since <span class="mono">2π</span> is dimensionless).</li>
              <li><strong>“Self-reciprocal” ≠ identical vectors:</strong> It means “same Bravais type” (hexagonal), possibly rotated/scaled.</li>
              <li><strong>First BZ is in reciprocal space:</strong> It is the Wigner–Seitz cell of the reciprocal lattice, not of the real lattice.</li>
            </ul>
          </div>

          <div class="callout keyeq">
            <div class="title"><span class="badge">Math Insight</span> The core equation as a mathematical object</div>
            <p class="muted">
              The condition <span class="mono">bᵢ · aⱼ = 2π δᵢⱼ</span> is a <strong>dual-basis</strong> relation: the set <span class="mono">{bᵢ}</span> is the (scaled) dual basis to <span class="mono">{aⱼ}</span> under the Euclidean inner product.
              In linear algebra terms, if <span class="mono">A</span> is the 3×3 matrix with columns <span class="mono">a₁,a₂,a₃</span>, then the matrix with columns <span class="mono">b₁,b₂,b₃</span> is <span class="mono">B = 2π (A^{-1})^T</span>.
              This is the precise mathematical reason the reciprocal lattice is the “Fourier dual” of the translation group.
            </p>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="p0b">
          <p class="kicker">PART 0B — Industry &amp; Applied Physics Perspective</p>
          <h2>Why engineers care about hexagonal lattices in reciprocal space</h2>

          <h3>Where this shows up (concrete application areas)</h3>
          <ul>
            <li><strong>Metals &amp; alloys with HCP structure:</strong> Ti, Mg, Zn and many HCP alloys. Reciprocal-space geometry organizes texture analysis and slip-system activation predictions.</li>
            <li><strong>Semiconductors &amp; optoelectronics:</strong> Wurtzite (hexagonal) GaN, ZnO, SiC polytypes—band extrema locations (Γ, K, A…) matter for LEDs/lasers and mobility.</li>
            <li><strong>2D materials &amp; thin films:</strong> Graphene-like hexagonal symmetry in-plane; reciprocal lattice governs ARPES maps, moiré patterns, and diffraction from epitaxial films.</li>
          </ul>

          <h3>Why industrial engineers and applied physicists care</h3>
          <ul>
            <li><strong>Performance:</strong> anisotropic transport (thermal/electrical) depends on band curvature across the BZ.</li>
            <li><strong>Reliability:</strong> defect scattering and phonon dispersion depend on reciprocal-space selection rules.</li>
            <li><strong>Manufacturability:</strong> texture and grain orientation distributions are inferred via diffraction peaks located by <span class="mono">G</span> vectors.</li>
            <li><strong>Cost/efficiency:</strong> targeted alloying and heat treatments aim to tune microstructure; reciprocal-space measurements validate the result quickly.</li>
          </ul>

          <h3>Typical measurement/validation methods</h3>
          <ul>
            <li><strong>X-ray / neutron diffraction:</strong> peak positions index to reciprocal vectors <span class="mono">G</span> (thus to <span class="mono">bᵢ</span>).</li>
            <li><strong>Electron diffraction (TEM/SAED):</strong> directly images reciprocal-lattice patterns.</li>
            <li><strong>ARPES / inelastic scattering:</strong> maps band/phonon dispersion across the first BZ.</li>
          </ul>

          <h3>Design trade-offs and constraints (non-idealities)</h3>
          <ul>
            <li><strong>Finite crystals:</strong> broaden reciprocal peaks (uncertainty-like effect).</li>
            <li><strong>Strain/tolerances:</strong> slightly changes <span class="mono">a</span> and <span class="mono">c</span> ⇒ shifts reciprocal lattice and BZ dimensions—critical for epitaxy and thin films.</li>
            <li><strong>Defects:</strong> break perfect periodicity; reciprocal-space selection rules become approximate.</li>
          </ul>

          <details>
            <summary>From lab to product: how the idealized model is adapted</summary>
            <p>
              In real production, materials are polycrystalline with textures and residual stresses.
              Engineers still use the ideal reciprocal lattice as the “reference geometry,” then incorporate broadening (finite size), splitting (strain),
              and intensity changes (texture, structure factors) to match measured diffraction patterns.
              This is a practical workflow: <em>ideal lattice model → measured reciprocal data → fitted corrections → process control</em>.
            </p>
          </details>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="p1">
          <p class="kicker">PART 1 — Problem Analysis</p>
          <h2>Restate the problem and set up the mathematical model</h2>

          <h3>Problem restatement (in plain words)</h3>
          <p>
            You are given primitive translation vectors for a hexagonal space lattice:
          </p>
          <pre id="eqGiven">a1 = ( (√3 a)/2 ) x̂  + ( a/2 ) ŷ
a2 = −( (√3 a)/2 ) x̂ + ( a/2 ) ŷ
a3 = c ẑ</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqGiven">Copy equation</button>
          </div>

          <p>You must:</p>
          <ol>
            <li><strong>(a)</strong> Show the primitive cell volume is <span class="mono">V = (√3/2) a² c</span>.</li>
            <li><strong>(b)</strong> Show the reciprocal primitive vectors are
              <span class="mono">b₁ = (2π/(√3 a)) x̂ + (2π/a) ŷ</span>,
              <span class="mono">b₂ = −(2π/(√3 a)) x̂ + (2π/a) ŷ</span>,
              <span class="mono">b₃ = (2π/c) ẑ</span>,
              and interpret the “self-reciprocal up to rotation” statement.</li>
            <li><strong>(c)</strong> Describe and sketch (verbally) the first Brillouin zone of the hexagonal lattice.</li>
          </ol>

          <h3>Mathematical physics model (explicit)</h3>
          <div class="callout keyeq">
            <div class="title"><span class="badge">Mathematical model</span> Variables, domains, coordinates</div>
            <ul>
              <li><strong>Space:</strong> Euclidean 3D space ℝ³ with orthonormal basis <span class="mono">(x̂, ŷ, ẑ)</span>.</li>
              <li><strong>Lattice translations:</strong> <span class="mono">R = n₁ a₁ + n₂ a₂ + n₃ a₃</span>, where <span class="mono">nᵢ ∈ ℤ</span>. This is a discrete subgroup of ℝ³.</li>
              <li><strong>Reciprocal lattice:</strong> <span class="mono">G = h b₁ + k b₂ + ℓ b₃</span> with <span class="mono">h,k,ℓ ∈ ℤ</span>, where <span class="mono">bᵢ·aⱼ=2πδᵢⱼ</span>.</li>
              <li><strong>Boundary/initial conditions:</strong> None are needed for this geometry-only task. (In wave physics, periodic boundary conditions and eigenvalue problems like <span class="mono">[−(ħ²/2m)∇² + V(r)]ψ=Eψ</span> motivate the reciprocal lattice.)</li>
            </ul>
          </div>

          <h3>Relevant principles (why they apply)</h3>
          <ul>
            <li><strong>Scalar triple product</strong> gives the volume of a parallelepiped spanned by <span class="mono">a₁,a₂,a₃</span>.</li>
            <li><strong>Dual-basis construction</strong> of the reciprocal lattice via cross products ensures <span class="mono">bᵢ·aⱼ=2πδᵢⱼ</span>.</li>
            <li><strong>Brillouin zone definition:</strong> The first BZ is the Wigner–Seitz cell of the reciprocal lattice—set of points closer to <span class="mono">G=0</span> than to any other reciprocal lattice point.</li>
          </ul>

          <div class="callout assump">
            <div class="title"><span class="badge">Assumptions</span> What is idealized</div>
            <ul>
              <li>Perfect infinite periodic lattice (ideal Bravais lattice).</li>
              <li>Standard Euclidean inner product and right-handed coordinate system.</li>
              <li>We use the physics convention for reciprocal vectors with the factor <span class="mono">2π</span> built in.</li>
            </ul>
          </div>

          <h3>Possible approaches (compare 2–3)</h3>
          <ul>
            <li><strong>Approach A (vector calculus):</strong> compute <span class="mono">V=a₁·(a₂×a₃)</span> and then <span class="mono">bᵢ</span> via cross products. <em>Pros:</em> direct, geometric. <em>Cons:</em> must do careful algebra.</li>
            <li><strong>Approach B (linear algebra):</strong> build matrix <span class="mono">A=[a₁ a₂ a₃]</span>, then <span class="mono">B=2π(A^{-1})^T</span>. <em>Pros:</em> systematic. <em>Cons:</em> inversion can be algebra-heavy by hand.</li>
            <li><strong>Approach C (solve dot-product system):</strong> write <span class="mono">bᵢ=(bₓ,bᵧ,b_z)</span> and solve <span class="mono">bᵢ·aⱼ=2πδᵢⱼ</span> as linear equations. <em>Pros:</em> transparent constraints. <em>Cons:</em> still requires careful solving.</li>
          </ul>
          <p><strong>Chosen approach:</strong> Approach A, because it exposes the geometric meaning (cell volume and duality) and keeps the derivation physically interpretable.</p>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="p2">
          <p class="kicker">PART 2 — Strategy &amp; Tips</p>
          <h2>Roadmap (no full algebra yet)</h2>

          <ol>
            <li><strong>Compute</strong> <span class="mono">a₂×a₃</span> using cross-product rules. <span class="muted">Tool:</span> determinant/coordinate formula. <span class="muted">Meaning:</span> area-vector of face spanned by <span class="mono">a₂,a₃</span>.</li>
            <li><strong>Dot</strong> with <span class="mono">a₁</span> to get <span class="mono">V = a₁·(a₂×a₃)</span>. <span class="muted">Meaning:</span> base area × height.</li>
            <li><strong>Build</strong> reciprocal vectors:
              <span class="mono">b₁ = 2π (a₂×a₃)/V</span>,
              <span class="mono">b₂ = 2π (a₃×a₁)/V</span>,
              <span class="mono">b₃ = 2π (a₁×a₂)/V</span>.
              <span class="muted">Meaning:</span> dual basis scaled by <span class="mono">2π</span>.</li>
            <li><strong>Simplify</strong> components carefully; keep <span class="mono">√3</span> factors consistent. <span class="muted">Tool:</span> algebra + dimensional check.</li>
            <li><strong>Verify</strong> by direct dot products: check <span class="mono">bᵢ·aⱼ=2πδᵢⱼ</span>. <span class="muted">Meaning:</span> correctness certificate.</li>
            <li><strong>Describe BZ:</strong> interpret reciprocal lattice as hexagonal; first BZ is Wigner–Seitz cell → hexagon in basal plane and bounds in <span class="mono">k_z</span>.</li>
          </ol>

          <div class="callout mist">
            <div class="title"><span class="badge">Common mistakes</span> Quick fixes</div>
            <ul>
              <li>Forgetting that <span class="mono">x̂×ẑ = −ŷ</span> and <span class="mono">ŷ×ẑ = x̂</span> (right-hand rule).</li>
              <li>Dropping the <span class="mono">2π</span> factor (physics convention vs. crystallography convention).</li>
              <li>Using <span class="mono">V</span> instead of <span class="mono">|V|</span> when orientation is reversed (sign issue).</li>
              <li>Confusing “first BZ” with “primitive cell” in real space—they are different spaces.</li>
            </ul>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="p3">
          <p class="kicker">PART 3 — Full Solution</p>
          <h2>Step-by-step derivation with mathematical justification</h2>

          <h3>Physical intuition before calculating</h3>
          <p>
            The vectors <span class="mono">a₁</span> and <span class="mono">a₂</span> lie in the basal plane and are separated by 60° (a hallmark of hexagonal symmetry),
            while <span class="mono">a₃</span> is along <span class="mono">ẑ</span>.
            So we expect the primitive cell to look like a “tilted” parallelogram base of area proportional to <span class="mono">a²</span>, times height <span class="mono">c</span>.
            In reciprocal space, we expect a similar hexagonal pattern in the <span class="mono">kₓ–kᵧ</span> plane, and spacing <span class="mono">2π/c</span> along <span class="mono">k_z</span>.
          </p>

          <h3>(a) Primitive cell volume</h3>
          <p>
            By definition, for three non-coplanar vectors in ℝ³, the (signed) volume of the parallelepiped they span is the scalar triple product:
            <span class="mono">V = a₁ · (a₂ × a₃)</span>.
            This is valid because the cross product <span class="mono">a₂×a₃</span> gives an area vector perpendicular to the face spanned by <span class="mono">a₂,a₃</span>,
            and dotting with <span class="mono">a₁</span> projects the third edge onto that normal.
          </p>

          <details>
            <summary>Cross product reminder (coordinate formula)</summary>
            <p class="muted">
              If <span class="mono">u=(uₓ,uᵧ,u_z)</span> and <span class="mono">v=(vₓ,vᵧ,v_z)</span>, then
              <span class="mono">u×v = (uᵧ v_z − u_z vᵧ) x̂ + (u_z vₓ − uₓ v_z) ŷ + (uₓ vᵧ − uᵧ vₓ) ẑ</span>.
            </p>
          </details>

          <p><strong>Write components</strong> (from the problem):</p>
          <pre id="eqAcomp">a1 = ( (√3 a)/2,  a/2,  0 )
a2 = ( −(√3 a)/2, a/2,  0 )
a3 = ( 0, 0, c )</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqAcomp">Copy equation</button>
          </div>

          <p><strong>Compute</strong> <span class="mono">a₂ × a₃</span> using the coordinate formula:</p>
          <p class="mono">
            Let <span class="mono">a₂ = (a2ₓ, a2ᵧ, a2_z) = (−(√3 a)/2, a/2, 0)</span> and <span class="mono">a₃ = (0,0,c)</span>.
          </p>
          <pre id="eqCross23">a2 × a3
= (a2ᵧ*c − a2_z*0) x̂ + (a2_z*0 − a2ₓ*c) ŷ + (a2ₓ*0 − a2ᵧ*0) ẑ
= ( (a/2)*c ) x̂ + ( −(−(√3 a)/2)*c ) ŷ + 0 ẑ
= (ac/2) x̂ + ( (√3 a c)/2 ) ŷ</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqCross23">Copy equation</button>
          </div>

          <p><strong>Now dot with</strong> <span class="mono">a₁ = ((√3 a)/2, a/2, 0)</span>:</p>
          <pre id="eqVol">V = a1 · (a2 × a3)
  = ((√3 a)/2)*(ac/2) + (a/2)*((√3 a c)/2) + 0
  = (√3 a^2 c)/4 + (√3 a^2 c)/4
  = (√3 a^2 c)/2</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqVol">Copy equation</button>
          </div>

          <div class="callout final">
            <div class="title"><span class="badge">Final (a)</span> Primitive cell volume</div>
            <pre id="finalA">V = (√3/2) a^2 c</pre>
            <div class="eqrow" style="margin-top:10px;">
              <button class="btn small" type="button" data-copy="#finalA">Copy final answer</button>
            </div>
            <p class="faint">
              <strong>Dimensional check:</strong> <span class="mono">a²c</span> has units m³. The factor <span class="mono">√3/2</span> is dimensionless.
            </p>
          </div>

          <h3>(b) Reciprocal lattice primitive vectors</h3>
          <p>
            The reciprocal basis vectors are defined so that <span class="mono">bᵢ·aⱼ=2πδᵢⱼ</span>.
            A standard constructive way (guaranteed by vector identities and linear algebra duality) is:
          </p>
          <pre id="eqBdef">b1 = 2π (a2 × a3) / V
b2 = 2π (a3 × a1) / V
b3 = 2π (a1 × a2) / V</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqBdef">Copy equation</button>
          </div>

          <p>
            This works because, for example, <span class="mono">a₁·(a₂×a₃)=V</span> while <span class="mono">a₂·(a₂×a₃)=0</span> and <span class="mono">a₃·(a₂×a₃)=0</span>,
            so dividing by <span class="mono">V</span> enforces the Kronecker delta structure; multiplying by <span class="mono">2π</span> sets the conventional normalization for Fourier phases.
          </p>

          <h3>Compute b₁</h3>
          <p>We already computed <span class="mono">a₂×a₃ = (ac/2) x̂ + (√3 a c/2) ŷ</span> and <span class="mono">V=(√3/2)a²c</span>. Therefore:</p>
          <pre id="eqB1">b1 = 2π (a2×a3)/V
   = 2π [ (ac/2) x̂ + ( (√3 a c)/2 ) ŷ ] / [ (√3/2) a^2 c ]
   = 2π [ (ac/2) / ((√3/2) a^2 c) ] x̂ + 2π [ ( (√3 a c)/2 ) / ((√3/2) a^2 c) ] ŷ
   = 2π [ 1/(√3 a) ] x̂ + 2π [ 1/a ] ŷ</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqB1">Copy equation</button>
          </div>

          <p class="muted">
            <strong>Justification of simplification:</strong> Factors <span class="mono">c</span> cancel (reciprocal vectors in the basal plane should not depend on <span class="mono">c</span>),
            and <span class="mono">(1/2)/((√3/2)) = 1/√3</span>.
          </p>

          <h3>Compute b₂</h3>
          <p>First compute <span class="mono">a₃×a₁</span>. Using <span class="mono">a₃=(0,0,c)</span> and <span class="mono">a₁=((√3 a)/2, a/2, 0)</span>:</p>
          <pre id="eqCross31">a3 × a1
= (0,0,c) × ( (√3 a)/2, a/2, 0 )
= ( (0*0 − c*(a/2)) ) x̂ + ( (c*( (√3 a)/2 ) − 0*0) ) ŷ + (0*(a/2) − 0*( (√3 a)/2 )) ẑ
= ( −ac/2 ) x̂ + ( (√3 a c)/2 ) ŷ</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqCross31">Copy equation</button>
          </div>

          <p>Now divide by <span class="mono">V=(√3/2)a²c</span> and multiply by <span class="mono">2π</span>:</p>
          <pre id="eqB2">b2 = 2π (a3×a1)/V
   = 2π [ (−ac/2) x̂ + ( (√3 a c)/2 ) ŷ ] / [ (√3/2) a^2 c ]
   = −2π [ 1/(√3 a) ] x̂ + 2π [ 1/a ] ŷ</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqB2">Copy equation</button>
          </div>

          <h3>Compute b₃</h3>
          <p>Compute <span class="mono">a₁×a₂</span>. Since both lie in the <span class="mono">x–y</span> plane, the cross product points along <span class="mono">±ẑ</span>:</p>
          <p class="mono">
            a₁ = ( (√3 a)/2, a/2, 0 ),&nbsp;
            a₂ = ( −(√3 a)/2, a/2, 0 ).
          </p>
          <p>
            Using <span class="mono">a₁×a₂ = (0,0,a1ₓ a2ᵧ − a1ᵧ a2ₓ)</span> (since z-components are zero):
          </p>
          <pre id="eqCross12">a1 × a2 = (0,0, a1ₓ a2ᵧ − a1ᵧ a2ₓ ) ẑ
= (0,0, ( (√3 a)/2 )*(a/2) − (a/2)*( −(√3 a)/2 ) ) ẑ
= (0,0, (√3 a^2)/4 + (√3 a^2)/4 ) ẑ
= (0,0, (√3 a^2)/2 ) ẑ</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqCross12">Copy equation</button>
          </div>

          <p>
            Therefore:
          </p>
          <pre id="eqB3">b3 = 2π (a1×a2)/V
   = 2π [ ( (√3 a^2)/2 ) ẑ ] / [ (√3/2) a^2 c ]
   = 2π (1/c) ẑ
   = (2π/c) ẑ</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqB3">Copy equation</button>
          </div>

          <div class="callout final">
            <div class="title"><span class="badge">Final (b)</span> Reciprocal primitive vectors</div>
            <pre id="finalB">b1 = (2π/(√3 a)) x̂ + (2π/a) ŷ
b2 = −(2π/(√3 a)) x̂ + (2π/a) ŷ
b3 = (2π/c) ẑ</pre>
            <div class="eqrow" style="margin-top:10px;">
              <button class="btn small" type="button" data-copy="#finalB">Copy final answer</button>
            </div>
            <p class="faint">
              <strong>Dimensional check:</strong> each component scales as <span class="mono">1/a</span> or <span class="mono">1/c</span>, so units are 1/m.
            </p>
          </div>

          <h3>Verification (certificate): check bᵢ·aⱼ = 2πδᵢⱼ</h3>
          <p>
            We verify one representative set explicitly; the others follow similarly.
            Using dot products in an orthonormal basis:
          </p>
          <pre id="eqVerify">b1·a1 = [(2π/(√3 a))*(√3 a/2)] + [(2π/a)*(a/2)] = π + π = 2π
b1·a2 = [(2π/(√3 a))*(−√3 a/2)] + [(2π/a)*(a/2)] = (−π) + π = 0
b1·a3 = (basal-plane vector)·(c ẑ) = 0

b3·a3 = (2π/c)*c = 2π
b3·a1 = b3·a2 = 0</pre>
          <div class="eqrow" style="margin-top:10px;">
            <button class="btn small" type="button" data-copy="#eqVerify">Copy equation</button>
          </div>

          <p class="muted">
            <strong>Why this matters mathematically:</strong> the dot-product equalities show that <span class="mono">{bᵢ}</span> is the scaled dual basis of <span class="mono">{aᵢ}</span>,
            guaranteeing that phases <span class="mono">e^{i G·r}</span> are periodic under real-space translations <span class="mono">r → r + aⱼ</span>.
          </p>

          <details>
            <summary>“Self reciprocal but with a rotation of axes” — what exactly does that mean?</summary>
            <p>
              In the basal plane, the real-space primitive vectors point at ±30° from the <span class="mono">y</span>-axis (as written),
              while the reciprocal vectors <span class="mono">b₁,b₂</span> are also separated by 60° but oriented differently.
              The set of reciprocal lattice points forms a <em>hexagonal</em> Bravais lattice (same symmetry class) with a different length scale
              (set by <span class="mono">2π/a</span>) and a rotated in-plane basis relative to the chosen <span class="mono">x̂, ŷ</span>.
              “Its own reciprocal” means the reciprocal of a hexagonal lattice is again hexagonal (not cubic, not rectangular).
            </p>
          </details>

          <h3>(c) First Brillouin zone (BZ) description</h3>
          <p>
            <strong>Definition:</strong> The first Brillouin zone is the Wigner–Seitz cell of the reciprocal lattice:
            it is the set of all <span class="mono">k</span> points closer to the origin <span class="mono">G=0</span> than to any other reciprocal lattice point.
            Equivalently, it is bounded by planes that are perpendicular bisectors of vectors from the origin to the nearest reciprocal lattice points.
          </p>

          <p>
            For this hexagonal reciprocal lattice:
          </p>
          <ul>
            <li>In the basal plane (<span class="mono">k_z=0</span>), the reciprocal lattice points form a 2D hexagonal lattice generated by <span class="mono">b₁,b₂</span>.</li>
            <li>Along <span class="mono">k_z</span>, points are stacked with spacing <span class="mono">|b₃| = 2π/c</span>.</li>
          </ul>

          <div class="callout keyeq">
            <div class="title"><span class="badge">Nearest-plane bounds</span> Where the BZ faces sit</div>
            <p class="muted">
              The top and bottom faces come from the nearest neighbors at <span class="mono">±b₃</span>, so the perpendicular bisector planes are at
              <span class="mono">k·ẑ = ±|b₃|/2 = ±π/c</span>.
              In-plane, the nearest reciprocal lattice points around the origin generate six bisector lines, making a regular hexagon.
            </p>
          </div>

          <p>
            <strong>Thus, the first BZ is a hexagonal prism:</strong>
          </p>
          <ul>
            <li><strong>Base:</strong> a regular hexagon in the <span class="mono">kₓ–kᵧ</span> plane, centered at Γ (<span class="mono">k=0</span>).</li>
            <li><strong>Height:</strong> extends from <span class="mono">k_z = −π/c</span> to <span class="mono">k_z = +π/c</span>.</li>
            <li><strong>Side faces:</strong> six vertical planes that bisect the vectors from Γ to the six nearest in-plane reciprocal points.</li>
          </ul>

          <details>
            <summary>High-symmetry points commonly used in band structures (naming)</summary>
            <p class="muted">
              Standard labels (convention-dependent) often include:
              Γ at center; K at hexagon corners; M at hexagon edge centers in the basal plane;
              A directly above Γ at <span class="mono">k_z=π/c</span>; H above K; L above M.
              These organize dispersion plots <span class="mono">E(k)</span> or <span class="mono">ω(k)</span>.
            </p>
          </details>

          <div class="callout final">
            <div class="title"><span class="badge">Final (c)</span> First Brillouin zone</div>
            <pre id="finalC">The first Brillouin zone of the hexagonal lattice is a hexagonal prism in k-space:
- In-plane (kz = 0): a regular hexagon (Wigner–Seitz cell of the 2D hexagonal reciprocal lattice).
- Along kz: bounded by kz = ±π/c (since b3 = (2π/c) ẑ).
So: a hexagonal cross-section extruded between kz = −π/c and kz = +π/c.</pre>
            <div class="eqrow" style="margin-top:10px;">
              <button class="btn small" type="button" data-copy="#finalC">Copy final answer</button>
            </div>
          </div>

          <div class="callout final">
            <div class="title"><span class="badge">Copy</span> Full final answers (a)–(c) as plain text</div>
            <pre id="finalAll">(a) V = a1 · (a2 × a3) = (√3/2) a^2 c.

(b) b1 = 2π (a2×a3)/V = (2π/(√3 a)) x̂ + (2π/a) ŷ,
    b2 = 2π (a3×a1)/V = −(2π/(√3 a)) x̂ + (2π/a) ŷ,
    b3 = 2π (a1×a2)/V = (2π/c) ẑ,
and bi·aj = 2π δij, so the reciprocal lattice is hexagonal (same Bravais type), with an in-plane basis rotated relative to the chosen axes.

(c) The first Brillouin zone is the Wigner–Seitz cell of the reciprocal lattice: a hexagonal prism.
It is bounded by kz = ±π/c and has a regular-hexagon cross-section in the kx–ky plane.</pre>
            <div class="eqrow" style="margin-top:10px;">
              <button class="btn small" type="button" data-copy="#finalAll">Copy final answer</button>
            </div>
          </div>

          <h3>Sanity checks</h3>
          <ul>
            <li><strong>Units:</strong> <span class="mono">V</span> scales like <span class="mono">a²c</span> (m³); <span class="mono">b</span> scales like <span class="mono">1/a</span> or <span class="mono">1/c</span> (1/m).</li>
            <li><strong>Limiting cases:</strong> If <span class="mono">c</span> increases, <span class="mono">b₃=2π/c</span> decreases, so the BZ becomes thinner in <span class="mono">k_z</span>—consistent with longer real-space period giving smaller reciprocal spacing.</li>
            <li><strong>Orientation/sign:</strong> If you permute <span class="mono">a₁,a₂,a₃</span>, the signed volume changes; using the same ordering in the reciprocal construction preserves consistency.</li>
            <li><strong>Physical interpretation:</strong> Reciprocal vectors define the periodicity of plane-wave phases; moving by <span class="mono">aⱼ</span> changes <span class="mono">e^{i G·r}</span> by <span class="mono">e^{i 2π integer}=1</span>.</li>
          </ul>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="p4">
          <p class="kicker">PART 4 — Deeper Understanding</p>
          <h2>Interpreting the result and connecting to broader theory</h2>

          <h3>Re-interpret the final formulas</h3>
          <ul>
            <li><strong>Volume:</strong> <span class="mono">V=(√3/2)a²c</span> = (area of 60° rhombus) × (height). The factor <span class="mono">√3/2</span> is exactly <span class="mono">sin(60°)</span>, reflecting hexagonal geometry.</li>
            <li><strong>Reciprocal scaling:</strong> <span class="mono">|b₃|=2π/c</span> depends only on the real-space period along <span class="mono">ẑ</span>, while <span class="mono">b₁,b₂</span> depend only on <span class="mono">a</span>.</li>
            <li><strong>Rotation statement:</strong> the reciprocal lattice is hexagonal because the dual of a 2D hexagonal lattice is another 2D hexagonal lattice (up to rotation and scaling), and stacking along <span class="mono">ẑ</span> preserves that Bravais type.</li>
          </ul>

          <h3>Parameter dependence (qualitative)</h3>
          <ul>
            <li>If <span class="mono">a</span> increases ⇒ in-plane reciprocal spacing decreases (BZ base shrinks).</li>
            <li>If <span class="mono">c</span> increases ⇒ <span class="mono">b₃</span> decreases ⇒ BZ height shrinks (in <span class="mono">k_z</span> extent).</li>
            <li>Anisotropy in <span class="mono">a</span> vs <span class="mono">c</span> maps directly to anisotropy in reciprocal space—and hence to anisotropy in dispersion relations <span class="mono">E(k)</span>, <span class="mono">ω(k)</span>.</li>
          </ul>

          <h3>Alternative derivation idea (brief but meaningful)</h3>
          <p>
            Build the 3×3 matrix <span class="mono">A=[a₁ a₂ a₃]</span>. The dual basis (without the <span class="mono">2π</span>) is given by <span class="mono">(A^{-1})^T</span>.
            Multiplying by <span class="mono">2π</span> yields <span class="mono">B=2π(A^{-1})^T</span>. This is a clean linear-algebra proof of the same results and clarifies the “dual space” nature.
          </p>

          <div class="callout keyeq">
            <div class="title"><span class="badge">Math Insight</span> Conservation / PDE context (why ∇ shows up even in a geometry problem)</div>
            <p class="muted">
              In wave/quantum problems, the periodic lattice appears as a periodic coefficient in PDEs.
              Example: Schrödinger eigenproblem <span class="mono">[−(ħ²/2m)∇² + V(r)]ψ = Eψ</span> with <span class="mono">V(r+R)=V(r)</span>,
              or elasticity/phonons with operators involving <span class="mono">∇·</span> and <span class="mono">∇×</span>.
              Fourier analysis turns spatial derivatives into multiplication by <span class="mono">ik</span>, making the reciprocal lattice the natural discrete set for expansions.
              The first BZ is then the minimal domain of unique eigenlabels <span class="mono">k</span>.
            </p>
          </div>

          <h3>Concept check (self-test Q&amp;A)</h3>
          <ul>
            <li><strong>Q:</strong> Why does <span class="mono">b₃</span> depend on <span class="mono">c</span> but not on <span class="mono">a</span>?<br/>
              <strong>A:</strong> Because <span class="mono">b₃ ∥ (a₁×a₂)</span> and <span class="mono">a₁×a₂</span> depends only on the basal plane; the only remaining scale comes from dividing by the volume, introducing <span class="mono">1/c</span>.</li>
            <li><strong>Q:</strong> What does <span class="mono">bᵢ·aⱼ=2πδᵢⱼ</span> guarantee about <span class="mono">e^{iG·r}</span>?<br/>
              <strong>A:</strong> Translating by any <span class="mono">aⱼ</span> changes the phase by <span class="mono">e^{i 2π integer}=1</span>, so the plane wave is periodic on the lattice.</li>
            <li><strong>Q:</strong> Why is the first BZ a prism here?<br/>
              <strong>A:</strong> Because the reciprocal lattice is a 2D hexagonal lattice in-plane stacked periodically along <span class="mono">k_z</span>; the Wigner–Seitz construction therefore extrudes the 2D hexagon between the nearest <span class="mono">±b₃</span> bisector planes.</li>
            <li><strong>Q:</strong> If you double <span class="mono">a</span>, what happens to the in-plane BZ size?<br/>
              <strong>A:</strong> It shrinks by a factor of 2 in linear dimensions because <span class="mono">b₁,b₂ ∝ 1/a</span>.</li>
          </ul>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="p5">
          <p class="kicker">PART 5 — Optional Plot Guide</p>
          <h2>Why no plot is necessary here</h2>
          <p>
            This problem is purely symbolic and geometric: it asks for exact vector formulas and a qualitative Brillouin-zone description.
            A numerical plot would require selecting example values for <span class="mono">a</span> and <span class="mono">c</span>, which is not needed to understand or verify the derivation.
          </p>
          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <footer class="pagebreak" style="margin-top:10px; color:var(--faint); padding: 0 6px;">
          <p style="margin:0;">
            <strong>Note:</strong> All results follow from Euclidean vector calculus and the dual-basis definition of reciprocal lattices.
            In applied physics, these objects become the backbone for diffraction, dispersion, and band-structure computations.
          </p>
        </footer>
      </main>
    </div>
  </header>

  <script>
    (function(){
      const tocLinks = Array.from(document.querySelectorAll('.toc a'));
      const sections = tocLinks
        .map(a => document.querySelector(a.getAttribute('href')))
        .filter(Boolean);

      function setActive(){
        const y = window.scrollY || document.documentElement.scrollTop;
        const offset = 120;
        let bestIdx = 0;
        for(let i=0;i<sections.length;i++){
          const s = sections[i];
          const top = s.getBoundingClientRect().top + y;
          if(top - offset <= y) bestIdx = i;
        }
        tocLinks.forEach((a,i)=>a.classList.toggle('active', i===bestIdx));
      }
      window.addEventListener('scroll', setActive, {passive:true});
      setActive();

      // Copy buttons
      async function copyTextFromSelector(sel){
        const el = document.querySelector(sel);
        if(!el) return;
        const text = el.innerText.replace(/\r\n/g,"\n");
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch(e){
          // fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position='fixed';
          ta.style.left='-9999px';
          document.body.appendChild(ta);
          ta.focus(); ta.select();
          try{ document.execCommand('copy'); }
          catch(err){}
          document.body.removeChild(ta);
          return true;
        }
      }

      document.querySelectorAll('[data-copy]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const sel = btn.getAttribute('data-copy');
          const ok = await copyTextFromSelector(sel);
          const old = btn.textContent;
          btn.textContent = ok ? 'Copied ✓' : 'Copy failed';
          setTimeout(()=>btn.textContent = old, 900);
        });
      });

      // TOC collapse
      const btnCollapse = document.getElementById('btnCollapseToc');
      const toc = document.getElementById('tocLinks');
      let collapsed = false;
      btnCollapse.addEventListener('click', ()=>{
        collapsed = !collapsed;
        toc.style.display = collapsed ? 'none' : 'block';
        btnCollapse.textContent = collapsed ? '↔' : '↕';
        btnCollapse.title = collapsed ? 'Expand the TOC' : 'Collapse/expand the TOC';
      });
    })();
  </script>
</body>
</html>
