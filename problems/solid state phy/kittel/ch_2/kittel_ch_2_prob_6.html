<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark">
  <title>Hydrogen Atom Form Factor (Ground State): Full Derivation</title>
  <style>
    :root{
      --bg:#0b0e14;
      --panel:#101826;
      --text:#e9eef7;
      --muted:#b8c4d9;
      --faint:#7f90ad;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border:rgba(255,255,255,.10);
      --shadow: 0 16px 40px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      --radius: 18px;
      --radius2: 26px;
      --maxw: 1100px;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8fc;
        --panel:#ffffff;
        --text:#0c1320;
        --muted:#334155;
        --faint:#64748b;
        --accent:#0284c7;
        --accent2:#6d28d9;
        --ok:#059669;
        --warn:#b45309;
        --bad:#be123c;
        --border:rgba(2,6,23,.10);
        --shadow: 0 16px 40px rgba(2,6,23,.10);
      }
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      background: radial-gradient(1200px 700px at 20% 10%, rgba(125,211,252,.14), transparent 50%),
                  radial-gradient(1000px 600px at 80% 20%, rgba(167,139,250,.12), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }

    a{ color:var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    header{
      padding: 28px 18px 12px;
    }
    .wrap{
      max-width: var(--maxw);
      margin:0 auto;
      padding: 0 18px 56px;
      display:grid;
      grid-template-columns: 300px 1fr;
      gap: 18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .wrap{ grid-template-columns: 1fr; }
    }

    .hero{
      max-width: var(--maxw);
      margin:0 auto;
      padding: 0 18px 10px;
    }
    .heroCard{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0));
      border:1px solid var(--border);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 18px 18px 14px;
      overflow:hidden;
      position:relative;
    }
    .heroCard:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(500px 220px at 10% 0%, rgba(125,211,252,.18), transparent 60%),
                  radial-gradient(560px 240px at 90% 0%, rgba(167,139,250,.16), transparent 60%);
      pointer-events:none;
      filter: blur(0px);
      opacity:.9;
    }
    .heroInner{ position:relative; }
    .kicker{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      color:var(--muted);
      font-size: 13px;
    }
    .pill{
      border:1px solid var(--border);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.05);
      backdrop-filter: blur(6px);
    }
    h1{
      margin: 10px 0 8px;
      line-height:1.15;
      font-size: clamp(22px, 3.2vw, 36px);
      letter-spacing: -0.02em;
    }
    .subtitle{
      margin: 0;
      color: var(--muted);
      max-width: 80ch;
    }

    nav.toc{
      position: sticky;
      top: 14px;
      background: rgba(16,24,38,.65);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px 12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    @media (prefers-color-scheme: light){
      nav.toc{ background: rgba(255,255,255,.75); }
    }
    .tocTitle{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    .tocTitle strong{ font-size:14px; }
    .toc small{ color:var(--faint); }
    .toc a{
      display:block;
      padding: 8px 10px;
      border-radius: 12px;
      color: var(--text);
      border:1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size: 13px;
    }
    .toc a:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.25);
      transform: translateY(-1px);
      text-decoration:none;
    }
    .toc a.active{
      background: rgba(167,139,250,.12);
      border-color: rgba(167,139,250,.30);
    }

    main{
      min-width:0;
    }
    section{
      background: rgba(16,24,38,.55);
      border:1px solid var(--border);
      border-radius: var(--radius2);
      padding: 16px 16px 14px;
      box-shadow: var(--shadow);
      margin-bottom: 14px;
      overflow:hidden;
      position:relative;
    }
    @media (prefers-color-scheme: light){
      section{ background: rgba(255,255,255,.85); }
    }
    section h2{
      margin: 0 0 10px;
      font-size: 18px;
      letter-spacing:-0.01em;
      display:flex; align-items:center; gap:10px;
    }
    .anchor{
      font-size: 12px;
      color: var(--faint);
      border:1px solid var(--border);
      padding: 3px 8px;
      border-radius: 999px;
    }
    p{ margin: 10px 0; color: var(--text); }
    ul{ margin: 8px 0 10px 18px; color: var(--text); }
    li{ margin: 6px 0; color: var(--text); }
    .muted{ color: var(--muted); }
    .faint{ color: var(--faint); }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 760px){
      .grid2{ grid-template-columns: 1fr; }
    }

    .callout{
      border:1px solid var(--border);
      border-radius: var(--radius);
      padding: 12px 12px 10px;
      background: rgba(255,255,255,.04);
      position:relative;
    }
    .callout:before{
      content:"";
      position:absolute;
      inset:0;
      border-radius: var(--radius);
      pointer-events:none;
      background: linear-gradient(90deg, rgba(125,211,252,.14), rgba(167,139,250,.10), transparent 70%);
      opacity:.65;
      mask: linear-gradient(#000, transparent 120%);
    }
    .callout > *{ position:relative; }
    .tagRow{ display:flex; gap:10px; flex-wrap:wrap; margin-bottom:8px; }
    .tag{
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
    }
    .tag.ok{ color: var(--ok); border-color: rgba(52,211,153,.35); background: rgba(52,211,153,.08); }
    .tag.warn{ color: var(--warn); border-color: rgba(251,191,36,.35); background: rgba(251,191,36,.08); }
    .tag.bad{ color: var(--bad); border-color: rgba(251,113,133,.35); background: rgba(251,113,133,.08); }

    .eqBlock{
      border:1px solid var(--border);
      border-radius: var(--radius);
      overflow:hidden;
      background: rgba(0,0,0,.18);
    }
    @media (prefers-color-scheme: light){
      .eqBlock{ background: rgba(2,6,23,.04); }
    }
    .eqHead{
      display:flex; justify-content:space-between; align-items:center;
      gap:10px;
      padding: 10px 10px;
      border-bottom:1px solid var(--border);
      background: rgba(255,255,255,.04);
    }
    .eqHead strong{
      font-size: 13px;
      color: var(--muted);
    }
    .btn{
      appearance:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 7px 10px;
      border-radius: 12px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size: 12px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: rgba(125,211,252,.35);
      background: rgba(125,211,252,.10);
    }
    .btn:active{ transform: translateY(0px); }
    .btn.secondary:hover{
      border-color: rgba(167,139,250,.35);
      background: rgba(167,139,250,.10);
    }
    pre{
      margin:0;
      padding: 12px 12px 12px;
      font-family: var(--mono);
      font-size: 13px;
      white-space: pre-wrap;
      word-break: break-word;
      color: var(--text);
    }
    code{
      font-family: var(--mono);
      font-size: 0.95em;
    }

    details{
      border:1px solid var(--border);
      border-radius: var(--radius);
      padding: 10px 12px;
      background: rgba(255,255,255,.03);
      margin: 10px 0 0;
    }
    summary{
      cursor:pointer;
      color: var(--muted);
      font-weight: 650;
    }

    figure{
      margin: 10px 0 0;
      border:1px solid var(--border);
      border-radius: var(--radius2);
      overflow:hidden;
      background: rgba(255,255,255,.03);
    }
    figcaption{
      padding: 10px 12px;
      color: var(--muted);
      border-top:1px solid var(--border);
      font-size: 13px;
    }
    canvas{ display:block; width:100%; height:340px; }

    .backTop{
      display:inline-flex;
      margin-top: 10px;
      font-size: 13px;
      align-items:center;
      gap:8px;
      color: var(--muted);
    }
    .backTop:hover{ color: var(--text); text-decoration:none; }

    footer{
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 18px 18px 36px;
      color: var(--faint);
      font-size: 13px;
    }

    .toast{
      position: fixed;
      right: 14px;
      bottom: 14px;
      background: rgba(16,24,38,.85);
      border: 1px solid var(--border);
      padding: 10px 12px;
      border-radius: 14px;
      box-shadow: var(--shadow);
      color: var(--text);
      font-size: 13px;
      opacity:0;
      transform: translateY(8px);
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      backdrop-filter: blur(10px);
      z-index: 30;
    }
    @media (prefers-color-scheme: light){
      .toast{ background: rgba(255,255,255,.90); }
    }
    .toast.show{ opacity:1; transform: translateY(0); }

    /* Print friendly */
    @media print{
      body{ background:#fff; color:#000; }
      nav.toc{ display:none; }
      .heroCard, section{ box-shadow:none; background:#fff; }
      .btn{ display:none; }
      a{ color:#000; text-decoration:underline; }
      section{ break-inside: avoid; page-break-inside: avoid; }
      .pageBreak{ break-before: page; page-break-before: always; }
      canvas{ height: 260px; }
    }
  </style>
</head>
<body>
  <a id="top"></a>

  <header class="hero">
    <div class="heroCard">
      <div class="heroInner">
        <div class="kicker">
          <span class="pill">Quantum + Mathematical Physics</span>
          <span class="pill">Fourier Transform of Charge Density</span>
          <span class="pill">Applied/Industry Lens</span>
        </div>
        <h1>Form Factor of Atomic Hydrogen (Ground State)</h1>
        <p class="subtitle">
          We compute the elastic scattering form factor of the hydrogen 1s electron density by reducing a 3D Fourier transform
          to a 1D radial integral using spherical symmetry, then evaluating it exactly with clean mathematical steps.
        </p>
      </div>
    </div>
  </header>

  <div class="wrap">
    <nav class="toc" aria-label="Table of contents">
      <div class="tocTitle">
        <strong>Table of Contents</strong>
        <small id="tocHint">sticky</small>
      </div>
      <a href="#quick-summary">Quick Summary</a>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry &amp; Applied Physics</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy &amp; Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Optional Plot Guide</a>
      <a href="#final">Final Answer</a>
    </nav>

    <main>
      <section id="quick-summary">
        <h2>Quick Summary <span class="anchor">overview</span></h2>
        <ul>
          <li><strong>What this is:</strong> Compute the <em>atomic form factor</em> (normalized Fourier transform) of hydrogen’s 1s electron number density.</li>
          <li><strong>Key physics idea:</strong> Elastic scattering amplitude depends on how charge/number density is distributed in space; in reciprocal space it is a Fourier transform.</li>
          <li><strong>Governing equation:</strong> <code>f(G) = ∫ n(r) e^{i G·r} d^3r</code> with <code>∫ n(r) d^3r = 1</code>.</li>
          <li><strong>Symmetry move:</strong> Spherical symmetry reduces 3D Fourier transform to a 1D radial integral with the <code>sin(Gr)/(Gr)</code> kernel.</li>
          <li><strong>Exact result (symbolic):</strong> <code>f(G) = 16 / (4 + G^2 a0^2)^2</code>.</li>
          <li><strong>Meaning:</strong> High spatial-frequency scattering (<code>G</code> large) is suppressed as <code>~ G^{-4}</code>, reflecting the smooth exponential density.</li>
          <li><strong>Sanity checks:</strong> <code>f(0)=1</code> (normalization), and <code>f(G)→0</code> as <code>G→∞</code>.</li>
        </ul>
      </section>

      <section id="part0">
        <h2>PART 0 — Concept Primer <span class="anchor">theory</span></h2>

        <div class="grid2">
          <div class="callout">
            <div class="tagRow">
              <span class="tag ok">Core definition</span>
              <span class="tag">Fourier transform</span>
              <span class="tag">Spherical symmetry</span>
            </div>
            <p>
              In scattering (X-ray, electron, neutron), the <strong>form factor</strong> of a localized density
              is the (normalized) Fourier transform of that density. For a number density <code>n(r)</code>:
            </p>
            <div class="eqBlock">
              <div class="eqHead">
                <strong>Form factor definition</strong>
                <button class="btn" data-copy="#eq_def">Copy equation</button>
              </div>
              <pre id="eq_def">f(G) = ∫_{R^3} n(r) e^{i G·r} d^3r,   with   ∫_{R^3} n(r) d^3r = 1</pre>
            </div>
            <p class="muted">
              Here <code>G</code> is a wavevector transfer magnitude (often called <code>q</code> in scattering),
              with units <code>[G] = 1/m</code>. The form factor is dimensionless.
            </p>
          </div>

          <div class="callout">
            <div class="tagRow">
              <span class="tag ok">Key reduction</span>
              <span class="tag">Angular integration</span>
            </div>
            <p>
              If <code>n(r)</code> depends only on <code>r = |r|</code>, then the Fourier transform depends only on <code>G = |G|</code>.
              Choose coordinates with <code>G</code> along <code>z</code> so that <code>G·r = G r cosθ</code>.
            </p>
            <p class="muted">
              The angular integral produces the spherical Bessel kernel:
              <code>∫ e^{i G r cosθ} dΩ = 4π sin(Gr)/(Gr)</code>.
            </p>
            <div class="eqBlock">
              <div class="eqHead">
                <strong>Spherically symmetric transform</strong>
                <button class="btn" data-copy="#eq_sph">Copy equation</button>
              </div>
              <pre id="eq_sph">f(G) = 4π ∫_0^∞ r^2 n(r) [sin(Gr)/(Gr)] dr</pre>
            </div>
          </div>
        </div>

        <h3 style="margin:14px 0 8px; font-size:16px;">Core definitions (symbols + SI units)</h3>
        <ul>
          <li><code>r</code>: radial coordinate in real space (m). Domain: <code>r ∈ [0, ∞)</code>.</li>
          <li><code>n(r)</code>: number density of the electron (1/m³). Normalization: <code>∫ n d^3r = 1</code>.</li>
          <li><code>a0</code>: Bohr radius (m). Characteristic length scale of hydrogen 1s orbital.</li>
          <li><code>G</code>: magnitude of scattering wavevector transfer (1/m). Domain: <code>G ∈ [0, ∞)</code>.</li>
          <li><code>f(G)</code>: dimensionless form factor (normalized scattering amplitude from the density).</li>
        </ul>

        <h3 style="margin:14px 0 8px; font-size:16px;">Physical meaning &amp; validity conditions</h3>
        <ul>
          <li><strong>Physical meaning:</strong> <code>f(G)</code> tells you how strongly the density “responds” at spatial frequency <code>G</code>. Large <code>G</code> probes fine spatial detail.</li>
          <li><strong>Regime:</strong> Elastic, single-particle density picture; the electron density is taken as fixed (ground state) and spherically symmetric.</li>
          <li><strong>Normalization:</strong> Using number density normalized to 1 forces <code>f(0)=1</code>, representing total number of electrons.</li>
        </ul>

        <h3 style="margin:14px 0 8px; font-size:16px;">Common models/approximations in this topic</h3>
        <ul>
          <li><strong>Independent-particle density:</strong> Replace full many-body wavefunction by a one-body density (exact for one-electron hydrogen).</li>
          <li><strong>Spherical symmetry:</strong> Use for s-states (like 1s) to reduce 3D integrals.</li>
          <li><strong>Born approximation (scattering):</strong> Often the measured amplitude is proportional to the Fourier transform of density/potential; the form factor enters cross-sections.</li>
        </ul>

        <h3 style="margin:14px 0 8px; font-size:16px;">Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li><strong>Point-like density:</strong> If <code>n(r)=δ^3(r)</code>, then <code>f(G)=1</code> for all <code>G</code> (all spatial frequencies present equally).</li>
          <li><strong>Broader density:</strong> If <code>n(r)</code> spreads out, then <code>f(G)</code> decays faster with <code>G</code> (fine details are washed out).</li>
          <li><strong>Exponential tail:</strong> Exponential densities produce rational functions in <code>G</code> with power-law decay at large <code>G</code>.</li>
        </ul>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag warn">What to watch for</span>
            <span class="tag">pitfalls</span>
          </div>
          <ul>
            <li><strong>Normalization:</strong> Check <code>∫ n d^3r = 1</code>; otherwise your <code>f(0)</code> will be wrong.</li>
            <li><strong>Kernel:</strong> Don’t forget <code>sin(Gr)/(Gr)</code> from angular integration.</li>
            <li><strong>Units:</strong> Ensure <code>G a0</code> is dimensionless; the final form factor must be dimensionless.</li>
            <li><strong>Limit <code>G→0</code>:</strong> Use <code>sin(Gr)/(Gr)→1</code> smoothly—avoid dividing by zero without taking the limit.</li>
          </ul>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Math Insight</span>
            <span class="tag">kernel as operator</span>
          </div>
          <p class="muted">
            Think of <code>f(G)</code> as the action of the <strong>Fourier transform operator</strong> on a radial function:
            the 3D transform of a spherically symmetric function is a <strong>Hankel-type transform</strong> (spherical Bessel transform).
            The kernel <code>sin(Gr)/(Gr)</code> is the spherical Bessel function <code>j0(Gr)</code>, so mathematically:
            <code>f(G) = 4π ∫_0^∞ r^2 n(r) j0(Gr) dr</code>.
          </p>
        </div>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry &amp; Applied Physics Perspective <span class="anchor">applied</span></h2>
        <ul>
          <li><strong>Materials characterization:</strong> X-ray and electron diffraction use atomic form factors to interpret scattering intensity and infer structure factors, bonding, and electron density redistribution.</li>
          <li><strong>Semiconductor &amp; nanotechnology:</strong> Scattering factors enter modeling of electron microscopy (TEM/STEM), impacting resolution limits, contrast mechanisms, and quantitative composition mapping.</li>
          <li><strong>Radiation interaction &amp; shielding:</strong> Electron density distributions affect differential cross-sections; used in simulation codes for radiation transport and detector design.</li>
        </ul>
        <p class="muted">
          Engineers care because form factors influence <strong>measurement accuracy</strong> (calibration of scattering experiments),
          <strong>device reliability</strong> (material defects and impurities diagnosed by diffraction),
          and <strong>cost/time</strong> (faster convergence in inverse problems when correct physics constraints are used).
        </p>

        <div class="grid2">
          <div class="callout">
            <div class="tagRow">
              <span class="tag">Validation methods</span>
              <span class="tag ok">in practice</span>
            </div>
            <ul>
              <li><strong>Diffraction fitting:</strong> Compare measured intensities to models using tabulated/derived form factors.</li>
              <li><strong>Electron microscopy simulations:</strong> Multislice methods incorporate scattering potentials derived from electron densities.</li>
              <li><strong>Spectroscopy cross-check:</strong> Use photoelectron spectroscopy/Compton profiles to validate momentum/real-space distributions.</li>
            </ul>
          </div>
          <div class="callout">
            <div class="tagRow">
              <span class="tag warn">Design trade-offs</span>
              <span class="tag">non-idealities</span>
            </div>
            <ul>
              <li><strong>Real atoms ≠ isolated hydrogen:</strong> In solids, densities deform (bonding), so effective form factors differ.</li>
              <li><strong>Temperature:</strong> Thermal motion adds Debye–Waller factors that further damp high-<code>G</code> scattering.</li>
              <li><strong>Instrument limits:</strong> Finite detector range caps accessible <code>G</code>, limiting spatial resolution in reconstructions.</li>
            </ul>
          </div>
        </div>

        <details>
          <summary>From lab to product: how the ideal model gets adapted</summary>
          <p class="muted">
            In real materials and devices, you rarely use the pure hydrogenic density directly. Instead you use:
            (i) tabulated atomic form factors (often parameterized sums of Gaussians),
            (ii) effective densities from density-functional theory (DFT),
            and (iii) corrections for thermal vibration, bonding, and multiple scattering.
            The hydrogen result remains a clean benchmark: it teaches how a localized exponential density maps into a rational function in reciprocal space.
          </p>
        </details>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis <span class="anchor">setup</span></h2>
        <p><strong>Problem (rephrased):</strong> The hydrogen atom ground-state electron number density is</p>

        <div class="eqBlock">
          <div class="eqHead">
            <strong>Given density</strong>
            <button class="btn" data-copy="#eq_given">Copy equation</button>
          </div>
          <pre id="eq_given">n(r) = (1 / (π a0^3)) exp(-2r/a0)</pre>
        </div>

        <p>Show that its form factor is</p>
        <div class="eqBlock">
          <div class="eqHead">
            <strong>Target result</strong>
            <button class="btn secondary" data-copy="#eq_target">Copy equation</button>
          </div>
          <pre id="eq_target">f(G) = 16 / (4 + G^2 a0^2)^2</pre>
        </div>

        <h3 style="margin:14px 0 8px; font-size:16px;">Mathematical model (explicit)</h3>
        <ul>
          <li><strong>Variables:</strong> <code>r ∈ R^3</code> (position), <code>G ∈ R^3</code> (reciprocal-space vector), magnitudes <code>r=|r|</code>, <code>G=|G|</code>.</li>
          <li><strong>Domain:</strong> All space: <code>r ∈ R^3</code>; radial coordinate <code>r ∈ [0,∞)</code>.</li>
          <li><strong>Coordinate system:</strong> Spherical coordinates <code>(r,θ,φ)</code> with polar axis chosen along <code>G</code> (so <code>G·r = G r cosθ</code>).</li>
          <li><strong>Boundary conditions:</strong> Localization: <code>n(r) → 0</code> as <code>r→∞</code> fast enough for integrability; finite at <code>r=0</code>.</li>
          <li><strong>Normalization constraint:</strong> <code>∫_{R^3} n(r) d^3r = 1</code> (one electron).</li>
        </ul>

        <h3 style="margin:14px 0 8px; font-size:16px;">Unknowns &amp; what must be proved</h3>
        <ul>
          <li><strong>Unknown:</strong> The function <code>f(G)</code>.</li>
          <li><strong>Prove:</strong> The closed-form expression <code>f(G) = 16/(4 + G^2 a0^2)^2</code>.</li>
        </ul>

        <h3 style="margin:14px 0 8px; font-size:16px;">Relevant principles/laws (and why)</h3>
        <ul>
          <li><strong>Fourier transform linearity:</strong> Allows direct integration of <code>n(r)</code> times an oscillatory kernel.</li>
          <li><strong>Rotational symmetry:</strong> Because <code>n(r)</code> depends only on <code>r</code>, <code>f</code> depends only on <code>G</code>. This justifies aligning axes with <code>G</code>.</li>
          <li><strong>Convergence:</strong> Exponential decay guarantees absolute convergence and legitimizes standard integral manipulations (e.g., taking imaginary parts, differentiating parameter integrals) when done carefully.</li>
        </ul>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Assumptions</span>
            <span class="tag">explicit</span>
          </div>
          <ul>
            <li>Hydrogen is in the ground (1s) state; the density is spherically symmetric.</li>
            <li>We use the standard physics convention for the form factor with <code>e^{i G·r}</code> and no <code>(2π)</code> factors (as commonly used in crystallography/scattering definitions).</li>
            <li>Elastic, static density (no time dependence, so no <code>∂/∂t</code> terms).</li>
          </ul>
        </div>

        <h3 style="margin:14px 0 8px; font-size:16px;">Possible approaches (compare)</h3>
        <ul>
          <li><strong>Approach A (best):</strong> Use spherical symmetry to reduce to <code>4π ∫ r^2 n(r) sin(Gr)/(Gr) dr</code>, then evaluate with a known exponential–sine integral. <span class="muted">Fast, clean, and physically transparent.</span></li>
          <li><strong>Approach B:</strong> Compute the 3D Fourier transform via complex analysis / parameter differentiation: start from <code>∫ e^{-αr} e^{iG·r} d^3r</code> and differentiate w.r.t. <code>α</code>. <span class="muted">Elegant but easier to make “magic jumps” if not shown step-by-step.</span></li>
          <li><strong>Approach C:</strong> Recognize <code>n(r)</code> as <code>|ψ_1s|^2</code> and use momentum-space wavefunction relations. <span class="muted">Good quantum insight, but longer and less direct for this exact prompt.</span></li>
        </ul>
        <p><strong>Chosen approach:</strong> Approach A, because it directly uses symmetry, keeps the math rigorous, and minimizes hidden steps.</p>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy &amp; Tips <span class="anchor">roadmap</span></h2>

        <ol style="margin:8px 0 10px 18px;">
          <li><strong>Normalize check</strong>: verify <code>∫ n(r) d^3r = 1</code> so <code>f(0)=1</code>. (Tool: spherical coordinates.)</li>
          <li><strong>Define the form factor</strong>: write <code>f(G)=∫ n(r) e^{iG·r} d^3r</code>. (Tool: Fourier transform definition.)</li>
          <li><strong>Exploit symmetry</strong>: align polar axis with <code>G</code>, rewrite <code>G·r = Gr cosθ</code>. (Tool: rotational invariance.)</li>
          <li><strong>Do angular integration</strong>: show <code>∫ e^{iGr cosθ} dΩ = 4π sin(Gr)/(Gr)</code>. (Tool: substitution <code>u=cosθ</code>.)</li>
          <li><strong>Reduce to 1D integral</strong>: obtain <code>f(G)=4π ∫ r^2 n(r) sin(Gr)/(Gr) dr</code>. (Meaning: spherical Bessel transform.)</li>
          <li><strong>Evaluate the radial integral</strong>: compute <code>∫_0^∞ r e^{-αr} sin(βr) dr</code> exactly. (Tool: complex exponential, parameter integral.)</li>
          <li><strong>Substitute parameters</strong>: set <code>α=2/a0</code>, <code>β=G</code>. Simplify to target expression.</li>
          <li><strong>Sanity checks</strong>: check dimensions, <code>G→0</code>, and <code>G→∞</code> asymptotics.</li>
        </ol>

        <div class="callout">
          <div class="tagRow">
            <span class="tag warn">Common mistakes</span>
          </div>
          <ul>
            <li>Dropping the <code>1/(Gr)</code> factor after angular integration.</li>
            <li>Forgetting the Jacobian <code>r^2 sinθ</code> in <code>d^3r</code>.</li>
            <li>Confusing <code>G</code> (magnitude) with vector <code>G</code>; symmetry lets you use magnitude in the final result.</li>
            <li>Not taking the <code>G→0</code> limit properly (use <code>sin x ~ x</code>).</li>
          </ul>
        </div>
      </section>

      <section id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching) <span class="anchor">derivation</span></h2>

        <h3 style="margin:0 0 8px; font-size:16px;">Physical intuition before calculating</h3>
        <p class="muted">
          The density is smooth and decays exponentially over length scale ~<code>a0</code>.
          Therefore, in reciprocal space the form factor should start at 1 for <code>G=0</code> and decrease monotonically.
          Because an exponential has no sharp edges, we expect a relatively fast decay at large <code>G</code> (indeed it will be ~<code>G^{-4}</code>).
        </p>

        <div class="callout" style="margin-top:10px;">
          <div class="tagRow">
            <span class="tag ok">Step 0</span>
            <span class="tag">Normalization check</span>
          </div>
          <p>We verify <code>∫ n(r) d^3r = 1</code>. In spherical coordinates, <code>d^3r = r^2 sinθ dr dθ dφ</code>, so:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Normalization</strong>
              <button class="btn" data-copy="#eq_norm">Copy equation</button>
            </div>
            <pre id="eq_norm">∫ n(r) d^3r
= ∫_0^∞ ∫_0^π ∫_0^{2π} (1/(π a0^3)) e^{-2r/a0} r^2 sinθ dφ dθ dr
= (1/(π a0^3)) (2π) (2) ∫_0^∞ r^2 e^{-2r/a0} dr
= (4/(a0^3)) ∫_0^∞ r^2 e^{-2r/a0} dr</pre>
          </div>
          <p>
            Evaluate <code>∫_0^∞ r^2 e^{-kr} dr = 2/k^3</code> for <code>k&gt;0</code> (standard Gamma-function result).
            Here <code>k = 2/a0</code>, thus:
          </p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Compute the integral</strong>
              <button class="btn" data-copy="#eq_norm2">Copy equation</button>
            </div>
            <pre id="eq_norm2">∫_0^∞ r^2 e^{-(2/a0) r} dr = 2 / (2/a0)^3 = 2 / (8/a0^3) = a0^3 / 4

⇒ (4/a0^3) * (a0^3/4) = 1</pre>
          </div>
          <p class="muted">So the density is correctly normalized; therefore <code>f(0)=1</code> should emerge automatically.</p>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Step 1</span>
            <span class="tag">Define form factor</span>
          </div>
          <p>By definition (static Fourier transform of the number density):</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Definition</strong>
              <button class="btn" data-copy="#eq_fdef2">Copy equation</button>
            </div>
            <pre id="eq_fdef2">f(G) = ∫_{R^3} n(r) e^{i G·r} d^3r</pre>
          </div>
          <p class="muted">
            Mathematical validity: the integral converges because <code>n(r)</code> decays exponentially and <code>|e^{iG·r}|=1</code>.
            So the integrand is absolutely integrable.
          </p>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Step 2</span>
            <span class="tag">Choose coordinates + symmetry</span>
          </div>
          <p>
            Since <code>n(r)</code> depends only on <code>r=|r|</code>, rotational symmetry implies <code>f</code> depends only on <code>G=|G|</code>.
            Choose spherical coordinates with the polar axis aligned with <code>G</code>.
            Then <code>G·r = G r cosθ</code>.
          </p>
          <p class="muted">
            This step is justified by invariance: for any rotation <code>R</code>, <code>n(Rr)=n(r)</code> so
            <code>f(RG)=∫ n(r) e^{i (RG)·r} d^3r = ∫ n(R^{-1}r') e^{iG·r'} d^3r' = f(G)</code>.
          </p>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Step 3</span>
            <span class="tag">Angular integral</span>
          </div>
          <p>Write the integral explicitly in spherical coordinates:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Expand the 3D integral</strong>
              <button class="btn" data-copy="#eq_ang0">Copy equation</button>
            </div>
            <pre id="eq_ang0">f(G) = ∫_0^∞ ∫_0^π ∫_0^{2π} n(r) e^{i G r cosθ} r^2 sinθ dφ dθ dr</pre>
          </div>

          <p>Because the integrand is independent of <code>φ</code>, the <code>φ</code>-integral gives <code>∫_0^{2π} dφ = 2π</code>:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Do the φ-integral</strong>
              <button class="btn" data-copy="#eq_ang1">Copy equation</button>
            </div>
            <pre id="eq_ang1">f(G) = 2π ∫_0^∞ r^2 n(r) [ ∫_0^π e^{i G r cosθ} sinθ dθ ] dr</pre>
          </div>

          <p>
            Now evaluate the θ-integral using the substitution <code>u = cosθ</code>, so <code>du = -sinθ dθ</code>.
            When <code>θ=0</code>, <code>u=1</code>; when <code>θ=π</code>, <code>u=-1</code>:
          </p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Substitute u = cosθ</strong>
              <button class="btn" data-copy="#eq_ang2">Copy equation</button>
            </div>
            <pre id="eq_ang2">∫_0^π e^{i G r cosθ} sinθ dθ
= ∫_{u=1}^{-1} e^{i G r u} (-du)
= ∫_{-1}^{1} e^{i G r u} du</pre>
          </div>

          <p>Integrate <code>e^{iGru}</code> with respect to <code>u</code>:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Compute the u-integral</strong>
              <button class="btn" data-copy="#eq_ang3">Copy equation</button>
            </div>
            <pre id="eq_ang3">∫_{-1}^{1} e^{i G r u} du
= [ e^{i G r u} / (i G r) ]_{-1}^{1}
= (e^{i G r} - e^{-i G r}) / (i G r)
= 2 sin(G r) / (G r)</pre>
          </div>

          <p>Therefore the full angular integral is <code>2π * 2 sin(Gr)/(Gr) = 4π sin(Gr)/(Gr)</code>, giving:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Reduced 1D radial form</strong>
              <button class="btn" data-copy="#eq_radial">Copy equation</button>
            </div>
            <pre id="eq_radial">f(G) = 4π ∫_0^∞ r^2 n(r) [sin(Gr)/(Gr)] dr</pre>
          </div>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Step 4</span>
            <span class="tag">Insert n(r) and simplify</span>
          </div>
          <p>Insert <code>n(r) = (1/(π a0^3)) e^{-2r/a0}</code>:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Substitute the density</strong>
              <button class="btn" data-copy="#eq_sub1">Copy equation</button>
            </div>
            <pre id="eq_sub1">f(G) = 4π ∫_0^∞ r^2 (1/(π a0^3)) e^{-2r/a0} [sin(Gr)/(Gr)] dr
     = (4/a0^3) ∫_0^∞ r^2 e^{-2r/a0} [sin(Gr)/(Gr)] dr</pre>
          </div>
          <p>Cancel one factor of <code>r</code>:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Expose a standard integral</strong>
              <button class="btn" data-copy="#eq_sub2">Copy equation</button>
            </div>
            <pre id="eq_sub2">f(G) = (4/(a0^3 G)) ∫_0^∞ r e^{-2r/a0} sin(Gr) dr</pre>
          </div>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Step 5</span>
            <span class="tag">Evaluate I = ∫ r e^{-αr} sin(βr) dr</span>
          </div>
          <p>
            Define parameters (with units): <code>α &gt; 0</code> (1/m), <code>β ≥ 0</code> (1/m). Let
          </p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Parameter substitution</strong>
              <button class="btn" data-copy="#eq_params">Copy equation</button>
            </div>
            <pre id="eq_params">α = 2/a0,   β = G</pre>
          </div>
          <p>
            Consider the complex integral (convergent because <code>Re(α) &gt; 0</code>):
          </p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Complex helper integral</strong>
              <button class="btn" data-copy="#eq_complex1">Copy equation</button>
            </div>
            <pre id="eq_complex1">J = ∫_0^∞ r e^{-(α - iβ) r} dr</pre>
          </div>

          <p>
            This is a standard Laplace-type integral. For any complex <code>k</code> with <code>Re(k) &gt; 0</code>,
            <code>∫_0^∞ r e^{-k r} dr = 1/k^2</code>. We can show it quickly by integration by parts:
          </p>
          <details>
            <summary>Show ∫0∞ r e^{-k r} dr = 1/k² (rigorous steps)</summary>
            <div class="eqBlock" style="margin-top:10px;">
              <div class="eqHead">
                <strong>Integration by parts</strong>
                <button class="btn" data-copy="#eq_ibp">Copy equation</button>
              </div>
              <pre id="eq_ibp">Let u = r  ⇒ du = dr
Let dv = e^{-k r} dr ⇒ v = -e^{-k r}/k

∫_0^∞ r e^{-k r} dr
= [u v]_0^∞ - ∫_0^∞ v du
= [ -r e^{-k r}/k ]_0^∞ + (1/k) ∫_0^∞ e^{-k r} dr

Since Re(k)>0, r e^{-k r} → 0 as r→∞, and the term is 0 at r=0,
so boundary term = 0.

Also ∫_0^∞ e^{-k r} dr = [ -e^{-k r}/k ]_0^∞ = 1/k.

Therefore ∫_0^∞ r e^{-k r} dr = (1/k)(1/k) = 1/k^2.</pre>
            </div>
          </details>

          <p>
            Apply with <code>k = α - iβ</code> (note <code>Re(k)=α&gt;0</code>), hence:
          </p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Closed form for J</strong>
              <button class="btn" data-copy="#eq_complex2">Copy equation</button>
            </div>
            <pre id="eq_complex2">J = 1 / (α - iβ)^2</pre>
          </div>

          <p>
            Now relate <code>J</code> to the real sine integral we need.
            Using Euler’s identity, <code>e^{iβr} = cos(βr) + i sin(βr)</code>, we have:
          </p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Imaginary part gives sine</strong>
              <button class="btn" data-copy="#eq_im">Copy equation</button>
            </div>
            <pre id="eq_im">e^{-(α - iβ)r} = e^{-αr} e^{iβr} = e^{-αr}[cos(βr) + i sin(βr)]

⇒ Im(J) = ∫_0^∞ r e^{-αr} sin(βr) dr</pre>
          </div>

          <p>So compute <code>Im(1/(α - iβ)^2)</code>. First expand:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Algebra (no jumps)</strong>
              <button class="btn" data-copy="#eq_alg1">Copy equation</button>
            </div>
            <pre id="eq_alg1">(α - iβ)^2 = α^2 - 2iαβ - β^2 = (α^2 - β^2) - i(2αβ)

1/(α - iβ)^2 = 1 / [(α^2 - β^2) - i(2αβ)]</pre>
          </div>

          <p>
            To extract the imaginary part, multiply numerator and denominator by the complex conjugate:
            <code>(α^2 - β^2) + i(2αβ)</code>.
          </p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Rationalize</strong>
              <button class="btn" data-copy="#eq_alg2">Copy equation</button>
            </div>
            <pre id="eq_alg2">1/(α - iβ)^2
= [(α^2 - β^2) + i(2αβ)] / [ (α^2 - β^2)^2 + (2αβ)^2 ]</pre>
          </div>

          <p>Simplify the denominator:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Denominator simplification</strong>
              <button class="btn" data-copy="#eq_alg3">Copy equation</button>
            </div>
            <pre id="eq_alg3">(α^2 - β^2)^2 + (2αβ)^2
= α^4 - 2α^2β^2 + β^4 + 4α^2β^2
= α^4 + 2α^2β^2 + β^4
= (α^2 + β^2)^2</pre>
          </div>

          <p>Therefore:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Imaginary part</strong>
              <button class="btn" data-copy="#eq_alg4">Copy equation</button>
            </div>
            <pre id="eq_alg4">1/(α - iβ)^2 = [(α^2 - β^2) + i(2αβ)] / (α^2 + β^2)^2

⇒ Im(1/(α - iβ)^2) = (2αβ) / (α^2 + β^2)^2</pre>
          </div>

          <p>
            Hence the needed integral is:
          </p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Key integral result</strong>
              <button class="btn secondary" data-copy="#eq_integral">Copy equation</button>
            </div>
            <pre id="eq_integral">∫_0^∞ r e^{-αr} sin(βr) dr = (2αβ) / (α^2 + β^2)^2</pre>
          </div>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Step 6</span>
            <span class="tag">Assemble f(G)</span>
          </div>

          <p>Recall from earlier:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Expression to finish</strong>
              <button class="btn" data-copy="#eq_finish0">Copy equation</button>
            </div>
            <pre id="eq_finish0">f(G) = (4/(a0^3 G)) ∫_0^∞ r e^{-(2/a0)r} sin(Gr) dr</pre>
          </div>

          <p>Match to the integral formula with <code>α = 2/a0</code>, <code>β = G</code>:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Substitute α, β</strong>
              <button class="btn" data-copy="#eq_finish1">Copy equation</button>
            </div>
            <pre id="eq_finish1">∫_0^∞ r e^{-(2/a0)r} sin(Gr) dr
= (2 (2/a0) G) / ((2/a0)^2 + G^2)^2
= (4G/a0) / ( (4/a0^2) + G^2 )^2</pre>
          </div>

          <p>Insert into <code>f(G)</code> and cancel the <code>G</code>:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Simplify</strong>
              <button class="btn" data-copy="#eq_finish2">Copy equation</button>
            </div>
            <pre id="eq_finish2">f(G) = (4/(a0^3 G)) * (4G/a0) / ( (4/a0^2) + G^2 )^2
     = (16/a0^4) / ( (4/a0^2) + G^2 )^2</pre>
          </div>

          <p>Now factor out <code>1/a0^2</code> from the parentheses to make it dimensionless:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Nondimensionalization (x = G a0)</strong>
              <button class="btn" data-copy="#eq_finish3">Copy equation</button>
            </div>
            <pre id="eq_finish3">(4/a0^2) + G^2 = (1/a0^2)(4 + G^2 a0^2)

⇒ ( (4/a0^2) + G^2 )^2 = (1/a0^4)(4 + G^2 a0^2)^2</pre>
          </div>

          <p>Therefore:</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Final closed form</strong>
              <button class="btn secondary" data-copy="#eq_finalboxed">Copy equation</button>
            </div>
            <pre id="eq_finalboxed">f(G) = (16/a0^4) / [ (1/a0^4)(4 + G^2 a0^2)^2 ]
     = 16 / (4 + G^2 a0^2)^2</pre>
          </div>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Sanity checks</span>
            <span class="tag">dimensions & limits</span>
          </div>

          <p><strong>1) Dimensional analysis:</strong> <code>G a0</code> is dimensionless, so <code>(4 + G^2 a0^2)</code> is dimensionless and <code>f(G)</code> is dimensionless. ✅</p>

          <p><strong>2) Limit <code>G→0</code>:</strong></p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Small-G</strong>
              <button class="btn" data-copy="#eq_smallG">Copy equation</button>
            </div>
            <pre id="eq_smallG">f(0) = 16 / 4^2 = 1</pre>
          </div>
          <p class="muted">Matches normalization: total electron number is 1. ✅</p>

          <p><strong>3) Large-<code>G</code> asymptotics:</strong> for <code>G a0 ≫ 1</code>,</p>
          <div class="eqBlock">
            <div class="eqHead">
              <strong>Large-G</strong>
              <button class="btn" data-copy="#eq_largeG">Copy equation</button>
            </div>
            <pre id="eq_largeG">f(G) = 16 / (G^4 a0^4) * 1/(1 + 4/(G^2 a0^2))^2
≈ 16 / (G^4 a0^4)   (leading order)</pre>
          </div>
          <p class="muted">
            So high spatial frequencies are strongly suppressed: smooth real-space density implies fast reciprocal-space decay. ✅
          </p>
        </div>

        <figure aria-label="Plot of hydrogen form factor vs dimensionless wavevector">
          <canvas id="plot"></canvas>
          <figcaption>
            Single illustrative plot (dimensionless): <code>f(x) = 16/(4 + x^2)^2</code> with <code>x = G a0</code>.
            This is purely for intuition; the derived result remains fully symbolic.
          </figcaption>
        </figure>

        <a class="backTop" href="#top" aria-label="Back to top">↑ Back to top</a>
      </section>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding <span class="anchor">interpretation</span></h2>

        <h3 style="margin:0 0 8px; font-size:16px;">Re-interpret the final formula</h3>
        <p>
          The form factor
          <code>f(G)=16/(4+G^2 a0^2)^2</code>
          depends only on the <strong>dimensionless product</strong> <code>G a0</code>.
          This is a scaling statement: changing <code>a0</code> simply rescales the <code>G</code>-axis.
        </p>

        <div class="callout">
          <div class="tagRow">
            <span class="tag ok">Parameter dependence</span>
            <span class="tag">qualitative</span>
          </div>
          <ul>
            <li>Increase <code>a0</code> (more spread-out density) → for a fixed <code>G</code>, the product <code>G a0</code> increases → <code>f</code> decreases. <span class="muted">(Broader real-space distribution gives narrower reciprocal-space response.)</span></li>
            <li>Increase <code>G</code> (probe finer structure) → <code>f</code> decreases roughly as <code>G^{-4}</code> for large <code>G</code>.</li>
            <li>Near <code>G=0</code>, expand: with <code>x=G a0</code>, <code>f(x)=16/(4+x^2)^2</code> gives
              <code>f(x) ≈ 1 - (x^2)/2 + O(x^4)</code> (smooth quadratic drop).
            </li>
          </ul>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Alternative derivation idea</span>
            <span class="tag">brief but meaningful</span>
          </div>
          <p class="muted">
            Instead of evaluating the sine integral, you can start from the known 3D transform
            <code>∫ e^{-αr} e^{iG·r} d^3r = 8π α / (α^2 + G^2)^2</code>
            (obtainable via Green’s-function/Laplacian identities or parameter differentiation),
            then normalize by the prefactor in <code>n(r)</code>.
            This frames the calculation as a transform pair and connects to PDE methods because Yukawa-type kernels appear as Green’s functions of <code>(∇^2 - α^2)</code>.
          </p>
        </div>

        <div class="callout" style="margin-top:12px;">
          <div class="tagRow">
            <span class="tag ok">Concept check (with answers)</span>
          </div>
          <ul>
            <li><strong>Q:</strong> Why does <code>f(G)</code> depend only on <code>G=|G|</code>? <br><strong>A:</strong> Because <code>n(r)</code> is radial: rotating <code>G</code> can be undone by rotating coordinates in the integral, leaving the value unchanged.</li>
            <li><strong>Q:</strong> What physical information does <code>f(0)=1</code> encode? <br><strong>A:</strong> The total number of electrons (normalization) since <code>e^{i0}=1</code> makes the Fourier transform equal to <code>∫ n d^3r</code>.</li>
            <li><strong>Q:</strong> Why does the kernel become <code>sin(Gr)/(Gr)</code>? <br><strong>A:</strong> It is the angular average of a plane wave over directions: <code>(1/4π)∫ e^{iGr cosθ} dΩ = j0(Gr)</code>.</li>
            <li><strong>Q:</strong> What sets the “roll-off” scale in <code>G</code>? <br><strong>A:</strong> The length scale <code>a0</code>; the crossover occurs near <code>G a0 ~ 1</code>.</li>
          </ul>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide <span class="anchor">plot</span></h2>
        <p>
          The plot shows the dimensionless curve <code>f(x)=16/(4+x^2)^2</code> with <code>x=G a0</code>.
          This is useful because it visualizes how reciprocal-space response drops as you probe smaller length scales.
        </p>
        <ul>
          <li><strong>x-axis:</strong> <code>x = G a0</code> (dimensionless).</li>
          <li><strong>y-axis:</strong> <code>f</code> (dimensionless).</li>
          <li><strong>Features to notice:</strong>
            <ul>
              <li><code>f(0)=1</code> at the origin (normalization).</li>
              <li>Monotone decrease; no oscillations because the density is strictly positive and smooth.</li>
              <li>For large <code>x</code>, the curve approaches 0 like <code>~ 16/x^4</code> (strong suppression).</li>
            </ul>
          </li>
        </ul>
        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="final" class="pageBreak">
        <h2>Final Answer <span class="anchor">result</span></h2>

        <div class="eqBlock">
          <div class="eqHead">
            <strong>Final result (copy-friendly)</strong>
            <button class="btn secondary" data-copy="#final_answer">Copy final answer</button>
          </div>
          <pre id="final_answer">Given n(r) = (1/(π a0^3)) exp(-2r/a0) and f(G) = ∫ n(r) e^{i G·r} d^3r,
spherical symmetry gives f(G) = 4π ∫_0^∞ r^2 n(r) [sin(Gr)/(Gr)] dr.

Evaluating the radial integral yields:
f(G) = 16 / (4 + G^2 a0^2)^2.</pre>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>
    </main>
  </div>

  <footer>
    <p>
      Notes: This derivation used only symmetry, basic spherical-coordinate integration, and a convergent Laplace-type integral.
      The key mathematical object is the spherical Bessel transform (3D Fourier transform of a radial function).
    </p>
  </footer>

  <div class="toast" id="toast" role="status" aria-live="polite">Copied.</div>

  <script>
    // -------- Copy buttons ----------
    function toast(msg){
      const t = document.getElementById('toast');
      t.textContent = msg || 'Copied.';
      t.classList.add('show');
      clearTimeout(window.__toastTimer);
      window.__toastTimer = setTimeout(()=>t.classList.remove('show'), 1200);
    }

    async function copyTextFromSelector(sel){
      const el = document.querySelector(sel);
      if(!el){ toast('Nothing to copy.'); return; }
      const text = el.textContent.trim();
      try{
        await navigator.clipboard.writeText(text);
        toast('Copied to clipboard.');
      }catch(e){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.setAttribute('readonly','');
        ta.style.position='fixed';
        ta.style.left='-9999px';
        document.body.appendChild(ta);
        ta.select();
        try{ document.execCommand('copy'); toast('Copied to clipboard.'); }
        catch(err){ toast('Copy failed.'); }
        document.body.removeChild(ta);
      }
    }

    document.addEventListener('click', (ev)=>{
      const btn = ev.target.closest('[data-copy]');
      if(!btn) return;
      const sel = btn.getAttribute('data-copy');
      copyTextFromSelector(sel);
    });

    // -------- ToC active link on scroll ----------
    const tocLinks = Array.from(document.querySelectorAll('nav.toc a'));
    const sections = tocLinks
      .map(a => document.querySelector(a.getAttribute('href')))
      .filter(Boolean);

    const obs = new IntersectionObserver((entries)=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting){
          const id = entry.target.getAttribute('id');
          tocLinks.forEach(a=>{
            const on = a.getAttribute('href') === '#' + id;
            a.classList.toggle('active', on);
          });
        }
      });
    }, { rootMargin: "-30% 0px -62% 0px", threshold: 0.02 });

    sections.forEach(s => obs.observe(s));

    // -------- Single static plot (canvas) ----------
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    function dpr(){ return window.devicePixelRatio || 1; }

    function drawPlot(){
      const rect = canvas.getBoundingClientRect();
      const Wcss = Math.max(320, rect.width);
      const Hcss = rect.height || 340;
      const R = dpr();
      canvas.width = Math.floor(Wcss * R);
      canvas.height = Math.floor(Hcss * R);
      ctx.setTransform(R,0,0,R,0,0);

      const W = Wcss, H = Hcss;

      // Layout
      const padL = 54, padR = 16, padT = 30, padB = 46;
      const x0 = padL, y0 = H - padB;
      const x1 = W - padR, y1 = padT;
      const pw = x1 - x0, ph = y0 - y1;

      // Axes ranges (dimensionless)
      const xmin = 0, xmax = 10;
      const ymin = 0, ymax = 1.02;

      function fx(x){
        return 16 / Math.pow(4 + x*x, 2);
      }
      function X(x){ return x0 + (x - xmin) * pw / (xmax - xmin); }
      function Y(y){ return y0 - (y - ymin) * ph / (ymax - ymin); }

      // Clear
      ctx.clearRect(0,0,W,H);

      // Background panel inside plot
      ctx.save();
      ctx.globalAlpha = 1;
      ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--panel').trim() || '#101826';
      ctx.globalAlpha = 0.22;
      roundRect(ctx, x0-10, y1-10, pw+20, ph+20, 16);
      ctx.fill();
      ctx.restore();

      // Gridlines
      ctx.save();
      ctx.strokeStyle = 'rgba(255,255,255,.14)';
      if(isLightMode()){
        ctx.strokeStyle = 'rgba(2,6,23,.12)';
      }
      ctx.lineWidth = 1;

      const xticks = 10;
      for(let i=0;i<=xticks;i++){
        const x = xmin + (xmax-xmin)*i/xticks;
        const xx = X(x);
        ctx.beginPath();
        ctx.moveTo(xx, y0);
        ctx.lineTo(xx, y1);
        ctx.stroke();
      }
      const yticks = 5;
      for(let j=0;j<=yticks;j++){
        const y = ymin + (ymax-ymin)*j/yticks;
        const yy = Y(y);
        ctx.beginPath();
        ctx.moveTo(x0, yy);
        ctx.lineTo(x1, yy);
        ctx.stroke();
      }
      ctx.restore();

      // Axes
      ctx.save();
      ctx.strokeStyle = 'rgba(255,255,255,.55)';
      if(isLightMode()){
        ctx.strokeStyle = 'rgba(2,6,23,.55)';
      }
      ctx.lineWidth = 1.6;
      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x1, y0);
      ctx.lineTo(x1, y0);
      ctx.stroke();

      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x0, y1);
      ctx.stroke();
      ctx.restore();

      // Ticks + labels
      ctx.save();
      ctx.fillStyle = getComputedStyle(document.body).color;
      ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;

      // x tick labels
      for(let i=0;i<=xticks;i+=2){
        const x = xmin + (xmax-xmin)*i/xticks;
        const xx = X(x);
        ctx.beginPath();
        ctx.moveTo(xx, y0);
        ctx.lineTo(xx, y0+6);
        ctx.strokeStyle = 'rgba(255,255,255,.55)';
        if(isLightMode()) ctx.strokeStyle = 'rgba(2,6,23,.55)';
        ctx.lineWidth = 1.2;
        ctx.stroke();
        ctx.fillText(String(Math.round(x)), xx-4, y0+20);
      }

      // y tick labels
      for(let j=0;j<=yticks;j++){
        const y = ymin + (ymax-ymin)*j/yticks;
        const yy = Y(y);
        ctx.beginPath();
        ctx.moveTo(x0, yy);
        ctx.lineTo(x0-6, yy);
        ctx.strokeStyle = 'rgba(255,255,255,.55)';
        if(isLightMode()) ctx.strokeStyle = 'rgba(2,6,23,.55)';
        ctx.lineWidth = 1.2;
        ctx.stroke();
        const lab = (Math.round(y*100)/100).toFixed(2).replace(/0+$/,'').replace(/\.$/,'');
        ctx.fillText(lab, x0-40, yy+4);
      }
      ctx.restore();

      // Title + axis labels
      ctx.save();
      ctx.fillStyle = getComputedStyle(document.body).color;
      ctx.font = '600 13px ' + getComputedStyle(document.body).fontFamily;
      ctx.fillText('Hydrogen 1s Form Factor vs x = G a₀', x0, 18);

      ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;
      ctx.fillText('x = G a₀ (dimensionless)', x0 + pw/2 - 70, H - 14);

      // y label (rotated)
      ctx.translate(14, y1 + ph/2 + 54);
      ctx.rotate(-Math.PI/2);
      ctx.fillText('f(x) (dimensionless)', 0, 0);
      ctx.restore();

      // Curve
      ctx.save();
      ctx.lineWidth = 2.4;
      ctx.strokeStyle = 'rgba(125,211,252,.95)';
      if(isLightMode()){
        ctx.strokeStyle = 'rgba(2,132,199,.95)';
      }
      ctx.beginPath();
      const N = 600;
      for(let i=0;i<=N;i++){
        const x = xmin + (xmax-xmin)*i/N;
        const y = fx(x);
        const xx = X(x);
        const yy = Y(y);
        if(i===0) ctx.moveTo(xx,yy);
        else ctx.lineTo(xx,yy);
      }
      ctx.stroke();
      ctx.restore();

      // Legend-like annotation
      ctx.save();
      ctx.fillStyle = getComputedStyle(document.body).color;
      ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;
      const legend = 'f(x) = 16 / (4 + x²)²';
      ctx.fillText(legend, x0 + 10, y1 + 18);
      ctx.restore();
    }

    function isLightMode(){
      // quick heuristic using computed background brightness
      const bg = getComputedStyle(document.documentElement).getPropertyValue('--bg').trim();
      return (bg && (bg.startsWith('#f') || bg.startsWith('#F')));
    }

    function roundRect(ctx, x, y, w, h, r){
      const rr = Math.min(r, w/2, h/2);
      ctx.beginPath();
      ctx.moveTo(x+rr, y);
      ctx.arcTo(x+w, y, x+w, y+h, rr);
      ctx.arcTo(x+w, y+h, x, y+h, rr);
      ctx.arcTo(x, y+h, x, y, rr);
      ctx.arcTo(x, y, x+w, y, rr);
      ctx.closePath();
    }

    // Initial draw + redraw on resize
    const ro = new ResizeObserver(()=>drawPlot());
    ro.observe(canvas);
    window.addEventListener('resize', drawPlot, {passive:true});
    drawPlot();
  </script>
</body>
</html>
