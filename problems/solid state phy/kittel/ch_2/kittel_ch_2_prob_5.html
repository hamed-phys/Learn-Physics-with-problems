<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="color-scheme" content="dark light"/>
  <title>Structure Factor of Diamond: Derivation, Selection Rules, and Extinctions</title>
  <style>
    :root{
      --bg: #0b0d10;
      --panel:#11141a;
      --panel2:#0f1217;
      --text:#e9eef7;
      --muted:#b7c0cf;
      --faint:#8793a7;
      --brand:#6ee7ff;
      --accent:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border: rgba(255,255,255,.10);
      --shadow: 0 16px 40px rgba(0,0,0,.45);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f7fb;
        --panel:#ffffff;
        --panel2:#fbfcff;
        --text:#0b1220;
        --muted:#344256;
        --faint:#5a6a82;
        --border: rgba(0,0,0,.10);
        --shadow: 0 16px 40px rgba(15,23,42,.12);
      }
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family: var(--sans);
      background: radial-gradient(1200px 700px at 10% 0%, rgba(110,231,255,.12), transparent 60%),
                  radial-gradient(900px 600px at 90% 10%, rgba(167,139,250,.12), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.6;
    }
    a{color:var(--brand); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding: 2.2rem 1rem 1.1rem;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .wrap{
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 1.1rem;
      align-items:start;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns: 1fr}
    }
    .hero{
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }
    .title{
      display:flex; flex-wrap:wrap; gap:.6rem; align-items:baseline;
      margin:0 0 .4rem;
    }
    .title h1{
      margin:0;
      font-size: clamp(1.55rem, 2.8vw, 2.25rem);
      letter-spacing: -0.02em;
    }
    .badge{
      display:inline-flex; align-items:center; gap:.5rem;
      font-size:.85rem;
      padding:.2rem .55rem;
      border:1px solid var(--border);
      border-radius: 999px;
      background: rgba(255,255,255,.03);
      color: var(--muted);
    }
    .subtitle{
      margin:.2rem 0 0;
      color:var(--muted);
      max-width: 70ch;
    }

    /* TOC */
    nav.toc{
      position: sticky;
      top: .9rem;
      padding: 1rem;
      border:1px solid var(--border);
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
    }
    nav.toc h2{
      margin:.1rem 0 .7rem;
      font-size:1rem;
      letter-spacing:.02em;
      color: var(--text);
    }
    .toc a{
      display:block;
      padding:.45rem .5rem;
      border-radius: 10px;
      color: var(--muted);
      border:1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size: .95rem;
    }
    .toc a:hover{
      background: rgba(110,231,255,.08);
      border-color: rgba(110,231,255,.22);
      transform: translateX(2px);
      text-decoration:none;
    }
    .toc .mini{
      margin-top:.75rem;
      padding-top:.75rem;
      border-top:1px dashed var(--border);
      color:var(--faint);
      font-size:.88rem;
    }
    .toc .toplink{
      margin-top:.5rem;
      display:inline-flex;
      gap:.45rem;
      align-items:center;
      padding:.4rem .55rem;
      border-radius: 12px;
      border:1px solid var(--border);
      color: var(--muted);
      background: rgba(255,255,255,.03);
    }

    /* Main content cards */
    main{
      padding: 1.1rem 0 2.8rem;
    }
    section{
      border:1px solid var(--border);
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      padding: 1.05rem 1.05rem;
      margin: 0 0 1.05rem;
      overflow:hidden;
    }
    section h2{
      margin:.2rem 0 .75rem;
      font-size: 1.25rem;
      letter-spacing:-0.01em;
    }
    section h3{
      margin: 1rem 0 .4rem;
      font-size: 1.05rem;
      color: var(--text);
    }
    p{margin:.55rem 0}
    ul{margin:.5rem 0 .7rem; padding-left: 1.2rem}
    li{margin:.25rem 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: .9rem;
    }
    @media (max-width: 880px){
      .grid2{grid-template-columns: 1fr}
    }

    /* Callouts */
    .callout{
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: .85rem .9rem;
      background: rgba(0,0,0,.12);
    }
    @media (prefers-color-scheme: light){
      .callout{background: rgba(15,23,42,.035)}
    }
    .callout strong{color: var(--text)}
    .callout.key{border-color: rgba(110,231,255,.28); background: rgba(110,231,255,.06)}
    .callout.assump{border-color: rgba(251,191,36,.26); background: rgba(251,191,36,.06)}
    .callout.mist{border-color: rgba(251,113,133,.26); background: rgba(251,113,133,.06)}
    .callout.math{border-color: rgba(167,139,250,.28); background: rgba(167,139,250,.06)}
    .kicker{
      display:inline-flex;
      align-items:center;
      gap:.55rem;
      font-size:.88rem;
      color: var(--muted);
      margin-bottom:.35rem;
    }
    .dot{
      width:.55rem; height:.55rem; border-radius: 99px;
      background: var(--brand);
      box-shadow: 0 0 0 6px rgba(110,231,255,.12);
    }
    .dot.a{background: var(--warn); box-shadow: 0 0 0 6px rgba(251,191,36,.12)}
    .dot.b{background: var(--bad); box-shadow: 0 0 0 6px rgba(251,113,133,.12)}
    .dot.c{background: var(--accent); box-shadow: 0 0 0 6px rgba(167,139,250,.12)}

    /* Equations */
    .eq{
      margin:.75rem 0;
      padding: .85rem .9rem;
      border: 1px solid var(--border);
      border-radius: 16px;
      background: rgba(255,255,255,.03);
      overflow:auto;
      position: relative;
    }
    .eq pre{
      margin:0;
      font-family: var(--mono);
      font-size: .95rem;
      line-height:1.45;
      color: var(--text);
      white-space: pre;
    }
    .btnrow{
      display:flex;
      gap:.55rem;
      flex-wrap:wrap;
      margin-top:.45rem;
    }
    button.copy{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      border-radius: 12px;
      padding: .45rem .65rem;
      font-size:.9rem;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      background: rgba(110,231,255,.08);
      border-color: rgba(110,231,255,.22);
      color: var(--text);
    }
    .pill{
      display:inline-block;
      padding: .15rem .5rem;
      border-radius: 999px;
      border:1px solid var(--border);
      color: var(--muted);
      background: rgba(255,255,255,.03);
      font-size:.85rem;
      margin-left:.35rem;
    }

    details{
      border:1px dashed var(--border);
      border-radius: 16px;
      padding:.7rem .8rem;
      background: rgba(255,255,255,.02);
      margin:.75rem 0;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 600;
    }
    details p, details ul{color: var(--muted)}
    .hr{
      height:1px;
      background: linear-gradient(90deg, transparent, var(--border), transparent);
      margin: 1rem 0;
    }

    footer{
      border-top:1px solid var(--border);
      padding: 1.2rem 1rem 2.2rem;
      color: var(--muted);
    }
    .small{color: var(--muted); font-size:.95rem}
    .muted{color: var(--muted)}
    .right{float:right}
    .nowrap{white-space:nowrap}

    /* Print */
    @media print{
      nav.toc{display:none}
      body{background:#fff; color:#000}
      section{box-shadow:none; background:#fff; break-inside: avoid}
      header{background:#fff}
      a{color:#000; text-decoration:underline}
      button{display:none !important}
      details{break-inside: avoid}
      .eq{background:#fff}
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="hero">
      <div class="title">
        <h1>Structure Factor of Diamond (with Selection Rules & Extinctions)</h1>
        <span class="badge">Physics tutor + mathematical physics rigor</span>
        <span class="badge">Applied/industrial lens</span>
      </div>
      <p class="subtitle">
        We derive the diamond structure factor from first principles (Fourier coefficients of the basis density),
        then prove the systematic absences: allowed reflections are the FCC-allowed set modified by an extra
        “diamond extinction” when <span class="nowrap">h+k+l = 4n+2</span> for even indices.
      </p>
    </div>
  </header>

  <div class="wrap">
    <nav class="toc" aria-label="Table of contents">
      <h2>Contents</h2>
      <a href="#quick">Quick Summary</a>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry & Applied Physics</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy & Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Optional Plot Guide</a>
      <div class="mini">
        Tip: Use the copy buttons under key equations and the final answer.
        <div style="margin-top:.55rem;">
          <a class="toplink" href="#top">↑ Back to top</a>
        </div>
      </div>
    </nav>

    <main>
      <section id="quick">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this is:</strong> Compute the <em>structure factor</em> of diamond and find its zeros (systematic absences) for diffraction.</li>
          <li><strong>Key physics idea:</strong> Diffraction amplitude at reciprocal vector <span class="nowrap">G</span> is the <em>Fourier coefficient</em> of the crystal’s density; the basis creates interference.</li>
          <li><strong>Mathematical model:</strong> Periodic density <span class="nowrap">ρ(r)=∑<sub>R</sub>∑<sub>j</sub>b δ(r−R−r<sub>j</sub>)</span>; structure factor is <span class="nowrap">S(G)=∫<sub>cell</sub> ρ(r) e^{iG·r} d^3r</span>.</li>
          <li><strong>Reciprocal-space condition:</strong> For cubic lattice, <span class="nowrap">G=(2π/a)(h,k,l)</span> with integers <span class="nowrap">(h,k,l)</span> (Miller indices).</li>
          <li><strong>Result type:</strong> Fully <strong>symbolic</strong>: <span class="nowrap">S(hkl)</span> in closed form; selection rules for allowed reflections.</li>
          <li><strong>FCC rule:</strong> <span class="nowrap">S=0</span> unless <span class="nowrap">h,k,l</span> are all even or all odd (FCC systematic absences).</li>
          <li><strong>Diamond extra rule:</strong> For the even case, reflections vanish when <span class="nowrap">h+k+l = 4n+2</span>.</li>
          <li><strong>Physical meaning:</strong> Two interpenetrating FCC sublattices (offset by <span class="nowrap">(a/4,a/4,a/4)</span>) produce additional destructive interference.</li>
          <li><strong>Industrial relevance:</strong> These extinctions are used to identify diamond-cubic materials (Si, Ge, diamond) and quantify defects/strain via diffraction peak presence and intensity.</li>
        </ul>
      </section>

      <section id="part0">
        <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

        <div class="grid2">
          <div class="callout key">
            <div class="kicker"><span class="dot"></span><span><strong>Core Definitions</strong></span></div>
            <ul>
              <li><strong>Scattering vector / reciprocal lattice vector</strong> <span class="pill">units: 1/m</span><br/>
                <span class="muted">For cubic crystals: </span><span class="nowrap">G = (2π/a)(h,k,l)</span>.
              </li>
              <li><strong>Basis positions</strong> <span class="pill">units: m</span><br/>
                Atomic positions inside the unit cell: <span class="nowrap">r<sub>j</sub></span>.
              </li>
              <li><strong>Scattering length / form-factor weight</strong> <span class="pill">neutron: m, X-ray: e− weighted</span><br/>
                Denote by <span class="nowrap">b<sub>j</sub></span>. For diamond (single element), often <span class="nowrap">b<sub>j</sub>=b</span>.
              </li>
              <li><strong>Structure factor</strong> <span class="pill">dimension: same as b</span><br/>
                <span class="nowrap">S(G) = ∑<sub>j</sub> b<sub>j</sub> e^{iG·r<sub>j</sub>}</span>.
              </li>
            </ul>
          </div>

          <div class="callout math">
            <div class="kicker"><span class="dot c"></span><span><strong>Mathematical Physics View</strong></span></div>
            <p class="muted">
              The crystal density is periodic, so it admits a <strong>Fourier series</strong> over the reciprocal lattice:
              <span class="nowrap">ρ(r)=∑<sub>G</sub> ρ̃(G)e^{iG·r}</span>.
              The coefficient <span class="nowrap">ρ̃(G)</span> is (up to a constant) the structure factor.
            </p>
            <ul class="muted">
              <li><strong>Translation symmetry:</strong> density invariant under lattice translations <span class="nowrap">T<sub>R</sub></span>; eigenfunctions are plane waves <span class="nowrap">e^{iG·r}</span>.</li>
              <li><strong>Linearity:</strong> Fourier transform/integral is linear, so sums over atoms become sums of phases.</li>
              <li><strong>Interference:</strong> zeros come from vector-phase cancellation (a discrete analogue of orthogonality).</li>
            </ul>
          </div>
        </div>

        <h3>Physical meaning (intuition)</h3>
        <ul>
          <li><strong>Why phases matter:</strong> Each atom contributes a complex phasor. If the phasors sum to zero, that Bragg reflection is <em>forbidden</em> (systematic absence).</li>
          <li><strong>Diamond = FCC + extra basis:</strong> Diamond-cubic structure can be seen as an FCC Bravais lattice with a two-atom basis <span class="nowrap">(0,0,0)</span> and <span class="nowrap">(1/4,1/4,1/4)</span> in units of <span class="nowrap">a</span>, or as two interpenetrating FCC sublattices.</li>
        </ul>

        <h3>Key laws/principles and validity conditions</h3>
        <div class="callout assump">
          <div class="kicker"><span class="dot a"></span><span><strong>Assumptions used in standard structure-factor selection rules</strong></span></div>
          <ul>
            <li><strong>Kinematic (single-scattering) regime:</strong> intensity ∝ |S|². Multiple scattering (dynamical diffraction) can modify intensities but <em>systematic absences remain strongly diagnostic</em>.</li>
            <li><strong>Perfect periodicity:</strong> infinite crystal idealization; finite size broadens peaks but does not change which hkl are allowed in the ideal lattice.</li>
            <li><strong>Identical atoms (diamond element):</strong> all <span class="nowrap">b<sub>j</sub>=b</span>. For compounds, weights differ and some extinctions can be lifted.</li>
          </ul>
        </div>

        <h3>Mini intuition examples (no heavy algebra)</h3>
        <ul>
          <li><strong>Two-atom 1D basis:</strong> atoms at 0 and a/2 give factor <span class="nowrap">1+e^{iπh}</span> ⇒ odd h cancels (classic destructive interference).</li>
          <li><strong>FCC idea:</strong> four corner/face-centered positions contribute phases that cancel unless h,k,l have the same parity (all even or all odd).</li>
          <li><strong>Diamond “extra” cancellation:</strong> even (h,k,l) can still cancel if the extra shift adds a phase of −1.</li>
        </ul>

        <h3>What to watch for (pitfalls)</h3>
        <ul>
          <li>Mixing <strong>primitive vs conventional cell</strong> descriptions: diamond’s conventional cubic cell contains 8 atoms, but the underlying Bravais lattice is FCC with a 2-atom basis.</li>
          <li>Forgetting that <strong>Miller indices correspond to reciprocal vectors</strong> <span class="nowrap">G=(2π/a)(h,k,l)</span> in cubic crystals.</li>
          <li>Confusing “allowed reflection” (S≠0) with “strong intensity” (which also depends on multiplicity, Debye–Waller factor, polarization, etc.).</li>
        </ul>

        <details>
          <summary>Optional deeper note: why Fourier modes show up (operator language)</summary>
          <p>
            Define the translation operator <span class="nowrap">T<sub>R</sub></span> acting on functions by
            <span class="nowrap">(T<sub>R</sub>f)(r)=f(r+R)</span>. Periodicity means <span class="nowrap">T<sub>R</sub>ρ=ρ</span> for all lattice vectors R.
            The simultaneous eigenfunctions of all translations are plane waves <span class="nowrap">e^{iq·r}</span>, with eigenvalue <span class="nowrap">e^{iq·R}</span>.
            Requiring <span class="nowrap">e^{iq·R}=1</span> for all R forces q to be a reciprocal lattice vector G.
            Thus only reciprocal-lattice Fourier components appear in the exact periodic density.
          </p>
        </details>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>
        <ul>
          <li><strong>Semiconductor manufacturing (Si/Ge):</strong> Diamond-cubic selection rules are used in XRD metrology to confirm crystal orientation, epitaxial quality, and detect polycrystallinity.</li>
          <li><strong>Materials ID & phase verification:</strong> Powder diffraction peak positions + allowed/forbidden hkl patterns distinguish diamond-cubic from similar cubic structures.</li>
          <li><strong>Defects & process control:</strong> Deviations from ideal intensities can signal strain, stacking faults, vacancies, or contamination—critical for yield and reliability.</li>
        </ul>

        <div class="grid2">
          <div class="callout">
            <div class="kicker"><span class="dot"></span><span><strong>How engineers measure/validate</strong></span></div>
            <ul class="muted">
              <li><strong>X-ray diffraction (XRD):</strong> fast inline/atline tools; intensity patterns compared to expected allowed reflections.</li>
              <li><strong>Neutron diffraction:</strong> more sensitive to light atoms and isotope contrast; used in research and some specialized industrial contexts.</li>
              <li><strong>EBSD / Laue diffraction:</strong> orientation mapping and texture; selection rules inform indexing robustness.</li>
            </ul>
          </div>
          <div class="callout">
            <div class="kicker"><span class="dot c"></span><span><strong>Design trade-offs & non-idealities</strong></span></div>
            <ul class="muted">
              <li><strong>Finite thickness & mosaicity:</strong> broaden peaks and reduce contrast but do not “create” forbidden peaks in ideal single-phase material.</li>
              <li><strong>Alloying/doping:</strong> changes atomic scattering weights; can shift intensities and in some cases partially lift extinctions.</li>
              <li><strong>Strain gradients:</strong> shift peak positions and can redistribute intensity—important in thin films and MEMS.</li>
            </ul>
          </div>
        </div>

        <p class="small">
          <strong>From lab to product:</strong> The ideal structure factor gives the “fingerprint” of what peaks <em>can exist</em>.
          Production metrology then layers on corrections (instrument resolution, Debye–Waller factors, absorption, texture, thickness)
          to fit actual intensity curves and extract actionable parameters (strain, composition, defect density).
        </p>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>Problem restatement</h3>
        <p>
          Diamond has a conventional cubic unit cell containing 8 atoms. (a) Compute the structure factor <span class="nowrap">S</span> for this basis.
          (b) Find where <span class="nowrap">S=0</span> (systematic absences), and show that allowed reflections satisfy either:
          <strong>(i)</strong> <span class="nowrap">h+k+l = 4n</span> with <strong>all indices even</strong>, or <strong>(ii)</strong> <strong>all indices odd</strong>.
        </p>

        <div class="grid2">
          <div class="callout">
            <div class="kicker"><span class="dot"></span><span><strong>Given</strong></span></div>
            <ul class="muted">
              <li>Diamond-cubic structure described by conventional cubic cell with 8 atoms.</li>
              <li>Use Miller indices <span class="nowrap">(h,k,l)</span> (also written as <span class="nowrap">v₁,v₂,v₃</span> in some texts).</li>
              <li>Implicit: identical atoms (carbon) ⇒ same scattering length/weight <span class="nowrap">b</span>.</li>
            </ul>
          </div>
          <div class="callout">
            <div class="kicker"><span class="dot c"></span><span><strong>Unknowns / tasks</strong></span></div>
            <ul class="muted">
              <li>(a) Closed-form <span class="nowrap">S(hkl)</span> for diamond basis.</li>
              <li>(b) Conditions on <span class="nowrap">(h,k,l)</span> such that <span class="nowrap">S=0</span> or <span class="nowrap">S≠0</span> (allowed reflections).</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>Reciprocal lattice & Bragg scattering:</strong> Peaks occur at reciprocal vectors; intensity is governed by the basis Fourier sum.</li>
          <li><strong>Linearity of Fourier transform:</strong> The structure factor is a linear sum over atoms; cancellations follow from symmetry/parity.</li>
          <li><strong>Periodicity:</strong> Allows restriction of integral to the unit cell and replacement by discrete sums over basis atoms.</li>
        </ul>

        <div class="callout assump">
          <div class="kicker"><span class="dot a"></span><span><strong>Assumptions to state explicitly</strong></span></div>
          <ul>
            <li>Cubic lattice constant <span class="nowrap">a</span>; coordinate system aligned with cube edges.</li>
            <li>Kinematic diffraction so that selection rules come from <span class="nowrap">S(G)</span> alone.</li>
            <li>All atoms equivalent: <span class="nowrap">b<sub>j</sub>=b</span>.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare 2–3)</h3>
        <ul>
          <li><strong>Approach A (best):</strong> View diamond as FCC Bravais lattice with a 2-atom basis, then compute
            <span class="nowrap">S = S<sub>FCC</sub>(hkl)·(1+e^{iG·d})</span>. <span class="muted">Fast, symmetry-transparent.</span></li>
          <li><strong>Approach B:</strong> Sum directly over the 8 conventional-cell atomic positions. <span class="muted">Works but more algebra.</span></li>
          <li><strong>Approach C:</strong> Use group/translation symmetry to infer parity rules (character sums). <span class="muted">Elegant but abstract.</span></li>
        </ul>

        <p><strong>Chosen approach:</strong> Approach A, because it isolates the known FCC selection rule and then shows how the diamond offset adds an extra interference factor.</p>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

        <ol>
          <li><strong>Set coordinates:</strong> conventional cube of side <span class="nowrap">a</span>; use fractional coordinates in <span class="nowrap">[0,1)</span>.</li>
          <li><strong>Write the mathematical model:</strong> basis density <span class="nowrap">ρ(r)</span> as a sum of delta functions; define <span class="nowrap">S(G)</span> as the cell Fourier coefficient.</li>
          <li><strong>Write reciprocal vector:</strong> <span class="nowrap">G=(2π/a)(h,k,l)</span>; compute phase <span class="nowrap">e^{iG·r}</span> for fractional positions.</li>
          <li><strong>Compute FCC factor:</strong> sum phases over the 4 FCC sites in the conventional cell to obtain <span class="nowrap">S<sub>FCC</sub>(hkl)</span> and its parity selection rule.</li>
          <li><strong>Account for diamond shift:</strong> second FCC sublattice is shifted by <span class="nowrap">d=(a/4)(1,1,1)</span>; multiply by <span class="nowrap">(1+e^{iG·d})</span>.</li>
          <li><strong>Find zeros:</strong> solve <span class="nowrap">S=0</span> by combining conditions <span class="nowrap">S<sub>FCC</sub>=0</span> and <span class="nowrap">1+e^{iG·d}=0</span>.</li>
          <li><strong>State allowed reflections:</strong> summarize in clean number-theory form (parity + sum mod 4).</li>
          <li><strong>Sanity checks:</strong> check special cases like (111), (220), (200), (222) against rules.</li>
        </ol>

        <div class="callout mist">
          <div class="kicker"><span class="dot b"></span><span><strong>Common mistakes</strong></span></div>
          <ul>
            <li>Dropping the factor <span class="nowrap">(2π/a)</span> in <span class="nowrap">G</span> and getting wrong phase arguments.</li>
            <li>Forgetting that FCC has 4 sites in the conventional cube (not 1).</li>
            <li>Mixing up “all even” with “sum even”: FCC requires same parity for all three indices.</li>
            <li>Not separating the two sources of extinction: FCC extinctions and diamond additional extinctions.</li>
          </ul>
        </div>
      </section>

      <section id="part3">
        <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

        <h3>Qualitative expectation (before calculating)</h3>
        <p>
          Diamond consists of two identical interpenetrating sublattices. For many reciprocal vectors, the two
          sublattices contribute equal magnitude but opposite phase, so we expect additional “missing” peaks beyond FCC.
          In other words, <strong>interference between the two sublattices</strong> should create extra systematic absences.
        </p>

        <div class="hr"></div>

        <h3>Step 1 — Mathematical model and coordinate system</h3>
        <p>
          Use a conventional cubic cell of side <span class="nowrap">a</span>, with axes along cube edges.
          Use <strong>fractional coordinates</strong> <span class="nowrap">(x,y,z)</span> meaning the physical position is
          <span class="nowrap">r = a(x,y,z)</span>, with <span class="nowrap">x,y,z ∈ [0,1)</span> for atoms inside one conventional cell.
        </p>

        <div class="callout math">
          <div class="kicker"><span class="dot c"></span><span><strong>Mathematical model (density → Fourier coefficient)</strong></span></div>
          <p class="muted">
            Model the basis (within one cell) as point scatterers:
          </p>
          <div class="eq" data-copy="eq1">
            <pre>ρ_basis(r) = Σ_{j=1..N} b_j δ(r - r_j)
S(G) = ∫_{cell} ρ_basis(r) e^{i G·r} d^3r = Σ_{j=1..N} b_j e^{i G·r_j}</pre>
          </div>
          <div class="btnrow">
            <button class="copy" data-copybtn="eq1">Copy key equations</button>
          </div>
          <p class="muted">
            Validity: the delta model is a standard idealization in kinematic diffraction; linearity of the integral gives the discrete sum.
            No boundary/initial conditions are needed because this is a <strong>spatial Fourier series coefficient</strong> on the unit cell.
          </p>
        </div>

        <h3>Step 2 — Reciprocal lattice vector for cubic crystals</h3>
        <p>
          For a cubic lattice, reciprocal vectors are
          <span class="nowrap">G = (2π/a)(h,k,l)</span> with integers <span class="nowrap">h,k,l</span>.
          Then for a basis atom at <span class="nowrap">r_j = a(x_j,y_j,z_j)</span>,
        </p>
        <div class="eq" data-copy="eq2">
          <pre>G·r_j = (2π/a)(h,k,l) · a(x_j,y_j,z_j) = 2π (h x_j + k y_j + l z_j)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copybtn="eq2">Copy phase relation</button>
        </div>
        <p class="muted">
          <strong>Dimensional check:</strong> G has units 1/m and r has units m, so G·r is dimensionless as required for an exponential.
        </p>

        <div class="hr"></div>

        <h3>Step 3 — Describe diamond as FCC + a shift (basis decomposition)</h3>
        <p>
          Diamond-cubic can be described as an FCC Bravais lattice with a two-atom basis at fractional coordinates
          <span class="nowrap">(0,0,0)</span> and <span class="nowrap">(1/4,1/4,1/4)</span>.
          Equivalently: within the <em>conventional cubic cell</em> there are 4 FCC sites, and diamond has those 4 plus the same 4 shifted by <span class="nowrap">(1/4,1/4,1/4)</span>.
        </p>

        <p><strong>FCC sites inside the conventional cube (fractional):</strong></p>
        <div class="eq" data-copy="eq3">
          <pre>r0 = (0,   0,   0)
r1 = (0,   1/2, 1/2)
r2 = (1/2, 0,   1/2)
r3 = (1/2, 1/2, 0)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copybtn="eq3">Copy FCC sites</button>
        </div>

        <p><strong>Diamond shift (fractional):</strong> <span class="nowrap">d = (1/4,1/4,1/4)</span>.
          The additional 4 atoms are at <span class="nowrap">r_m + d</span> for <span class="nowrap">m=0..3</span>.
          Total atoms in conventional cell: 8.
        </p>

        <div class="hr"></div>

        <h3>Step 4 — Compute the FCC structure factor (systematic absences)</h3>
        <p>
          Assume identical scattering weight <span class="nowrap">b</span> for each atom (e.g., carbon for diamond).
          First compute the FCC contribution:
        </p>

        <div class="eq" data-copy="eq4">
          <pre>S_FCC(h,k,l) = b Σ_{m=0..3} exp[i G·(a r_m)]
              = b[ 1
                 + exp(i2π(0·h + (1/2)k + (1/2)l))
                 + exp(i2π((1/2)h + 0·k + (1/2)l))
                 + exp(i2π((1/2)h + (1/2)k + 0·l)) ]</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copybtn="eq4">Copy FCC sum</button>
        </div>

        <p>
          Use <span class="nowrap">exp(i2π·1/2·n) = exp(iπ n) = (-1)^n</span> for integer n.
          Therefore:
        </p>
        <div class="eq" data-copy="eq5">
          <pre>S_FCC(h,k,l) = b[ 1 + e^{iπ(k+l)} + e^{iπ(h+l)} + e^{iπ(h+k)} ]
             = b[ 1 + (-1)^{k+l} + (-1)^{h+l} + (-1)^{h+k} ]</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copybtn="eq5">Copy FCC closed form</button>
        </div>

        <p><strong>Why this step is valid:</strong> We used the specific fractional coordinates of FCC sites and the phase identity for half-integers; this is purely algebraic and relies on <span class="nowrap">h,k,l ∈ ℤ</span>.</p>

        <h3>Step 5 — Analyze when the FCC factor vanishes (parity argument)</h3>
        <p>
          The quantities <span class="nowrap">(-1)^{h+k}</span>, <span class="nowrap">(-1)^{h+l}</span>, <span class="nowrap">(-1)^{k+l}</span>
          depend only on the parity (even/odd) of h,k,l.
        </p>
        <ul>
          <li>If <strong>h,k,l are all even</strong>, then h+k, h+l, k+l are even, so each <span class="nowrap">(-1)^{...}=+1</span>:
            <span class="nowrap">S_FCC = b(1+1+1+1)=4b</span>.</li>
          <li>If <strong>h,k,l are all odd</strong>, then sums like h+k are even (odd+odd), again all <span class="nowrap">(-1)^{...}=+1</span>:
            <span class="nowrap">S_FCC = 4b</span>.</li>
          <li>If the parities are mixed (some even, some odd), then two of the exponents become odd and two even, giving cancellation:
            <span class="nowrap">S_FCC = b(1+1−1−1)=0</span> (up to permutation).</li>
        </ul>

        <div class="callout key">
          <div class="kicker"><span class="dot"></span><span><strong>FCC selection rule</strong></span></div>
          <p class="muted">
            <strong>S<sub>FCC</sub>(hkl) = 0</strong> unless <strong>h, k, l are all even or all odd</strong>.
            When allowed, <span class="nowrap">S<sub>FCC</sub>=4b</span>.
          </p>
        </div>

        <div class="hr"></div>

        <h3>Step 6 — Add the diamond shift: factorization</h3>
        <p>
          Diamond has two identical FCC sublattices: one at positions <span class="nowrap">r_m</span> and one at positions <span class="nowrap">r_m + d</span>.
          Thus the total structure factor is
        </p>

        <div class="eq" data-copy="eq6">
          <pre>S_diamond = b Σ_{m=0..3} e^{iG·(a r_m)} + b Σ_{m=0..3} e^{iG·(a (r_m + d))}
          = b Σ_{m=0..3} e^{iG·(a r_m)} [1 + e^{iG·(a d)}]
          = S_FCC(h,k,l) [1 + e^{iG·(a d)}]</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copybtn="eq6">Copy diamond factorization</button>
        </div>

        <p><strong>Why factorization is valid:</strong> The second sum differs from the first only by a constant shift <span class="nowrap">ad</span>.
          By linearity and the identity <span class="nowrap">e^{iG·(r+ad)} = e^{iG·r} e^{iG·(ad)}</span>, the common phase factors pull out.
        </p>

        <h3>Step 7 — Compute the shift phase exactly</h3>
        <p>
          With fractional <span class="nowrap">d=(1/4,1/4,1/4)</span>, we have
        </p>
        <div class="eq" data-copy="eq7">
          <pre>G·(a d) = 2π(h·1/4 + k·1/4 + l·1/4) = (π/2)(h + k + l)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copybtn="eq7">Copy shift phase</button>
        </div>

        <p>Therefore the diamond structure factor is:</p>
        <div class="eq" data-copy="eq8">
          <pre>S_diamond(h,k,l) = S_FCC(h,k,l) [ 1 + exp(i (π/2)(h+k+l)) ]</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copybtn="eq8">Copy diamond S(hkl)</button>
        </div>

        <h3>Step 8 — Find zeros: combine FCC rule and diamond interference rule</h3>
        <p>
          The product is zero if either factor is zero:
        </p>
        <ul>
          <li><strong>FCC extinctions:</strong> If h,k,l are mixed parity ⇒ <span class="nowrap">S_FCC=0</span> ⇒ <span class="nowrap">S_diamond=0</span>.</li>
          <li><strong>Diamond extra extinctions:</strong> If <span class="nowrap">1+exp(i(π/2)(h+k+l))=0</span>, even if FCC allows it.</li>
        </ul>

        <p>
          Solve the diamond interference condition:
        </p>
        <div class="eq" data-copy="eq9">
          <pre>1 + e^{i(π/2)H} = 0   where H := h+k+l
⇔ e^{i(π/2)H} = -1 = e^{iπ(2n+1)}
⇔ (π/2)H = π(2n+1)
⇔ H = 2(2n+1) = 4n + 2</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copybtn="eq9">Copy extinction derivation</button>
        </div>

        <p>
          So the extra diamond extinction happens when <span class="nowrap">h+k+l ≡ 2 (mod 4)</span>.
          However, note how this interacts with the FCC rule:
        </p>
        <ul>
          <li>If <strong>h,k,l all even</strong>, then H is even, so <span class="nowrap">H mod 4</span> can be 0 or 2. Both are possible; thus some even-even-even reflections are killed (those with H=4n+2).</li>
          <li>If <strong>h,k,l all odd</strong>, then H is odd, so it can never be <span class="nowrap">4n+2</span> (even). Therefore odd-odd-odd reflections are never killed by this particular condition (they survive, though with a phase factor).</li>
        </ul>

        <div class="callout math">
          <div class="kicker"><span class="dot c"></span><span><strong>Math Insight</strong></span></div>
          <p class="muted">
            The core object <span class="nowrap">S(G)=∑ e^{iG·r_j}</span> is a <strong>finite Fourier transform</strong> (a character sum) over a discrete set.
            The selection rules are number-theoretic statements about when this character sum vanishes due to symmetry (parity classes mod 2 and mod 4).
            In this sense, systematic absences are a discrete orthogonality phenomenon, not a “materials accident.”
          </p>
        </div>

        <div class="hr"></div>

        <h3>Step 9 — Final closed form and allowed-reflection rule</h3>

        <div class="callout key" id="finalBox">
          <div class="kicker"><span class="dot"></span><span><strong>FINAL ANSWER (Structure factor + selection rules)</strong></span></div>

          <div class="eq" data-copy="finalEq">
            <pre>Let G = (2π/a)(h,k,l), and define H = h+k+l.

FCC factor (4 sites in conventional cube):
S_FCC(h,k,l) = b[1 + e^{iπ(k+l)} + e^{iπ(h+l)} + e^{iπ(h+k)}]
            = b[1 + (-1)^{k+l} + (-1)^{h+l} + (-1)^{h+k}]

Diamond (8 atoms = FCC + shifted FCC by d=(1/4,1/4,1/4)):
S_diamond(h,k,l) = S_FCC(h,k,l) [1 + e^{i(π/2)H}]

Selection rules:
1) If h,k,l are not all even and not all odd  ⇒  S_diamond = 0.
2) If h,k,l are all even:
      - If H = 4n     ⇒  S_diamond = 8b (allowed)
      - If H = 4n+2   ⇒  S_diamond = 0  (diamond extinction)
3) If h,k,l are all odd:
      S_diamond = 4b[1 + e^{i(π/2)H}] = 4b(1 ± i)  (allowed; nonzero)

Therefore allowed reflections satisfy:
- all indices odd, OR
- all indices even with h+k+l = 4n.</pre>
          </div>
          <div class="btnrow">
            <button class="copy" data-copybtn="finalEq">Copy final answer (plain text)</button>
          </div>
        </div>

        <h3>Sanity checks</h3>
        <ul>
          <li><strong>(111):</strong> all odd ⇒ allowed. Here H=3 ⇒ <span class="nowrap">e^{i(π/2)H}=e^{i3π/2}=-i</span>, so bracket is <span class="nowrap">1-i</span> ⇒ nonzero.</li>
          <li><strong>(220):</strong all even, H=4 ⇒ <span class="nowrap">H=4n</span> ⇒ allowed (strong).</li>
          <li><strong>(200):</strong all even, H=2 ⇒ <span class="nowrap">H=4n+2</span> ⇒ extinct (forbidden in ideal diamond).</li>
          <li><strong>(222):</strong all even, H=6 ⇒ <span class="nowrap">4n+2</span> ⇒ extinct.</li>
        </ul>

        <h3>Extra checks: units, limits, interpretation</h3>
        <ul>
          <li><strong>Units:</strong> S has units of b (scattering length/weight). Intensity in kinematic theory scales like <span class="nowrap">|S|²</span>.</li>
          <li><strong>Limiting case:</strong> If the shift d were zero (two sublattices coincide), bracket becomes 2 and diamond would reduce to FCC with doubled weight: makes sense.</li>
          <li><strong>Physical interpretation:</strong> Even-even-even reflections split into two classes: those where the two FCC sublattices add (constructive) and those where they cancel (destructive).</li>
        </ul>
      </section>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

        <h3>Re-interpreting the final formula term-by-term</h3>
        <ul>
          <li><strong>S<sub>FCC</sub>(hkl):</strong> encodes the four-site symmetry of FCC. It is a parity filter: mixed parity cannot satisfy the FCC translation symmetry phases.</li>
          <li><strong>[1 + e^{i(π/2)H}]:</strong> encodes interference between the two interpenetrating sublattices. It is sensitive to <span class="nowrap">H mod 4</span>.</li>
        </ul>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li>Changing <strong>a</strong> changes Bragg peak <em>positions</em> (through G and d-spacings), but the <em>selection rules</em> depend only on integer parity and mod-4 sums—i.e., symmetry, not scale.</li>
          <li>Changing <strong>atom type</strong> changes b and thus intensity scale. In alloys/compounds, different <span class="nowrap">b<sub>j</sub></span> can alter cancellation and partially lift extinctions.</li>
          <li>Thermal motion introduces a Debye–Waller factor <span class="nowrap">e^{-2W(G)}</span> multiplying intensity; selection rules persist but peaks weaken at large |G|.</li>
        </ul>

        <details>
          <summary>Alternative derivation idea (brief but meaningful)</summary>
          <p>
            Instead of factoring into FCC×(1+phase), you can sum over the 8 conventional-cell positions directly.
            The same exponent arithmetic appears, but factoring highlights the group structure:
            first a mod-2 parity filter (FCC), then a mod-4 filter (diamond shift).
            In representation-theory language, you are summing characters over cosets of the translation group.
          </p>
        </details>

        <div class="callout math">
          <div class="kicker"><span class="dot c"></span><span><strong>Math Insight (core equation as an object)</strong></span></div>
          <p class="muted">
            <strong>Structure factor = Fourier coefficient of a periodic distribution.</strong>
            The delta-comb model means the Fourier transform is another discrete comb (Poisson summation).
            The basis acts like a finite impulse response (FIR) filter in reciprocal space: it passes some integer modes and rejects others.
            This “filter viewpoint” is extremely useful in applied diffraction: systematic absences are stop-bands enforced by symmetry.
          </p>
        </div>

        <h3>Concept check (self-test)</h3>
        <ul>
          <li><strong>Q:</strong> Why are (100) reflections forbidden in diamond? <br><strong>A:</strong> Mixed parity (1,0,0) violates FCC parity rule ⇒ <span class="nowrap">S_FCC=0</span>.</li>
          <li><strong>Q:</strong> Why can (200) be forbidden even though all indices are even? <br><strong>A:</strong> It passes FCC, but H=2 gives <span class="nowrap">1+e^{iπ}=0</span> ⇒ diamond sublattices cancel.</li>
          <li><strong>Q:</strong> Do odd reflections ever satisfy the “H=4n+2” extinction? <br><strong>A:</strong> No, because H is odd when h,k,l are all odd.</li>
          <li><strong>Q:</strong> What changes if the two atoms in the basis were different elements? <br><strong>A:</strong> Weights <span class="nowrap">b_1,b_2</span> differ; cancellation may be incomplete, so some “forbidden” peaks can gain intensity.</li>
        </ul>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p class="muted">
          No plot is necessary here because the problem is primarily <strong>symbolic</strong>: the main learning outcome is the exact
          selection rules (parity and mod-4 conditions) and the closed-form expression for <span class="nowrap">S(hkl)</span>.
          A plot would require choosing specific intensities and instrument factors, which would distract from the symmetry proof.
        </p>
        <p class="small"><a href="#top">↑ Back to top</a></p>
      </section>
    </main>
  </div>

  <footer>
    <div class="hero">
      <p class="small">
        Built as a self-contained HTML lesson: semantic layout, sticky TOC, copy buttons, collapsible notes, and print-friendly styling.
      </p>
    </div>
  </footer>

  <script>
    (function(){
      function getTextFromEq(eqEl){
        const pre = eqEl.querySelector('pre');
        return pre ? pre.textContent.replace(/\n{3,}/g, "\n\n").trim() : "";
      }
      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          let ok=false;
          try{ ok = document.execCommand('copy'); }catch(_){ ok=false; }
          document.body.removeChild(ta);
          return ok;
        }
      }
      function flash(btn, ok){
        const old = btn.textContent;
        btn.textContent = ok ? "Copied ✓" : "Copy failed";
        btn.style.borderColor = ok ? "rgba(52,211,153,.45)" : "rgba(251,113,133,.45)";
        btn.style.background = ok ? "rgba(52,211,153,.10)" : "rgba(251,113,133,.10)";
        btn.style.color = "var(--text)";
        setTimeout(()=>{
          btn.textContent = old;
          btn.style.borderColor = "var(--border)";
          btn.style.background = "rgba(255,255,255,.04)";
          btn.style.color = "var(--muted)";
        }, 1200);
      }

      document.querySelectorAll('button.copy[data-copybtn]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const id = btn.getAttribute('data-copybtn');
          const eq = document.querySelector('.eq[data-copy="'+id+'"]');
          const text = eq ? getTextFromEq(eq) : "";
          const ok = text ? await copyText(text) : false;
          flash(btn, ok);
        });
      });
    })();
  </script>
</body>
</html>
