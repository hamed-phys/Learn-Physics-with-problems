<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hagen–Rubens Relation: Infrared Reflectivity of Metals (Derivation + Engineering View)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --card:#101823;
      --card2:#0f1520;
      --text:#e8eef6;
      --muted:#b7c3d6;
      --faint:#7f8aa0;
      --accent:#66d9ff;
      --accent2:#7cffc3;
      --warn:#ffd36a;
      --danger:#ff6b7a;
      --border:rgba(255,255,255,0.10);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --radius: 16px;
      --radius2: 22px;
      --lh: 1.55;
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8fc;
        --card:#ffffff;
        --card2:#fbfcff;
        --text:#0b1220;
        --muted:#334155;
        --faint:#64748b;
        --border:rgba(15,23,42,0.12);
        --shadow: 0 10px 30px rgba(2,6,23,0.10);
      }
    }

    *{box-sizing:border-box;}
    html{scroll-behavior:smooth;}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 15% 0%, rgba(102,217,255,0.10), transparent 60%),
                  radial-gradient(1000px 650px at 95% 10%, rgba(124,255,195,0.08), transparent 60%),
                  var(--bg);
      color:var(--text);
      line-height:var(--lh);
    }

    header{
      padding: 28px 16px 14px;
      position: relative;
      overflow:hidden;
    }

    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 0 14px 40px;
    }

    .hero{
      display:grid;
      grid-template-columns: 1.6fr 1fr;
      gap: 14px;
      align-items: stretch;
    }

    .titleCard{
      background: linear-gradient(180deg, rgba(102,217,255,0.10), transparent 55%),
                  linear-gradient(0deg, rgba(124,255,195,0.08), transparent 60%),
                  var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 18px 18px 14px;
      position: relative;
    }

    h1{
      margin: 0 0 10px;
      font-size: clamp(1.35rem, 2.2vw, 2.05rem);
      letter-spacing: 0.2px;
    }

    .subtitle{
      margin: 0;
      color: var(--muted);
      font-size: 0.98rem;
    }

    .metaRow{
      display:flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color: var(--muted);
      font-size: 0.88rem;
      backdrop-filter: blur(6px);
    }

    .pill .dot{
      width:10px;height:10px;border-radius:50%;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(102,217,255,0.15);
    }

    .tocCard{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 14px;
      position: sticky;
      top: 10px;
      align-self: start;
      max-height: calc(100vh - 20px);
      overflow:auto;
    }

    .tocCard h2{
      margin: 2px 0 10px;
      font-size: 0.98rem;
      color: var(--muted);
      letter-spacing: 0.3px;
    }

    .toc{
      list-style:none;
      padding:0;margin:0;
      display:grid;
      gap: 6px;
    }

    .toc a{
      text-decoration:none;
      color: var(--text);
      border: 1px solid transparent;
      border-radius: 12px;
      padding: 8px 10px;
      display:block;
      transition: transform 160ms ease, background 160ms ease, border-color 160ms ease;
      font-size: 0.93rem;
    }
    .toc a:hover{
      background: rgba(102,217,255,0.08);
      border-color: rgba(102,217,255,0.25);
      transform: translateY(-1px);
    }

    main{
      padding: 8px 0 20px;
    }

    section{
      margin-top: 16px;
      scroll-margin-top: 14px;
    }

    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 16px;
    }

    .card h2{
      margin: 0 0 8px;
      font-size: 1.15rem;
    }

    .card h3{
      margin: 16px 0 8px;
      font-size: 1.03rem;
      color: var(--muted);
    }

    .muted{color:var(--muted);}
    .faint{color:var(--faint);}

    .callouts{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
      margin-top: 10px;
    }

    .callout{
      grid-column: span 12;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), transparent 60%);
      position: relative;
      overflow:hidden;
    }

    .callout strong{color: var(--text);}
    .callout .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size: 0.85rem;
      color: var(--muted);
      margin-bottom: 6px;
    }
    .tag .badge{
      width:10px;height:10px;border-radius: 3px;
      background: var(--accent2);
      box-shadow: 0 0 0 3px rgba(124,255,195,0.12);
    }
    .callout.warn .tag .badge{background: var(--warn); box-shadow: 0 0 0 3px rgba(255,211,106,0.15);}
    .callout.danger .tag .badge{background: var(--danger); box-shadow: 0 0 0 3px rgba(255,107,122,0.15);}
    .callout.eq .tag .badge{background: var(--accent); box-shadow: 0 0 0 3px rgba(102,217,255,0.15);}

    ul{margin: 8px 0 0 20px;}
    li{margin: 6px 0;}
    .tight li{margin: 4px 0;}
    .eqBlock{
      margin-top: 10px;
      padding: 12px 12px 10px;
      border-radius: var(--radius);
      border: 1px solid rgba(102,217,255,0.30);
      background: linear-gradient(180deg, rgba(102,217,255,0.10), transparent 70%);
      position: relative;
      overflow:hidden;
    }

    pre, code{
      font-family: var(--mono);
      font-size: 0.92rem;
      line-height: 1.45;
    }

    pre{
      margin: 0;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .btnRow{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    button.copyBtn{
      appearance:none;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      border-radius: 999px;
      padding: 8px 12px;
      cursor:pointer;
      font-size: 0.9rem;
      transition: transform 160ms ease, background 160ms ease, border-color 160ms ease;
    }
    button.copyBtn:hover{
      transform: translateY(-1px);
      background: rgba(102,217,255,0.10);
      border-color: rgba(102,217,255,0.28);
    }
    button.copyBtn:active{transform: translateY(0px) scale(0.99);}

    details{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 10px 12px;
      background: rgba(255,255,255,0.03);
      margin-top: 10px;
    }
    details summary{
      cursor:pointer;
      color: var(--muted);
      font-weight: 600;
    }

    figure{margin:0;}
    .plotCard{padding: 14px;}

    canvas{
      width: 100%;
      height: auto;
      display:block;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--card2);
    }

    .backTop{
      display:inline-block;
      margin-top: 12px;
      text-decoration:none;
      color: var(--accent);
      font-weight: 600;
    }
    .backTop:hover{text-decoration: underline;}

    footer{
      padding: 18px 14px 34px;
      color: var(--muted);
    }

    @media (max-width: 980px){
      .hero{grid-template-columns: 1fr;}
      .tocCard{position: relative; top: 0;}
    }

    @media print{
      body{background:#fff; color:#000;}
      .tocCard{display:none;}
      .titleCard, .card{box-shadow:none;}
      a{color:#000;}
      .copyBtn, .backTop{display:none;}
      section{break-inside: avoid-page;}
      .eqBlock{background:#fff;}
    }
  </style>
</head>
<body>
<header id="top">
  <div class="wrap">
    <div class="hero">
      <div class="titleCard">
        <h1>Hagen–Rubens Relation for Infrared Reflectivity of Metals</h1>
        <p class="subtitle">
          Derive the low-frequency (ωτ ≪ 1) reflectivity formula for a good conductor using the complex refractive index and normal-incidence Fresnel reflection.
          Includes rigorous mathematical steps and an applied engineering perspective.
        </p>
        <div class="metaRow">
          <div class="pill"><span class="dot"></span> Regime: intraband (Drude), interband neglected</div>
          <div class="pill"><span class="dot" style="background:var(--accent2); box-shadow:0 0 0 3px rgba(124,255,195,0.15);"></span> Output: symbolic + one numerical check</div>
          <div class="pill"><span class="dot" style="background:var(--warn); box-shadow:0 0 0 3px rgba(255,211,106,0.15);"></span> Units: CGS (Gaussian) in the statement</div>
        </div>
      </div>

      <aside class="tocCard" aria-label="Table of contents">
        <h2>Table of Contents</h2>
        <ol class="toc">
          <li><a href="#quick-summary">Quick Summary</a></li>
          <li><a href="#part0">PART 0 — Concept Primer</a></li>
          <li><a href="#part0b">PART 0B — Industry &amp; Applied Physics Perspective</a></li>
          <li><a href="#part1">PART 1 — Problem Analysis</a></li>
          <li><a href="#part2">PART 2 — Strategy &amp; Tips</a></li>
          <li><a href="#part3">PART 3 — Full Solution</a></li>
          <li><a href="#part4">PART 4 — Deeper Understanding</a></li>
          <li><a href="#part5">PART 5 — Optional Plot Guide</a></li>
        </ol>
      </aside>
    </div>
  </div>
</header>

<main class="wrap">
  <section id="quick-summary" class="card">
    <h2>Quick Summary</h2>
    <ul class="tight">
      <li><strong>What this is:</strong> Derivation of the <em>Hagen–Rubens</em> approximation for the <strong>infrared reflectivity</strong> of a metal at normal incidence.</li>
      <li><strong>Key physics idea:</strong> In a good conductor at low frequency, the electromagnetic field penetrates only a small <em>skin depth</em>, and the complex refractive index becomes large and nearly “45°” in the complex plane (n ≈ K).</li>
      <li><strong>Governing relation (given):</strong> Complex dielectric function in CGS:
        <span class="muted">ε(ω) = (n + iK)<sup>2</sup> = 1 + i(4πσ<sub>0</sub>/ω)</span>.</li>
      <li><strong>Optics link:</strong> Normal-incidence Fresnel reflection for complex index <span class="muted">N = n + iK</span>:
        <span class="muted">r = (1 − N)/(1 + N),&nbsp; R = |r|<sup>2</sup></span>.</li>
      <li><strong>Main result (Hagen–Rubens):</strong> For a good metal with <span class="muted">σ<sub>0</sub> ≫ ω</span>,
        <strong>R ≈ 1 − √(2ω/(πσ<sub>0</sub>))</strong> (CGS form used here).</li>
      <li><strong>Meaning:</strong> Reflectivity is close to 1, but the <em>deficit</em> (1 − R) grows like √ω, so metals reflect less at higher IR frequencies.</li>
      <li><strong>Numeric check (sodium, 10 μm):</strong> With ω = 1.88×10<sup>14</sup> s<sup>−1</sup>, σ<sub>0</sub> = 2.1×10<sup>17</sup> s<sup>−1</sup>, prediction: <strong>R ≈ 0.976</strong>.</li>
    </ul>
    <a class="backTop" href="#top">Back to top ↑</a>
  </section>

  <section id="part0" class="card">
    <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

    <h3>0.1 Core definitions (symbols + units)</h3>
    <ul>
      <li><strong>ω</strong> — angular frequency of light (s<sup>−1</sup>).</li>
      <li><strong>σ<sub>0</sub></strong> — DC (static) conductivity. In the given CGS statement it appears in the combination (4πσ<sub>0</sub>/ω) which is dimensionless; treat σ<sub>0</sub> as having “frequency-like” units in Gaussian-cgs conventions used in many older solid-state texts.</li>
      <li><strong>ε(ω)</strong> — complex dielectric function (dimensionless), relating <strong>D</strong> and <strong>E</strong> via <strong>D</strong> = ε(ω)<strong>E</strong> (linear, isotropic medium).</li>
      <li><strong>N = n + iK</strong> — complex refractive index (dimensionless):
        <ul class="tight">
          <li><strong>n</strong> — refractive index (phase),</li>
          <li><strong>K</strong> — extinction coefficient (attenuation).</li>
        </ul>
      </li>
      <li><strong>r</strong> — complex amplitude reflection coefficient; <strong>R = |r|²</strong> — reflectivity (power ratio).</li>
    </ul>

    <h3>0.2 Physical meaning &amp; intuition</h3>
    <ul>
      <li><strong>Complex ε</strong> encodes both energy storage (real part) and dissipation (imaginary part). In a conductor, dissipation dominates at low ω because conduction currents respond strongly.</li>
      <li><strong>K</strong> sets how quickly the wave decays in the metal: fields behave like exp(−αz) where α ∝ K. This is the <em>skin effect</em>.</li>
      <li>When the metal is very conductive, <strong>N</strong> becomes large, so the interface looks like a near-perfect mirror: <strong>R → 1</strong>.</li>
    </ul>

    <h3>0.3 Key laws &amp; validity conditions</h3>
    <div class="callouts">
      <div class="callout eq">
        <div class="tag"><span class="badge"></span><strong>Maxwell + linear response</strong></div>
        <div class="muted">
          In frequency domain (time dependence e<sup>−iωt</sup>), a homogeneous isotropic medium supports plane waves with dispersion
          k = (ω/c)N, where N = √ε(ω) (assuming μ≈1).
        </div>
      </div>
      <div class="callout warn">
        <div class="tag"><span class="badge"></span><strong>Regime assumed here</strong></div>
        <ul class="tight">
          <li><strong>Intraband (Drude) dominance</strong> and <strong>interband neglected</strong>.</li>
          <li><strong>Low frequency</strong> in the sense of Drude: ωτ ≪ 1 (so σ(ω) ≈ σ<sub>0</sub>).</li>
          <li><strong>Good conductor limit</strong>: σ<sub>0</sub> ≫ ω (as stated), so the imaginary term in ε dominates.</li>
          <li>Normal incidence, planar interface, linear optics.</li>
        </ul>
      </div>
    </div>

    <h3>0.4 Common models/approximations and why</h3>
    <ul>
      <li><strong>Drude dielectric function:</strong> ε(ω) = 1 + i(4πσ(ω)/ω) (in Gaussian CGS form). At ωτ ≪ 1, σ(ω) ≈ σ<sub>0</sub> is nearly real and constant.</li>
      <li><strong>Good conductor simplification:</strong> If the conduction term dominates, then ε ≈ i(4πσ<sub>0</sub>/ω) is almost purely imaginary and large. This drives n ≈ K.</li>
      <li><strong>Large-index expansion:</strong> If |N| ≫ 1, Fresnel expressions simplify via series in 1/N.</li>
    </ul>

    <h3>0.5 Mini intuition examples (minimal algebra)</h3>
    <ul>
      <li><strong>If conductivity increases</strong>, the metal becomes more reflective: currents more effectively cancel interior fields, so less energy enters.</li>
      <li><strong>If frequency increases</strong> (still within intraband/low-ω), penetration increases relative to the “perfect conductor” case and reflectivity drops roughly like √ω.</li>
      <li><strong>Surface roughness</strong> or oxide layers can reduce measured reflectivity beyond this ideal model—important in real components.</li>
    </ul>

    <h3>0.6 What to watch for (pitfalls)</h3>
    <ul>
      <li>Mixing <strong>SI vs CGS</strong> forms of ε(ω). The statement uses a CGS-style formula with 4π.</li>
      <li>Forgetting that <strong>r is complex</strong>; reflectivity is <strong>R = |r|²</strong>.</li>
      <li>Dropping the “1” in ε too early without checking the <strong>dominant balance</strong>.</li>
      <li>Using n≈K without justifying: it follows from the real part of ε being small compared to its imaginary part in this regime.</li>
    </ul>

    <div class="callout" style="margin-top:12px;">
      <div class="tag"><span class="badge"></span><strong>Math Insight</strong></div>
      <div class="muted">
        The key relation (n + iK)² = ε is a <strong>complex square-root mapping</strong>. In the good-conductor regime ε ≈ iA with A ≫ 1, so ε lies near the positive imaginary axis.
        The square root rotates angle by half: √(iA) has phase ≈ π/4, meaning <strong>real and imaginary parts are comparable</strong> ⇒ n ≈ K.
      </div>
    </div>

    <a class="backTop" href="#top">Back to top ↑</a>
  </section>

  <section id="part0b" class="card">
    <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>

    <h3>Why this matters in real engineering</h3>
    <ul>
      <li><strong>Infrared optics &amp; thermal management:</strong> Reflectivity controls radiative heat exchange (e.g., reflective foils, cryogenic shields, furnace linings).</li>
      <li><strong>IR sensing and spectroscopy hardware:</strong> Metal mirrors in FTIR spectrometers, IR telescopes, and beam steering rely on predictable R(ω).</li>
      <li><strong>Electronics &amp; EMC:</strong> Skin-depth physics that underlies Hagen–Rubens also governs RF shielding, conductor losses, and surface resistance at high frequencies.</li>
    </ul>

    <h3>Why industrial engineers care (performance, reliability, cost)</h3>
    <ul>
      <li><strong>Performance:</strong> Small changes in R can shift signal-to-noise in IR systems or change thermal radiation budgets.</li>
      <li><strong>Reliability:</strong> Oxidation, contamination, and roughness can degrade reflectivity, driving maintenance cycles and drift.</li>
      <li><strong>Cost &amp; manufacturability:</strong> Highly polished surfaces and protective coatings increase cost; designers trade off reflectivity vs durability.</li>
    </ul>

    <h3>Typical measurement/validation methods</h3>
    <ul>
      <li><strong>Ellipsometry</strong> to extract n(ω), K(ω), hence ε(ω) and R(ω).</li>
      <li><strong>FTIR reflectometry</strong> for broadband IR reflectance.</li>
      <li><strong>Four-point probe</strong> / transport measurements for σ<sub>0</sub>, then compare with optical predictions in the Drude regime.</li>
    </ul>

    <h3>Design trade-offs &amp; non-idealities</h3>
    <ul>
      <li><strong>Surface roughness</strong> causes diffuse scattering (reduces specular reflectivity).</li>
      <li><strong>Thin films</strong> can deviate from bulk σ due to grain boundaries and size effects.</li>
      <li><strong>Temperature dependence</strong> of σ<sub>0</sub> changes R (important for high-temperature processes and cryogenic systems).</li>
    </ul>

    <details>
      <summary>From lab to product: adapting the ideal model</summary>
      <div class="muted">
        In products, engineers often replace σ<sub>0</sub> with a measured σ(ω) (complex, frequency-dependent), include a surface layer (oxide/coating) as a thin-film stack,
        and add a roughness/scatter loss term. Hagen–Rubens remains valuable as a <strong>quick scaling law</strong> and a <strong>sanity check</strong> for low-ω behavior.
      </div>
    </details>

    <a class="backTop" href="#top">Back to top ↑</a>
  </section>

  <section id="part1" class="card">
    <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

    <h3>1.1 Restate the problem</h3>
    <p class="muted">
      A metal has complex refractive index N = n + iK. In the low-frequency intraband regime (ωτ ≪ 1), the dielectric function is given (CGS) by:
      ε(ω) = (n + iK)² = 1 + i(4πσ<sub>0</sub>/ω),
      where σ<sub>0</sub> is the DC conductivity. Using the normal-incidence reflection coefficient for a medium with complex index,
      show that the reflectivity satisfies the Hagen–Rubens approximation:
      R ≈ 1 − √(2ω/(πσ<sub>0</sub>)),
      provided σ<sub>0</sub> ≫ ω.
    </p>

    <h3>1.2 Given, unknowns, required</h3>
    <ul>
      <li><strong>Given:</strong> ε(ω) = (n+iK)² = 1 + i(4πσ<sub>0</sub>/ω) (CGS), and the normal-incidence Fresnel relation:
        r = (1 − N)/(1 + N), R = |r|², with N = n + iK.</li>
      <li><strong>Unknowns:</strong> n(ω), K(ω) in the good-conductor limit; then R(ω).</li>
      <li><strong>To prove:</strong> R ≈ 1 − √(2ω/(πσ<sub>0</sub>)) when σ<sub>0</sub> ≫ ω.</li>
    </ul>

    <h3>1.3 Relevant principles and why they apply</h3>
    <ul>
      <li><strong>Linear electromagnetism in frequency domain:</strong> plane waves in homogeneous media; ε(ω) captures response.</li>
      <li><strong>Boundary conditions at a planar interface:</strong> tangential E and H continuous ⇒ Fresnel coefficients.</li>
      <li><strong>Complex analysis / asymptotics:</strong> expand R for large |N| (good conductor).</li>
    </ul>

    <h3>1.4 Explicit assumptions</h3>
    <div class="callout warn">
      <div class="tag"><span class="badge"></span><strong>Assumptions used in the derivation</strong></div>
      <ul class="tight">
        <li>Normal incidence from vacuum (index 1) onto the metal (index N).</li>
        <li>Homogeneous, isotropic metal with μ ≈ 1.</li>
        <li>Intraband response dominates; σ(ω) ≈ σ<sub>0</sub> (ωτ ≪ 1).</li>
        <li>Good conductor: σ<sub>0</sub> ≫ ω ⇒ |ε| ≫ 1 and ε is predominantly imaginary.</li>
        <li>Choose the physical branch of the square root so that K &gt; 0 (attenuation into the metal).</li>
      </ul>
    </div>

    <h3>1.5 Possible approaches (compare)</h3>
    <ul>
      <li><strong>Approach A (direct):</strong> Solve (n+iK)² = 1 + iA for n,K in the limit A ≫ 1, then insert into Fresnel r and expand.
        <span class="faint">Pros: transparent. Cons: careful complex algebra needed.</span></li>
      <li><strong>Approach B (impedance method):</strong> Use r = (Z − Z<sub>0</sub>)/(Z + Z<sub>0</sub>) and expand for good conductor.
        <span class="faint">Pros: strong RF/skin-depth intuition. Cons: unit-system bookkeeping.</span></li>
      <li><strong>Approach C (energy flow):</strong> Estimate absorption from skin depth and infer 1−R.
        <span class="faint">Pros: intuitive. Cons: harder to get prefactor cleanly.</span></li>
    </ul>
    <p class="muted"><strong>Chosen:</strong> Approach A, because the problem explicitly provides ε(ω) in terms of n and K and directs you to use normal-incidence reflection.</p>

    <a class="backTop" href="#top">Back to top ↑</a>
  </section>

  <section id="part2" class="card">
    <h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

    <ol>
      <li><strong>Define variables</strong> N = n + iK and A = 4πσ<sub>0</sub>/ω; identify A ≫ 1.</li>
      <li><strong>Expand</strong> (n+iK)² = n² − K² + 2inK and match real/imag parts.</li>
      <li><strong>Use dominant balance</strong> to show n ≈ K and solve for n and K at leading order.</li>
      <li><strong>Insert into Fresnel r</strong> = (1 − N)/(1 + N) and compute R = |r|².</li>
      <li><strong>Expand</strong> in 1/N (since |N| ≫ 1) to the first nontrivial order.</li>
      <li><strong>Simplify</strong> 1−R to get the √ω law and match the Hagen–Rubens prefactor.</li>
      <li><strong>Check</strong> limits and compute the sodium IR example.</li>
    </ol>

    <div class="callout danger">
      <div class="tag"><span class="badge"></span><strong>Common mistakes</strong></div>
      <ul class="tight">
        <li>Not taking the complex modulus when computing |1 − 2/N|².</li>
        <li>Dropping the 1/N term too early (that term produces the leading reflectivity loss).</li>
        <li>Confusing ωτ ≪ 1 (Drude low ω) with σ<sub>0</sub> ≫ ω (good conductor): both matter here.</li>
      </ul>
    </div>

    <a class="backTop" href="#top">Back to top ↑</a>
  </section>

  <section id="part3" class="card">
    <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

    <h3>3.1 Qualitative expectation</h3>
    <p class="muted">
      In a good conductor, induced currents strongly oppose interior fields, so the incident wave is mostly reflected: R should be near 1.
      The small deviation 1−R measures how much energy actually enters and dissipates within the skin depth.
    </p>

    <h3>3.2 Mathematical model (variables, domain, boundary conditions)</h3>
    <div class="callout eq">
      <div class="tag"><span class="badge"></span><strong>Model</strong></div>
      <ul class="tight">
        <li><strong>Geometry:</strong> planar interface at z=0; vacuum for z&lt;0, metal for z&gt;0.</li>
        <li><strong>Fields:</strong> time-harmonic plane waves; use frequency-domain Maxwell equations (∂/∂t → −iω).</li>
        <li><strong>Constitutive law:</strong> D(ω)=ε(ω)E(ω), with ε(ω) complex; μ≈1.</li>
        <li><strong>Dispersion:</strong> k = (ω/c)N where N = n + iK = √ε(ω); choose branch with K&gt;0 so waves decay into metal (z&gt;0).</li>
        <li><strong>Boundary conditions:</strong> tangential E and H continuous at z=0 ⇒ Fresnel coefficients at normal incidence.</li>
      </ul>
    </div>

    <h3>3.3 Start from the given dielectric function</h3>
    <div class="eqBlock" id="eq1">
      <pre>ε(ω) = (n + iK)^2 = 1 + i (4π σ0 / ω)   (CGS)</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq1" data-copy-prefix="ε(ω) = (n + iK)^2 = 1 + i (4π σ0 / ω)">Copy equation</button>
      </div>
    </div>

    <p class="muted">
      Define the dimensionless parameter
      A := 4πσ<sub>0</sub>/ω.
      The condition σ<sub>0</sub> ≫ ω implies A ≫ 1.
    </p>

    <h3>3.4 Equate real and imaginary parts</h3>
    <p class="muted">Expand the square (linearity of multiplication and i² = −1):</p>

    <div class="eqBlock" id="eq2">
      <pre>(n + iK)^2 = n^2 + 2 i nK + (iK)^2 = (n^2 − K^2) + i(2 nK)</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq2" data-copy-prefix="(n + iK)^2 = (n^2 − K^2) + i(2 nK)">Copy equation</button>
      </div>
    </div>

    <p class="muted">
      Set equal to 1 + iA and match components (equality of complex numbers):
    </p>

    <div class="eqBlock" id="eq3">
      <pre>n^2 − K^2 = 1
2 nK      = A</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq3" data-copy-prefix="n^2 − K^2 = 1;  2 nK = A">Copy equations</button>
      </div>
    </div>

    <h3>3.5 Good-conductor asymptotics: show n ≈ K</h3>
    <p class="muted">
      Since A ≫ 1, the equation 2nK = A implies nK ≫ 1, so n and K are large. Then n² and K² are large, yet their difference is only 1:
      n² − K² = 1. The only consistent balance is n² ≈ K², hence n ≈ K (taking positive values for physical refractive index and attenuation).
    </p>

    <div class="eqBlock" id="eq4">
      <pre>For A ≫ 1:   n ≈ K</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq4" data-copy-prefix="For A ≫ 1: n ≈ K">Copy equation</button>
      </div>
    </div>

    <details>
      <summary>Controlled correction (optional)</summary>
      <div class="muted">
        Let n = K + δ with |δ| ≪ K. Then n² − K² = 2Kδ + δ² ≈ 2Kδ = 1 ⇒ δ ≈ 1/(2K).
        Since K will scale like √A, δ/K ~ 1/A ≪ 1, confirming n ≈ K asymptotically.
      </div>
    </details>

    <h3>3.6 Solve for n and K to leading order</h3>
    <p class="muted">
      Use n = K in 2nK = A:
    </p>

    <div class="eqBlock" id="eq5">
      <pre>2 n^2 = A
n = K = √(A/2) = √( (4πσ0/ω)/2 ) = √(2πσ0/ω)</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq5" data-copy-prefix="n = K = sqrt(2πσ0/ω)">Copy equation</button>
      </div>
    </div>

    <p class="muted">
      Define a := √(2πσ<sub>0</sub>/ω), so
      N = n + iK ≈ a(1 + i).
      Because σ<sub>0</sub> ≫ ω, we have a ≫ 1, hence |N| ≫ 1.
    </p>

    <h3>3.7 Fresnel reflection at normal incidence and expansion</h3>
    <div class="eqBlock" id="eq6">
      <pre>r = (1 − N)/(1 + N),   R = |r|^2</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq6" data-copy-prefix="r = (1 − N)/(1 + N),  R = |r|^2">Copy equation</button>
      </div>
    </div>

    <p class="muted">
      For |N| ≫ 1, set x := 1/N (so |x| ≪ 1). Divide numerator and denominator by N:
    </p>

    <div class="eqBlock" id="eq7">
      <pre>r = (x − 1)/(x + 1) = −(1 − x)/(1 + x)</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq7" data-copy-prefix="r = (1/N − 1)/(1/N + 1) = −(1 − 1/N)/(1 + 1/N)">Copy equation</button>
      </div>
    </div>

    <p class="muted">
      Use the geometric series (1 + x)<sup>−1</sup> = 1 − x + O(x²), valid for |x|&lt;1:
    </p>

    <div class="eqBlock" id="eq8">
      <pre>r = −(1 − x)(1 − x + O(x^2)) = −(1 − 2x + O(x^2))
⇒ |r|^2 ≈ |1 − 2/N|^2</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq8" data-copy-prefix="R ≈ |1 − 2/N|^2 for |N| ≫ 1">Copy equation</button>
      </div>
    </div>

    <h3>3.8 Compute 1/N and the modulus</h3>
    <p class="muted">
      With N ≈ a(1+i),
      1/(1+i) = (1−i)/2 (multiply numerator/denominator by 1−i). Thus:
    </p>

    <div class="eqBlock" id="eq9">
      <pre>1/N ≈ 1/(a(1+i)) = (1−i)/(2a)
2/N ≈ (1−i)/a</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq9" data-copy-prefix="1/N ≈ (1−i)/(2a),  2/N ≈ (1−i)/a">Copy equation</button>
      </div>
    </div>

    <p class="muted">
      Then:
    </p>

    <div class="eqBlock" id="eq10">
      <pre>1 − 2/N ≈ 1 − (1/a) + i(1/a)</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq10" data-copy-prefix="1 − 2/N ≈ (1 − 1/a) + i(1/a)">Copy equation</button>
      </div>
    </div>

    <p class="muted">
      Take modulus squared (|u+iv|² = u² + v²):
    </p>

    <div class="eqBlock" id="eq11">
      <pre>R ≈ (1 − 1/a)^2 + (1/a)^2 = 1 − 2/a + 2/a^2</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq11" data-copy-prefix="R ≈ 1 − 2/a + 2/a^2">Copy equation</button>
      </div>
    </div>

    <p class="muted">
      Since a ≫ 1, drop the higher-order term 2/a²:
      R ≈ 1 − 2/a.
      Substitute a = √(2πσ<sub>0</sub>/ω):
    </p>

    <div class="eqBlock" id="eq12">
      <pre>2/a = 2 / √(2πσ0/ω)
    = 2 √(ω/(2πσ0))
    = √(2ω/(πσ0))</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eq12" data-copy-prefix="2/a = sqrt(2ω/(πσ0))">Copy equation</button>
      </div>
    </div>

    <div class="callout eq" style="margin-top:12px;">
      <div class="tag"><span class="badge"></span><strong>Final Result (Hagen–Rubens)</strong></div>
      <div class="eqBlock" id="finalAnswer" style="margin-top:8px;">
        <pre>R(ω) ≈ 1 − √( 2ω / (π σ0) ),     valid when  σ0 ≫ ω  (good conductor, low-frequency intraband regime)</pre>
        <div class="btnRow">
          <button class="copyBtn" data-copy-target="#finalAnswer" data-copy-prefix="R(ω) ≈ 1 − √(2ω/(πσ0))">Copy final answer</button>
        </div>
      </div>
    </div>

    <h3>3.9 Sanity checks</h3>
    <div class="callouts">
      <div class="callout">
        <div class="tag"><span class="badge"></span><strong>Dimensions</strong></div>
        <div class="muted">
          A = 4πσ<sub>0</sub>/ω is dimensionless in the problem’s CGS convention, so √(ω/σ<sub>0</sub>) is dimensionless and R is dimensionless as required.
        </div>
      </div>
      <div class="callout">
        <div class="tag"><span class="badge"></span><strong>Limits</strong></div>
        <ul class="tight muted">
          <li>ω → 0 ⇒ R → 1.</li>
          <li>σ<sub>0</sub> → ∞ ⇒ R → 1.</li>
          <li>Increasing ω (within validity) increases 1−R, consistent with increased dissipation.</li>
        </ul>
      </div>
      <div class="callout">
        <div class="tag"><span class="badge"></span><strong>Physical meaning</strong></div>
        <div class="muted">
          The √ω dependence is the optical signature of the skin-effect/Drude response: surface absorption grows with √ω.
        </div>
      </div>
    </div>

    <h3>3.10 Numerical check (sodium at 10 μm)</h3>
    <p class="muted">
      Using the values quoted in the statement: ω = 1.88×10<sup>14</sup> s<sup>−1</sup>, σ<sub>0</sub> = 2.1×10<sup>17</sup> s<sup>−1</sup>:
    </p>
    <div class="eqBlock" id="eqNum">
      <pre>R ≈ 1 − √(2ω/(πσ0))
  = 1 − √( 2·1.88×10^14 / (π·2.1×10^17) )
  ≈ 1 − 0.02387
  ≈ 0.976</pre>
      <div class="btnRow">
        <button class="copyBtn" data-copy-target="#eqNum" data-copy-prefix="For ω=1.88e14, σ0=2.1e17: R≈0.976">Copy numeric result</button>
      </div>
    </div>

    <a class="backTop" href="#top">Back to top ↑</a>
  </section>

  <section id="part4" class="card">
    <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

    <h3>4.1 Re-interpret the final formula</h3>
    <ul>
      <li><strong>R ≈ 1</strong>: metal is nearly a perfect mirror in this regime.</li>
      <li><strong>1 − R ∝ √ω</strong>: reflectivity loss grows with frequency (within Drude low-ω), consistent with stronger surface absorption.</li>
      <li><strong>1 − R ∝ 1/√σ<sub>0</sub></strong>: better conductivity improves reflectivity, but only with square-root benefit.</li>
    </ul>

    <h3>4.2 Parameter dependence</h3>
    <div class="callout">
      <div class="tag"><span class="badge"></span><strong>Scaling</strong></div>
      <ul class="tight muted">
        <li>If ω increases by factor 4, then (1−R) increases by factor √4 = 2.</li>
        <li>If σ<sub>0</sub> increases by factor 9, then (1−R) decreases by factor √9 = 3.</li>
      </ul>
    </div>

    <h3>4.3 Alternative derivation idea</h3>
    <details>
      <summary>Impedance method (engineering-friendly)</summary>
      <div class="muted">
        Using r = (Z − Z0)/(Z + Z0), the good-conductor surface impedance satisfies |Z| ∝ √(ω/σ).
        Expanding for |Z| ≪ Z0 yields 1−R proportional to √(ω/σ), reproducing Hagen–Rubens and tying directly to surface resistance.
      </div>
    </details>

    <h3>4.4 Concept check (with answers)</h3>
    <ul>
      <li><strong>Q:</strong> Why does n ≈ K for a good conductor?
        <br><strong>A:</strong> Because n² − K² = 1 while nK = A/2 ≫ 1 forces n² and K² to be nearly equal (difference only 1).</li>
      <li><strong>Q:</strong> What mathematical fact lets us expand in 1/N?
        <br><strong>A:</strong> The geometric series for (1+x)<sup>−1</sup> with x = 1/N and |x|≪1.</li>
      <li><strong>Q:</strong> If σ<sub>0</sub> decreases (e.g., from heating), what happens to R?
        <br><strong>A:</strong> R decreases because 1−R grows like 1/√σ<sub>0</sub>.</li>
    </ul>

    <a class="backTop" href="#top">Back to top ↑</a>
  </section>

  <section id="part5" class="card plotCard">
    <h2>PART 5 — Optional Plot Guide (A Single Static Plot)</h2>

    <figure>
      <canvas id="plot" width="900" height="520" aria-label="Plot of Hagen–Rubens reflectivity vs frequency"></canvas>
      <figcaption class="muted" style="margin-top:10px;">
        <strong>Example plot:</strong> Hagen–Rubens reflectivity R(ω) for a fixed example conductivity σ<sub>0</sub> = 2.1×10<sup>17</sup> s<sup>−1</sup> (CGS as in the problem),
        over ω from 1×10<sup>13</sup> to 3×10<sup>14</sup> s<sup>−1</sup>. Example values are for visualization only.
      </figcaption>
    </figure>

    <div class="callout">
      <div class="tag"><span class="badge"></span><strong>What to notice</strong></div>
      <ul class="tight muted">
        <li>R stays close to 1, but decreases with ω.</li>
        <li>The curvature reflects the √ω dependence (loss grows sublinearly with ω).</li>
        <li>Engineering intuition: better conductors (larger σ<sub>0</sub>) would shift the curve upward.</li>
      </ul>
    </div>

    <a class="backTop" href="#top">Back to top ↑</a>
  </section>
</main>

<footer class="wrap">
  <div class="card" style="padding:14px;">
    <div class="muted">
      <strong>Note on conventions:</strong> This solution follows the statement’s CGS-style ε(ω) = 1 + i(4πσ<sub>0</sub>/ω).
      In SI the corresponding expressions involve ε<sub>0</sub> and look different—convert with care.
    </div>
  </div>
</footer>

<script>
  (function(){
    // Copy buttons: copy plain text of the associated block (or provided prefix).
    function getTextFromTarget(selector){
      var el = document.querySelector(selector);
      if(!el) return "";
      var pre = el.querySelector("pre");
      return (pre ? pre.textContent : el.textContent).trim();
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        var ta = document.createElement("textarea");
        ta.value = text;
        ta.style.position = "fixed";
        ta.style.left = "-9999px";
        ta.style.top = "0";
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        try{
          var ok = document.execCommand("copy");
          document.body.removeChild(ta);
          return ok;
        }catch(err){
          document.body.removeChild(ta);
          return false;
        }
      }
    }

    document.querySelectorAll("button.copyBtn").forEach(function(btn){
      btn.addEventListener("click", async function(){
        var target = btn.getAttribute("data-copy-target");
        var prefix = btn.getAttribute("data-copy-prefix");
        var text = prefix || getTextFromTarget(target);
        var ok = await copyText(text);
        var old = btn.textContent;
        btn.textContent = ok ? "Copied ✓" : "Copy failed";
        setTimeout(function(){ btn.textContent = old; }, 1100);
      });
    });

    // Plot: single static canvas of R(ω)=1-sqrt(2ω/(πσ0)) for example σ0.
    const canvas = document.getElementById("plot");
    if(!canvas) return;
    const ctx = canvas.getContext("2d");

    function dprFix(c){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = c.getBoundingClientRect();
      c.width = Math.round(rect.width * dpr);
      c.height = Math.round((rect.width * 0.58) * dpr);
      return dpr;
    }

    function draw(){
      const dpr = dprFix(canvas);
      const w = canvas.width, h = canvas.height;

      const styles = getComputedStyle(document.documentElement);
      const border = styles.getPropertyValue("--border").trim() || "rgba(255,255,255,0.12)";
      const text = styles.getPropertyValue("--text").trim() || "#e8eef6";
      const muted = styles.getPropertyValue("--muted").trim() || "#b7c3d6";

      ctx.clearRect(0,0,w,h);

      const padL = 68*dpr, padR = 18*dpr, padT = 34*dpr, padB = 56*dpr;
      const x0 = padL, y0 = h - padB, x1 = w - padR, y1 = padT;
      const pw = x1 - x0, ph = y0 - y1;

      // Example values (explicitly labeled in caption)
      const sigma0 = 2.1e17; // s^-1 (CGS per problem statement)
      const wMin = 1.0e13;
      const wMax = 3.0e14;

      function R(omega){
        const val = 1 - Math.sqrt((2*omega)/(Math.PI*sigma0));
        return Math.max(0, Math.min(1, val));
      }

      // y-range: show small change near 1
      const yMin = 0.90, yMax = 1.00;

      function xMap(omega){
        return x0 + (omega - wMin) * (pw / (wMax - wMin));
      }
      function yMap(r){
        return y0 - (r - yMin) * (ph / (yMax - yMin));
      }

      // Gridlines
      ctx.save();
      ctx.lineWidth = 1*dpr;
      ctx.strokeStyle = border;

      const nx = 6;
      for(let i=0;i<=nx;i++){
        const omega = wMin + (wMax-wMin)*(i/nx);
        const x = xMap(omega);
        ctx.beginPath();
        ctx.moveTo(x, y0);
        ctx.lineTo(x, y1);
        ctx.stroke();
      }

      const ny = 5;
      for(let j=0;j<=ny;j++){
        const r = yMin + (yMax-yMin)*(j/ny);
        const y = yMap(r);
        ctx.beginPath();
        ctx.moveTo(x0, y);
        ctx.lineTo(x1, y);
        ctx.stroke();
      }
      ctx.restore();

      // Axes
      ctx.save();
      ctx.strokeStyle = text;
      ctx.lineWidth = 1.6*dpr;
      ctx.beginPath(); ctx.moveTo(x0, y0); ctx.lineTo(x1, y0); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(x0, y0); ctx.lineTo(x0, y1); ctx.stroke();
      ctx.restore();

      // Labels
      ctx.save();
      ctx.fillStyle = muted;
      ctx.font = `${12*dpr}px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial`;
      ctx.textBaseline = "middle";

      // X ticks
      ctx.textAlign = "center";
      for(let i=0;i<=nx;i++){
        const omega = wMin + (wMax-wMin)*(i/nx);
        const x = xMap(omega);
        const label = (omega/1e14).toFixed(2) + "×10^14";
        ctx.fillText(label, x, y0 + 20*dpr);
      }

      // Y ticks
      ctx.textAlign = "right";
      for(let j=0;j<=ny;j++){
        const r = yMin + (yMax-yMin)*(j/ny);
        const y = yMap(r);
        ctx.fillText(r.toFixed(2), x0 - 10*dpr, y);
      }

      // Axis titles
      ctx.textAlign = "center";
      ctx.fillStyle = text;
      ctx.font = `${13*dpr}px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial`;
      ctx.fillText("Angular frequency ω  (s⁻¹)", (x0+x1)/2, h - 20*dpr);

      ctx.save();
      ctx.translate(18*dpr, (y0+y1)/2);
      ctx.rotate(-Math.PI/2);
      ctx.fillText("Reflectivity R  (dimensionless)", 0, 0);
      ctx.restore();

      // Title
      ctx.fillStyle = text;
      ctx.font = `${14*dpr}px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial`;
      ctx.textAlign = "left";
      ctx.fillText("Hagen–Rubens:  R(ω) = 1 − √(2ω/(πσ₀))  (example σ₀ fixed)", x0, 18*dpr);

      // Curve
      ctx.save();
      ctx.lineWidth = 2.4*dpr;
      ctx.strokeStyle = text;
      ctx.beginPath();
      const N = 240;
      for(let k=0;k<=N;k++){
        const omega = wMin + (wMax-wMin)*(k/N);
        const r = R(omega);
        const x = xMap(omega);
        const y = yMap(r);
        if(k===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      }
      ctx.stroke();
      ctx.restore();

      // Legend
      ctx.save();
      ctx.fillStyle = muted;
      ctx.font = `${12*dpr}px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial`;
      ctx.textAlign = "left";
      ctx.fillText("Curve: Hagen–Rubens prediction (example σ₀)", x0, y1 + 14*dpr);
      ctx.restore();
    }

    window.addEventListener("resize", function(){ draw(); }, {passive:true});
    requestAnimationFrame(draw);
  })();
</script>
</body>
</html>