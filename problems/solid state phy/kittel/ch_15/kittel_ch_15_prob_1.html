<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Causality, Kramers–Kronig, and the Impulse Response of a Damped Oscillator</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#0f1730;
      --card:#121c3a;
      --text:#e9eefc;
      --muted:#b8c3ea;
      --faint:#7f8bb7;
      --accent:#7cf0d6;
      --accent2:#9aa7ff;
      --warn:#ffd27a;
      --ok:#8dffb3;
      --danger:#ff8ea1;
      --line:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    html,body{height:100%;}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 20% 10%, rgba(154,167,255,.18), transparent 60%),
                  radial-gradient(1100px 700px at 85% 20%, rgba(124,240,214,.14), transparent 60%),
                  linear-gradient(180deg, var(--bg), #070a14 70%);
      color:var(--text);
      line-height:1.55;
    }

    header{
      padding: 28px 18px 10px 18px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .title{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:18px;
      flex-wrap:wrap;
    }

    h1{
      margin:0;
      font-size: clamp(1.4rem, 2.4vw, 2.1rem);
      letter-spacing:.2px;
      line-height:1.2;
    }
    .subtitle{
      margin:10px 0 0 0;
      color:var(--muted);
      max-width: 78ch;
      font-size: 1.02rem;
    }

    .meta{
      margin-top:14px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      color:var(--faint);
      font-size:.95rem;
    }
    .pill{
      padding:6px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      background: rgba(255,255,255,.04);
      backdrop-filter: blur(6px);
    }

    main{
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
    }

    nav{
      position: sticky;
      top: 14px;
      align-self:start;
      background: rgba(18,28,58,.62);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    nav .navHead{
      padding:14px 14px 10px 14px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    nav .navHead strong{
      font-size:1rem;
      letter-spacing:.3px;
    }
    nav .navBody{
      padding: 10px 6px 14px 6px;
    }
    nav a{
      display:block;
      padding:10px 12px;
      margin: 2px 6px;
      border-radius: 12px;
      color: var(--muted);
      text-decoration:none;
      border:1px solid transparent;
      transition: transform .12s ease, background .12s ease, color .12s ease, border-color .12s ease;
      font-size:.98rem;
    }
    nav a:hover{
      background: rgba(124,240,214,.08);
      border-color: rgba(124,240,214,.25);
      color: var(--text);
      transform: translateY(-1px);
    }
    nav a small{color:var(--faint); display:block; margin-top:2px; font-size:.86rem;}

    .content{
      display:flex;
      flex-direction:column;
      gap: 16px;
    }

    section, article{
      background: rgba(18,28,58,.62);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 18px 16px 18px;
    }

    h2{
      margin: 0 0 8px 0;
      font-size: clamp(1.15rem, 1.7vw, 1.55rem);
      letter-spacing:.2px;
    }
    h3{
      margin: 16px 0 8px 0;
      font-size: 1.08rem;
      color: var(--text);
    }
    p{margin: 8px 0;}
    ul{margin: 10px 0 8px 1.2rem;}
    li{margin: 6px 0; color: var(--muted);}
    li strong{color: var(--text);}

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 960px){
      main{grid-template-columns: 1fr;}
      nav{position:relative; top:auto;}
      .grid2{grid-template-columns:1fr;}
    }

    .callouts{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 10px;
    }
    @media (max-width: 960px){ .callouts{grid-template-columns:1fr;} }

    .callout{
      border-radius: 16px;
      padding: 14px 14px 12px 14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
    }
    .callout .tag{
      display:inline-block;
      font-size:.82rem;
      letter-spacing:.3px;
      padding:4px 9px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--faint);
      margin-bottom: 8px;
    }
    .callout.assumptions .tag{color: var(--warn); border-color: rgba(255,210,122,.35); background: rgba(255,210,122,.06);}
    .callout.keyeq .tag{color: var(--accent); border-color: rgba(124,240,214,.35); background: rgba(124,240,214,.06);}
    .callout.mistakes .tag{color: var(--danger); border-color: rgba(255,142,161,.35); background: rgba(255,142,161,.06);}
    .callout.final .tag{color: var(--ok); border-color: rgba(141,255,179,.35); background: rgba(141,255,179,.06);}

    .eqBlock{
      margin: 10px 0;
      border-radius: 16px;
      border: 1px dashed rgba(154,167,255,.35);
      background: rgba(154,167,255,.06);
      overflow:hidden;
    }
    .eqTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 10px 12px;
      border-bottom:1px solid rgba(154,167,255,.18);
    }
    .eqTop .label{
      color: var(--muted);
      font-size:.92rem;
    }
    .btn{
      appearance:none;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      font-size:.92rem;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(124,240,214,.08);
      border-color: rgba(124,240,214,.25);
    }
    pre.eq{
      margin:0;
      padding: 12px 12px 14px 12px;
      font-family: var(--mono);
      font-size: .95rem;
      color: var(--text);
      overflow:auto;
      white-space: pre;
      tab-size: 2;
    }

    details{
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.03);
      padding: 10px 12px;
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      color: var(--muted);
      font-weight:600;
    }
    details[open] summary{color: var(--text);}
    .mathInsight{
      border: 1px solid rgba(124,240,214,.35);
      background: rgba(124,240,214,.06);
      border-radius: 16px;
      padding: 14px 14px 12px 14px;
      margin-top: 10px;
    }
    .mathInsight strong{color: var(--accent);}

    figure{
      margin: 10px 0 0 0;
      padding: 12px;
      border-radius: 16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
    }
    figcaption{
      margin-top:8px;
      color: var(--faint);
      font-size:.92rem;
    }

    .toplink{
      display:inline-block;
      margin-top: 10px;
      color: var(--accent2);
      text-decoration:none;
      border-bottom: 1px dashed rgba(154,167,255,.45);
    }
    .toplink:hover{color: var(--text);}

    .kicker{
      color: var(--faint);
      font-size:.95rem;
      margin-top: 2px;
    }

    footer{
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 18px 26px 18px;
      color: var(--faint);
      font-size:.95rem;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000;}
      nav{display:none;}
      main{grid-template-columns:1fr; padding:0;}
      section, article{box-shadow:none; background:#fff; border:1px solid #ddd;}
      .btn{display:none;}
      .eqBlock{border-color:#666; background:#f7f7ff;}
      pre.eq{color:#000;}
      a{color:#000; text-decoration:underline;}
      .pagebreak{break-before:page;}
    }
  </style>
</head>

<body>
  <a id="top"></a>
  <header>
    <div class="title">
      <div>
        <h1>Causality and the Response Function: Impulse Response of a Damped Harmonic Oscillator</h1>
        <p class="subtitle">
          We prove causality (no response before the force) using complex analysis / Kramers–Kronig logic, then compute the
          explicit time-domain displacement caused by an impulsive force <span style="font-family:var(--mono);">F(t)=δ(t)</span>
          for a linear damped oscillator with frequency-domain response <span style="font-family:var(--mono);">α(ω)</span>.
        </p>
        <div class="meta">
          <span class="pill">Applied physics + math-physics rigor</span>
          <span class="pill">Industrial engineering relevance</span>
          <span class="pill">Contour integration (upper vs lower half-plane)</span>
        </div>
      </div>
    </div>
  </header>

  <main>
    <nav aria-label="Table of contents">
      <div class="navHead">
        <strong>Table of Contents</strong>
        <button class="btn" id="collapseTocBtn" type="button" aria-expanded="true">Collapse</button>
      </div>
      <div class="navBody" id="tocBody">
        <a href="#quick">Quick Summary <small>What &amp; why + result</small></a>
        <a href="#part0">PART 0 — Concept Primer <small>Linear response, causality, transforms</small></a>
        <a href="#part0b">PART 0B — Industry Perspective <small>Why engineers care</small></a>
        <a href="#part1">PART 1 — Problem Analysis <small>Given/unknowns/assumptions</small></a>
        <a href="#part2">PART 2 — Strategy &amp; Tips <small>Roadmap + pitfalls</small></a>
        <a href="#part3">PART 3 — Full Solution <small>Contour proof + residues</small></a>
        <a href="#part4">PART 4 — Deeper Understanding <small>Interpretation + checks</small></a>
        <a href="#part5">PART 5 — Optional Plot Guide <small>Impulse response example</small></a>
      </div>
    </nav>

    <div class="content">

      <section id="quick">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this is about:</strong> showing that a physically causal oscillator does not respond before an applied impulse, and computing the response for later times.</li>
          <li><strong>Key physics idea:</strong> <em>causality</em> ↔ <em>analyticity</em> of the response function in the upper-half complex frequency plane (the same backbone behind Kramers–Kronig relations).</li>
          <li><strong>Governing model:</strong> linear time-invariant damped oscillator driven by an external force, with frequency response
            <span style="font-family:var(--mono);">α(ω)=1/(ω0^2−ω^2−iρω)</span>.</li>
          <li><strong>Impulse forcing:</strong> <span style="font-family:var(--mono);">F(t)=δ(t)= (1/2π)∫ e^(−iωt) dω</span> (Fourier representation).</li>
          <li><strong>Main causality result:</strong> for <span style="font-family:var(--mono);">t&lt;0</span>, close the contour in the <strong>upper</strong> half-plane; since the poles of <span style="font-family:var(--mono);">α(ω)</span> lie in the <strong>lower</strong> half-plane, the integral is zero ⇒ <span style="font-family:var(--mono);">x(t)=0</span>.</li>
          <li><strong>Main computed response:</strong> for <span style="font-family:var(--mono);">t&gt;0</span>, close in the <strong>lower</strong> half-plane and sum residues at the poles to obtain a decaying sinusoid (underdamped case).</li>
          <li><strong>Symbolic final answer:</strong> <span style="font-family:var(--mono);">x(t)=θ(t) e^(−ρt/2) sin(Ω t)/Ω</span>, with <span style="font-family:var(--mono);">Ω = sqrt(ω0^2 − ρ^2/4)</span>.</li>
          <li><strong>Physical meaning:</strong> the impulse “kicks” the oscillator, producing a ring-down that starts exactly at <span style="font-family:var(--mono);">t=0</span> and decays with time constant <span style="font-family:var(--mono);">2/ρ</span>.</li>
        </ul>

        <div class="callouts">
          <div class="callout keyeq">
            <div class="tag">Key equation (copyable)</div>
            <div class="eqBlock">
              <div class="eqTop">
                <span class="label">Frequency response and impulse-response integral</span>
                <button class="btn copyBtn" data-copy-target="#eq-quick-1" type="button">Copy</button>
              </div>
              <pre class="eq" id="eq-quick-1">α(ω) = 1 / (ω0^2 − ω^2 − i ρ ω)
x(t) = (1/2π) ∫_{−∞}^{∞} α(ω) e^{−i ω t} dω</pre>
            </div>
          </div>

          <div class="callout final">
            <div class="tag">Final answer (copyable)</div>
            <div class="eqBlock">
              <div class="eqTop">
                <span class="label">Causal displacement for an impulse force</span>
                <button class="btn copyBtn" data-copy-target="#eq-quick-2" type="button">Copy</button>
              </div>
              <pre class="eq" id="eq-quick-2">Let Ω = sqrt(ω0^2 − ρ^2/4).  (underdamped: ω0 > ρ/2)

x(t) = 0,                         t < 0
x(t) = e^{−ρ t/2} sin(Ω t) / Ω,   t > 0

Equivalently: x(t) = θ(t) e^{−ρ t/2} sin(Ω t)/Ω.</pre>
            </div>
          </div>
        </div>

        <a class="toplink" href="#top">Back to top</a>
      </section>

      <article id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <h3>0.1 Core definitions (symbols + SI units)</h3>
        <ul>
          <li><strong>x(t)</strong> — displacement (m).</li>
          <li><strong>F(t)</strong> — applied force per unit mass (m/s²) if mass is absorbed into definition; or force (N) if mass is explicit. In this standard response-function setup, we treat the equation as normalized by mass.</li>
          <li><strong>ω</strong> — angular frequency variable (rad/s).</li>
          <li><strong>ω0</strong> — undamped natural frequency (rad/s).</li>
          <li><strong>ρ</strong> — damping coefficient (s⁻¹). (Many texts write <span style="font-family:var(--mono);">γ</span>.)</li>
          <li><strong>α(ω)</strong> — (complex) frequency-domain response function (units of s² if the driving is acceleration-like; more generally “output per input” in frequency domain).</li>
          <li><strong>θ(t)</strong> — Heaviside step function: <span style="font-family:var(--mono);">θ(t)=0</span> for <span style="font-family:var(--mono);">t&lt;0</span>, <span style="font-family:var(--mono);">θ(t)=1</span> for <span style="font-family:var(--mono);">t&gt;0</span>.</li>
          <li><strong>δ(t)</strong> — Dirac delta distribution (s⁻¹), representing an impulse at <span style="font-family:var(--mono);">t=0</span>.</li>
        </ul>

        <h3>0.2 Physical meaning</h3>
        <p>
          A linear oscillator responds to a drive by superposition. If the system is <strong>causal</strong>,
          it cannot move before the drive is applied. In frequency space, causality becomes a powerful
          statement about where the poles of <span style="font-family:var(--mono);">α(ω)</span> are allowed to be:
          a causal, stable response has its singularities in the <strong>lower</strong> half of the complex <span style="font-family:var(--mono);">ω</span>-plane.
        </p>

        <h3>0.3 Linear response + Fourier transform (operator viewpoint)</h3>
        <p>
          A linear time-invariant (LTI) system maps input to output by convolution with a Green’s function
          <span style="font-family:var(--mono);">G(t)</span>:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">LTI mapping (convolution form)</span>
            <button class="btn copyBtn" data-copy-target="#eq-0-1" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-0-1">x(t) = ∫_{−∞}^{∞} G(t − t′) F(t′) dt′</pre>
        </div>
        <p>
          In frequency domain, convolution becomes multiplication:
          <span style="font-family:var(--mono);">x(ω) = α(ω) F(ω)</span>, with <span style="font-family:var(--mono);">α(ω)</span> the transfer function / susceptibility.
        </p>

        <h3>0.4 The damped oscillator model (ODE + validity)</h3>
        <p>
          The standard damped oscillator (normalized by mass) is:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Time-domain ODE model</span>
            <button class="btn copyBtn" data-copy-target="#eq-0-2" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-0-2">d²x/dt² + ρ (dx/dt) + ω0² x = F(t)</pre>
        </div>
        <p class="kicker">
          Assumptions: linear restoring force, linear viscous damping, time-invariant parameters, and a stable equilibrium.
        </p>

        <h3>0.5 Frequency response from the ODE (why it looks like α(ω))</h3>
        <p>
          Using the Fourier convention
          <span style="font-family:var(--mono);">f(t)=(1/2π)∫ f(ω)e^{−iωt} dω</span>,
          derivatives become multiplications:
          <span style="font-family:var(--mono);">d/dt ↦ −iω</span>, <span style="font-family:var(--mono);">d²/dt² ↦ −ω²</span>.
          Thus the differential operator
          <span style="font-family:var(--mono);">L = d²/dt² + ρ d/dt + ω0²</span>
          becomes
          <span style="font-family:var(--mono);">L(ω) = (−ω²) + ρ(−iω) + ω0² = ω0² − ω² − i ρ ω</span>,
          so:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Response function</span>
            <button class="btn copyBtn" data-copy-target="#eq-0-3" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-0-3">α(ω) = 1 / (ω0² − ω² − i ρ ω)</pre>
        </div>

        <div class="mathInsight">
          <strong>Math Insight:</strong>
          <p style="margin:8px 0 0 0; color:var(--muted);">
            The impulse response is the <em>Green’s function</em> of a linear ODE. In the complex-ω plane, <span style="font-family:var(--mono);">α(ω)</span>
            is a meromorphic function; its poles encode the system’s eigenmodes. Causality is enforced by analyticity in the
            upper half-plane (no poles there), which is precisely the analytic structure behind Kramers–Kronig relations.
          </p>
        </div>

        <h3>0.6 Mini intuition examples (no heavy algebra)</h3>
        <ul>
          <li><strong>No damping (ρ=0):</strong> impulse produces a pure sinusoid <span style="font-family:var(--mono);">x(t)∝sin(ω0 t)</span> starting at <span style="font-family:var(--mono);">t=0</span>.</li>
          <li><strong>More damping:</strong> the oscillations decay faster; poles move deeper into the lower half-plane.</li>
          <li><strong>Overdamped:</strong> no oscillations; response is a sum of two decaying exponentials (poles remain in lower half-plane).</li>
        </ul>

        <h3>0.7 What to watch for (pitfalls &amp; sign conventions)</h3>
        <ul>
          <li><strong>Fourier sign convention:</strong> with <span style="font-family:var(--mono);">e^{−iωt}</span>, the decay condition on the contour depends on the sign of <span style="font-family:var(--mono);">t</span>.</li>
          <li><strong>Contour orientation:</strong> closing in the lower half-plane gives a clockwise contour (minus sign in residue theorem).</li>
          <li><strong>Causality vs stability:</strong> stability requires poles in the lower half-plane; causality requires analyticity in the upper half-plane for the retarded response.</li>
          <li><strong>Units check:</strong> be consistent about whether the equation is normalized by mass.</li>
        </ul>

        <a class="toplink" href="#top">Back to top</a>
      </article>

      <article id="part0b">
        <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>

        <h3>Where this appears in industry (concrete applications)</h3>
        <ul>
          <li><strong>Vibration &amp; machinery dynamics:</strong> impulse testing (hammer tests) to identify resonances of motors, pumps, machine tools, and structural frames.</li>
          <li><strong>MEMS sensors &amp; actuators:</strong> accelerometers, gyros, and resonant sensors where transfer functions dictate bandwidth, noise shaping, and shock response.</li>
          <li><strong>Control systems &amp; servo design:</strong> Bode/transfer-function methods rely on causality; non-causal models cause unstable or unrealizable controllers.</li>
          <li><strong>Signal integrity / materials response:</strong> dielectric and viscoelastic response functions use the same Kramers–Kronig causality constraints.</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><strong>Performance:</strong> resonance peaks amplify motion/force; knowing <span style="font-family:var(--mono);">α(ω)</span> predicts amplification and ring-down time.</li>
          <li><strong>Reliability &amp; fatigue:</strong> impulse responses determine how shocks (drops, impacts) translate into stress cycles.</li>
          <li><strong>Safety:</strong> avoiding excessive transient oscillations in cranes, robotics arms, or vehicle suspensions.</li>
          <li><strong>Cost &amp; manufacturability:</strong> damping (materials, coatings, tuned dampers) trades off with efficiency, mass, and complexity.</li>
        </ul>

        <h3>Typical measurement / validation methods</h3>
        <ul>
          <li><strong>Impact (modal) testing:</strong> measure force input and displacement/acceleration output → estimate frequency response function (FRF).</li>
          <li><strong>Ring-down tests:</strong> excite then measure decay to estimate damping <span style="font-family:var(--mono);">ρ</span> (log decrement).</li>
          <li><strong>Swept-sine:</strong> map magnitude/phase vs frequency and compare to model constraints (including causality/K–K consistency).</li>
        </ul>

        <h3>Design trade-offs &amp; real-world constraints</h3>
        <ul>
          <li><strong>Non-ideal damping:</strong> real damping may be frequency-dependent (viscoelastic), requiring generalized <span style="font-family:var(--mono);">α(ω)</span>.</li>
          <li><strong>Tolerances:</strong> manufacturing spread shifts <span style="font-family:var(--mono);">ω0</span>; design must be robust to parameter variation.</li>
          <li><strong>Nonlinearity:</strong> large deflections violate linear assumptions; response becomes amplitude-dependent.</li>
        </ul>

        <details>
          <summary>From lab to product: how the ideal model is adapted</summary>
          <p>
            In products, engineers often fit <span style="font-family:var(--mono);">α(ω)</span> from measured FRFs, then enforce causality and stability by ensuring poles remain in the lower half-plane.
            Frequency-dependent damping can be modeled by replacing <span style="font-family:var(--mono);">i ρ ω</span> with a more general complex loss term (e.g., Kelvin–Voigt or fractional derivative models),
            while preserving analyticity constraints.
          </p>
        </details>

        <a class="toplink" href="#top">Back to top</a>
      </article>

      <article id="part1">
        <h2>PART 1 — Problem Analysis (No solving yet)</h2>

        <h3>1.1 Restate the problem in plain words</h3>
        <p>
          A delta-function force is applied at time <span style="font-family:var(--mono);">t=0</span>:
          <span style="font-family:var(--mono);">F(t)=δ(t)</span>, written as a Fourier integral.
          The oscillator has frequency response
          <span style="font-family:var(--mono);">α(ω) = 1/(ω0² − ω² − i ρ ω)</span>.
          (a) Show that the displacement response <span style="font-family:var(--mono);">x(t)</span> is zero for <span style="font-family:var(--mono);">t&lt;0</span> (causality).
          (b) Compute <span style="font-family:var(--mono);">x(t)</span> for <span style="font-family:var(--mono);">t&gt;0</span>, using the fact that the poles lie in the lower half-plane.
        </p>

        <h3>1.2 Given quantities</h3>
        <ul>
          <li>Impulse: <span style="font-family:var(--mono);">F(t)=δ(t) = (1/2π)∫_{−∞}^{∞} e^{−iωt} dω</span>.</li>
          <li>Response function: <span style="font-family:var(--mono);">α(ω) = 1/(ω0² − ω² − i ρ ω)</span>.</li>
          <li>Pole locations: <span style="font-family:var(--mono);">ω = ±sqrt(ω0² − ρ²/4) − i ρ/2</span> (both in lower half-plane).</li>
        </ul>

        <h3>1.3 Unknowns</h3>
        <ul>
          <li><span style="font-family:var(--mono);">x(t)</span> for <span style="font-family:var(--mono);">t&lt;0</span> and <span style="font-family:var(--mono);">t&gt;0</span>.</li>
        </ul>

        <h3>1.4 Principles that apply (and why)</h3>
        <ul>
          <li><strong>Linearity:</strong> impulse response defines the system completely via convolution.</li>
          <li><strong>Fourier analysis:</strong> δ(t) has flat frequency content, letting us read the time response from the inverse transform of <span style="font-family:var(--mono);">α(ω)</span>.</li>
          <li><strong>Complex analysis / residue theorem:</strong> evaluate the inverse Fourier integral by closing the contour where the exponential decays.</li>
          <li><strong>Causality:</strong> for retarded response, poles must not lie in the upper half-plane; that is exactly what guarantees <span style="font-family:var(--mono);">x(t&lt;0)=0</span>.</li>
        </ul>

        <div class="callout assumptions">
          <div class="tag">Assumptions</div>
          <ul>
            <li>Stable, causal (retarded) response: poles of <span style="font-family:var(--mono);">α(ω)</span> are in the lower half-plane.</li>
            <li>LTI model; parameters <span style="font-family:var(--mono);">ω0</span>, <span style="font-family:var(--mono);">ρ</span> are constants.</li>
            <li>Arc contribution at infinity vanishes (justified by exponential decay from <span style="font-family:var(--mono);">e^{−iωt}</span> with appropriate contour).</li>
          </ul>
        </div>

        <h3>1.5 Possible approaches (compare)</h3>
        <div class="grid2">
          <div class="callout">
            <div class="tag">Approach A — Contour integration</div>
            <ul>
              <li><strong>Pros:</strong> directly proves causality; uses pole locations exactly as the problem hints.</li>
              <li><strong>Cons:</strong> requires careful sign/orientation handling.</li>
              <li><strong>Best when:</strong> you know analytic structure (poles/branch cuts).</li>
            </ul>
          </div>
          <div class="callout">
            <div class="tag">Approach B — Solve ODE with δ(t)</div>
            <ul>
              <li><strong>Pros:</strong> physical: impulse induces jump in velocity; quick for oscillators.</li>
              <li><strong>Cons:</strong> needs distribution/jump-condition reasoning; causality is assumed via initial conditions.</li>
              <li><strong>Best when:</strong> time-domain intuition is primary.</li>
            </ul>
          </div>
        </div>
        <div class="callout">
          <div class="tag">Approach C — Kramers–Kronig (KK)</div>
          <ul>
            <li><strong>Pros:</strong> connects to dispersion relations; emphasizes causality ↔ analyticity.</li>
            <li><strong>Cons:</strong> more abstract; still usually ends with contour reasoning.</li>
            <li><strong>Best when:</strong> you want a general statement beyond this oscillator.</li>
          </ul>
        </div>

        <p>
          <strong>Choice:</strong> Approach A (contour integration) is the cleanest because the prompt explicitly mentions contour closure and pole locations.
        </p>

        <a class="toplink" href="#top">Back to top</a>
      </article>

      <article id="part2">
        <h2>PART 2 — Strategy &amp; Tips (Roadmap only)</h2>

        <ol style="margin:10px 0 0 1.2rem; color:var(--muted);">
          <li><strong>Write the response integral</strong>: use the Fourier representation of δ(t) to express <span style="font-family:var(--mono);">x(t)</span> as an inverse Fourier integral of <span style="font-family:var(--mono);">α(ω)</span>.</li>
          <li><strong>Analyze exponential decay</strong>: for complex <span style="font-family:var(--mono);">ω=u+iv</span>, determine where <span style="font-family:var(--mono);">e^{−iωt}</span> decays as |ω|→∞ for a given sign of t.</li>
          <li><strong>Choose contour</strong>: close in upper half-plane for <span style="font-family:var(--mono);">t&lt;0</span> and in lower half-plane for <span style="font-family:var(--mono);">t&gt;0</span>.</li>
          <li><strong>Use analyticity/poles</strong>: note poles of <span style="font-family:var(--mono);">α(ω)</span> are in the lower half-plane only.</li>
          <li><strong>Prove causality</strong>: for <span style="font-family:var(--mono);">t&lt;0</span>, upper contour encloses no poles → integral zero.</li>
          <li><strong>Compute residues</strong>: for <span style="font-family:var(--mono);">t&gt;0</span>, sum residues of <span style="font-family:var(--mono);">α(ω)e^{−iωt}</span> at the two poles.</li>
          <li><strong>Simplify</strong>: express result in terms of <span style="font-family:var(--mono);">Ω = sqrt(ω0² − ρ²/4)</span> (or handle overdamped case as exponentials).</li>
          <li><strong>Sanity checks</strong>: units, limits (<span style="font-family:var(--mono);">ρ→0</span>, large t), and “starts at t=0”.</li>
        </ol>

        <div class="callout mistakes" style="margin-top:12px;">
          <div class="tag">Common mistakes</div>
          <ul>
            <li>Closing the contour in the wrong half-plane for a given sign of <span style="font-family:var(--mono);">t</span>.</li>
            <li>Forgetting that closing in the lower half-plane yields a <strong>clockwise</strong> contour (introduces a minus sign in residue theorem).</li>
            <li>Mixing Fourier conventions (extra factors of <span style="font-family:var(--mono);">2π</span>).</li>
            <li>Dropping the Heaviside factor: the final answer must explicitly encode causality.</li>
          </ul>
        </div>

        <a class="toplink" href="#top">Back to top</a>
      </article>

      <article id="part3" class="pagebreak">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>3.1 Physical intuition first (qualitative expectation)</h3>
        <p>
          An impulse at <span style="font-family:var(--mono);">t=0</span> gives the oscillator an instantaneous “kick.”
          A stable damped oscillator then rings down: oscillations at a damped frequency with an exponential envelope.
          Before the kick (<span style="font-family:var(--mono);">t&lt;0</span>), a causal system must have <span style="font-family:var(--mono);">x(t)=0</span>.
        </p>

        <h3>3.2 Mathematical model (variables, domain, and conditions)</h3>
        <p>
          Time domain: <span style="font-family:var(--mono);">t ∈ ℝ</span>.
          Frequency domain: <span style="font-family:var(--mono);">ω ∈ ℝ</span> for the integral, extended to complex <span style="font-family:var(--mono);">ω ∈ ℂ</span> for contour methods.
        </p>
        <p>
          We use the LTI frequency-space relation <span style="font-family:var(--mono);">x(ω)=α(ω)F(ω)</span>.
          With the Fourier pair
          <span style="font-family:var(--mono);">f(t)=(1/2π)∫ f(ω)e^{−iωt} dω</span>,
          the delta function satisfies <span style="font-family:var(--mono);">δ(t)=(1/2π)∫ e^{−iωt} dω</span>, i.e. <span style="font-family:var(--mono);">F(ω)=1</span>.
        </p>

        <div class="callout keyeq">
          <div class="tag">Key setup</div>
          <p style="margin:8px 0; color:var(--muted);">
            For an impulse input, the displacement is the inverse Fourier transform of <span style="font-family:var(--mono);">α(ω)</span>:
          </p>
          <div class="eqBlock">
            <div class="eqTop">
              <span class="label">Impulse response integral</span>
              <button class="btn copyBtn" data-copy-target="#eq-3-1" type="button">Copy</button>
            </div>
            <pre class="eq" id="eq-3-1">x(t) = (1/2π) ∫_{−∞}^{∞} α(ω) e^{−i ω t} dω
α(ω) = 1/(ω0^2 − ω^2 − i ρ ω)</pre>
          </div>
        </div>

        <h3>3.3 Part (a): Prove x(t)=0 for t&lt;0 (causality)</h3>
        <p>
          Let <span style="font-family:var(--mono);">ω = u + i v</span> with <span style="font-family:var(--mono);">u,v ∈ ℝ</span>.
          Then the exponential factor is
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Decay test</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-2" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-2">e^{−i ω t} = e^{−i(u+iv)t} = e^{−i u t} · e^{v t}</pre>
        </div>
        <p>
          For <strong>t&lt;0</strong>, if we take <span style="font-family:var(--mono);">v&gt;0</span> (upper half-plane),
          then <span style="font-family:var(--mono);">e^{v t} = e^{−|t| v}</span> decays exponentially as <span style="font-family:var(--mono);">v</span> grows.
          This means the contribution from a large semicircle in the <strong>upper</strong> half-plane vanishes.
        </p>
        <p>
          Now use the given analytic structure: the poles of
          <span style="font-family:var(--mono);">α(ω)</span> are at
          <span style="font-family:var(--mono);">ω = ±sqrt(ω0² − ρ²/4) − iρ/2</span>,
          which are strictly in the <strong>lower</strong> half-plane (since <span style="font-family:var(--mono);">−iρ/2</span> has negative imaginary part).
          Therefore, the closed contour in the upper half-plane encloses <strong>no poles</strong>.
        </p>

        <p>
          By Cauchy’s theorem (integral of an analytic function around a closed contour is zero),
          the contour integral is zero, and since the arc contribution vanishes, the real-axis integral must be zero:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Causality conclusion</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-3" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-3">t < 0  ⇒  x(t) = (1/2π) ∫_{−∞}^{∞} α(ω) e^{−i ω t} dω = 0</pre>
        </div>
        <p>
          This is the frequency-domain manifestation of “an effect cannot precede its cause.”
          In KK language: analyticity in the upper half-plane implies real/imaginary parts are Hilbert transforms of each other,
          which is another way of encoding the same causal constraint.
        </p>

        <h3>3.4 Part (b): Evaluate x(t) for t&gt;0 (residue theorem)</h3>
        <p>
          For <strong>t&gt;0</strong>, we want the arc contribution to vanish, so we require <span style="font-family:var(--mono);">e^{v t}</span> to decay.
          That happens when <span style="font-family:var(--mono);">v&lt;0</span>, i.e. in the <strong>lower</strong> half-plane.
          Thus we close the contour with a large semicircle below the real axis.
        </p>

        <p>
          Now we compute residues at the poles of <span style="font-family:var(--mono);">α(ω)</span>.
          First, factor the denominator carefully:
        </p>

        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Complete the square + define the damped frequency</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-4" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-4">Denominator D(ω) = ω0^2 − ω^2 − i ρ ω
= −(ω^2 + i ρ ω − ω0^2)
= −[(ω + iρ/2)^2 − (ω0^2 − ρ^2/4)]

Define Ω = sqrt(ω0^2 − ρ^2/4)  (underdamped if ω0 > ρ/2).</pre>
        </div>

        <p>
          Therefore the poles (zeros of <span style="font-family:var(--mono);">D(ω)</span>) are:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Pole locations</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-5" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-5">ω± = ±Ω − i ρ/2   (both have Im(ω±) = −ρ/2 < 0)</pre>
        </div>

        <p>
          Next, factor the denominator:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Factorization (useful for residues)</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-6" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-6">D(ω) = ω0^2 − ω^2 − i ρ ω = −(ω − ω+)(ω − ω−)

So α(ω) = 1/D(ω) = − 1 / [(ω − ω+)(ω − ω−)].</pre>
        </div>

        <h3>3.4.1 Compute residues of the full integrand</h3>
        <p>
          The integrand is <span style="font-family:var(--mono);">g(ω)=α(ω)e^{−iωt}</span>.
          At a simple pole <span style="font-family:var(--mono);">ω=ωp</span>, the residue is
          <span style="font-family:var(--mono);">Res[g,ωp] = lim_{ω→ωp} (ω−ωp)g(ω)</span>.
        </p>

        <p><strong>Residue at ω=ω+</strong></p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Residue at ω+</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-7" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-7">Res[g, ω+] = lim_{ω→ω+} (ω−ω+) [ − e^{−iωt} / ((ω−ω+)(ω−ω−)) ]
= − e^{−iω+ t} / (ω+ − ω−)
But ω+ − ω− = (Ω − iρ/2) − (−Ω − iρ/2) = 2Ω
So Res[g, ω+] = − e^{−iω+ t} / (2Ω)</pre>
        </div>

        <p><strong>Residue at ω=ω−</strong></p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Residue at ω−</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-8" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-8">Res[g, ω−] = lim_{ω→ω−} (ω−ω−) [ − e^{−iωt} / ((ω−ω+)(ω−ω−)) ]
= − e^{−iω− t} / (ω− − ω+)
But ω− − ω+ = −2Ω
So Res[g, ω−] = + e^{−iω− t} / (2Ω)</pre>
        </div>

        <h3>3.4.2 Apply the residue theorem with correct orientation</h3>
        <p>
          For <span style="font-family:var(--mono);">t&gt;0</span>, we close in the <strong>lower</strong> half-plane.
          That contour is <strong>clockwise</strong>, so:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Clockwise contour sign</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-9" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-9">∫_{−∞}^{∞} g(ω) dω = − 2π i · Σ Res[g, poles in lower half-plane]</pre>
        </div>

        <p>
          Therefore,
          <span style="font-family:var(--mono);">x(t) = (1/2π) ∫ g(ω) dω = (1/2π)(−2π i) ΣRes = − i ΣRes</span>.
          Summing both residues:
        </p>

        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Sum of residues and simplification</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-10" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-10">ΣRes = Res[g,ω+] + Res[g,ω−]
= (1/(2Ω)) (e^{−iω− t} − e^{−iω+ t})

Thus x(t) = −i * (1/(2Ω)) (e^{−iω− t} − e^{−iω+ t}).</pre>
        </div>

        <p>
          Now insert <span style="font-family:var(--mono);">ω± = ±Ω − iρ/2</span>:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Evaluate exponentials</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-11" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-11">e^{−iω± t} = e^{−i(±Ω − iρ/2)t}
= e^{∓ i Ω t} · e^{−ρ t/2}

So e^{−iω− t} − e^{−iω+ t}
= e^{−ρ t/2} (e^{+iΩ t} − e^{−iΩ t})
= e^{−ρ t/2} (2 i sin(Ω t)).</pre>
        </div>

        <p>
          Substitute back:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Final expression for t>0</span>
            <button class="btn copyBtn" data-copy-target="#eq-3-12" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-3-12">x(t) = −i * (1/(2Ω)) * [ e^{−ρ t/2} (2 i sin(Ω t)) ]
= e^{−ρ t/2} sin(Ω t) / Ω,   for t > 0.</pre>
        </div>

        <div class="callout final">
          <div class="tag">Final Answer (boxed)</div>
          <div class="eqBlock">
            <div class="eqTop">
              <span class="label">Causal impulse response</span>
              <button class="btn copyBtn" data-copy-target="#eq-3-final" type="button">Copy</button>
            </div>
            <pre class="eq" id="eq-3-final">Let Ω = sqrt(ω0^2 − ρ^2/4).

x(t) = 0,                          t < 0
x(t) = e^{−ρ t/2} sin(Ω t)/Ω,      t > 0

Equivalently:  x(t) = θ(t) e^{−ρ t/2} sin(Ω t)/Ω.</pre>
          </div>
        </div>

        <h3>3.5 Sanity checks</h3>

        <div class="callouts">
          <div class="callout">
            <div class="tag">Dimensional analysis</div>
            <p>
              <span style="font-family:var(--mono);">Ω</span> has units of s⁻¹, so <span style="font-family:var(--mono);">sin(Ωt)</span> is dimensionless and
              <span style="font-family:var(--mono);">1/Ω</span> has units of seconds.
              With the normalized ODE (mass absorbed), an impulse in <span style="font-family:var(--mono);">F(t)</span> produces a velocity jump of unit size,
              making <span style="font-family:var(--mono);">x(t)</span> scale like time—consistent with the <span style="font-family:var(--mono);">1/Ω</span> factor.
            </p>
          </div>
          <div class="callout">
            <div class="tag">Limiting cases</div>
            <ul>
              <li><strong>ρ → 0:</strong> <span style="font-family:var(--mono);">Ω→ω0</span> and <span style="font-family:var(--mono);">x(t)→θ(t) sin(ω0 t)/ω0</span>, the undamped impulse response.</li>
              <li><strong>t → ∞:</strong> exponential <span style="font-family:var(--mono);">e^{−ρ t/2}</span> drives <span style="font-family:var(--mono);">x(t)→0</span>, as expected for damping.</li>
              <li><strong>Causality:</strong> explicit <span style="font-family:var(--mono);">θ(t)</span> ensures no response for negative time.</li>
            </ul>
          </div>
        </div>

        <details>
          <summary>Optional note: overdamped / critically damped cases</summary>
          <p>
            If <span style="font-family:var(--mono);">ω0 ≤ ρ/2</span>, then <span style="font-family:var(--mono);">Ω</span> becomes imaginary or zero.
            The same contour method works; you simply get a sum of decaying exponentials (overdamped) or a polynomial times an exponential (critical damping).
            The poles still lie in the lower half-plane, so causality is unchanged.
          </p>
        </details>

        <a class="toplink" href="#top">Back to top</a>
      </article>

      <article id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>4.1 Re-interpret the final formula</h3>
        <p>
          The impulse response
          <span style="font-family:var(--mono);">x(t)=θ(t) e^{−ρ t/2} sin(Ω t)/Ω</span>
          has three distinct “controls”:
        </p>
        <ul>
          <li><strong>θ(t)</strong>: pure causality — response starts at <span style="font-family:var(--mono);">t=0</span>.</li>
          <li><strong>e^{−ρ t/2}</strong>: damping envelope — sets decay time <span style="font-family:var(--mono);">τ = 2/ρ</span>.</li>
          <li><strong>sin(Ω t)</strong>: oscillatory part — frequency is reduced from <span style="font-family:var(--mono);">ω0</span> to <span style="font-family:var(--mono);">Ω</span> by damping.</li>
          <li><strong>1/Ω</strong>: scale factor — faster oscillators (larger Ω) accumulate less displacement per unit impulse “kick.”</li>
        </ul>

        <h3>4.2 Parameter dependence (qualitative + quantitative)</h3>
        <ul>
          <li><strong>Increase ω0 (stiffer system):</strong> increases <span style="font-family:var(--mono);">Ω</span> ⇒ higher-frequency oscillations and smaller amplitude scale <span style="font-family:var(--mono);">1/Ω</span>.</li>
          <li><strong>Increase ρ (more damping):</strong> faster decay (<span style="font-family:var(--mono);">e^{−ρt/2}</span>) and reduced oscillation frequency (<span style="font-family:var(--mono);">Ω</span> decreases).</li>
          <li><strong>Approach critical damping (ρ → 2ω0):</strong> <span style="font-family:var(--mono);">Ω→0</span> and the sinusoid limit morphs into a non-oscillatory response (handled by taking the proper limit).</li>
        </ul>

        <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Solve the time-domain ODE with <span style="font-family:var(--mono);">F(t)=δ(t)</span>. Integrate the ODE across an infinitesimal interval around <span style="font-family:var(--mono);">t=0</span>:
        </p>
        <div class="eqBlock">
          <div class="eqTop">
            <span class="label">Jump condition intuition</span>
            <button class="btn copyBtn" data-copy-target="#eq-4-1" type="button">Copy</button>
          </div>
          <pre class="eq" id="eq-4-1">∫_{−ε}^{+ε} (d²x/dt²) dt + ρ∫_{−ε}^{+ε} (dx/dt) dt + ω0²∫_{−ε}^{+ε} x dt = ∫_{−ε}^{+ε} δ(t) dt

As ε→0:
(dx/dt)|_{0+} − (dx/dt)|_{0−} = 1</pre>
        </div>
        <p>
          With rest initial conditions <span style="font-family:var(--mono);">x(0−)=0</span>, <span style="font-family:var(--mono);">ẋ(0−)=0</span>, this gives <span style="font-family:var(--mono);">ẋ(0+)=1</span>.
          Then solve the homogeneous damped oscillator for <span style="font-family:var(--mono);">t&gt;0</span> with
          <span style="font-family:var(--mono);">x(0)=0</span>, <span style="font-family:var(--mono);">ẋ(0)=1</span>, yielding the same
          <span style="font-family:var(--mono);">e^{−ρt/2} sin(Ωt)/Ω</span>.
        </p>

        <h3>4.4 Concept check (self-test with answers)</h3>
        <ul>
          <li><strong>Q:</strong> Why does <span style="font-family:var(--mono);">t&lt;0</span> require closing in the upper half-plane? <br>
              <strong>A:</strong> Because <span style="font-family:var(--mono);">e^{−iωt}=e^{−iut}e^{vt}</span> decays for <span style="font-family:var(--mono);">v&gt;0</span> only when <span style="font-family:var(--mono);">t&lt;0</span>.</li>
          <li><strong>Q:</strong> What feature of <span style="font-family:var(--mono);">α(ω)</span> encodes stability? <br>
              <strong>A:</strong> Poles strictly in the lower half-plane (negative imaginary parts).</li>
          <li><strong>Q:</strong> What mathematical object is the impulse response? <br>
              <strong>A:</strong> The Green’s function of the linear differential operator <span style="font-family:var(--mono);">L = d²/dt² + ρ d/dt + ω0²</span>.</li>
          <li><strong>Q:</strong> What happens to the response if damping increases a lot? <br>
              <strong>A:</strong> Oscillations weaken and may disappear (overdamped), but causality remains via pole locations.</li>
        </ul>

        <a class="toplink" href="#top">Back to top</a>
      </article>

      <article id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>

        <p>
          A plot is useful here because the final result is a time waveform (a ring-down). We keep the solution symbolic,
          but visualize one <em>example</em> to connect formula ↔ intuition.
        </p>

        <figure>
          <canvas id="plot" style="width:100%; height:320px; display:block;"></canvas>
          <figcaption>
            <strong>Impulse response example (not part of the symbolic result):</strong>
            plotted is <span style="font-family:var(--mono);">x(t)=θ(t)e^{−ρt/2}sin(Ωt)/Ω</span> with example values
            <span style="font-family:var(--mono);">ω0=1.0 rad/s</span>, <span style="font-family:var(--mono);">ρ=0.4 s⁻1</span>
            (so <span style="font-family:var(--mono);">Ω≈0.9799 rad/s</span>). The response starts at <span style="font-family:var(--mono);">t=0</span> and decays exponentially.
          </figcaption>
        </figure>

        <h3>What to notice</h3>
        <ul>
          <li><strong>Start time:</strong> the curve is zero for <span style="font-family:var(--mono);">t&lt;0</span> (causality).</li>
          <li><strong>Envelope:</strong> peaks shrink approximately like <span style="font-family:var(--mono);">e^{−ρt/2}</span>.</li>
          <li><strong>Oscillation period:</strong> set by <span style="font-family:var(--mono);">Ω</span>, slightly less than <span style="font-family:var(--mono);">ω0</span> when damping is present.</li>
          <li><strong>Scale:</strong> amplitude roughly scales like <span style="font-family:var(--mono);">1/Ω</span> for fixed impulse size.</li>
        </ul>

        <a class="toplink" href="#top">Back to top</a>
      </article>

    </div>
  </main>

  <footer>
    <p>
      Built as a self-contained learning article: contour integration, causality/KK intuition, and the impulse response of a damped oscillator,
      with applied engineering context. You can paste this HTML directly into a website.
    </p>
  </footer>

  <script>
    // --- TOC collapse ---
    const tocBtn = document.getElementById('collapseTocBtn');
    const tocBody = document.getElementById('tocBody');
    tocBtn.addEventListener('click', () => {
      const expanded = tocBtn.getAttribute('aria-expanded') === 'true';
      tocBtn.setAttribute('aria-expanded', String(!expanded));
      tocBody.style.display = expanded ? 'none' : 'block';
      tocBtn.textContent = expanded ? 'Expand' : 'Collapse';
    });

    // --- Smooth scroll ---
    document.querySelectorAll('nav a[href^="#"]').forEach(a=>{
      a.addEventListener('click', (e)=>{
        const id = a.getAttribute('href');
        const el = document.querySelector(id);
        if(el){
          e.preventDefault();
          el.scrollIntoView({behavior:'smooth', block:'start'});
          history.replaceState(null, '', id);
        }
      });
    });

    // --- Copy buttons for equations/final answers ---
    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(err){
        // Fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        let ok = false;
        try{ ok = document.execCommand('copy'); }catch(e){ ok=false; }
        document.body.removeChild(ta);
        return ok;
      }
    }

    document.querySelectorAll('.copyBtn').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const sel = btn.getAttribute('data-copy-target');
        const target = document.querySelector(sel);
        if(!target) return;
        const ok = await copyText(target.innerText.trim());
        const old = btn.textContent;
        btn.textContent = ok ? 'Copied ✓' : 'Copy failed';
        setTimeout(()=>btn.textContent = old, 900);
      });
    });

    // --- Static canvas plot (single plot, responsive, high-DPI) ---
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    function draw(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const cssW = canvas.clientWidth;
      const cssH = canvas.clientHeight;
      canvas.width = Math.round(cssW * dpr);
      canvas.height = Math.round(cssH * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);

      // Plot area
      const padL = 56, padR = 18, padT = 26, padB = 44;
      const W = cssW, H = cssH;
      const x0 = padL, y0 = padT, x1 = W - padR, y1 = H - padB;
      const pw = x1 - x0, ph = y1 - y0;

      // Example parameters (clearly labeled in caption; not part of symbolic answer)
      const w0 = 1.0;          // rad/s
      const rho = 0.4;         // 1/s
      const Om = Math.sqrt(Math.max(0, w0*w0 - (rho*rho)/4)); // underdamped

      // Domain
      const tMin = -1.0, tMax = 14.0; // s
      // Range: estimate using envelope 1/Ω with some margin
      const amp = (Om>0 ? 1/Om : 2/(rho+1e-9));
      const yMax = 1.15*amp;
      const yMin = -1.15*amp;

      // Helpers
      const tx = t => x0 + (t - tMin) * pw / (tMax - tMin);
      const ty = y => y1 - (y - yMin) * ph / (yMax - yMin);

      // Background
      ctx.clearRect(0,0,W,H);
      ctx.fillStyle = 'rgba(255,255,255,0.02)';
      ctx.fillRect(x0,y0,pw,ph);

      // Gridlines
      ctx.strokeStyle = 'rgba(255,255,255,0.10)';
      ctx.lineWidth = 1;

      // x ticks
      const xTicks = 8;
      for(let i=0;i<=xTicks;i++){
        const t = tMin + (tMax-tMin)*i/xTicks;
        const X = tx(t);
        ctx.beginPath();
        ctx.moveTo(X,y0);
        ctx.lineTo(X,y1);
        ctx.stroke();
      }

      // y ticks
      const yTicks = 6;
      for(let i=0;i<=yTicks;i++){
        const y = yMin + (yMax-yMin)*i/yTicks;
        const Y = ty(y);
        ctx.beginPath();
        ctx.moveTo(x0,Y);
        ctx.lineTo(x1,Y);
        ctx.stroke();
      }

      // Axes
      ctx.strokeStyle = 'rgba(255,255,255,0.35)';
      ctx.lineWidth = 1.5;
      // x-axis at y=0
      const Y0 = ty(0);
      ctx.beginPath();
      ctx.moveTo(x0,Y0);
      ctx.lineTo(x1,Y0);
      ctx.stroke();

      // y-axis at t=0
      const X0 = tx(0);
      ctx.beginPath();
      ctx.moveTo(X0,y0);
      ctx.lineTo(X0,y1);
      ctx.stroke();

      // Labels & title
      ctx.fillStyle = 'rgba(233,238,252,0.95)';
      ctx.font = '600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      ctx.fillText('Impulse response example: x(t) for F(t)=δ(t)', x0, 18);

      ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      ctx.fillStyle = 'rgba(184,195,234,0.95)';
      ctx.fillText('t (s)', x0 + pw/2 - 12, H - 14);
      // y label
      ctx.save();
      ctx.translate(16, y0 + ph/2 + 16);
      ctx.rotate(-Math.PI/2);
      ctx.fillText('x(t) (arb. units)', 0, 0);
      ctx.restore();

      // Tick labels
      ctx.fillStyle = 'rgba(184,195,234,0.90)';
      ctx.font = '11px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace';

      // x tick labels
      for(let i=0;i<=xTicks;i++){
        const t = tMin + (tMax-tMin)*i/xTicks;
        const X = tx(t);
        ctx.fillText(t.toFixed(1), X-10, y1+18);
        // tick marks
        ctx.strokeStyle = 'rgba(255,255,255,0.35)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(X,y1);
        ctx.lineTo(X,y1+6);
        ctx.stroke();
      }

      // y tick labels
      for(let i=0;i<=yTicks;i++){
        const y = yMin + (yMax-yMin)*i/yTicks;
        const Y = ty(y);
        ctx.fillText(y.toFixed(2), x0-48, Y+4);
        ctx.strokeStyle = 'rgba(255,255,255,0.35)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(x0-6,Y);
        ctx.lineTo(x0,Y);
        ctx.stroke();
      }

      // Data curve: x(t)=θ(t) e^{-ρt/2} sin(Ωt)/Ω
      ctx.strokeStyle = 'rgba(124,240,214,0.95)';
      ctx.lineWidth = 2;
      ctx.beginPath();
      const N = 1200;
      for(let i=0;i<=N;i++){
        const t = tMin + (tMax-tMin)*i/N;
        let x = 0;
        if(t>0){
          if(Om>0){
            x = Math.exp(-rho*t/2) * Math.sin(Om*t) / Om;
          }else{
            // critical/overdamped fallback (not expected here); keep smooth
            x = t*Math.exp(-rho*t/2);
          }
        }
        const X = tx(t), Y = ty(x);
        if(i===0) ctx.moveTo(X,Y); else ctx.lineTo(X,Y);
      }
      ctx.stroke();

      // Legend (simple)
      const lx = x0 + 10, ly = y0 + 10;
      ctx.fillStyle = 'rgba(18,28,58,0.75)';
      ctx.strokeStyle = 'rgba(255,255,255,0.16)';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.roundRect(lx, ly, 235, 44, 10);
      ctx.fill();
      ctx.stroke();

      ctx.strokeStyle = 'rgba(124,240,214,0.95)';
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(lx+12, ly+22);
      ctx.lineTo(lx+42, ly+22);
      ctx.stroke();

      ctx.fillStyle = 'rgba(233,238,252,0.95)';
      ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      ctx.fillText('x(t) = θ(t)e^{−ρt/2} sin(Ωt)/Ω', lx+50, ly+26);
    }

    // Canvas roundRect polyfill-ish for older browsers
    if(!CanvasRenderingContext2D.prototype.roundRect){
      CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
        r = Math.min(r, w/2, h/2);
        this.beginPath();
        this.moveTo(x+r, y);
        this.arcTo(x+w, y, x+w, y+h, r);
        this.arcTo(x+w, y+h, x, y+h, r);
        this.arcTo(x, y+h, x, y, r);
        this.arcTo(x, y, x+w, y, r);
        this.closePath();
        return this;
      };
    }

    const ro = new ResizeObserver(()=>draw());
    ro.observe(canvas);
    window.addEventListener('load', draw, {once:true});
  </script>
</body>
</html>