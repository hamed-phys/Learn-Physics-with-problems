<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Dissipation Sum Rule for Oscillator Strengths</title>
  <style>
    :root{
      --bg:#0b0f14;
      --card:#111826;
      --card2:#0f1622;
      --text:#e7eef8;
      --muted:#a8b3c7;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --danger:#fb7185;
      --border:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(125,211,252,.12), transparent 60%),
        radial-gradient(900px 600px at 90% 10%, rgba(167,139,250,.12), transparent 55%),
        linear-gradient(180deg, #070a0f, var(--bg));
      color:var(--text);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      position:relative;
      padding:2.2rem 1rem 1.2rem;
      border-bottom:1px solid var(--border);
      overflow:hidden;
    }
    header .wrap{
      max-width:1200px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:1rem;
      align-items:end;
    }
    h1{
      margin:0;
      font-size:clamp(1.6rem, 2.4vw + 1rem, 2.6rem);
      letter-spacing:-0.02em;
    }
    .subtitle{
      margin:.4rem 0 0;
      color:var(--muted);
      max-width:70ch;
    }
    .badgeRow{
      display:flex; flex-wrap:wrap; gap:.5rem; justify-content:flex-end;
    }
    .badge{
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      padding:.35rem .6rem;
      border-radius:999px;
      font-size:.85rem;
      color:var(--muted);
      backdrop-filter: blur(6px);
    }

    main{
      max-width:1200px;
      margin:0 auto;
      padding:1.2rem 1rem 4rem;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:1.2rem;
      align-items:start;
    }

    nav#toc{
      position:sticky;
      top:1rem;
      align-self:start;
      border:1px solid var(--border);
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border-radius:16px;
      padding:1rem;
      box-shadow: var(--shadow);
      max-height: calc(100vh - 2rem);
      overflow:auto;
    }
    #toc h2{
      font-size:1rem;
      margin:0 0 .6rem;
      color:var(--text);
      letter-spacing:.02em;
    }
    #toc a{
      display:block;
      padding:.35rem .45rem;
      border-radius:10px;
      color:var(--muted);
      font-size:.93rem;
    }
    #toc a:hover{background:rgba(125,211,252,.10); color:var(--text); text-decoration:none}
    #toc a.active{background:rgba(167,139,250,.14); color:var(--text); border:1px solid rgba(167,139,250,.25)}
    #toc .mini{
      color:var(--muted);
      font-size:.84rem;
      margin:.6rem 0 0;
      padding-top:.6rem;
      border-top:1px dashed rgba(255,255,255,.16);
    }

    article{
      border:1px solid var(--border);
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border-radius:18px;
      box-shadow: var(--shadow);
      padding:1.1rem;
      overflow:hidden;
    }

    section{
      padding:1rem 0;
      border-top:1px solid rgba(255,255,255,.08);
    }
    section:first-of-type{border-top:none}
    h2{
      margin:.2rem 0 .6rem;
      font-size:clamp(1.2rem, 1.2vw + .9rem, 1.55rem);
      letter-spacing:-0.01em;
    }
    h3{
      margin:1rem 0 .5rem;
      font-size:1.05rem;
      color:var(--text);
    }
    p{margin:.55rem 0; color:var(--text)}
    ul,ol{margin:.45rem 0 .75rem 1.1rem; color:var(--text)}
    li{margin:.25rem 0}
    .muted{color:var(--muted)}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:.9rem;
    }
    @media (max-width: 980px){
      main{grid-template-columns:1fr}
      nav#toc{position:relative; top:auto; max-height:none}
      header .wrap{grid-template-columns:1fr}
      .badgeRow{justify-content:flex-start}
      .grid2{grid-template-columns:1fr}
    }

    .card{
      border:1px solid var(--border);
      background:rgba(0,0,0,.18);
      border-radius:14px;
      padding:.9rem;
    }
    .callout{
      border-left:4px solid var(--accent);
      background:rgba(125,211,252,.08);
      padding:.9rem;
      border-radius:14px;
    }
    .callout.warn{border-left-color: var(--warn); background:rgba(251,191,36,.10)}
    .callout.ok{border-left-color: var(--ok); background:rgba(52,211,153,.10)}
    .callout.danger{border-left-color: var(--danger); background:rgba(251,113,133,.10)}
    .kicker{
      font-size:.85rem;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.10em;
      margin-bottom:.2rem;
    }

    .eqBlock{
      position:relative;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.25);
      border-radius:14px;
      padding:.9rem .9rem .8rem;
      overflow:auto;
    }
    pre, code{
      font-family: var(--mono);
      font-size:.95rem;
      line-height:1.5;
      margin:0;
      white-space:pre;
      color:#eaf2ff;
    }
    .copyBtn{
      position:absolute;
      top:.55rem;
      right:.55rem;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(255,255,255,.06);
      color:var(--text);
      font-size:.82rem;
      padding:.35rem .55rem;
      border-radius:10px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease;
      user-select:none;
    }
    .copyBtn:hover{background:rgba(255,255,255,.10)}
    .copyBtn:active{transform: scale(.98)}
    .pillRow{display:flex; flex-wrap:wrap; gap:.5rem; margin:.4rem 0 0}
    .pill{
      font-family:var(--mono);
      font-size:.82rem;
      padding:.22rem .5rem;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.18);
      color:var(--muted);
    }

    details{
      border:1px dashed rgba(255,255,255,.18);
      border-radius:14px;
      padding:.75rem .85rem;
      background:rgba(0,0,0,.12);
      margin:.8rem 0;
    }
    summary{
      cursor:pointer;
      color:var(--text);
      font-weight:600;
    }
    summary::marker{color:var(--accent)}

    .backTop{
      display:inline-flex;
      gap:.5rem;
      align-items:center;
      margin-top:1rem;
      padding:.4rem .6rem;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.05);
      color:var(--text);
      text-decoration:none;
    }
    .backTop:hover{background:rgba(255,255,255,.09); text-decoration:none}

    footer{
      max-width:1200px;
      margin:0 auto;
      padding:1.5rem 1rem 2.2rem;
      color:var(--muted);
      border-top:1px solid var(--border);
    }

    /* Subtle micro-animation */
    @media (prefers-reduced-motion: no-preference){
      article{animation: fadeIn .35s ease-out both}
      @keyframes fadeIn{
        from{opacity:.0; transform: translateY(8px)}
        to{opacity:1; transform: translateY(0)}
      }
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, nav#toc, .copyBtn, .backTop{display:none !important}
      article{box-shadow:none; border:1px solid #ccc; background:#fff}
      .eqBlock{background:#fff; border:1px solid #ddd}
      pre, code{color:#000}
      section{page-break-inside:avoid}
      h2{page-break-after:avoid}
      a{color:#000; text-decoration:underline}
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap">
      <div>
        <h1>Dissipation Sum Rule (Oscillator-Strength Sum Rule)</h1>
        <p class="subtitle">
          Derive a fundamental constraint linking the <em>sum of oscillator strengths</em> to an integral over the
          <em>absorptive (dissipative)</em> part of the polarizability using high-frequency asymptotics and
          Kramers–Kronig causality.
        </p>
      </div>
      <div class="badgeRow" aria-label="context badges">
        <span class="badge">Linear response</span>
        <span class="badge">Causality</span>
        <span class="badge">Kramers–Kronig</span>
        <span class="badge">Applied spectroscopy</span>
      </div>
    </div>
  </header>

  <main>
    <nav id="toc" aria-label="Table of contents">
      <h2>On this page</h2>
      <a href="#quick-summary">Quick Summary</a>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry & Applied Physics Perspective</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy & Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Optional Plot Guide</a>
      <div class="mini">
        Tip: Use the copy buttons on equation boxes to copy plain text.
      </div>
    </nav>

    <article>
      <!-- Quick Summary -->
      <section id="quick-summary">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this is:</strong> Prove a <em>sum rule</em> connecting oscillator strengths <code>f_j</code> to dissipation encoded in <code>α''(ω)</code>.</li>
          <li><strong>Key physics idea:</strong> <em>Causality</em> of the response forces <em>Kramers–Kronig</em> relations between <code>α'(ω)</code> and <code>α''(ω)</code>.</li>
          <li><strong>Governing structure:</strong> Complex polarizability <code>α(ω) = α'(ω) + i α''(ω)</code> with KK:
            <code>α'(ω) = (2/π) P ∫_0^∞ [s α''(s)]/(s^2 - ω^2) ds</code>.</li>
          <li><strong>High-frequency asymptotics:</strong> As <code>ω → ∞</code>, <code>α'(ω) ~ - (Σ f_j)/ω^2</code> from the oscillator model.</li>
          <li><strong>Match coefficients:</strong> Expanding KK for large <code>ω</code> gives <code>α'(ω) ~ - (2/π)(1/ω^2) ∫_0^∞ s α''(s) ds</code>.</li>
          <li><strong>Result (symbolic):</strong> <strong>Σ f_j = (2/π) ∫_0^∞ s α''(s) ds</strong>.</li>
          <li><strong>Physical meaning:</strong> Total “spectral weight” of absorption is conserved; you can’t arbitrarily change loss at one frequency without compensating elsewhere.</li>
          <li><strong>Industrial relevance:</strong> Constrains optical/material models used in ellipsometry, dielectric fitting, RF/microwave permittivity extraction, and photonics CAD.</li>
        </ul>
      </section>

      <!-- PART 0 -->
      <section id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="card">
            <div class="kicker">Core definitions</div>
            <ul>
              <li><strong>Polarizability</strong> <code>α(ω)</code> (SI: <code>C·m / (V/m) = C·m^2/V</code>): relates induced dipole moment to electric field.</li>
              <li><strong>Linear response</strong>: <code>p(ω) = α(ω) E(ω)</code> for a (small) driving field.</li>
              <li><strong>Complex response</strong>: <code>α(ω)=α'(ω)+ i α''(ω)</code>.
                <ul>
                  <li><code>α'(ω)</code> = dispersive (in-phase) response.</li>
                  <li><code>α''(ω)</code> = absorptive/dissipative (out-of-phase) response; <code>α''(ω) ≥ 0</code> for passive media at <code>ω>0</code>.</li>
                </ul>
              </li>
              <li><strong>Oscillator strengths</strong> <code>f_j</code> (dimensionless): weights of resonant transitions in an oscillator model of <code>α(ω)</code>.</li>
            </ul>
            <div class="pillRow">
              <span class="pill">α(ω)=α'(ω)+iα''(ω)</span>
              <span class="pill">passivity ⇒ α''(ω) ≥ 0</span>
            </div>
          </div>

          <div class="card">
            <div class="kicker">Physical meaning</div>
            <p>
              Think of <code>α(ω)</code> as the “frequency-dependent compliance” of charge motion:
              low frequencies often let charges follow the field (large response), while high frequencies
              make them “too heavy to follow” (response decays).
            </p>
            <p>
              Dissipation appears when microscopic degrees of freedom (electrons, phonons, defects)
              absorb energy from the field. In Fourier space, dissipation is encoded by a nonzero
              <code>α''(ω)</code>.
            </p>
            <p class="muted">
              The sum rule we derive is a quantitative statement that the total absorption “budget”
              is fixed by fundamental constraints (causality + high-frequency behavior).
            </p>
          </div>
        </div>

        <h3>Mathematical model (rigorous setup)</h3>
        <div class="callout">
          <div class="kicker">Model + assumptions</div>
          <ul>
            <li><strong>Time-domain linear response (causal):</strong> there exists a real-valued response kernel <code>χ(t)</code> such that
              <code>p(t) = ∫_{-∞}^{∞} χ(t - t') E(t') dt'</code> with <code>χ(t)=0</code> for <code>t&lt;0</code> (causality).</li>
            <li><strong>Frequency domain:</strong> <code>α(ω) = ∫_0^∞ χ(t) e^{iωt} dt</code> (Fourier/Laplace-type transform).
              This analyticity in the upper half-plane is the key mathematical ingredient behind Kramers–Kronig.</li>
            <li><strong>Domain:</strong> angular frequency <code>ω ∈ ℝ</code>; we focus on <code>ω&gt;0</code> for physical spectra.</li>
            <li><strong>Linearity:</strong> superposition holds; enables decomposition into oscillator contributions and integral transforms.</li>
            <li><strong>Passivity:</strong> no net energy generation; implies positivity properties (e.g., <code>α''(ω) ≥ 0</code> for <code>ω&gt;0</code> under standard conventions).</li>
          </ul>
        </div>

        <h3>Key law: Kramers–Kronig (Hilbert transform pair)</h3>
        <p>
          Because <code>α(ω)</code> is analytic in the upper half complex <code>ω</code>-plane (from causality) and decays sufficiently at infinity,
          its real and imaginary parts are not independent; they obey Kramers–Kronig relations.
        </p>

        <div class="eqBlock" role="group" aria-label="Key equations: Kramers–Kronig for polarizability">
          <button class="copyBtn" data-copy="kk">Copy</button>
<pre id="kk">Kramers–Kronig (for a causal α(ω), ω>0):
α'(ω) = (2/π) P ∫_0^∞ [ s α''(s) ] / (s^2 - ω^2) ds

Equivalent partner relation:
α''(ω) = -(2ω/π) P ∫_0^∞ α'(s) / (s^2 - ω^2) ds</pre>
        </div>

        <h3>Common models/approximations in this topic</h3>
        <ul>
          <li><strong>Multi-oscillator (Lorentz) model:</strong> represent matter as a sum of damped harmonic oscillators. Works well for optical phonons, interband transitions, resonances in dielectrics/metals.</li>
          <li><strong>High-frequency expansion:</strong> assume <code>ω</code> much larger than all resonance frequencies; expand in powers of <code>1/ω</code>.</li>
          <li><strong>Neglect of magnetic coupling:</strong> treat electric dipole response only (valid when electric dipole dominates).</li>
        </ul>

        <h3>Mini intuition examples (conceptual)</h3>
        <ol>
          <li><strong>Single resonance:</strong> absorption <code>α''(ω)</code> peaks near the resonance; dispersion <code>α'(ω)</code> flips sign across it (normal dispersion).</li>
          <li><strong>Shift absorption upward:</strong> if you increase loss at one band, KK forces a corresponding change in dispersion across frequencies.</li>
          <li><strong>High-frequency inertia:</strong> at very large <code>ω</code>, charges cannot accelerate fast enough, so response typically decays like <code>1/ω^2</code> (for bound charges).</li>
        </ol>

        <h3>What to watch for (pitfalls)</h3>
        <ul>
          <li><strong>Sign conventions:</strong> whether you use <code>e^{-iωt}</code> or <code>e^{+iωt}</code> changes signs in KK formulas and in what “positive absorption” means. Stay consistent.</li>
          <li><strong>Principal value:</strong> the KK integral uses <code>P</code> because of a pole at <code>s=ω</code>.</li>
          <li><strong>Convergence:</strong> the large-<code>ω</code> expansion assumes the integral moments like <code>∫ s α''(s) ds</code> converge (physically: finite total spectral weight).</li>
        </ul>

        <div class="callout ok">
          <div class="kicker">Math Insight</div>
          <p>
            The KK relation is a <strong>Hilbert transform</strong> constraint: analyticity in the upper half-plane implies that
            <code>α'(ω)</code> is essentially the Hilbert transform of <code>α''(ω)</code>. The “sum rule” we derive is a <strong>moment constraint</strong>:
            it equates a coefficient in the <code>1/ω</code>-asymptotic series to an integral moment (first moment) of <code>α''</code>.
          </p>
        </div>

        <a class="backTop" href="#top" aria-label="Back to top">↑ Back to top</a>
      </section>

      <!-- PART 0B -->
      <section id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <div class="grid2">
          <div class="card">
            <div class="kicker">Where this shows up (3+ areas)</div>
            <ul>
              <li><strong>Optical materials & coatings:</strong> fitting <code>n(ω)</code>, <code>k(ω)</code>, dielectric functions with Lorentz/Drude–Lorentz models; KK-consistent parameter extraction.</li>
              <li><strong>Semiconductor & photonics design:</strong> dispersion engineering in waveguides/metasurfaces; absorption constraints affect loss budgets and device Q-factor.</li>
              <li><strong>RF/microwave dielectrics:</strong> permittivity extraction and Debye/Lorentz relaxations; sum rules help validate fitted models against physical realizability.</li>
              <li><strong>Battery/solid-state ionics spectroscopy:</strong> impedance and dielectric spectroscopy; KK checks catch non-physical data (e.g., drift, contact artifacts).</li>
            </ul>
          </div>
          <div class="card">
            <div class="kicker">Why engineers care</div>
            <ul>
              <li><strong>Reliability & safety:</strong> non-physical fits can cause wrong thermal-loss predictions (overheating risk).</li>
              <li><strong>Performance:</strong> dispersion affects phase matching, pulse broadening, resonance tuning, antenna bandwidth.</li>
              <li><strong>Cost & manufacturability:</strong> fewer parameters and KK-consistent models reduce overfitting and improve extrapolation across temperature/batch variation.</li>
            </ul>
          </div>
        </div>

        <h3>Typical measurement/validation methods</h3>
        <ul>
          <li><strong>Ellipsometry / spectroscopy:</strong> measure reflection/transmission to infer <code>α''</code>-related loss (or <code>k(ω)</code>) and use KK to obtain consistent dispersion.</li>
          <li><strong>Time-domain THz spectroscopy:</strong> retrieves complex response; KK acts as a consistency check on data processing.</li>
          <li><strong>Dielectric spectroscopy / impedance:</strong> KK transforms verify causality and passivity of measured permittivity/conductivity models.</li>
        </ul>

        <h3>Design trade-offs & real constraints</h3>
        <div class="callout warn">
          <div class="kicker">Reality check</div>
          <ul>
            <li>Real materials have multiple overlapping resonances, disorder broadening, and temperature dependence; the “oscillator list” becomes an effective model.</li>
            <li>Finite measurement bandwidth means integrals like <code>∫_0^∞</code> must be approximated; engineers use tails (high/low-frequency extrapolation) constrained by physics.</li>
            <li>Manufacturing tolerances shift resonance frequencies; sum rules help ensure refits remain physically plausible.</li>
          </ul>
        </div>

        <p class="muted">
          <strong>From lab to product:</strong> In practice you fit a KK-consistent oscillator model to measured spectra, then enforce
          sum rules as soft/hard constraints in optimization so the model stays passive/causal when used in simulation workflows.
        </p>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 1 -->
      <section id="part1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>Restating the problem</h3>
        <p>
          You are told that by comparing the high-frequency (<code>ω → ∞</code>) behavior of the real part of the polarizability
          <code>α'(ω)</code> obtained from two expressions—(i) an oscillator-strength representation (from “(9)”) and (ii) a Kramers–Kronig
          integral representation (from “(11a)”)—you should show that the oscillator strengths obey:
        </p>

        <div class="eqBlock" role="group" aria-label="Target sum rule">
          <button class="copyBtn" data-copy="target">Copy</button>
<pre id="target">Target (Dissipation sum rule):
Σ_j f_j = (2/π) ∫_0^∞ s α''(s) ds</pre>
        </div>

        <h3>Given quantities</h3>
        <ul>
          <li><code>α(ω) = α'(ω) + i α''(ω)</code>: complex polarizability (frequency response function).</li>
          <li><code>f_j</code>: oscillator strengths (dimensionless) appearing in an oscillator expansion of <code>α(ω)</code>.</li>
          <li>Two formulas for <code>α'(ω)</code> (referenced as (9) and (11a)) that must agree asymptotically as <code>ω → ∞</code>.</li>
        </ul>

        <h3>Unknowns / what must be proved</h3>
        <ul>
          <li>Prove the stated identity relating <code>Σ f_j</code> to an integral moment of <code>α''</code>.</li>
        </ul>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>Linearity:</strong> allows <code>α(ω)</code> to be decomposed into additive oscillator contributions.</li>
          <li><strong>Causality (χ(t)=0 for t&lt;0):</strong> implies analyticity of <code>α(ω)</code> in the upper half-plane and thus Kramers–Kronig relations.</li>
          <li><strong>High-frequency expansion:</strong> matching leading powers of <code>1/ω</code> between two correct representations yields sum rules.</li>
        </ul>

        <div class="callout">
          <div class="kicker">Assumptions (explicit)</div>
          <ul>
            <li><strong>Passive, causal, linear medium</strong> so KK applies.</li>
            <li><strong>Bound-charge (Lorentz-type) high-frequency decay:</strong> <code>α'(ω) = O(1/ω^2)</code> as <code>ω→∞</code>.</li>
            <li><strong>Moment convergence:</strong> <code>∫_0^∞ s α''(s) ds</code> is finite (physically: finite total absorption spectral weight).</li>
          </ul>
        </div>

        <h3>Possible approaches (compare 2–3)</h3>
        <ol>
          <li><strong>Asymptotic matching (best here):</strong> Expand KK formula for large <code>ω</code> and match to oscillator-model expansion of <code>α'(ω)</code>.
            <span class="muted">Pros: direct, minimal machinery. Cons: requires comfort with series expansion under the integral.</span></li>
          <li><strong>Contour integration:</strong> Use analytic continuation of <code>α(ω)</code> and evaluate contour integrals of <code>ω^2 α(ω)</code> to extract moments.
            <span class="muted">Pros: elegant; Cons: heavier complex analysis.</span></li>
          <li><strong>Energy-weighted sum rule from time domain:</strong> Relate moments of <code>α''</code> to derivatives of <code>χ(t)</code> at <code>t=0</code>.
            <span class="muted">Pros: insightful; Cons: requires additional regularity assumptions about <code>χ(t)</code>.</span></li>
        </ol>

        <p><strong>Choice:</strong> We use <strong>asymptotic matching</strong> because the prompt explicitly mentions comparing the <code>ω→∞</code> limits of two formulas.</p>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 2 -->
      <section id="part2">
        <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

        <ol>
          <li><strong>Write KK for</strong> <code>α'(ω)</code>.
            <span class="muted">Tool: Kramers–Kronig integral with principal value.</span></li>
          <li><strong>Expand the kernel</strong> <code>1/(s^2-ω^2)</code> for large <code>ω</code>.
            <span class="muted">Tool: geometric series in <code>(s/ω)^2</code>.</span></li>
          <li><strong>Keep the leading term</strong> in <code>1/ω^2</code>.
            <span class="muted">Meaning: leading inertial/high-frequency response.</span></li>
          <li><strong>Extract the coefficient</strong> multiplying <code>-1/ω^2</code> from KK:
            it becomes <code>(2/π)∫_0^∞ s α''(s) ds</code>.</li>
          <li><strong>Write the oscillator-model high-ω limit</strong> for <code>α'(ω)</code>:
            <code>α'(ω) ~ -(Σ f_j)/ω^2</code> (as given by the referenced formula (9)).</li>
          <li><strong>Match coefficients</strong> of <code>-1/ω^2</code> between the two representations.</li>
          <li><strong>Conclude the sum rule</strong> and perform quick sanity checks (dimensions, positivity, physical meaning).</li>
        </ol>

        <div class="callout danger">
          <div class="kicker">Common mistakes</div>
          <ul>
            <li>Forgetting the minus sign from <code>1/(s^2-ω^2) = -1/ω^2 · 1/(1-(s/ω)^2)</code>.</li>
            <li>Dropping the factor <code>s</code> in the KK integrand (<code>s α''(s)</code> is essential).</li>
            <li>Not stating the convergence condition needed to justify exchanging expansion and integration.</li>
            <li>Mixing sign conventions for Fourier transforms; KK formulas depend on them.</li>
          </ul>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 3 -->
      <section id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation (before calculating)</h3>
        <p>
          At very high driving frequency <code>ω</code>, bound charges cannot follow the rapid oscillations,
          so the polarizability must fall off. For Lorentz-type bound motion, the leading decay is typically
          <code>α(ω) ~ 1/ω^2</code>. Therefore, the coefficient of <code>1/ω^2</code> is a “global” measure of how much
          oscillating charge is available—precisely what oscillator strengths quantify. KK then tells us that
          this same coefficient must be encoded in the integrated absorption <code>α''</code>.
        </p>

        <h3>Step 1: Start from the Kramers–Kronig relation for α'(ω)</h3>
        <p>
          For a causal linear response function <code>α(ω)</code> with appropriate decay, we have (for <code>ω&gt;0</code>):
        </p>

        <div class="eqBlock" role="group" aria-label="KK relation used in the derivation">
          <button class="copyBtn" data-copy="kk2">Copy</button>
<pre id="kk2">α'(ω) = (2/π) P ∫_0^∞ [ s α''(s) ] / (s^2 - ω^2) ds</pre>
        </div>

        <p class="muted">
          Why valid: this is a standard consequence of analyticity (causality) plus boundedness at infinity,
          derived via contour integration (Cauchy integral formula) and taking real parts.
        </p>

        <h3>Step 2: Expand the kernel for large ω</h3>
        <p>
          For fixed <code>s</code> and large <code>ω</code>, rewrite the denominator:
        </p>

        <div class="eqBlock" role="group" aria-label="Kernel expansion">
          <button class="copyBtn" data-copy="kern">Copy</button>
<pre id="kern">1/(s^2 - ω^2)
= -1/ω^2 · 1/(1 - (s/ω)^2)
= -1/ω^2 · [ 1 + (s/ω)^2 + (s/ω)^4 + ... ]   (|s/ω|<1)</pre>
        </div>

        <p>
          <strong>Why this step is legitimate (mathematical justification):</strong>
          The expansion is a geometric series in <code>(s/ω)^2</code>. For the asymptotic <code>ω→∞</code> limit,
          the leading term <code>-1/ω^2</code> is valid as an asymptotic approximation. To rigorously exchange
          “expand then integrate,” one typically assumes sufficient decay so that the moment
          <code>∫_0^∞ s α''(s) ds</code> converges and dominates the leading behavior. Physically, real materials
          have finite spectral weight so this condition holds in standard models.
        </p>

        <details>
          <summary>Optional rigorous note (asymptotic expansion under the integral)</summary>
          <p class="muted">
            A common sufficient condition is that <code>s α''(s)</code> is integrable on <code>(0,∞)</code> and that
            the remainder after truncating the series is uniformly dominated by an integrable function for
            large <code>ω</code>. In practice, one uses known high-frequency tails (from microscopic theory) to ensure
            moment finiteness.
          </p>
        </details>

        <h3>Step 3: Insert the expansion into KK and keep the leading term</h3>
        <p>
          Substitute the first term of the expansion into KK:
        </p>

        <div class="eqBlock" role="group" aria-label="Leading-order KK asymptotic">
          <button class="copyBtn" data-copy="lead">Copy</button>
<pre id="lead">α'(ω)
= (2/π) P ∫_0^∞ s α''(s) · [1/(s^2 - ω^2)] ds
≈ (2/π) ∫_0^∞ s α''(s) · [ -1/ω^2 ] ds     (ω→∞)

So:
α'(ω) ≈ - (2/π) (1/ω^2) ∫_0^∞ s α''(s) ds   (leading term)</pre>
        </div>

        <p>
          <strong>Why principal value disappears at leading order:</strong>
          The leading approximation replaces <code>1/(s^2-ω^2)</code> by <code>-1/ω^2</code>, which has no pole in <code>s</code>,
          so the principal value is no longer needed at this order.
        </p>

        <h3>Step 4: Write the oscillator-model high-frequency limit</h3>
        <p>
          The referenced expression “(9)” is an oscillator-strength representation of polarizability. A typical (dimensionless-strength) form is:
        </p>

        <div class="eqBlock" role="group" aria-label="Oscillator model high-frequency asymptotic">
          <button class="copyBtn" data-copy="osc">Copy</button>
<pre id="osc">Oscillator-strength form (schematic):
α(ω) = Σ_j f_j / (ω_j^2 - ω^2 - i γ_j ω)   (one common convention)

As ω→∞:
(ω_j^2 - ω^2 - i γ_j ω) ≈ -ω^2   (dominant term)
⇒ α(ω) ≈ Σ_j f_j / (-ω^2) = -(Σ_j f_j)/ω^2

Taking the real part:
α'(ω) ≈ -(Σ_j f_j)/ω^2   (ω→∞)</pre>
        </div>

        <p>
          <strong>Why the approximation is valid:</strong>
          for <code>ω</code> much larger than every finite <code>ω_j</code> and damping scale <code>γ_j</code>,
          the <code>-ω^2</code> term dominates. This is a controlled expansion in small parameters
          <code>ω_j/ω</code> and <code>γ_j/ω</code>.
        </p>

        <h3>Step 5: Match the two correct high-ω expansions</h3>
        <p>
          Both derivations describe the same physical <code>α'(ω)</code> and therefore must agree term-by-term for <code>ω→∞</code>.
          Comparing:
        </p>

        <div class="eqBlock" role="group" aria-label="Coefficient matching">
          <button class="copyBtn" data-copy="match">Copy</button>
<pre id="match">From KK expansion:
α'(ω) ≈ - (2/π)(1/ω^2) ∫_0^∞ s α''(s) ds

From oscillator model:
α'(ω) ≈ - (1/ω^2) Σ_j f_j

Match coefficients of (-1/ω^2):
Σ_j f_j = (2/π) ∫_0^∞ s α''(s) ds</pre>
        </div>

        <div class="callout ok">
          <div class="kicker">Final result (boxed)</div>
          <div class="eqBlock" role="group" aria-label="Final answer">
            <button class="copyBtn" data-copy="final">Copy</button>
<pre id="final">Dissipation (oscillator-strength) sum rule:
Σ_j f_j = (2/π) ∫_0^∞ s α''(s) ds</pre>
          </div>
        </div>

        <h3>Sanity checks</h3>

        <div class="grid2">
          <div class="card">
            <div class="kicker">Dimensions / units</div>
            <p>
              In many textbook conventions, <code>f_j</code> is dimensionless and <code>α(ω)</code> may be scaled so that the RHS is dimensionless too.
              The statement “compare (9) and (11a)” implies the same normalization is being used on both sides.
            </p>
            <p class="muted">
              If your <code>α</code> carries SI units, then the “oscillator strength” in that convention may carry compensating factors
              (charge, mass, density, ε0, etc.). The <em>sum rule structure</em> (moment of <code>α''</code>) is the invariant content.
            </p>
          </div>
          <div class="card">
            <div class="kicker">Signs & positivity</div>
            <p>
              For passive media, <code>α''(s) ≥ 0</code> (for <code>s&gt;0</code> under standard sign conventions), hence the integral is nonnegative.
              Therefore <code>Σ f_j ≥ 0</code>, consistent with oscillator strengths being nonnegative weights.
            </p>
            <p>
              The minus sign appears only in the asymptotic expansion of <code>α'(ω)</code>; the sum rule itself is positive.
            </p>
          </div>
        </div>

        <details>
          <summary>Limiting-case asymptotics (next term)</summary>
          <p class="muted">
            Keeping the next term in the kernel expansion,
            <code>1/(s^2-ω^2) = -1/ω^2 - s^2/ω^4 - ...</code>,
            yields higher-moment sum rules, e.g. involving <code>∫_0^∞ s^3 α''(s) ds</code>.
            These correspond to higher-order coefficients in the high-frequency expansion of <code>α'(ω)</code>.
          </p>
        </details>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 4 -->
      <section id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpret the final formula</h3>
        <p>
          The sum rule
          <code>Σ f_j = (2/π) ∫_0^∞ s α''(s) ds</code>
          says the <strong>total oscillator strength</strong> equals a <strong>frequency-weighted area</strong> under the absorption curve.
          The weight factor <code>s</code> emphasizes higher-frequency absorption more strongly than low-frequency absorption.
        </p>

        <div class="callout">
          <div class="kicker">What each piece controls</div>
          <ul>
            <li><strong><code>f_j</code>:</strong> how much “spectral weight” each resonance contributes (strength of coupling to the field).</li>
            <li><strong><code>α''(s)</code>:</strong> where and how strongly energy is absorbed in frequency space.</li>
            <li><strong><code>s</code> weighting:</strong> reflects how high-frequency response affects the leading <code>1/ω^2</code> inertial tail of <code>α'(ω)</code>.</li>
            <li><strong><code>2/π</code> factor:</strong> a universal constant from Hilbert-transform/KK structure.</li>
          </ul>
        </div>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li>If absorption broadens (larger damping) but preserves total spectral weight, the integral stays the same; the loss is redistributed in frequency, but the moment constraint remains.</li>
          <li>Shifting absorption to higher frequencies tends to increase the weighted moment <code>∫ s α''(s) ds</code>, but the sum rule says this must correspond to a change in total oscillator strength (or in your normalization/model assumptions).</li>
          <li>Adding additional resonances adds new positive contributions to both sides; sum rules are excellent checks on whether a fitted model “missed” a resonance band.</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          A contour-integral route: consider <code>ω^2 α(ω)</code> as an analytic function in the upper half-plane.
          Integrate it around a large semicircle and use the residue theorem. The large-<code>ω</code> coefficient relates to
          an integral over the imaginary part along the real axis, producing the same moment sum rule.
          This is essentially the complex-analysis “engine” behind Kramers–Kronig.
        </p>

        <h3>Concept check (self-test)</h3>
        <ul>
          <li><strong>Q:</strong> Why does causality matter here?<br><strong>A:</strong> Causality makes <code>α(ω)</code> analytic in the upper half-plane, which forces KK relations and thus sum rules.</li>
          <li><strong>Q:</strong> Why is the integral weighted by <code>s</code>?<br><strong>A:</strong> Because the KK kernel for <code>α'(ω)</code> involves <code>s α''(s)</code> when written in the symmetric (0,∞) form.</li>
          <li><strong>Q:</strong> What physical quantity does <code>α''(ω)</code> represent?<br><strong>A:</strong> Dissipative response; it determines energy absorbed per cycle from the driving field (loss).</li>
          <li><strong>Q:</strong> What breaks if the integral <code>∫_0^∞ s α''(s) ds</code> diverges?<br><strong>A:</strong> Then the <code>1/ω^2</code> leading asymptotic coefficient is not well-defined from KK; the assumed high-frequency behavior or model normalization must be revisited.</li>
        </ul>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 5 -->
      <section id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p class="muted">
          A plot isn’t necessary here because the problem is purely symbolic and the key result is a moment identity.
          Any plot of <code>α''(ω)</code> would require specific material parameters and would not add essential insight beyond
          “the area under the absorption curve (with weight <code>ω</code>) is fixed.”
        </p>
        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

    </article>
  </main>

  <footer>
    <p>
      <strong>Note on notation:</strong> This article used <code>α(ω)=α'(ω)+iα''(ω)</code> and a KK form consistent with the given target sum rule.
      If your course/text uses a different Fourier sign convention, the KK formulas may appear with sign changes, but the
      physical content (moment constraints) remains the same when conventions are applied consistently.
    </p>
  </footer>

  <script>
    // Copy-to-clipboard for equation blocks (plain text)
    function copyTextFromElement(id){
      const el = document.getElementById(id);
      if(!el) return;
      const text = el.textContent;
      navigator.clipboard.writeText(text).then(()=>{
        // lightweight feedback
      }).catch(()=>{
        // fallback: create temporary textarea
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
      });
    }
    document.querySelectorAll('.copyBtn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const key = btn.getAttribute('data-copy');
        const map = {
          kk:'kk', target:'target', kk2:'kk2', kern:'kern', lead:'lead', osc:'osc', match:'match', final:'final'
        };
        const id = map[key] || key;
        copyTextFromElement(id);
        const old = btn.textContent;
        btn.textContent = 'Copied!';
        setTimeout(()=>btn.textContent = old, 900);
      });
    });

    // Scrollspy for TOC
    const tocLinks = Array.from(document.querySelectorAll('#toc a'))
      .filter(a => a.getAttribute('href') && a.getAttribute('href').startsWith('#'));
    const sections = tocLinks
      .map(a => document.querySelector(a.getAttribute('href')))
      .filter(Boolean);

    const observer = new IntersectionObserver((entries)=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting){
          const id = '#' + entry.target.id;
          tocLinks.forEach(a=>{
            a.classList.toggle('active', a.getAttribute('href') === id);
          });
        }
      });
    }, { root: null, threshold: 0.25, rootMargin: "-15% 0px -70% 0px" });

    sections.forEach(sec => observer.observe(sec));
  </script>
</body>
</html>