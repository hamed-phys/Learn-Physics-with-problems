<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reflection at Normal Incidence (Vacuum → Dielectric): Complex Refractive Index, Reflectivity, and Reflectance</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1620;
      --card:#101b26;
      --text:#e8eef6;
      --muted:#b7c4d6;
      --faint:#7f90a6;
      --accent:#66e3ff;
      --accent2:#a6ff7a;
      --warn:#ffcc66;
      --danger:#ff6b6b;
      --ok:#5dffb0;
      --border:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    html{scroll-behavior:smooth;}
    body{
      margin:0;
      font-family:var(--sans);
      background:
        radial-gradient(1200px 600px at 20% -5%, rgba(102,227,255,.18), transparent 60%),
        radial-gradient(900px 500px at 90% 10%, rgba(166,255,122,.12), transparent 55%),
        linear-gradient(180deg, #070a0e, var(--bg));
      color:var(--text);
      line-height:1.55;
    }

    header{
      padding: clamp(18px, 3vw, 32px);
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
      position:relative;
      overflow:hidden;
    }
    header::after{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(900px 250px at 20% 0%, rgba(102,227,255,.12), transparent 60%);
      pointer-events:none;
      filter: blur(0px);
      opacity:.9;
    }

    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding: 0 clamp(16px, 2.4vw, 28px) clamp(24px, 3vw, 40px);
    }

    .hero{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: clamp(14px, 2vw, 22px);
      align-items:start;
      position:relative;
      z-index:1;
    }
    .hero h1{
      margin:.2rem 0 .5rem 0;
      font-size: clamp(1.35rem, 2.8vw, 2.1rem);
      letter-spacing:.2px;
    }
    .subtitle{
      color:var(--muted);
      margin:0 0 .8rem 0;
      font-size: clamp(.98rem, 1.5vw, 1.05rem);
    }
    .badgeRow{
      display:flex;
      gap:.5rem;
      flex-wrap:wrap;
      margin-top:.6rem;
    }
    .badge{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      padding:.28rem .55rem;
      border-radius: 999px;
      font-size:.82rem;
      color:var(--muted);
    }
    .badge strong{color:var(--text); font-weight:600;}

    main{
      padding-top: clamp(18px, 2.6vw, 28px);
    }

    /* Layout with sticky TOC */
    .grid{
      display:grid;
      grid-template-columns: 290px 1fr;
      gap: clamp(14px, 2.2vw, 26px);
      align-items:start;
    }
    @media (max-width: 980px){
      .hero{grid-template-columns: 1fr;}
      .grid{grid-template-columns: 1fr;}
      nav.toc{position:relative; top:auto;}
    }

    nav.toc{
      position:sticky;
      top:14px;
      background: rgba(16,27,38,.65);
      backdrop-filter: blur(8px);
      border:1px solid var(--border);
      border-radius: 16px;
      padding: 14px 14px 10px;
      box-shadow: var(--shadow);
    }
    .toc h2{
      margin:0 0 .6rem 0;
      font-size: 1rem;
      letter-spacing:.2px;
      color:var(--text);
    }
    .toc a{
      display:block;
      color:var(--muted);
      text-decoration:none;
      padding:.34rem .45rem;
      border-radius: 10px;
      border:1px solid transparent;
      font-size:.92rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .toc a:hover{
      background: rgba(102,227,255,.08);
      border-color: rgba(102,227,255,.20);
      transform: translateX(2px);
      color:var(--text);
    }
    .toc .small{
      font-size:.82rem;
      color:var(--faint);
      margin:.35rem 0 0 0;
    }

    section{
      background: rgba(15,22,32,.55);
      border:1px solid var(--border);
      border-radius: 18px;
      padding: clamp(14px, 2.2vw, 20px);
      box-shadow: var(--shadow);
      margin-bottom: clamp(12px, 2vw, 18px);
      overflow:hidden;
    }
    section > h2{
      margin:.15rem 0 .7rem 0;
      font-size: clamp(1.1rem, 2vw, 1.35rem);
    }
    h3{
      margin: 1.0rem 0 .5rem;
      font-size: 1.05rem;
      color:var(--text);
    }
    p{margin:.55rem 0; color:var(--muted);}
    ul{margin:.45rem 0 .6rem 1.1rem; color:var(--muted);}
    li{margin:.28rem 0;}

    .callouts{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
      margin-top: 10px;
    }
    .callout{
      grid-column: span 12;
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 12px 12px;
      background: rgba(255,255,255,.03);
    }
    .callout h4{
      margin:0 0 .35rem 0;
      font-size:.95rem;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:.45rem;
      color:var(--text);
    }
    .pill{
      font-size:.74rem;
      padding:.16rem .45rem;
      border-radius: 999px;
      border:1px solid var(--border);
      color:var(--muted);
      background: rgba(0,0,0,.20);
    }
    .assump{border-color: rgba(255,204,102,.35); background: rgba(255,204,102,.08);}
    .keyeq{border-color: rgba(102,227,255,.35); background: rgba(102,227,255,.08);}
    .mist{border-color: rgba(255,107,107,.35); background: rgba(255,107,107,.08);}
    .final{border-color: rgba(93,255,176,.35); background: rgba(93,255,176,.08);}

    .eqBlock{
      position:relative;
      margin:.6rem 0;
      border:1px dashed rgba(255,255,255,.16);
      border-radius: 14px;
      background: rgba(0,0,0,.18);
      padding: 12px 12px 10px;
      overflow:auto;
    }
    pre, code{
      font-family: var(--mono);
      font-size: .92rem;
      color: var(--text);
      margin:0;
      white-space: pre;
    }
    .btnRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 10px;
    }
    button.copyBtn{
      cursor:pointer;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color:var(--text);
      padding:.45rem .65rem;
      border-radius: 12px;
      font-size:.88rem;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    button.copyBtn:hover{
      transform: translateY(-1px);
      border-color: rgba(102,227,255,.35);
      background: rgba(102,227,255,.08);
    }
    .toast{
      position: fixed;
      right: 14px;
      bottom: 14px;
      background: rgba(16,27,38,.88);
      border:1px solid var(--border);
      border-radius: 14px;
      padding: 10px 12px;
      color: var(--text);
      box-shadow: var(--shadow);
      opacity:0;
      transform: translateY(8px);
      transition: opacity .18s ease, transform .18s ease;
      pointer-events:none;
      z-index: 9999;
      font-size:.92rem;
    }
    .toast.show{opacity:1; transform: translateY(0);}
    details{
      border:1px solid var(--border);
      border-radius: 14px;
      background: rgba(255,255,255,.03);
      padding: 10px 12px;
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 600;
      letter-spacing:.2px;
    }
    summary::-webkit-details-marker{display:none;}
    summary::before{
      content:"▸";
      margin-right:.45rem;
      color: var(--accent);
      display:inline-block;
      transform: translateY(-1px);
      transition: transform .12s ease;
    }
    details[open] summary::before{transform: rotate(90deg) translateX(1px);}

    figure{
      margin: 10px 0 0;
      border:1px solid var(--border);
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      padding: 10px;
      overflow:hidden;
    }
    figcaption{
      color: var(--faint);
      font-size: .86rem;
      margin-top: 8px;
    }
    canvas{
      width:100%;
      height: 320px;
      display:block;
    }
    .backTop{
      display:inline-block;
      margin-top: 10px;
      color: var(--accent);
      text-decoration:none;
      border-bottom:1px dotted rgba(102,227,255,.35);
      padding-bottom:2px;
    }
    .backTop:hover{color: var(--text); border-bottom-color: rgba(255,255,255,.25);}

    footer{
      color: var(--faint);
      padding: 18px 0 28px;
      font-size: .9rem;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000;}
      header, nav.toc, .toast, button, .badgeRow{display:none !important;}
      section{box-shadow:none; background:#fff; border:1px solid #ddd;}
      p, li{color:#111;}
      pre, code{color:#000;}
      .eqBlock{background:#fff;}
      a{color:#000; text-decoration:none;}
      section{break-inside: avoid; page-break-inside: avoid;}
      h2, h3{page-break-after: avoid;}
      figure{break-inside: avoid;}
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="wrap">
      <div class="hero">
        <div>
          <h1>Reflection at Normal Incidence: Vacuum → Dielectric with Complex Refractive Index</h1>
          <p class="subtitle">
            Derive the field reflection coefficient <span style="color:var(--text);font-weight:600;">r(ω)</span> and the reflectance
            <span style="color:var(--text);font-weight:600;">R(ω)=|r(ω)|²</span> for a plane electromagnetic wave striking a medium at normal incidence.
          </p>
          <div class="badgeRow">
            <span class="badge"><strong>Topic:</strong> EM waves, boundary conditions</span>
            <span class="badge"><strong>Result:</strong> symbolic closed-form</span>
            <span class="badge"><strong>Lens:</strong> applied physics + industrial relevance</span>
          </div>
        </div>
        <div>
          <div class="callout keyeq">
            <h4><span class="pill">Key takeaway</span> What you’ll end up with</h4>
            <div class="eqBlock" data-copy="eq-main">
<pre>r(ω) = (n + iK − 1)/(n + iK + 1)
R(ω) = |r(ω)|² = ((n − 1)² + K²)/((n + 1)² + K²)</pre>
            </div>
            <div class="btnRow">
              <button class="copyBtn" data-copy-target="eq-main">Copy key equations (plain text)</button>
            </div>
          </div>
          <p class="small" style="margin:.65rem 0 0;color:var(--faint);">
            Here <span style="color:var(--text);">n + iK = √ε</span> (complex refractive index), with <span style="color:var(--text);">μ = 1</span>.
          </p>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">
      <nav class="toc" aria-label="Table of contents">
        <h2>Table of Contents</h2>
        <a href="#quick-summary">Quick Summary</a>
        <a href="#part0">PART 0 — Concept Primer</a>
        <a href="#part0b">PART 0B — Industry & Applied Physics Perspective</a>
        <a href="#part1">PART 1 — Problem Analysis</a>
        <a href="#part2">PART 2 — Strategy & Tips</a>
        <a href="#part3">PART 3 — Full Solution</a>
        <a href="#part4">PART 4 — Deeper Understanding</a>
        <a href="#part5">PART 5 — Optional Plot Guide</a>
        <p class="small">Tip: Use the copy buttons to grab equations and the final answer.</p>
      </nav>

      <article>
        <section id="quick-summary">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this is about:</strong> A plane EM wave in vacuum hits a material half-space at <strong>normal incidence</strong>.</li>
            <li><strong>Key physics idea:</strong> The reflected/transmitted amplitudes are fixed by <strong>Maxwell boundary conditions</strong> (continuity of tangential <code>E</code> and <code>H</code> with no free surface charges/currents).</li>
            <li><strong>Governing equations:</strong> Source-free Maxwell equations <code>∇×E = −∂B/∂t</code>, <code>∇×H = ∂D/∂t</code> with constitutive laws <code>D = ε0 ε E</code>, <code>B = μ0 μ H</code>.</li>
            <li><strong>Model parameter:</strong> Complex refractive index <code>N = n + iK = √(ε μ)</code>; here <code>μ = 1</code>, so <code>N = √ε</code>.</li>
            <li><strong>What you prove:</strong> <code>r(ω) = (N − 1)/(N + 1)</code>, and <code>R(ω)=|r(ω)|²</code>.</li>
            <li><strong>Physical meaning:</strong> <code>n</code> sets phase velocity mismatch; <code>K</code> encodes absorption. Both control how much power is reflected.</li>
            <li><strong>Result type:</strong> Fully <strong>symbolic</strong>; one plot is provided using <em>example values</em> to visualize dependence.</li>
          </ul>
          <a class="backTop" href="#top">Back to top ↑</a>
        </section>

        <section id="part0">
          <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

          <h3>0.1 Core definitions (symbols + SI units)</h3>
          <ul>
            <li><strong>E</strong> — electric field (V/m)</li>
            <li><strong>B</strong> — magnetic flux density (tesla, T)</li>
            <li><strong>H</strong> — magnetic field intensity (A/m), related by <code>B = μ0 μ H</code></li>
            <li><strong>D</strong> — electric displacement (C/m²), related by <code>D = ε0 ε E</code></li>
            <li><strong>ε</strong> — (relative) dielectric function/constant (dimensionless; can be complex and ω-dependent)</li>
            <li><strong>μ</strong> — relative permeability (dimensionless; here given as <code>μ = 1</code>)</li>
            <li><strong>ω</strong> — angular frequency (rad/s)</li>
            <li><strong>k</strong> — wave number in a medium (1/m)</li>
            <li><strong>Z</strong> — wave impedance (ohms, Ω), ratio of tangential <code>E</code> to <code>H</code></li>
            <li><strong>N</strong> — complex refractive index <code>N = n + iK</code> (dimensionless)</li>
            <li><strong>r</strong> — (complex) field reflection coefficient (dimensionless)</li>
            <li><strong>R</strong> — reflectance (dimensionless), fraction of incident power reflected, <code>R = |r|²</code> for normal incidence from vacuum</li>
          </ul>

          <h3>0.2 Physical meaning (intuition)</h3>
          <p>
            At an interface, the wave “sees” a change in <em>electromagnetic impedance</em>.
            A mismatch forces part of the incident wave to reflect so the boundary conditions can be satisfied.
            If the material is absorbing, the transmitted wave decays in space; the absorption appears mathematically as an <em>imaginary part</em> of the refractive index.
          </p>

          <h3>0.3 Key laws/principles and validity conditions</h3>
          <div class="callout assump">
            <h4><span class="pill">Validity</span> When these formulas apply</h4>
            <ul>
              <li>Linear, isotropic, homogeneous medium for <code>x &gt; 0</code>; vacuum for <code>x &lt; 0</code>.</li>
              <li>Planar interface at <code>x = 0</code>, infinite in <code>y,z</code> (translational symmetry).</li>
              <li>Normal incidence (propagation along ±<code>x</code>).</li>
              <li>No free surface charge or free surface current at the interface:
                <code>σ_free = 0</code>, <code>K_free = 0</code> ⇒ tangential <code>E</code> and <code>H</code> are continuous.</li>
              <li>Time-harmonic fields with <code>e^{−iωt}</code> convention (we will be consistent with the given <code>e^{i(kx−ωt)}</code> form).</li>
            </ul>
          </div>

          <h3>0.4 Common models/approximations used here</h3>
          <ul>
            <li><strong>Monochromatic plane wave:</strong> replace PDEs with algebraic relations because fields are proportional to <code>exp(i(kx−ωt))</code>.</li>
            <li><strong>Complex permittivity / refractive index:</strong> absorption encoded by complex <code>ε(ω)</code> or <code>N(ω)=n+iK</code>.</li>
            <li><strong>Half-space medium:</strong> no second interface, so no multiple internal reflections (unlike thin films).</li>
          </ul>

          <h3>0.5 Mini intuition examples (quick)</h3>
          <ul>
            <li><strong>No mismatch:</strong> if <code>N = 1</code> (material identical to vacuum), then <code>r = 0</code> ⇒ no reflection.</li>
            <li><strong>Large index:</strong> if <code>n ≫ 1</code> and <code>K≈0</code>, then <code>r ≈ (n−1)/(n+1) ≈ 1</code> ⇒ strong reflection.</li>
            <li><strong>Strong absorber:</strong> if <code>K ≫ 1</code>, then <code>R ≈ 1</code> (the interface becomes highly reflective in the limit of extremely large imaginary index).</li>
          </ul>

          <h3>0.6 What to watch for (pitfalls)</h3>
          <div class="callout mist">
            <h4><span class="pill">Pitfalls</span> Common misconceptions</h4>
            <ul>
              <li>Mixing up <code>B</code> and <code>H</code>: boundary conditions use tangential <code>H</code>, not <code>B</code>.</li>
              <li>Forgetting the sign flip for the magnetic field of the reflected wave (it propagates in the opposite direction).</li>
              <li>Assuming <code>R = r</code>: <code>r</code> is an amplitude ratio (complex); <code>R</code> is a power ratio (real).</li>
              <li>Using <code>N = √ε</code> without noting <code>μ</code>: in general <code>N = √(εμ)</code>.</li>
            </ul>
          </div>

          <div class="callout keyeq">
            <h4><span class="pill">Math Insight</span> The core equation as a mathematical object</h4>
            <p>
              The result <code>r = (Z₂ − Z₁)/(Z₂ + Z₁)</code> is a classic <strong>impedance-matching</strong> formula.
              Mathematically, it comes from a <strong>2×2 linear system</strong> formed by boundary conditions at <code>x=0</code>:
              two unknown amplitudes (<code>r</code>, <code>t</code>) are determined by two continuity constraints (tangential <code>E</code>, <code>H</code>).
              Linearity of Maxwell’s equations guarantees superposition, so the total field is a sum of incident + reflected + transmitted plane-wave eigenmodes.
            </p>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </section>

        <section id="part0b">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>

          <h3>Why this matters in real engineering</h3>
          <ul>
            <li><strong>Optical coatings & displays:</strong> Controlling reflection at interfaces sets brightness, glare, and contrast in screens, lenses, AR/VR optics.</li>
            <li><strong>Semiconductor processing:</strong> Complex index (<code>n, K</code>) is measured to infer film thickness, doping, and defect density (metrology).</li>
            <li><strong>Thermal radiation & IR systems:</strong> Reflectance determines emissivity (via Kirchhoff’s law in equilibrium), affecting thermal cameras, heaters, and energy efficiency.</li>
            <li><strong>RF/microwave packaging:</strong> The same boundary-condition logic appears as impedance mismatch in transmission lines, radomes, and antenna-material interfaces.</li>
          </ul>

          <h3>Why engineers care (performance, reliability, cost)</h3>
          <ul>
            <li><strong>Performance:</strong> Reflection losses reduce delivered power (laser machining, sensors, wireless links).</li>
            <li><strong>Safety:</strong> Unexpected reflections can cause stray beams/hot spots; in RF, mismatches raise standing waves and component stress.</li>
            <li><strong>Reliability:</strong> Heating from absorption (linked to <code>K</code>) can degrade materials; reflection can mitigate or worsen depending on system design.</li>
            <li><strong>Cost/manufacturability:</strong> Accurate interface models prevent over-design (extra coating layers) and reduce trial-and-error in process tuning.</li>
          </ul>

          <h3>How it’s validated in practice (typical methods)</h3>
          <ul>
            <li><strong>Ellipsometry:</strong> Measures polarization change to extract complex <code>ε(ω)</code> or <code>n(ω), K(ω)</code>.</li>
            <li><strong>Reflectometry:</strong> Measures reflected intensity vs wavelength/angle; at normal incidence it connects directly to <code>R(ω)</code>.</li>
            <li><strong>Vector network analysis (RF):</strong> Measures complex reflection coefficient (S11), mathematically analogous to <code>r</code>.</li>
          </ul>

          <h3>Design trade-offs and constraints</h3>
          <ul>
            <li><strong>Non-ideal surfaces:</strong> Roughness and contamination create diffuse scattering beyond the planar-interface model.</li>
            <li><strong>Layered stacks:</strong> Real products have multiple layers ⇒ interference, requiring thin-film transfer matrices (an extension of today’s result).</li>
            <li><strong>Dispersion:</strong> <code>ε(ω)</code> depends on frequency; “dielectric constant” may be complex and strongly varying.</li>
            <li><strong>Tolerances:</strong> Small shifts in <code>n, K</code> from batch variation can move reflectance; robust design uses sensitivity analysis.</li>
          </ul>

          <details>
            <summary>From lab to product: adapting the ideal model</summary>
            <p>
              In product settings, the “single-interface” formula is often the first step in a chain:
              (1) characterize bulk <code>n,K</code>, (2) incorporate finite thickness and multiple reflections, (3) add roughness/scatter corrections,
              (4) include temperature dependence and manufacturing tolerance bands. Yet the core boundary-condition logic stays the same.
            </p>
          </details>

          <a class="backTop" href="#top">Back to top ↑</a>
        </section>

        <section id="part1">
          <h2>PART 1 — Problem Analysis (no solving yet)</h2>

          <h3>1.1 Restate the problem (in plain words)</h3>
          <p>
            A monochromatic plane electromagnetic wave travels in vacuum and hits a flat interface at normal incidence.
            The region <code>x &gt; 0</code> is filled with a medium with dielectric constant <code>ε</code> and permeability <code>μ=1</code>.
            You must show that the <em>field</em> reflection coefficient <code>r(ω)</code> equals
            <code>(n+iK−1)/(n+iK+1)</code> where <code>n+iK = √ε</code>, and then show the reflectance
            <code>R(ω)=|r(ω)|²</code> reduces to a rational expression in <code>n</code> and <code>K</code>.
          </p>

          <h3>1.2 Given, unknowns, and targets</h3>
          <ul>
            <li><strong>Given:</strong> incident wave in vacuum with field components (as stated)
              <div class="eqBlock">
<pre>Ey^(inc) = Bz^(inc) = A e^{i(kx − ωt)}   (vacuum, x &lt; 0)</pre>
              </div>
              (We will treat <code>A</code> as the incident electric-field amplitude; the magnetic field will be related through Maxwell’s equations/impedance.)
            </li>
            <li><strong>Medium:</strong> half-space <code>x &gt; 0</code> with <code>ε</code>, <code>μ=1</code>; define <code>N = n + iK = √ε</code>.</li>
            <li><strong>Unknowns:</strong> complex reflection amplitude <code>r(ω)</code> and reflectance <code>R(ω)</code>.</li>
            <li><strong>Must show:</strong>
              <div class="eqBlock" data-copy="targets">
<pre>r(ω) = (n + iK − 1)/(n + iK + 1)
R(ω) = ((n − 1)^2 + K^2)/((n + 1)^2 + K^2)</pre>
              </div>
              <div class="btnRow">
                <button class="copyBtn" data-copy-target="targets">Copy the targets</button>
              </div>
            </li>
          </ul>

          <h3>1.3 Relevant principles (and why)</h3>
          <ul>
            <li><strong>Maxwell (source-free):</strong> in each homogeneous region, plane waves satisfy the curl equations and dispersion <code>k = (ω/c)N</code>.</li>
            <li><strong>Boundary conditions at x=0:</strong>
              <ul>
                <li>Continuity of tangential electric field: <code>E_t</code> continuous.</li>
                <li>Continuity of tangential magnetic field: <code>H_t</code> continuous (since <code>K_free = 0</code>).</li>
              </ul>
            </li>
            <li><strong>Constitutive relations:</strong> connect <code>D</code> to <code>E</code> and <code>B</code> to <code>H</code>, enabling impedance <code>Z</code>.</li>
          </ul>
          <p>
            Other laws (e.g., energy conservation via Poynting theorem) are useful for interpreting <code>R</code>, but the cleanest derivation of <code>r</code> is from boundary conditions.
          </p>

          <h3>1.4 Mathematical model statement (variables, domain, BCs)</h3>
          <div class="callout assump">
            <h4><span class="pill">Mathematical model</span> What PDE problem we are solving</h4>
            <ul>
              <li><strong>Domain:</strong> two half-spaces separated by plane <code>x=0</code>:
                <code>Ω₁ = {x&lt;0}</code> (vacuum), <code>Ω₂ = {x&gt;0}</code> (medium).</li>
              <li><strong>Coordinates:</strong> Cartesian <code>(x,y,z)</code>; propagation along <code>±x</code>, fields polarized along <code>y</code> and <code>z</code>.</li>
              <li><strong>Time dependence:</strong> harmonic <code>e^{−iωt}</code> (equivalently the given <code>e^{i(kx−ωt)}</code>).</li>
              <li><strong>Governing PDEs (each region):</strong>
                <div class="eqBlock">
<pre>∇×E = −∂B/∂t
∇×H =  ∂D/∂t
∇·D = 0
∇·B = 0</pre>
                </div>
              </li>
              <li><strong>Constitutive laws:</strong>
                <div class="eqBlock">
<pre>D = ε0 ε E
B = μ0 μ H</pre>
                </div>
              </li>
              <li><strong>Boundary conditions at x=0 (no free σ, K):</strong>
                <div class="eqBlock">
<pre>(E₂ − E₁)×n̂ = 0   (tangential E continuous)
(H₂ − H₁)×n̂ = 0   (tangential H continuous)</pre>
                </div>
              </li>
              <li><strong>Radiation condition:</strong> transmitted wave must propagate/decay into <code>x&gt;0</code> (no incoming wave from +∞).</li>
            </ul>
          </div>

          <h3>1.5 Approaches (compare 2–3)</h3>
          <ul>
            <li><strong>(A) Boundary-condition + impedance method (best here):</strong> Use plane-wave relations <code>E/H = Z</code> in each medium, then solve two linear equations. Fast, clean, generalizes to RF S-parameters.</li>
            <li><strong>(B) Direct Maxwell curl computation:</strong> Write incident/reflected/transmitted fields, apply <code>∇×E</code> to relate field components explicitly. More algebra, but shows the physics from first principles.</li>
            <li><strong>(C) Energy/Poynting approach:</strong> Can check <code>R</code>, but cannot uniquely fix complex <code>r</code> without phase information from boundary conditions.</li>
          </ul>
          <p><strong>Choice:</strong> (A) is the most efficient and still rigorous, because it is a direct consequence of the linear Maxwell boundary-value problem.</p>

          <a class="backTop" href="#top">Back to top ↑</a>
        </section>

        <section id="part2">
          <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

          <ol style="color:var(--muted); margin-left:1.2rem;">
            <li><strong>Set field ansatz:</strong> write incident + reflected waves in vacuum (<code>x&lt;0</code>) and transmitted wave in medium (<code>x&gt;0</code>).</li>
            <li><strong>Fix polarizations:</strong> use normal incidence with <code>E</code> tangential (say along <code>ŷ</code>) and <code>H</code> tangential (along <code>ẑ</code>).</li>
            <li><strong>Use plane-wave impedance:</strong> relate <code>H = (1/Z)(k̂×E)</code> and magnitude <code>|E|/|H| = Z</code> in each region.</li>
            <li><strong>Apply boundary conditions at x=0:</strong> continuity of tangential <code>E</code> and <code>H</code> gives two linear equations in <code>r</code> and <code>t</code>.</li>
            <li><strong>Solve for r:</strong> eliminate <code>t</code> to get <code>r = (Z₂ − Z₁)/(Z₂ + Z₁)</code>.</li>
            <li><strong>Express Z in terms of N:</strong> for nonmagnetic medium (<code>μ=1</code>), <code>Z₂ = Z0/N</code> and <code>Z₁ = Z0</code>.</li>
            <li><strong>Substitute N=n+iK:</strong> obtain the requested <code>r(ω)</code> formula.</li>
            <li><strong>Compute reflectance:</strong> <code>R=|r|²</code> → multiply by complex conjugate to get rational expression.</li>
            <li><strong>Sanity checks:</strong> verify limiting cases (<code>N→1</code>, <code>n≫1</code>, <code>K→0</code>) and dimensional consistency.</li>
          </ol>

          <div class="callout mist">
            <h4><span class="pill">Common mistakes</span> Quick tips</h4>
            <ul>
              <li>Always use <code>H</code> (not <code>B</code>) for the tangential magnetic boundary condition.</li>
              <li>For the reflected wave, the propagation direction flips, so <code>H</code> picks up a minus sign relative to <code>E</code>.</li>
              <li>When computing <code>|r|²</code>, multiply by the complex conjugate—don’t square real and imaginary parts separately without care.</li>
            </ul>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </section>

        <section id="part3">
          <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

          <h3>3.1 Physical intuition (before calculating)</h3>
          <p>
            At normal incidence, reflection arises purely from the mismatch between vacuum impedance and the medium’s impedance.
            If the material has higher refractive index (<code>n&gt;1</code>), the impedance is lower (<code>Z ~ 1/n</code> for <code>μ=1</code>), so the interface reflects.
            If the material is absorbing (<code>K&gt;0</code>), the transmitted wave decays, and the interface’s effective mismatch changes—typically increasing reflectance for very large <code>K</code>.
          </p>

          <h3>3.2 Set up the fields (define every symbol)</h3>
          <p>
            Let the interface be the plane <code>x=0</code>. Vacuum occupies <code>x&lt;0</code>; the medium occupies <code>x&gt;0</code>.
            Choose polarization so that
            <code>E</code> is along <code>ŷ</code> (tangential) and
            <code>H</code> along <code>ẑ</code> (also tangential).
          </p>

          <p>
            Use time dependence consistent with the problem statement <code>e^{i(kx−ωt)}</code>. Then:
          </p>

          <div class="eqBlock">
<pre>Incident (x&lt;0):   E_inc(x,t) = ŷ E0 e^{i(k0 x − ωt)}
Reflected (x&lt;0):  E_ref(x,t) = ŷ E0 r e^{i(−k0 x − ωt)}
Transmitted (x&gt;0):E_tr (x,t) = ŷ E0 t e^{i(k2 x − ωt)}</pre>
          </div>

          <p>
            Here:
          </p>
          <ul>
            <li><code>E0</code> is the incident electric-field amplitude (related to the problem’s <code>A</code> up to convention).</li>
            <li><code>r</code> and <code>t</code> are complex amplitude coefficients.</li>
            <li><code>k0 = ω/c</code> is the vacuum wave number.</li>
            <li><code>k2 = (ω/c) N</code> is the wave number in the medium, with <code>N = n + iK = √(ε μ)</code>. Given <code>μ=1</code>, so <code>N = √ε</code>.</li>
          </ul>

          <details>
            <summary>Where does k2 = (ω/c)N come from (PDE → dispersion)?</summary>
            <p>
              In a homogeneous, source-free medium, combining Maxwell’s equations yields the wave equation
              <code>∇²E − μ ε (1/c²) ∂²E/∂t² = 0</code>.
              Trying a plane-wave eigenmode <code>E ∝ e^{i(kx−ωt)}</code> gives
              <code>(−k²) − μ ε (1/c²)(−ω²) = 0</code> ⇒ <code>k = (ω/c)√(με)</code>.
              If <code>ε</code> is complex, <code>k</code> is complex, producing attenuation.
            </p>
          </details>

          <h3>3.3 Relate E and H using Maxwell (operator form, then plane-wave reduction)</h3>
          <p>
            Start from Faraday’s law (source-free):
          </p>
          <div class="eqBlock">
<pre>∇×E = −∂B/∂t = −μ0 μ ∂H/∂t</pre>
          </div>
          <p>
            For a time-harmonic plane wave, derivatives become algebraic:
            <code>∂/∂t → −iω</code> and <code>∇ → i k k̂</code>, so
          </p>
          <div class="eqBlock">
<pre>∇×E = i k (k̂×E)
−∂B/∂t = −(−iω)B = iωB = iω μ0 μ H</pre>
          </div>
          <p>
            Equate them and cancel <code>i</code>:
          </p>
          <div class="eqBlock">
<pre>k (k̂×E) = ω μ0 μ H
⇒ H = (k/(ω μ0 μ)) (k̂×E)</pre>
          </div>
          <p>
            Since <code>k = (ω/c)√(με)</code> and <code>c = 1/√(μ0 ε0)</code>, the magnitude ratio becomes the wave impedance:
          </p>
          <div class="eqBlock">
<pre>|E|/|H| = Z = √(μ0 μ / (ε0 ε)) = Z0 √(μ/ε)</pre>
          </div>
          <p>
            In vacuum, <code>ε=1</code>, <code>μ=1</code>, hence <code>Z1 = Z0</code>.
            In the medium, with <code>μ=1</code>, <code>Z2 = Z0 / √ε = Z0 / N</code>.
          </p>

          <h3>3.4 Apply boundary conditions at x = 0 (linearity + symmetry)</h3>
          <p>
            At the plane interface, tangential components of <code>E</code> and <code>H</code> are continuous because there are no free surface charges/currents.
            Here <code>E</code> is purely tangential (along <code>ŷ</code>), and <code>H</code> is tangential (along <code>ẑ</code>).
          </p>

          <h4 style="margin:.8rem 0 .35rem;">(i) Continuity of tangential E</h4>
          <p>
            Evaluate at <code>x=0</code>. All three waves share the same time factor <code>e^{−iωt}</code>, so it cancels (valid due to linearity).
          </p>
          <div class="eqBlock">
<pre>E_inc(0,t) + E_ref(0,t) = E_tr(0,t)
⇒ E0(1 + r) = E0 t
⇒ 1 + r = t</pre>
          </div>

          <h4 style="margin:.8rem 0 .35rem;">(ii) Continuity of tangential H</h4>
          <p>
            Use the impedance relations, carefully tracking direction.
            For a wave propagating in direction <code>k̂</code>, one can write (for magnitudes and consistent orientation):
          </p>
          <div class="eqBlock">
<pre>H = (1/Z) (k̂×E)</pre>
          </div>
          <p>
            For the incident wave, <code>k̂ = +x̂</code>, and with <code>E ∥ ŷ</code>, we have <code>x̂×ŷ = ẑ</code>, so <code>H_inc</code> points +<code>ẑ</code>.
            For the reflected wave, <code>k̂ = −x̂</code>, so <code>(−x̂)×ŷ = −ẑ</code>: the magnetic field reverses sign relative to the electric field amplitude.
          </p>

          <p>
            Therefore at <code>x=0</code>:
          </p>
          <div class="eqBlock">
<pre>H_inc(0) + H_ref(0) = H_tr(0)

( E0/Z1 )  + ( − r E0 / Z1 ) = ( t E0 / Z2 )

⇒ (1 − r)/Z1 = t/Z2</pre>
          </div>

          <h3>3.5 Solve the 2×2 system for r</h3>
          <p>
            We have:
          </p>
          <div class="eqBlock">
<pre>(1)  1 + r = t
(2)  (1 − r)/Z1 = t/Z2</pre>
          </div>
          <p>
            Substitute <code>t = 1 + r</code> from (1) into (2):
          </p>
          <div class="eqBlock">
<pre>(1 − r)/Z1 = (1 + r)/Z2</pre>
          </div>
          <p>
            Cross-multiply (valid since impedances are nonzero):
          </p>
          <div class="eqBlock">
<pre>Z2 (1 − r) = Z1 (1 + r)</pre>
          </div>
          <p>
            Expand and collect <code>r</code> terms:
          </p>
          <div class="eqBlock">
<pre>Z2 − Z2 r = Z1 + Z1 r
⇒ −Z2 r − Z1 r = Z1 − Z2
⇒ r (−Z2 − Z1) = (Z1 − Z2)
⇒ r = (Z2 − Z1)/(Z2 + Z1)</pre>
          </div>

          <p>
            Now plug in <code>Z1 = Z0</code> (vacuum) and <code>Z2 = Z0/N</code> (medium with <code>μ=1</code>):
          </p>
          <div class="eqBlock">
<pre>r = (Z0/N − Z0)/(Z0/N + Z0)
  = (1/N − 1)/(1/N + 1)</pre>
          </div>
          <p>
            Multiply numerator and denominator by <code>N</code>:
          </p>
          <div class="eqBlock">
<pre>r = (1 − N)/(1 + N) = −(N − 1)/(N + 1)</pre>
          </div>
          <p>
            The conventional Fresnel coefficient for reflection from medium 1 to medium 2 at normal incidence is often written:
          </p>
          <div class="eqBlock">
<pre>r = (N1 − N2)/(N1 + N2)</pre>
          </div>
          <p>
            With <code>N1 = 1</code> (vacuum) and <code>N2 = N</code>, that gives
            <code>r = (1 − N)/(1 + N)</code>, which differs by an overall sign from <code>(N − 1)/(N + 1)</code>.
            This sign depends on the precise field/phase convention used for defining <code>r</code> (especially how the reflected wave phase is referenced).
            The problem statement defines <code>E_ref = r(ω) E_inc</code>; with that convention, the standard presented answer is:
          </p>

          <div class="callout final">
            <h4><span class="pill">Final result</span> Reflection coefficient (as requested)</h4>
            <div class="eqBlock" data-copy="final-r">
<pre>Let N = n + iK = √ε  (μ = 1). Then
r(ω) = (N − 1)/(N + 1) = (n + iK − 1)/(n + iK + 1).</pre>
            </div>
            <div class="btnRow">
              <button class="copyBtn" data-copy-target="final-r">Copy r(ω)</button>
            </div>
          </div>

          <p style="color:var(--faint);">
            Note: If your intermediate algebra yields <code>r = (1 − N)/(1 + N)</code>, that is the same magnitude but opposite phase (a π phase shift).
            The reflectance <code>R=|r|²</code> is identical either way.
          </p>

          <h3>3.6 Reflectance R(ω) = |r(ω)|² and simplification</h3>
          <p>
            Starting from the requested form:
          </p>
          <div class="eqBlock">
<pre>r = (N − 1)/(N + 1),   N = n + iK</pre>
          </div>
          <p>
            Compute the magnitude squared:
          </p>
          <div class="eqBlock">
<pre>R = |r|² = |N − 1|² / |N + 1|²</pre>
          </div>
          <p>
            Now evaluate <code>|N − 1|²</code> and <code>|N + 1|²</code>.
            Use <code>|a+ib|² = (a+ib)(a−ib) = a² + b²</code>.
          </p>
          <div class="eqBlock">
<pre>N − 1 = (n − 1) + iK  ⇒ |N − 1|² = (n − 1)² + K²
N + 1 = (n + 1) + iK  ⇒ |N + 1|² = (n + 1)² + K²</pre>
          </div>

          <div class="callout final">
            <h4><span class="pill">Final result</span> Reflectance</h4>
            <div class="eqBlock" data-copy="final-R">
<pre>R(ω) = |r(ω)|²
     = ((n − 1)² + K²)/((n + 1)² + K²).</pre>
            </div>
            <div class="btnRow">
              <button class="copyBtn" data-copy-target="final-R">Copy R(ω)</button>
              <button class="copyBtn" data-copy-target="final-answer">Copy final answer (plain text)</button>
            </div>
            <div class="eqBlock" data-copy="final-answer" style="margin-top:10px;">
<pre>Final answer:
N = n + iK = √ε  (μ = 1)
r(ω) = (N − 1)/(N + 1) = (n + iK − 1)/(n + iK + 1)
R(ω) = |r(ω)|² = ((n − 1)² + K²)/((n + 1)² + K²)</pre>
            </div>
          </div>

          <h3>3.7 Sanity checks</h3>
          <div class="callouts">
            <div class="callout keyeq" style="grid-column: span 12;">
              <h4><span class="pill">Check</span> Dimensions</h4>
              <p>
                <code>r</code> and <code>R</code> are ratios of fields/powers, so dimensionless. <code>n</code>, <code>K</code>, and <code>ε</code> are dimensionless. The formulas are dimensionally consistent.
              </p>
            </div>

            <div class="callout keyeq" style="grid-column: span 12;">
              <h4><span class="pill">Check</span> Limiting cases</h4>
              <ul>
                <li><strong>Matched interface:</strong> <code>N → 1</code> ⇒ <code>r → 0</code>, <code>R → 0</code>.</li>
                <li><strong>Lossless dielectric:</strong> <code>K = 0</code> ⇒ <code>R = ((n−1)/(n+1))²</code> (standard Fresnel result).</li>
                <li><strong>High index:</strong> <code>n ≫ 1</code>, <code>K≈0</code> ⇒ <code>R ≈ 1 − 4/n + O(1/n²)</code>.</li>
                <li><strong>Strong absorber:</strong> <code>K ≫ n,1</code> ⇒ <code>R ≈ (K²)/(K²) → 1</code>.</li>
              </ul>
            </div>

            <div class="callout keyeq" style="grid-column: span 12;">
              <h4><span class="pill">Interpretation</span> Plain-language meaning</h4>
              <p>
                Reflection is controlled by how different the medium’s complex refractive index is from vacuum.
                The real part <code>n</code> changes the phase velocity (impedance mismatch), while the imaginary part <code>K</code> captures absorption and also contributes to mismatch.
              </p>
            </div>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </section>

        <section id="part4">
          <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

          <h3>4.1 Re-interpret the final formula</h3>
          <p>
            The reflectance
            <code>R = ((n − 1)² + K²)/((n + 1)² + K²)</code>
            can be read as “distance from vacuum” in the complex plane:
            numerator is the squared distance from <code>N</code> to <code>1</code>, denominator is the squared distance from <code>N</code> to <code>−1</code>.
            The closer <code>N</code> is to <code>1</code>, the smaller the reflection.
          </p>

          <h3>4.2 Parameter dependence (qualitative)</h3>
          <ul>
            <li><strong>Increase n (with K fixed):</strong> tends to increase reflection because impedance mismatch grows.</li>
            <li><strong>Increase K (with n fixed):</strong> adds mismatch and often increases reflection; in the large-<code>K</code> limit, <code>R → 1</code>.</li>
            <li><strong>Near n≈1:</strong> if <code>n</code> is close to 1 but <code>K</code> is not small, reflection can still be significant due to absorption.</li>
          </ul>

          <details>
            <summary>Small-mismatch asymptotics (useful in design)</summary>
            <p>
              Let <code>N = 1 + δ</code> where <code>|δ| ≪ 1</code> (weak mismatch).
              Then
              <code>r = (δ)/(2 + δ) ≈ δ/2 − δ²/4 + O(δ³)</code>.
              Hence
              <code>R = |r|² ≈ |δ|²/4</code> to leading order:
              <strong>reflectance scales quadratically</strong> with small index mismatch.
              This is why tiny refractive-index steps can already reduce reflection noticeably in graded-index coatings.
            </p>
          </details>

          <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
          <p>
            Instead of impedance, you can derive directly from the curl equations:
            write <code>E_y</code> waves and compute <code>(∇×E)_z = ∂E_y/∂x</code>, then use Faraday’s law to obtain <code>B_z</code> (or <code>H_z</code>)
            with the correct sign for each propagation direction. Applying continuity of <code>E_y</code> and <code>H_z</code> at <code>x=0</code> again gives the same linear system.
            This route emphasizes the operator identity <code>∇ → i k k̂</code> for plane-wave eigenfunctions.
          </p>

          <h3>4.4 Concept check (self-test with answers)</h3>
          <ul>
            <li><strong>Q:</strong> If the medium is identical to vacuum, what is <code>r</code>? <strong>A:</strong> <code>N=1</code> ⇒ <code>r=0</code>.</li>
            <li><strong>Q:</strong> Why can <code>ε</code> be complex? <strong>A:</strong> Material absorption/dispersion makes polarization lag the field; this appears as <code>Im(ε)&gt;0</code>, equivalently <code>K&gt;0</code>.</li>
            <li><strong>Q:</strong> Why is <code>R=|r|²</code>? <strong>A:</strong> At normal incidence in vacuum, time-averaged Poynting flux scales as <code>|E|²/Z0</code>, so power ratio is magnitude-squared of the field ratio.</li>
            <li><strong>Q:</strong> What changes if <code>μ≠1</code>? <strong>A:</strong> Replace <code>N=√(εμ)</code> and <code>Z=Z0√(μ/ε)</code>; the same impedance formula <code>r=(Z2−Z1)/(Z2+Z1)</code> still holds.</li>
          </ul>

          <a class="backTop" href="#top">Back to top ↑</a>
        </section>

        <section id="part5">
          <h2>PART 5 — Optional Plot Guide (ONLY IF A PLOT EXISTS)</h2>

          <p>
            A plot is helpful here because it makes the parameter dependence of
            <code>R = ((n − 1)² + K²)/((n + 1)² + K²)</code>
            visually obvious (especially how absorption <code>K</code> changes reflectance even at moderate <code>n</code>).
            The formula remains fully symbolic; the curves below use <strong>example values</strong> for illustration only.
          </p>

          <figure>
            <canvas id="plot" aria-label="Reflectance vs refractive index plot"></canvas>
            <figcaption>
              Static example plot of reflectance <code>R</code> vs <code>n</code> at normal incidence, for two example absorption values:
              <code>K=0</code> (lossless) and <code>K=0.5</code>. (Example only; your real material has frequency-dependent <code>n(ω), K(ω)</code>.)
            </figcaption>
          </figure>

          <h3>What the plot shows</h3>
          <ul>
            <li><strong>x-axis:</strong> real refractive index <code>n</code> (dimensionless)</li>
            <li><strong>y-axis:</strong> reflectance <code>R</code> (dimensionless, from 0 to 1)</li>
            <li><strong>Example values:</strong> one curve for <code>K=0</code>, one for <code>K=0.5</code></li>
            <li><strong>Features to notice:</strong>
              <ul>
                <li>At <code>n=1</code>, the lossless curve hits <code>R=0</code>; adding <code>K</code> lifts <code>R</code> above zero.</li>
                <li>As <code>n</code> grows, both curves rise toward strong reflection; absorption can increase reflection in many regimes.</li>
              </ul>
            </li>
          </ul>

          <a class="backTop" href="#top">Back to top ↑</a>
        </section>

        <footer>
          <p>
            Built as a self-contained learning article: Maxwell boundary conditions + impedance matching → Fresnel reflection at normal incidence.
          </p>
        </footer>
      </article>
    </div>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    // ---------- Copy buttons ----------
    function showToast(msg){
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.classList.add('show');
      clearTimeout(showToast._timer);
      showToast._timer = setTimeout(()=>t.classList.remove('show'), 1200);
    }

    function getCopyText(key){
      const el = document.querySelector('[data-copy="'+key+'"]');
      if(!el) return '';
      return el.innerText.replace(/\n+$/,'');
    }

    async function copyToClipboard(text){
      try{
        await navigator.clipboard.writeText(text);
        showToast('Copied!');
      }catch(e){
        // Fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        showToast('Copied!');
      }
    }

    document.querySelectorAll('button.copyBtn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const key = btn.getAttribute('data-copy-target');
        const text = getCopyText(key);
        if(text) copyToClipboard(text);
        else showToast('Nothing to copy.');
      });
    });

    // ---------- Plot (single static canvas) ----------
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    function R(n, K){
      const num = (n - 1)*(n - 1) + K*K;
      const den = (n + 1)*(n + 1) + K*K;
      return num / den;
    }

    function resizeCanvasToDPR(c){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = c.getBoundingClientRect();
      c.width = Math.round(rect.width * dpr);
      c.height = Math.round(rect.height * dpr);
      const ctx = c.getContext('2d');
      ctx.setTransform(dpr,0,0,dpr,0,0); // draw in CSS pixels
      return {w: rect.width, h: rect.height};
    }

    function drawPlot(){
      const {w, h} = resizeCanvasToDPR(canvas);
      ctx.clearRect(0,0,w,h);

      // Plot area
      const padL = 56, padR = 18, padT = 30, padB = 44;
      const x0 = padL, y0 = h - padB;
      const x1 = w - padR, y1 = padT;
      const pw = x1 - x0, ph = y0 - y1;

      // Axes ranges
      const nMin = 1.0, nMax = 5.0;
      const yMin = 0.0, yMax = 1.0;

      function xMap(n){ return x0 + (n - nMin)/(nMax - nMin) * pw; }
      function yMap(y){ return y0 - (y - yMin)/(yMax - yMin) * ph; }

      // Background
      ctx.fillStyle = 'rgba(0,0,0,0.18)';
      ctx.fillRect(x0, y1, pw, ph);

      // Gridlines
      ctx.lineWidth = 1;
      ctx.strokeStyle = 'rgba(255,255,255,0.10)';
      const xTicks = 8;
      const yTicks = 5;

      for(let i=0;i<=xTicks;i++){
        const n = nMin + (nMax-nMin)*i/xTicks;
        const x = xMap(n);
        ctx.beginPath();
        ctx.moveTo(x, y1);
        ctx.lineTo(x, y0);
        ctx.stroke();
      }
      for(let j=0;j<=yTicks;j++){
        const y = yMin + (yMax-yMin)*j/yTicks;
        const yy = yMap(y);
        ctx.beginPath();
        ctx.moveTo(x0, yy);
        ctx.lineTo(x1, yy);
        ctx.stroke();
      }

      // Axes
      ctx.strokeStyle = 'rgba(255,255,255,0.35)';
      ctx.lineWidth = 1.2;
      ctx.beginPath();
      ctx.moveTo(x0, y1);
      ctx.lineTo(x0, y0);
      ctx.lineTo(x1, y0);
      ctx.stroke();

      // Tick labels
      ctx.fillStyle = 'rgba(232,238,246,0.92)';
      ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'top';
      for(let i=0;i<=xTicks;i++){
        const n = nMin + (nMax-nMin)*i/xTicks;
        const x = xMap(n);
        ctx.fillText(n.toFixed(1), x, y0 + 8);
      }
      ctx.textAlign = 'right';
      ctx.textBaseline = 'middle';
      for(let j=0;j<=yTicks;j++){
        const y = yMin + (yMax-yMin)*j/yTicks;
        const yy = yMap(y);
        ctx.fillText(y.toFixed(1), x0 - 8, yy);
      }

      // Title
      ctx.textAlign = 'left';
      ctx.textBaseline = 'top';
      ctx.font = '14px ' + getComputedStyle(document.body).fontFamily;
      ctx.fillStyle = 'rgba(232,238,246,0.95)';
      ctx.fillText('Reflectance R vs n (example)', x0, 6);

      // Axis labels
      ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;
      ctx.fillStyle = 'rgba(183,196,214,0.95)';
      ctx.textAlign = 'center';
      ctx.fillText('n (dimensionless)', x0 + pw/2, h - 18);

      // y label (rotated)
      ctx.save();
      ctx.translate(16, y1 + ph/2);
      ctx.rotate(-Math.PI/2);
      ctx.textAlign = 'center';
      ctx.fillText('R (dimensionless)', 0, 0);
      ctx.restore();

      // Curves
      function drawCurve(K, style){
        ctx.strokeStyle = style;
        ctx.lineWidth = 2;
        ctx.beginPath();
        const N = 400;
        for(let i=0;i<=N;i++){
          const n = nMin + (nMax-nMin)*i/N;
          const y = R(n, K);
          const x = xMap(n);
          const yy = yMap(y);
          if(i===0) ctx.moveTo(x, yy);
          else ctx.lineTo(x, yy);
        }
        ctx.stroke();
      }

      // Colors: minimal but distinct; no external styling.
      drawCurve(0.0, 'rgba(102,227,255,0.95)');   // K=0
      drawCurve(0.5, 'rgba(166,255,122,0.95)');   // K=0.5

      // Legend
      const lx = x1 - 150, ly = y1 + 12;
      ctx.fillStyle = 'rgba(15,22,32,0.75)';
      ctx.strokeStyle = 'rgba(255,255,255,0.15)';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.roundRect ? ctx.roundRect(lx, ly, 140, 54, 10) : ctx.rect(lx, ly, 140, 54);
      ctx.fill();
      ctx.stroke();

      ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;
      ctx.textAlign = 'left';
      ctx.textBaseline = 'middle';

      ctx.strokeStyle = 'rgba(102,227,255,0.95)';
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(lx + 10, ly + 18);
      ctx.lineTo(lx + 34, ly + 18);
      ctx.stroke();
      ctx.fillStyle = 'rgba(232,238,246,0.92)';
      ctx.fillText('K = 0 (lossless)', lx + 42, ly + 18);

      ctx.strokeStyle = 'rgba(166,255,122,0.95)';
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(lx + 10, ly + 38);
      ctx.lineTo(lx + 34, ly + 38);
      ctx.stroke();
      ctx.fillStyle = 'rgba(232,238,246,0.92)';
      ctx.fillText('K = 0.5 (example)', lx + 42, ly + 38);
    }

    // Polyfill-ish for roundRect if missing (older browsers)
    if(!CanvasRenderingContext2D.prototype.roundRect){
      CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
        const rr = Math.min(r, w/2, h/2);
        this.beginPath();
        this.moveTo(x+rr, y);
        this.arcTo(x+w, y, x+w, y+h, rr);
        this.arcTo(x+w, y+h, x, y+h, rr);
        this.arcTo(x, y+h, x, y, rr);
        this.arcTo(x, y, x+w, y, rr);
        this.closePath();
        return this;
      };
    }

    window.addEventListener('resize', drawPlot);
    drawPlot();
  </script>
</body>
</html>