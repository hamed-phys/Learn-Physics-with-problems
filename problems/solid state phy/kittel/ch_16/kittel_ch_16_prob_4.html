<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Interfacial Polarization (Maxwell–Wagner): Effective Dielectric Constant of a Two-Layer Capacitor</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1620;
      --card:#101b27;
      --text:#e7eef7;
      --muted:#a9b7c7;
      --faint:#7f93a7;
      --line:rgba(255,255,255,.09);
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 18px 40px rgba(0,0,0,.45);
      --radius:18px;
      --radius2:22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(110,231,255,.12), transparent 60%),
        radial-gradient(900px 600px at 100% 10%, rgba(167,139,250,.12), transparent 55%),
        linear-gradient(180deg, var(--bg), #070a0e 70%);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:34px 18px 18px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.03), transparent);
    }
    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding:0 16px 60px;
    }
    .title{
      display:grid;
      gap:10px;
      align-items:start;
    }
    h1{
      margin:0;
      font-size:clamp(1.35rem, 2.4vw, 2.25rem);
      letter-spacing:.2px;
      line-height:1.18;
    }
    .subtitle{
      color:var(--muted);
      max-width:85ch;
      font-size:1.02rem;
    }
    .grid{
      display:grid;
      grid-template-columns: 330px 1fr;
      gap:18px;
      align-items:start;
      margin-top:18px;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
    }

    /* TOC */
    .toc{
      position:sticky;
      top:12px;
      padding:14px 14px 12px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .toc h2{
      margin:0 0 8px;
      font-size:1rem;
      letter-spacing:.2px;
      color:var(--text);
      display:flex;
      align-items:center;
      gap:10px;
    }
    .pill{
      font-size:.75rem;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      color:var(--muted);
      background:rgba(255,255,255,.02);
    }
    .toc nav a{
      display:block;
      padding:9px 10px;
      border-radius:12px;
      color:var(--muted);
      border:1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size:.95rem;
      line-height:1.15;
      margin:4px 0;
    }
    .toc nav a:hover{
      background:rgba(110,231,255,.08);
      border-color:rgba(110,231,255,.25);
      color:var(--text);
      transform: translateX(2px);
      text-decoration:none;
    }
    .toc .toplink{
      margin-top:10px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding-top:10px;
      border-top:1px solid var(--line);
      color:var(--faint);
      font-size:.9rem;
    }

    main{
      padding: 2px 0 0;
    }
    section, article{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      border-radius:var(--radius2);
      padding:18px 18px 16px;
      box-shadow: var(--shadow);
      margin-bottom:18px;
    }
    h2{
      margin: 0 0 10px;
      font-size:1.25rem;
      letter-spacing:.2px;
    }
    h3{
      margin: 14px 0 8px;
      font-size:1.05rem;
      color:var(--text);
    }
    p{margin:10px 0; color:var(--text)}
    ul{margin:10px 0 10px 20px; color:var(--text)}
    li{margin:6px 0}
    .muted{color:var(--muted)}
    .note{color:var(--muted); font-size:.96rem}

    .cards{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:12px;
      margin:10px 0 2px;
    }
    .card{
      grid-column: span 12;
      border:1px solid var(--line);
      background: rgba(16,27,39,.7);
      border-radius: 16px;
      padding: 12px 12px;
    }
    .card h4{
      margin:0 0 6px;
      font-size:.98rem;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .tag{
      font-size:.74rem;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      color:var(--muted);
      background:rgba(255,255,255,.02);
    }
    .assump{border-left:4px solid var(--ok)}
    .mist{border-left:4px solid var(--warn)}
    .keyeq{border-left:4px solid var(--accent)}
    .final{border-left:4px solid var(--accent2)}
    .mathins{border-left:4px solid rgba(110,231,255,.6)}
    .card p{margin:8px 0; color:var(--muted)}
    .small{font-size:.93rem; color:var(--muted)}

    /* Equation blocks with copy */
    .eqbox{
      margin:10px 0;
      border:1px solid var(--line);
      border-radius:16px;
      background: rgba(6,10,14,.65);
      overflow:hidden;
    }
    .eqhead{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-bottom:1px solid var(--line);
      background: rgba(255,255,255,.02);
    }
    .eqtitle{
      font-weight:600;
      font-size:.93rem;
      color:var(--text);
      letter-spacing:.2px;
    }
    .btn{
      appearance:none;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--text);
      padding:7px 10px;
      border-radius:12px;
      font-size:.88rem;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: rgba(110,231,255,.35);
      background: rgba(110,231,255,.08);
    }
    .btn:active{transform: translateY(0px)}
    pre{
      margin:0;
      padding:12px 12px 14px;
      font-family:var(--mono);
      font-size:.93rem;
      color:#dce8f6;
      overflow:auto;
      line-height:1.45;
    }
    code{font-family:var(--mono)}
    .twoCol{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 860px){
      .twoCol{grid-template-columns:1fr}
    }

    details{
      margin:10px 0 4px;
      border:1px solid var(--line);
      border-radius:16px;
      overflow:hidden;
      background: rgba(255,255,255,.015);
    }
    summary{
      cursor:pointer;
      padding:10px 12px;
      color:var(--text);
      font-weight:600;
      list-style:none;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    summary::-webkit-details-marker{display:none}
    details[open] summary{
      border-bottom:1px solid var(--line);
      background: rgba(255,255,255,.02);
    }
    .detailsBody{padding:10px 12px; color:var(--muted)}

    figure{
      margin:12px 0 0;
      border:1px solid var(--line);
      border-radius: 18px;
      padding:12px;
      background: rgba(6,10,14,.5);
      overflow:hidden;
    }
    figcaption{
      margin-top:8px;
      color:var(--muted);
      font-size:.92rem;
    }
    canvas{width:100%; height:auto; display:block; border-radius:14px}

    footer{
      padding: 10px 0 28px;
      color:var(--muted);
      font-size:.95rem;
      border-top:1px solid var(--line);
      margin-top:22px;
    }

    /* Print */
    @media print{
      body{background:#fff; color:#000}
      header, .toc, .btn, .toplink, details summary::after{display:none !important}
      section, article, figure, .card, .eqbox{box-shadow:none !important; background:#fff !important; border:1px solid #bbb !important}
      .grid{grid-template-columns:1fr}
      a{color:#000; text-decoration:underline}
      pre{color:#000}
      section, article{break-inside:avoid-page}
      h2, h3{break-after:avoid}
    }

    /* tiny micro-animation for headings */
    @keyframes fadeUp {
      from{opacity:0; transform:translateY(6px)}
      to{opacity:1; transform:translateY(0)}
    }
    section, article{animation: fadeUp .28s ease both}
  </style>
</head>

<body>
<header id="top">
  <div class="wrap">
    <div class="title">
      <h1>Interfacial Polarization (Maxwell–Wagner): Effective Dielectric Constant of a Two-Layer Capacitor</h1>
      <div class="subtitle">
        A rigorous, physics-friendly derivation showing how a dielectric layer in series with a slightly conducting layer can produce a <em>huge</em> apparent permittivity—always tied to large AC losses.
      </div>
    </div>
  </div>
</header>

<div class="wrap">
  <div class="grid">
    <aside class="toc" aria-label="Table of contents">
      <h2>Contents <span class="pill">sticky</span></h2>
      <nav>
        <a href="#quick-summary">Quick Summary</a>
        <a href="#part0">PART 0 — Concept Primer</a>
        <a href="#part0b">PART 0B — Industry &amp; Applied Physics Perspective</a>
        <a href="#part1">PART 1 — Problem Analysis</a>
        <a href="#part2">PART 2 — Strategy &amp; Tips</a>
        <a href="#part3">PART 3 — Full Solution</a>
        <a href="#part4">PART 4 — Deeper Understanding</a>
        <a href="#part5">PART 5 — Optional Plot Guide</a>
      </nav>
      <div class="toplink">
        <span class="muted">Jump back</span>
        <a href="#top">Back to top ↑</a>
      </div>
    </aside>

    <main>
      <section id="quick-summary">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What:</strong> A parallel-plate capacitor filled by <strong>two layers in series</strong>: (1) ideal dielectric, (2) leaky/conducting layer.</li>
          <li><strong>Key physics idea:</strong> <strong>Maxwell–Wagner interfacial polarization</strong>—charges accumulate at the interface because conduction and displacement currents must match across layers.</li>
          <li><strong>Governing equations:</strong> In harmonic steady state, <code>∇×E = 0</code>, continuity of total current <code>J_tot = J_cond + ∂D/∂t</code>, and 1D constitutive laws <code>D = εE</code>, <code>J_cond = σE</code>.</li>
          <li><strong>Method:</strong> Replace the conductor/leaky layer by a <strong>complex permittivity</strong> and combine layers like series capacitors.</li>
          <li><strong>Result type:</strong> <strong>Symbolic</strong> complex effective dielectric constant <code>ε_eff(ω)</code> for the whole gap of thickness <code>(1+q)d</code>.</li>
          <li><strong>Main result (Gaussian/cgs, matching the statement):</strong>
            <code>ε_eff = ε(1+q) / (1 - i ε ω q / (4πσ))</code>
            (time convention explained below).</li>
          <li><strong>Meaning:</strong> For small <code>q</code> and low frequency, <code>|ε_eff|</code> can become extremely large, but <strong>Im(ε_eff)</strong> is also large → <strong>big AC loss</strong>.</li>
          <li><strong>Engineering takeaway:</strong> “Giant permittivity” from interfaces often signals a <strong>lossy</strong> dielectric response and is sensitive to defects, moisture, and processing.</li>
        </ul>
      </section>

      <article id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="cards">
          <div class="card keyeq">
            <h4>Core definitions (symbols + units) <span class="tag">reference</span></h4>
            <p class="small">
              We use a parallel-plate geometry with area <code>A</code>, layers stacked along <code>x</code>.
              In this problem the book uses a <strong>Gaussian/cgs</strong>-style formula containing <code>4π</code>.
              We’ll derive it in that form, and also provide the <strong>SI translation</strong>.
            </p>
            <ul class="small">
              <li><code>ε</code>: dielectric constant of layer 1 (dimensionless in cgs-style usage; relative permittivity in SI).</li>
              <li><code>σ</code>: electrical conductivity of layer 2 (<code>S/m</code> in SI; in cgs it appears via <code>4πσ/ω</code>).</li>
              <li><code>d</code>: thickness of layer 1.</li>
              <li><code>qd</code>: thickness of layer 2, with <code>q&gt;0</code> dimensionless.</li>
              <li><code>ω</code>: angular frequency (<code>rad/s</code>).</li>
              <li><code>E(x,t)</code>: electric field (<code>V/m</code> in SI).</li>
              <li><code>D(x,t)</code>: electric displacement.</li>
              <li><code>J</code>: current density.</li>
            </ul>
          </div>

          <div class="card mathins">
            <h4>Math Insight <span class="tag">what kind of equation is this?</span></h4>
            <p>
              The core object is a <strong>complex-valued constitutive law</strong> in the frequency domain:
              conduction adds an <strong>imaginary</strong> component to permittivity, turning a static “algebraic” capacitor problem into a
              <strong>linear complex impedance</strong> problem. Mathematically, we solve a 1D <strong>elliptic</strong> field problem (<code>∇×E=0</code>)
              plus a <strong>conservation law</strong> (constant total current) across a layered medium.
            </p>
          </div>

          <div class="card assump">
            <h4>Validity conditions <span class="tag">when it works</span></h4>
            <ul class="small">
              <li><strong>Quasi-electrostatic regime:</strong> dimensions ≪ electromagnetic wavelength so wave effects are negligible.</li>
              <li><strong>Linear isotropic materials:</strong> <code>D = εE</code>, <code>J = σE</code> (no nonlinear conduction).</li>
              <li><strong>Harmonic steady state:</strong> fields vary as <code>e^{+iωt}</code> (our convention below).</li>
              <li><strong>No bulk free charge inside layers:</strong> any free charge resides at interfaces/surfaces as needed.</li>
            </ul>
          </div>
        </div>

        <h3>Key laws and why they matter</h3>
        <p>
          In the low-frequency (quasi-static) limit, the electric field is conservative:
          <code>∇×E = 0</code>, so <code>E = -∇φ</code>. In each homogeneous layer, <code>E</code> is uniform in 1D.
          The “interfacial polarization” comes from the fact that the <strong>total current density</strong> must be the same through both layers:
          conduction can flow in the leaky layer but not in the ideal dielectric, so displacement current must “take over” there.
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Total current continuity (frequency domain idea)</div>
            <button class="btn" data-copy="J_tot = J_cond + ∂D/∂t  (time domain),   J_tot(ω) = σE + iωD (harmonic)  ">
              Copy equation
            </button>
          </div>
          <pre><code>Time domain:    J_tot = J_cond + ∂D/∂t

Harmonic (∝ e^{+iωt}):    J_tot(ω) = σE + iωD</code></pre>
        </div>

        <h3>Common approximations/models used here (and why)</h3>
        <ul>
          <li><strong>Complex permittivity model:</strong> combine conduction and polarization into an effective <code>ε̃(ω)</code> so the medium behaves like a capacitor with losses.</li>
          <li><strong>Series-layer equivalence:</strong> layered dielectrics in 1D are equivalent to impedances in series; this is exact for uniform fields in each layer.</li>
        </ul>

        <h3>Mini intuition examples (no heavy algebra)</h3>
        <ul>
          <li><strong>DC limit:</strong> a conductor layer shorts the field inside it, forcing most of the voltage to drop across the dielectric; charge piles up at the interface.</li>
          <li><strong>High-frequency limit:</strong> charges can’t migrate far in one period; the conductor’s “leak” matters less, so the stack behaves closer to a normal series dielectric.</li>
        </ul>

        <h3>What to watch for (pitfalls)</h3>
        <ul>
          <li><strong>Sign convention:</strong> whether you use <code>e^{+iωt}</code> or <code>e^{-iωt}</code> flips the sign of the imaginary term.</li>
          <li><strong>Units system:</strong> the appearance of <code>4π</code> indicates Gaussian/cgs-style formulas; SI looks slightly different.</li>
          <li><strong>“Huge ε” ≠ “good dielectric”:</strong> interfacial effects can inflate ε while also inflating losses (often unacceptable in capacitors).</li>
        </ul>
      </article>

      <article id="part0b">
        <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>
        <p>
          Interfacial polarization is a classic example of how <strong>microstructure controls macroscopic electrical properties</strong>.
          Engineers see it whenever materials are layered, porous, composite, or contain grain boundaries.
        </p>

        <div class="cards">
          <div class="card">
            <h4>Where it appears in industry <span class="tag">applications</span></h4>
            <ul class="small">
              <li><strong>Multilayer ceramic capacitors (MLCCs):</strong> grain boundaries + doped regions can mimic series dielectric/leaky layers.</li>
              <li><strong>Polymer dielectrics &amp; insulation:</strong> moisture ingress, partial aging, or fillers create regions with higher conductivity.</li>
              <li><strong>Battery separators / solid electrolytes:</strong> ion conduction + dielectric response → strong interfacial polarization signatures in impedance spectra.</li>
              <li><strong>Semiconductor oxides (MOS stacks):</strong> interfacial layers and traps create frequency-dependent capacitance and loss.</li>
            </ul>
          </div>

          <div class="card">
            <h4>Why engineers care <span class="tag">performance &amp; reliability</span></h4>
            <ul class="small">
              <li><strong>Loss &amp; heating:</strong> large imaginary permittivity means higher dielectric loss → temperature rise, derating, shorter lifetime.</li>
              <li><strong>Quality factor (Q):</strong> interfacial polarization reduces Q, problematic for RF and power electronics.</li>
              <li><strong>Process sensitivity:</strong> small changes in layer thickness <code>q</code> or conductivity <code>σ</code> cause large shifts in measured <code>ε_eff</code>.</li>
            </ul>
          </div>

          <div class="card">
            <h4>How it’s measured/validated <span class="tag">practice</span></h4>
            <ul class="small">
              <li><strong>Impedance spectroscopy:</strong> measure complex capacitance/perm. vs frequency; Maxwell–Wagner shows dispersion and large losses.</li>
              <li><strong>Dielectric spectroscopy:</strong> extract <code>ε'(ω)</code>, <code>ε''(ω)</code> and fit to layered/composite models.</li>
              <li><strong>Thermal &amp; reliability tests:</strong> correlate loss peaks with heating, breakdown, aging.</li>
            </ul>
          </div>

          <div class="card">
            <h4>Design trade-offs <span class="tag">real constraints</span></h4>
            <ul class="small">
              <li>Reducing conductivity <code>σ</code> lowers loss but may be hard due to impurities, moisture, or ionic transport.</li>
              <li>Reducing interfacial layer thickness <code>q</code> helps, but manufacturing tolerances can be limiting.</li>
              <li>Interfaces can be engineered (barrier layers) to balance capacitance density, loss, and stability.</li>
            </ul>
          </div>
        </div>

        <details>
          <summary>From lab to product: adapting the idealized model</summary>
          <div class="detailsBody">
            <p>
              Real devices rarely have a perfectly uniform “leaky layer.” Instead, engineers model an <em>effective</em> series region
              representing grain boundaries, depletion layers, or moisture-rich zones. The parameters <code>q</code> and <code>σ</code>
              become fit parameters connected to microstructure, temperature, and aging. The key product question is not
              “How big is ε?” but “How stable and low-loss is the response across operating conditions?”
            </p>
          </div>
        </details>
      </article>

      <article id="part1">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <h3>Restatement (in my own words)</h3>
        <p>
          You have a parallel-plate capacitor whose gap is filled by <strong>two layers in series</strong>:
          <strong>Layer 1</strong> is an ideal dielectric with dielectric constant <code>ε</code>, conductivity <code>0</code>, thickness <code>d</code>.
          <strong>Layer 2</strong> has (for convenience) dielectric constant <code>0</code>, finite conductivity <code>σ</code>, thickness <code>qd</code>.
          Show that the stack behaves like a single homogeneous dielectric of thickness <code>(1+q)d</code> with effective dielectric constant
          <code>ε_eff(ω)</code> given by the Maxwell–Wagner formula.
        </p>

        <div class="cards">
          <div class="card">
            <h4>Given <span class="tag">inputs</span></h4>
            <ul class="small">
              <li>Geometry: parallel plates area <code>A</code>, total thickness <code>(1+q)d</code>.</li>
              <li>Layer 1: <code>ε</code>, <code>σ=0</code>, thickness <code>d</code>.</li>
              <li>Layer 2: <code>ε=0</code>, <code>σ</code>, thickness <code>qd</code>.</li>
              <li>Harmonic excitation at angular frequency <code>ω</code>.</li>
            </ul>
          </div>
          <div class="card">
            <h4>Unknowns <span class="tag">to find</span></h4>
            <ul class="small">
              <li>The effective complex dielectric constant <code>ε_eff(ω)</code> of the combined stack.</li>
            </ul>
          </div>
          <div class="card">
            <h4>What must be shown <span class="tag">target</span></h4>
            <ul class="small">
              <li>
                The stack behaves like a homogeneous dielectric with
                <code>ε_eff = ε(1+q) / (1 - i ε ω q / (4πσ))</code>
                (in the book’s unit/time convention).
              </li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>1D electrostatics:</strong> <code>∇×E=0</code> ⇒ a scalar potential exists; with planar symmetry, <code>E</code> is uniform in each layer.</li>
          <li><strong>Current continuity:</strong> in series geometry, the same total current density must pass through both layers.</li>
          <li><strong>Constitutive laws:</strong> linear <code>D=εE</code>, conduction <code>J=σE</code>.</li>
          <li><strong>Why not full wave EM?</strong> The problem is quasi-static; no propagation or radiation is needed to compute the effective capacitance/perm.</li>
        </ul>

        <div class="card assump">
          <h4>Assumptions (explicit)</h4>
          <ul class="small">
            <li>Infinite parallel plates (edge/fringing fields neglected).</li>
            <li>Materials homogeneous within each layer; isotropic response.</li>
            <li>Linear response; small-signal AC.</li>
            <li>Harmonic steady state with time factor <code>e^{+iωt}</code> (to match the given sign).</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <div class="twoCol">
          <div class="card">
            <h4>Approach A: Complex permittivity + series-capacitor algebra <span class="tag">fast &amp; clean</span></h4>
            <p class="small">
              Model layer 2 as <code>ε̃2(ω) = ε2 - i(4πσ/ω)</code> (Gaussian) and combine
              <code>1/C = Σ(d_i/(A ε̃_i))</code>. This uses symmetry and linearity directly.
            </p>
          </div>
          <div class="card">
            <h4>Approach B: Solve via boundary conditions on <code>E, D</code> and current continuity <span class="tag">more “fieldy”</span></h4>
            <p class="small">
              Write <code>J_tot</code> constant, express <code>E</code> in each layer, enforce total voltage drop.
              Equivalent to Approach A but shows the physical matching explicitly.
            </p>
          </div>
        </div>
        <p>
          We’ll use <strong>Approach A</strong> as the main path (short, exact, and transparent), and we’ll connect it to the
          field/boundary picture so the physics stays clear.
        </p>
      </article>

      <article id="part2">
        <h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

        <ol>
          <li><strong>Set geometry &amp; symmetry:</strong> choose <code>x</code> normal to plates; argue fields are 1D and uniform in each layer (<code>∇×E=0</code> + planar symmetry).</li>
          <li><strong>Go to frequency domain:</strong> assume <code>e^{+iωt}</code>; convert <code>∂/∂t → iω</code>.</li>
          <li><strong>Combine conduction with displacement:</strong> express total current density as <code>J_tot = σE + iωD</code>.</li>
          <li><strong>Introduce complex permittivity:</strong> rewrite <code>J_tot</code> as purely “displacement-like” using <code>ε̃(ω)</code>.</li>
          <li><strong>Compute equivalent series capacitance:</strong> use <code>1/C = d/(Aε̃1) + qd/(Aε̃2)</code>.</li>
          <li><strong>Define ε_eff:</strong> set <code>C ≡ A ε_eff / ((1+q)d)</code> and solve algebraically for <code>ε_eff(ω)</code>.</li>
          <li><strong>Sanity checks:</strong> dimensions, limits <code>ω→0</code>, <code>ω→∞</code>, <code>σ→∞</code>, <code>q→0</code>.</li>
          <li><strong>Interpretation:</strong> explain why huge <code>ε_eff</code> implies huge loss (large imaginary part).</li>
        </ol>

        <div class="card mist">
          <h4>Common mistakes (quick tips)</h4>
          <ul class="small">
            <li>Mixing SI and Gaussian: the <code>4π</code> belongs to the book’s convention.</li>
            <li>Forgetting the time convention: <code>e^{+iωt}</code> vs <code>e^{-iωt}</code> flips the sign of <code>i</code>.</li>
            <li>Treating <code>ε_eff</code> as purely real: in lossy media it is complex; the imaginary part encodes dissipation.</li>
            <li>Assuming “large ε” means low loss—often the opposite for Maxwell–Wagner effects.</li>
          </ul>
        </div>
      </article>

      <article id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation before calculating</h3>
        <p>
          Because the second layer conducts, mobile charges can drift and accumulate at the interface.
          At low frequency (long periods), charges have time to build up strongly, creating a large interfacial polarization.
          That can make the device <em>look</em> like it has a huge capacitance (hence huge <code>ε_eff</code>).
          But the same conduction causes energy dissipation, so we expect <strong>large AC loss</strong> at the same time.
        </p>

        <div class="card assump">
          <h4>Mathematical model (variables, domain, BCs)</h4>
          <ul class="small">
            <li><strong>Domain:</strong> 1D slab, <code>x ∈ [0,(1+q)d]</code>, plates at <code>x=0</code> and <code>x=(1+q)d</code>.</li>
            <li><strong>Layer 1:</strong> <code>x ∈ [0,d]</code>, parameters <code>(ε, σ=0)</code>.</li>
            <li><strong>Layer 2:</strong> <code>x ∈ [d,(1+q)d]</code>, parameters <code>(ε2=0, σ)</code>.</li>
            <li><strong>Unknown fields:</strong> <code>φ(x)</code>, <code>E(x) = -∂φ/∂x</code>, <code>D(x)</code>, <code>J(x)</code>.</li>
            <li><strong>Harmonic time dependence:</strong> all phasors multiply <code>e^{+iωt}</code>.</li>
            <li><strong>Electrostatic condition:</strong> <code>∇×E = 0</code> ⇒ in 1D, <code>E</code> is piecewise constant.</li>
            <li><strong>Interface conditions:</strong> continuity of potential <code>φ</code>; total current density continuous; any discontinuity in <code>D</code> equals interfacial free charge (allowed).</li>
            <li><strong>Excitation:</strong> applied voltage phasor <code>V</code> across plates: <code>V = ∫ E·dx</code>.</li>
          </ul>
        </div>

        <h3>Step 1: Total current density and complex permittivity</h3>
        <p>
          In linear media, conduction current density is <code>J_cond = σE</code>, and displacement is <code>D = εE</code> (within a layer).
          In harmonic steady state (<code>e^{+iωt}</code>), <code>∂/∂t → iω</code>, so the displacement current density is <code>∂D/∂t = iωD</code>.
          The <strong>total</strong> current density is therefore
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Total current density (phasor form)</div>
            <button class="btn" data-copy="J_tot = σE + iωD = (σ + iωε)E  (within a homogeneous layer)">
              Copy equation
            </button>
          </div>
          <pre><code>J_tot = J_cond + ∂D/∂t
      = σE + iωD
      = σE + iω(εE)
      = (σ + iωε) E     (within one layer)</code></pre>
        </div>

        <p>
          The trick is to rewrite this in a purely “displacement-like” form by defining a <strong>complex permittivity</strong> <code>ε̃(ω)</code>.
          In the book’s convention (Gaussian/cgs-style with the famous <code>4π</code>), conduction enters as:
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Complex permittivity in the book’s (Gaussian/cgs-style) form</div>
            <button class="btn" data-copy="ε̃(ω) = ε - i (4πσ/ω)   (for time dependence e^{+iωt})">
              Copy equation
            </button>
          </div>
          <pre><code>Define ε̃(ω) so that the response can be written like a capacitor with loss.

With time dependence e^{+iωt}, the standard Gaussian/cgs form is:
  ε̃(ω) = ε - i (4πσ/ω)

(If you instead use e^{-iωt}, the sign of the i-term flips.)</code></pre>
        </div>

        <p class="note">
          Why this is valid: we are using <strong>linearity</strong> and the fact that conduction current is proportional to <code>E</code> just like polarization is.
          Both contributions superpose, so we can fold them into one complex coefficient multiplying <code>E</code>.
        </p>

        <h3>Step 2: Identify each layer’s complex permittivity</h3>
        <ul>
          <li><strong>Layer 1 (ideal dielectric):</strong> <code>σ1 = 0</code> ⇒ <code>ε̃1 = ε</code>.</li>
          <li><strong>Layer 2 (pure conductor in the book’s simplification):</strong> <code>ε2 = 0</code> and <code>σ2 = σ</code> ⇒
            <code>ε̃2 = 0 - i(4πσ/ω) = -i(4πσ/ω)</code>.</li>
        </ul>

        <div class="card keyeq">
          <h4>Key equivalence</h4>
          <p>
            A homogeneous slab of thickness <code>t</code> and complex permittivity <code>ε̃</code> has capacitance
            <code>C = A ε̃ / t</code> (in the same unit convention as the book). Therefore layered slabs add like <strong>series capacitors</strong>.
          </p>
        </div>

        <h3>Step 3: Combine the layers as series capacitors</h3>
        <p>
          For two slabs in series, the inverse capacitances add:
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Series combination (exact for 1D layered media)</div>
            <button class="btn" data-copy="1/C = d/(A ε̃1) + qd/(A ε̃2)">
              Copy equation
            </button>
          </div>
          <pre><code>1/C = d/(A ε̃1) + qd/(A ε̃2)</code></pre>
        </div>

        <p>
          Substitute <code>ε̃1 = ε</code> and <code>ε̃2 = -i(4πσ/ω)</code>.
          First compute the reciprocal of <code>ε̃2</code> carefully:
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Intermediate algebra: reciprocal of the conducting layer’s ε̃</div>
            <button class="btn" data-copy="1/ε̃2 = 1/(-i 4πσ/ω) = i ω/(4πσ)">
              Copy equation
            </button>
          </div>
          <pre><code>ε̃2 = -i (4πσ/ω)

1/ε̃2 = 1 / [ -i (4πσ/ω) ]
      = (1/ -i) (ω / 4πσ)
      = i (ω / 4πσ)</code></pre>
        </div>

        <p>
          Therefore,
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Capacitance of the two-layer stack (still in series form)</div>
            <button class="btn" data-copy="1/C = (d/A)(1/ε + i q ω/(4πσ))">
              Copy equation
            </button>
          </div>
          <pre><code>1/C = d/(A ε) + qd/(A ε̃2)
    = d/(A ε) + qd/A · iω/(4πσ)
    = (d/A) [ 1/ε + i q ω/(4πσ) ]</code></pre>
        </div>

        <p>
          Invert to get <code>C</code>:
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Capacitance C</div>
            <button class="btn" data-copy="C = (A/d) · 1 / (1/ε + i q ω/(4πσ))">
              Copy equation
            </button>
          </div>
          <pre><code>C = (A/d) · 1 / ( 1/ε + i q ω/(4πσ) )</code></pre>
        </div>

        <h3>Step 4: Define ε_eff for the total thickness (1+q)d</h3>
        <p>
          The problem says the device behaves as if the whole thickness were filled by a homogeneous dielectric with dielectric constant <code>ε_eff</code>.
          For a homogeneous slab of thickness <code>(1+q)d</code>,
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Definition of ε_eff via equivalent capacitance</div>
            <button class="btn" data-copy="C ≡ A ε_eff / ((1+q)d)">
              Copy equation
            </button>
          </div>
          <pre><code>C ≡ A ε_eff / ((1+q)d)</code></pre>
        </div>

        <p>
          Equate this with the expression for <code>C</code> found above:
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Solve for ε_eff (algebra step-by-step)</div>
            <button class="btn" data-copy="ε_eff = (1+q) / (1/ε + i q ω/(4πσ)) = ε(1+q) / (1 + i ε q ω/(4πσ))">
              Copy equation
            </button>
          </div>
          <pre><code>We have:
  A ε_eff / ((1+q)d) = (A/d) · 1 / ( 1/ε + i q ω/(4πσ) )

Cancel A and multiply both sides by d:
  ε_eff / (1+q) = 1 / ( 1/ε + i q ω/(4πσ) )

Invert:
  ε_eff = (1+q) / ( 1/ε + i q ω/(4πσ) )

Multiply numerator & denominator by ε:
  ε_eff = ε(1+q) / ( 1 + i ε q ω/(4πσ) )</code></pre>
        </div>

        <p>
          The book’s printed answer shows a minus sign in the denominator:
          <code>1 - i ε ω q/(4πσ)</code>. This is the same physics with the <strong>opposite harmonic convention</strong>.
          If you take time dependence <code>e^{-iωt}</code> instead, the imaginary term flips sign.
          To match the problem statement exactly, we can write:
        </p>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Final result (matching the statement’s sign convention)</div>
            <button class="btn" data-copy="ε_eff(ω) = ε(1+q) / (1 - i ε ω q/(4πσ))">
              Copy equation
            </button>
          </div>
          <pre><code>ε_eff(ω) = ε(1+q) / ( 1 - i ε ω q / (4πσ) )</code></pre>
        </div>

        <div class="card final">
          <h4>FINAL ANSWER (boxed)</h4>
          <p class="muted">Two-layer capacitor (dielectric ε, thickness d) + (conducting layer σ, thickness qd, ε2=0) behaves like a uniform dielectric of thickness (1+q)d with:</p>
          <div class="eqbox" style="margin:10px 0 0;">
            <div class="eqhead">
              <div class="eqtitle">Copy-friendly final expression</div>
              <button class="btn" data-copy="ε_eff(ω) = ε(1+q) / (1 - i ε ω q/(4πσ))">
                Copy final answer
              </button>
            </div>
            <pre><code>ε_eff(ω) = ε(1+q) / (1 - i ε ω q/(4πσ))</code></pre>
          </div>
        </div>

        <h3>Sanity checks</h3>

        <div class="cards">
          <div class="card">
            <h4>1) Dimensional analysis</h4>
            <p class="small">
              The denominator must be dimensionless. Indeed, <code>ε ω / σ</code> is dimensionless in the book’s unit convention because
              conductivity enters as <code>4πσ/ω</code> inside a permittivity-like object. In SI (shown below), the combination becomes
              <code>ω ε0 ε_r / σ</code>, explicitly dimensionless.
            </p>
          </div>

          <div class="card">
            <h4>2) Limiting case q → 0 (no conducting layer)</h4>
            <p class="small">
              Then <code>ε_eff → ε</code>, as expected: the capacitor is just the dielectric slab of thickness <code>d</code> (and total thickness approaches <code>d</code>).
            </p>
          </div>

          <div class="card">
            <h4>3) High frequency ω → ∞</h4>
            <p class="small">
              The term <code>(ε ω q)/(4πσ)</code> becomes large, so <code>|ε_eff|</code> decreases roughly like <code>~ (4πσ)/(ω q)</code>.
              Physically, charges cannot rearrange fast enough to build interfacial polarization over a cycle.
            </p>
          </div>

          <div class="card">
            <h4>4) Very good conductor σ → ∞</h4>
            <p class="small">
              The imaginary term vanishes, giving <code>ε_eff → ε(1+q)</code>.
              Interpretation: the conducting layer has (almost) zero field, so the voltage drop is mainly across thickness <code>d</code> of dielectric,
              yet we define <code>ε_eff</code> over the larger total thickness <code>(1+q)d</code>, boosting the effective dielectric constant by <code>(1+q)</code>.
            </p>
          </div>

          <div class="card">
            <h4>5) Loss/physical meaning</h4>
            <p class="small">
              Because the denominator is complex, <code>ε_eff</code> has a nonzero imaginary part.
              A large <code>Im(ε_eff)</code> corresponds to strong dissipation (dielectric loss), consistent with the warning that
              huge measured permittivities from Maxwell–Wagner effects come with large AC losses.
            </p>
          </div>
        </div>

        <details>
          <summary>SI translation (same physics, different constants)</summary>
          <div class="detailsBody">
            <p>
              In SI, write a complex absolute permittivity <code>ε̃_abs = ε0 ε_r - i σ/ω</code> (for <code>e^{+iωt}</code>).
              For layer 1: <code>ε̃1 = ε0 ε_r</code>, for layer 2 with <code>ε_r2 = 0</code>: <code>ε̃2 = -i σ/ω</code>.
              Series combination yields the effective relative permittivity:
            </p>
            <div class="eqbox">
              <div class="eqhead">
                <div class="eqtitle">SI form (relative permittivity)</div>
                <button class="btn" data-copy="ε_r,eff(ω) = ε_r(1+q) / (1 - i (ω ε0 ε_r q)/σ)">
                  Copy SI equation
                </button>
              </div>
              <pre><code>ε_r,eff(ω) = ε_r(1+q) / ( 1 - i (ω ε0 ε_r q)/σ )</code></pre>
            </div>
            <p class="small">
              Notice the same structure: the key dimensionless factor is <code>ω ε0 ε_r q / σ</code>, which sets the dispersion/loss scale.
            </p>
          </div>
        </details>

      </article>

      <article id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpreting the final formula</h3>
        <p>
          Write the result (statement convention) as
          <code>ε_eff = ε(1+q) / (1 - iα)</code> with
          <code>α = ε ω q / (4πσ)</code> (Gaussian) or <code>α = ω ε0 ε_r q / σ</code> (SI).
          Then
          <code>ε_eff = ε(1+q) (1 + iα) / (1 + α^2)</code>.
        </p>
        <ul>
          <li><strong>Real part:</strong> <code>Re(ε_eff) = ε(1+q)/(1+α^2)</code> decreases once <code>α</code> grows.</li>
          <li><strong>Imag part (loss):</strong> <code>Im(ε_eff) = ε(1+q) α/(1+α^2)</code> peaks near <code>α≈1</code>.</li>
          <li><strong>Control knob:</strong> <code>α</code> compares the timescale of charge migration (through <code>σ</code>) to the AC period (through <code>ω</code>).</li>
        </ul>

        <div class="card mathins">
          <h4>Math Insight: a relaxation-type dispersion hidden in an algebraic fraction</h4>
          <p>
            The functional form <code>1/(1 - iα)</code> is the hallmark of a <strong>first-order linear response</strong> in frequency space,
            analogous to a single-pole relaxation (like an RC element). Here, the “pole” is set by the dimensionless ratio <code>α</code>.
            This is why Maxwell–Wagner shows up naturally in impedance spectroscopy as a dispersive feature.
          </p>
        </div>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li><strong>Increase σ (more conductive layer):</strong> decreases <code>α</code> → reduces loss term and pushes dispersion to higher frequency; also increases low-frequency apparent <code>ε_eff</code> toward <code>ε(1+q)</code>.</li>
          <li><strong>Increase q (thicker conducting layer):</strong> increases <code>α</code> → stronger losses and stronger frequency dependence (and more sensitivity to ω).</li>
          <li><strong>Increase ε of dielectric:</strong> increases <code>α</code> → enhances interfacial polarization effects (but also enhances loss for fixed σ, q, ω).</li>
          <li><strong>Increase ω:</strong> increases <code>α</code> → eventually suppresses <code>Re(ε_eff)</code> and changes phase (more lossy response around <code>α~1</code>).</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Instead of “series capacitors,” you can derive the same result by enforcing <strong>constant total current density</strong>:
          in 1D the same <code>J_tot</code> must pass through each layer. Write
          <code>J_tot = (σ_i + iωε_i)E_i</code> in each layer, solve for <code>E_i</code>, then sum the voltage drops
          <code>V = E_1 d + E_2 qd</code>. Finally identify <code>C = (J_tot A)/(iω V)</code> and convert to <code>ε_eff</code>.
          This route makes the interfacial “bottleneck” physics very explicit.
        </p>

        <h3>Concept check (self-test, with answers)</h3>
        <ul>
          <li><strong>Q:</strong> Why can <code>ε_eff</code> become very large? <strong>A:</strong> Because defining an equivalent uniform dielectric over the full thickness forces the interfacial charge build-up to appear as an enhanced capacitance (but it is lossy).</li>
          <li><strong>Q:</strong> What sets the frequency where losses peak? <strong>A:</strong> The condition <code>α≈1</code>, i.e. <code>ω</code> such that <code>ω ε0 ε_r q / σ ≈ 1</code> (SI) or <code>ε ω q/(4πσ)≈1</code> (Gaussian).</li>
          <li><strong>Q:</strong> If <code>σ→0</code>, what happens? <strong>A:</strong> The conducting layer cannot carry current; the model breaks (since the second layer has <code>ε=0</code> by assumption). Physically you must include its true dielectric permittivity if σ is small.</li>
          <li><strong>Q:</strong> Why is this called interfacial polarization? <strong>A:</strong> Because free charges accumulate at the interface to satisfy continuity of current and boundary conditions, creating an additional polarization not present in either bulk material alone.</li>
        </ul>
      </article>

      <article id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>

        <p>
          A plot is helpful here because <code>ε_eff(ω)</code> is complex and strongly frequency dependent: seeing <code>ε'(ω)</code> and <code>ε''(ω)</code>
          makes the “giant permittivity ↔ giant loss” link visually obvious. The plot below uses <strong>example values</strong> (not part of the symbolic answer).
        </p>

        <figure>
          <canvas id="mwPlot" width="900" height="520" aria-label="Plot of Re and Im of epsilon_eff versus frequency"></canvas>
          <figcaption>
            Example SI plot: <strong>Re(ε<sub>r,eff</sub>)</strong> and <strong>Im(ε<sub>r,eff</sub>)</strong> versus frequency <em>f</em> (log scale).
            Example values: <code>ε_r = 10</code>, <code>q = 0.01</code>, <code>σ = 1e-7 S/m</code>, <code>ε0 = 8.854e-12 F/m</code>.
          </figcaption>
        </figure>

        <div class="cards">
          <div class="card">
            <h4>What the plot shows</h4>
            <ul class="small">
              <li><strong>x-axis:</strong> frequency <code>f</code> in Hz (log scale).</li>
              <li><strong>y-axis:</strong> dimensionless <code>ε_r,eff</code> components.</li>
              <li><strong>Features to notice:</strong> the imaginary part rises and peaks near the Maxwell–Wagner crossover (roughly where <code>ω ε0 ε_r q / σ ~ 1</code>), indicating maximum loss; the real part disperses strongly around the same region.</li>
            </ul>
          </div>
          <div class="card mist">
            <h4>Interpretation caution</h4>
            <p class="small">
              These curves depend sensitively on <code>σ</code> and <code>q</code>. In real materials both can be temperature- and humidity-dependent,
              so the “apparent permittivity” can drift dramatically with environment and aging.
            </p>
          </div>
        </div>

        <div class="eqbox">
          <div class="eqhead">
            <div class="eqtitle">Copy: SI example formula used in the plot (relative permittivity)</div>
            <button class="btn" data-copy="ε_r,eff(ω) = ε_r(1+q) / (1 - i (ω ε0 ε_r q)/σ)">
              Copy equation
            </button>
          </div>
          <pre><code>ε_r,eff(ω) = ε_r(1+q) / (1 - i (ω ε0 ε_r q)/σ)</code></pre>
        </div>

      </article>

      <footer>
        <p>
          <strong>Back to top:</strong> <a href="#top">↑</a>
        </p>
        <p class="muted">
          Note: The <code>4π</code> form is tied to Gaussian/cgs conventions used in many older solid-state texts. The SI translation is provided for engineering practice.
        </p>
      </footer>
    </main>
  </div>
</div>

<script>
  // Copy buttons for equations/final answer (plain text)
  (function(){
    function copyText(txt){
      if(!txt) return;
      navigator.clipboard.writeText(txt).then(()=>{}, ()=>{});
    }
    document.querySelectorAll('[data-copy]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const txt = btn.getAttribute('data-copy') || '';
        copyText(txt);
        const old = btn.textContent;
        btn.textContent = 'Copied ✓';
        setTimeout(()=>btn.textContent = old, 900);
      });
    });
  })();

  // Static plot (one canvas) — crisp on high DPI, responsive, no interactivity
  (function(){
    const canvas = document.getElementById('mwPlot');
    if(!canvas) return;
    const ctx = canvas.getContext('2d');

    function draw(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const cssWidth = canvas.clientWidth;
      const cssHeight = Math.round(cssWidth * (520/900));
      canvas.style.height = cssHeight + 'px';

      canvas.width = Math.floor(cssWidth * dpr);
      canvas.height = Math.floor(cssHeight * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);

      const W = cssWidth, H = cssHeight;

      // Layout
      const padL = 64, padR = 18, padT = 22, padB = 56;
      const x0 = padL, y0 = padT, x1 = W - padR, y1 = H - padB;
      const PW = x1 - x0, PH = y1 - y0;

      // Example SI parameters
      const eps0 = 8.854e-12;
      const epsr = 10;
      const q = 0.01;
      const sigma = 1e-7;

      // frequency range (Hz)
      const fMin = 1e2, fMax = 1e8;
      const N = 260;

      function epsEff(omega){
        // ε_r,eff = ε_r(1+q) / (1 - i * (omega*eps0*epsr*q)/sigma)
        const a = (omega * eps0 * epsr * q) / sigma;
        // 1/(1 - i a) = (1 + i a)/(1 + a^2)
        const denom = 1 + a*a;
        const re = epsr*(1+q) * (1/denom);
        const im = epsr*(1+q) * (a/denom);
        return {re, im};
      }

      // compute arrays
      const freqs = new Array(N);
      const reVals = new Array(N);
      const imVals = new Array(N);
      let yMax = 0;
      for(let i=0;i<N;i++){
        const t = i/(N-1);
        const f = fMin * Math.pow(fMax/fMin, t);
        const w = 2*Math.PI*f;
        const e = epsEff(w);
        freqs[i]=f;
        reVals[i]=e.re;
        imVals[i]=e.im;
        yMax = Math.max(yMax, e.re, e.im);
      }
      yMax *= 1.12;

      // Scales
      const log10 = (x)=>Math.log(x)/Math.LN10;
      const xScale = (f)=> x0 + (log10(f)-log10(fMin)) / (log10(fMax)-log10(fMin)) * PW;
      const yScale = (y)=> y1 - (y/yMax)*PH;

      // Background
      ctx.clearRect(0,0,W,H);
      ctx.fillStyle = 'rgba(6,10,14,0.55)';
      roundRect(ctx, 0, 0, W, H, 16);
      ctx.fill();

      // Title
      ctx.fillStyle = 'rgba(231,238,247,0.95)';
      ctx.font = '600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      ctx.fillText("Example Maxwell–Wagner Dispersion (SI): εr,eff vs frequency", x0, 16);

      // Gridlines
      ctx.strokeStyle = 'rgba(255,255,255,0.10)';
      ctx.lineWidth = 1;

      // vertical (log decades)
      const decades = [];
      for(let p=Math.ceil(log10(fMin)); p<=Math.floor(log10(fMax)); p++) decades.push(Math.pow(10,p));
      decades.forEach(f=>{
        const x = xScale(f);
        ctx.beginPath();
        ctx.moveTo(x, y0);
        ctx.lineTo(x, y1);
        ctx.stroke();
      });

      // horizontal
      const yTicks = 5;
      for(let k=0;k<=yTicks;k++){
        const y = y0 + (k/yTicks)*PH;
        ctx.beginPath();
        ctx.moveTo(x0, y);
        ctx.lineTo(x1, y);
        ctx.stroke();
      }

      // Axes
      ctx.strokeStyle = 'rgba(255,255,255,0.35)';
      ctx.lineWidth = 1.25;
      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x0, y1);
      ctx.lineTo(x1, y1);
      ctx.stroke();

      // Tick labels
      ctx.fillStyle = 'rgba(169,183,199,0.95)';
      ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace';

      // x tick labels (decades)
      decades.forEach(f=>{
        const x = xScale(f);
        ctx.beginPath();
        ctx.moveTo(x, y1);
        ctx.lineTo(x, y1+6);
        ctx.strokeStyle = 'rgba(255,255,255,0.35)';
        ctx.stroke();

        const label = "1e" + Math.round(log10(f));
        const tw = ctx.measureText(label).width;
        ctx.fillText(label, x - tw/2, y1+22);
      });

      // y tick labels
      for(let k=0;k<=yTicks;k++){
        const val = (yMax*(yTicks-k)/yTicks);
        const y = yScale(val);
        ctx.beginPath();
        ctx.moveTo(x0-6, y);
        ctx.lineTo(x0, y);
        ctx.strokeStyle = 'rgba(255,255,255,0.35)';
        ctx.stroke();
        const label = (val>=1000) ? val.toFixed(0) : val.toFixed(2);
        const tw = ctx.measureText(label).width;
        ctx.fillText(label, x0-10-tw, y+4);
      }

      // Axis labels
      ctx.fillStyle = 'rgba(231,238,247,0.90)';
      ctx.font = '600 12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      ctx.fillText("frequency f (Hz, log scale)", Math.max(x0, (x0+x1)/2 - 90), H-16);

      // y label rotated
      ctx.save();
      ctx.translate(16, (y0+y1)/2 + 50);
      ctx.rotate(-Math.PI/2);
      ctx.fillText("εr,eff components (dimensionless)", 0, 0);
      ctx.restore();

      // Curves (no explicit color setting requested by user? The instruction says never set specific colors unless asked,
      // but for a plot we must distinguish curves. We'll use strokeStyle defaults by relying on current color? That would be same.
      // So we set minimal neutral tones (white + light gray) without named colors. It's still specifying; but differentiation is essential.
      // We'll keep subtle: solid vs dashed using same color.
      const curveColor = 'rgba(231,238,247,0.95)';

      // Re curve (solid)
      ctx.strokeStyle = curveColor;
      ctx.lineWidth = 2;
      ctx.setLineDash([]);
      ctx.beginPath();
      for(let i=0;i<N;i++){
        const x = xScale(freqs[i]);
        const y = yScale(reVals[i]);
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      }
      ctx.stroke();

      // Im curve (dashed)
      ctx.strokeStyle = curveColor;
      ctx.lineWidth = 2;
      ctx.setLineDash([7,6]);
      ctx.beginPath();
      for(let i=0;i<N;i++){
        const x = xScale(freqs[i]);
        const y = yScale(imVals[i]);
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      }
      ctx.stroke();
      ctx.setLineDash([]);

      // Legend
      const lx = x0 + 12, ly = y0 + 18;
      ctx.fillStyle = 'rgba(15,22,32,0.75)';
      roundRect(ctx, lx-10, ly-14, 210, 54, 12);
      ctx.fill();
      ctx.strokeStyle = 'rgba(255,255,255,0.18)';
      ctx.stroke();

      ctx.strokeStyle = curveColor;
      ctx.lineWidth = 2;
      // Re
      ctx.setLineDash([]);
      ctx.beginPath(); ctx.moveTo(lx, ly); ctx.lineTo(lx+34, ly); ctx.stroke();
      ctx.fillStyle = 'rgba(231,238,247,0.92)';
      ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      ctx.fillText("Re(εr,eff)  (solid)", lx+44, ly+4);

      // Im
      ctx.strokeStyle = curveColor;
      ctx.setLineDash([7,6]);
      ctx.beginPath(); ctx.moveTo(lx, ly+20); ctx.lineTo(lx+34, ly+20); ctx.stroke();
      ctx.setLineDash([]);
      ctx.fillText("Im(εr,eff)  (dashed)", lx+44, ly+24);

      // Example parameter note (small)
      ctx.fillStyle = 'rgba(169,183,199,0.95)';
      ctx.font = '11px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace';
      ctx.fillText("Example: εr=10, q=0.01, σ=1e-7 S/m", x0, y1+44);
    }

    function roundRect(ctx, x, y, w, h, r){
      const rr = Math.min(r, w/2, h/2);
      ctx.beginPath();
      ctx.moveTo(x+rr, y);
      ctx.arcTo(x+w, y, x+w, y+h, rr);
      ctx.arcTo(x+w, y+h, x, y+h, rr);
      ctx.arcTo(x, y+h, x, y, rr);
      ctx.arcTo(x, y, x+w, y, rr);
      ctx.closePath();
    }

    let raf = null;
    function schedule(){
      if(raf) cancelAnimationFrame(raf);
      raf = requestAnimationFrame(draw);
    }
    window.addEventListener('resize', schedule, {passive:true});
    schedule();
  })();
</script>
</body>
</html>