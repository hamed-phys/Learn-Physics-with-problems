<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Landau Theory: Dielectric Constant Below the Transition Temperature (Second-Order Ferroelectric)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#101823;
      --panel2:#0f1620;
      --text:#e9eef6;
      --muted:#b7c3d6;
      --faint:#7f90aa;
      --accent:#7dd3fc;
      --accent2:#a7f3d0;
      --warn:#fbbf24;
      --bad:#fb7185;
      --good:#86efac;
      --line:rgba(255,255,255,.10);
      --shadow: 0 18px 40px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --radius: 18px;
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8fc;
        --panel:#ffffff;
        --panel2:#f1f5fb;
        --text:#0b1220;
        --muted:#334155;
        --faint:#64748b;
        --line:rgba(2,6,23,.12);
        --shadow: 0 14px 32px rgba(2,6,23,.10);
      }
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1100px 700px at 18% -10%, rgba(125,211,252,.18), transparent 55%),
        radial-gradient(900px 600px at 88% 10%, rgba(167,243,208,.14), transparent 55%),
        var(--bg);
      line-height:1.55;
    }

    header{
      padding: clamp(18px, 3.2vw, 34px) 18px 14px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
      position:relative;
      overflow:hidden;
    }
    header::after{
      content:"";
      position:absolute; inset:-2px -2px auto -2px;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(125,211,252,.7), rgba(167,243,208,.55), transparent);
      opacity:.7;
      filter: blur(.2px);
    }

    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 0 18px 64px;
    }

    .title{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
    }
    h1{
      margin:0;
      font-size: clamp(22px, 2.5vw, 34px);
      letter-spacing: .2px;
      line-height:1.15;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      font-size: 15px;
      max-width: 85ch;
    }

    .layout{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
      margin-top: 18px;
    }

    nav{
      position: sticky;
      top: 14px;
      align-self:start;
      background: color-mix(in oklab, var(--panel) 92%, transparent);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 12px;
      backdrop-filter: blur(8px);
    }
    nav h2{
      margin:0 0 10px;
      font-size: 13px;
      color: var(--muted);
      letter-spacing: .12em;
      text-transform: uppercase;
    }
    .toc{
      margin:0;
      padding:0;
      list-style:none;
      display:grid;
      gap:8px;
    }
    .toc a{
      text-decoration:none;
      color: var(--text);
      font-size: 14px;
      display:block;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }
    .toc a:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.22);
      transform: translateY(-1px);
    }
    .toc small{
      color: var(--faint);
      display:block;
      font-size: 12px;
      margin-top:2px;
    }

    main{
      min-width:0;
      display:grid;
      gap: 16px;
    }

    section, article{
      background: color-mix(in oklab, var(--panel) 94%, transparent);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: clamp(14px, 2.2vw, 22px);
      overflow:hidden;
    }

    h2{
      margin: 0 0 10px;
      font-size: 20px;
      line-height:1.25;
    }
    h3{
      margin: 18px 0 8px;
      font-size: 16px;
      line-height:1.3;
      color: color-mix(in oklab, var(--text) 92%, var(--accent) 8%);
    }
    p{margin: 8px 0}
    ul,ol{margin: 8px 0 8px 18px}
    li{margin: 6px 0}
    .muted{color: var(--muted)}
    .tiny{color: var(--faint); font-size: 12px}

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns: 1fr}
      nav{position:relative; top:auto}
      .grid2{grid-template-columns: 1fr}
    }

    .callouts{
      display:grid;
      gap: 12px;
      margin-top: 10px;
    }
    .callout{
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 12px 12px 10px;
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .callout .label{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size: 12px;
      letter-spacing:.12em;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 6px;
    }
    .dot{
      width:9px; height:9px; border-radius:99px;
      background: var(--accent);
      box-shadow: 0 0 0 4px rgba(125,211,252,.16);
    }
    .dot.warn{background: var(--warn); box-shadow: 0 0 0 4px rgba(251,191,36,.16)}
    .dot.bad{background: var(--bad); box-shadow: 0 0 0 4px rgba(251,113,133,.16)}
    .dot.good{background: var(--good); box-shadow: 0 0 0 4px rgba(134,239,172,.16)}

    .eqbox{
      border: 1px dashed rgba(125,211,252,.35);
      background: rgba(125,211,252,.06);
      border-radius: 16px;
      padding: 10px;
      margin: 10px 0;
      position:relative;
    }
    pre.eq{
      margin:0;
      padding: 10px 10px 8px;
      font-family: var(--mono);
      font-size: 13px;
      white-space: pre-wrap;
      overflow-wrap:anywhere;
      color: color-mix(in oklab, var(--text) 92%, white 8%);
      line-height:1.45;
    }
    .copyrow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:8px;
    }
    button.copy{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      font-size: 13px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.25);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      font-size: 12px;
      color: var(--muted);
    }

    details{
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 10px 12px;
      background: rgba(255,255,255,.02);
      margin: 10px 0 0;
    }
    summary{
      cursor:pointer;
      font-weight: 650;
      color: color-mix(in oklab, var(--text) 92%, var(--accent) 8%);
      outline:none;
    }
    details[open]{
      background: rgba(167,243,208,.05);
      border-color: rgba(167,243,208,.22);
      transition: background .15s ease, border-color .15s ease;
    }

    figure{
      margin: 12px 0 0;
      padding: 12px;
      border:1px solid var(--line);
      border-radius: 18px;
      background: rgba(255,255,255,.02);
    }
    figcaption{
      margin-top: 8px;
      color: var(--muted);
      font-size: 13px;
    }
    canvas{width:100%; height:auto; display:block}

    .backtop{
      display:inline-block;
      margin-top: 10px;
      text-decoration:none;
      color: var(--accent);
      border: 1px solid rgba(125,211,252,.25);
      padding: 8px 10px;
      border-radius: 12px;
      transition: transform .12s ease, background .12s ease;
      background: rgba(125,211,252,.06);
    }
    .backtop:hover{transform: translateY(-1px); background: rgba(125,211,252,.10)}

    footer{
      padding: 18px;
      color: var(--faint);
      text-align:center;
    }

    /* Print-friendly */
    @media print{
      nav{display:none}
      body{background:#fff}
      section, article{box-shadow:none}
      .backtop{display:none}
      a{color:#000; text-decoration:underline}
      .eqbox{background:#fff}
      header{border-bottom:1px solid #bbb}
      section, article{page-break-inside:avoid}
      h2, h3{page-break-after:avoid}
    }
  </style>
</head>

<body>
<header id="top">
  <div class="wrap">
    <div class="title">
      <h1>Dielectric Constant Below the Transition Temperature (Landau Theory, 2nd Order)</h1>
      <p class="subtitle">
        We derive the dielectric response of a ferroelectric below <span class="pill">T&lt;T<sub>c</sub></span> using the Landau free-energy expansion,
        showing that the susceptibility doubles its slope relative to the paraelectric side and the dielectric constant diverges as
        <span class="pill">1/(T<sub>c</sub>−T)</span>.
      </p>
    </div>
  </div>
</header>

<div class="wrap layout">
  <nav aria-label="Table of Contents">
    <h2>On this page</h2>
    <ul class="toc">
      <li><a href="#qs">Quick Summary<small>Key idea + result</small></a></li>
      <li><a href="#part0">PART 0 — Concept Primer<small>Landau ferroelectrics refresher</small></a></li>
      <li><a href="#part0b">PART 0B — Industry Perspective<small>Why engineers care</small></a></li>
      <li><a href="#part1">PART 1 — Problem Analysis<small>Given/unknowns/assumptions</small></a></li>
      <li><a href="#part2">PART 2 — Strategy &amp; Tips<small>Roadmap + common mistakes</small></a></li>
      <li><a href="#part3">PART 3 — Full Solution<small>Step-by-step derivation</small></a></li>
      <li><a href="#part4">PART 4 — Deeper Understanding<small>Interpretation + self-test</small></a></li>
      <li><a href="#part5">PART 5 — Optional Plot Guide<small>What the curve means</small></a></li>
    </ul>
  </nav>

  <main>
    <section id="qs">
      <h2>Quick Summary</h2>
      <ul>
        <li><strong>What this is about:</strong> dielectric constant (permittivity) of a ferroelectric <em>below</em> its second-order transition temperature.</li>
        <li><strong>Key physics idea:</strong> Landau free energy with an order parameter polarization <strong>P</strong>; response found by minimizing free energy in a weak applied field <strong>E</strong>.</li>
        <li><strong>Governing relation (equation of state):</strong> <span class="pill">E = ∂f/∂P</span> from the Landau free-energy density <span class="pill">f(P,T)</span>.</li>
        <li><strong>Main mathematical move:</strong> linearize the nonlinear equation of state around the spontaneous polarization <span class="pill">P<sub>0</sub>(T)</span> for <span class="pill">T&lt;T<sub>c</sub></span>.</li>
        <li><strong>Susceptibility result (symbolic):</strong> <span class="pill">χ = (∂P/∂E)<sub>E→0</sub> = 1/[2γ(T<sub>c</sub>−T)]</span>.</li>
        <li><strong>Dielectric constant (cgs form used in many texts):</strong>
          <span class="pill">ε = 1 + 4πχ = 1 + 2π/[γ(T<sub>c</sub>−T)]</span>.
        </li>
        <li><strong>Physical meaning:</strong> as <span class="pill">T → T<sub>c</sub>−</span>, the material becomes extremely polarizable; the divergence is a hallmark of mean-field second-order transitions.</li>
        <li><strong>Engineering takeaway:</strong> near <span class="pill">T<sub>c</sub></span>, small temperature drift can cause large capacitance changes (great for sensors, risky for stability).</li>
      </ul>

      <div class="callouts">
        <div class="callout">
          <div class="label"><span class="dot"></span>Key target statement</div>
          <div class="eqbox">
            <pre class="eq" id="eq-target">ε(T&lt;Tc) = 1 + 4π (ΔP/E) = 1 + 2π / [γ (Tc − T)]</pre>
            <div class="copyrow">
              <button class="copy" data-copy-target="eq-target">Copy equation (plain text)</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <article id="part0">
      <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

      <h3>0.1 Core definitions (symbols and SI units)</h3>
      <ul>
        <li><strong>P</strong>: polarization (dipole moment per volume). SI: C·m<sup>−2</sup>. (In cgs, P has different units; the problem’s <span class="pill">4π</span> indicates cgs-style relations.)</li>
        <li><strong>E</strong>: applied electric field. SI: V·m<sup>−1</sup>.</li>
        <li><strong>D</strong>: electric displacement. SI: C·m<sup>−2</sup>. In SI: <span class="pill">D = ε<sub>0</sub>E + P</span>. In cgs (Gaussian): <span class="pill">D = E + 4πP</span>.</li>
        <li><strong>ε</strong>: relative dielectric constant (dimensionless). In SI: ε<sub>r</sub>. In cgs, often written as <span class="pill">ε = 1 + 4πχ</span>.</li>
        <li><strong>χ</strong>: electric susceptibility (dimensionless in both common conventions, but the prefactors differ by unit system).</li>
        <li><strong>T, T<sub>c</sub></strong>: temperature and transition temperature (K).</li>
        <li><strong>γ, g</strong>: Landau expansion coefficients in the free energy (their units depend on chosen unit system and on how f is defined).</li>
      </ul>

      <h3>0.2 Physical meaning (intuition)</h3>
      <p class="muted">
        In a ferroelectric, below <strong>T<sub>c</sub></strong> the crystal can sustain a <em>spontaneous</em> polarization even at zero applied field. The dielectric response
        then measures how easily that polarization changes when a small field is applied. Landau theory captures this by expanding the free energy in powers of <strong>P</strong>
        near the transition.
      </p>

      <h3>0.3 Landau free energy and validity conditions</h3>
      <div class="callouts">
        <div class="callout">
          <div class="label"><span class="dot good"></span>Assumptions behind Landau mean-field</div>
          <ul>
            <li>Order parameter is small near <span class="pill">T≈T<sub>c</sub></span> so a low-order polynomial in <strong>P</strong> is adequate.</li>
            <li>Spatial variations are neglected (uniform state). If included, one adds a gradient term <span class="pill">(κ/2)|∇P|²</span>, leading to a PDE.</li>
            <li>Fluctuations are ignored (mean-field). In real materials, critical exponents can differ near <span class="pill">T<sub>c</sub></span>.</li>
            <li>Second-order transition: quartic coefficient is positive (stability) and cubic term is forbidden by symmetry in the paraelectric phase.</li>
          </ul>
        </div>
      </div>

      <h3>0.4 Common models/approximations and why they’re used</h3>
      <ul>
        <li><strong>Uniform Landau model:</strong> <span class="pill">f(P,T) = f<sub>0</sub>(T) + (γ/2)(T−T<sub>c</sub>)P² + (g/4)P⁴ − EP</span>.
          This is the simplest model that yields a continuous onset of spontaneous polarization at <span class="pill">T<sub>c</sub></span>.
        </li>
        <li><strong>Linear response:</strong> evaluate <span class="pill">χ = (∂P/∂E)<sub>E→0</sub></span> by linearizing around equilibrium.</li>
        <li><strong>Small-field limit:</strong> keep only first-order changes in <span class="pill">ΔP</span> produced by a small <span class="pill">E</span>.</li>
      </ul>

      <h3>0.5 Mini intuition examples (minimal algebra)</h3>
      <ol>
        <li><strong>Above T<sub>c</sub>:</strong> equilibrium has <span class="pill">P=0</span> at <span class="pill">E=0</span>; small <span class="pill">E</span> produces <span class="pill">P∝E</span> with a slope diverging as <span class="pill">1/(T−T<sub>c</sub>)</span>.</li>
        <li><strong>Below T<sub>c</sub>:</strong> equilibrium has <span class="pill">P=±P<sub>0</sub></span>; a small <span class="pill">E</span> mainly shifts you along one of these wells, giving a different slope (factor of 2 difference emerges).</li>
        <li><strong>Engineering analogy:</strong> think “spring constant.” The curvature of the free energy at equilibrium is like stiffness; susceptibility is like compliance (inverse stiffness).</li>
      </ol>

      <h3>0.6 What to watch for (pitfalls)</h3>
      <ul>
        <li><strong>Unit system trap:</strong> the <span class="pill">4π</span> in <span class="pill">ε = 1 + 4πχ</span> signals cgs/Gaussian conventions, not SI.</li>
        <li><strong>Wrong expansion point:</strong> below <span class="pill">T<sub>c</sub></span>, expand around <span class="pill">P<sub>0</sub></span>, not around 0.</li>
        <li><strong>Stability condition:</strong> need <span class="pill">g&gt;0</span> so the free energy is bounded below.</li>
        <li><strong>Derivative meaning:</strong> <span class="pill">χ</span> is the derivative at equilibrium, i.e., after minimizing the free energy with respect to <strong>P</strong>.</li>
      </ul>

      <div class="callouts">
        <div class="callout">
          <div class="label"><span class="dot"></span>Math Insight</div>
          <p class="muted">
            The core calculation is a <strong>variational minimization</strong>: equilibrium polarization satisfies
            <span class="pill">∂f/∂P = 0</span>. Linear response is controlled by the <strong>Hessian (curvature)</strong>
            <span class="pill">∂²f/∂P²</span> at the minimum. Susceptibility is essentially the inverse curvature:
            <span class="pill">χ = (∂P/∂E) = 1 / (∂E/∂P) = 1 / (∂²f/∂P²)</span> (evaluated at equilibrium).
          </p>
        </div>
      </div>
      <a class="backtop" href="#top">Back to top</a>
    </article>

    <article id="part0b">
      <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>

      <h3>Why this matters in real engineering</h3>
      <ul>
        <li><strong>Capacitors &amp; tunable components:</strong> high-ε materials increase capacitance density; near <span class="pill">T<sub>c</sub></span> you can get huge permittivity (and huge temperature coefficient).</li>
        <li><strong>Pyroelectric &amp; IR sensors:</strong> strong temperature dependence of polarization and permittivity is exploited in sensing and thermal imaging.</li>
        <li><strong>Actuators/transducers (piezoelectrics):</strong> many piezoelectric properties correlate with dielectric response; tuning composition to place <span class="pill">T<sub>c</sub></span> near operating temperature can maximize sensitivity.</li>
      </ul>

      <h3>Why industrial engineers care (performance, reliability, cost)</h3>
      <ul>
        <li><strong>Process windows:</strong> small composition/processing shifts move <span class="pill">T<sub>c</sub></span>, changing ε and thus device specs (capacitance, impedance, resonance).</li>
        <li><strong>Thermal drift &amp; stability:</strong> ε diverging like <span class="pill">1/(T<sub>c</sub>−T)</span> means temperature control becomes a key quality and reliability variable.</li>
        <li><strong>Breakdown &amp; nonlinearity:</strong> high susceptibility often comes with stronger field nonlinearity and loss; trade-offs impact efficiency and heating.</li>
      </ul>

      <h3>Measurement/validation methods (brief)</h3>
      <ul>
        <li><strong>Impedance spectroscopy / LCR measurements:</strong> measure capacitance vs. temperature to extract ε(T).</li>
        <li><strong>Dielectric loss tangent (tan δ):</strong> quantifies dissipation; critical near transitions.</li>
        <li><strong>Hysteresis loop (P–E) tracing:</strong> confirms ferroelectric phase and provides Landau-parameter fits near <span class="pill">T<sub>c</sub></span> (approximate).</li>
      </ul>

      <h3>Design trade-offs and constraints</h3>
      <ul>
        <li><strong>Non-idealities:</strong> domains, defects, grain boundaries, stresses, and finite frequency reduce/round the ideal divergence.</li>
        <li><strong>Manufacturability:</strong> sintering/annealing and dopants shift <span class="pill">T<sub>c</sub></span> and change γ, g.</li>
        <li><strong>System-level constraints:</strong> thermal environment, allowable drift, and calibration cost can dominate the “best material” choice.</li>
      </ul>

      <h3>From lab to product</h3>
      <p class="muted">
        The ideal Landau model is typically adapted by adding loss (complex permittivity), finite-frequency dispersion, and sometimes gradient terms
        (domain-wall and size effects). In production, engineers characterize ε(T, f, E) rather than ε(T) alone and build guard-bands for temperature
        and lot-to-lot variability.
      </p>
      <a class="backtop" href="#top">Back to top</a>
    </article>

    <article id="part1">
      <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

      <h3>1.1 Restatement in plain words</h3>
      <p>
        Using the Landau free-energy expansion for a <strong>second-order ferroelectric transition</strong>, show that for <strong>T&lt;T<sub>c</sub></strong> the dielectric constant is
        <span class="pill">ε = 1 + 4πΔP/E = 1 + 2π/[γ(T<sub>c</sub>−T)]</span>, expressed in terms of Landau parameters.
      </p>

      <div class="grid2">
        <div class="callout">
          <div class="label"><span class="dot"></span>Given / Model ingredients</div>
          <ul>
            <li>Landau free-energy density expanded in polarization <strong>P</strong>.</li>
            <li>Second-order transition at <span class="pill">T = T<sub>c</sub></span>.</li>
            <li>Small applied electric field <strong>E</strong> (linear response).</li>
            <li>Definition (cgs-style): <span class="pill">ε = 1 + 4π(P/E)</span> in linear regime, or equivalently <span class="pill">ε = 1 + 4πχ</span>.</li>
          </ul>
        </div>

        <div class="callout">
          <div class="label"><span class="dot good"></span>Unknowns / what to prove</div>
          <ul>
            <li>Compute the susceptibility <span class="pill">χ = (∂P/∂E)<sub>E→0</sub></span> for <span class="pill">T&lt;T<sub>c</sub></span>.</li>
            <li>Convert to dielectric constant <span class="pill">ε</span> using the given relationship.</li>
            <li>Show the final divergence and the factor of 2 in the denominator relative to above <span class="pill">T<sub>c</sub></span>.</li>
          </ul>
        </div>
      </div>

      <h3>1.2 Relevant principles (and why they apply)</h3>
      <ul>
        <li><strong>Variational equilibrium:</strong> stable uniform equilibrium minimizes free energy, so <span class="pill">∂f/∂P = 0</span> (and <span class="pill">∂²f/∂P² &gt; 0</span>).</li>
        <li><strong>Linear response:</strong> for small <span class="pill">E</span>, the change <span class="pill">ΔP</span> is linear in <span class="pill">E</span> and defines susceptibility.</li>
        <li><strong>Symmetry:</strong> in the paraelectric phase, <span class="pill">f(P)</span> is even in <span class="pill">P</span> (no cubic term), enabling a continuous (second-order) transition.</li>
      </ul>

      <h3>1.3 Explicit assumptions</h3>
      <div class="callouts">
        <div class="callout">
          <div class="label"><span class="dot warn"></span>Assumptions used in the derivation</div>
          <ul>
            <li><strong>Uniform polarization:</strong> ignore spatial gradients; mathematically, we use an algebraic minimization rather than a PDE.</li>
            <li><strong>Small field:</strong> retain only linear terms in <span class="pill">ΔP</span> about equilibrium.</li>
            <li><strong>Mean-field Landau form:</strong> truncate at <span class="pill">P⁴</span> and assume <span class="pill">g &gt; 0</span>.</li>
            <li><strong>Near T<sub>c</sub>:</strong> the Landau expansion is controlled and the order parameter is not too large.</li>
          </ul>
        </div>
      </div>

      <h3>1.4 Possible approaches (compare and choose)</h3>
      <ol>
        <li><strong>Equation-of-state linearization (best here):</strong> derive <span class="pill">E(P)</span> from <span class="pill">∂f/∂P</span>, find spontaneous <span class="pill">P<sub>0</sub></span>, then linearize.
          <span class="muted">Pros: direct, minimal machinery, highlights curvature → susceptibility.</span>
        </li>
        <li><strong>Curvature/Hessian method:</strong> compute <span class="pill">∂²f/∂P²</span> at the minimum; use <span class="pill">χ = 1/(∂E/∂P)</span>.
          <span class="muted">Pros: elegant, makes “inverse stiffness” interpretation explicit.</span>
        </li>
        <li><strong>Full variational functional with gradients:</strong> use <span class="pill">F[P]=∫(f + (κ/2)|∇P|²)dV</span>, then take the Euler–Lagrange equation
          <span class="pill">δF/δP = 0</span>.
          <span class="muted">Pros: general; Cons: overkill for uniform dielectric constant.</span>
        </li>
      </ol>
      <p><strong>Choice:</strong> We will use (1) and explicitly connect it to (2) to satisfy both physical clarity and mathematical rigor.</p>
      <a class="backtop" href="#top">Back to top</a>
    </article>

    <article id="part2">
      <h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

      <ol>
        <li><strong>Write the Landau free-energy density</strong> <span class="pill">f(P,T)</span> for a second-order transition, including coupling to <span class="pill">E</span>.</li>
        <li><strong>Minimize with respect to P</strong>: set <span class="pill">∂f/∂P = 0</span> to obtain the equation of state <span class="pill">E = E(P,T)</span>.</li>
        <li><strong>Find spontaneous polarization below T<sub>c</sub></strong> by setting <span class="pill">E=0</span> and solving for <span class="pill">P=P<sub>0</sub>(T)</span>.</li>
        <li><strong>Linearize around the minimum</strong>: put <span class="pill">P = P<sub>0</sub> + ΔP</span> and keep only first-order terms in <span class="pill">ΔP</span>.</li>
        <li><strong>Read off susceptibility</strong>: identify <span class="pill">ΔP = χE</span> so <span class="pill">χ = (∂P/∂E)</span>.</li>
        <li><strong>Convert to dielectric constant</strong> using <span class="pill">ε = 1 + 4πχ</span> (the convention used by the problem).</li>
        <li><strong>Sanity checks</strong>: divergence as <span class="pill">T→T<sub>c</sub>−</span>, positivity of χ, and dimensional consistency of the combination <span class="pill">γ(T<sub>c</sub>−T)</span>.</li>
      </ol>

      <div class="callouts">
        <div class="callout">
          <div class="label"><span class="dot bad"></span>Common mistakes</div>
          <ul>
            <li>Using <span class="pill">P=0</span> as the expansion point below <span class="pill">T<sub>c</sub></span> (wrong equilibrium).</li>
            <li>Differentiating <span class="pill">P(E)</span> before enforcing equilibrium (you must minimize first).</li>
            <li>Dropping the <span class="pill">3gP<sub>0</sub>²</span> term when linearizing <span class="pill">P³</span>.</li>
            <li>Mixing SI and cgs formulas for ε and χ (watch the <span class="pill">4π</span>).</li>
          </ul>
        </div>
      </div>

      <a class="backtop" href="#top">Back to top</a>
    </article>

    <article id="part3">
      <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

      <h3>3.1 Physical intuition first (what we expect)</h3>
      <p class="muted">
        Below <span class="pill">T<sub>c</sub></span>, the free energy has two symmetry-related minima (at <span class="pill">±P<sub>0</sub></span>).
        A small applied field <span class="pill">E</span> slightly shifts the minimum and changes the polarization by <span class="pill">ΔP</span>.
        The susceptibility is larger near <span class="pill">T<sub>c</sub></span> because the “well” is shallow: the curvature at the minimum goes to zero as
        <span class="pill">T → T<sub>c</sub></span>.
      </p>

      <h3>3.2 Mathematical model (variables, domain, boundary conditions)</h3>
      <div class="callouts">
        <div class="callout">
          <div class="label"><span class="dot"></span>Model statement (uniform mean-field Landau)</div>
          <ul>
            <li><strong>Order parameter:</strong> scalar polarization <span class="pill">P</span> along the field direction (we assume a single-axis situation).</li>
            <li><strong>Independent variables:</strong> temperature <span class="pill">T</span> and uniform applied field <span class="pill">E</span>.</li>
            <li><strong>Domain:</strong> spatially uniform bulk sample; no explicit dependence on position <span class="pill">x</span>, so operators like <span class="pill">∇</span> do not enter.</li>
            <li><strong>Equilibrium condition:</strong> minimize the free-energy density <span class="pill">f(P,T;E)</span> with respect to <span class="pill">P</span> at fixed <span class="pill">T,E</span>.</li>
            <li><strong>Stability:</strong> require <span class="pill">∂²f/∂P² &gt; 0</span> at equilibrium.</li>
          </ul>

          <details>
            <summary>Optional generalization (with spatial variations)</summary>
            <p class="muted">
              If polarization varies in space, one uses a functional
              <span class="pill">F[P] = ∫ ( f(P,T) + (κ/2)|∇P|² ) dV</span>.
              Equilibrium follows from the Euler–Lagrange equation:
              <span class="pill">δF/δP = 0 ⇒ κ∇²P = ∂f/∂P</span>,
              with boundary conditions set by surfaces/electrodes. For the present dielectric constant in a uniform bulk, we take <span class="pill">∇P = 0</span>.
            </p>
          </details>
        </div>
      </div>

      <h3>3.3 Landau free-energy density</h3>
      <p>
        For a second-order transition (no cubic term by symmetry, stable quartic term), take the Landau expansion (per unit volume):
      </p>

      <div class="eqbox">
        <pre class="eq" id="eq-landau">f(P,T;E) = f0(T) + (γ/2)(T − Tc) P^2 + (g/4) P^4 − E P
with g &gt; 0</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-landau">Copy equation (plain text)</button>
          <span class="pill">Second-order: g&gt;0</span>
        </div>
      </div>

      <p class="muted">
        The term <span class="pill">−EP</span> is the work of the field on the polarization (coupling).
        The temperature-dependent quadratic coefficient changes sign at <span class="pill">T = T<sub>c</sub></span>, driving the transition.
      </p>

      <h3>3.4 Equilibrium condition: minimize f with respect to P</h3>
      <p>
        Since the model is uniform, minimization is an ordinary calculus condition:
      </p>

      <div class="eqbox">
        <pre class="eq" id="eq-min1">∂f/∂P = 0</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-min1">Copy (plain text)</button>
        </div>
      </div>

      <p>Compute the derivative term-by-term (linearity of differentiation):</p>
      <ul>
        <li><span class="pill">∂/∂P [(γ/2)(T−Tc)P²] = γ(T−Tc)P</span></li>
        <li><span class="pill">∂/∂P [(g/4)P⁴] = gP³</span></li>
        <li><span class="pill">∂/∂P [−EP] = −E</span></li>
        <li><span class="pill">∂f0/∂P = 0</span> because <span class="pill">f0</span> depends only on <span class="pill">T</span>.</li>
      </ul>

      <p>Therefore the equilibrium (equation of state) is:</p>
      <div class="eqbox">
        <pre class="eq" id="eq-state">γ(T − Tc) P + g P^3 − E = 0
⇔ E = γ(T − Tc) P + g P^3</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-state">Copy equation of state</button>
          <span class="pill">Nonlinear constitutive relation</span>
        </div>
      </div>

      <h3>3.5 Spontaneous polarization below Tc (set E=0)</h3>
      <p>
        For <span class="pill">T&lt;T<sub>c</sub></span> and <span class="pill">E=0</span>, solve:
      </p>

      <div class="eqbox">
        <pre class="eq" id="eq-P0-steps">0 = γ(T − Tc) P + g P^3
Factor P:
0 = P [ γ(T − Tc) + g P^2 ]</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-P0-steps">Copy steps</button>
        </div>
      </div>

      <p>Thus either <span class="pill">P = 0</span> or <span class="pill">γ(T − Tc) + gP² = 0</span>. For <span class="pill">T&lt;Tc</span>, we have <span class="pill">(T−Tc)&lt;0</span>, so a nonzero solution exists:</p>

      <div class="eqbox">
        <pre class="eq" id="eq-P0">g P0^2 = −γ (T − Tc) = γ (Tc − T)
⇒ P0(T) = ± sqrt[ γ (Tc − T) / g ]</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-P0">Copy P0(T)</button>
        </div>
      </div>

      <p class="muted">
        Physically, the ± corresponds to the two symmetry-related ferroelectric domain orientations in zero field.
      </p>

      <h3>3.6 Linear response below Tc: perturb about P0</h3>
      <p>
        Apply a small field <span class="pill">E</span> and write the polarization as:
      </p>

      <div class="eqbox">
        <pre class="eq" id="eq-Pexp">P = P0 + ΔP,   with |ΔP| ≪ |P0| for small E</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-Pexp">Copy (plain text)</button>
        </div>
      </div>

      <p>Insert into the equation of state:</p>
      <div class="eqbox">
        <pre class="eq" id="eq-insert">E = γ(T − Tc)(P0 + ΔP) + g(P0 + ΔP)^3</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-insert">Copy (plain text)</button>
        </div>
      </div>

      <p>Now expand the cubic term to first order in <span class="pill">ΔP</span> (binomial expansion):</p>
      <div class="eqbox">
        <pre class="eq" id="eq-cubic">(P0 + ΔP)^3 = P0^3 + 3P0^2 ΔP + 3P0 (ΔP)^2 + (ΔP)^3
Linear-response approximation: keep only up to O(ΔP)
⇒ (P0 + ΔP)^3 ≈ P0^3 + 3P0^2 ΔP</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-cubic">Copy expansion</button>
          <span class="pill">Neglect O((ΔP)²)</span>
        </div>
      </div>

      <p>Substitute and group terms:</p>
      <div class="eqbox">
        <pre class="eq" id="eq-group">E ≈ [γ(T − Tc)P0 + gP0^3]  +  [γ(T − Tc) + 3gP0^2] ΔP</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-group">Copy grouped form</button>
        </div>
      </div>

      <p>
        The bracketed constant term vanishes because <span class="pill">P0</span> satisfies the <span class="pill">E=0</span> equilibrium equation:
        <span class="pill">γ(T−Tc)P0 + gP0^3 = 0</span>. Therefore:
      </p>

      <div class="eqbox">
        <pre class="eq" id="eq-linear">E ≈ [γ(T − Tc) + 3gP0^2] ΔP</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-linear">Copy linear relation</button>
        </div>
      </div>

      <h3>3.7 Eliminate P0 using its temperature dependence</h3>
      <p>
        From <span class="pill">gP0^2 = γ(Tc − T)</span>, compute:
      </p>
      <div class="eqbox">
        <pre class="eq" id="eq-elim">γ(T − Tc) + 3gP0^2
= γ(T − Tc) + 3γ(Tc − T)
Let ΔT = (Tc − T) &gt; 0 (below Tc)
Then γ(T − Tc) = −γΔT and 3γ(Tc − T) = 3γΔT
So the sum = (−γΔT + 3γΔT) = 2γΔT = 2γ(Tc − T)</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-elim">Copy elimination steps</button>
        </div>
      </div>

      <p>Hence the linear-response relation becomes:</p>
      <div class="eqbox">
        <pre class="eq" id="eq-dP">E ≈ 2γ(Tc − T) ΔP
⇒ ΔP/E ≈ 1 / [2γ(Tc − T)]</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-dP">Copy ΔP/E</button>
        </div>
      </div>

      <h3>3.8 Susceptibility and dielectric constant</h3>
      <p>
        By definition in linear response, the susceptibility (in the convention implied by the problem) is:
        <span class="pill">χ = ΔP/E</span>. Therefore:
      </p>

      <div class="eqbox">
        <pre class="eq" id="eq-chi">χ(T&lt;Tc) = 1 / [2γ(Tc − T)]</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-chi">Copy χ(T&lt;Tc)</button>
        </div>
      </div>

      <p>
        Using the problem’s dielectric constant relation (cgs/Gaussian-style):
      </p>

      <div class="eqbox">
        <pre class="eq" id="eq-eps">ε = 1 + 4πχ
⇒ ε(T&lt;Tc) = 1 + 4π * (1 / [2γ(Tc − T)])
= 1 + 2π / [γ(Tc − T)]</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="eq-eps">Copy final derivation</button>
        </div>
      </div>

      <div class="callouts">
        <div class="callout">
          <div class="label"><span class="dot good"></span>Final answer (boxed)</div>
          <div class="eqbox">
            <pre class="eq" id="eq-final">For a second-order Landau ferroelectric transition (T&lt;Tc):

χ = (ΔP/E) = 1 / [2γ(Tc − T)]

ε = 1 + 4πχ = 1 + 2π / [γ(Tc − T)]</pre>
            <div class="copyrow">
              <button class="copy" data-copy-target="eq-final">Copy final answer (plain text)</button>
            </div>
          </div>
        </div>
      </div>

      <h3>3.9 Sanity checks</h3>
      <div class="grid2">
        <div class="callout">
          <div class="label"><span class="dot"></span>Dimensional / units check</div>
          <p class="muted">
            Since <span class="pill">χ = ΔP/E</span> is dimensionless in the convention used here,
            the combination <span class="pill">γ(Tc − T)</span> must have the same “units” as <span class="pill">E/P</span>.
            Landau coefficients carry the necessary units so that <span class="pill">f</span> is an energy density.
          </p>
        </div>
        <div class="callout">
          <div class="label"><span class="dot warn"></span>Limiting behavior</div>
          <ul>
            <li>As <span class="pill">T → Tc−</span>, <span class="pill">ε → ∞</span> like <span class="pill">1/(Tc − T)</span> (mean-field divergence).</li>
            <li>Deeper below <span class="pill">Tc</span>, <span class="pill">Tc − T</span> increases, so χ decreases (the well stiffens).</li>
            <li>χ is positive for <span class="pill">T&lt;Tc</span> if <span class="pill">γ&gt;0</span>, consistent with stability.</li>
          </ul>
        </div>
      </div>

      <h3>3.10 Static plot (optional, for intuition)</h3>
      <p class="muted">
        The plot below uses <strong>example values</strong> (not required by the symbolic problem) to visualize the divergence as <span class="pill">T → Tc−</span>.
        The final result above remains fully symbolic.
      </p>

      <figure>
        <canvas id="plot" width="980" height="420" aria-label="Plot of epsilon vs temperature below Tc"></canvas>
        <figcaption>
          Example curve of <span class="pill">ε(T) = 1 + 2π/[γ(Tc−T)]</span> for <span class="pill">T&lt;Tc</span>.
          Example parameters used in the plot: <span class="pill">Tc=400 K</span>, <span class="pill">γ=1</span> (arbitrary units consistent with the convention), and temperature range <span class="pill">T∈[360, 399] K</span>.
        </figcaption>
      </figure>

      <a class="backtop" href="#top">Back to top</a>
    </article>

    <article id="part4">
      <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

      <h3>4.1 Re-interpret the final formula</h3>
      <ul>
        <li><strong>γ</strong> sets the <em>temperature stiffness</em> of the quadratic term: larger γ means stronger restoring “spring,” hence smaller χ and ε.</li>
        <li><strong>(T<sub>c</sub>−T)</strong> measures how far you are below the transition: closer to <span class="pill">T<sub>c</sub></span> means softer curvature and larger response.</li>
        <li><strong>Factor of 2</strong> (vs above <span class="pill">T<sub>c</sub></span>): below <span class="pill">T<sub>c</sub></span>, you respond around a shifted minimum where the cubic nonlinearity effectively increases curvature by a term <span class="pill">3gP0²</span>; using <span class="pill">P0² ∝ (T<sub>c</sub>−T)</span> yields the net <span class="pill">2γ(T<sub>c</sub>−T)</span>.</li>
      </ul>

      <h3>4.2 Parameter dependence (qualitative)</h3>
      <ul>
        <li>If <strong>γ increases</strong> → <strong>χ decreases</strong> and <strong>ε decreases</strong> at fixed <span class="pill">T</span>.</li>
        <li>If <strong>T approaches T<sub>c</sub> from below</strong> → <strong>χ and ε increase strongly</strong> as <span class="pill">1/(T<sub>c</sub>−T)</span>.</li>
        <li>The quartic coefficient <strong>g</strong> controls <span class="pill">P0</span>, but it cancels out of χ below <span class="pill">T<sub>c</sub></span> in this simplest mean-field result (because curvature at the minimum depends on <span class="pill">gP0²</span>, which is fixed by γ and <span class="pill">(T<sub>c</sub>−T)</span>).</li>
      </ul>

      <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
      <p class="muted">
        Instead of expanding the equation of state, compute the curvature directly:
        <span class="pill">∂E/∂P = ∂²f/∂P² = γ(T−T<sub>c</sub>) + 3gP²</span>.
        Evaluate at equilibrium <span class="pill">P=P0</span>, substitute <span class="pill">gP0² = γ(T<sub>c</sub>−T)</span>, and obtain
        <span class="pill">∂E/∂P|<sub>P0</sub> = 2γ(T<sub>c</sub>−T)</span>. Then
        <span class="pill">χ = (∂P/∂E) = 1/(∂E/∂P)</span>.
        This emphasizes χ as the inverse Hessian (inverse “stiffness”) at the minimum.
      </p>

      <h3>4.4 Concept check (self-test with answers)</h3>
      <ul>
        <li><strong>Q:</strong> Why is there no <span class="pill">P³</span> term in the Landau expansion here?<br/>
            <strong>A:</strong> In the high-temperature paraelectric phase, symmetry typically implies <span class="pill">f(P)=f(−P)</span>, so odd powers vanish.</li>
        <li><strong>Q:</strong> What mathematical object controls susceptibility in Landau theory?<br/>
            <strong>A:</strong> The curvature (Hessian) <span class="pill">∂²f/∂P²</span> at equilibrium; χ is essentially its inverse.</li>
        <li><strong>Q:</strong> What happens to χ if fluctuations are important very close to <span class="pill">T<sub>c</sub></span>?<br/>
            <strong>A:</strong> The divergence may be rounded or follow different critical exponents than mean-field; the simple <span class="pill">1/|T−T<sub>c</sub>|</span> form can fail extremely close to <span class="pill">T<sub>c</sub></span>.</li>
        <li><strong>Q:</strong> Why do we compute <span class="pill">ΔP</span> around <span class="pill">P0</span> for <span class="pill">T&lt;T<sub>c</sub></span>?<br/>
            <strong>A:</strong> Because <span class="pill">P0</span> is the stable equilibrium; linear response must be taken about the actual minimum.</li>
      </ul>

      <a class="backtop" href="#top">Back to top</a>
    </article>

    <article id="part5">
      <h2>PART 5 — Optional Plot Guide</h2>
      <h3>What the plot shows and why it’s useful</h3>
      <ul>
        <li><strong>Y-axis:</strong> dielectric constant <span class="pill">ε</span> (dimensionless, in the convention used here).</li>
        <li><strong>X-axis:</strong> temperature <span class="pill">T</span> in kelvin.</li>
        <li><strong>Curve:</strong> <span class="pill">ε(T) = 1 + 2π/[γ(Tc−T)]</span> for <span class="pill">T&lt;Tc</span>.</li>
        <li><strong>Example values:</strong> <span class="pill">Tc=400 K</span> and <span class="pill">γ=1</span> are chosen purely to visualize the divergence; the symbolic result does not depend on these choices.</li>
        <li><strong>Feature to notice:</strong> the curve rises sharply as <span class="pill">T</span> approaches <span class="pill">Tc</span> from below, illustrating the <span class="pill">1/(Tc−T)</span> blow-up.</li>
      </ul>
      <a class="backtop" href="#top">Back to top</a>
    </article>

    <section>
      <h2>Copy-friendly “Final Answer”</h2>
      <div class="eqbox">
        <pre class="eq" id="final-answer-plain">Using the Landau free energy
f(P,T;E) = f0(T) + (γ/2)(T − Tc)P^2 + (g/4)P^4 − EP  (g>0),

the equation of state is
E = γ(T − Tc)P + gP^3.

For T<Tc at E=0, the spontaneous polarization satisfies
P0^2 = γ(Tc − T)/g.

For a small field E, write P = P0 + ΔP and linearize:
E ≈ [γ(T − Tc) + 3gP0^2] ΔP = 2γ(Tc − T) ΔP,
so
ΔP/E = χ = 1/[2γ(Tc − T)].

Therefore (with the problem’s convention ε = 1 + 4πχ):
ε(T<Tc) = 1 + 2π/[γ(Tc − T)].</pre>
        <div class="copyrow">
          <button class="copy" data-copy-target="final-answer-plain">Copy final answer (plain text)</button>
        </div>
      </div>
    </section>
  </main>
</div>

<footer>
  <div class="wrap">
    <p class="tiny">
      Notes: The appearance of <span class="pill">4π</span> indicates a cgs/Gaussian-style dielectric relation. In SI, one would express the result in terms of ε<sub>0</sub> and ε<sub>r</sub> with different prefactors, but the Landau-derived temperature dependence is the same in mean-field form.
    </p>
  </div>
</footer>

<script>
  // Copy buttons (plain text)
  (function(){
    function copyTextFrom(el){
      const text = el.innerText.replace(/\u00A0/g,' ');
      return navigator.clipboard.writeText(text);
    }
    document.querySelectorAll('button.copy').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const id = btn.getAttribute('data-copy-target');
        const el = document.getElementById(id);
        if(!el) return;
        const original = btn.textContent;
        try{
          await copyTextFrom(el);
          btn.textContent = "Copied ✓";
          btn.style.borderColor = "rgba(134,239,172,.35)";
          btn.style.background = "rgba(134,239,172,.10)";
          setTimeout(()=>{
            btn.textContent = original;
            btn.style.borderColor = "";
            btn.style.background = "";
          }, 900);
        }catch(e){
          btn.textContent = "Copy failed";
          setTimeout(()=>btn.textContent = original, 900);
        }
      });
    });
  })();

  // Simple static plot on canvas (high-DPI aware, responsive redraw)
  (function(){
    const canvas = document.getElementById('plot');
    if(!canvas) return;
    const ctx = canvas.getContext('2d');

    // Example values (explicitly not part of symbolic final answer)
    const Tc = 400;      // K
    const gamma = 1.0;   // arbitrary in the chosen convention
    const Tmin = 360;    // K
    const Tmax = 399;    // K (avoid singularity at Tc)

    function eps(T){
      return 1 + (2*Math.PI)/(gamma*(Tc - T));
    }

    function draw(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      const w = Math.max(520, Math.floor(rect.width));
      const h = Math.floor(w * 0.42);

      canvas.width = Math.floor(w * dpr);
      canvas.height = Math.floor(h * dpr);
      canvas.style.height = h + "px";
      canvas.style.width = w + "px";
      ctx.setTransform(dpr,0,0,dpr,0,0);

      // Layout
      const padL = 66, padR = 18, padT = 34, padB = 54;
      const W = w, H = h;
      const x0 = padL, x1 = W - padR;
      const y0 = padT, y1 = H - padB;

      // Data sampling
      const N = 300;
      const xs = [];
      const ys = [];
      let ymin = Infinity, ymax = -Infinity;
      for(let i=0;i<N;i++){
        const T = Tmin + (Tmax - Tmin) * (i/(N-1));
        const val = eps(T);
        xs.push(T);
        ys.push(val);
        if(val<ymin) ymin=val;
        if(val>ymax) ymax=val;
      }
      // Expand y-range a bit for aesthetics
      const yPad = 0.08*(ymax-ymin || 1);
      ymin = Math.max(0, ymin - yPad);
      ymax = ymax + yPad;

      function xPix(T){
        return x0 + (T - Tmin) * (x1 - x0) / (Tmax - Tmin);
      }
      function yPix(v){
        return y1 - (v - ymin) * (y1 - y0) / (ymax - ymin);
      }

      // Background
      ctx.clearRect(0,0,W,H);

      // Panel
      ctx.fillStyle = "rgba(255,255,255,0.02)";
      roundRect(ctx, 10, 10, W-20, H-20, 16);
      ctx.fill();
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.lineWidth = 1;
      ctx.stroke();

      // Title
      ctx.fillStyle = "rgba(233,238,246,0.95)";
      ctx.font = "600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("Example plot: ε(T) below Tc", 18, 26);

      // Gridlines + ticks
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.lineWidth = 1;

      // x ticks (K)
      const xTicks = 6;
      for(let i=0;i<=xTicks;i++){
        const T = Tmin + (Tmax - Tmin)*i/xTicks;
        const xp = xPix(T);
        ctx.beginPath();
        ctx.moveTo(xp, y0);
        ctx.lineTo(xp, y1);
        ctx.stroke();
      }
      // y ticks
      const yTicks = 5;
      for(let i=0;i<=yTicks;i++){
        const v = ymin + (ymax - ymin)*i/yTicks;
        const yp = yPix(v);
        ctx.beginPath();
        ctx.moveTo(x0, yp);
        ctx.lineTo(x1, yp);
        ctx.stroke();
      }

      // Axes
      ctx.strokeStyle = "rgba(255,255,255,0.32)";
      ctx.lineWidth = 1.2;
      ctx.beginPath();
      ctx.moveTo(x0, y1);
      ctx.lineTo(x1, y1);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x0, y1);
      ctx.stroke();

      // Labels
      ctx.fillStyle = "rgba(183,195,214,0.95)";
      ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";

      // x tick labels
      for(let i=0;i<=xTicks;i++){
        const T = Tmin + (Tmax - Tmin)*i/xTicks;
        const xp = xPix(T);
        const label = Math.round(T).toString();
        ctx.fillText(label, xp-10, y1 + 18);
        // tick marks
        ctx.strokeStyle = "rgba(255,255,255,0.32)";
        ctx.beginPath();
        ctx.moveTo(xp, y1);
        ctx.lineTo(xp, y1+5);
        ctx.stroke();
      }

      // y tick labels
      for(let i=0;i<=yTicks;i++){
        const v = ymin + (ymax - ymin)*i/yTicks;
        const yp = yPix(v);
        const label = (Math.round(v*10)/10).toString();
        ctx.fillText(label, x0 - 44, yp + 4);
        ctx.strokeStyle = "rgba(255,255,255,0.32)";
        ctx.beginPath();
        ctx.moveTo(x0-5, yp);
        ctx.lineTo(x0, yp);
        ctx.stroke();
      }

      // Axis titles
      ctx.fillStyle = "rgba(233,238,246,0.92)";
      ctx.font = "600 12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("Temperature T (K)", Math.floor((x0+x1)/2)-56, H-18);

      // Rotate for y axis label
      ctx.save();
      ctx.translate(18, Math.floor((y0+y1)/2)+42);
      ctx.rotate(-Math.PI/2);
      ctx.fillText("Dielectric constant ε (dimensionless)", 0, 0);
      ctx.restore();

      // Curve
      ctx.lineWidth = 2.2;
      ctx.strokeStyle = "rgba(125,211,252,0.95)";
      ctx.beginPath();
      for(let i=0;i<N;i++){
        const xp = xPix(xs[i]);
        const yp = yPix(ys[i]);
        if(i===0) ctx.moveTo(xp, yp);
        else ctx.lineTo(xp, yp);
      }
      ctx.stroke();

      // Legend
      const lx = x1 - 230, ly = y0 + 10;
      ctx.fillStyle = "rgba(0,0,0,0.25)";
      roundRect(ctx, lx, ly, 212, 44, 12);
      ctx.fill();
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.stroke();

      ctx.strokeStyle = "rgba(125,211,252,0.95)";
      ctx.lineWidth = 2.2;
      ctx.beginPath();
      ctx.moveTo(lx+12, ly+16);
      ctx.lineTo(lx+46, ly+16);
      ctx.stroke();

      ctx.fillStyle = "rgba(233,238,246,0.92)";
      ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("ε = 1 + 2π/[γ(Tc−T)]", lx+54, ly+20);
      ctx.fillStyle = "rgba(183,195,214,0.92)";
      ctx.fillText("Example: Tc=400 K, γ=1", lx+54, ly+36);
    }

    function roundRect(ctx, x, y, w, h, r){
      const rr = Math.min(r, w/2, h/2);
      ctx.beginPath();
      ctx.moveTo(x+rr, y);
      ctx.arcTo(x+w, y, x+w, y+h, rr);
      ctx.arcTo(x+w, y+h, x, y+h, rr);
      ctx.arcTo(x, y+h, x, y, rr);
      ctx.arcTo(x, y, x+w, y, rr);
      ctx.closePath();
    }

    const ro = new ResizeObserver(()=>draw());
    ro.observe(canvas);
    draw();
    window.addEventListener('resize', draw, {passive:true});
  })();
</script>
</body>
</html>