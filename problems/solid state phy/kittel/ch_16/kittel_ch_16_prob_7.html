<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Saturation Polarization at the Curie Point (First-Order Landau Transition)</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#0f1624;
      --panel2:#0c1320;
      --text:#e9eef7;
      --muted:#b7c3d9;
      --faint:#8ea0be;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#86efac;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border:rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius:16px;
      --radius2:22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
      --line: 1.65;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      background: radial-gradient(1200px 600px at 15% 10%, rgba(125,211,252,.12), transparent 60%),
                  radial-gradient(900px 500px at 80% 20%, rgba(167,139,250,.10), transparent 55%),
                  linear-gradient(180deg, var(--bg), #070a10 55%, #05070b);
      color:var(--text);
      font-family:var(--sans);
      line-height:var(--line);
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:28px 18px 16px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(15,22,36,.75), rgba(15,22,36,.25));
      position:relative;
      overflow:hidden;
    }
    header .wrap{
      max-width:1100px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.4fr .6fr;
      gap:16px;
      align-items:start;
    }
    .title{
      margin:0 0 8px;
      font-size: clamp(22px, 2.2vw + 10px, 38px);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      font-size: clamp(14px, .55vw + 12px, 18px);
    }
    .pillbar{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      justify-content:flex-end;
      align-items:flex-start;
      padding-top:6px;
    }
    .pill{
      font-size:12px;
      color:var(--muted);
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      padding:7px 10px;
      border-radius:999px;
      backdrop-filter: blur(8px);
      box-shadow: 0 6px 18px rgba(0,0,0,.20);
      white-space:nowrap;
    }

    main{
      max-width:1100px;
      margin:0 auto;
      padding:18px;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:18px;
    }
    nav.toc{
      position:sticky;
      top:14px;
      align-self:start;
      background: linear-gradient(180deg, rgba(15,22,36,.72), rgba(15,22,36,.44));
      border:1px solid var(--border);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding:14px 14px 12px;
      overflow:hidden;
    }
    .toc h2{
      margin:0 0 10px;
      font-size:13px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:var(--faint);
    }
    .toc a{
      display:block;
      padding:9px 10px;
      border-radius:12px;
      color:var(--text);
      font-size:13px;
      border:1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .toc a:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.22);
      transform: translateX(2px);
      text-decoration:none;
    }
    .toc .mini{
      margin-top:10px;
      padding-top:10px;
      border-top:1px dashed rgba(255,255,255,.12);
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .toc .mini a{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      background: rgba(255,255,255,.04);
      border:1px solid var(--border);
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
    }

    article{
      background: linear-gradient(180deg, rgba(15,22,36,.60), rgba(12,19,32,.42));
      border:1px solid var(--border);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 18px 18px 10px;
      overflow:hidden;
    }

    section{padding: 10px 0 14px; border-bottom:1px solid rgba(255,255,255,.08)}
    section:last-child{border-bottom:none}
    h3{
      margin:0 0 8px;
      font-size: 18px;
      letter-spacing:.2px;
    }
    h4{
      margin:14px 0 8px;
      font-size: 15px;
      color: var(--text);
    }
    p{margin: 8px 0; color: var(--text)}
    ul{margin: 8px 0 8px 22px; color: var(--text)}
    li{margin:6px 0}
    .muted{color:var(--muted)}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    .grid3{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 980px){
      main{grid-template-columns: 1fr}
      nav.toc{position:relative; top:0}
      header .wrap{grid-template-columns: 1fr}
      .pillbar{justify-content:flex-start}
      .grid2,.grid3{grid-template-columns:1fr}
    }

    .card{
      background: rgba(255,255,255,.03);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 12px 12px 10px;
      box-shadow: 0 10px 22px rgba(0,0,0,.25);
    }
    .callout{
      border-left: 4px solid rgba(125,211,252,.85);
      background: linear-gradient(90deg, rgba(125,211,252,.10), rgba(255,255,255,.02));
      padding: 12px 12px 10px;
      border-radius: 14px;
      border:1px solid rgba(125,211,252,.18);
    }
    .callout.warn{
      border-left-color: rgba(251,191,36,.95);
      border-color: rgba(251,191,36,.20);
      background: linear-gradient(90deg, rgba(251,191,36,.10), rgba(255,255,255,.02));
    }
    .callout.good{
      border-left-color: rgba(134,239,172,.95);
      border-color: rgba(134,239,172,.20);
      background: linear-gradient(90deg, rgba(134,239,172,.10), rgba(255,255,255,.02));
    }
    .callout.bad{
      border-left-color: rgba(251,113,133,.95);
      border-color: rgba(251,113,133,.20);
      background: linear-gradient(90deg, rgba(251,113,133,.10), rgba(255,255,255,.02));
    }
    .kicker{
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:var(--faint);
      margin:0 0 6px;
    }

    .eqbox{
      background: rgba(10,14,24,.72);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      padding: 12px 12px 10px;
      margin: 10px 0;
      position:relative;
      overflow:hidden;
    }
    .eqbox::before{
      content:"";
      position:absolute;
      inset: -2px -2px auto -2px;
      height: 3px;
      background: linear-gradient(90deg, rgba(125,211,252,.85), rgba(167,139,250,.75), rgba(134,239,172,.65));
      opacity:.9;
    }
    pre, code{
      font-family: var(--mono);
      font-size: 13px;
      line-height: 1.55;
      color: #eaf2ff;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .eqrow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      color: var(--text);
      border-radius: 999px;
      padding: 8px 10px;
      font-size:12px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.25);
    }
    .btn:active{transform: translateY(0px) scale(.99)}
    .btn.small{padding:6px 9px; font-size:11px}

    details{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      border-radius: 16px;
      padding: 10px 12px;
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 650;
    }
    summary::marker{color: var(--accent)}
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:10px;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      font-size: 12px;
    }
    .backtop:hover{
      text-decoration:none;
      color: var(--text);
      border-color: rgba(125,211,252,.25);
      background: rgba(125,211,252,.08);
    }

    figure{
      margin: 10px 0 0;
      padding: 12px;
      border-radius: 18px;
      background: rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.10);
    }
    figcaption{
      margin-top:8px;
      color: var(--muted);
      font-size: 12px;
    }
    canvas{
      width:100%;
      height:320px;
      display:block;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(10,14,24,.75), rgba(10,14,24,.45));
      border:1px solid rgba(255,255,255,.10);
    }

    footer{
      max-width:1100px;
      margin:0 auto;
      padding: 14px 18px 28px;
      color: var(--muted);
      font-size: 12px;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, nav.toc, .pillbar, .btn, .backtop {display:none !important}
      main{display:block; padding:0}
      article{box-shadow:none; border:none; background:#fff; padding:0}
      section{break-inside:avoid}
      .eqbox, .card, .callout, details{border:1px solid #ddd; background:#fff}
      pre, code{color:#000}
      a{color:#000; text-decoration:underline}
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="wrap">
      <div>
        <h1 class="title">Saturation Polarization at the Curie Point (First-Order Transition)</h1>
        <p class="subtitle">
          Landau free-energy method: combine (i) equilibrium (stationary) condition and (ii) phase coexistence at the Curie point
          to derive <span class="muted">P<sub>s</sub><sup>2</sup>(T<sub>c</sub>)</span> and <span class="muted">T<sub>c</sub></span>.
        </p>
      </div>
      <div class="pillbar" aria-label="topic tags">
        <span class="pill">Landau theory</span>
        <span class="pill">first-order phase transition</span>
        <span class="pill">ferroelectrics / polarization</span>
        <span class="pill">applied physics + industry</span>
      </div>
    </div>
  </header>

  <main>
    <nav class="toc" aria-label="Table of Contents">
      <h2>Contents</h2>
      <a href="#qs">Quick Summary</a>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry & Applied Physics</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy & Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Optional Plot Guide</a>
      <div class="mini">
        <a href="#final">Final Answer</a>
        <a href="#top">Back to top</a>
      </div>
    </nav>

    <article>
      <!-- Quick Summary -->
      <section id="qs">
        <h3>Quick Summary</h3>
        <ul>
          <li><strong>What this problem is about:</strong> a <em>first-order</em> Landau phase transition where a nonzero polarization minimum coexists with the zero-polarization state at <span class="muted">T = T<sub>c</sub></span>.</li>
          <li><strong>Key physics idea:</strong> at a first-order Curie point, <strong>two phases are equally stable</strong> (equal free energy) while each stable phase satisfies <strong>local equilibrium</strong> (stationary condition).</li>
          <li><strong>Governing model:</strong> a sixth-order Landau free-energy density
            <span class="muted">F(P,T) = F<sub>0</sub>(T) + (γ/2)(T−T<sub>0</sub>)P<sup>2</sup> − (g<sub>4</sub>/4)P<sup>4</sup> + (g<sub>6</sub>/6)P<sup>6</sup></span> (zero applied field).</li>
          <li><strong>Two conditions at</strong> <span class="muted">T<sub>c</sub></span>:
            (i) <span class="muted">∂F/∂P = 0</span> at <span class="muted">P = P<sub>s</sub></span>;
            (ii) <span class="muted">F(P<sub>s</sub>,T<sub>c</sub>) = F(0,T<sub>c</sub>)</span> (phase coexistence).</li>
          <li><strong>Main symbolic results:</strong>
            <span class="muted">P<sub>s</sub><sup>2</sup>(T<sub>c</sub>) = 3g<sub>4</sub>/(4g<sub>6</sub>)</span>
            and
            <span class="muted">T<sub>c</sub> = T<sub>0</sub> + 3g<sub>4</sub><sup>2</sup>/(16γg<sub>6</sub>)</span>.</li>
          <li><strong>What it physically means:</strong> the polarization <em>jumps</em> discontinuously at <span class="muted">T<sub>c</sub></span>, and the jump size is fixed by the ratio of nonlinear Landau coefficients.</li>
        </ul>

        <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
      </section>

      <!-- PART 0 -->
      <section id="part0">
        <h3>PART 0 — Concept Primer (Theory Before Solving)</h3>

        <div class="grid2">
          <div class="card">
            <p class="kicker">Core definitions</p>
            <ul>
              <li><strong>P</strong>: polarization order parameter (SI: C·m<sup>−2</sup>).</li>
              <li><strong>F(P,T)</strong>: (Helmholtz) free-energy density as a function of order parameter and temperature (SI: J·m<sup>−3</sup>).</li>
              <li><strong>F<sub>0</sub>(T)</strong>: background free energy of the reference (paraelectric) phase.</li>
              <li><strong>T</strong>: absolute temperature (K).</li>
              <li><strong>T<sub>0</sub></strong>: Landau “bare” critical temperature that would be the second-order transition point if the quartic term did not drive first-order behavior (K).</li>
              <li><strong>γ</strong>: positive coefficient linking temperature to quadratic stiffness (units so that γ(T−T<sub>0</sub>)P<sup>2</sup> has J·m<sup>−3</sup>).</li>
              <li><strong>g<sub>4</sub>, g<sub>6</sub></strong>: nonlinear Landau coefficients (units so that g<sub>4</sub>P<sup>4</sup>, g<sub>6</sub>P<sup>6</sup> have J·m<sup>−3</sup>).</li>
              <li><strong>P<sub>s</sub>(T)</strong>: spontaneous (equilibrium) polarization in the ordered phase.</li>
            </ul>
          </div>

          <div class="card">
            <p class="kicker">Physical meaning</p>
            <p>
              Landau theory treats the transition as a competition between:
              <strong>quadratic stiffness</strong> (prefers <span class="muted">P=0</span>),
              and <strong>nonlinear terms</strong> that can create additional minima at <span class="muted">P≠0</span>.
            </p>
            <ul>
              <li>If the quartic term effectively acts with a <strong>negative</strong> sign, a double-well can form <em>before</em> the quadratic term changes sign, producing a <strong>first-order</strong> jump.</li>
              <li>Stability for large <span class="muted">|P|</span> requires the highest-order coefficient to be positive (here <span class="muted">g<sub>6</sub> &gt; 0</span> with the chosen sign convention).</li>
            </ul>
          </div>
        </div>

        <div class="callout">
          <p class="kicker">Mathematical model (explicit)</p>
          <p>
            We model a spatially uniform order parameter (no domain walls, no gradients), so the “field” is a scalar
            <strong>P</strong> living on the domain <strong>P ∈ ℝ</strong>, and temperature is a parameter <strong>T ∈ ℝ</strong>.
            The free-energy density functional reduces to an ordinary function:
          </p>

          <div class="eqbox" data-copy="eq-landau">
            <div class="eqrow">
              <pre id="eq-landau">F(P,T) = F0(T) + (γ/2)(T − T0) P^2 − (g4/4) P^4 + (g6/6) P^6   (E = 0)</pre>
              <button class="btn small" data-copy-btn="eq-landau" aria-label="Copy equation">Copy</button>
            </div>
            <p class="muted" style="margin:8px 0 0">
              Sign convention: for a first-order transition we take <span class="muted">γ &gt; 0</span>, <span class="muted">g<sub>4</sub> &gt; 0</span>, <span class="muted">g<sub>6</sub> &gt; 0</span>, and the quartic term enters with a minus sign.
            </p>
          </div>

          <p>
            <strong>Equilibrium (local stability)</strong> at fixed <span class="muted">T</span> is obtained from the stationarity condition
            <span class="muted">∂F/∂P = 0</span>, and stable minima additionally require <span class="muted">∂²F/∂P² &gt; 0</span>.
          </p>
        </div>

        <div class="grid2">
          <div class="card">
            <p class="kicker">Key laws & validity conditions</p>
            <ul>
              <li><strong>Mean-field / Landau approximation:</strong> expand free energy in a power series near the transition, assuming analyticity in <span class="muted">P</span> and symmetry <span class="muted">F(P)=F(−P)</span> (no odd powers at zero field).</li>
              <li><strong>Uniform order parameter:</strong> we neglect spatial variations; mathematically, we omit gradient terms like <span class="muted">(κ/2)|∇P|²</span>.</li>
              <li><strong>Near-transition regime:</strong> higher-than-sixth order terms are neglected; justified if <span class="muted">P</span> stays small enough that the sixth order stabilizes the expansion.</li>
            </ul>
          </div>

          <div class="card">
            <p class="kicker">Mini intuition examples</p>
            <ul>
              <li><strong>Second-order case:</strong> if the quartic coefficient were positive in <span class="muted">+ (g4/4)P^4</span>, the minimum moves continuously from <span class="muted">P=0</span> as <span class="muted">T</span> crosses <span class="muted">T0</span>.</li>
              <li><strong>First-order case (this problem):</strong> the negative quartic term creates a nonzero minimum even when <span class="muted">T &gt; T0</span>; at <span class="muted">T = Tc</span> the two minima have equal depth → discontinuous jump.</li>
              <li><strong>Engineering view:</strong> a jump implies latent heat and hysteresis; devices can switch sharply but may be sensitive to defects and cycling.</li>
            </ul>
          </div>
        </div>

        <div class="callout warn">
          <p class="kicker">What to watch for (pitfalls)</p>
          <ul>
            <li><strong>Sign conventions:</strong> first-order requires an “effective” negative quartic contribution. Different textbooks encode this either by <span class="muted">g4&lt;0</span> or by writing an explicit minus sign (as we do).</li>
            <li><strong>Two distinct conditions at Tc:</strong> (i) stationarity at <span class="muted">P=P<sub>s</sub></span> and (ii) equality of free energies between <span class="muted">P=0</span> and <span class="muted">P=P<sub>s</sub></span>.</li>
            <li><strong>Don’t confuse</strong> <span class="muted">T0</span> (Landau parameter) with the actual transition temperature <span class="muted">Tc</span> for a first-order transition.</li>
          </ul>
        </div>

        <details>
          <summary>Math Insight (interpret the core equation as a mathematical object)</summary>
          <p class="muted">
            The equilibrium condition <span class="muted">∂F/∂P = 0</span> is the Euler–Lagrange condition for minimizing a potential.
            In our uniform model, it becomes a <strong>polynomial algebraic equation</strong> (an ODE/PDE-free variational problem).
            The Curie-point coexistence adds a second scalar constraint, selecting a specific stationary point where
            the polynomial has <strong>two minima of equal value</strong>—a classic “double-well equal-depth” condition.
          </p>
          <div class="eqbox" data-copy="eq-stationary">
            <div class="eqrow">
              <pre id="eq-stationary">Equilibrium: ∂F/∂P = γ(T − T0)P − g4 P^3 + g6 P^5 = 0</pre>
              <button class="btn small" data-copy-btn="eq-stationary">Copy</button>
            </div>
          </div>
        </details>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 0B -->
      <section id="part0b">
        <h3>PART 0B — Industry &amp; Applied Physics Perspective</h3>

        <div class="grid3">
          <div class="card">
            <p class="kicker">Where it appears (3+ areas)</p>
            <ul>
              <li><strong>Ferroelectric memories</strong> (FeRAM), and emerging <strong>ferroelectric HfO<sub>2</sub></strong> stacks in CMOS-compatible devices.</li>
              <li><strong>Piezoelectric actuators/sensors</strong> (PZT-class ceramics): sharp transitions impact coupling coefficients and stability.</li>
              <li><strong>Thermal reliability of capacitors</strong> and dielectric stacks: phase transitions change permittivity and loss.</li>
              <li><strong>Electrocaloric cooling</strong>: first-order transitions can enhance entropy change (but also hysteresis losses).</li>
            </ul>
          </div>
          <div class="card">
            <p class="kicker">Why engineers care</p>
            <ul>
              <li><strong>Performance:</strong> polarization jump affects switching charge, actuator strain, and permittivity near Tc.</li>
              <li><strong>Reliability:</strong> first-order transitions often imply <strong>hysteresis</strong>, aging, and fatigue under cycling.</li>
              <li><strong>Manufacturability:</strong> coefficients <span class="muted">g4,g6,γ</span> depend on composition, grain size, stress, and processing.</li>
              <li><strong>Cost/efficiency:</strong> sharp transitions can boost functionality but increase loss and process sensitivity.</li>
            </ul>
          </div>
          <div class="card">
            <p class="kicker">How it’s validated</p>
            <ul>
              <li><strong>P–E loops</strong> (hysteresis measurement) vs temperature to locate Tc and the jump in <span class="muted">P<sub>s</sub></span>.</li>
              <li><strong>DSC / calorimetry</strong> for latent heat (signature of first-order behavior).</li>
              <li><strong>Dielectric spectroscopy</strong> for permittivity peaks and loss tangent changes near Tc.</li>
              <li><strong>XRD / Raman</strong> for structural phase identification and order parameter proxies.</li>
            </ul>
          </div>
        </div>

        <div class="callout">
          <p class="kicker">Design trade-offs &amp; “lab → product” adaptation</p>
          <p>
            The ideal Landau model is uniform and defect-free. Real devices add:
            <strong>stress</strong> (thermal mismatch), <strong>finite size</strong> (thin films), <strong>electrodes</strong> (dead layers),
            and <strong>domains</strong> (spatially varying <span class="muted">P(x)</span>), which introduce gradient terms like
            <span class="muted">(κ/2)|∇P|²</span> and depolarization fields.
            Practically, engineers fit an “effective” Landau model to measured data over the operating range, then use it to
            predict switching margins, temperature drift, and failure modes.
          </p>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 1 -->
      <section id="part1">
        <h3>PART 1 — Problem Analysis (No Solving Yet)</h3>

        <div class="card">
          <p class="kicker">Restatement (in my own words)</p>
          <p>
            For a first-order transition described by a Landau free energy <span class="muted">F(P,T)</span>, at the Curie point
            <span class="muted">T=T<sub>c</sub></span> the ordered phase with polarization <span class="muted">P<sub>s</sub>(T<sub>c</sub>)</span>
            coexists with the disordered phase <span class="muted">P=0</span>. Using (i) the equilibrium condition (stationary point) and
            (ii) the coexistence condition <span class="muted">F(P<sub>s</sub>,T<sub>c</sub>)=F(0,T<sub>c</sub>)</span>,
            prove:
            <span class="muted">P<sub>s</sub><sup>2</sup>(T<sub>c</sub>) = 3g<sub>4</sub>/(4g<sub>6</sub>)</span>, then deduce
            <span class="muted">T<sub>c</sub> = T<sub>0</sub> + 3g<sub>4</sub><sup>2</sup>/(16γg<sub>6</sub>)</span>.
          </p>
        </div>

        <div class="grid2">
          <div class="card">
            <p class="kicker">Given quantities</p>
            <ul>
              <li>Landau free energy with parameters <span class="muted">γ, T0, g4, g6</span>, and background <span class="muted">F0(T)</span>.</li>
              <li>First-order Curie condition: equal-depth minima at <span class="muted">T=Tc</span>.</li>
            </ul>
            <p class="kicker" style="margin-top:10px;">Unknowns</p>
            <ul>
              <li><span class="muted">P<sub>s</sub>(T<sub>c</sub>)</span> (specifically its square).</li>
              <li><span class="muted">T<sub>c</sub></span> in terms of model parameters.</li>
            </ul>
          </div>

          <div class="card">
            <p class="kicker">Relevant principles (and why)</p>
            <ul>
              <li><strong>Thermodynamic equilibrium:</strong> minimize <span class="muted">F</span> with respect to <span class="muted">P</span> → use <span class="muted">∂F/∂P = 0</span>.</li>
              <li><strong>Phase coexistence at a first-order point:</strong> both phases have equal free energy → use <span class="muted">F(Ps,Tc)=F(0,Tc)</span>.</li>
              <li><strong>Symmetry:</strong> at zero field, <span class="muted">F(P)=F(−P)</span>, so stable phases appear in ± pairs. We can work with <span class="muted">P≥0</span> without loss of generality.</li>
            </ul>
            <p class="muted">
              We do <em>not</em> need spatial operators (∇, ∇·, ∇×) because the problem is explicitly uniform (no gradient energy).
            </p>
          </div>
        </div>

        <div class="callout good">
          <p class="kicker">Assumptions (explicit)</p>
          <ul>
            <li>Uniform polarization (single-domain mean-field description).</li>
            <li>Zero applied electric field (so no linear −EP term).</li>
            <li>Landau truncation at sixth order is valid near the transition.</li>
            <li>Coefficients are temperature-independent over the narrow range considered (standard Landau approximation).</li>
          </ul>
        </div>

        <div class="card">
          <p class="kicker">Possible approaches (compare)</p>
          <ol>
            <li><strong>Direct algebra (best here):</strong> write the two conditions explicitly, eliminate <span class="muted">γ(Tc−T0)</span>, solve for <span class="muted">P<sub>s</sub></span>. <span class="muted">Pros:</span> short, exact. <span class="muted">Cons:</span> must track signs carefully.</li>
            <li><strong>Graphical/potential method:</strong> interpret <span class="muted">F(P)</span> as a double-well; equal-depth minima impose constraints on coefficients. <span class="muted">Pros:</span> strong intuition. <span class="muted">Cons:</span> still needs algebra for exact constants.</li>
            <li><strong>Factorization trick:</strong> require that the polynomial <span class="muted">F(P)−F(0)</span> has a double root at <span class="muted">P=0</span> and a stationary equal-depth root at <span class="muted">P=Ps</span>. <span class="muted">Pros:</span> elegant. <span class="muted">Cons:</span> less straightforward for beginners.</li>
          </ol>
          <p><strong>Chosen approach:</strong> direct algebra using the two scalar conditions. It is the most transparent and aligns with the problem statement.</p>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 2 -->
      <section id="part2">
        <h3>PART 2 — Strategy &amp; Tips (Roadmap Only)</h3>

        <div class="card">
          <p class="kicker">Plan (minimal roadmap)</p>
          <ol>
            <li><strong>Write the Landau free-energy density</strong> <span class="muted">F(P,T)</span> and identify the “excess” part <span class="muted">ΔF(P,T)=F(P,T)-F(0,T)</span>.</li>
            <li><strong>Apply equilibrium at</strong> <span class="muted">P=Ps</span>: set <span class="muted">∂F/∂P=0</span> → an algebraic equation linking <span class="muted">Tc</span> and <span class="muted">Ps</span>.</li>
            <li><strong>Apply coexistence at</strong> <span class="muted">Tc</span>: enforce <span class="muted">ΔF(Ps,Tc)=0</span> → a second algebraic equation.</li>
            <li><strong>Eliminate the temperature-dependent factor</strong> <span class="muted">γ(Tc−T0)</span> between the two equations.</li>
            <li><strong>Solve for</strong> <span class="muted">Ps^2(Tc)</span>; then substitute back to get <span class="muted">Tc</span>.</li>
            <li><strong>Sanity checks:</strong> verify dimensions and positivity (first-order requires parameter signs that make <span class="muted">Ps^2&gt;0</span>).</li>
          </ol>
        </div>

        <div class="callout warn">
          <p class="kicker">Common mistakes</p>
          <ul>
            <li>Forgetting to subtract <span class="muted">F(0,Tc)</span> when applying <span class="muted">F(Ps,Tc)=F(0,Tc)</span>.</li>
            <li>Dividing by <span class="muted">Ps</span> without noting <span class="muted">Ps≠0</span> in the ordered phase.</li>
            <li>Mixing sign conventions for the quartic term (check whether it is written as <span class="muted">+g4 P^4/4</span> with <span class="muted">g4&lt;0</span>, or as <span class="muted">−g4 P^4/4</span> with <span class="muted">g4&gt;0</span>).</li>
            <li>Confusing <span class="muted">T0</span> with <span class="muted">Tc</span>.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 3 -->
      <section id="part3">
        <h3>PART 3 — Full Solution (Detailed + Teaching)</h3>

        <div class="card">
          <p class="kicker">Qualitative expectation (before algebra)</p>
          <p>
            In a first-order transition, we expect a <strong>discontinuous jump</strong> in polarization at <span class="muted">T=Tc</span>.
            That means at <span class="muted">Tc</span> there are <strong>two competing minima</strong> of the free energy:
            one at <span class="muted">P=0</span> and another at <span class="muted">P=Ps</span>, and they have <strong>equal depth</strong>.
            The jump size should be set mainly by the nonlinear coefficients <span class="muted">g4,g6</span>, because those shape the double-well.
          </p>
        </div>

        <h4>Step 1 — Write the Landau free energy and define the excess part</h4>
        <p>
          Start from the (uniform, zero-field) Landau expansion (free-energy density):
        </p>

        <div class="eqbox" data-copy="eq-F">
          <div class="eqrow">
            <pre id="eq-F">F(P,T) = F0(T) + (γ/2)(T − T0) P^2 − (g4/4) P^4 + (g6/6) P^6</pre>
            <button class="btn small" data-copy-btn="eq-F">Copy</button>
          </div>
        </div>

        <p>
          At <span class="muted">P=0</span>, we have <span class="muted">F(0,T)=F0(T)</span>.
          It is convenient to subtract this background and work with
        </p>

        <div class="eqbox" data-copy="eq-dF">
          <div class="eqrow">
            <pre id="eq-dF">ΔF(P,T) := F(P,T) − F(0,T) = (γ/2)(T − T0) P^2 − (g4/4) P^4 + (g6/6) P^6</pre>
            <button class="btn small" data-copy-btn="eq-dF">Copy</button>
          </div>
        </div>

        <p class="muted">
          This subtraction is valid because we are comparing free-energy differences between phases at the same temperature.
          The constant offset <span class="muted">F0(T)</span> cancels in coexistence conditions.
        </p>

        <h4>Step 2 — Apply the equilibrium (stationary) condition at the ordered minimum</h4>
        <p>
          Equilibrium polarization values satisfy <span class="muted">∂F/∂P = 0</span>.
          Since <span class="muted">F0(T)</span> does not depend on <span class="muted">P</span>, it drops out of the derivative:
        </p>

        <div class="eqbox" data-copy="eq-dFdP">
          <div class="eqrow">
            <pre id="eq-dFdP">∂F/∂P = γ(T − T0)P − g4 P^3 + g6 P^5</pre>
            <button class="btn small" data-copy-btn="eq-dFdP">Copy</button>
          </div>
        </div>

        <p>
          At <span class="muted">T=Tc</span>, the ordered-phase polarization is <span class="muted">P=Ps(Tc)</span>, which is nonzero.
          So we set:
        </p>

        <div class="eqbox" data-copy="eq-eq1">
          <div class="eqrow">
            <pre id="eq-eq1">0 = γ(Tc − T0)Ps − g4 Ps^3 + g6 Ps^5</pre>
            <button class="btn small" data-copy-btn="eq-eq1">Copy</button>
          </div>
        </div>

        <p>
          Because <span class="muted">Ps ≠ 0</span>, we can divide by <span class="muted">Ps</span> (mathematically valid because we are not at the trivial solution):
        </p>

        <div class="eqbox" data-copy="eq-eq1b">
          <div class="eqrow">
            <pre id="eq-eq1b">γ(Tc − T0) − g4 Ps^2 + g6 Ps^4 = 0
⇒ γ(Tc − T0) = g4 Ps^2 − g6 Ps^4</pre>
            <button class="btn small" data-copy-btn="eq-eq1b">Copy</button>
          </div>
        </div>

        <h4>Step 3 — Apply the Curie-point coexistence condition (equal free energies)</h4>
        <p>
          At a first-order transition temperature, the coexisting phases have equal free energy. Here:
        </p>

        <div class="eqbox" data-copy="eq-coex">
          <div class="eqrow">
            <pre id="eq-coex">F(Ps, Tc) = F(0, Tc)  ⇔  ΔF(Ps, Tc) = 0</pre>
            <button class="btn small" data-copy-btn="eq-coex">Copy</button>
          </div>
        </div>

        <p>
          Using the expression for <span class="muted">ΔF</span>:
        </p>

        <div class="eqbox" data-copy="eq-eq2">
          <div class="eqrow">
            <pre id="eq-eq2">0 = (γ/2)(Tc − T0) Ps^2 − (g4/4) Ps^4 + (g6/6) Ps^6</pre>
            <button class="btn small" data-copy-btn="eq-eq2">Copy</button>
          </div>
        </div>

        <h4>Step 4 — Combine the two conditions to solve for Ps²(Tc)</h4>
        <p>
          We now eliminate <span class="muted">γ(Tc−T0)</span> using the stationarity result:
          <span class="muted">γ(Tc−T0) = g4 Ps² − g6 Ps⁴</span>.
          Substitute that into the coexistence equation:
        </p>

        <div class="eqbox" data-copy="eq-sub">
          <div class="eqrow">
            <pre id="eq-sub">0 = (1/2)(g4 Ps^2 − g6 Ps^4) Ps^2 − (g4/4) Ps^4 + (g6/6) Ps^6</pre>
            <button class="btn small" data-copy-btn="eq-sub">Copy</button>
          </div>
        </div>

        <p>Now expand term-by-term (showing the algebra explicitly):</p>

        <div class="eqbox" data-copy="eq-alg">
          <div class="eqrow">
            <pre id="eq-alg">(1/2)(g4 Ps^2 − g6 Ps^4) Ps^2 = (1/2)(g4 Ps^4 − g6 Ps^6)

So:
0 = (1/2)g4 Ps^4 − (1/2)g6 Ps^6 − (1/4)g4 Ps^4 + (1/6)g6 Ps^6

Group Ps^4 terms:
(1/2 − 1/4) g4 Ps^4 = (1/4) g4 Ps^4

Group Ps^6 terms:
(−1/2 + 1/6) g6 Ps^6 = (−1/3) g6 Ps^6

Therefore:
0 = (1/4) g4 Ps^4 − (1/3) g6 Ps^6</pre>
            <button class="btn small" data-copy-btn="eq-alg">Copy</button>
          </div>
        </div>

        <p>
          Factor out <span class="muted">Ps^4</span> (again valid because <span class="muted">Ps≠0</span> so <span class="muted">Ps^4&gt;0</span>):
        </p>

        <div class="eqbox" data-copy="eq-factor">
          <div class="eqrow">
            <pre id="eq-factor">0 = Ps^4 [ (1/4)g4 − (1/3)g6 Ps^2 ]</pre>
            <button class="btn small" data-copy-btn="eq-factor">Copy</button>
          </div>
        </div>

        <p>
          Since <span class="muted">Ps^4 ≠ 0</span>, the bracket must vanish:
        </p>

        <div class="eqbox" data-copy="eq-ps2">
          <div class="eqrow">
            <pre id="eq-ps2">(1/4)g4 − (1/3)g6 Ps^2 = 0
⇒ g6 Ps^2 = (3/4) g4
⇒ Ps^2(Tc) = 3 g4 / (4 g6)</pre>
            <button class="btn small" data-copy-btn="eq-ps2">Copy</button>
          </div>
        </div>

        <div class="callout good">
          <p class="kicker">Result (a)</p>
          <p><strong>At the Curie point of the first-order transition:</strong></p>
          <div class="eqbox" style="margin:10px 0 0" data-copy="eq-a">
            <div class="eqrow">
              <pre id="eq-a">Ps^2(Tc) = 3 g4 / (4 g6)</pre>
              <button class="btn small" data-copy-btn="eq-a">Copy</button>
            </div>
          </div>
        </div>

        <h4>Step 5 — Use Ps²(Tc) in the stationarity condition to get Tc</h4>
        <p>
          Return to:
          <span class="muted">γ(Tc − T0) = g4 Ps² − g6 Ps⁴</span>.
          Let <span class="muted">x := Ps²</span>. Then <span class="muted">Ps⁴ = x²</span>, so:
        </p>

        <div class="eqbox" data-copy="eq-temp1">
          <div class="eqrow">
            <pre id="eq-temp1">γ(Tc − T0) = g4 x − g6 x^2,   where x = Ps^2(Tc)</pre>
            <button class="btn small" data-copy-btn="eq-temp1">Copy</button>
          </div>
        </div>

        <p>Now substitute <span class="muted">x = 3g4/(4g6)</span> and compute carefully:</p>

        <div class="eqbox" data-copy="eq-temp2">
          <div class="eqrow">
            <pre id="eq-temp2">x = 3g4/(4g6)
x^2 = 9 g4^2 / (16 g6^2)

Compute g4 x:
g4 x = g4 * (3g4/(4g6)) = 3 g4^2 / (4 g6)

Compute g6 x^2:
g6 x^2 = g6 * (9 g4^2/(16 g6^2)) = 9 g4^2 / (16 g6)

Subtract:
g4 x − g6 x^2 = (3 g4^2/(4 g6)) − (9 g4^2/(16 g6))
= (12/16 − 9/16) (g4^2/g6)
= (3/16)(g4^2/g6)</pre>
            <button class="btn small" data-copy-btn="eq-temp2">Copy</button>
          </div>
        </div>

        <p>Therefore:</p>

        <div class="eqbox" data-copy="eq-temp3">
          <div class="eqrow">
            <pre id="eq-temp3">γ(Tc − T0) = (3/16)(g4^2/g6)
⇒ Tc = T0 + 3 g4^2 / (16 γ g6)</pre>
            <button class="btn small" data-copy-btn="eq-temp3">Copy</button>
          </div>
        </div>

        <div class="callout good" id="final">
          <p class="kicker">Result (b)</p>
          <p><strong>The first-order Curie temperature is shifted upward from T0:</strong></p>
          <div class="eqbox" style="margin:10px 0 0" data-copy="eq-b">
            <div class="eqrow">
              <pre id="eq-b">Tc = T0 + 3 g4^2 / (16 γ g6)</pre>
              <button class="btn small" data-copy-btn="eq-b">Copy</button>
            </div>
          </div>
        </div>

        <h4>Sanity checks</h4>
        <div class="grid2">
          <div class="callout">
            <p class="kicker">Dimensional analysis</p>
            <ul>
              <li><span class="muted">Ps^2</span> has units (C·m<sup>−2</sup>)<sup>2</sup>. In <span class="muted">Ps^2 = 3g4/(4g6)</span>, the ratio <span class="muted">g4/g6</span> must have units of <span class="muted">P^2</span>, which is consistent because <span class="muted">g4 P^4</span> and <span class="muted">g6 P^6</span> must share units of energy density.</li>
              <li>In <span class="muted">Tc = T0 + 3g4^2/(16γg6)</span>, the combination <span class="muted">g4^2/(γg6)</span> must have units of temperature, since <span class="muted">γ(T−T0)</span> multiplies <span class="muted">P^2</span> like an energy density coefficient.</li>
            </ul>
          </div>
          <div class="callout">
            <p class="kicker">Physical consistency</p>
            <ul>
              <li><span class="muted">Ps^2(Tc) &gt; 0</span> requires <span class="muted">g4/g6 &gt; 0</span>; with our sign convention for first order, both are positive.</li>
              <li><span class="muted">Tc &gt; T0</span> because the shift term is positive if <span class="muted">γ,g4,g6&gt;0</span>. This matches the idea that the first-order jump happens before the quadratic coefficient would vanish in a second-order scenario.</li>
              <li>The coexistence condition ensures <strong>equal stability</strong> of phases at <span class="muted">Tc</span>; away from <span class="muted">Tc</span> one minimum is deeper.</li>
            </ul>
          </div>
        </div>

        <figure>
          <canvas id="plot" aria-label="Plot of Landau excess free energy versus polarization"></canvas>
          <figcaption>
            Static example plot of the Landau excess free energy ΔF(P,Tc) showing equal-depth minima at P=0 and P=Ps (example parameters; the final results remain symbolic).
          </figcaption>
        </figure>

        <div class="eqbox" data-copy="final-answer">
          <div class="eqrow">
            <pre id="final-answer">FINAL (symbolic):
Ps^2(Tc) = 3 g4 / (4 g6)
Tc = T0 + 3 g4^2 / (16 γ g6)</pre>
            <button class="btn" data-copy-btn="final-answer">Copy Final Answer</button>
          </div>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 4 -->
      <section id="part4">
        <h3>PART 4 — Deeper Understanding (Theory Around the Result)</h3>

        <div class="grid2">
          <div class="card">
            <p class="kicker">Interpret the formulas</p>
            <ul>
              <li><strong>Polarization jump:</strong> <span class="muted">Ps^2(Tc) = 3g4/(4g6)</span> depends only on the <em>nonlinear shape</em> of the Landau potential. Larger <span class="muted">g4</span> (stronger destabilizing quartic) increases the jump; larger <span class="muted">g6</span> (stronger stabilizing sixth order) decreases it.</li>
              <li><strong>Curie-point shift:</strong> <span class="muted">Tc − T0 = 3g4^2/(16γg6)</span> grows with <span class="muted">g4^2</span> and shrinks with <span class="muted">γg6</span>. Stronger temperature stiffness <span class="muted">γ</span> or stronger stabilizing <span class="muted">g6</span> pushes <span class="muted">Tc</span> closer to <span class="muted">T0</span>.</li>
            </ul>
          </div>

          <div class="card">
            <p class="kicker">Parameter dependence (qualitative)</p>
            <ul>
              <li>Increase <span class="muted">g4</span> → larger <span class="muted">Ps(Tc)</span> and higher <span class="muted">Tc</span>.</li>
              <li>Increase <span class="muted">g6</span> → smaller <span class="muted">Ps(Tc)</span> and lower <span class="muted">Tc</span> (closer to <span class="muted">T0</span>).</li>
              <li>Increase <span class="muted">γ</span> → reduces the temperature shift <span class="muted">Tc − T0</span> but does not change <span class="muted">Ps^2(Tc)</span>.</li>
              <li>Change <span class="muted">T0</span> → rigidly shifts <span class="muted">Tc</span> by the same amount.</li>
            </ul>
          </div>
        </div>

        <details>
          <summary>Alternative derivation idea (brief but meaningful)</summary>
          <p class="muted">
            Consider the excess free energy polynomial <span class="muted">ΔF(P,Tc)</span>. At coexistence it satisfies:
            (i) <span class="muted">ΔF(0,Tc)=0</span>, (ii) <span class="muted">ΔF(Ps,Tc)=0</span>, and (iii) <span class="muted">ΔF'(Ps,Tc)=0</span>.
            That means <span class="muted">P=Ps</span> is a <em>double root</em> of <span class="muted">ΔF</span> when written as a polynomial in <span class="muted">P^2</span>.
            Enforcing this double-root structure fixes the ratio <span class="muted">Ps^2 = 3g4/(4g6)</span> and then <span class="muted">Tc</span>.
          </p>
        </details>

        <div class="callout">
          <p class="kicker">Concept check (self-test with answers)</p>
          <ul>
            <li><strong>Q:</strong> Why do we need both <span class="muted">∂F/∂P=0</span> and <span class="muted">F(Ps)=F(0)</span> at <span class="muted">Tc</span>? <br><strong>A:</strong> Stationarity gives candidate equilibrium points; coexistence selects the temperature where two distinct minima have equal depth (first-order condition).</li>
            <li><strong>Q:</strong> Does <span class="muted">Ps^2(Tc)</span> depend on <span class="muted">γ</span>? <br><strong>A:</strong> No—at <span class="muted">Tc</span> the jump magnitude depends only on <span class="muted">g4/g6</span> for this sixth-order Landau model.</li>
            <li><strong>Q:</strong> Why must the sixth-order term be stabilizing? <br><strong>A:</strong> Because the quartic contribution is destabilizing (negative), without a positive sixth-order term the free energy would go to <span class="muted">−∞</span> as <span class="muted">|P|→∞</span>, which is unphysical.</li>
            <li><strong>Q:</strong> If the transition were second-order, what would change? <br><strong>A:</strong> The quartic term would be stabilizing (positive), and the ordered minimum would emerge continuously from <span class="muted">P=0</span> at <span class="muted">T=T0</span>.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <!-- PART 5 -->
      <section id="part5">
        <h3>PART 5 — Optional Plot Guide</h3>

        <div class="card">
          <p class="kicker">What the plot shows (and why it’s useful)</p>
          <p>
            The canvas plot displays the <strong>excess free energy</strong> <span class="muted">ΔF(P,Tc)</span> versus polarization <span class="muted">P</span>
            for a set of <em>example values</em> (chosen only to visualize the shape):
            <span class="muted">γ=1</span>, <span class="muted">T0=0</span>, <span class="muted">g4=1</span>, <span class="muted">g6=1</span>.
            With these, the symbolic results predict
            <span class="muted">Tc=3/16</span> and <span class="muted">Ps=√(3/4)</span>.
          </p>
          <ul>
            <li><strong>x-axis:</strong> polarization <span class="muted">P</span> (arbitrary units for visualization).</li>
            <li><strong>y-axis:</strong> excess free energy <span class="muted">ΔF</span> (arbitrary units; only relative depth matters).</li>
            <li><strong>Key feature:</strong> two minima at <span class="muted">P=0</span> and <span class="muted">P≈Ps</span> with <strong>equal depth</strong>, which is the defining hallmark of a first-order transition temperature.</li>
          </ul>
          <p class="muted">
            These numeric values are <em>only</em> for plotting; the final answers above remain purely symbolic in terms of <span class="muted">γ,T0,g4,g6</span>.
          </p>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>
    </article>
  </main>

  <footer>
    <p>
      Built as a self-contained learning article: Landau theory (uniform order parameter, zero field), first-order coexistence at the Curie point.
      Copy buttons provide plain-text equations and the final symbolic result.
    </p>
  </footer>

  <script>
    // Copy-to-clipboard helpers
    (function(){
      function copyText(text){
        if(navigator.clipboard && window.isSecureContext){
          return navigator.clipboard.writeText(text);
        }
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        ta.style.top = '0';
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        try{ document.execCommand('copy'); }catch(e){}
        document.body.removeChild(ta);
        return Promise.resolve();
      }
      document.querySelectorAll('[data-copy-btn]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const id = btn.getAttribute('data-copy-btn');
          const el = document.getElementById(id);
          if(!el) return;
          const text = el.innerText.replace(/\n{3,}/g, '\n\n').trim();
          await copyText(text);
          const old = btn.textContent;
          btn.textContent = 'Copied ✓';
          btn.style.borderColor = 'rgba(134,239,172,.35)';
          btn.style.background = 'rgba(134,239,172,.10)';
          setTimeout(()=>{
            btn.textContent = old;
            btn.style.borderColor = '';
            btn.style.background = '';
          }, 900);
        });
      });
    })();

    // Simple static plot on canvas: ΔF(P,Tc) for example values
    (function(){
      const canvas = document.getElementById('plot');
      if(!canvas) return;

      const ex = {
        gamma: 1.0,
        T0: 0.0,
        g4: 1.0,
        g6: 1.0
      };
      // From derived result:
      const Tc = ex.T0 + 3*ex.g4*ex.g4/(16*ex.gamma*ex.g6);
      const Ps2 = 3*ex.g4/(4*ex.g6);
      const Ps = Math.sqrt(Ps2);

      function dF(P){
        return 0.5*ex.gamma*(Tc - ex.T0)*P*P - 0.25*ex.g4*Math.pow(P,4) + (1/6)*ex.g6*Math.pow(P,6);
      }

      function render(){
        const rect = canvas.getBoundingClientRect();
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        canvas.width = Math.round(rect.width * dpr);
        canvas.height = Math.round(rect.height * dpr);
        const ctx = canvas.getContext('2d');
        ctx.setTransform(dpr,0,0,dpr,0,0);

        const W = rect.width, H = rect.height;

        // Plot area
        const padL = 52, padR = 16, padT = 22, padB = 44;
        const x0 = padL, x1 = W - padR, y0 = padT, y1 = H - padB;
        const PW = x1 - x0, PH = y1 - y0;

        // Choose range
        const Pmax = Math.max(1.6, 1.6*Ps);
        const xmin = -Pmax, xmax = Pmax;

        // Sample curve
        const N = 900;
        let ymin = Infinity, ymax = -Infinity;
        const pts = [];
        for(let i=0;i<=N;i++){
          const t = i/N;
          const P = xmin + t*(xmax-xmin);
          const y = dF(P);
          pts.push({P, y});
          ymin = Math.min(ymin, y);
          ymax = Math.max(ymax, y);
        }

        // Add some padding to y-range for aesthetics
        const yr = ymax - ymin || 1;
        ymin = ymin - 0.12*yr;
        ymax = ymax + 0.18*yr;

        function X(P){ return x0 + (P - xmin) * PW / (xmax - xmin); }
        function Y(v){ return y1 - (v - ymin) * PH / (ymax - ymin); }

        // Background
        ctx.clearRect(0,0,W,H);

        // Gridlines
        ctx.lineWidth = 1;
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        ctx.fillStyle = 'rgba(255,255,255,0.85)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';

        // x ticks
        const xticks = 8;
        for(let k=0;k<=xticks;k++){
          const t = k/xticks;
          const P = xmin + t*(xmax-xmin);
          const xx = X(P);
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y1);
          ctx.stroke();

          // tick label
          ctx.fillStyle = 'rgba(255,255,255,0.70)';
          ctx.textAlign = 'center';
          ctx.textBaseline = 'top';
          ctx.fillText(P.toFixed(1), xx, y1 + 8);
        }

        // y ticks
        const yticks = 6;
        for(let k=0;k<=yticks;k++){
          const t = k/yticks;
          const v = ymin + t*(ymax-ymin);
          const yy = Y(v);
          ctx.beginPath();
          ctx.moveTo(x0, yy);
          ctx.lineTo(x1, yy);
          ctx.stroke();

          ctx.fillStyle = 'rgba(255,255,255,0.70)';
          ctx.textAlign = 'right';
          ctx.textBaseline = 'middle';
          ctx.fillText(v.toFixed(2), x0 - 8, yy);
        }

        // Axes
        ctx.strokeStyle = 'rgba(255,255,255,0.35)';
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x0, y1);
        ctx.lineTo(x1, y1);
        ctx.stroke();

        // Curve
        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.lineWidth = 2;
        ctx.beginPath();
        for(let i=0;i<pts.length;i++){
          const xx = X(pts[i].P);
          const yy = Y(pts[i].y);
          if(i===0) ctx.moveTo(xx,yy);
          else ctx.lineTo(xx,yy);
        }
        ctx.stroke();

        // Mark minima at P=0 and P=Ps (positive branch)
        const yAt0 = dF(0);
        const yAtPs = dF(Ps);

        function dot(px, py, r){
          ctx.beginPath();
          ctx.arc(px, py, r, 0, Math.PI*2);
          ctx.fill();
        }

        ctx.fillStyle = 'rgba(167,139,250,0.95)';
        dot(X(0), Y(yAt0), 4.2);
        dot(X(Ps), Y(yAtPs), 4.2);
        dot(X(-Ps), Y(yAtPs), 4.2);

        // Title
        ctx.fillStyle = 'rgba(255,255,255,0.90)';
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.font = '13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';
        ctx.fillText('Example: ΔF(P, Tc) with equal-depth minima (γ=1, g4=1, g6=1)', x0, 4);

        // Axis labels
        ctx.fillStyle = 'rgba(255,255,255,0.80)';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'bottom';
        ctx.fillText('P (example units)', (x0+x1)/2, H - 8);

        ctx.save();
        ctx.translate(16, (y0+y1)/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        ctx.fillText('ΔF (example units)', 0, 0);
        ctx.restore();

        // Legend
        const lx = x1 - 260, ly = y0 + 10;
        ctx.fillStyle = 'rgba(0,0,0,0.35)';
        ctx.strokeStyle = 'rgba(255,255,255,0.12)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        roundRect(ctx, lx, ly, 244, 54, 10);
        ctx.fill();
        ctx.stroke();

        // legend line
        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(lx + 12, ly + 18);
        ctx.lineTo(lx + 44, ly + 18);
        ctx.stroke();
        ctx.fillStyle = 'rgba(255,255,255,0.82)';
        ctx.textAlign = 'left';
        ctx.textBaseline = 'middle';
        ctx.fillText('ΔF(P, Tc)', lx + 52, ly + 18);

        // legend markers
        ctx.fillStyle = 'rgba(167,139,250,0.95)';
        dot(lx + 28, ly + 38, 3.8);
        ctx.fillStyle = 'rgba(255,255,255,0.82)';
        ctx.fillText('Minima at P = 0 and ±Ps', lx + 52, ly + 38);

        // helpers
        function roundRect(c, x, y, w, h, r){
          const rr = Math.min(r, w/2, h/2);
          c.moveTo(x+rr, y);
          c.arcTo(x+w, y, x+w, y+h, rr);
          c.arcTo(x+w, y+h, x, y+h, rr);
          c.arcTo(x, y+h, x, y, rr);
          c.arcTo(x, y, x+w, y, rr);
          c.closePath();
        }
      }

      // Render once and on resize
      let raf = null;
      function schedule(){
        if(raf) cancelAnimationFrame(raf);
        raf = requestAnimationFrame(render);
      }
      window.addEventListener('resize', schedule, {passive:true});
      schedule();
    })();
  </script>
</body>
</html>