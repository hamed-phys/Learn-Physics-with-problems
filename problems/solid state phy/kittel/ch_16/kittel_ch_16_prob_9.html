<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Soft Modes & Lattice Transformations in a 1D Monatomic Chain (Zone-Boundary Instability)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1620;
      --panel2:#0c121a;
      --text:#e7eef7;
      --muted:#a9b7c6;
      --line:#223244;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#86efac;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: var(--sans);
      background: radial-gradient(1200px 800px at 15% 10%, rgba(125,211,252,.10), transparent 60%),
                  radial-gradient(1000px 700px at 85% 20%, rgba(167,139,250,.10), transparent 60%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    header{
      padding: 28px 18px 18px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    header .wrap{
      max-width: 1200px;
      margin: 0 auto;
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    h1{
      margin:0;
      font-size: clamp(1.4rem, 2.2vw + 1rem, 2.3rem);
      letter-spacing:.2px;
    }
    .subtitle{
      color: var(--muted);
      max-width: 80ch;
      margin:0;
    }

    main{
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
    }

    nav.toc{
      position: sticky;
      top: 12px;
      align-self:start;
      background: rgba(15,22,32,.72);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 10px;
      backdrop-filter: blur(8px);
    }
    nav.toc h2{
      margin:0 0 8px;
      font-size: 1rem;
      color: var(--text);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .toc small{color:var(--muted)}
    .toc a{
      display:block;
      color: var(--muted);
      text-decoration:none;
      padding: 7px 10px;
      border-radius: 10px;
      border: 1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size: .95rem;
    }
    .toc a:hover{
      background: rgba(125,211,252,.08);
      border-color: rgba(125,211,252,.25);
      transform: translateX(2px);
      color: var(--text);
    }
    .toc .toplink{
      margin-top: 10px;
      font-size:.9rem;
      color: var(--accent);
    }

    article{
      background: rgba(15,22,32,.55);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      backdrop-filter: blur(8px);
      min-width: 0;
    }

    section{
      margin: 18px 0 26px;
      scroll-margin-top: 70px;
    }
    section > h2{
      margin: 0 0 10px;
      font-size: 1.25rem;
      letter-spacing: .2px;
      display:flex;
      gap:10px;
      align-items:baseline;
    }
    section > h2 span.tag{
      font-size:.78rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--muted);
    }
    h3{
      margin: 14px 0 8px;
      font-size: 1.05rem;
      color: var(--text);
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    .card{
      background: rgba(12,18,26,.85);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 12px 12px;
    }
    .card h3{margin-top:0}
    ul{margin: 8px 0 0 18px}
    li{margin: 6px 0}
    .muted{color:var(--muted)}
    .eqbox, .ansbox{
      position: relative;
      background: linear-gradient(180deg, rgba(125,211,252,.08), rgba(12,18,26,.85));
      border: 1px solid rgba(125,211,252,.25);
      border-radius: 14px;
      padding: 12px 12px 12px;
      margin: 10px 0;
      overflow:hidden;
    }
    .eqbox .label, .ansbox .label{
      font-size:.8rem;
      color: var(--muted);
      margin-bottom: 6px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    pre{
      margin:0;
      padding: 10px;
      border-radius: 12px;
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.08);
      overflow:auto;
      font-family: var(--mono);
      font-size: .92rem;
      line-height:1.45;
      color: #dbeafe;
      white-space: pre-wrap;
    }
    code{font-family: var(--mono)}
    .btn{
      cursor:pointer;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 7px 10px;
      border-radius: 10px;
      font-size: .85rem;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.10);
      border-color: rgba(125,211,252,.30);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      font-size: .86rem;
    }

    .callouts{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 10px;
    }
    .callout{
      border-radius: 14px;
      border:1px solid var(--line);
      padding: 12px;
      background: rgba(12,18,26,.85);
    }
    .callout strong{display:block; margin-bottom:6px}
    .callout.assumptions{border-color: rgba(167,139,250,.35)}
    .callout.mistakes{border-color: rgba(251,191,36,.35)}
    .callout.math{border-color: rgba(125,211,252,.35)}
    .callout.final{border-color: rgba(134,239,172,.35)}

    details{
      border: 1px solid var(--line);
      background: rgba(12,18,26,.72);
      border-radius: 14px;
      padding: 10px 12px;
      margin: 10px 0;
    }
    details summary{
      cursor:pointer;
      color: var(--text);
      font-weight:600;
    }
    details p, details ul{color:var(--muted)}
    figure{
      margin: 12px 0;
      padding: 12px;
      border-radius: 14px;
      background: rgba(12,18,26,.85);
      border: 1px solid var(--line);
    }
    figcaption{
      color: var(--muted);
      font-size:.92rem;
      margin-top: 8px;
    }
    canvas{
      width: 100%;
      height: 320px;
      display:block;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }

    footer{
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px;
      color: var(--muted);
      font-size:.92rem;
    }

    @media (max-width: 980px){
      main{grid-template-columns: 1fr}
      nav.toc{position: relative; top:auto}
      .grid2, .callouts{grid-template-columns: 1fr}
    }

    /* Print-friendly */
    @media print{
      body{background:white; color:black}
      nav.toc{display:none}
      article{box-shadow:none; background:white; border: 1px solid #bbb}
      pre{background:#f6f6f6; color:black}
      .btn{display:none}
      a{color:black; text-decoration:none}
      section{break-inside: avoid-page}
      figure{break-inside: avoid-page}
    }
  </style>
</head>

<body id="top">
<header>
  <div class="wrap">
    <h1>Soft Modes & Lattice Transformations in a 1D Monatomic Chain</h1>
    <p class="subtitle">
      Zone-boundary longitudinal phonons can “soften” to zero frequency at a critical temperature, signaling a structural
      instability (a lattice transformation). We’ll build the mathematical model, sketch the displacement pattern,
      identify the low-temperature structure, and summarize the dispersion curves above, at, and below the transition.
    </p>
    <div class="pill" title="Scope">
      <span>1D lattice</span><span class="muted">•</span><span>longitudinal phonons</span><span class="muted">•</span><span>soft-mode transition</span>
    </div>
  </div>
</header>

<main>
  <nav class="toc" aria-label="Table of contents">
    <h2>Contents <small>sticky</small></h2>
    <a href="#quick">Quick Summary</a>
    <a href="#part0">PART 0 — Concept Primer</a>
    <a href="#part0b">PART 0B — Industry & Applied Physics</a>
    <a href="#part1">PART 1 — Problem Analysis</a>
    <a href="#part2">PART 2 — Strategy & Tips</a>
    <a href="#part3">PART 3 — Full Solution</a>
    <a href="#part4">PART 4 — Deeper Understanding</a>
    <a href="#part5">PART 5 — Optional Plot Guide</a>
    <a class="toplink" href="#top">Back to top ↑</a>
  </nav>

  <article>
    <section id="quick">
      <h2>Quick Summary <span class="tag">fast</span></h2>
      <ul>
        <li><strong>What this is:</strong> a 1D monatomic chain (spacing <code>a</code>) whose <strong>zone-boundary longitudinal phonon</strong> becomes unstable as temperature crosses <code>Tc</code>.</li>
        <li><strong>Key idea:</strong> a <em>soft mode</em> means the renormalized frequency satisfies <code>ω(k*) → 0</code> (here <code>k* = π/a</code>), so the lattice prefers a new static distortion with the same wavevector.</li>
        <li><strong>Governing equations:</strong> discrete Newton’s law + harmonic force; normal modes <code>u_n(t)=U e^{i(kna-ωt)}</code> give a dispersion relation <code>ω(k)</code>.</li>
        <li><strong>Monatomic dispersion (harmonic nearest-neighbor):</strong> <code>ω(k)=2√(K/M)|sin(ka/2)|</code> (acoustic branch).</li>
        <li><strong>Softening at zone boundary:</strong> phenomenologically <code>ω^2(π/a,T) ∝ (T − Tc)</code>, so it vanishes at <code>T=Tc</code> and becomes negative below <code>Tc</code> (instability).</li>
        <li><strong>Resulting structure below <code>Tc</code>:</strong> <strong>doubling of the unit cell</strong> (period <code>2a</code>) with alternating displacements: <code>+ − + − ...</code> (a dimerized/Peierls-like pattern).</li>
        <li><strong>New phonons below <code>Tc</code>:</strong> a two-atom basis implies <strong>two branches</strong> in the reduced Brillouin zone: an acoustic branch and an optical branch (often with a gap controlled by the distortion).</li>
        <li><strong>Industrial meaning:</strong> soft modes underpin displacive phase transitions that change elastic constants, thermal transport, and reliability (e.g., ferroelectrics, shape-memory alloys, thermo-mechanically cycled components).</li>
      </ul>
    </section>

    <section id="part0">
      <h2>PART 0 — Concept Primer <span class="tag">theory</span></h2>

      <div class="grid2">
        <div class="card">
          <h3>Core definitions (symbols & SI units)</h3>
          <ul>
            <li><code>a</code>: lattice constant (m)</li>
            <li><code>n</code>: integer site index; equilibrium position <code>x_n = n a</code></li>
            <li><code>u_n(t)</code>: longitudinal displacement of atom <code>n</code> from equilibrium (m)</li>
            <li><code>M</code>: atomic mass (kg)</li>
            <li><code>K</code>: nearest-neighbor harmonic spring constant (N/m)</li>
            <li><code>k</code>: wavevector (1/m), defined modulo reciprocal lattice vectors</li>
            <li><code>ω</code>: angular frequency (rad/s)</li>
            <li><code>Tc</code>: critical temperature of structural transition (K)</li>
          </ul>
        </div>
        <div class="card">
          <h3>Physical meaning (intuition)</h3>
          <ul>
            <li><strong>Phonon:</strong> collective vibration mode; in 1D, longitudinal means atoms move along the chain.</li>
            <li><strong>Zone boundary:</strong> edge of the Brillouin zone; for monatomic spacing <code>a</code>, the first BZ is <code>k ∈ [−π/a, π/a]</code>.</li>
            <li><strong>Soft mode:</strong> a specific phonon whose restoring force disappears as a control parameter changes; mathematically <code>ω^2 → 0</code>.</li>
            <li><strong>Instability:</strong> if <code>ω^2 &lt; 0</code>, the harmonic equilibrium is unstable and the system distorts to a new equilibrium (new crystal structure).</li>
          </ul>
        </div>
      </div>

      <h3>Key laws / principles (and validity)</h3>
      <ul>
        <li><strong>Discrete Newton’s 2nd law</strong> (linear regime): <code>M d²u_n/dt² = F_n</code>.</li>
        <li><strong>Harmonic approximation:</strong> expand interatomic potential to quadratic order in displacements; valid for small <code>|u_n|/a</code> and not too close to melting.</li>
        <li><strong>Translation invariance</strong> in the high-<code>T</code> phase implies normal modes are plane waves (Fourier eigenmodes of a discrete Laplacian).</li>
        <li><strong>Phase transition idea:</strong> temperature renormalizes effective force constants (via anharmonicity/electron-phonon coupling); a particular eigenvalue of the dynamical matrix can cross zero.</li>
      </ul>

      <div class="callouts">
        <div class="callout math">
          <strong>Math Insight (core equation as an object)</strong>
          <div class="muted">
            The normal-mode problem is an <strong>eigenvalue problem</strong> for the (mass-weighted) dynamical matrix:
            plane waves diagonalize the discrete translation-invariant operator. The dispersion relation is the eigenvalue map
            <code>k ↦ ω(k)</code>, with <code>ω²</code> as the eigenvalue of a discrete Laplacian-like operator.
          </div>
        </div>
        <div class="callout assumptions">
          <strong>Assumptions (high-T phase model)</strong>
          <ul class="muted">
            <li>1D infinite or periodic chain (Born–von Kármán boundary conditions).</li>
            <li>Identical atoms (monatomic), nearest-neighbor harmonic forces only.</li>
            <li>Small displacements: linearization is valid.</li>
          </ul>
        </div>
      </div>

      <h3>Common models / approximations used here (and why)</h3>
      <ul>
        <li><strong>Nearest-neighbor springs:</strong> simplest model capturing acoustic phonons and zone-boundary behavior.</li>
        <li><strong>Mean-field softening:</strong> represent temperature effects by <code>ω²(k*,T)=A(T−Tc)</code> near the critical point; captures instability criterion without detailed anharmonic calculations.</li>
        <li><strong>Low-T structure as doubled cell:</strong> the unstable mode at <code>k*=π/a</code> has period <code>2a</code>, so the new equilibrium must reflect that periodicity.</li>
      </ul>

      <h3>Mini intuition examples (no heavy algebra)</h3>
      <ul>
        <li><strong>k≈0 (long wavelength):</strong> all atoms move almost in phase → looks like sound; <code>ω ≈ v_s |k|</code>.</li>
        <li><strong>k=π/a (zone boundary):</strong> neighbors are out of phase: <code>+ − + −</code>; this is the highest-frequency standing wave in the simple monatomic spring model.</li>
        <li><strong>Softening:</strong> if the “stiffness” for the <code>+ − + −</code> pattern decreases with cooling, at some point it costs no energy to adopt it statically → new structure.</li>
      </ul>

      <h3>What to watch for (pitfalls)</h3>
      <ul>
        <li>Confusing <strong>zone boundary</strong> (<code>k=π/a</code>) with <strong>zone center</strong> (<code>k=0</code>) after the unit cell doubles (reciprocal lattice changes).</li>
        <li>Thinking <code>ω=0</code> automatically means “rigid translation” only; at a critical point, <code>ω=0</code> can occur at nonzero <code>k</code> (soft mode).</li>
        <li>For the low-T phase, forgetting there are now <strong>two phonon branches</strong> (acoustic + optical) because the basis has two atoms.</li>
      </ul>
    </section>

    <section id="part0b">
      <h2>PART 0B — Industry & Applied Physics Perspective <span class="tag">applied</span></h2>
      <div class="grid2">
        <div class="card">
          <h3>Where this appears (3+ application areas)</h3>
          <ul>
            <li><strong>Ferroelectrics / piezoelectrics:</strong> soft transverse optic modes drive displacive transitions (actuators, ultrasound transducers, precision positioning).</li>
            <li><strong>Shape-memory & martensitic systems:</strong> precursor softening affects damping, fatigue, and transformation temperatures (aerospace, automotive, medical stents).</li>
            <li><strong>Thermal transport engineering:</strong> soft modes increase phonon scattering and lower thermal conductivity (thermoelectrics, thermal barrier coatings).</li>
            <li><strong>Semiconductor & CDW materials:</strong> zone-boundary (or finite-k) instabilities relate to charge-density waves and device-temperature stability.</li>
          </ul>
        </div>
        <div class="card">
          <h3>Why engineers care</h3>
          <ul>
            <li><strong>Performance:</strong> elastic constants and sound speed change near <code>Tc</code> (stiffness, resonance frequencies).</li>
            <li><strong>Reliability:</strong> repeated thermal cycling through <code>Tc</code> can cause microcracking, hysteresis losses, or domain formation.</li>
            <li><strong>Manufacturability:</strong> controlling cooling rates and composition tunes <code>Tc</code> and the distortion amplitude.</li>
            <li><strong>Cost/efficiency:</strong> targeted phase transitions can be exploited (actuation) or avoided (dimensional stability).</li>
          </ul>
        </div>
      </div>

      <h3>Typical measurement / validation methods</h3>
      <ul>
        <li><strong>Inelastic neutron or x-ray scattering:</strong> measures <code>ω(k)</code> directly; softening shows up as a phonon branch dropping toward zero at a particular <code>k</code>.</li>
        <li><strong>Raman/IR spectroscopy:</strong> optical modes (especially at zone center) and symmetry changes in the low-T phase.</li>
        <li><strong>Ultrasonic/Brillouin scattering:</strong> tracks sound velocity and elastic constant anomalies near <code>Tc</code>.</li>
        <li><strong>Diffraction (x-ray/electron):</strong> detects new periodicity (superlattice peaks) when the unit cell doubles.</li>
      </ul>

      <h3>Design trade-offs & non-idealities</h3>
      <ul>
        <li><strong>Anharmonicity & defects:</strong> broaden modes, shift <code>Tc</code>, and can pin the distortion (domains).</li>
        <li><strong>Finite size / interfaces:</strong> thin films can suppress or enhance softening via strain boundary conditions.</li>
        <li><strong>Thermal gradients:</strong> may produce mixed-phase regions, affecting mechanical integrity.</li>
      </ul>

      <details>
        <summary>From lab to product (how the ideal model is adapted)</summary>
        <p>
          Real materials are not perfect 1D springs: engineers use temperature-dependent elastic constants, multi-branch phonon
          models, and microstructure-aware constitutive laws. Soft-mode physics often enters through (i) fitted
          <code>ω²(T)</code> trends near <code>Tc</code>, (ii) Landau-type free energies coupled to strain, and (iii) finite-element
          models with phase-fraction evolution under thermal cycling.
        </p>
      </details>
    </section>

    <section id="part1">
      <h2>PART 1 — Problem Analysis <span class="tag">setup</span></h2>

      <h3>Problem restatement (in plain words)</h3>
      <p class="muted">
        We have a monatomic 1D lattice with spacing <code>a</code>. A longitudinal phonon at the <strong>zone boundary</strong>
        (<code>k = π/a</code>) becomes <strong>soft</strong>: as we cool through <code>Tc</code>, its frequency goes to zero.
        (a) Sketch the chain and show the displacement directions for six atoms for that zone-boundary longitudinal mode.
        (b) Sketch the new crystal structure that results once the mode becomes unstable (below <code>Tc</code>).
        (c) On one graph, sketch the key features of the longitudinal phonon dispersion well above <code>Tc</code>, at <code>T=Tc</code>,
        and in the new structure well below <code>Tc</code>.
      </p>

      <div class="grid2">
        <div class="card">
          <h3>Given</h3>
          <ul>
            <li>Monatomic linear lattice, lattice constant <code>a</code></li>
            <li>Longitudinal phonon wavevector at zone boundary: <code>k* = π/a</code></li>
            <li>Softening criterion: <code>ω(k*,T) → 0</code> as <code>T → Tc</code></li>
          </ul>
        </div>
        <div class="card">
          <h3>Unknowns / what to produce</h3>
          <ul>
            <li>(a) Displacement pattern for 6 atoms at fixed time (direction arrows)</li>
            <li>(b) Resulting low-T structure (new periodicity / unit cell)</li>
            <li>(c) Qualitative dispersion sketches: above <code>Tc</code>, at <code>Tc</code>, and below <code>Tc</code> (new branches)</li>
          </ul>
        </div>
      </div>

      <h3>Relevant principles (and why they apply)</h3>
      <ul>
        <li><strong>Normal modes of a periodic chain:</strong> translation invariance implies plane-wave eigenmodes.</li>
        <li><strong>Zone-boundary mode structure:</strong> at <code>k=π/a</code>, neighboring atoms move opposite (phase difference π).</li>
        <li><strong>Soft-mode transition:</strong> when an eigenfrequency reaches zero, harmonic stability is lost and the equilibrium changes.</li>
        <li><strong>Symmetry/periodicity:</strong> a distortion at wavevector <code>k*</code> produces a new structure with real-space period <code>2π/k*</code>.</li>
      </ul>

      <div class="callouts">
        <div class="callout assumptions">
          <strong>Assumptions we will use</strong>
          <ul class="muted">
            <li>High-T phase: monatomic, nearest-neighbor harmonic chain (good for sketching dispersion).</li>
            <li>Temperature effect: encoded phenomenologically as a renormalization of the zone-boundary eigenvalue <code>ω²(k*,T)</code>.</li>
            <li>Below <code>Tc</code>: the stable structure has doubled periodicity (<code>2a</code> unit cell); phonons are those of a 2-atom basis chain.</li>
          </ul>
        </div>
        <div class="callout math">
          <strong>Mathematical model (explicit)</strong>
          <div class="muted">
            Variables: <code>u_n(t)</code> for <code>n ∈ ℤ</code> (or <code>n=0…N−1</code> with periodic BC).
            Domain: 1D discrete lattice positions <code>x_n=na</code>.
            Boundary conditions (for mode analysis): Born–von Kármán <code>u_{n+N}=u_n</code>.
            Operator form: a discrete Laplacian <code>(Δ_d u)_n = u_{n+1} - 2u_n + u_{n-1}</code>.
          </div>
        </div>
      </div>

      <h3>Possible approaches (compare)</h3>
      <ol>
        <li><strong>Discrete equation of motion + plane-wave ansatz</strong>: derive <code>ω(k)</code> and identify the zone-boundary eigenvector. <span class="muted">(Best for clarity & rigor.)</span></li>
        <li><strong>Dynamical matrix / Fourier transform</strong>: treat the lattice as an eigenvalue problem in k-space. <span class="muted">(Compact, emphasizes linear algebra.)</span></li>
        <li><strong>Landau soft-mode picture</strong>: use <code>ω²(k*,T)∝(T−Tc)</code> to connect instability to a new order parameter. <span class="muted">(Best for physics of the transition.)</span></li>
      </ol>

      <p class="muted">
        We’ll combine (1) and (3): first get the monatomic dispersion and eigenvector at <code>k*=π/a</code>, then use the soft-mode idea
        to infer the doubled-cell structure and sketch the low-T phonon branches.
      </p>
    </section>

    <section id="part2">
      <h2>PART 2 — Strategy & Tips <span class="tag">roadmap</span></h2>

      <ol>
        <li><strong>Write the discrete equation of motion</strong> using nearest-neighbor springs; identify the discrete Laplacian form.</li>
        <li><strong>Insert plane-wave trial solution</strong> <code>u_n(t)=U e^{i(kna-ωt)}</code> to diagonalize the operator (Fourier eigenmode argument).</li>
        <li><strong>Derive the monatomic dispersion</strong> <code>ω(k)</code>; evaluate at <code>k=π/a</code> to see the zone-boundary frequency above <code>Tc</code>.</li>
        <li><strong>Get the displacement pattern</strong> at <code>k=π/a</code>: analyze the phase factor <code>e^{ikna} = e^{iπn}=(-1)^n</code>.</li>
        <li><strong>Soft-mode criterion</strong>: interpret <code>ω(k*,T)→0</code> at <code>Tc</code> as vanishing restoring force for that pattern.</li>
        <li><strong>Infer new crystal structure</strong>: a static distortion with period <code>2a</code> doubles the unit cell.</li>
        <li><strong>Phonons below <code>Tc</code></strong>: treat as a 2-atom basis chain → two branches in reduced zone (acoustic + optical); note mode folding and gap formation.</li>
        <li><strong>Sketch dispersion</strong> on one graph: high-T monatomic curve, <code>T=Tc</code> curve touching zero at zone boundary, and low-T folded acoustic+optical branches.</li>
      </ol>

      <div class="callout mistakes">
        <strong>Common mistakes (quick tips)</strong>
        <ul class="muted">
          <li>At <code>k=π/a</code>, displacements alternate sign; don’t draw them all pointing the same way.</li>
          <li>After doubling the unit cell, the Brillouin zone halves: <code>q ∈ [−π/(2a), π/(2a)]</code>.</li>
          <li>The old zone boundary maps to the new zone center (because the reciprocal lattice vector changes).</li>
          <li>Don’t force a numeric plot from symbolic data: a qualitative sketch is the point; if plotted, use normalized units.</li>
        </ul>
      </div>
    </section>

    <section id="part3">
      <h2>PART 3 — Full Solution <span class="tag">derivation</span></h2>

      <h3>Physical intuition first (what we expect)</h3>
      <ul class="muted">
        <li>In a simple monatomic chain, the longitudinal mode at <code>k=π/a</code> is a standing wave where neighbors move oppositely.</li>
        <li>If that mode softens to <code>ω=0</code>, the lattice can adopt that displacement pattern as a <em>static</em> distortion without energy cost.</li>
        <li>A pattern with alternating sign has period <code>2a</code>, so the new structure should have a doubled unit cell.</li>
        <li>With two atoms per cell (basis), phonons split into acoustic and optical branches in the reduced zone.</li>
      </ul>

      <h3>Step 1: Equation of motion (discrete operator form)</h3>
      <p class="muted">
        Nearest-neighbor harmonic springs give a force on atom <code>n</code> proportional to relative extensions:
        <code>F_n = K[(u_{n+1}-u_n) - (u_n-u_{n-1})] = K(u_{n+1}-2u_n+u_{n-1})</code>.
        This is exactly a discrete Laplacian.
      </p>

      <div class="eqbox">
        <div class="label">
          <span><strong>Key equation (discrete wave/oscillator system)</strong></span>
          <button class="btn" data-copy="eq1">Copy equation</button>
        </div>
        <pre id="eq1">M d²u_n/dt² = K (u_{n+1} - 2u_n + u_{n-1})  ≡  K (Δ_d u)_n</pre>
      </div>

      <p class="muted">
        <strong>Why this step is valid:</strong> linearity follows from the harmonic (quadratic) potential approximation, so superposition holds and
        Fourier modes diagonalize the translation-invariant operator.
      </p>

      <h3>Step 2: Normal-mode ansatz (Fourier eigenmode)</h3>
      <p class="muted">
        Use periodic boundary conditions so plane waves form a complete basis. Let
        <code>u_n(t)=U e^{i(kna-ωt)}</code>. Then
        <code>u_{n±1} = U e^{i(k(n±1)a-ωt)} = u_n e^{±ika}</code>.
      </p>

      <div class="eqbox">
        <div class="label">
          <span><strong>Plane-wave substitution algebra</strong></span>
          <button class="btn" data-copy="eq2">Copy steps</button>
        </div>
        <pre id="eq2">(Δ_d u)_n = u_{n+1} - 2u_n + u_{n-1}
          = u_n (e^{ika} - 2 + e^{-ika})
          = u_n (2cos(ka) - 2)
          = -4 u_n sin²(ka/2)</pre>
      </div>

      <p class="muted">
        <strong>Why this diagonalizes the operator:</strong> the discrete Laplacian is shift-invariant in <code>n</code>, so its eigenvectors are Fourier modes;
        <code>e^{ikna}</code> is an eigenvector with eigenvalue <code>-4 sin²(ka/2)</code>.
      </p>

      <h3>Step 3: Monatomic longitudinal phonon dispersion (high-T phase)</h3>
      <p class="muted">
        Substitute the ansatz into the equation of motion. The time derivatives give
        <code>d²u_n/dt² = -ω² u_n</code>.
        Therefore:
        <code>-Mω² u_n = K(-4 sin²(ka/2)) u_n</code>.
        Cancel <code>u_n</code> (nontrivial mode) to obtain the dispersion.
      </p>

      <div class="eqbox">
        <div class="label">
          <span><strong>Dispersion relation (monatomic chain)</strong></span>
          <button class="btn" data-copy="eq3">Copy equation</button>
        </div>
        <pre id="eq3">ω²(k) = (4K/M) sin²(ka/2)
ω(k)  = 2 √(K/M) |sin(ka/2)|,   k ∈ [−π/a, π/a]</pre>
      </div>

      <details>
        <summary>Sanity checks (dimensions & limits)</summary>
        <ul>
          <li><strong>Units:</strong> <code>K/M</code> has units (N/m)/kg = (kg·m/s² / m)/kg = 1/s², so <code>ω</code> has 1/s.</li>
          <li><strong>Long wavelength:</strong> for small <code>x</code>, <code>sin x ≈ x</code> so
            <code>ω ≈ 2√(K/M) (|ka|/2) = a√(K/M)|k|</code>, i.e. sound with speed <code>v_s = a√(K/M)</code>.</li>
          <li><strong>Zone boundary:</strong> at <code>k=π/a</code>, <code>sin(π/2)=1</code>, so <code>ω(π/a)=2√(K/M)</code> in the simple harmonic model (i.e., normally not zero).</li>
        </ul>
      </details>

      <h3>(a) Displacement pattern at the zone boundary for 6 atoms</h3>
      <p class="muted">
        At fixed time (say <code>t=0</code>), the displacement is proportional to <code>e^{ikna} = e^{iπn} = (-1)^n</code>.
        Taking the real part gives alternating signs.
      </p>

      <div class="eqbox">
        <div class="label">
          <span><strong>Zone-boundary eigenvector (direction pattern)</strong></span>
          <button class="btn" data-copy="eq4">Copy pattern</button>
        </div>
        <pre id="eq4">k* = π/a  ⇒  u_n ∝ Re[(-1)^n] = (+1, −1, +1, −1, ...)

For six atoms n = 0,1,2,3,4,5:
u_0:  →
u_1:  ←
u_2:  →
u_3:  ←
u_4:  →
u_5:  ←</pre>
      </div>

      <p class="muted">
        <strong>Interpretation:</strong> neighbors are exactly out of phase (phase difference π). This is the highest-k standing wave in the monatomic Brillouin zone.
      </p>

      <h3>(b) Crystal structure that results when the mode becomes unstable</h3>
      <p class="muted">
        A phonon “going unstable” means the harmonic coefficient for that mode changes sign. A standard way to express softening is:
        <code>ω²(k*,T) = A (T − Tc)</code> with <code>A &gt; 0</code>.
        At <code>T=Tc</code>, <code>ω=0</code>. For <code>T&lt;Tc</code>, <code>ω²&lt;0</code> signals instability of the high-T equilibrium.
        The system lowers its free energy by developing a <em>static distortion</em> with the same spatial dependence:
        <code>u_n = u0 (-1)^n</code>.
      </p>

      <div class="callout final">
        <strong>Resulting low-T structure (sketch description)</strong>
        <div class="muted">
          The distortion <code>u_n = u0(-1)^n</code> has period <code>2a</code>, so the <strong>unit cell doubles</strong>.
          Equivalently, the new Bravais lattice has lattice constant <code>a' = 2a</code> with a two-atom basis.
          In real space: atoms shift alternately right/left, producing a dimerized pattern.
        </div>
      </div>

      <details>
        <summary>Why the period must double (one-line math)</summary>
        <p class="muted">
          The unstable mode has wavevector <code>k*=π/a</code> so its real-space periodicity is <code>λ = 2π/k* = 2a</code>.
          A static order parameter inheriting that modulation must repeat every <code>2a</code>.
        </p>
      </details>

      <h3>(c) Dispersion above <code>Tc</code>, at <code>Tc</code>, and below <code>Tc</code></h3>

      <h3>High temperature: monatomic acoustic branch</h3>
      <p class="muted">
        Well above <code>Tc</code>, the chain is stable and monatomic; the dispersion is the standard acoustic curve:
        <code>ω(k)=2√(K/M)|sin(ka/2)|</code>, with a nonzero value at the zone boundary.
      </p>

      <h3>At <code>T=Tc</code>: zone-boundary softening</h3>
      <p class="muted">
        The key qualitative change is that <code>ω(π/a)</code> drops to zero. In soft-mode language the relevant eigenvalue of the dynamical matrix satisfies:
      </p>

      <div class="eqbox">
        <div class="label">
          <span><strong>Soft-mode criterion (phenomenological)</strong></span>
          <button class="btn" data-copy="eq5">Copy equation</button>
        </div>
        <pre id="eq5">ω²(k*=π/a, T) = A (T − Tc),   A &gt; 0
⇒ ω(π/a, Tc) = 0</pre>
      </div>

      <p class="muted">
        <strong>Meaning:</strong> the restoring force for the alternating <code>+ − + −</code> displacement pattern vanishes at <code>Tc</code>.
      </p>

      <h3>Below <code>Tc</code>: phonons in the new doubled-cell structure</h3>
      <p class="muted">
        Once the unit cell doubles (<code>a' = 2a</code>), the reciprocal lattice vector halves, so the <strong>reduced Brillouin zone</strong> is
        <code>q ∈ [−π/(2a), π/(2a)]</code>.
        A two-atom basis implies two normal-mode branches:
        <strong>acoustic</strong> (<code>ω(q)→0</code> as <code>q→0</code>) and <strong>optical</strong> (finite <code>ω</code> at <code>q=0</code>).
      </p>

      <p class="muted">
        A minimal (and common) way to model the low-T phase in 1D is to allow alternating bond stiffnesses <code>K1</code>, <code>K2</code>
        (dimerization). With equal masses <code>M</code> and cell length <code>2a</code>, the dispersion becomes:
      </p>

      <div class="eqbox">
        <div class="label">
          <span><strong>Low-T (dimerized) dispersion: acoustic + optical</strong></span>
          <button class="btn" data-copy="eq6">Copy equation</button>
        </div>
        <pre id="eq6">q ∈ [−π/(2a), π/(2a)]  (reduced zone)

ω²_±(q) = (K1+K2)/M  ±  (1/M) √(K1² + K2² + 2K1K2 cos(2qa))

"−" : acoustic branch   (ω_−(0)=0)
"+" : optical branch    (ω_+(0)=√(2(K1+K2)/M))</pre>
      </div>

      <details>
        <summary>How this connects to the soft mode (mapping old zone boundary to new zone center)</summary>
        <p class="muted">
          When the cell doubles, the new reciprocal lattice vector is <code>G' = π/a</code>.
          Therefore the old wavevector <code>k*=π/a</code> is equivalent to <code>q=0</code> in the new zone (since <code>k* = G'</code>).
          So the mode that softened at the old zone boundary becomes a zone-center mode of the low-T phase (and the distortion is a
          zone-center order parameter in the doubled-cell description).
        </p>
      </details>

      <figure>
        <canvas id="dispersionCanvas" aria-label="Phonon dispersion sketch"></canvas>
        <figcaption>
          <strong>One-graph sketch:</strong> High-<code>T</code> monatomic acoustic dispersion (normalized units), a critical curve touching
          <code>ω=0</code> at the old zone boundary, and the low-<code>T</code> doubled-cell acoustic + optical branches in the reduced zone.
          (Curves are illustrative/normalized; the <em>features</em> are the key.)
        </figcaption>
      </figure>

      <div class="ansbox">
        <div class="label">
          <span><strong>Final answer (plain text)</strong></span>
          <button class="btn" data-copy="finalAnswer">Copy final answer</button>
        </div>
        <pre id="finalAnswer">(a) Zone-boundary longitudinal phonon for a monatomic chain (k = π/a):
    u_n(t) = Re[U e^{i(kna − ωt)}] ⇒ at fixed time, u_n ∝ cos(πn) = (−1)^n.
    For six atoms (n=0…5): →, ←, →, ←, →, ← (neighbors out of phase).

(b) When this k = π/a mode becomes unstable (ω → 0 at Tc), the chain adopts a static distortion with the same
    spatial periodicity λ = 2π/k = 2a:
    u_n = u0 (−1)^n.  This doubles the real-space period and the unit cell becomes 2a (two-atom basis).
    The new structure is a dimerized/alternating-displacement lattice.

(c) Dispersion sketches (qualitative):
    • For T >> Tc (high-T monatomic phase): one acoustic branch
        ω(k) = 2 √(K/M) |sin(ka/2)|,  k ∈ [−π/a, π/a],
      with ω(π/a) = 2√(K/M) (nonzero).
    • At T = Tc: the zone-boundary eigenfrequency softens to zero:
        ω(π/a, Tc) = 0, often captured by ω²(π/a, T) = A(T − Tc).
    • For T << Tc (low-T doubled-cell phase): reduced Brillouin zone q ∈ [−π/(2a), π/(2a)] and two branches:
        ω²_±(q) = (K1+K2)/M ± (1/M) √(K1² + K2² + 2K1K2 cos(2qa)),
      giving an acoustic branch (ω_−(0)=0) and an optical branch (finite ω_+(0)), i.e., mode folding and (generally) a gap.</pre>
      </div>

      <details>
        <summary>Extra rigor: stability as a sign of an eigenvalue</summary>
        <p class="muted">
          In linear lattice dynamics, <code>ω²</code> are eigenvalues of the mass-weighted dynamical matrix.
          Stability requires <code>ω² ≥ 0</code> for all modes. A soft mode is the approach of the minimum eigenvalue to zero.
          Below <code>Tc</code>, that eigenvalue becomes negative in the high-T reference structure, meaning the harmonic expansion
          is about the wrong equilibrium. The correct equilibrium shifts along the corresponding eigenvector (here: <code>(−1)^n</code>),
          restoring nonnegative eigenvalues in the new phase.
        </p>
      </details>
    </section>

    <section id="part4">
      <h2>PART 4 — Deeper Understanding <span class="tag">insight</span></h2>

      <h3>Re-interpret the final formulas: what controls what?</h3>
      <ul class="muted">
        <li>In the monatomic phase, <code>K/M</code> sets the overall frequency scale; <code>a</code> sets the slope near <code>k=0</code> (sound speed <code>v_s=a√(K/M)</code>).</li>
        <li>The soft-mode statement <code>ω²(k*,T)=A(T−Tc)</code> says temperature tunes an <em>effective stiffness</em> (eigenvalue) of the lattice for that pattern.</li>
        <li>In the doubled-cell phase, the <em>difference</em> between <code>K1</code> and <code>K2</code> encodes the distortion: it typically opens a separation between folded branches (a “gap” feature in the sketch).</li>
      </ul>

      <h3>Parameter dependence (qualitative)</h3>
      <ul class="muted">
        <li><strong>Increase mass <code>M</code>:</strong> all phonon frequencies decrease like <code>1/√M</code>.</li>
        <li><strong>Increase stiffness (springs):</strong> frequencies increase like <code>√K</code> (or <code>√(K1+K2)</code> below <code>Tc</code>).</li>
        <li><strong>Approach <code>Tc</code> from above:</strong> the zone-boundary frequency decreases; the lattice becomes “soft” to alternating distortions.</li>
        <li><strong>Stronger dimerization (larger <code>|K1−K2|</code>):</strong> the separation between branches at the reduced-zone boundary increases (more pronounced structural change).</li>
      </ul>

      <h3>Alternative derivation idea (brief but meaningful)</h3>
      <p class="muted">
        Instead of the spring-chain derivation, one can write the dynamical matrix <code>D(k)</code> directly from translational symmetry.
        For the monatomic chain, <code>D(k) = (2K/M)(1−cos ka)</code>, so <code>ω²(k)=D(k)</code>. For the doubled-cell phase,
        <code>D(q)</code> becomes a <strong>2×2 matrix</strong> (two sublattices), whose eigenvalues are <code>ω²_±(q)</code>.
        This makes the “two branches” result immediate from linear algebra.
      </p>

      <div class="callouts">
        <div class="callout math">
          <strong>Math Insight (Sturm–Liouville analogue, discretized)</strong>
          <div class="muted">
            The discrete operator <code>Δ_d</code> is the lattice analogue of a second derivative (<code>∂²/∂x²</code>).
            The dispersion <code>ω² ∝ -eigenvalue(Δ_d)</code> mirrors how continuous wave equations yield <code>ω² ∝ k²</code>,
            but with lattice periodicity replacing continuum scaling via <code>sin(ka/2)</code>.
          </div>
        </div>
        <div class="callout mistakes">
          <strong>Concept checks (self-test with answers)</strong>
          <ul class="muted">
            <li><strong>Q:</strong> Why does <code>k=π/a</code> give alternating displacements? <strong>A:</strong> <code>e^{ikna}=e^{iπn}=(-1)^n</code>.</li>
            <li><strong>Q:</strong> What is the new real-space period of the distortion? <strong>A:</strong> <code>λ=2π/k=2a</code>.</li>
            <li><strong>Q:</strong> Why do we get two branches below <code>Tc</code>? <strong>A:</strong> two atoms per unit cell → a 2×2 dynamical matrix → two eigenvalues.</li>
            <li><strong>Q:</strong> What does <code>ω²&lt;0</code> mean physically? <strong>A:</strong> exponential growth in time in the linearized equation → instability of that equilibrium.</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="part5">
      <h2>PART 5 — Optional Plot Guide <span class="tag">plot</span></h2>
      <p class="muted">
        The plot is qualitative but useful because it puts all three requested regimes on one set of axes:
        the high-<code>T</code> monatomic acoustic curve, the critical softening (touching <code>ω=0</code> at the old zone boundary),
        and the low-<code>T</code> doubled-cell phonons (acoustic + optical) in the reduced zone (mode folding).
      </p>
      <ul class="muted">
        <li><strong>x-axis:</strong> wavevector (normalized). The figure shows the old-zone range <code>0 → π/a</code> and indicates the reduced-zone boundary <code>π/(2a)</code>.</li>
        <li><strong>y-axis:</strong> normalized frequency <code>ω/ω0</code>, where <code>ω0 = 2√(K/M)</code> is the high-T zone-boundary frequency scale.</li>
        <li><strong>What to notice:</strong>
          (i) high-T curve is nonzero at <code>π/a</code>;
          (ii) at <code>Tc</code> the curve hits zero at <code>π/a</code>;
          (iii) below <code>Tc</code> there are two branches (acoustic + optical) in the reduced zone, consistent with a doubled unit cell.
        </li>
      </ul>
    </section>

    <p class="muted"><a href="#top" style="color:var(--accent); text-decoration:none;">Back to top ↑</a></p>
  </article>
</main>

<footer>
  <div>
    <strong>Note:</strong> The exact microscopic cause of softening (anharmonicity, electron-phonon coupling, etc.) is material-specific.
    This article focuses on the universal lattice-dynamics logic: <em>soft mode → instability → new periodicity → new phonon branches</em>.
  </div>
</footer>

<script>
  // Copy buttons
  (function(){
    function copyTextFromElementId(id){
      const el = document.getElementById(id);
      if(!el) return;
      const text = el.innerText;
      navigator.clipboard.writeText(text).then(()=>flash(el), ()=>fallbackCopy(text));
    }
    function fallbackCopy(text){
      const ta = document.createElement('textarea');
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      try{ document.execCommand('copy'); }catch(e){}
      document.body.removeChild(ta);
    }
    function flash(el){
      el.style.outline = "2px solid rgba(134,239,172,.55)";
      setTimeout(()=>{ el.style.outline = "none"; }, 450);
    }
    document.querySelectorAll('[data-copy]').forEach(btn=>{
      btn.addEventListener('click', ()=> copyTextFromElementId(btn.getAttribute('data-copy')));
    });
  })();

  // Simple static plot on canvas (normalized, illustrative)
  (function(){
    const canvas = document.getElementById('dispersionCanvas');
    if(!canvas) return;
    const ctx = canvas.getContext('2d');

    function draw(){
      const dpr = window.devicePixelRatio || 1;
      const rect = canvas.getBoundingClientRect();
      canvas.width = Math.max(2, Math.floor(rect.width * dpr));
      canvas.height = Math.max(2, Math.floor(rect.height * dpr));
      ctx.setTransform(dpr,0,0,dpr,0,0);

      const W = rect.width, H = rect.height;
      ctx.clearRect(0,0,W,H);

      // Layout
      const padL=56, padR=16, padT=28, padB=46;
      const x0=padL, y0=padT, x1=W-padR, y1=H-padB;
      const plotW = x1-x0, plotH = y1-y0;

      // Background
      ctx.fillStyle = "rgba(0,0,0,0.16)";
      roundRect(ctx, x0, y0, plotW, plotH, 10);
      ctx.fill();

      // Axes + grid
      ctx.strokeStyle = "rgba(255,255,255,0.16)";
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.moveTo(x0,y1); ctx.lineTo(x1,y1);
      ctx.moveTo(x0,y0); ctx.lineTo(x0,y1);
      ctx.stroke();

      const nx=6, ny=5;
      for(let i=1;i<nx;i++){
        const x = x0 + plotW*i/nx;
        ctx.strokeStyle = "rgba(255,255,255,0.08)";
        ctx.beginPath(); ctx.moveTo(x,y0); ctx.lineTo(x,y1); ctx.stroke();
      }
      for(let j=1;j<ny;j++){
        const y = y0 + plotH*j/ny;
        ctx.strokeStyle = "rgba(255,255,255,0.08)";
        ctx.beginPath(); ctx.moveTo(x0,y); ctx.lineTo(x1,y); ctx.stroke();
      }

      // Axis labels
      ctx.fillStyle = "rgba(231,238,247,0.92)";
      ctx.font = "600 13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText("Qualitative longitudinal phonon dispersion (normalized)", x0, 16);

      ctx.fillStyle = "rgba(169,183,198,0.95)";
      ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText("wavevector k  (0 → π/a), with reduced-zone boundary at π/(2a)", x0, H-16);

      // y-axis label (rotated)
      ctx.save();
      ctx.translate(16, y0 + plotH/2);
      ctx.rotate(-Math.PI/2);
      ctx.fillText("ω / ω0  (ω0 = 2√(K/M), example normalization)", 0, 0);
      ctx.restore();

      // Tick labels (x)
      const ticks = [
        {t:0, label:"0"},
        {t:0.5, label:"π/(2a)"},
        {t:1, label:"π/a"}
      ];
      ctx.fillStyle = "rgba(169,183,198,0.95)";
      ticks.forEach(obj=>{
        const x = x0 + plotW*obj.t;
        ctx.strokeStyle = "rgba(255,255,255,0.16)";
        ctx.beginPath(); ctx.moveTo(x,y1); ctx.lineTo(x,y1+6); ctx.stroke();
        ctx.fillText(obj.label, x-14, y1+22);
      });

      // Map functions: kNorm in [0,1] corresponds to k in [0, π/a]
      // High-T: ω/ω0 = sin( (ka)/2 ) with ω0 chosen so boundary is 1.
      // Since ka = π*kNorm, ω/ω0 = sin( (π*kNorm)/2 ).
      function wHigh(kN){
        return Math.sin(Math.PI*kN/2);
      }
      // At Tc: qualitative softening to 0 at k=π/a while keeping linear near k=0.
      // Use ω/ω0 = sin(πkN/2) * sqrt(1 - sin^2(πkN/2)) = sin(.) cos(.)
      function wTc(kN){
        const s = Math.sin(Math.PI*kN/2);
        const c = Math.cos(Math.PI*kN/2);
        return Math.abs(s*c);
      }
      // Low-T doubled cell: show acoustic and optical in reduced zone [0,0.5] then fold.
      // Use illustrative forms (not fitted): acoustic ~ sin(π kN) on [0,0.5]; optical ~ sqrt(gap^2 + cos^2(π kN)).
      const gap = 0.35; // illustrative gap for optical at zone center in reduced zone (example only)
      function wAcLow(kN){
        // in reduced zone, q runs 0..π/(2a) so kN in 0..0.5
        const x = Math.min(0.5, Math.max(0, kN));
        return Math.sin(Math.PI*x); // linear near 0, reaches 1 at x=0.5
      }
      function wOpLow(kN){
        const x = Math.min(0.5, Math.max(0, kN));
        const c = Math.cos(Math.PI*x); // 1 at 0, 0 at 0.5
        return Math.sqrt(gap*gap + (1-gap*gap)*(c*c));
      }

      // Helper to plot a curve
      function plotCurve(fn, color, dash){
        ctx.save();
        ctx.strokeStyle = color;
        ctx.lineWidth = 2;
        ctx.setLineDash(dash || []);
        ctx.beginPath();
        const N=220;
        for(let i=0;i<=N;i++){
          const kN = i/N;
          const w = fn(kN); // normalized 0..1
          const x = x0 + plotW*kN;
          const y = y1 - plotH*w;
          if(i===0) ctx.moveTo(x,y);
          else ctx.lineTo(x,y);
        }
        ctx.stroke();
        ctx.restore();
      }

      // High-T (accent)
      plotCurve(wHigh, "rgba(125,211,252,0.95)", []);

      // Tc (accent2, dashed)
      plotCurve(wTc, "rgba(167,139,250,0.95)", [6,4]);

      // Low-T branches (greenish): plot only on reduced zone [0,0.5] and mirror as "folding" into [0.5,1]
      function plotFolded(fnHalf, color){
        ctx.save();
        ctx.strokeStyle = color;
        ctx.lineWidth = 2;
        ctx.setLineDash([]);
        // first half
        ctx.beginPath();
        const N=160;
        for(let i=0;i<=N;i++){
          const kN = 0.5*i/N;
          const w = fnHalf(kN);
          const x = x0 + plotW*kN;
          const y = y1 - plotH*w;
          if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
        }
        ctx.stroke();

        // folded copy in second half (mirror around 0.5): kN' = 1 - kN
        ctx.beginPath();
        for(let i=0;i<=N;i++){
          const kN = 0.5*i/N;
          const kN2 = 1 - kN;
          const w = fnHalf(kN);
          const x = x0 + plotW*kN2;
          const y = y1 - plotH*w;
          if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
        }
        ctx.stroke();
        ctx.restore();
      }
      plotFolded(wAcLow, "rgba(134,239,172,0.92)");
      plotFolded(wOpLow, "rgba(134,239,172,0.55)");

      // Mark reduced-zone boundary
      const xb = x0 + plotW*0.5;
      ctx.strokeStyle = "rgba(251,191,36,0.45)";
      ctx.lineWidth = 1.5;
      ctx.setLineDash([4,4]);
      ctx.beginPath(); ctx.moveTo(xb,y0); ctx.lineTo(xb,y1); ctx.stroke();
      ctx.setLineDash([]);
      ctx.fillStyle = "rgba(251,191,36,0.85)";
      ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText("reduced-zone boundary", xb-66, y0+16);

      // Legend (simple)
      const lx = x0 + 12, ly = y0 + 12;
      legendItem(lx, ly, "rgba(125,211,252,0.95)", "T >> Tc (monatomic acoustic)");
      legendItem(lx, ly+18, "rgba(167,139,250,0.95)", "T = Tc (soft at k=π/a)", [6,4]);
      legendItem(lx, ly+36, "rgba(134,239,172,0.92)", "T << Tc (acoustic, doubled cell)");
      legendItem(lx, ly+54, "rgba(134,239,172,0.55)", "T << Tc (optical, doubled cell)");

      function legendItem(x,y,color,text,dash){
        ctx.save();
        ctx.strokeStyle = color;
        ctx.lineWidth = 3;
        ctx.setLineDash(dash || []);
        ctx.beginPath(); ctx.moveTo(x,y); ctx.lineTo(x+22,y); ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = "rgba(231,238,247,0.85)";
        ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
        ctx.fillText(text, x+28, y+4);
        ctx.restore();
      }

      function roundRect(ctx,x,y,w,h,r){
        const rr = Math.min(r, w/2, h/2);
        ctx.beginPath();
        ctx.moveTo(x+rr,y);
        ctx.arcTo(x+w,y,x+w,y+h,rr);
        ctx.arcTo(x+w,y+h,x,y+h,rr);
        ctx.arcTo(x,y+h,x,y,rr);
        ctx.arcTo(x,y,x+w,y,rr);
        ctx.closePath();
      }
    }

    window.addEventListener('resize', draw, {passive:true});
    draw();
  })();
</script>

</body>
</html>