<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>F-Center in NaCl: Hydrogenic Model, 1s–2p Energy, and Comparison to Sodium 3s–3p</title>
  <style>
    :root{
      --bg:#0b0d12;
      --panel:#121625;
      --panel2:#0f1320;
      --text:#e9edf7;
      --muted:#b8c0d9;
      --faint:#7f89a8;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0; font-family:var(--sans); background:radial-gradient(1200px 700px at 15% 5%, rgba(125,211,252,.12), transparent 60%),
      radial-gradient(900px 600px at 85% 20%, rgba(167,139,250,.10), transparent 55%),
      var(--bg);
      color:var(--text); line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:28px 18px 18px;
      border-bottom:1px solid var(--border);
      background:linear-gradient(180deg, rgba(18,22,37,.85), rgba(11,13,18,.0));
      position:relative;
      overflow:hidden;
    }
    header .wrap{max-width:1180px; margin:0 auto; display:grid; gap:12px}
    .kicker{
      display:inline-flex; gap:10px; align-items:center;
      color:var(--muted);
      font-size:14px;
    }
    .pill{
      padding:4px 10px; border:1px solid var(--border);
      border-radius:999px; background:rgba(255,255,255,.03);
    }
    h1{
      margin:0;
      font-size:clamp(24px, 3.2vw, 40px);
      letter-spacing:-.02em;
    }
    .sub{
      margin:0;
      color:var(--muted);
      max-width:78ch;
      font-size:15.5px;
    }

    main{
      max-width:1180px; margin:0 auto; padding:18px;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:18px;
    }
    @media (max-width: 980px){
      main{grid-template-columns: 1fr}
      .toc{position:relative; top:auto}
    }

    .toc{
      position:sticky; top:14px;
      align-self:start;
      border:1px solid var(--border);
      background:linear-gradient(180deg, rgba(18,22,37,.80), rgba(15,19,32,.65));
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px;
    }
    .toc h2{
      margin:2px 0 10px;
      font-size:14px; color:var(--muted);
      letter-spacing:.08em; text-transform:uppercase;
    }
    .toc ol{margin:0; padding-left:18px; color:var(--muted); font-size:14px}
    .toc li{margin:8px 0}
    .toc a{color:var(--text)}
    .toc a span{color:var(--faint); font-size:12px}
    .toc .toplink{
      display:flex; justify-content:space-between; align-items:center;
      margin-top:12px; padding-top:12px; border-top:1px solid var(--border);
      font-size:13px;
    }

    article{
      display:grid; gap:14px;
    }
    section{
      border:1px solid var(--border);
      background:linear-gradient(180deg, rgba(18,22,37,.70), rgba(15,19,32,.55));
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px;
      overflow:hidden;
      animation:fadeUp .35s ease both;
    }
    @keyframes fadeUp{from{opacity:.0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)}}
    section h2{
      margin:0 0 10px;
      font-size:20px;
      letter-spacing:-.01em;
    }
    section h3{
      margin:16px 0 8px; font-size:16px; color:var(--text)
    }
    p{margin:10px 0; color:var(--muted)}
    ul,ol{color:var(--muted)}
    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    @media (max-width:860px){.grid2{grid-template-columns:1fr}}

    .callouts{display:grid; gap:10px}
    .card{
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
      border-radius:14px;
      padding:12px 12px 10px;
    }
    .card .title{
      display:flex; align-items:center; gap:10px;
      font-weight:650; color:var(--text);
      margin-bottom:6px;
    }
    .dot{width:10px; height:10px; border-radius:50%}
    .dot.assump{background:var(--warn)}
    .dot.eq{background:var(--accent)}
    .dot.mist{background:var(--bad)}
    .dot.ans{background:var(--ok)}
    .dot.math{background:var(--accent2)}
    .small{font-size:13.5px; color:var(--muted)}
    .mono{font-family:var(--mono)}
    .eqbox{
      border:1px solid var(--border);
      background:rgba(0,0,0,.25);
      border-radius:14px;
      padding:12px;
      overflow:auto;
      position:relative;
    }
    .eqbox pre{
      margin:0;
      white-space:pre-wrap;
      word-break:break-word;
      color:#f2f5ff;
      font-size:13.5px;
      line-height:1.45;
    }
    .actions{
      display:flex; gap:8px; flex-wrap:wrap;
      margin-top:8px;
    }
    button.copy{
      border:1px solid var(--border);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:7px 10px;
      border-radius:999px;
      font-size:13px;
      cursor:pointer;
      transition:transform .08s ease, background .15s ease, border-color .15s ease;
    }
    button.copy:hover{background:rgba(255,255,255,.10); border-color:rgba(255,255,255,.18)}
    button.copy:active{transform:translateY(1px)}
    .tagrow{display:flex; gap:8px; flex-wrap:wrap; margin-top:8px}
    .tag{
      font-size:12px; color:var(--muted);
      padding:4px 8px; border:1px solid var(--border);
      border-radius:999px; background:rgba(255,255,255,.03);
    }
    details{
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
      border-radius:14px;
      padding:10px 12px;
      margin-top:10px;
    }
    summary{
      cursor:pointer;
      color:var(--text);
      font-weight:650;
    }
    details p{margin:8px 0 0}
    figure{
      margin:0;
      border:1px solid var(--border);
      background:rgba(0,0,0,.20);
      border-radius:14px;
      padding:12px;
    }
    figcaption{
      color:var(--muted);
      font-size:13px;
      margin-top:8px;
    }
    canvas{width:100%; height:320px; display:block; border-radius:12px}
    footer{
      max-width:1180px; margin:0 auto; padding:18px;
      color:var(--faint); font-size:13px;
    }
    .printnote{display:none}
    @media print{
      body{background:#fff; color:#000}
      header, .toc, button, .actions{display:none !important}
      main{grid-template-columns:1fr; padding:0}
      section{box-shadow:none; border:1px solid #ddd; background:#fff}
      p, ul, ol{color:#111}
      .eqbox{background:#f7f7f7}
      .printnote{display:block; margin-top:10px; color:#333}
      section{break-inside:avoid; page-break-inside:avoid}
    }
  </style>
</head>

<body>
<header id="top">
  <div class="wrap">
    <div class="kicker">
      <span class="pill">Solid-state physics</span>
      <span class="pill">Hydrogenic defect model</span>
      <span class="pill">Applied + IE lens</span>
    </div>
    <h1>F Center in NaCl: 1s–2p Energy Difference (Hydrogenic Model) + Comparison to Na 3s–3p</h1>
    <p class="sub">
      We model an F-center electron as a hydrogen-like bound state in a dielectric medium, derive the screened-Coulomb
      spectrum from the Schrödinger eigenvalue problem, compute the 1s→2p excitation, and compare to typical measured
      NaCl F-center absorption and to the atomic sodium 3s→3p transition.
    </p>
  </div>
</header>

<main>
  <nav class="toc" aria-label="Table of contents">
    <h2>Contents</h2>
    <ol>
      <li><a href="#qs">Quick Summary <span>results & meaning</span></a></li>
      <li><a href="#p0">Part 0 — Concept Primer <span>theory</span></a></li>
      <li><a href="#p0b">Part 0B — Industry Perspective <span>why engineers care</span></a></li>
      <li><a href="#p1">Part 1 — Problem Analysis <span>setup</span></a></li>
      <li><a href="#p2">Part 2 — Strategy & Tips <span>roadmap</span></a></li>
      <li><a href="#p3">Part 3 — Full Solution <span>derivation</span></a></li>
      <li><a href="#p4">Part 4 — Deeper Understanding <span>interpretation</span></a></li>
      <li><a href="#p5">Part 5 — Optional Plot Guide <span>reading the curve</span></a></li>
    </ol>
    <div class="toplink">
      <a href="#top">Back to top ↑</a>
      <span class="pill">print-friendly</span>
    </div>
  </nav>

  <article>
    <!-- Quick Summary -->
    <section id="qs">
      <h2>Quick Summary</h2>
      <ul>
        <li><strong>What this is:</strong> An <em>F center</em> in NaCl is an electron trapped at an anion (Cl<sup>−</sup>) vacancy.</li>
        <li><strong>Key physics idea:</strong> Treat the trapped electron as a <em>hydrogen-like</em> particle bound by a screened Coulomb potential in a dielectric.</li>
        <li><strong>Governing equation:</strong> Time-independent Schrödinger eigenvalue problem
          <span class="mono">[−(ħ²/2m)∇² + V(r)]ψ = Eψ</span> with <span class="mono">V(r)=−e²/(4πϵ₀ϵ<sub>r</sub> r)</span>.</li>
        <li><strong>Core mathematical structure:</strong> Separation in spherical coordinates → radial Sturm–Liouville eigenproblem.</li>
        <li><strong>Main symbolic result:</strong> Hydrogenic levels scale as <span class="mono">E<sub>n</sub> = −(13.6 eV)/(ϵ<sub>r</sub>² n²)</span> (for free-electron mass).</li>
        <li><strong>Asked quantity:</strong> The <span class="mono">1s→2p</span> energy equals the <span class="mono">n=1 → n=2</span> gap:
          <span class="mono">ΔE = (3/4)(13.6 eV)/ϵ<sub>r</sub>² = 10.2 eV / ϵ<sub>r</sub>²</span>.</li>
        <li><strong>Typical NaCl numbers:</strong> If you use <span class="mono">ϵ<sub>r</sub>≈2.3–2.4</span> (high-frequency screening), you get ~<span class="mono">1.8–1.9 eV</span> (rough, underestimates measured F-center absorption ~<span class="mono">2.7 eV</span>).</li>
        <li><strong>Comparison to atomic sodium:</strong> Free Na <span class="mono">3s→3p</span> is ~<span class="mono">2.10 eV</span> (589 nm), same order as F-center excitation.</li>
        <li><strong>Physical meaning:</strong> Dielectric screening strongly reduces binding; real crystals deviate because the vacancy potential is not a pure Coulomb point charge (central-cell, finite cavity, polarization, effective mass, etc.).</li>
      </ul>

      <div class="callouts">
        <div class="card">
          <div class="title"><span class="dot ans"></span>Final result type</div>
          <div class="small">
            Symbolic formula in terms of <span class="mono">ϵ<sub>r</sub></span>, plus representative NaCl numeric estimates and comparisons.
          </div>
        </div>
      </div>
    </section>

    <!-- Part 0 -->
    <section id="p0">
      <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

      <div class="grid2">
        <div class="card">
          <div class="title"><span class="dot eq"></span>Core definitions (symbols & SI units)</div>
          <ul class="small">
            <li><span class="mono">m</span>: electron mass (kg). (Here, treat F-center electron as free-electron mass.)</li>
            <li><span class="mono">e</span>: elementary charge (C).</li>
            <li><span class="mono">ħ</span>: reduced Planck constant (J·s).</li>
            <li><span class="mono">ϵ₀</span>: vacuum permittivity (F/m).</li>
            <li><span class="mono">ϵ<sub>r</sub></span> (or <span class="mono">ϵ</span> in many texts): relative dielectric constant (dimensionless).</li>
            <li><span class="mono">V(r)</span>: potential energy (J).</li>
            <li><span class="mono">ψ(r)</span>: wavefunction; <span class="mono">|ψ|²</span> is probability density (1/m³).</li>
          </ul>
        </div>

        <div class="card">
          <div class="title"><span class="dot math"></span>Physical meaning (intuition)</div>
          <ul class="small">
            <li>In a dielectric, electric fields are reduced by screening → Coulomb attraction becomes weaker by factor <span class="mono">1/ϵ<sub>r</sub></span>.</li>
            <li>Weaker attraction → larger orbital size (effective Bohr radius increases) and smaller binding energies (scale down by <span class="mono">1/ϵ<sub>r</sub>²</span>).</li>
            <li>Hydrogenic “1s, 2p” labels refer to quantum numbers <span class="mono">n</span> (principal), <span class="mono">ℓ</span> (orbital), <span class="mono">m</span> (magnetic), via spherical symmetry.</li>
          </ul>
        </div>
      </div>

      <h3>Key laws/principles and validity conditions</h3>
      <ul>
        <li><strong>Quantum bound states:</strong> Stationary states satisfy <span class="mono">Hψ = Eψ</span> with <span class="mono">H = −(ħ²/2m)∇² + V</span>.</li>
        <li><strong>Electrostatics in a homogeneous dielectric:</strong> Point charge produces potential <span class="mono">φ(r)= (1/4πϵ₀ϵ<sub>r</sub>)(q/r)</span>; energy of electron is <span class="mono">V=−eφ</span>.</li>
        <li><strong>When hydrogenic model is reasonable:</strong> If the defect potential is approximately spherically symmetric and long-range part behaves like screened Coulomb.</li>
        <li><strong>Limitations:</strong> Real F centers involve a finite vacancy cavity, lattice relaxation, nonlocal polarization, and band-structure effects → “central-cell corrections” change energies.</li>
      </ul>

      <h3>Common models/approximations and why used</h3>
      <div class="callouts">
        <div class="card">
          <div class="title"><span class="dot assump"></span>Hydrogenic (screened Coulomb) approximation</div>
          <p class="small">
            Replace the complicated defect potential by <span class="mono">V(r)=−e²/(4πϵ₀ϵ<sub>r</sub> r)</span>.
            This makes the problem analytically solvable and reveals key scaling with <span class="mono">ϵ<sub>r</sub></span>.
          </p>
        </div>
        <div class="card">
          <div class="title"><span class="dot assump"></span>Which dielectric constant?</div>
          <p class="small">
            Optical excitation happens fast; often the relevant screening is closer to the <em>high-frequency</em> dielectric constant
            <span class="mono">ϵ∞≈n²</span> rather than the static <span class="mono">ϵ₀(static)</span>.
            Using one or the other changes the energy by a large factor because the scaling is <span class="mono">1/ϵ<sub>r</sub>²</span>.
          </p>
        </div>
      </div>

      <h3>Mini intuition examples (quick)</h3>
      <ol>
        <li>If <span class="mono">ϵ<sub>r</sub></span> doubles, Coulomb attraction halves, and binding energies drop by factor 4.</li>
        <li>Larger orbit size (effective Bohr radius) means the electron samples more of the crystal → the “point charge” picture becomes less accurate near the vacancy core.</li>
      </ol>

      <h3>What to watch for (pitfalls)</h3>
      <ul>
        <li>Mixing up <span class="mono">ϵ<sub>r</sub></span> (relative) with <span class="mono">ϵ</span> (absolute permittivity).</li>
        <li>For hydrogen, <span class="mono">2s</span> and <span class="mono">2p</span> are degenerate (same <span class="mono">n</span>), so the “1s–2p” gap is the same as “1s–2s”.</li>
        <li>Using the wrong screening constant (static vs high-frequency) can shift results by ~an order of magnitude.</li>
        <li>Assuming perfect agreement with experiment: the hydrogenic model is mainly for scaling and order-of-magnitude.</li>
      </ul>

      <div class="card">
        <div class="title"><span class="dot math"></span>Math Insight (core equation as a mathematical object)</div>
        <p class="small">
          The time-independent Schrödinger equation with a central potential is an <strong>eigenvalue problem</strong> for a
          self-adjoint operator <span class="mono">H</span>. In spherical coordinates, separation of variables reduces it to a
          <strong>radial Sturm–Liouville problem</strong> with quantized eigenvalues <span class="mono">E<sub>n</sub></span>.
          The screened Coulomb potential preserves the same mathematical structure as hydrogen, with a simple parameter rescaling.
        </p>
      </div>
    </section>

    <!-- Part 0B -->
    <section id="p0b">
      <h2>PART 0B — Industry & Applied Physics Perspective</h2>
      <p>
        F centers (and related color centers) are not just textbook curiosities: they influence optical absorption, radiation response,
        and reliability of ionic crystals and optical components.
      </p>

      <h3>Where this phenomenon appears (concrete application areas)</h3>
      <ul>
        <li><strong>Radiation dosimetry & detectors:</strong> Defect centers form under irradiation; their absorption bands track dose.</li>
        <li><strong>Optical windows, lenses, scintillators:</strong> Color centers can darken materials (loss increase), affecting transmission and lifetime.</li>
        <li><strong>Laser/quantum technologies (broader class):</strong> Color centers in solids are engineered as optically addressable states (platform idea generalizes beyond NaCl).</li>
      </ul>

      <h3>Why engineers care</h3>
      <ul>
        <li><strong>Performance:</strong> Absorption bands reduce optical throughput; shift in defect energies changes color and loss.</li>
        <li><strong>Reliability:</strong> Defect formation under heat/radiation drives aging and drift in sensors or optics.</li>
        <li><strong>Cost & manufacturability:</strong> Controlling impurities, stoichiometry, and annealing cycles reduces defect densities.</li>
      </ul>

      <h3>Typical measurement/validation methods</h3>
      <ul>
        <li><strong>Optical absorption spectroscopy:</strong> Measures defect excitation energies as absorption peaks.</li>
        <li><strong>Electron paramagnetic resonance (EPR/ESR):</strong> Detects unpaired electrons and local environments.</li>
        <li><strong>Thermoluminescence / photoluminescence:</strong> Probes recombination pathways and trap depths.</li>
      </ul>

      <h3>Design trade-offs & constraints</h3>
      <ul>
        <li>High purity reduces unwanted centers but increases processing cost.</li>
        <li>Annealing can heal defects but may cause grain growth or mechanical property changes.</li>
        <li>Real materials are inhomogeneous: local <span class="mono">ϵ</span>, strain, and impurities broaden absorption lines.</li>
      </ul>

      <div class="card">
        <div class="title"><span class="dot assump"></span>From lab to product (how the ideal model is adapted)</div>
        <p class="small">
          In practice, engineers replace the “point charge in uniform dielectric” with calibrated effective parameters:
          an <em>effective</em> dielectric screening (often frequency-dependent), an <em>effective mass</em> (band structure),
          and a short-range “central-cell” correction capturing the finite vacancy cavity and lattice relaxation.
          The hydrogenic model still matters because it gives the correct <strong>scaling logic</strong> and a clean baseline for design decisions.
        </p>
      </div>
    </section>

    <!-- Part 1 -->
    <section id="p1">
      <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

      <h3>Restate the problem (in plain words)</h3>
      <p>
        (a) Model an F center as an electron of mass <span class="mono">m</span> moving in the Coulomb field of a point charge <span class="mono">+e</span>
        inside a medium with dielectric constant <span class="mono">ϵ<sub>r</sub></span>. Find the <span class="mono">1s–2p</span> energy difference,
        then evaluate it for NaCl.
        <br/>
        (b) Using an experimental value (from a referenced table) for the F-center excitation energy in NaCl, compare it to the
        <span class="mono">3s–3p</span> energy difference in a free sodium atom.
      </p>

      <div class="grid2">
        <div class="card">
          <div class="title"><span class="dot eq"></span>Given</div>
          <ul class="small">
            <li>Electron mass <span class="mono">m</span> (take as free electron mass).</li>
            <li>Point charge <span class="mono">+e</span>.</li>
            <li>Uniform dielectric with relative permittivity <span class="mono">ϵ<sub>r</sub></span>.</li>
            <li>Material: NaCl (needs a representative <span class="mono">ϵ<sub>r</sub></span>).</li>
            <li>Table value: experimental F-center excitation energy in NaCl (often around <span class="mono">2.7 eV</span>).</li>
          </ul>
        </div>
        <div class="card">
          <div class="title"><span class="dot ans"></span>Unknowns / targets</div>
          <ul class="small">
            <li>(a) <span class="mono">ΔE = E(2p) − E(1s)</span> in terms of <span class="mono">ϵ<sub>r</sub></span>, then estimate for NaCl.</li>
            <li>(b) Compare experimental F-center excitation energy to Na atomic <span class="mono">3s→3p</span> energy.</li>
          </ul>
        </div>
      </div>

      <h3>Relevant principles (and why they apply)</h3>
      <ul>
        <li><strong>Quantum bound states in central potentials:</strong> Because the model potential depends only on <span class="mono">r</span>, we can use spherical symmetry.</li>
        <li><strong>Electrostatics in dielectric media:</strong> The Coulomb interaction is reduced by <span class="mono">ϵ<sub>r</sub></span>.</li>
        <li><strong>Hydrogen spectrum:</strong> The eigenvalues for <span class="mono">1/r</span> potentials are known; we can derive them and then apply screening scaling.</li>
      </ul>

      <h3>Assumptions (explicit)</h3>
      <div class="card">
        <div class="title"><span class="dot assump"></span>Assumptions used in the model</div>
        <ul class="small">
          <li>Homogeneous, isotropic dielectric with constant <span class="mono">ϵ<sub>r</sub></span>.</li>
          <li>Electron effective mass equals free mass <span class="mono">m</span> (no band-structure correction).</li>
          <li>Point-charge Coulomb potential (ignores finite vacancy size and lattice relaxation).</li>
          <li>Nonrelativistic Schrödinger theory (appropriate for eV-scale bound states).</li>
        </ul>
      </div>

      <h3>Possible solution approaches (compare)</h3>
      <ol>
        <li><strong>Scaling from hydrogen (fastest):</strong> Use known hydrogen energy levels and replace <span class="mono">e² → e²/ϵ<sub>r</sub></span>.
          <em>Pro:</em> quick and highlights physics. <em>Con:</em> easy to misuse constants.</li>
        <li><strong>Full separation-of-variables derivation (most instructive):</strong> Solve the Schrödinger equation in spherical coordinates to show quantization.
          <em>Pro:</em> rigorous math physics; clarifies degeneracy. <em>Con:</em> longer.</li>
        <li><strong>Variational estimate (useful if potential is not exactly Coulomb):</strong> Trial wavefunction in a cavity-like potential.
          <em>Pro:</em> closer to real F centers. <em>Con:</em> not what the prompt asks for.</li>
      </ol>

      <p><strong>Chosen approach:</strong> Use the full hydrogenic derivation (Approach 2) with a dielectric-rescaled Coulomb potential, then plug NaCl-relevant <span class="mono">ϵ<sub>r</sub></span> values and compare to experiment/atomic Na.</p>
    </section>

    <!-- Part 2 -->
    <section id="p2">
      <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

      <ol>
        <li><strong>Model definition:</strong> Write the Hamiltonian <span class="mono">H = −(ħ²/2m)∇² + V(r)</span> with screened Coulomb <span class="mono">V(r)</span>.</li>
        <li><strong>Symmetry:</strong> Use spherical coordinates since <span class="mono">V(r)</span> depends only on <span class="mono">r</span>.</li>
        <li><strong>Separation:</strong> Set <span class="mono">ψ(r,θ,φ)=R(r)Y<sub>ℓm</sub>(θ,φ)</span> and obtain the radial ODE.</li>
        <li><strong>Quantization:</strong> Impose normalizability and boundary conditions to get discrete energy levels <span class="mono">E<sub>n</sub></span>.</li>
        <li><strong>Screening scaling:</strong> Express energies in terms of an “effective Rydberg” <span class="mono">Ry*</span> and “effective Bohr radius” <span class="mono">a*</span>.</li>
        <li><strong>Compute the gap:</strong> Use <span class="mono">E(1)</span> and <span class="mono">E(2)</span> to get <span class="mono">ΔE</span>.</li>
        <li><strong>NaCl estimate:</strong> Evaluate for representative <span class="mono">ϵ<sub>r</sub></span> values (static vs high-frequency) and discuss which is plausible.</li>
        <li><strong>Comparison:</strong> Compare experimental F-center excitation energy to Na atomic <span class="mono">3s→3p</span> (~589 nm).</li>
      </ol>

      <div class="card">
        <div class="title"><span class="dot mist"></span>Common mistakes (quick tips)</div>
        <ul class="small">
          <li>For a pure Coulomb potential, <span class="mono">E</span> depends only on <span class="mono">n</span>, so <span class="mono">2p</span> and <span class="mono">2s</span> have the same energy.</li>
          <li>Don’t forget the <span class="mono">1/ϵ<sub>r</sub>²</span> scaling (not <span class="mono">1/ϵ<sub>r</sub></span>).</li>
          <li>Be explicit about which <span class="mono">ϵ</span> you use for NaCl (static vs high-frequency).</li>
        </ul>
      </div>
    </section>

    <!-- Part 3 -->
    <section id="p3">
      <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

      <h3>Physical intuition first</h3>
      <p>
        In vacuum hydrogen, the <span class="mono">1s→2</span> excitation is 10.2 eV. In a dielectric, the Coulomb attraction is weaker by <span class="mono">1/ϵ<sub>r</sub></span>,
        so the entire spectrum “shrinks” by <span class="mono">1/ϵ<sub>r</sub>²</span>. Therefore we expect the F-center excitation energy to be much smaller than 10.2 eV,
        typically in the visible/near-IR range.
      </p>

      <h3>Step 1: Mathematical model (Hamiltonian, domain, boundary conditions)</h3>
      <div class="eqbox" role="group" aria-label="Model equations">
        <pre id="eq-model">Variables:
  r ∈ (0,∞), angles (θ,φ), wavefunction ψ(r,θ,φ)
  dielectric constant ϵr (dimensionless), electron mass m

Domain:
  ℝ³ \ {0} (point charge at origin), with physical requirement ψ finite at r→0 and normalizable as r→∞

Time-independent Schrödinger eigenvalue problem:
  Hψ = Eψ
  H = −(ħ²/2m) ∇² + V(r)
  V(r) = − e² / (4πϵ₀ ϵr r)

Boundary/normalization:
  ∫|ψ|² d³r = 1
  ψ finite at r=0, ψ → 0 as r → ∞</pre>
        <div class="actions">
          <button class="copy" data-copy-target="eq-model">Copy equation (plain text)</button>
        </div>
      </div>

      <p>
        Why is this valid? We assume linear, conservative quantum dynamics (no time dependence needed for stationary states), and
        a central potential from electrostatics in a homogeneous dielectric. The operator <span class="mono">∇²</span> is the Laplacian,
        ensuring kinetic energy is <span class="mono">−(ħ²/2m)∇²</span>.
      </p>

      <h3>Step 2: Use spherical symmetry and separate variables</h3>
      <p>
        Because <span class="mono">V(r)</span> depends only on <span class="mono">r</span>, the Hamiltonian commutes with angular momentum operators
        <span class="mono">L²</span> and <span class="mono">L<sub>z</sub></span>. Therefore we choose simultaneous eigenfunctions:
      </p>

      <div class="eqbox">
        <pre id="eq-sep">Assume separation:
  ψ(r,θ,φ) = R(r) Yℓm(θ,φ)

where Yℓm are spherical harmonics satisfying:
  L² Yℓm = ħ² ℓ(ℓ+1) Yℓm
  Lz Yℓm = ħ m Yℓm</pre>
        <div class="actions">
          <button class="copy" data-copy-target="eq-sep">Copy equation (plain text)</button>
        </div>
      </div>

      <p>
        This step is justified by symmetry: central potentials make the problem separable in spherical coordinates, reducing a PDE to an angular eigenproblem
        plus a radial ODE.
      </p>

      <h3>Step 3: The radial equation (operator form → ODE)</h3>
      <p>
        In spherical coordinates, the Laplacian splits as:
        <span class="mono">∇² = (1/r²)∂/∂r(r² ∂/∂r) − L²/(ħ² r²)</span>.
        Substituting <span class="mono">ψ=R Y</span> into <span class="mono">Hψ=Eψ</span>, dividing by <span class="mono">Y</span>, and using <span class="mono">L²Y=ħ²ℓ(ℓ+1)Y</span> gives:
      </p>

      <div class="eqbox">
        <pre id="eq-radial">Radial equation for R(r):
  −(ħ²/2m) [ (1/r²) d/dr ( r² dR/dr ) − ℓ(ℓ+1) R / r² ]  + V(r) R  = E R

It is standard to remove the first-derivative structure by defining u(r)=r R(r),
which yields a 1D-like Schrödinger equation:
  −(ħ²/2m) d²u/dr² + [ V(r) + ħ² ℓ(ℓ+1)/(2m r²) ] u = E u

Boundary conditions:
  u(0)=0 (to keep ψ finite), and u(r) → 0 as r→∞ (bound state)</pre>
        <div class="actions">
          <button class="copy" data-copy-target="eq-radial">Copy equation (plain text)</button>
        </div>
      </div>

      <p>
        The extra term <span class="mono">ħ²ℓ(ℓ+1)/(2m r²)</span> is the centrifugal barrier. For <span class="mono">1s</span>, <span class="mono">ℓ=0</span>;
        for <span class="mono">2p</span>, <span class="mono">ℓ=1</span>.
      </p>

      <h3>Step 4: Nondimensionalization / scaling (why energies scale as 1/ϵ<sub>r</sub>²)</h3>
      <p>
        Define the screened Coulomb coupling:
        <span class="mono">κ ≡ e²/(4πϵ₀ϵ<sub>r</sub>)</span> so <span class="mono">V(r)=−κ/r</span>.
        The hydrogenic length scale (effective Bohr radius) comes from balancing kinetic and potential terms:
      </p>

      <div class="eqbox">
        <pre id="eq-scale">Estimate scaling by dimensional analysis:
  kinetic ~ ħ²/(2m a²)
  potential ~ κ/a

Set ħ²/(2m a²) ~ κ/a  ⇒  a ~ ħ²/(m κ)

Thus the effective Bohr radius:
  a* = ħ² / (m κ) = ħ² / (m (e²/(4πϵ₀ϵr))) = ϵr (4πϵ₀ ħ²)/(m e²) = ϵr a0

Energy scale then:
  E* ~ − κ/a* = − m κ² / ħ²  ∝ − 1/ϵr²</pre>
        <div class="actions">
          <button class="copy" data-copy-target="eq-scale">Copy equation (plain text)</button>
        </div>
      </div>

      <p>
        So screening enlarges the orbit size by <span class="mono">ϵ<sub>r</sub></span> and reduces binding energies by <span class="mono">1/ϵ<sub>r</sub>²</span>.
        This is a strong effect and explains why defect excitations can move into the visible.
      </p>

      <h3>Step 5: Hydrogenic eigenvalues (with dielectric rescaling)</h3>
      <p>
        Solving the radial equation exactly (via series methods leading to associated Laguerre polynomials) yields the discrete spectrum:
      </p>

      <div class="eqbox">
        <pre id="eq-levels">Hydrogenic energy levels for V(r)=−κ/r:
  En = − (m κ²) / (2 ħ²) * (1/n²),   n=1,2,3,...

Substitute κ = e²/(4πϵ₀ ϵr):
  En = − [m e⁴] / [2 (4πϵ₀)² ħ²] * (1/ϵr²) * (1/n²)

Recognize the vacuum Rydberg energy Ry ≈ 13.6 eV:
  En = − (Ry / ϵr²) * (1/n²)   (for electron mass m)</pre>
        <div class="actions">
          <button class="copy" data-copy-target="eq-levels">Copy equation (plain text)</button>
        </div>
      </div>

      <p>
        Note: In the pure Coulomb problem, <span class="mono">E</span> depends only on <span class="mono">n</span>, so all states with the same <span class="mono">n</span> are degenerate
        (e.g., <span class="mono">2s</span> and <span class="mono">2p</span>).
      </p>

      <h3>Step 6: Compute the 1s–2p energy difference</h3>
      <p>
        The <span class="mono">1s</span> state corresponds to <span class="mono">n=1</span>; the <span class="mono">2p</span> state corresponds to <span class="mono">n=2</span> (with <span class="mono">ℓ=1</span>).
        Since energy depends only on <span class="mono">n</span>:
      </p>

      <div class="eqbox">
        <pre id="eq-gap">E1 = E(n=1) = −Ry/ϵr²
E2 = E(n=2) = −Ry/(4 ϵr²)

Excitation energy (absorbed photon):
  ΔE(1s→2p) = E2 − E1
            = [−Ry/(4ϵr²)] − [−Ry/ϵr²]
            = (3/4) (Ry/ϵr²)

Using Ry ≈ 13.6 eV:
  ΔE(1s→2p) = (3/4)(13.6 eV)/ϵr² = 10.2 eV / ϵr²</pre>
        <div class="actions">
          <button class="copy" data-copy-target="eq-gap">Copy equation (plain text)</button>
        </div>
      </div>

      <div class="card">
        <div class="title"><span class="dot ans"></span>Final Answer (Part a, symbolic)</div>
        <p class="small mono" id="ans-a">ΔE(1s→2p) = (3/4)(Ry/ϵr²) = 10.2 eV / ϵr²</p>
        <div class="actions">
          <button class="copy" data-copy-target="ans-a">Copy final answer (plain text)</button>
        </div>
      </div>

      <h3>Step 7: Evaluate for NaCl (and discuss which ϵ is relevant)</h3>
      <p>
        NaCl has a <em>static</em> dielectric constant on the order of ~5–6, while its <em>high-frequency</em> (electronic) dielectric constant is closer to ~2–2.5.
        Because optical excitation is fast, many simple treatments use something nearer the high-frequency screening.
        Since the problem statement does not specify, it’s instructive to show both outcomes:
      </p>

      <div class="eqbox">
        <pre id="eq-nacl">Numerical estimates from ΔE = 10.2 eV / ϵr²:

If ϵr = 2.37 (≈ n² for NaCl with n≈1.54):
  ΔE ≈ 10.2 / (2.37²) eV ≈ 10.2 / 5.62 eV ≈ 1.81 eV

If ϵr = 5.9 (typical static value):
  ΔE ≈ 10.2 / (5.9²) eV ≈ 10.2 / 34.81 eV ≈ 0.293 eV</pre>
        <div class="actions">
          <button class="copy" data-copy-target="eq-nacl">Copy estimates (plain text)</button>
        </div>
      </div>

      <p>
        Real NaCl F-center absorption is commonly observed in the visible (often around ~2.7 eV). The simple hydrogenic estimate with
        <span class="mono">ϵ<sub>r</sub>≈2.3–2.4</span> gives ~1.8 eV, typically <em>below</em> experiment, indicating missing physics beyond uniform screening.
      </p>

      <details>
        <summary>Why the hydrogenic model can miss the NaCl F-center energy</summary>
        <p class="small">
          The vacancy is not a point charge; the electron sits in a finite cavity with strong short-range potentials.
          The dielectric response is spatially nonuniform and frequency-dependent; lattice relaxation and polarization can change the effective attraction.
          Band-structure effects can change the electron’s effective mass and kinetic energy term.
          All of these produce “central-cell corrections” that can push the excitation energy upward relative to the simplest <span class="mono">1/ϵ²</span> scaling.
        </p>
      </details>

      <h3>Part (b): Compare experimental F-center excitation to Na atomic 3s–3p</h3>
      <p>
        The free sodium atom has a strong <span class="mono">3s → 3p</span> transition (the D-lines) near 589 nm, corresponding to:
        <span class="mono">E ≈ hc/λ ≈ 1240 eV·nm / 589 nm ≈ 2.11 eV</span>.
      </p>

      <div class="eqbox">
        <pre id="eq-compare">Atomic sodium (free atom):
  ΔE(Na: 3s→3p) ≈ 2.1 eV  (λ≈589 nm)

NaCl F-center (from typical table/measurement):
  ΔE(F-center, NaCl) ≈ 2.7 eV  (visible absorption band)

Comparison:
  F-center excitation is of the same order as Na atomic 3s→3p, often somewhat larger (≈ 2.7 vs 2.1 eV).</pre>
        <div class="actions">
          <button class="copy" data-copy-target="eq-compare">Copy comparison (plain text)</button>
        </div>
      </div>

      <div class="card">
        <div class="title"><span class="dot ans"></span>Final Answer (Part b, plain-language)</div>
        <p class="small" id="ans-b">
          The NaCl F-center excitation energy (commonly ~2.7 eV) is comparable to, but typically larger than, the free sodium atom’s 3s–3p energy (~2.1 eV at 589 nm).
          This similarity reflects that both are “single-electron” optical excitations, but the crystal environment reshapes the potential and screening.
        </p>
        <div class="actions">
          <button class="copy" data-copy-target="ans-b">Copy final answer (plain text)</button>
        </div>
      </div>

      <h3>Sanity checks</h3>
      <div class="grid2">
        <div class="card">
          <div class="title"><span class="dot eq"></span>Units / dimensions</div>
          <ul class="small">
            <li><span class="mono">Ry</span> is energy; dividing by <span class="mono">ϵ<sub>r</sub>²</span> keeps energy units.</li>
            <li><span class="mono">V(r)</span> has units J because <span class="mono">e²/(4πϵ₀ r)</span> is energy.</li>
          </ul>
        </div>
        <div class="card">
          <div class="title"><span class="dot math"></span>Limiting cases</div>
          <ul class="small">
            <li>If <span class="mono">ϵ<sub>r</sub>→1</span> (vacuum), <span class="mono">ΔE→10.2 eV</span>, the hydrogen value.</li>
            <li>If <span class="mono">ϵ<sub>r</sub>→∞</span>, <span class="mono">ΔE→0</span>, meaning screening destroys binding (as expected).</li>
          </ul>
        </div>
      </div>

      <p class="printnote">
        Print note: Interactive copy buttons and the sticky ToC are hidden in print view for clean PDFs.
      </p>
    </section>

    <!-- Plot -->
    <section>
      <h2>One Useful Visual: How the Excitation Shrinks with Dielectric Screening</h2>
      <p>
        Because <span class="mono">ΔE = 10.2 eV / ϵ<sub>r</sub>²</span>, the predicted excitation drops quadratically as screening increases.
        The curve below visualizes that dependence and marks two representative NaCl screening choices (example values).
      </p>
      <figure>
        <canvas id="plot" aria-label="Plot of ΔE vs dielectric constant"></canvas>
        <figcaption>
          Plot of <span class="mono">ΔE(1s→2p)=10.2/ϵ<sub>r</sub>²</span> (eV) vs <span class="mono">ϵ<sub>r</sub></span>.
          Markers show example NaCl values: <span class="mono">ϵ<sub>r</sub>≈2.37</span> (high-frequency) and <span class="mono">ϵ<sub>r</sub>≈5.9</span> (static).
        </figcaption>
      </figure>
    </section>

    <!-- Part 4 -->
    <section id="p4">
      <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

      <h3>Re-interpret the final formula</h3>
      <p>
        <span class="mono">ΔE = 10.2 eV / ϵ<sub>r</sub>²</span> says the excitation energy is controlled primarily by screening:
        <strong>double</strong> <span class="mono">ϵ<sub>r</sub></span> → <strong>quarter</strong> the excitation energy.
        In defect engineering terms, anything that changes local polarizability (composition, temperature, strain, frequency response) can shift optical bands.
      </p>

      <h3>Parameter dependence</h3>
      <ul>
        <li><strong>Dielectric constant <span class="mono">ϵ<sub>r</sub></span>:</strong> <span class="mono">ΔE ∝ 1/ϵ<sub>r</sub>²</span> (strong quadratic sensitivity).</li>
        <li><strong>Effective mass (if included):</strong> In a refined model, <span class="mono">ΔE ∝ m*</span>. Heavier effective mass → stronger binding → higher excitation energy.</li>
        <li><strong>Short-range potential details:</strong> Deviations from pure <span class="mono">1/r</span> (finite cavity, lattice relaxation) can break hydrogenic degeneracies and shift energies substantially.</li>
      </ul>

      <h3>Alternative derivation idea (brief but meaningful)</h3>
      <p>
        A fast alternative is <strong>scaling from vacuum hydrogen</strong>:
        replace <span class="mono">e² → e²/ϵ<sub>r</sub></span> in the Coulomb interaction. Since hydrogen energies scale as <span class="mono">e⁴</span>,
        the spectrum scales as <span class="mono">1/ϵ<sub>r</sub>²</span>, immediately giving <span class="mono">ΔE = 10.2/ϵ<sub>r</sub>²</span> eV.
        The full separation-of-variables method shown earlier explains <em>why</em> this scaling holds mathematically.
      </p>

      <div class="card">
        <div class="title"><span class="dot math"></span>Concept check (self-test with answers)</div>
        <ul class="small">
          <li><strong>Q:</strong> Why is <span class="mono">1s→2p</span> the same gap as <span class="mono">1s→2s</span> here? <br/><strong>A:</strong> In a pure Coulomb potential, energy depends only on <span class="mono">n</span>, so all states with the same <span class="mono">n</span> are degenerate.</li>
          <li><strong>Q:</strong> If <span class="mono">ϵ<sub>r</sub></span> increases, does the bound state become tighter or looser? <br/><strong>A:</strong> Looser: orbit size grows ~<span class="mono">ϵ<sub>r</sub></span>, binding energy shrinks ~<span class="mono">1/ϵ<sub>r</sub>²</span>.</li>
          <li><strong>Q:</strong> What physical effect could push the real NaCl excitation above the hydrogenic estimate? <br/><strong>A:</strong> Central-cell corrections / finite cavity potential can deepen confinement relative to a simple screened point charge.</li>
          <li><strong>Q:</strong> Why might high-frequency <span class="mono">ϵ</span> be more relevant for optical absorption? <br/><strong>A:</strong> The lattice ions cannot fully respond on optical timescales, so screening is closer to the electronic (fast) response.</li>
        </ul>
      </div>
    </section>

    <!-- Part 5 -->
    <section id="p5">
      <h2>PART 5 — Optional Plot Guide</h2>
      <h3>What the plot shows and why it’s useful</h3>
      <ul>
        <li><strong>Vertical axis:</strong> <span class="mono">ΔE(1s→2p)</span> in eV.</li>
        <li><strong>Horizontal axis:</strong> dielectric constant <span class="mono">ϵ<sub>r</sub></span> (dimensionless).</li>
        <li><strong>Example values:</strong> Markers at <span class="mono">ϵ<sub>r</sub>=2.37</span> (high-frequency estimate) and <span class="mono">ϵ<sub>r</sub>=5.9</span> (static estimate) are illustrative.</li>
        <li><strong>Feature to notice:</strong> Quadratic decay—small changes in <span class="mono">ϵ<sub>r</sub></span> cause large changes in <span class="mono">ΔE</span>.</li>
        <li><strong>Connection to the formula:</strong> The curve is exactly <span class="mono">10.2/ϵ<sub>r</sub>²</span>, so its curvature encodes the <span class="mono">1/ϵ²</span> scaling derived from the eigenvalue problem.</li>
      </ul>

      <div class="card">
        <div class="title"><span class="dot ans"></span>Copy-ready final results (all in one place)</div>
        <div class="eqbox">
          <pre id="final-pack">Part (a):
  ΔE(1s→2p) = (3/4)(Ry/ϵr²) = 10.2 eV / ϵr²

  Example NaCl estimates:
    if ϵr=2.37 → ΔE≈1.81 eV
    if ϵr=5.9  → ΔE≈0.293 eV

Part (b):
  Na atom (3s→3p) ≈ 2.1 eV (589 nm)
  NaCl F-center excitation (typical) ≈ 2.7 eV
  → same order; F-center often somewhat larger than Na 3s→3p</pre>
        </div>
        <div class="actions">
          <button class="copy" data-copy-target="final-pack">Copy final answer pack (plain text)</button>
        </div>
      </div>

      <p><a href="#top">Back to top ↑</a></p>
    </section>
  </article>
</main>

<footer>
  <div>
    <strong>Note:</strong> If your course “Table 3” gives a different NaCl F-center energy, plug it into the comparison directly.
    The hydrogenic model prediction remains <span class="mono">ΔE = 10.2/ϵ<sub>r</sub>²</span> eV under the stated assumptions.
  </div>
</footer>

<script>
  // Copy buttons (plain text)
  (function(){
    function textFromTarget(id){
      const el = document.getElementById(id);
      if(!el) return "";
      return (el.innerText || el.textContent || "").trim();
    }
    async function copyText(txt){
      try{
        await navigator.clipboard.writeText(txt);
        return true;
      }catch(e){
        // Fallback
        const ta = document.createElement("textarea");
        ta.value = txt;
        ta.style.position="fixed";
        ta.style.left="-9999px";
        document.body.appendChild(ta);
        ta.select();
        try{ document.execCommand("copy"); } catch(_){}
        document.body.removeChild(ta);
        return true;
      }
    }
    document.querySelectorAll("button.copy").forEach(btn=>{
      btn.addEventListener("click", async ()=>{
        const id = btn.getAttribute("data-copy-target");
        const txt = textFromTarget(id);
        const ok = await copyText(txt);
        const old = btn.textContent;
        btn.textContent = ok ? "Copied!" : "Copy failed";
        setTimeout(()=>btn.textContent=old, 900);
      });
    });
  })();

  // Single static plot: ΔE = 10.2 / eps^2
  (function(){
    const canvas = document.getElementById("plot");
    if(!canvas) return;
    const ctx = canvas.getContext("2d");

    function resize(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
      draw(rect.width, rect.height);
    }

    function draw(w, h){
      // Layout
      const padL = 58, padR = 18, padT = 26, padB = 44;
      const plotW = w - padL - padR;
      const plotH = h - padT - padB;

      // Data ranges
      const xMin = 1.0, xMax = 8.0;        // eps_r
      const yMin = 0.0, yMax = 11.0;       // eV (covers up to ~10.2 at eps=1)

      function xToPx(x){ return padL + (x - xMin) / (xMax - xMin) * plotW; }
      function yToPx(y){ return padT + plotH - (y - yMin) / (yMax - yMin) * plotH; }

      // Clear
      ctx.clearRect(0,0,w,h);

      // Background
      ctx.fillStyle = "rgba(255,255,255,0.02)";
      ctx.fillRect(padL, padT, plotW, plotH);

      // Gridlines + ticks
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.lineWidth = 1;

      // X ticks
      const xTicks = [1,2,3,4,5,6,7,8];
      xTicks.forEach(t=>{
        const x = xToPx(t);
        ctx.beginPath();
        ctx.moveTo(x, padT);
        ctx.lineTo(x, padT+plotH);
        ctx.stroke();
      });

      // Y ticks
      const yTicks = [0,2,4,6,8,10];
      yTicks.forEach(t=>{
        const y = yToPx(t);
        ctx.beginPath();
        ctx.moveTo(padL, y);
        ctx.lineTo(padL+plotW, y);
        ctx.stroke();
      });

      // Axes
      ctx.strokeStyle = "rgba(255,255,255,0.35)";
      ctx.lineWidth = 1.2;
      ctx.beginPath();
      ctx.moveTo(padL, padT);
      ctx.lineTo(padL, padT+plotH);
      ctx.lineTo(padL+plotW, padT+plotH);
      ctx.stroke();

      // Labels
      ctx.fillStyle = "rgba(233,237,247,0.92)";
      ctx.font = "600 13px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("ΔE (eV)", 10, padT + 12);

      ctx.font = "600 13px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      const xLabel = "Dielectric constant ϵr";
      const xLabelW = ctx.measureText(xLabel).width;
      ctx.fillText(xLabel, padL + (plotW - xLabelW)/2, padT + plotH + 34);

      // Title
      ctx.font = "700 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      const title = "Hydrogenic prediction: ΔE = 10.2 / ϵr²";
      const titleW = ctx.measureText(title).width;
      ctx.fillText(title, padL + (plotW - titleW)/2, 18);

      // Tick labels
      ctx.fillStyle = "rgba(184,192,217,0.95)";
      ctx.font = "12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace";

      xTicks.forEach(t=>{
        const x = xToPx(t);
        ctx.fillText(String(t), x-4, padT+plotH+18);
      });
      yTicks.forEach(t=>{
        const y = yToPx(t);
        ctx.fillText(String(t), padL-28, y+4);
      });

      // Curve
      ctx.strokeStyle = "rgba(125,211,252,0.95)";
      ctx.lineWidth = 2;
      ctx.beginPath();
      let started=false;
      for(let i=0;i<=400;i++){
        const x = xMin + (xMax-xMin)*i/400;
        const y = 10.2/(x*x);
        const px = xToPx(x);
        const py = yToPx(y);
        if(!started){ ctx.moveTo(px,py); started=true; }
        else ctx.lineTo(px,py);
      }
      ctx.stroke();

      // Markers: eps=2.37 and eps=5.9
      function marker(eps, label){
        const y = 10.2/(eps*eps);
        const px = xToPx(eps), py = yToPx(y);

        // point
        ctx.fillStyle = "rgba(167,139,250,0.95)";
        ctx.beginPath();
        ctx.arc(px, py, 4.2, 0, Math.PI*2);
        ctx.fill();

        // label
        ctx.fillStyle = "rgba(233,237,247,0.92)";
        ctx.font = "12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace";
        const txt = `${label}: ϵr=${eps.toFixed(2)}, ΔE=${y.toFixed(2)} eV`;
        ctx.fillText(txt, Math.min(px+8, padL+plotW-210), Math.max(py-10, padT+14));
      }
      marker(2.37, "NaCl (high-freq)");
      marker(5.90, "NaCl (static)");

      // Legend
      const lx = padL + 10, ly = padT + 10;
      ctx.fillStyle = "rgba(0,0,0,0.25)";
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.roundRect(lx, ly, 210, 44, 10);
      ctx.fill();
      ctx.stroke();

      ctx.strokeStyle = "rgba(125,211,252,0.95)";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(lx+12, ly+16);
      ctx.lineTo(lx+44, ly+16);
      ctx.stroke();

      ctx.fillStyle = "rgba(184,192,217,0.95)";
      ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("ΔE = 10.2 / ϵr²", lx+54, ly+20);

      ctx.fillStyle = "rgba(167,139,250,0.95)";
      ctx.beginPath();
      ctx.arc(lx+28, ly+32, 4.2, 0, Math.PI*2);
      ctx.fill();

      ctx.fillStyle = "rgba(184,192,217,0.95)";
      ctx.fillText("Example NaCl markers", lx+54, ly+36);
    }

    // Polyfill-like for roundRect if not available
    if(!CanvasRenderingContext2D.prototype.roundRect){
      CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
        const rr = Math.min(r, w/2, h/2);
        this.beginPath();
        this.moveTo(x+rr, y);
        this.arcTo(x+w, y, x+w, y+h, rr);
        this.arcTo(x+w, y+h, x, y+h, rr);
        this.arcTo(x, y+h, x, y, rr);
        this.arcTo(x, y, x+w, y, rr);
        this.closePath();
        return this;
      }
    }

    window.addEventListener("resize", resize, {passive:true});
    resize();
  })();
</script>
</body>
</html>