<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title>Elastic Waves in a Cubic Crystal — General Propagation Direction (Christoffel Determinant + Velocity Sum Rule)</title>
  <style>
    :root{
      --bg: #0b0d10;
      --panel: #12151b;
      --panel2:#0f1217;
      --text:#e9eef6;
      --muted:#aeb9c8;
      --line:#223043;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --radius2: 22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --maxw: 1100px;
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8fb;
        --panel:#ffffff;
        --panel2:#f3f6fb;
        --text:#111827;
        --muted:#4b5563;
        --line:#d7e0ee;
        --shadow: 0 10px 26px rgba(16,24,40,.10);
      }
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 600px at 15% -10%, rgba(125,211,252,.16), transparent 55%),
                  radial-gradient(900px 520px at 90% 10%, rgba(167,139,250,.14), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    a{color:inherit; text-decoration:none}
    a:hover{opacity:.9}
    code, pre{font-family:var(--mono)}
    .wrap{
      max-width:var(--maxw);
      margin:0 auto;
      padding:20px 18px 64px;
    }

    header{
      background:linear-gradient(180deg, rgba(125,211,252,.14), rgba(167,139,250,.08) 40%, transparent);
      border:1px solid var(--line);
      border-radius:var(--radius2);
      box-shadow:var(--shadow);
      padding:22px 18px;
      position:relative;
      overflow:hidden;
    }
    header::after{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(700px 240px at 30% 0%, rgba(125,211,252,.18), transparent 55%),
        radial-gradient(700px 240px at 85% 20%, rgba(167,139,250,.16), transparent 55%);
      pointer-events:none;
      filter: blur(.2px);
    }
    header > *{position:relative; z-index:1}
    .kicker{
      display:inline-flex;
      gap:10px;
      align-items:center;
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:var(--muted);
      margin-bottom:8px;
    }
    .pill{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      border-radius:999px;
      padding:6px 10px;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
      white-space:nowrap;
    }
    h1{
      margin:6px 0 8px;
      font-size: clamp(22px, 3.2vw, 34px);
      line-height:1.15;
      letter-spacing:-0.02em;
    }
    .sub{
      color:var(--muted);
      max-width:78ch;
      margin:0;
      font-size:15px;
    }

    .layout{
      display:grid;
      grid-template-columns: 300px 1fr;
      gap:18px;
      margin-top:18px;
      align-items:start;
    }

    @media (max-width: 980px){
      .layout{grid-template-columns:1fr}
    }

    .toc{
      position:sticky;
      top:12px;
      border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px 12px;
    }
    .toc h2{
      font-size:14px;
      margin:4px 6px 10px;
      letter-spacing:.02em;
      color:var(--muted);
      font-weight:650;
    }
    .toc nav{
      display:flex;
      flex-direction:column;
      gap:8px;
      padding:0 6px 10px;
    }
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid transparent;
      color:var(--text);
      background:transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size:14px;
    }
    .toc a:hover{
      background:rgba(125,211,252,.10);
      border-color:rgba(125,211,252,.25);
      transform: translateY(-1px);
    }
    .toc .mini{
      color:var(--muted);
      font-size:12px;
      padding:0 8px 6px;
    }

    main{
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      border-radius:var(--radius2);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    section{
      padding:18px 18px;
      border-top:1px solid var(--line);
    }
    section:first-child{border-top:none}
    section h2{
      margin:0 0 10px;
      font-size:18px;
      letter-spacing:-0.01em;
    }
    section h3{
      margin:16px 0 8px;
      font-size:15.5px;
      color:var(--text);
      letter-spacing:-0.01em;
    }
    p{margin:10px 0}
    ul{margin:10px 0 10px 20px}
    li{margin:6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 860px){
      .grid2{grid-template-columns:1fr}
    }

    .callout{
      border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.035), rgba(255,255,255,.01));
      border-radius:var(--radius);
      padding:12px 12px;
      margin:12px 0;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
    }
    .callout .title{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:750;
      letter-spacing:.01em;
      margin-bottom:6px;
      color:var(--text);
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background:var(--accent);
      box-shadow: 0 0 0 4px rgba(125,211,252,.14);
      flex:0 0 auto;
    }
    .dot.warn{background:var(--warn); box-shadow:0 0 0 4px rgba(251,191,36,.16)}
    .dot.good{background:var(--good); box-shadow:0 0 0 4px rgba(52,211,153,.16)}
    .dot.bad{background:var(--bad); box-shadow:0 0 0 4px rgba(251,113,133,.14)}
    .muted{color:var(--muted)}
    .eq{
      margin:10px 0;
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
      background:rgba(0,0,0,.12);
    }
    @media (prefers-color-scheme: light){
      .eq{background:rgba(243,246,251,.75)}
    }
    .eqhead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 10px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(125,211,252,.08), transparent);
    }
    .eqhead .label{
      font-size:12px;
      color:var(--muted);
      letter-spacing:.12em;
      text-transform:uppercase;
    }
    .btn{
      cursor:pointer;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text);
      border-radius:12px;
      padding:7px 10px;
      font-size:12.5px;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .btn:hover{
      transform: translateY(-1px);
      background:rgba(125,211,252,.10);
      border-color:rgba(125,211,252,.25);
    }
    .btn:active{transform: translateY(0)}
    .eq pre{
      margin:0;
      padding:12px 12px;
      overflow:auto;
      font-size:13px;
      line-height:1.45;
      white-space:pre;
    }
    .box{
      border-left:4px solid rgba(125,211,252,.7);
      padding:10px 12px;
      background:rgba(125,211,252,.08);
      border-radius:12px;
      margin:10px 0;
    }
    .final{
      border-left-color: rgba(52,211,153,.85);
      background: rgba(52,211,153,.10);
    }
    .printnote{
      font-size:12px;
      color:var(--muted);
      margin-top:8px;
    }

    details{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      background:rgba(255,255,255,.02);
      margin:10px 0;
    }
    summary{
      cursor:pointer;
      font-weight:700;
      color:var(--text);
      list-style:none;
      display:flex;
      align-items:center;
      gap:10px;
    }
    summary::-webkit-details-marker{display:none}
    summary:before{
      content:"▸";
      color:var(--accent);
      font-weight:900;
      transform: translateY(-1px);
    }
    details[open] summary:before{content:"▾"}
    .toplink{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:10px;
      color:var(--muted);
      font-size:13px;
      border:1px solid var(--line);
      padding:8px 10px;
      border-radius:12px;
      background:rgba(255,255,255,.02);
    }
    .toplink:hover{
      background:rgba(167,139,250,.10);
      border-color:rgba(167,139,250,.25);
      color:var(--text);
    }

    footer{
      margin-top:16px;
      color:var(--muted);
      font-size:12.5px;
      padding:10px 4px 0;
      text-align:center;
    }

    /* Micro animation */
    @media (prefers-reduced-motion: no-preference){
      .fadeIn{
        animation: fadeIn .35s ease both;
      }
      @keyframes fadeIn{
        from{opacity:0; transform: translateY(4px)}
        to{opacity:1; transform: translateY(0)}
      }
    }

    /* Print */
    @media print{
      body{background:#fff; color:#000}
      header, main, .toc{box-shadow:none}
      .toc{display:none}
      .layout{grid-template-columns:1fr}
      .btn{display:none}
      a{color:#000; text-decoration:none}
      section{page-break-inside:avoid}
      h2{page-break-after:avoid}
      .eq{page-break-inside:avoid}
      .toplink{display:none}
    }
  </style>
</head>

<body>
  <div class="wrap" id="top">
    <header class="fadeIn">
      <div class="kicker">
        <span class="pill">Elasticity • Waves • Cubic Crystals</span>
        <span class="pill">Math Physics Focus</span>
        <span class="pill">Industrial Relevance</span>
      </div>
      <h1>General Propagation Direction in a Cubic Crystal: The Christoffel Determinant and a Velocity Sum Rule</h1>
      <p class="sub">
        We derive the plane-wave eigenvalue condition (a determinant / dispersion relation) for elastic waves in a cubic crystal,
        then prove a direction-independent identity:
        the sum of the <em>squared</em> phase velocities of the three acoustic modes equals (C11 + 2C44)/ρ.
      </p>
    </header>

    <div class="layout">
      <aside class="toc fadeIn" aria-label="Table of Contents">
        <h2>Table of Contents</h2>
        <div class="mini">Sticky • Click to jump</div>
        <nav>
          <a href="#qs">Quick Summary</a>
          <a href="#p0">PART 0 — Concept Primer</a>
          <a href="#p0b">PART 0B — Industry & Applied Physics</a>
          <a href="#p1">PART 1 — Problem Analysis</a>
          <a href="#p2">PART 2 — Strategy & Tips</a>
          <a href="#p3">PART 3 — Full Solution</a>
          <a href="#p4">PART 4 — Deeper Understanding</a>
          <a href="#p5">PART 5 — Plot Note</a>
        </nav>
        <div class="printnote">Print tip: use your browser’s print for a clean PDF.</div>
      </aside>

      <main class="fadeIn">
        <!-- Quick Summary -->
        <section id="qs">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this is about:</strong> elastic plane waves traveling in <strong>any</strong> direction inside a <strong>cubic crystal</strong>.</li>
            <li><strong>Key physics idea:</strong> linear elasticity + plane-wave ansatz turns the PDE into a <strong>3×3 eigenvalue problem</strong> (Christoffel equation).</li>
            <li><strong>Governing equations:</strong> ρ ∂²u/∂t² = ∇·σ with σ = C:ε and ε = (∇u + (∇u)ᵀ)/2.</li>
            <li><strong>Wave form used:</strong> u(r,t) = u0 exp[i(k·r − ωt)] with <em>phase velocity</em> v = ω/|k|.</li>
            <li><strong>Main math object:</strong> the <strong>Christoffel matrix</strong> Γ(n) = C<sub>ijkl</sub> n<sub>j</sub> n<sub>l</sub>, where n = k/|k|.</li>
            <li><strong>Part (a) result type:</strong> symbolic determinant equation det(Γ − ρv²I)=0 giving three v² roots (1 longitudinal-like, 2 transverse-like).</li>
            <li><strong>Part (b) result type:</strong> symbolic identity: v₁² + v₂² + v₃² = (C11 + 2C44)/ρ (independent of propagation direction in a cubic crystal).</li>
            <li><strong>Physical meaning:</strong> although individual mode speeds depend on direction (anisotropy), this particular <strong>sum rule</strong> does not.</li>
          </ul>
          <a class="toplink" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 0 -->
        <section id="p0">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <div class="grid2">
            <div class="callout">
              <div class="title"><span class="dot"></span>Core Definitions (with SI units)</div>
              <ul>
                <li><strong>Displacement field</strong> u(r,t) [m]: vector field describing small material motion.</li>
                <li><strong>Strain tensor</strong> ε = (∇u + (∇u)ᵀ)/2 [dimensionless].</li>
                <li><strong>Stress tensor</strong> σ [Pa]: σ = C:ε (Hooke’s law for a linear elastic solid).</li>
                <li><strong>Mass density</strong> ρ [kg·m⁻³].</li>
                <li><strong>Wavevector</strong> k [m⁻¹], angular frequency ω [s⁻¹], <strong>phase speed</strong> v = ω/|k| [m·s⁻¹].</li>
                <li><strong>Direction unit vector</strong> n = k/|k| (direction cosines n = (l,m,n) with l²+m²+n²=1).</li>
              </ul>
            </div>

            <div class="callout">
              <div class="title"><span class="dot good"></span>Physical Meaning (Intuition)</div>
              <ul>
                <li>The PDE of motion couples components of u through elastic stiffness (anisotropic “spring constants”).</li>
                <li>A plane wave “tests” the material in direction n; the response is three possible polarizations (eigenvectors u0).</li>
                <li>In isotropic media you get one longitudinal (P) and two transverse (S) modes with simple speeds; in crystals, speeds depend on direction and polarization mixing can occur.</li>
              </ul>
            </div>
          </div>

          <h3>Key Laws/Principles and Validity Conditions</h3>
          <ul>
            <li><strong>Linear momentum balance</strong> (no body forces): ρ ü = ∇·σ. Valid for small strains and small rotations.</li>
            <li><strong>Linear constitutive law</strong> (Hooke): σ = C:ε. Requires elastic regime (no plasticity, no strong damping).</li>
            <li><strong>Homogeneous crystal</strong>: C and ρ treated constant in space (locally true if wavelength ≫ microstructural length scales such as defects spacing).</li>
          </ul>

          <div class="callout">
            <div class="title"><span class="dot warn"></span>Common Models/Approximations (and why)</div>
            <ul>
              <li><strong>Small-displacement / small-strain</strong>: keep only linear terms in u and its derivatives → PDE becomes linear (superposition works).</li>
              <li><strong>Plane-wave ansatz</strong>: u ∝ exp[i(k·r − ωt)] reduces PDE to algebraic eigenproblem; justified by translational invariance in a homogeneous medium.</li>
              <li><strong>Cubic symmetry</strong>: stiffness tensor has only three independent constants C11, C12, C44, greatly simplifying Γ(n).</li>
            </ul>
          </div>

          <h3>Mini Intuition Examples (minimal algebra)</h3>
          <ul>
            <li><strong>Isotropic limit:</strong> if C11 = C12 + 2C44, then speeds become direction-independent and match P/S speeds.</li>
            <li><strong>Along a symmetry axis</strong> (e.g., [100]): modes “decouple” into one pure longitudinal and two pure transverse, giving simple closed-form speeds.</li>
            <li><strong>General direction:</strong> polarizations can rotate relative to n; still, there are always exactly three acoustic solutions for v².</li>
          </ul>

          <div class="callout">
            <div class="title"><span class="dot bad"></span>What to Watch For (pitfalls)</div>
            <ul>
              <li>Mixing up k (vector) with k = |k| (magnitude).</li>
              <li>Forgetting that v², not v, is the eigenvalue in the Christoffel equation.</li>
              <li>Using isotropic formulas (Lamé parameters) when anisotropy matters.</li>
              <li>Not enforcing l² + m² + n² = 1 for direction cosines.</li>
              <li>Dropping factors of i when substituting plane waves into derivatives.</li>
            </ul>
          </div>

          <a class="toplink" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 0B -->
        <section id="p0b">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>
          <p>
            Direction-dependent acoustic wave speeds in crystals aren’t just “theory”—they directly affect measurements, device performance,
            and reliability whenever elastic waves propagate through single-crystal or textured materials.
          </p>

          <div class="grid2">
            <div class="callout">
              <div class="title"><span class="dot"></span>Where this appears (3+ concrete areas)</div>
              <ul>
                <li><strong>Semiconductor manufacturing</strong>: wafer-scale stress/strain mapping; acoustic velocities influence ultrasonic metrology and defect detection.</li>
                <li><strong>SAW/BAW resonators</strong> (RF filters, timing): wave speeds set resonance frequencies; anisotropy controls coupling and temperature sensitivity.</li>
                <li><strong>Nondestructive evaluation (NDE)</strong> of single-crystal turbine blades: anisotropic ultrasound affects beam steering, focusing, and flaw sizing.</li>
                <li><strong>Crystallographic texture in metals</strong>: effective wave speeds shift with rolling/heat treatment, impacting process monitoring.</li>
              </ul>
            </div>
            <div class="callout">
              <div class="title"><span class="dot good"></span>Why engineers care</div>
              <ul>
                <li><strong>Performance:</strong> resonance frequency accuracy, signal integrity, acoustic losses.</li>
                <li><strong>Safety:</strong> detecting cracks/voids; avoiding false negatives caused by mis-modeled anisotropy.</li>
                <li><strong>Reliability:</strong> stress waves can concentrate along certain directions → fatigue hot spots.</li>
                <li><strong>Cost & throughput:</strong> faster in-line metrology if you can predict/fit wave speeds robustly.</li>
              </ul>
            </div>
          </div>

          <h3>Typical measurement / validation methods</h3>
          <ul>
            <li><strong>Ultrasonic pulse-echo</strong> and <strong>through-transmission</strong> for time-of-flight → v(n) extraction.</li>
            <li><strong>Brillouin light scattering</strong> (microscale) for acoustic phonon velocities in crystals.</li>
            <li><strong>Resonant ultrasound spectroscopy</strong> to fit elastic constants C11, C12, C44 from resonance spectra.</li>
          </ul>

          <h3>Design trade-offs & real-world constraints</h3>
          <ul>
            <li><strong>Non-idealities:</strong> damping, temperature gradients, residual stress, grain boundaries, and defects perturb the ideal plane-wave model.</li>
            <li><strong>Tolerances:</strong> small misalignment in crystal orientation changes v(n) noticeably in anisotropic materials.</li>
            <li><strong>Model adaptation:</strong> engineers often use effective (averaged) stiffness for polycrystals or include attenuation via complex ω (or complex elastic constants).</li>
          </ul>

          <div class="callout">
            <div class="title"><span class="dot warn"></span>From lab to product</div>
            <p class="muted">
              In product settings, you rarely know C exactly. A typical workflow is:
              measure v for a set of directions → fit C11, C12, C44 → predict v(n) everywhere → incorporate into simulation (FEM, ray tracing)
              with manufacturing tolerances and temperature dependence.
            </p>
          </div>

          <a class="toplink" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 1 -->
        <section id="p1">
          <h2>PART 1 — Problem Analysis (no solving yet)</h2>

          <h3>Restate the problem (in clear words)</h3>
          <p>
            Consider a homogeneous cubic crystal. We try a plane-wave displacement field
            u(r,t) = u0 exp[i(K·r − ωt)], where u0 is a constant polarization vector and K is the wavevector.
            (a) Substitute this into the elastic wave equations to obtain the <strong>determinantal condition</strong> for a nontrivial solution u0.
            (b) Use the fact that the <em>sum of the roots</em> of the determinant equation equals the sum of the diagonal elements to prove that
            the sum of the squares of the three elastic wave speeds in any direction equals (C11 + 2C44)/ρ, using v² = ω²/K².
          </p>

          <div class="grid2">
            <div class="callout">
              <div class="title"><span class="dot"></span>Given</div>
              <ul>
                <li>Cubic crystal stiffness constants: C11, C12, C44 [Pa].</li>
                <li>Density ρ [kg·m⁻³].</li>
                <li>Plane wave form: u(r,t) = u0 exp[i(K·r − ωt)].</li>
              </ul>
            </div>
            <div class="callout">
              <div class="title"><span class="dot good"></span>Unknowns / What to find</div>
              <ul>
                <li><strong>(a)</strong> Determinant equation (dispersion/eigenvalue condition) for u0.</li>
                <li><strong>(b)</strong> Prove: v1² + v2² + v3² = (C11 + 2C44)/ρ for any direction n.</li>
              </ul>
            </div>
          </div>

          <h3>Relevant principles (and why they apply)</h3>
          <ul>
            <li><strong>Linear elastodynamics:</strong> because the wave equation in a solid comes from momentum balance and Hooke’s law.</li>
            <li><strong>Symmetry (cubic):</strong> reduces the stiffness tensor to three constants and constrains the Christoffel matrix structure.</li>
            <li><strong>Eigenvalue theory:</strong> nontrivial polarization u0 exists only if det(Γ − ρv²I)=0.</li>
          </ul>

          <div class="callout">
            <div class="title"><span class="dot warn"></span>Assumptions (explicit)</div>
            <ul>
              <li>Small-amplitude waves → linear strain, linear stress-strain law.</li>
              <li>No body forces; no dissipation (purely real ω and v).</li>
              <li>Homogeneous medium (C, ρ constant) → plane waves are valid global solutions.</li>
              <li>Infinite or effectively unbounded medium (no boundary reflections needed for this derivation).</li>
            </ul>
          </div>

          <h3>Possible approaches (2–3) and comparison</h3>
          <ul>
            <li><strong>Direct PDE → plane-wave substitution (best here):</strong> fastest and most transparent; yields Christoffel matrix immediately.</li>
            <li><strong>Variational/energy method:</strong> interpret v² as Rayleigh quotient; elegant but longer if you want explicit Γ for cubic crystals.</li>
            <li><strong>Fourier transform method:</strong> take spatial Fourier transform of PDE; equivalent to plane-wave substitution but more formal for general fields.</li>
          </ul>
          <p><strong>Chosen approach:</strong> direct substitution, because the prompt explicitly asks for “substitution” and then uses a determinant property (trace/sum of roots).</p>

          <a class="toplink" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 2 -->
        <section id="p2">
          <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

          <ol>
            <li><strong>Write the mathematical model:</strong> ρ ü = ∇·σ with σ = C:ε and ε = sym(∇u). (Sets the PDE and variables.)</li>
            <li><strong>Insert plane-wave ansatz:</strong> u = u0 e^{i(K·r − ωt)} so that ∂/∂x_j → iK_j and ∂²/∂t² → −ω². (Turns PDE into algebra.)</li>
            <li><strong>Derive the Christoffel form:</strong> (Γ_ij − ρv² δ_ij) u0_j = 0 with Γ_ij = C_{ijkl} n_k n_l and v = ω/K. (Eigenvalue problem.)</li>
            <li><strong>Nontrivial solution condition:</strong> det(Γ − ρv² I) = 0. (Determinantal dispersion relation.)</li>
            <li><strong>Specialize to cubic symmetry:</strong> express Γ explicitly using C11, C12, C44 and direction cosines (l,m,n). (Concrete matrix.)</li>
            <li><strong>Use algebraic identity:</strong> sum of eigenvalues of Γ equals tr(Γ). Since eigenvalues are ρv_s², sum v_s² = tr(Γ)/ρ. (Sum rule.)</li>
            <li><strong>Compute tr(Γ) for cubic:</strong> show tr(Γ) = C11 + 2C44 using l²+m²+n²=1. (Direction independence.)</li>
            <li><strong>Sanity checks:</strong> units, isotropic limit, high-symmetry directions.</li>
          </ol>

          <div class="callout">
            <div class="title"><span class="dot bad"></span>Common mistakes (quick tips)</div>
            <ul>
              <li><strong>Sign errors:</strong> remember ü gives −ω² times the wave field.</li>
              <li><strong>Index placement:</strong> keep the dummy indices consistent when contracting C_{ijkl} with K_jK_l.</li>
              <li><strong>Trace vs sum of roots:</strong> the “roots” are eigenvalues of Γ (or of Γ/ρ) depending on how you write the determinant.</li>
              <li><strong>Direction cosines:</strong> enforce l²+m²+n²=1 at the end; don’t treat l,m,n as independent.</li>
            </ul>
          </div>

          <a class="toplink" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 3 -->
        <section id="p3">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>Qualitative expectation (before calculating)</h3>
          <p>
            A homogeneous elastic solid supports three acoustic branches for any direction: one mostly longitudinal and two mostly transverse.
            In a cubic crystal the individual speeds depend on direction (elastic anisotropy). However, because cubic symmetry constrains how stiffness contributes,
            certain combinations (like the trace of the Christoffel matrix) can become direction-independent. That is exactly what we will prove.
          </p>

          <div class="callout">
            <div class="title"><span class="dot"></span>Mathematical Model (fields, domain, operators, conditions)</div>
            <ul>
              <li><strong>Unknown field:</strong> u(r,t) ∈ ℝ³, defined for r ∈ ℝ³ (infinite medium) and t ∈ ℝ.</li>
              <li><strong>Coordinates:</strong> Cartesian basis aligned with crystal axes (x,y,z).</li>
              <li><strong>PDE (no body force):</strong> ρ ∂²u/∂t² = ∇·σ.</li>
              <li><strong>Constitutive law:</strong> σ = C:ε, with ε = (∇u + (∇u)ᵀ)/2.</li>
              <li><strong>Boundary/initial conditions:</strong> not needed for plane-wave dispersion in an unbounded homogeneous medium; plane waves are valid global solutions due to translational invariance.</li>
            </ul>
            <p class="muted">
              Why steps are valid: linearity (small-strain Hooke law) makes the PDE linear with constant coefficients, so separable Fourier modes (plane waves) form an eigenbasis.
            </p>
          </div>

          <!-- Governing equations -->
          <div class="eq" id="eq-model">
            <div class="eqhead">
              <div class="label">Key equations (model)</div>
              <button class="btn" data-copy="eq-model-text" aria-label="Copy key model equations">⧉ Copy</button>
            </div>
            <pre id="eq-model-text"><code>Equation of motion (no body force):
  ρ ∂²u_i/∂t² = ∂σ_ij/∂x_j

Linear elasticity:
  σ_ij = C_ijkl ε_kl

Small-strain kinematics:
  ε_kl = (1/2)(∂u_k/∂x_l + ∂u_l/∂x_k)</code></pre>
          </div>

          <h3>Step 1: Reduce the PDE using tensor/index notation (no “magic jumps”)</h3>
          <p>
            Start from:
            ρ ü = ∇·σ.
            In components (Einstein summation convention over repeated indices),
          </p>

          <div class="eq" id="eq-eom">
            <div class="eqhead">
              <div class="label">Momentum balance in components</div>
              <button class="btn" data-copy="eq-eom-text">⧉ Copy</button>
            </div>
            <pre id="eq-eom-text"><code>ρ ∂²u_i/∂t² = ∂σ_ij/∂x_j</code></pre>
          </div>

          <p>
            Substitute σ_ij = C_ijkl ε_kl and ε_kl = (1/2)(∂u_k/∂x_l + ∂u_l/∂x_k).
            Because C_ijkl is symmetric in k↔l for elastic media and ε_kl is symmetric by definition, we can write (effectively)
            σ_ij = C_ijkl ∂u_k/∂x_l (the factor 1/2 is absorbed by symmetry when contracting with C for standard elastic tensors).
            More explicitly, the full substitution yields the same final “Christoffel” form for plane waves; we’ll keep the compact, standard contraction form:
          </p>

          <details>
            <summary>Optional note: why σ_ij = C_ijkl ∂u_k/∂x_l works here</summary>
            <p class="muted">
              In linear elasticity, C_ijkl has minor symmetries C_ijkl = C_ijlk and C_ijkl = C_jikl, and ε_kl is symmetric.
              For plane waves, both ∂u_k/∂x_l and ∂u_l/∂x_k appear, and the symmetric part is what contributes. Writing σ = C:ε is safest;
              after substituting u ∝ e^{iK·r}, you obtain the same Γ(n) because K_kK_l is symmetric under k↔l.
            </p>
          </details>

          <h3>Step 2: Insert the plane-wave ansatz and compute derivatives carefully</h3>
          <p>
            Use the given trial solution (vector plane wave):
          </p>

          <div class="eq" id="eq-ansatz">
            <div class="eqhead">
              <div class="label">Plane-wave trial field</div>
              <button class="btn" data-copy="eq-ansatz-text">⧉ Copy</button>
            </div>
            <pre id="eq-ansatz-text"><code>u(r,t) = u0 exp[i(K·r − ω t)]
where:
  u0 = constant polarization vector
  K = wavevector (constant), K = |K|
  ω = angular frequency</code></pre>
          </div>

          <p>
            Derivatives:
          </p>
          <ul>
            <li>Spatial derivative: ∂/∂x_j [exp(iK·r)] = iK_j exp(iK·r) ⇒ ∂u_i/∂x_j = iK_j u_i.</li>
            <li>Second time derivative: ∂²/∂t² [exp(−iωt)] = (−ω²) exp(−iωt) ⇒ ∂²u_i/∂t² = −ω² u_i.</li>
          </ul>

          <div class="callout">
            <div class="title"><span class="dot good"></span>Dimensional analysis check</div>
            <ul>
              <li>[K] = m⁻¹, [ω] = s⁻¹, so v = ω/K has units m·s⁻¹.</li>
              <li>Γ has units of stiffness: [Pa] = kg·m⁻¹·s⁻², so Γ/ρ has units m²·s⁻², matching v².</li>
            </ul>
          </div>

          <h3>Step 3: Derive the Christoffel eigenvalue problem</h3>
          <p>
            Start from the PDE in component form:
            ρ ∂²u_i/∂t² = ∂σ_ij/∂x_j.
            With σ_ij = C_ijkl ε_kl and ε_kl = (1/2)(∂u_k/∂x_l + ∂u_l/∂x_k),
            and for a plane wave, each spatial derivative brings down a factor iK.
            The result is a linear relation between u0 components:
          </p>

          <p>
            Because the medium is homogeneous, all terms have the common factor exp[i(K·r − ωt)] and we can cancel it.
            Carefully tracking factors of i:
          </p>

          <ul>
            <li>Left side: ρ (−ω²) u_i.</li>
            <li>Right side: ∂/∂x_j brings iK_j; stress already contains one derivative of u, giving another iK_l → product (i)(i)=−1.</li>
          </ul>

          <p>
            Thus the minus signs cancel, yielding:
          </p>

          <div class="eq" id="eq-christoffel">
            <div class="eqhead">
              <div class="label">Christoffel form (general anisotropic medium)</div>
              <button class="btn" data-copy="eq-christoffel-text">⧉ Copy</button>
            </div>
            <pre id="eq-christoffel-text"><code>Let n = K / |K| (unit direction vector), K = |K|.

Define the Christoffel matrix:
  Γ_ik(n) = C_ijkl n_j n_l

Then plane waves satisfy:
  (Γ_ik(n) − ρ v² δ_ik) u0_k = 0
where:
  v = ω / K</code></pre>
          </div>

          <div class="callout">
            <div class="title"><span class="dot"></span>Math Insight: the core equation as a mathematical object</div>
            <p class="muted">
              This is a <strong>finite-dimensional eigenvalue problem</strong> derived from a PDE via Fourier/separation of variables.
              The operator “∇·(C:sym∇)” becomes multiplication by Γ(n) in Fourier space.
              Nontrivial solutions exist only when ρv² is an eigenvalue of Γ(n).
            </p>
          </div>

          <h3>Part (a): The determinantal equation (condition for a nontrivial polarization)</h3>
          <p>
            The linear system (Γ − ρv²I)u0 = 0 has a nonzero solution u0 only if the matrix is singular:
          </p>

          <div class="eq" id="eq-det">
            <div class="eqhead">
              <div class="label">Determinant condition (dispersion relation)</div>
              <button class="btn" data-copy="eq-det-text">⧉ Copy</button>
            </div>
            <pre id="eq-det-text"><code>det( Γ(n) − ρ v² I ) = 0
equivalently:
det( Γ(n)/ρ − v² I ) = 0</code></pre>
          </div>

          <p>
            This cubic equation in v² has three real, nonnegative roots v1², v2², v3² for stable elastic media,
            corresponding to three acoustic modes.
          </p>

          <h3>Specialize Γ(n) to a cubic crystal (explicit matrix)</h3>
          <p>
            Choose Cartesian axes along the cubic crystal axes. Let the direction cosines be:
            n = (l, m, n) with l² + m² + n² = 1.
            For cubic symmetry (three independent elastic constants C11, C12, C44), the Christoffel matrix becomes:
          </p>

          <div class="eq" id="eq-cubic">
            <div class="eqhead">
              <div class="label">Christoffel matrix for a cubic crystal</div>
              <button class="btn" data-copy="eq-cubic-text">⧉ Copy</button>
            </div>
            <pre id="eq-cubic-text"><code>Direction cosines: n = (l, m, n), with l² + m² + n² = 1.

Γ11 = C11 l² + C44 (m² + n²)
Γ22 = C11 m² + C44 (l² + n²)
Γ33 = C11 n² + C44 (l² + m²)

Γ12 = Γ21 = (C12 + C44) l m
Γ13 = Γ31 = (C12 + C44) l n
Γ23 = Γ32 = (C12 + C44) m n</code></pre>
          </div>

          <p>
            So part (a) can be stated concretely as:
            det(Γ(l,m,n) − ρv²I) = 0, with Γ given above.
            (You do not need to expand the full cubic polynomial to complete part (b).)
          </p>

          <div class="callout">
            <div class="title"><span class="dot warn"></span>Why we don’t expand the determinant here</div>
            <p class="muted">
              Expanding a general 3×3 determinant produces a long cubic in v².
              The problem’s key trick is to use an invariant of the matrix (the trace) to get the sum of roots without full expansion.
              This is a standard mathematical-physics move: use symmetry/invariants to avoid algebra explosion.
            </p>
          </div>

          <h3>Part (b): Use “sum of roots = sum of diagonal elements” to prove the sum rule</h3>
          <p>
            Write the determinant equation in the normalized form:
          </p>

          <div class="eq" id="eq-eigs">
            <div class="eqhead">
              <div class="label">Eigenvalues and roots connection</div>
              <button class="btn" data-copy="eq-eigs-text">⧉ Copy</button>
            </div>
            <pre id="eq-eigs-text"><code>det( Γ/ρ − v² I ) = 0

The roots v_s² (s=1,2,3) are eigenvalues of the matrix (Γ/ρ).
Therefore:
  v1² + v2² + v3² = tr(Γ/ρ) = tr(Γ)/ρ</code></pre>
          </div>

          <p>
            The equality “sum of eigenvalues = trace” is a fundamental linear algebra identity valid for any square matrix
            (more precisely: for any matrix, trace equals sum of eigenvalues counting algebraic multiplicity; for symmetric real Γ, eigenvalues are real).
            Cubic crystals give a symmetric Γ, so this is especially clean.
          </p>

          <h3>Compute tr(Γ) explicitly and show direction-independence</h3>
          <p>
            Using the cubic-crystal diagonal entries from above:
          </p>
          <ul>
            <li>Γ11 = C11 l² + C44(m² + n²)</li>
            <li>Γ22 = C11 m² + C44(l² + n²)</li>
            <li>Γ33 = C11 n² + C44(l² + m²)</li>
          </ul>

          <p>
            Add them:
          </p>

          <div class="eq" id="eq-trace">
            <div class="eqhead">
              <div class="label">Trace computation (step-by-step)</div>
              <button class="btn" data-copy="eq-trace-text">⧉ Copy</button>
            </div>
            <pre id="eq-trace-text"><code>tr(Γ) = Γ11 + Γ22 + Γ33
      = [C11 l² + C44(m² + n²)]
        + [C11 m² + C44(l² + n²)]
        + [C11 n² + C44(l² + m²)]

Group C11 terms:
      = C11(l² + m² + n²)
        + C44[(m² + n²) + (l² + n²) + (l² + m²)]

Use l² + m² + n² = 1:
      = C11(1) + C44[2(l² + m² + n²)]
      = C11 + 2 C44</code></pre>
          </div>

          <p>
            Therefore:
          </p>

          <div class="box final" id="finalAnswerBox">
            <h3 style="margin:0 0 6px;">Final Result (boxed)</h3>
            <p style="margin:0;">
              For any propagation direction in a cubic crystal,
              <strong>v1² + v2² + v3² = (C11 + 2C44)/ρ</strong>.
            </p>
          </div>

          <div class="eq" id="eq-final">
            <div class="eqhead">
              <div class="label">Final answer (plain text, copy-ready)</div>
              <button class="btn" data-copy="eq-final-text" aria-label="Copy final answer">⧉ Copy</button>
            </div>
            <pre id="eq-final-text"><code>Sum rule for a cubic crystal (any direction n):
  v1^2 + v2^2 + v3^2 = (C11 + 2 C44) / ρ

where v_s = ω_s / |K| are the three phase velocities from:
  det(Γ(n) − ρ v^2 I) = 0
and Γ_ik(n) = C_ijkl n_j n_l.</code></pre>
          </div>

          <h3>Sanity checks</h3>

          <div class="callout">
            <div class="title"><span class="dot good"></span>Units</div>
            <p class="muted">
              (C11 + 2C44)/ρ has units (Pa)/(kg·m⁻³) = (kg·m⁻¹·s⁻²)/(kg·m⁻³) = m²·s⁻² = (velocity)². ✔
            </p>
          </div>

          <div class="callout">
            <div class="title"><span class="dot"></span>Limiting / special cases</div>
            <ul>
              <li><strong>Isotropic limit:</strong> if C11 = C12 + 2C44, then Γ corresponds to isotropic Lamé parameters and the sum rule still holds (now each v is direction-independent).</li>
              <li><strong>High-symmetry directions:</strong> along [100], the three speeds are simple:
                vL² = C11/ρ, vT1² = vT2² = C44/ρ, so vL² + vT1² + vT2² = (C11 + 2C44)/ρ. ✔</li>
            </ul>
          </div>

          <a class="toplink" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 4 -->
        <section id="p4">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>Re-interpret the final formula</h3>
          <p>
            The three squared speeds are the eigenvalues of Γ/ρ. The sum of eigenvalues is the trace, so the identity is really:
            “the trace of Γ(n) is invariant with direction for cubic symmetry.”
            Physically, cubic symmetry distributes stiffness contributions so that the total “effective stiffness seen by all three modes combined”
            is constant even though each mode individually varies with direction.
          </p>

          <h3>Parameter dependence (qualitative)</h3>
          <ul>
            <li>Increasing <strong>C11</strong> increases the sum of v² linearly (stiffer along principal axes → higher overall wave speed scale).</li>
            <li>Increasing <strong>C44</strong> increases the sum of v² twice as strongly (appears as 2C44), reflecting its role in shear response contributing across two transverse degrees of freedom in the trace.</li>
            <li>Increasing <strong>ρ</strong> decreases all speeds (inertia effect) and reduces the sum as 1/ρ.</li>
            <li><strong>C12</strong> does <em>not</em> appear in the sum rule—its effect redistributes speeds among modes/directions but cancels in the trace.</li>
          </ul>

          <div class="callout">
            <div class="title"><span class="dot"></span>Math Insight (invariant viewpoint)</div>
            <p class="muted">
              Γ(n) is a quadratic form in n: Γ_ik(n) = C_ijkl n_j n_l.
              The trace is tr Γ = Γ_11 + Γ_22 + Γ_33, which is a scalar quadratic form in n.
              Cubic symmetry forces this scalar quadratic form to reduce to a constant times (l²+m²+n²) = 1,
              hence direction independence.
            </p>
          </div>

          <h3>Alternative derivation idea (brief but meaningful)</h3>
          <p>
            A variational/energy method: for a plane wave, kinetic energy density scales like ρ|u̇|² and elastic energy density scales like uᵀΓu.
            The phase velocity squared can be written as a Rayleigh quotient v² = (uᵀΓu)/(ρ uᵀu).
            Summing over an orthonormal eigenbasis of Γ gives Σ v_s² = tr(Γ)/ρ directly, again reducing the task to computing tr(Γ).
          </p>

          <h3>Concept check (self-test Q&A)</h3>
          <ul>
            <li><strong>Q:</strong> Why do we solve for v² instead of v? <strong>A:</strong> The eigenvalue appears as ρv² in (Γ − ρv²I)u0=0 because time derivatives bring ω² and spatial derivatives bring K².</li>
            <li><strong>Q:</strong> Does the sum rule mean the material is isotropic? <strong>A:</strong> No. Individual v_s still depend on direction; only this specific combination is invariant for cubic symmetry.</li>
            <li><strong>Q:</strong> Where did C12 go in the final identity? <strong>A:</strong> C12 affects off-diagonal Γ entries and mode mixing but cancels out in the trace tr(Γ).</li>
            <li><strong>Q:</strong> What mathematical fact connects “sum of roots” to “diagonal sum”? <strong>A:</strong> For det(A − λI)=0, the coefficient of λ² is −tr(A), so the sum of eigenvalues equals tr(A).</li>
          </ul>

          <a class="toplink" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 5 -->
        <section id="p5">
          <h2>PART 5 — Optional Plot Guide</h2>
          <p class="muted">
            No plot is necessary here because the task is purely symbolic and based on matrix invariants (trace/eigenvalues).
            A plot would require choosing specific material constants and directions, which would illustrate anisotropy but is not needed to prove the identity.
          </p>
          <a class="toplink" href="#top">↑ Back to top</a>
        </section>
      </main>
    </div>

    <footer>
      <div>Built as a self-contained HTML article (no external libraries). Copy buttons export plain-text equations.</div>
    </footer>
  </div>

  <script>
    (function(){
      // Smooth scroll for in-page anchors
      document.querySelectorAll('a[href^="#"]').forEach(a=>{
        a.addEventListener('click', (e)=>{
          const id = a.getAttribute('href');
          if(!id || id === '#') return;
          const el = document.querySelector(id);
          if(!el) return;
          e.preventDefault();
          el.scrollIntoView({behavior:'smooth', block:'start'});
          history.pushState(null,'',id);
        });
      });

      // Copy buttons: copy innerText from target element id
      function copyTextFrom(id){
        const el = document.getElementById(id);
        if(!el) return;
        const text = el.innerText.replace(/\n{3,}/g,"\n\n").trim();
        navigator.clipboard.writeText(text).then(()=>{
          toast("Copied to clipboard.");
        }).catch(()=>{
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand('copy'); toast("Copied to clipboard."); }
          catch(e){ toast("Copy failed (browser blocked)."); }
          document.body.removeChild(ta);
        });
      }

      document.querySelectorAll('.btn[data-copy]').forEach(btn=>{
        btn.addEventListener('click', ()=> copyTextFrom(btn.getAttribute('data-copy')));
      });

      // Tiny toast
      const t = document.createElement('div');
      t.style.position='fixed';
      t.style.left='50%';
      t.style.bottom='18px';
      t.style.transform='translateX(-50%)';
      t.style.background='rgba(0,0,0,.75)';
      t.style.color='white';
      t.style.padding='10px 12px';
      t.style.borderRadius='12px';
      t.style.border='1px solid rgba(255,255,255,.18)';
      t.style.fontSize='13px';
      t.style.fontFamily='system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      t.style.boxShadow='0 10px 24px rgba(0,0,0,.25)';
      t.style.opacity='0';
      t.style.pointerEvents='none';
      t.style.transition='opacity .18s ease, transform .18s ease';
      document.body.appendChild(t);

      let toastTimer = null;
      function toast(msg){
        t.textContent = msg;
        t.style.opacity='1';
        t.style.transform='translateX(-50%) translateY(-2px)';
        clearTimeout(toastTimer);
        toastTimer = setTimeout(()=>{
          t.style.opacity='0';
          t.style.transform='translateX(-50%) translateY(0px)';
        }, 1200);
      }
    })();
  </script>
</body>
</html>
