<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Meissner Effect in a Sphere (Type I Superconductor): Magnetization, Surface Field, and Breakdown</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#101826;
      --panel2:#0f1522;
      --text:#e9eef7;
      --muted:#b9c3d6;
      --faint:#7f8aa3;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#86efac;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border:rgba(255,255,255,.10);
      --shadow: 0 14px 40px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --radius: 18px;
      --radius2: 14px;
      --max: 1120px;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(125,211,252,.18), transparent 60%),
        radial-gradient(900px 520px at 90% 10%, rgba(167,139,250,.18), transparent 55%),
        radial-gradient(900px 700px at 30% 110%, rgba(134,239,172,.10), transparent 60%),
        var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{padding:28px 18px 10px}
    .wrap{
      max-width:var(--max);
      margin:0 auto;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:18px;
      padding: 0 18px 40px;
    }
    .hero{max-width:var(--max); margin:0 auto; padding: 0 18px 12px}
    .titleCard{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:18px 18px 14px;
      overflow:hidden;
      position:relative;
    }
    .titleCard::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(500px 180px at 20% 0%, rgba(125,211,252,.25), transparent 55%),
                  radial-gradient(520px 220px at 90% 10%, rgba(167,139,250,.20), transparent 60%);
      opacity:.9;
      pointer-events:none;
    }
    .titleInner{position:relative}
    h1{margin:0 0 6px; font-size: clamp(1.35rem, 2.4vw, 2.05rem); letter-spacing:.2px}
    .subtitle{margin:0; color:var(--muted); max-width: 80ch; font-size: 1.02rem}
    .meta{margin-top:10px; display:flex; flex-wrap:wrap; gap:10px; color:var(--faint); font-size:.92rem}
    .pill{
      border:1px solid var(--border);
      background: rgba(0,0,0,.18);
      padding:6px 10px;
      border-radius: 999px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .pill b{color:var(--text); font-weight:600}
    nav#toc{
      position: sticky;
      top: 14px;
      align-self:start;
      background: rgba(16,24,38,.74);
      backdrop-filter: blur(10px);
      border:1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    nav#toc h2{
      margin:0 0 10px;
      font-size:1.02rem;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .tocLinks{display:grid; gap:8px; padding:0; margin:0; list-style:none}
    .tocLinks a{
      display:block;
      padding:8px 10px;
      border-radius: 12px;
      border:1px solid transparent;
      color:var(--muted);
      background: rgba(255,255,255,.03);
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size:.96rem;
    }
    .tocLinks a:hover{
      background: rgba(125,211,252,.09);
      border-color: rgba(125,211,252,.22);
      transform: translateY(-1px);
      color:var(--text);
      text-decoration:none;
    }
    main{min-width:0}
    section{
      background: rgba(16,24,38,.64);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 10px 26px rgba(0,0,0,.22);
      padding: 16px 16px 14px;
      margin-bottom: 14px;
      overflow:hidden;
    }
    section h2{margin: 2px 0 10px; font-size:1.28rem; letter-spacing:.2px}
    section h3{margin: 14px 0 8px; font-size:1.06rem; color: var(--text)}
    p{margin: 8px 0}
    ul{margin:8px 0 8px 20px}
    li{margin:6px 0}
    .grid2{display:grid; grid-template-columns: 1fr 1fr; gap: 12px}
    @media (max-width: 980px){
      .wrap{grid-template-columns: 1fr}
      nav#toc{position:relative; top:auto}
      .grid2{grid-template-columns: 1fr}
    }
    .callout{
      border-radius: var(--radius2);
      border:1px solid var(--border);
      background: rgba(0,0,0,.18);
      padding: 12px 12px 10px;
      margin: 10px 0;
      position:relative;
    }
    .callout strong{display:inline-flex; align-items:center; gap:8px; margin-bottom:6px}
    .callout.assumptions{border-color: rgba(125,211,252,.25); background: rgba(125,211,252,.06)}
    .callout.equations{border-color: rgba(167,139,250,.25); background: rgba(167,139,250,.06)}
    .callout.mistakes{border-color: rgba(251,191,36,.25); background: rgba(251,191,36,.06)}
    .callout.final{border-color: rgba(134,239,172,.25); background: rgba(134,239,172,.06)}
    .callout.mathinsight{border-color: rgba(125,211,252,.25); background: rgba(125,211,252,.05)}
    .badge{
      font-size:.78rem;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.20);
      color: var(--muted);
      margin-left:6px;
      vertical-align: middle;
    }
    pre{
      margin: 10px 0;
      padding: 12px;
      border-radius: var(--radius2);
      border:1px solid var(--border);
      background: rgba(7,10,16,.72);
      overflow:auto;
      font-family: var(--mono);
      font-size: .95rem;
      line-height: 1.45;
    }
    code{font-family: var(--mono)}
    .eqBlock{position:relative}
    .copyRow{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
      justify-content:flex-end;
      margin-top: -6px;
      margin-bottom: 6px;
    }
    .btn{
      appearance:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      color: var(--text);
      padding: 7px 10px;
      border-radius: 999px;
      cursor:pointer;
      font-size:.88rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(125,211,252,.09);
      border-color: rgba(125,211,252,.22);
    }
    .btn:active{transform: translateY(0)}
    .btn.secondary:hover{
      background: rgba(167,139,250,.09);
      border-color: rgba(167,139,250,.22);
    }
    .btn.ok:hover{
      background: rgba(134,239,172,.10);
      border-color: rgba(134,239,172,.24);
    }
    .small{color:var(--muted); font-size:.95rem}
    details{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      border-radius: var(--radius2);
      padding: 10px 12px;
      margin: 10px 0;
    }
    summary{cursor:pointer; color: var(--text); font-weight: 600}
    summary::-webkit-details-marker{display:none}
    summary::before{
      content:"▸";
      display:inline-block;
      margin-right:8px;
      color: var(--accent);
      transform: translateY(-1px);
    }
    details[open] summary::before{content:"▾"}
    footer{
      max-width:var(--max);
      margin: 0 auto 30px;
      padding: 0 18px;
      color: var(--faint);
      font-size:.95rem;
    }
    .backTop{display:inline-flex; align-items:center; gap:8px; margin-top: 10px}
    .printNote{display:none}
    @media print{
      body{background:#fff; color:#000}
      nav#toc{display:none}
      section, .titleCard{box-shadow:none; background:#fff; border:1px solid #ddd}
      a{color:#000; text-decoration:underline}
      .btn{display:none}
      pre{background:#f6f6f6; border-color:#ddd}
      .printNote{display:block; color:#000}
      section{break-inside: avoid-page}
      h2{break-after: avoid-page}
    }
  </style>
</head>

<body id="top">
  <header>
    <div class="hero">
      <div class="titleCard">
        <div class="titleInner">
          <h1>Meissner Effect in a Sphere (Type I Superconductor)</h1>
          <p class="subtitle">
            Derive the effective magnetization required to expel magnetic flux, compute the enhanced surface field at the equator,
            and determine the applied field at which the Meissner state breaks down.
          </p>
          <div class="meta">
            <span class="pill"><b>Geometry</b> sphere</span>
            <span class="pill"><b>Regime</b> Meissner (perfect diamagnet)</span>
            <span class="pill"><b>Key idea</b> demagnetizing field</span>
            <span class="pill"><b>Units used</b> cgs-Gaussian (as implied by 4&pi; factors)</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <nav id="toc" aria-label="Table of contents">
      <h2>
        <span>Table of Contents</span>
        <span class="badge">sticky</span>
      </h2>
      <ul class="tocLinks">
        <li><a href="#quick">Quick Summary</a></li>
        <li><a href="#part0">PART 0 — Concept Primer</a></li>
        <li><a href="#part0b">PART 0B — Industry &amp; Applied Physics</a></li>
        <li><a href="#part1">PART 1 — Problem Analysis</a></li>
        <li><a href="#part2">PART 2 — Strategy &amp; Tips</a></li>
        <li><a href="#part3">PART 3 — Full Solution</a></li>
        <li><a href="#part4">PART 4 — Deeper Understanding</a></li>
        <li><a href="#part5">PART 5 — Optional Plot Guide</a></li>
      </ul>
      <p class="small" style="margin-top:10px;">
        Tip: equations have <b>Copy</b> buttons (plain text).
      </p>
    </nav>

    <main>
      <section id="quick">
        <h2>Quick Summary</h2>
        <ul>
          <li><b>What this is about:</b> A superconducting sphere in a uniform applied magnetic field <code>B_a</code> expels flux (Meissner effect), inducing surface screening currents that act like a magnetization <code>M</code>.</li>
          <li><b>Key physics idea:</b> Finite-size samples develop a <i>demagnetizing field</i>; for a sphere it is uniform inside and equals <code>H_d = -(4π/3) M</code> (cgs).</li>
          <li><b>Governing relations (cgs):</b> <code>B = H + 4π M</code>, magnetostatics <code>∇×H=0</code> (no free currents in the bulk), <code>∇·B=0</code>.</li>
          <li><b>Meissner condition:</b> In the bulk of an ideal type I superconductor (Meissner state), <code>B_inside = 0</code>.</li>
          <li><b>Result (a):</b> The effective uniform magnetization inside the sphere is
            <code>M = -(3/(8π)) B_a</code>, i.e. <code>-(8π/3) M = B_a</code>.</li>
          <li><b>Result (b):</b> The magnetic field magnitude at the surface in the equatorial plane is enhanced to <code>|B_surface,eq| = (3/2) B_a</code>.</li>
          <li><b>Breakdown criterion:</b> The Meissner state fails when the <i>maximum surface field</i> reaches the critical field <code>H_c</code>, giving <code>B_a,break = (2/3) H_c</code>.</li>
          <li><b>Meaning:</b> Geometry concentrates the magnetic field at the surface; a sphere reaches the local critical field at an applied field lower than <code>H_c</code>.</li>
        </ul>
      </section>

      <section id="part0">
        <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

        <div class="grid2">
          <div>
            <h3>Core definitions (symbols &amp; units)</h3>
            <ul>
              <li><code>B</code>: magnetic flux density (cgs: gauss, G).</li>
              <li><code>H</code>: magnetic field intensity (cgs: oersted, Oe). In vacuum, numerically <code>B = H</code>.</li>
              <li><code>M</code>: magnetization (dipole moment per volume) (cgs: emu/cm<sup>3</sup>), enters <code>B = H + 4πM</code>.</li>
              <li><code>H_c</code>: thermodynamic critical field for a type I superconductor (cgs: Oe).</li>
              <li><code>B_a</code>: uniform applied field far from the sphere (cgs: G), taken along <code>+z</code>.</li>
              <li><code>R</code>: sphere radius.</li>
              <li><code>θ</code>: polar angle from the <code>+z</code> axis.</li>
            </ul>
            <p class="small"><b>Note on units:</b> The problem statement includes <code>4π</code> factors and the demagnetization field <code>-(4π/3)M</code>, which is the standard <b>cgs-Gaussian</b> convention. The same physics can be translated to SI, but the algebraic constants change.</p>
          </div>

          <div>
            <h3>Physical meaning &amp; intuition</h3>
            <ul>
              <li><b>Meissner effect:</b> the superconductor creates screening currents so that <b>magnetic flux is expelled</b> from the bulk: <code>B≈0</code> inside (for fields below breakdown).</li>
              <li><b>Finite-size effect:</b> those currents live near the surface and produce fields that resemble a <b>magnetized object</b> (like a diamagnet).</li>
              <li><b>Demagnetizing field:</b> the field created by magnetization often partially cancels (or reinforces) the applied field inside, depending on shape. For a sphere it’s simple and uniform.</li>
            </ul>
          </div>
        </div>

        <h3>Key laws/principles and validity conditions</h3>
        <div class="callout assumptions">
          <strong>Assumptions for this problem <span class="badge">Meissner regime</span></strong>
          <ul>
            <li><b>Type I</b> superconductor, in the <b>Meissner state</b>: bulk magnetic induction <code>B_inside = 0</code>.</li>
            <li><b>Magnetostatics</b> (time-independent): <code>∂/∂t = 0</code>, no displacement current effects.</li>
            <li><b>No free currents in the bulk</b> (screening currents are confined near the surface), so inside the material’s bulk region: <code>∇×H = 0</code>.</li>
            <li><b>Uniform applied field</b> far away: <code>B → B_a ẑ</code> as <code>r → ∞</code>.</li>
            <li><b>Idealized sphere</b> with perfect symmetry; this makes internal demagnetizing field uniform.</li>
          </ul>
        </div>

        <h3>Common models/approximations used here (and why)</h3>
        <ul>
          <li><b>Effective magnetization model:</b> Replace complicated surface currents by an equivalent uniform <code>M</code> that reproduces the same external field pattern (dipole-like).</li>
          <li><b>Demagnetizing-factor approach:</b> For ellipsoids (including spheres), the demagnetizing field is uniform and proportional to <code>M</code>, enabling simple algebra instead of solving full boundary-value PDEs.</li>
          <li><b>Local breakdown criterion:</b> In practice the Meissner state fails when the <b>maximum surface field</b> reaches <code>H_c</code> (because that’s where superconductivity is most stressed).</li>
        </ul>

        <h3>Mini intuition examples (conceptual)</h3>
        <ul>
          <li><b>Long cylinder (field along axis):</b> demagnetization is small; the surface field isn’t much larger than the applied field.</li>
          <li><b>Thin plate (field perpendicular):</b> strong demagnetization; surface fields can be much larger than applied, leading to earlier breakdown.</li>
          <li><b>Sphere:</b> “moderate” demagnetization with a clean factor <code>1/3</code>, making it the textbook benchmark.</li>
        </ul>

        <h3>What to watch for (pitfalls)</h3>
        <div class="callout mistakes">
          <strong>Watch out for these</strong>
          <ul>
            <li><b>Mixing SI and cgs:</b> In SI you do not write <code>B = H + 4πM</code>. Here we stick to cgs because the given demagnetization formula uses it.</li>
            <li><b>Confusing <code>B</code> vs <code>H</code>:</b> The Meissner condition is about <code>B</code> (flux density) inside the superconductor, not necessarily <code>H</code>.</li>
            <li><b>Sign conventions:</b> For diamagnetism, <code>M</code> points opposite the applied field.</li>
            <li><b>Breakdown location:</b> The maximum field occurs at the <b>equator</b> for a sphere in a uniform field; that’s what controls breakdown.</li>
          </ul>
        </div>

        <div class="callout mathinsight">
          <strong>Math Insight: why a sphere is “solvable”</strong>
          <p>
            In magnetostatics with <code>∇×H = 0</code>, we can write <code>H = -∇Φ</code>. Outside the sphere (no currents),
            <code>∇·B = 0</code> plus <code>B=H</code> implies <code>∇·H=0</code>, hence <code>∇²Φ = 0</code> (Laplace’s equation).
            The sphere’s symmetry restricts solutions to the <b>l=1</b> (dipole) harmonic, so the entire boundary-value problem collapses to matching a few constants.
          </p>
        </div>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>
        <h3>Where this appears in industry (concrete areas)</h3>
        <ul>
          <li><b>MRI and NMR magnets:</b> Meissner screening and demagnetization concepts matter for shielding and field-uniformity planning.</li>
          <li><b>Magnetic shielding &amp; cryogenic enclosures:</b> Superconducting shields rely on flux expulsion; geometry sets local field peaks that can trigger failure.</li>
          <li><b>Superconducting sensors &amp; metrology:</b> Cryogenic fixtures often include superconducting parts whose shapes affect local fields and stability margins.</li>
          <li><b>Power devices:</b> Local field enhancement near edges affects stability; the sphere is a clean reference case for shape-induced amplification.</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><b>Reliability:</b> Local surface-field hotspots can exceed critical limits even when the applied field seems safe.</li>
          <li><b>Performance:</b> Field distortions can degrade uniformity (imaging, calibration, sensor noise).</li>
          <li><b>Safety:</b> Early breakdown can seed transitions that dump heat into cryogenic systems.</li>
          <li><b>Cost/weight:</b> Accurate geometry factors reduce overdesign (extra shielding thickness, spacing, mass).</li>
        </ul>

        <h3>Typical measurement/validation methods</h3>
        <ul>
          <li><b>Hall probe mapping</b> near surfaces to locate maxima (equator hotspots).</li>
          <li><b>Magnetometry</b> (VSM/SQUID) to measure effective <code>M(H)</code> and infer shape effects.</li>
          <li><b>Magneto-optical imaging</b> (when applicable) to visualize flux exclusion/entry.</li>
        </ul>

        <h3>Design trade-offs &amp; real constraints</h3>
        <ul>
          <li><b>Non-ideal materials:</b> finite penetration depth <code>λ</code>, defects, roughness lower practical thresholds.</li>
          <li><b>Tolerances:</b> deviations from sphericity add higher harmonics and can increase local peaks.</li>
          <li><b>Nearby components:</b> ferromagnets, gaps, joints alter boundary conditions and amplify fields.</li>
        </ul>

        <details>
          <summary>From lab to product: adapting the ideal model</summary>
          <p>
            Real superconductors have finite London penetration depth <code>λ</code>, so screening currents occupy a shell and
            <code>B</code> decays over <code>λ</code> rather than dropping to zero instantly. When <code>λ &ll; R</code>, the ideal boundary
            condition is a good approximation with corrections scaling like <code>O(λ/R)</code>. Practical breakdown is often defect- and
            surface-barrier-limited, so safe applied fields can be below <code>(2/3)H_c</code>.
          </p>
        </details>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>Problem restatement</h3>
        <p>
          A type I superconducting sphere in a uniform applied field <code>B_a</code> expels flux in the Meissner state. Model the effect as
          a uniform magnetization <code>M</code> that produces a demagnetizing field <code>H_d = -(4π/3)M</code>. Prove:
          (a) <code>-(8π/3)M = B_a</code>.
          (b) The surface field at the equator equals <code>(3/2)B_a</code>, and thus Meissner breakdown occurs at <code>B_a = (2/3)H_c</code>.
        </p>

        <h3>Given</h3>
        <ul>
          <li><code>B_a</code> (uniform applied field, along <code>+z</code>).</li>
          <li><code>H_c</code> (critical field).</li>
          <li>Demagnetizing field (sphere): <code>H_d = -(4π/3)M</code> (cgs).</li>
        </ul>

        <h3>Unknowns</h3>
        <ul>
          <li><code>M</code> (effective magnetization in Meissner regime).</li>
          <li>Surface field at equator <code>|B(R, θ=π/2)|</code>.</li>
          <li>Breakdown applied field <code>B_a,break</code>.</li>
        </ul>

        <h3>Why these laws apply</h3>
        <ul>
          <li>Magnetostatics: <code>∇·B=0</code> and (away from surface currents) <code>∇×H=0</code>.</li>
          <li>Constitutive relation in cgs: <code>B = H + 4πM</code>.</li>
          <li>Meissner condition: <code>B_in=0</code> in the superconducting bulk.</li>
          <li>Sphere demagnetization is uniform → reduces to algebra.</li>
        </ul>

        <div class="callout assumptions">
          <strong>Assumptions</strong>
          <ul>
            <li>Ideal Meissner expulsion (<code>B_in=0</code>) until breakdown.</li>
            <li>Sphere in vacuum; applied field uniform at infinity.</li>
            <li>Breakdown when maximum surface field reaches <code>H_c</code>.</li>
          </ul>
        </div>

        <h3>Approaches</h3>
        <ul>
          <li><b>Demagnetization algebra:</b> fastest for (a).</li>
          <li><b>Laplace scalar potential:</b> fundamental for external field; yields same surface result.</li>
          <li><b>Dipole-field method:</b> efficient for (b) once <code>M</code> is known.</li>
        </ul>
        <p><b>We choose:</b> demagnetization algebra + dipole evaluation at the equator.</p>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy &amp; Tips (roadmap only)</h2>
        <ol>
          <li>Set <code>B_a</code> along <code>+z</code>; use spherical coordinates.</li>
          <li>Write internal field: <code>H_in = H_a + H_d</code> with <code>H_d = -(4π/3)M</code>.</li>
          <li>Use cgs relation: <code>B_in = H_in + 4πM</code>.</li>
          <li>Apply Meissner: <code>B_in=0</code> → solve for <code>M</code>.</li>
          <li>Convert magnetization to dipole moment: <code>m = M(4πR^3/3)</code>.</li>
          <li>Add applied field + dipole field at <code>r=R, θ=π/2</code> to get equator surface field.</li>
          <li>Set <code>|B_surface,eq| = H_c</code> → solve <code>B_a,break</code>.</li>
        </ol>

        <div class="callout mistakes">
          <strong>Common mistakes</strong>
          <ul>
            <li>Using <code>H_in=0</code> instead of <code>B_in=0</code>.</li>
            <li>Forgetting the sphere factor <code>4π/3</code> in demagnetization and dipole conversion.</li>
            <li>Missing that at the equator the applied field is purely in <code>-θ̂</code>.</li>
          </ul>
        </div>
      </section>

      <section id="part3">
        <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

        <h3>Qualitative expectation</h3>
        <p>
          The superconductor must induce currents that oppose the applied field, so <code>M</code> is opposite <code>B_a</code>.
          Geometry produces field enhancement at the surface, so breakdown occurs when the <b>largest</b> surface field hits <code>H_c</code>,
          which should happen at <code>B_a &lt; H_c</code>.
        </p>

        <h3>Mathematical model (operators, domains, BCs)</h3>
        <div class="callout equations">
          <strong>Magnetostatic model (cgs)</strong>
          <ul>
            <li>Inside (<code>r&lt;R</code>): Meissner bulk, <code>B_in = 0</code>.</li>
            <li>Outside (<code>r&gt;R</code>): vacuum, <code>∇×H=0</code>, <code>∇·B=0</code>, and <code>B=H</code>.</li>
            <li>At infinity: <code>B → B_a ẑ</code>.</li>
            <li>Constitutive relation inside: <code>B = H + 4πM</code>.</li>
          </ul>
        </div>

        <h3>(a) Find the effective magnetization <code>M</code></h3>

        <p>
          For a uniformly magnetized sphere, the demagnetizing field is uniform and given (reminder):
        </p>
        <pre><code>H_d = -(4π/3) M</code></pre>

        <p>
          The internal <code>H</code> field is the sum of the applied field intensity and the demagnetizing field:
        </p>
        <pre><code>H_in = H_a + H_d = H_a - (4π/3)M</code></pre>

        <p>
          In cgs vacuum, the applied intensity equals the applied induction numerically:
        </p>
        <pre><code>H_a = B_a</code></pre>

        <p>
          Now use the constitutive relation inside:
        </p>
        <pre><code>B_in = H_in + 4πM</code></pre>

        <p>
          Substitute <code>H_in</code>:
        </p>
        <pre><code>B_in = (H_a - (4π/3)M) + 4πM = H_a + (8π/3)M</code></pre>

        <p>
          Impose the Meissner condition <code>B_in=0</code>:
        </p>
        <pre><code>0 = H_a + (8π/3)M  ⇒  M = -(3/(8π)) H_a</code></pre>

        <p>
          With <code>H_a=B_a</code>:
        </p>

        <div class="callout final">
          <strong>Final result (a)</strong>
          <pre><code>M = -(3/(8π)) B_a
equivalently:  -(8π/3) M = B_a</code></pre>
        </div>

        <h3>(b) Surface field at the equator and breakdown</h3>

        <h4>Step 1: Magnetic dipole equivalence</h4>
        <p>
          A uniformly magnetized sphere has magnetic dipole moment
        </p>
        <pre><code>m = M V = M (4πR^3/3)</code></pre>

        <p>
          The dipole field (cgs) is
        </p>
        <pre><code>B_dip(r) = [3(m·r̂) r̂ − m] / r^3</code></pre>

        <p>
          In spherical components for a dipole along <code>z</code>:
        </p>
        <pre><code>B_r(dip) = (2m cosθ)/r^3
B_θ(dip) = (m sinθ)/r^3</code></pre>

        <h4>Step 2: Applied field in spherical components</h4>
        <pre><code>B_a ẑ = B_a (cosθ r̂ − sinθ θ̂)</code></pre>

        <h4>Step 3: Evaluate at equator <code>θ=π/2</code>, surface <code>r=R</code></h4>
        <p>
          At <code>θ=π/2</code>, <code>cosθ=0</code>, <code>sinθ=1</code>:
        </p>
        <pre><code>B_applied(eq) = −B_a θ̂
B_r(dip)(eq) = 0
B_θ(dip)(eq) = m/R^3</code></pre>

        <p>
          Therefore
        </p>
        <pre><code>B_surface,eq = (−B_a + m/R^3) θ̂</code></pre>

        <p>
          Convert <code>m/R^3</code> to <code>M</code>:
        </p>
        <pre><code>m/R^3 = [M(4πR^3/3)]/R^3 = (4π/3)M</code></pre>

        <p>
          Insert <code>M = -(3/(8π))B_a</code>:
        </p>
        <pre><code>(4π/3)M = (4π/3) [-(3/(8π))B_a] = -(1/2)B_a</code></pre>

        <p>
          Hence
        </p>
        <pre><code>B_surface,eq = (−B_a − (1/2)B_a) θ̂ = −(3/2) B_a θ̂</code></pre>

        <div class="callout final">
          <strong>Final result (b): equatorial surface field magnitude</strong>
          <pre><code>|B_surface, eq| = (3/2) B_a</code></pre>
        </div>

        <h4>Breakdown of Meissner state</h4>
        <p>
          Breakdown occurs when the maximum surface field reaches the critical field <code>H_c</code>. For a sphere, the maximum is at the equator:
        </p>
        <pre><code>(3/2) B_a,break = H_c  ⇒  B_a,break = (2/3) H_c</code></pre>

        <div class="callout final">
          <strong>Final answers (copy-ready)</strong>
          <pre><code>(a)  M = -(3/(8π)) B_a    ⇔    -(8π/3) M = B_a

(b)  |B_surface, eq| = (3/2) B_a

Breakdown (Meissner fails when |B_surface,eq| = H_c):
     B_a,break = (2/3) H_c</code></pre>
        </div>

        <h3>Sanity checks</h3>
        <ul>
          <li><b>Dimensions:</b> <code>(3/(8π))</code> is dimensionless; <code>M</code> has correct cgs units since <code>4πM</code> matches <code>H</code>.</li>
          <li><b>Sign:</b> <code>M&lt;0</code> for <code>B_a&gt;0</code> → diamagnetic.</li>
          <li><b>Limiting case:</b> <code>B_a→0</code> gives <code>M→0</code>.</li>
          <li><b>Interpretation:</b> Surface amplification factor <code>3/2</code> explains why breakdown occurs at <code>2H_c/3</code>.</li>
        </ul>

        <details>
          <summary>Optional deeper math: Laplace equation viewpoint</summary>
          <p>
            In regions without free current, <code>∇×H=0</code> so <code>H=-∇Φ</code>. Outside the sphere, <code>B=H</code> and <code>∇·B=0</code>
            imply <code>∇·H=0</code>, so <code>∇²Φ=0</code>. Axisymmetry selects the <code>l=1</code> harmonic:
            <code>Φ_out = -H_a r cosθ + C cosθ / r^2</code>. Matching boundary conditions at <code>r=R</code> fixes <code>C</code>,
            corresponding to an induced dipole moment and reproducing the same <code>3/2</code> equatorial enhancement.
          </p>
        </details>

        <div class="callout mathinsight">
          <strong>Math Insight</strong>
          <p>
            The external problem is a <b>Laplace boundary-value problem</b> (<code>∇²Φ=0</code>) with spherical symmetry.
            Only the dipole (<code>l=1</code>) term survives, so the solution reduces to matching a small number of constants—this is why
            the final results are simple rational multiples (<code>1/3</code>, <code>3/2</code>, <code>2/3</code>).
          </p>
        </div>
      </section>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

        <h3>Re-interpretation</h3>
        <ul>
          <li><b>Geometry control:</b> The demagnetization factor for a sphere (<code>N=1/3</code>) sets both <code>M</code> and the surface enhancement.</li>
          <li><b>Engineering takeaway:</b> Local fields can exceed applied fields; design limits should be based on hotspots.</li>
        </ul>

        <h3>Parameter dependence</h3>
        <ul>
          <li><code>M ∝ B_a</code> until breakdown.</li>
          <li><code>|B_surface,eq| ∝ B_a</code> with factor <code>3/2</code>.</li>
          <li><code>B_a,break ∝ H_c</code>.</li>
        </ul>

        <h3>Alternative derivation (demagnetization factor)</h3>
        <p>
          Using <code>H_in = H_a - 4π N M</code> with <code>N=1/3</code> and <code>B_in = H_in + 4πM</code>,
          Meissner gives <code>0 = H_a + 4π(1-N)M</code> → <code>M = -H_a/[4π(1-1/3)] = -(3/(8π))H_a</code>.
        </p>

        <h3>Concept check (with answers)</h3>
        <ul>
          <li><b>Q:</b> Why is breakdown set by the equator? <b>A:</b> That’s where the surface field is maximal for this geometry.</li>
          <li><b>Q:</b> What’s the core PDE outside? <b>A:</b> <code>∇²Φ=0</code> for the scalar magnetic potential.</li>
          <li><b>Q:</b> What changes in real materials? <b>A:</b> Finite penetration depth and defects lower the practical threshold below <code>(2/3)H_c</code>.</li>
        </ul>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p>
          No plot is necessary because the problem is symbolic and the key results are fixed geometric factors
          (<code>-(3/(8π))</code>, <code>3/2</code>, <code>2/3</code>) rather than a curve requiring numerical parameters.
        </p>
      </section>
    </main>
  </div>

  <footer>
    <p class="printNote"><b>Print note:</b> Copy buttons and the sticky table of contents are hidden in print view for clean pages.</p>
    <p>
      <b>Reference used:</b> For a uniformly magnetized sphere, <code>H_d=-(4π/3)M</code> (cgs). Combined with <code>B=H+4πM</code>
      and <code>B_in=0</code>, this fixes <code>M</code> and the surface field enhancement.
    </p>
  </footer>

  <script>
    (function(){
      function copyText(text){
        if(!navigator.clipboard){
          const ta = document.createElement('textarea');
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand('copy'); } catch(e){}
          document.body.removeChild(ta);
          return;
        }
        navigator.clipboard.writeText(text);
      }
      function flash(btn, msg){
        const original = btn.textContent;
        btn.textContent = msg;
        btn.style.borderColor = 'rgba(134,239,172,.35)';
        btn.style.background = 'rgba(134,239,172,.10)';
        setTimeout(()=>{
          btn.textContent = original;
          btn.style.borderColor = '';
          btn.style.background = '';
        }, 900);
      }
      document.querySelectorAll('[data-copy-target]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.getAttribute('data-copy-target');
          const el = document.getElementById(id);
          if(!el) return;
          const text = el.innerText.replace(/\u00a0/g,' ').trim();
          copyText(text);
          flash(btn, 'Copied ✓');
        });
      });

      // gentle TOC highlight based on scroll
      const links = Array.from(document.querySelectorAll('#toc a'));
      const sections = links.map(a => document.querySelector(a.getAttribute('href'))).filter(Boolean);
      function onScroll(){
        const y = window.scrollY || document.documentElement.scrollTop;
        let bestIdx = 0;
        for(let i=0;i<sections.length;i++){
          const top = sections[i].getBoundingClientRect().top + y - 120;
          if(y >= top) bestIdx = i;
        }
        links.forEach((a,i)=>{
          a.style.background = i===bestIdx ? 'rgba(125,211,252,.12)' : 'rgba(255,255,255,.03)';
          a.style.borderColor = i===bestIdx ? 'rgba(125,211,252,.25)' : 'transparent';
          a.style.color = i===bestIdx ? 'var(--text)' : 'var(--muted)';
        });
      }
      window.addEventListener('scroll', onScroll, {passive:true});
      onScroll();
    })();
  </script>
</body>
</html>
