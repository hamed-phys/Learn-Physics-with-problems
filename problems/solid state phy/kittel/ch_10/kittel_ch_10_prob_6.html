<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Diffraction Effect of a Josephson Junction (Fraunhofer-like sinc law)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#111826;
      --panel2:#0f1622;
      --text:#e9eef6;
      --muted:#b8c2d6;
      --faint:#8ea0bf;
      --accent:#76b6ff;
      --accent2:#7CFFB2;
      --warn:#ffcc66;
      --bad:#ff6b6b;
      --ok:#7CFFB2;
      --border:rgba(255,255,255,0.10);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius: 16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background: radial-gradient(1200px 800px at 10% 10%, rgba(118,182,255,0.10), transparent 55%),
                  radial-gradient(900px 600px at 85% 15%, rgba(124,255,178,0.08), transparent 55%),
                  linear-gradient(180deg, #070a0f, var(--bg));
      line-height:1.55;
    }

    header{
      padding: 28px 18px 18px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.04), transparent);
      position:relative;
      overflow:hidden;
    }
    header::after{
      content:"";
      position:absolute;
      inset:-80px -120px auto auto;
      width:420px;height:420px;
      background: radial-gradient(circle at 30% 30%, rgba(118,182,255,0.22), transparent 55%),
                  radial-gradient(circle at 70% 60%, rgba(124,255,178,0.14), transparent 58%);
      filter: blur(10px);
      transform: rotate(12deg);
      pointer-events:none;
      opacity:0.9;
    }
    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 0 18px 48px;
    }
    .title{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    h1{
      margin:0;
      font-size: clamp(22px, 2.4vw, 34px);
      letter-spacing: 0.2px;
    }
    .subtitle{
      margin: 8px 0 0;
      color: var(--muted);
      max-width: 76ch;
      font-size: 0.98rem;
    }
    .pillrow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 14px;
    }
    .pill{
      font-size: 12px;
      color: var(--muted);
      border:1px solid var(--border);
      background: rgba(255,255,255,0.03);
      padding: 7px 10px;
      border-radius: 999px;
      backdrop-filter: blur(6px);
    }

    main{
      display:grid;
      grid-template-columns: 1fr 290px;
      gap: 18px;
      padding-top: 18px;
    }

    @media (max-width: 980px){
      main{grid-template-columns: 1fr}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px 16px;
    }

    section{scroll-margin-top: 90px}
    h2{
      margin: 0 0 10px;
      font-size: 1.25rem;
      letter-spacing: 0.2px;
    }
    h3{
      margin: 16px 0 10px;
      font-size: 1.05rem;
      color: var(--text);
    }
    p{margin: 8px 0; color: var(--text)}
    ul{margin: 8px 0 8px 20px; color: var(--text)}
    li{margin: 6px 0}
    .muted{color: var(--muted)}
    .tiny{color: var(--faint); font-size: 0.92rem}

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 760px){
      .grid2{grid-template-columns:1fr}
    }

    .callout{
      border:1px solid var(--border);
      border-left: 4px solid var(--accent);
      background: rgba(118,182,255,0.06);
      padding: 12px 12px;
      border-radius: 14px;
      margin: 12px 0;
    }
    .callout.warn{
      border-left-color: var(--warn);
      background: rgba(255,204,102,0.08);
    }
    .callout.bad{
      border-left-color: var(--bad);
      background: rgba(255,107,107,0.08);
    }
    .callout.ok{
      border-left-color: var(--ok);
      background: rgba(124,255,178,0.08);
    }

    .eqbox{
      margin: 10px 0;
      border: 1px dashed rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.18);
      border-radius: 14px;
      overflow:hidden;
    }
    .eqhdr{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 10px 10px 0;
    }
    .eqhdr .label{
      font-size: 12px;
      color: var(--muted);
      letter-spacing: 0.3px;
      text-transform: uppercase;
    }
    pre{
      margin:0;
      padding: 10px 10px 12px;
      overflow:auto;
      font-family: var(--mono);
      font-size: 0.93rem;
      color: #f1f6ff;
      white-space: pre-wrap;
      word-break: break-word;
    }
    code{font-family: var(--mono)}
    .btn{
      appearance:none;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      padding: 7px 10px;
      border-radius: 10px;
      cursor:pointer;
      font-size: 12px;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px); background: rgba(255,255,255,0.07)}
    .btn:active{transform: translateY(0px)}
    .btn.small{padding:6px 8px; border-radius: 9px}
    .btn.copyok{border-color: rgba(124,255,178,0.55)}
    .btn.copybad{border-color: rgba(255,107,107,0.55)}

    aside{
      position: sticky;
      top: 14px;
      height: fit-content;
    }
    .toc{
      padding: 12px 12px;
    }
    .toc h2{
      font-size: 0.98rem;
      margin: 0 0 8px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.35px;
    }
    .toc a{
      display:block;
      padding: 7px 8px;
      margin: 4px 0;
      border-radius: 10px;
      color: var(--text);
      text-decoration:none;
      border:1px solid transparent;
      background: transparent;
      transition: background 120ms ease, border-color 120ms ease;
      font-size: 0.93rem;
    }
    .toc a:hover{
      background: rgba(255,255,255,0.05);
      border-color: rgba(255,255,255,0.10);
    }
    .toc .sub{
      margin-left: 10px;
      color: var(--muted);
      font-size: 0.90rem;
    }

    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      color: var(--accent);
      text-decoration:none;
      margin-top: 10px;
      font-size: 0.95rem;
    }
    .backtop:hover{text-decoration:underline}

    details{
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 10px 10px;
      background: rgba(255,255,255,0.02);
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 650;
    }
    details[open] summary{margin-bottom: 8px}
    .kpi{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin: 10px 0 0;
    }
    .kpi .box{
      flex: 1 1 160px;
      border: 1px solid var(--border);
      border-radius: 14px;
      background: rgba(0,0,0,0.16);
      padding: 10px 10px;
      min-width: 160px;
    }
    .kpi .num{
      font-family: var(--mono);
      font-size: 0.98rem;
      color:#f3f7ff;
    }
    .kpi .lbl{
      color: var(--muted);
      font-size: 0.86rem;
      margin-top: 2px;
    }

    figure{
      margin: 14px 0 4px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: rgba(0,0,0,0.18);
      overflow:hidden;
    }
    figcaption{
      padding: 10px 12px 12px;
      color: var(--muted);
      font-size: 0.92rem;
    }
    canvas{display:block; width:100%; height:auto}

    footer{
      margin-top: 18px;
      padding: 16px 0 30px;
      color: var(--muted);
      border-top:1px solid var(--border);
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, aside, .btn, .pillrow, .backtop{display:none !important}
      .card, figure, details{box-shadow:none; background:#fff; border:1px solid #bbb}
      pre{color:#000}
      a{color:#000; text-decoration:underline}
      section{break-inside:avoid-page}
    }

    /* subtle micro-animation */
    @keyframes pop{
      0%{transform:scale(0.98); opacity:0.7}
      100%{transform:scale(1); opacity:1}
    }
    .pop{animation: pop 220ms ease}
  </style>
</head>
<body>
  <header id="top">
    <div class="wrap">
      <div class="title">
        <div>
          <h1>Diffraction Effect of a Josephson Junction: why the DC current becomes a <span style="color:var(--accent)">sinc</span></h1>
          <p class="subtitle">
            A rectangular Josephson junction in an in-plane magnetic field develops a spatially varying gauge-invariant phase difference.
            When you integrate the local Josephson current density across the width, you get the same mathematics as optical Fraunhofer diffraction:
            a <em>sinc</em> envelope.
          </p>
          <div class="pillrow">
            <span class="pill">Topic: superconductivity &amp; Josephson effect</span>
            <span class="pill">Key math: gauge invariance, line integral, Fourier integral</span>
            <span class="pill">Result: symbolic (closed form)</span>
            <span class="pill">Engineering lens: SQUIDs, sensors, qubits</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <main>
      <article class="card">
        <section id="quick-summary">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this is:</strong> A Josephson junction (rectangular cross section) in a magnetic field <em>in the plane</em> shows a “diffraction” pattern of its DC supercurrent.</li>
            <li><strong>Key physics idea:</strong> The magnetic vector potential <code>A</code> makes the <em>gauge-invariant</em> phase difference vary across the junction width; different parts contribute currents with different phases and partially cancel.</li>
            <li><strong>Governing relations:</strong> Josephson current density <code>j = j_c sin(δ)</code>, with gauge-invariant phase <code>δ = φ2 − φ1 − (2e/ħc)∫ A·dl</code>; and magnetostatics <code>∇×A = B</code>.</li>
            <li><strong>Geometry-to-flux link:</strong> For an in-plane field normal to the width direction, the relevant flux through the <code>(width × thickness)</code> rectangle is <code>Φ = B w T</code>.</li>
            <li><strong>Main result:</strong> The DC current is reduced by a <em>sinc</em> factor:
              <code>J = J0 * sin(w T B e / (ħ c)) / (w T B e / (ħ c))</code>.
            </li>
            <li><strong>Physical meaning:</strong> As <code>B</code> grows, phase winding across the width increases, giving interference zeros (nodes) when the total phase twist equals an integer multiple of <code>π</code>.</li>
            <li><strong>Type of answer:</strong> Fully symbolic derivation; one optional plot illustrates the normalized sinc envelope.</li>
          </ul>
        </section>

        <section id="part0">
          <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

          <h3>Core definitions (symbols + SI units)</h3>
          <ul>
            <li><strong>Magnetic field</strong> <code>B</code> (tesla, T): here applied <em>in the plane</em> of the junction.</li>
            <li><strong>Vector potential</strong> <code>A</code> (weber per meter, Wb/m): defined so that <code>∇×A = B</code>.</li>
            <li><strong>Superconducting phases</strong> <code>φ1, φ2</code> (radians): phases of the macroscopic condensate wavefunctions in each electrode.</li>
            <li><strong>Gauge-invariant phase difference</strong> <code>δ</code> (radians): the physical phase controlling the Josephson effect.</li>
            <li><strong>Junction dimensions</strong>:
              <ul>
                <li><code>w</code> = width (m) along which the phase varies</li>
                <li><code>T</code> = thickness of the junction region (m) along the current path</li>
              </ul>
            </li>
            <li><strong>Electron charge magnitude</strong> <code>e</code> (coulomb, C); Cooper pair charge is <code>2e</code>.</li>
            <li><strong>Reduced Planck constant</strong> <code>ħ</code> (J·s); <strong>speed of light</strong> <code>c</code> (m/s) appears because the problem is written in Gaussian/CGS-like convention.</li>
            <li><strong>Josephson critical current density</strong> <code>j_c</code> (A/m²): maximum DC supercurrent density locally for a given point in the junction.</li>
            <li><strong>Total DC current</strong> <code>J</code> (A): integral of current density over the junction area.</li>
          </ul>

          <h3>Physical meaning (intuition)</h3>
          <p>
            In a uniform junction at <code>B=0</code>, the phase difference is the same everywhere, so all points push supercurrent in phase and the total
            current adds coherently. When a magnetic field is present, the phase becomes position-dependent, so contributions from different transverse
            positions can partially cancel—exactly like waves from different parts of an aperture interfering.
          </p>

          <h3>Key laws/principles and validity conditions</h3>
          <div class="callout ok">
            <strong>Josephson relations (DC form):</strong>
            <ul>
              <li>Local current density: <code>j(r) = j_c sin(δ(r))</code></li>
              <li>Gauge-invariant phase difference:
                <code>δ(r) = φ2(r) − φ1(r) − (2e/ħc) ∫_1^2 A·dl</code>
              </li>
            </ul>
            <div class="tiny">
              Valid for weak-link junctions where the tunneling (or weak coupling) approximation holds and dynamics are slow (DC, no time-varying fields).
            </div>
          </div>

          <div class="callout warn">
            <strong>Regime assumptions typically used:</strong>
            <ul>
              <li>Uniform <code>j_c</code> across the width (no strong inhomogeneity).</li>
              <li>Magnetic field and vector potential are treated as externally imposed (self-field of the Josephson current neglected or small).</li>
              <li>Quasi-static magnetostatics: <code>∇×A = B</code>, no significant displacement current effects.</li>
              <li>Junction is “short” in the sense that phase varies primarily across width <code>w</code> (not along other directions).</li>
            </ul>
          </div>

          <h3>Common models/approximations and why they’re used</h3>
          <ul>
            <li><strong>Uniform-current (aperture) model:</strong> treat the junction as an aperture with constant amplitude <code>j_c</code>, but with a phase ramp across it.</li>
            <li><strong>Neglect self-field:</strong> simplifies the phase profile to one determined by the applied <code>B</code>, enabling a closed-form integral.</li>
            <li><strong>Linear phase profile:</strong> in a uniform field and simple gauge, the phase varies linearly with transverse coordinate.</li>
          </ul>

          <h3>Mini intuition examples (minimal algebra)</h3>
          <ul>
            <li><strong>No field:</strong> all points have same phase → total current is maximal.</li>
            <li><strong>Small field:</strong> slight phase spread across width → small quadratic reduction (because <code>sinc(x) ≈ 1 − x²/6</code>).</li>
            <li><strong>Larger field:</strong> phase winds by ~<code>π</code> across width → near-complete cancellation → current crosses zero (diffraction node).</li>
          </ul>

          <h3>What to watch for (pitfalls &amp; sign conventions)</h3>
          <ul>
            <li><strong>Gauge invariance:</strong> you must use <code>δ = Δφ − (2e/ħc)∫A·dl</code>, not just <code>Δφ</code>.</li>
            <li><strong>Which area gives flux:</strong> for an <em>in-plane</em> field, the relevant flux is through the rectangle <code>w×T</code>, not <code>w×(junction length)</code>.</li>
            <li><strong>Choosing the phase offset:</strong> the problem sets <code>δ(B=0)=π/2</code> to make the current maximal at zero field.</li>
            <li><strong>Self-field effects:</strong> in real devices, screening and self-fields can distort the ideal sinc pattern.</li>
          </ul>

          <div class="callout">
            <strong>Math Insight:</strong>
            The final current is a <em>spatial integral of a sinusoid with a linear phase ramp</em>. Mathematically, it is the imaginary part of
            <code>∫ exp(i[δ0 + ky]) dy</code>, i.e., the Fourier transform of a rectangular window. That is exactly why a <code>sinc</code> function appears.
          </div>
        </section>

        <section id="part0b">
          <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>

          <h3>Where this appears in industry (3+ concrete areas)</h3>
          <ul>
            <li><strong>Magnetometry &amp; sensing (SQUIDs):</strong> Josephson junction interference is central to SQUID operation and calibration; field-dependent critical currents set sensitivity and dynamic range.</li>
            <li><strong>Superconducting digital &amp; RF electronics:</strong> junctions in RSFQ logic, parametric amplifiers, and mixers can experience field-induced critical current reduction that impacts margins and noise.</li>
            <li><strong>Quantum computing hardware:</strong> transmon and flux qubits use Josephson junctions; unwanted magnetic fields shift junction parameters, contributing to drift, decoherence, and yield issues.</li>
            <li><strong>Metrology:</strong> Josephson voltage standards depend on stable junction behavior; magnetic pickup can perturb operating points.</li>
          </ul>

          <h3>Why engineers care</h3>
          <ul>
            <li><strong>Performance:</strong> <code>J(B)</code> sets maximum supercurrent; reduced critical current changes gain, switching speed, and qubit frequencies.</li>
            <li><strong>Reliability:</strong> sensitivity to stray fields means packaging, shielding, and layout matter for reproducible operation.</li>
            <li><strong>Cost &amp; manufacturability:</strong> junction uniformity determines how clean the diffraction pattern is; process variation shows up as distorted lobes and reduced <code>J0</code>.</li>
          </ul>

          <h3>Typical measurement/validation methods</h3>
          <ul>
            <li><strong>I–V curves vs magnetic field:</strong> sweep <code>B</code> and record critical current to map the “Fraunhofer pattern.”</li>
            <li><strong>Scanning SQUID / magneto-optic imaging:</strong> visualize trapped flux and field nonuniformity that would distort <code>J(B)</code>.</li>
            <li><strong>On-wafer cryogenic probing:</strong> for process control, extracting <code>j_c</code> and uniformity from the lobe structure.</li>
          </ul>

          <h3>Design trade-offs &amp; constraints</h3>
          <ul>
            <li><strong>Shielding vs accessibility:</strong> magnetic shielding improves stability but adds cost, mass, and integration complexity.</li>
            <li><strong>Geometry:</strong> increasing <code>w</code> or <code>T</code> increases flux sensitivity (<code>Φ = B w T</code>)—good for sensors, bad for robustness.</li>
            <li><strong>Non-idealities:</strong> nonuniform <code>j_c(y)</code>, edge roughness, trapped vortices, and field focusing shift zeros and reduce contrast.</li>
          </ul>

          <details>
            <summary>From lab to product: how the ideal model is adapted</summary>
            <p class="muted">
              In products, engineers rarely assume perfectly uniform <code>j_c</code> or perfectly uniform <code>B</code>.
              A common adaptation is to replace the simple rectangular “aperture” by an effective profile <code>j_c(y)</code> and compute
              <code>J(B) = ∫ j_c(y) sin(δ0 + k y) dy</code>. The measured pattern then becomes a diagnostic tool:
              deviations from sinc indicate spatial nonuniformity or trapped flux. Packaging adds magnetic permeability effects and field focusing,
              which can be captured with electromagnetic simulation feeding an effective <code>A(y)</code> into the phase integral.
            </p>
          </details>
        </section>

        <section id="part1">
          <h2>PART 1 — Problem Analysis (no solving yet)</h2>

          <h3>Restate the problem (in plain words)</h3>
          <p>
            We have a Josephson junction of rectangular cross section. A magnetic field <code>B</code> is applied <em>in the plane of the junction</em>,
            and it is oriented normal to the edge corresponding to width <code>w</code>. The junction thickness (distance across which the supercurrent tunnels)
            is <code>T</code>. Assuming the phase difference at zero field is <code>π/2</code>, show that the DC current becomes
            <code>J = J0 * sin(w T B e/(ħ c)) / (w T B e/(ħ c))</code>.
          </p>

          <div class="grid2">
            <div class="callout">
              <strong>Given:</strong>
              <ul>
                <li>Width: <code>w</code></li>
                <li>Thickness: <code>T</code></li>
                <li>Uniform in-plane magnetic field: <code>B</code></li>
                <li>Phase offset at <code>B=0</code>: <code>δ0 = π/2</code></li>
              </ul>
            </div>
            <div class="callout">
              <strong>Unknowns / target:</strong>
              <ul>
                <li>Total DC current <code>J(B)</code></li>
                <li>Show it equals a sinc reduction of the zero-field value <code>J0</code></li>
              </ul>
            </div>
          </div>

          <h3>Relevant principles and why they apply</h3>
          <ul>
            <li><strong>Josephson current-phase relation:</strong> DC supercurrent depends on <code>sin</code> of gauge-invariant phase difference.</li>
            <li><strong>Gauge invariance with vector potential:</strong> applied magnetic field enters the phase through <code>∫A·dl</code>.</li>
            <li><strong>Superposition via spatial integration:</strong> total current is integral of local current density over the junction area; cancellation can occur due to phase variation.</li>
          </ul>

          <h3>Assumptions (explicit)</h3>
          <div class="callout warn">
            <ul>
              <li><strong>Uniform junction:</strong> constant <code>j_c</code> across the width.</li>
              <li><strong>Neglect self-field:</strong> phase profile is determined by the applied <code>B</code>, not by the Josephson current’s own field.</li>
              <li><strong>Static field:</strong> magnetostatics (<code>∇×A=B</code>), no time dependence.</li>
              <li><strong>Phase depends primarily on one transverse coordinate</strong> (across width).</li>
            </ul>
          </div>

          <h3>Possible approaches (compare)</h3>
          <ul>
            <li><strong>(A) Gauge-invariant phase + direct integral (best):</strong>
              derive a linear phase profile <code>δ(y)=δ0+ky</code> from <code>A</code>, then integrate <code>sin(δ(y))</code> over <code>y∈[-w/2,w/2]</code>.
              <span class="muted">Pros: shortest, transparent; Cons: must be careful with geometry and gauge.</span>
            </li>
            <li><strong>(B) Flux quantization loop argument:</strong>
              relate phase difference between two points to enclosed flux via a contour integral of <code>∇δ</code>.
              <span class="muted">Pros: explicitly gauge-invariant; Cons: slightly more abstract.</span>
            </li>
            <li><strong>(C) Treat as Fourier transform (aperture optics analogy):</strong>
              current is the Fourier transform of a rectangular “aperture” with phase tilt.
              <span class="muted">Pros: quick pattern recognition; Cons: must still connect <code>k</code> to <code>B</code>.</span>
            </li>
          </ul>

          <p><strong>Chosen approach:</strong> (A) because it is direct, constructive, and makes the mathematical steps (linearity → integral → sinc) explicit.</p>
        </section>

        <section id="part2">
          <h2>PART 2 — Strategy &amp; Tips (roadmap only)</h2>

          <ol>
            <li><strong>Set coordinates &amp; geometry:</strong> choose the width coordinate <code>y</code> across <code>w</code> and tunneling direction <code>x</code> across thickness <code>T</code>.</li>
            <li><strong>Write the gauge-invariant phase:</strong> <code>δ(y) = φ2 − φ1 − (2e/ħc)∫ A·dl</code>.</li>
            <li><strong>Pick a convenient gauge for uniform in-plane <code>B</code>:</strong> choose <code>A</code> so that <code>∇×A = B</code> and the line integral across thickness is easy.</li>
            <li><strong>Show <code>δ(y)</code> is linear in <code>y</code>:</strong> obtain a phase ramp <code>δ(y)=δ0+ky</code> with <code>k</code> proportional to <code>B T</code>.</li>
            <li><strong>Write the local Josephson current density:</strong> <code>j(y) = j_c sin(δ(y))</code>.</li>
            <li><strong>Integrate across width:</strong> total current <code>J(B) = ∫ j(y) dy</code> (times any uniform length into the page; absorb into <code>J0</code>).</li>
            <li><strong>Use trig/exponential integral identity:</strong> integral of <code>sin(δ0+ky)</code> over symmetric interval gives a <code>sinc</code>.</li>
            <li><strong>Apply the condition <code>δ0=π/2</code>:</strong> simplifies amplitude to the desired form.</li>
            <li><strong>Sanity checks:</strong> dimensions, <code>B→0</code> limit, zeros at expected phase windings.</li>
          </ol>

          <div class="callout bad">
            <strong>Common mistakes</strong>
            <ul>
              <li>Using <code>Δφ</code> instead of the gauge-invariant <code>δ</code>.</li>
              <li>Picking the wrong effective flux area for an <em>in-plane</em> field (should involve <code>T</code>).</li>
              <li>Dropping the factor of <code>2e</code> for Cooper pairs (or mixing SI/CGS conventions inconsistently).</li>
              <li>Forgetting the phase offset choice <code>δ0=π/2</code> (it sets the zero-field current to be maximal).</li>
            </ul>
          </div>
        </section>

        <section id="part3">
          <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

          <h3>Qualitative expectation before calculating</h3>
          <p>
            At <code>B=0</code>, the phase is uniform and the DC current is maximal: <code>J(B=0)=J0</code>.
            When <code>B</code> increases, the phase difference across the width develops a gradient, so currents from different transverse slices
            add with different phases—partial cancellation reduces the net current, eventually producing zeros (complete cancellation).
            This is the same “interference” logic as diffraction of waves through a finite aperture.
          </p>

          <h3>Step 1 — Mathematical model (variables, domain, coordinates, boundary conditions)</h3>
          <div class="callout">
            <strong>Geometry and coordinates</strong>
            <ul>
              <li>Let the junction barrier occupy <code>0 ≤ x ≤ T</code> (tunneling direction).</li>
              <li>Let the junction extend across width <code>y ∈ [-w/2, +w/2]</code>.</li>
              <li>Assume uniformity along the third direction (call it <code>z</code>), so we consider current per unit length in <code>z</code>, or absorb that length into <code>J0</code>.</li>
              <li>Applied magnetic field <code>B</code> lies in the junction plane and is normal to the width-edge direction; a convenient choice is <code>B = B \hat{z}</code> (in-plane) while width is along <code>y</code> and thickness along <code>x</code>.
                What matters is that <code>B</code> threads the rectangle spanned by <code>T</code> and <code>w</code>.</li>
            </ul>
            <div class="tiny">
              We assume steady state (DC), so there are no time-dependent boundary conditions. The key “boundary condition” is the given phase offset:
              <code>δ(B=0)=π/2</code>.
            </div>
          </div>

          <h3>Step 2 — Gauge-invariant phase difference</h3>
          <p>
            The physically meaningful phase that enters the Josephson relation is the gauge-invariant phase difference:
          </p>

          <div class="eqbox" id="eq-gauge">
            <div class="eqhdr">
              <div class="label">Key equation: gauge-invariant phase</div>
              <button class="btn small" data-copy="#eqtext-gauge" aria-label="Copy equation">Copy</button>
            </div>
            <pre id="eqtext-gauge"><code>δ(y) = φ2(y) − φ1(y) − (2e/(ħ c)) ∫_1^2 A(x,y) · dl</code></pre>
          </div>

          <p class="muted">
            Why this step is valid: the condensate phase <code>φ</code> is gauge-dependent, but the combination
            <code>∇φ − (2e/ħc)A</code> is gauge-invariant; integrating across the junction produces a gauge-invariant
            phase difference that controls tunneling.
          </p>

          <h3>Step 3 — Choose a convenient vector potential (use ∇×A = B)</h3>
          <p>
            We need a vector potential <code>A</code> such that <code>∇×A = B</code> (magnetostatics).
            For a uniform field oriented along <code>z</code>, a standard gauge choice is:
          </p>

          <div class="eqbox" id="eq-gaugechoice">
            <div class="eqhdr">
              <div class="label">Convenient gauge (one choice)</div>
              <button class="btn small" data-copy="#eqtext-gaugechoice">Copy</button>
            </div>
            <pre id="eqtext-gaugechoice"><code>B = B ẑ,  choose  A = (0, A_y, 0) with  A_y = B x.
Then ∇×A has z-component: (∂A_y/∂x − ∂A_x/∂y) = ∂(Bx)/∂x = B.</code></pre>
          </div>

          <p class="muted">
            Why this is valid: magnetostatics only requires <code>∇×A=B</code>; many gauges work. We pick one that makes the line integral across
            <code>x</code> simple. Any other gauge would give the same final <code>J(B)</code> because <code>δ</code> is gauge-invariant.
          </p>

          <h3>Step 4 — Evaluate the line integral across thickness (build δ(y))</h3>
          <p>
            Take the integration path <code>dl = dx  x̂</code> straight across the barrier from <code>x=0</code> to <code>x=T</code> at fixed <code>y</code>.
            In our gauge, <code>A</code> has only a <code>y</code>-component, so <code>A·dl = A_x dx = 0</code> along this straight path.
            That looks like no effect—so we must be careful: the physically relevant spatial variation of <code>δ</code> is best obtained from
            how <code>δ</code> changes between two points across the width (a loop/flux argument), which avoids path confusion.
          </p>

          <div class="callout warn">
            <strong>Important clarification:</strong>
            The quantity <code>δ(y)</code> can be defined with different (but physically equivalent) paths. The <em>difference</em>
            <code>δ(y2)−δ(y1)</code> is directly related to the magnetic flux through the rectangle spanning <code>y1→y2</code> and the thickness <code>T</code>.
            This is the cleanest way to proceed and keeps gauge invariance explicit.
          </div>

          <h3>Step 5 — Flux/loop argument to get the phase gradient (explicitly gauge-invariant)</h3>
          <p>
            Consider two transverse positions <code>y</code> and <code>y+dy</code>. Form a thin rectangular loop:
            go across the junction (through thickness <code>T</code>) at <code>y</code>, then along the superconducting electrode by <code>dy</code>,
            then back across the junction at <code>y+dy</code>, then return along the other electrode.
          </p>
          <p>
            The gauge-invariant phase change around a closed loop satisfies a flux relation. In differential form, the transverse gradient of the
            gauge-invariant phase difference obeys (for uniform field and negligible self-field):
          </p>

          <div class="eqbox" id="eq-grad">
            <div class="eqhdr">
              <div class="label">Phase gradient from enclosed flux</div>
              <button class="btn small" data-copy="#eqtext-grad">Copy</button>
            </div>
            <pre id="eqtext-grad"><code>∂δ/∂y = (2e/(ħ c)) * (B * T)</code></pre>
          </div>

          <p>
            Here is the reasoning step-by-step, with no “magic jump”:
          </p>

          <details open>
            <summary>Derivation of ∂δ/∂y using Stokes’ theorem</summary>
            <p class="muted">
              For the thin rectangle of height <code>T</code> (across the barrier) and width <code>dy</code> (across the junction width),
              the magnetic flux through it is <code>dΦ = B * (T dy)</code> (because <code>B</code> is normal to that rectangle).
            </p>
            <div class="eqbox" id="eq-stokes">
              <div class="eqhdr">
                <div class="label">Stokes + flux link (conceptual)</div>
                <button class="btn small" data-copy="#eqtext-stokes">Copy</button>
              </div>
              <pre id="eqtext-stokes"><code>dΦ = ∬ B·dS = ∬ (∇×A)·dS = ∮ A·dl</code></pre>
            </div>
            <p class="muted">
              The gauge-invariant phase difference <code>δ</code> includes <code>−(2e/ħc)∫A·dl</code>.
              When you compare <code>δ(y+dy)</code> and <code>δ(y)</code>, the difference in the line integrals across the barrier equals the loop integral
              <code>∮A·dl</code>, which equals <code>dΦ</code> by Stokes’ theorem.
              Therefore:
            </p>
            <div class="eqbox" id="eq-delta">
              <div class="eqhdr">
                <div class="label">Incremental phase difference</div>
                <button class="btn small" data-copy="#eqtext-delta">Copy</button>
              </div>
              <pre id="eqtext-delta"><code>δ(y+dy) − δ(y) = (2e/(ħ c)) * dΦ
               = (2e/(ħ c)) * (B * T * dy)</code></pre>
            </div>
            <p class="muted">
              Dividing by <code>dy</code> and taking <code>dy→0</code> gives:
              <code>∂δ/∂y = (2e/(ħc)) B T</code>.
            </p>
          </details>

          <p>
            Integrate this first-order ODE in <code>y</code> (linearity makes this straightforward):
          </p>

          <div class="eqbox" id="eq-phaseprofile">
            <div class="eqhdr">
              <div class="label">Phase profile across the width</div>
              <button class="btn small" data-copy="#eqtext-phaseprofile">Copy</button>
            </div>
            <pre id="eqtext-phaseprofile"><code>Let k ≡ (2e/(ħ c)) B T.
Then ∂δ/∂y = k  ⇒  δ(y) = δ0 + k y,
where δ0 is the phase at y=0 (a constant set by bias conditions).</code></pre>
          </div>

          <h3>Step 6 — Local Josephson current density and total current</h3>
          <p>
            The DC Josephson current density at position <code>y</code> is:
          </p>

          <div class="eqbox" id="eq-localj">
            <div class="eqhdr">
              <div class="label">Local current density</div>
              <button class="btn small" data-copy="#eqtext-localj">Copy</button>
            </div>
            <pre id="eqtext-localj"><code>j(y) = j_c sin(δ(y)) = j_c sin(δ0 + k y)</code></pre>
          </div>

          <p>
            The total current (per unit length in the uniform direction) is the integral across the width:
          </p>

          <div class="eqbox" id="eq-integral">
            <div class="eqhdr">
              <div class="label">Total current as a width integral</div>
              <button class="btn small" data-copy="#eqtext-integral">Copy</button>
            </div>
            <pre id="eqtext-integral"><code>J(B) = ∫_{-w/2}^{w/2} j(y) dy
     = j_c ∫_{-w/2}^{w/2} sin(δ0 + k y) dy</code></pre>
          </div>

          <h3>Step 7 — Perform the integral (show all steps)</h3>
          <p>
            Compute:
          </p>
          <div class="eqbox" id="eq-intsteps">
            <div class="eqhdr">
              <div class="label">Integral evaluation (no skipped steps)</div>
              <button class="btn small" data-copy="#eqtext-intsteps">Copy</button>
            </div>
            <pre id="eqtext-intsteps"><code>J(B) = j_c ∫_{-w/2}^{w/2} sin(δ0 + k y) dy

Let u = δ0 + k y  ⇒  du = k dy  ⇒  dy = du/k.

When y = -w/2, u = δ0 - k w/2.
When y =  w/2, u = δ0 + k w/2.

So:
J(B) = (j_c/k) ∫_{δ0 - k w/2}^{δ0 + k w/2} sin(u) du
     = (j_c/k) [ -cos(u) ]_{δ0 - k w/2}^{δ0 + k w/2}
     = (j_c/k) ( -cos(δ0 + k w/2) + cos(δ0 - k w/2) )

Use identity: cos(a-b) - cos(a+b) = 2 sin(a) sin(b).
So:
J(B) = (j_c/k) * (2 sin(δ0) sin(k w/2))
     = (2 j_c sin(δ0)/k) * sin(k w/2)</code></pre>
          </div>

          <p>
            Now define the zero-field current <code>J0</code> under the problem’s convention <code>δ0 = π/2</code> when <code>B=0</code>.
            With <code>δ0 = π/2</code>, we have <code>sin(δ0)=1</code>, which makes the zero-field current maximal.
          </p>

          <p>
            To put the result into a clean “sinc” form, multiply and divide by <code>(k w/2)</code>:
          </p>

          <div class="eqbox" id="eq-sincform">
            <div class="eqhdr">
              <div class="label">Sinc form</div>
              <button class="btn small" data-copy="#eqtext-sincform">Copy</button>
            </div>
            <pre id="eqtext-sincform"><code>J(B) = (2 j_c sin(δ0)/k) * sin(k w/2)
     = (j_c w sin(δ0)) * [ sin(k w/2) / (k w/2) ]</code></pre>
          </div>

          <p>
            Recognize the bracket as <code>sinc(x)</code> with <code>x = k w/2</code>. Define the (maximum) zero-field current:
          </p>

          <div class="eqbox" id="eq-J0">
            <div class="eqhdr">
              <div class="label">Zero-field normalization</div>
              <button class="btn small" data-copy="#eqtext-J0">Copy</button>
            </div>
            <pre id="eqtext-J0"><code>J0 ≡ j_c w sin(δ0).
With δ0 = π/2 ⇒ J0 = j_c w.</code></pre>
          </div>

          <p>
            Substitute <code>k = (2e/(ħc)) B T</code>. Then:
            <code>x = k w/2 = (e/(ħc)) B T w</code>.
          </p>

          <div class="callout ok">
            <strong>Final algebraic form:</strong> the DC current is
            <code>J(B) = J0 * sin(x)/x</code>
            with <code>x = (e/(ħ c)) B T w</code>.
          </div>

          <div class="eqbox" id="final-answer-box">
            <div class="eqhdr">
              <div class="label">Final answer (copyable)</div>
              <button class="btn small" data-copy="#final-answer-text">Copy</button>
            </div>
            <pre id="final-answer-text"><code>J(B) = J0 * sin( (w T B e)/(ħ c) ) / ( (w T B e)/(ħ c) )</code></pre>
          </div>

          <h3>Sanity checks</h3>
          <div class="grid2">
            <div class="callout">
              <strong>Dimensional analysis</strong>
              <p class="muted">
                The argument <code>x = (e/(ħc)) B T w</code> must be dimensionless. Interpreting <code>B T w</code> as a flux-like quantity,
                and using the Josephson phase-flux factor <code>(2e/(ħc))</code>, we indeed get a pure number (phase).
              </p>
            </div>
            <div class="callout">
              <strong>Limiting cases</strong>
              <ul class="muted">
                <li><code>B→0</code>: <code>sin(x)/x → 1</code> ⇒ <code>J→J0</code> (correct).</li>
                <li>Small field: <code>sin(x)/x ≈ 1 − x²/6</code> ⇒ quadratic suppression.</li>
                <li>Zeros: <code>J=0</code> when <code>x = nπ</code> ⇒ <code>B_n = nπ ħ c /(e T w)</code>.</li>
              </ul>
            </div>
          </div>

          <h3>Physical interpretation (plain language)</h3>
          <p>
            The field produces a phase twist across the width. When that twist equals <code>π</code>, half the junction tends to push current “forward”
            while the other half pushes “backward,” canceling the net DC current. The sinc envelope is the mathematical fingerprint of integrating a
            constant-amplitude oscillation over a finite width.
          </p>

          <figure class="pop" aria-label="Plot of normalized Josephson current versus normalized field parameter">
            <canvas id="plot" width="1200" height="640"></canvas>
            <figcaption>
              <strong>One useful visualization:</strong> the normalized current <code>J/J0 = sin(x)/x</code> vs <code>x = (w T B e)/(ħ c)</code>.
              This is the same sinc envelope as Fraunhofer diffraction from a rectangular aperture.
              <span class="tiny">Plot is dimensionless; no numerical material parameters are required.</span>
            </figcaption>
          </figure>
        </section>

        <section id="part4">
          <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

          <h3>Re-interpret the final formula: what each term controls</h3>
          <div class="kpi">
            <div class="box">
              <div class="num">J0</div>
              <div class="lbl">Sets the zero-field maximum current (geometry + j<sub>c</sub> + chosen phase bias).</div>
            </div>
            <div class="box">
              <div class="num">x = (e/(ħc)) B T w</div>
              <div class="lbl">A dimensionless phase-twist parameter proportional to enclosed flux through area w×T.</div>
            </div>
            <div class="box">
              <div class="num">sin(x)/x</div>
              <div class="lbl">Interference factor from integrating a linear phase ramp over a finite width (Fourier of a rectangle).</div>
            </div>
          </div>

          <h3>Parameter dependence (qualitative)</h3>
          <ul>
            <li><strong>Increase <code>B</code>:</strong> increases <code>x</code> → decreases <code>|J|</code> on average and creates oscillatory sign changes (lobes and nodes).</li>
            <li><strong>Increase width <code>w</code>:</strong> more phase spread across junction → more sensitive to field (zeros occur at smaller <code>B</code>).</li>
            <li><strong>Increase thickness <code>T</code>:</strong> larger effective flux area for in-plane field → stronger modulation (again smaller <code>B</code> for first node).</li>
            <li><strong>Change bias phase δ0:</strong> overall amplitude scales like <code>sin(δ0)</code>; the sinc dependence remains.</li>
          </ul>

          <details>
            <summary>Alternative derivation idea (brief but meaningful)</summary>
            <p class="muted">
              You can start from the gauge-invariant “superfluid momentum”:
              <code>p_s ∝ ∇φ − (2e/ħc)A</code>.
              In a static uniform field, symmetry implies a constant gradient of <code>δ</code> across the width.
              Then write the total current as the imaginary part of
              <code>∫ exp(i(δ0+ky)) dy</code>, which is the Fourier transform of a rectangular window, giving <code>sinc</code> immediately.
              This emphasizes the mathematical structure: <em>aperture integral → diffraction envelope</em>.
            </p>
          </details>

          <h3>Concept check (self-test with answers)</h3>
          <ul>
            <li><strong>Q:</strong> Why does a magnetic field change the Josephson current if the junction is static?
              <br><strong>A:</strong> It changes the <em>gauge-invariant phase</em> across the junction via the vector potential, creating spatial phase variation and interference.</li>
            <li><strong>Q:</strong> What geometric area sets the modulation for an in-plane field here?
              <br><strong>A:</strong> The rectangle spanned by junction thickness and width: <code>w×T</code>, so <code>Φ = B w T</code>.</li>
            <li><strong>Q:</strong> Why do zeros occur?
              <br><strong>A:</strong> When the phase twist across the width equals <code>nπ</code>, positive and negative contributions cancel exactly in the uniform model.</li>
            <li><strong>Q:</strong> What would nonuniform <code>j_c(y)</code> do?
              <br><strong>A:</strong> It changes the “aperture shape,” so the pattern becomes the Fourier transform of <code>j_c(y)</code> rather than a clean sinc.</li>
          </ul>
        </section>

        <section id="part5">
          <h2>PART 5 — Optional Plot Guide (PLOT EXISTS)</h2>
          <ul>
            <li><strong>What it shows:</strong> the normalized current <code>J/J0 = sin(x)/x</code> vs the dimensionless parameter <code>x</code>.</li>
            <li><strong>Axes:</strong> horizontal <code>x = (w T B e)/(ħ c)</code> (dimensionless); vertical <code>J/J0</code> (dimensionless).</li>
            <li><strong>Example values:</strong> none needed—this curve is universal once you nondimensionalize.</li>
            <li><strong>Features to notice:</strong> maximum at <code>x=0</code>, first zero at <code>x=π</code>, lobes with decreasing magnitude ~<code>1/x</code> envelope.</li>
          </ul>

          <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
        </section>

        <footer>
          <p class="tiny">
            Notes: This derivation captures the ideal “diffraction” (Fraunhofer-like) pattern under uniform <code>j_c</code> and negligible self-field.
            Real junctions may show shifted nodes, asymmetric lobes, or reduced contrast due to trapped flux, field focusing, and spatial nonuniformity.
          </p>
        </footer>
      </article>

      <aside class="card toc" aria-label="Table of contents">
        <h2>Contents</h2>
        <nav>
          <a href="#quick-summary">Quick Summary</a>
          <a href="#part0">PART 0 — Concept Primer</a>
          <a class="sub" href="#part0">Definitions &amp; laws</a>
          <a href="#part0b">PART 0B — Industry Perspective</a>
          <a href="#part1">PART 1 — Problem Analysis</a>
          <a href="#part2">PART 2 — Strategy &amp; Tips</a>
          <a href="#part3">PART 3 — Full Solution</a>
          <a class="sub" href="#final-answer-box">Final Answer</a>
          <a href="#part4">PART 4 — Deeper Understanding</a>
          <a href="#part5">PART 5 — Plot Guide</a>
          <a href="#top" class="sub">Back to top</a>
        </nav>

        <div style="margin-top:10px; border-top:1px solid var(--border); padding-top:10px;">
          <p class="tiny muted" style="margin:0 0 8px;">
            Copy helpers
          </p>
          <button class="btn" data-copy="#final-answer-text">Copy final answer</button>
          <button class="btn" data-copy="#eqtext-gauge" style="margin-top:8px;">Copy key equation</button>
        </div>
      </aside>
    </main>
  </div>

  <script>
    // Copy-to-clipboard buttons
    (function(){
      function setBtnState(btn, ok){
        btn.classList.remove('copyok','copybad');
        btn.classList.add(ok ? 'copyok' : 'copybad');
        const old = btn.textContent;
        btn.textContent = ok ? 'Copied!' : 'Copy failed';
        setTimeout(()=>{ btn.textContent = old; btn.classList.remove('copyok','copybad'); }, 900);
      }

      document.addEventListener('click', async (e) => {
        const btn = e.target.closest('[data-copy]');
        if(!btn) return;
        const sel = btn.getAttribute('data-copy');
        const el = document.querySelector(sel);
        if(!el){ setBtnState(btn, false); return; }
        const text = el.innerText.trim();
        try{
          await navigator.clipboard.writeText(text);
          setBtnState(btn, true);
        }catch(err){
          // Fallback
          try{
            const ta = document.createElement('textarea');
            ta.value = text;
            ta.style.position = 'fixed';
            ta.style.opacity = '0';
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            setBtnState(btn, true);
          }catch(e2){
            setBtnState(btn, false);
          }
        }
      });
    })();

    // Static canvas plot: y = sinc(x) = sin(x)/x
    (function(){
      const canvas = document.getElementById('plot');
      const ctx = canvas.getContext('2d');

      function draw(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const rect = canvas.getBoundingClientRect();
        const cssW = rect.width;
        const cssH = Math.max(280, Math.min(520, rect.width * 0.52));
        canvas.style.height = cssH + 'px';

        canvas.width = Math.round(cssW * dpr);
        canvas.height = Math.round(cssH * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        const W = cssW, H = cssH;
        const pad = {l:54, r:16, t:34, b:44};
        const pw = W - pad.l - pad.r;
        const ph = H - pad.t - pad.b;

        // Axes ranges
        const xmin = -8.0, xmax = 8.0;
        const ymin = -0.35, ymax = 1.10;

        function x2px(x){ return pad.l + (x - xmin) / (xmax - xmin) * pw; }
        function y2px(y){ return pad.t + (ymax - y) / (ymax - ymin) * ph; }

        // Background
        ctx.clearRect(0,0,W,H);
        ctx.fillStyle = 'rgba(0,0,0,0)';
        ctx.fillRect(0,0,W,H);

        // Grid
        ctx.lineWidth = 1;
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        ctx.fillStyle = 'rgba(255,255,255,0.75)';
        ctx.font = '12px ui-sans-serif, system-ui';

        const xticks = [-8,-6,-4,-2,0,2,4,6,8];
        const yticks = [-0.2,0.0,0.2,0.4,0.6,0.8,1.0];

        // Vertical grid + x labels
        xticks.forEach(x=>{
          const xp = x2px(x);
          ctx.beginPath();
          ctx.moveTo(xp, pad.t);
          ctx.lineTo(xp, pad.t + ph);
          ctx.stroke();
          ctx.fillStyle = 'rgba(255,255,255,0.70)';
          ctx.textAlign = 'center';
          ctx.textBaseline = 'top';
          ctx.fillText(String(x), xp, pad.t + ph + 8);
        });

        // Horizontal grid + y labels
        yticks.forEach(y=>{
          const yp = y2px(y);
          ctx.beginPath();
          ctx.moveTo(pad.l, yp);
          ctx.lineTo(pad.l + pw, yp);
          ctx.stroke();
          ctx.fillStyle = 'rgba(255,255,255,0.70)';
          ctx.textAlign = 'right';
          ctx.textBaseline = 'middle';
          ctx.fillText(y.toFixed(1), pad.l - 8, yp);
        });

        // Axes
        ctx.strokeStyle = 'rgba(255,255,255,0.35)';
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(pad.l, pad.t + ph);
        ctx.lineTo(pad.l + pw, pad.t + ph);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(pad.l, pad.t);
        ctx.lineTo(pad.l, pad.t + ph);
        ctx.stroke();

        // Axis labels + title
        ctx.fillStyle = 'rgba(255,255,255,0.92)';
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.font = '14px ui-sans-serif, system-ui';
        ctx.fillText('Normalized Josephson current:  J/J0 = sin(x)/x', pad.l, 10);

        ctx.font = '13px ui-sans-serif, system-ui';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'bottom';
        ctx.fillText('x = (w T B e)/(ħ c)  (dimensionless)', pad.l + pw/2, H - 10);

        ctx.save();
        ctx.translate(16, pad.t + ph/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        ctx.fillText('J / J0', 0, 0);
        ctx.restore();

        // Curve: sinc
        function sinc(x){
          if(Math.abs(x) < 1e-8) return 1.0;
          return Math.sin(x)/x;
        }

        ctx.strokeStyle = 'rgba(118,182,255,0.95)';
        ctx.lineWidth = 2.2;
        ctx.beginPath();
        const N = 900;
        for(let i=0;i<=N;i++){
          const x = xmin + (xmax-xmin)*i/N;
          const y = sinc(x);
          const xp = x2px(x);
          const yp = y2px(y);
          if(i===0) ctx.moveTo(xp, yp);
          else ctx.lineTo(xp, yp);
        }
        ctx.stroke();

        // Legend
        const lx = pad.l + 10, ly = pad.t + 10;
        ctx.fillStyle = 'rgba(0,0,0,0.25)';
        ctx.strokeStyle = 'rgba(255,255,255,0.14)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.roundRect(lx, ly, 160, 34, 10);
        ctx.fill();
        ctx.stroke();

        ctx.strokeStyle = 'rgba(118,182,255,0.95)';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(lx+12, ly+18);
        ctx.lineTo(lx+44, ly+18);
        ctx.stroke();

        ctx.fillStyle = 'rgba(255,255,255,0.88)';
        ctx.font = '12.5px ui-sans-serif, system-ui';
        ctx.textAlign = 'left';
        ctx.textBaseline = 'middle';
        ctx.fillText('sinc(x)', lx+54, ly+18);
      }

      // Polyfill for roundRect if needed
      if(!CanvasRenderingContext2D.prototype.roundRect){
        CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
          const rr = Math.min(r, w/2, h/2);
          this.beginPath();
          this.moveTo(x+rr, y);
          this.arcTo(x+w, y, x+w, y+h, rr);
          this.arcTo(x+w, y+h, x, y+h, rr);
          this.arcTo(x, y+h, x, y, rr);
          this.arcTo(x, y, x+w, y, rr);
          this.closePath();
          return this;
        }
      }

      window.addEventListener('resize', draw, {passive:true});
      draw();
    })();
  </script>
</body>
</html>
