<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Structure of a Vortex: Solving the London Equation in Cylindrical Symmetry</title>
  <style>
    :root{
      --bg:#0b0f16;
      --card:#111827;
      --card2:#0f172a;
      --text:#e5e7eb;
      --muted:#a7b0c0;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#86efac;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 10px 25px rgba(0,0,0,.35);
      --radius:16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 15% 5%, rgba(125,211,252,.12), transparent 60%),
                  radial-gradient(900px 600px at 80% 0%, rgba(167,139,250,.10), transparent 55%),
                  radial-gradient(900px 600px at 50% 95%, rgba(134,239,172,.08), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:28px 18px 18px;
      position:relative;
      overflow:hidden;
      border-bottom:1px solid var(--line);
    }
    header .wrap{
      max-width:1200px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.5fr 1fr;
      gap:18px;
      align-items:start;
    }
    @media (max-width: 980px){
      header .wrap{grid-template-columns:1fr}
    }
    .title{
      background: linear-gradient(90deg, var(--text), rgba(229,231,235,.75));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      font-size: clamp(1.35rem, 2.4vw, 2.1rem);
      margin:0 0 10px;
      letter-spacing:.2px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      max-width:70ch;
    }
    .meta{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:14px 14px;
      box-shadow: var(--shadow);
    }
    .meta h3{
      margin:0 0 8px;
      font-size:1rem;
      color:rgba(229,231,235,.95);
    }
    .meta ul{margin:0; padding-left:18px; color:var(--muted)}
    .layout{
      max-width:1200px;
      margin:0 auto;
      padding:18px;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:18px;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns:1fr}
    }
    nav#toc{
      position:sticky;
      top:12px;
      align-self:start;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:14px;
      box-shadow: var(--shadow);
    }
    @media (max-width: 980px){
      nav#toc{position:relative; top:auto}
    }
    #toc .toc-title{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    #toc h2{font-size:1rem; margin:0}
    #toc a{
      display:block;
      padding:6px 8px;
      border-radius:10px;
      color:rgba(229,231,235,.9);
    }
    #toc a:hover{background: rgba(125,211,252,.10); text-decoration:none}
    .pill{
      font-size:.78rem;
      color:rgba(229,231,235,.9);
      border:1px solid var(--line);
      padding:3px 8px;
      border-radius:999px;
      background: rgba(0,0,0,.18);
      white-space:nowrap;
    }
    main{
      display:grid;
      gap:16px;
    }
    section{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:18px;
      box-shadow: var(--shadow);
      transform: translateY(0);
      transition: transform .2s ease, border-color .2s ease;
    }
    section:hover{transform: translateY(-1px); border-color: rgba(125,211,252,.22)}
    h2{
      margin:0 0 8px;
      font-size:1.25rem;
      letter-spacing:.2px;
    }
    h3{
      margin:16px 0 8px;
      font-size:1.05rem;
      color:rgba(229,231,235,.96);
    }
    p{margin:8px 0; color:rgba(229,231,235,.92)}
    ul{margin:8px 0; padding-left:18px; color:rgba(229,231,235,.90)}
    li{margin:6px 0}
    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:14px}
    @media (max-width: 900px){.grid2{grid-template-columns:1fr}}
    .callout{
      border:1px solid var(--line);
      border-left:4px solid var(--accent);
      background: rgba(0,0,0,.18);
      padding:12px 12px;
      border-radius: 14px;
    }
    .callout strong{color:rgba(229,231,235,.98)}
    .callout.warn{border-left-color: var(--warn)}
    .callout.good{border-left-color: var(--good)}
    .callout.bad{border-left-color: var(--bad)}
    .math-insight{
      border-left:4px solid var(--accent2);
    }
    pre{
      margin:10px 0 8px;
      padding:12px;
      border-radius: 14px;
      background: rgba(0,0,0,.30);
      border:1px solid var(--line);
      overflow:auto;
    }
    code{font-family:var(--mono); font-size:.95rem; color:rgba(229,231,235,.96)}
    .eq-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-top:10px;
    }
    .btn{
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: rgba(229,231,235,.95);
      padding:8px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-size:.9rem;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{transform: translateY(-1px); background: rgba(125,211,252,.10); border-color: rgba(125,211,252,.25)}
    .btn:active{transform: translateY(0)}
    .muted{color:var(--muted)}
    details{
      border:1px solid var(--line);
      border-radius: 14px;
      padding:10px 12px;
      background: rgba(0,0,0,.16);
      margin:10px 0;
    }
    summary{
      cursor:pointer;
      color: rgba(229,231,235,.95);
      font-weight:600;
    }
    figure{
      margin:12px 0 0;
      padding:12px;
      border-radius: 14px;
      background: rgba(0,0,0,.20);
      border:1px solid var(--line);
    }
    figcaption{color:var(--muted); font-size:.92rem; margin-top:8px}
    canvas{width:100%; height:auto; display:block; border-radius:12px}
    .final-box{
      border:1px solid rgba(125,211,252,.35);
      background: linear-gradient(180deg, rgba(125,211,252,.12), rgba(0,0,0,.18));
      border-radius: 16px;
      padding:12px;
    }
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:10px;
      padding:8px 10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: rgba(229,231,235,.92);
    }
    .backtop:hover{background: rgba(125,211,252,.10); text-decoration:none}
    footer{
      max-width:1200px;
      margin:0 auto;
      padding:10px 18px 28px;
      color:var(--muted);
    }
    .hr{height:1px; background: var(--line); margin:12px 0}
    .tiny{font-size:.9rem}
    .kpi{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    @media (max-width: 900px){.kpi{grid-template-columns:1fr}}
    .kpi .card{
      border:1px solid var(--line);
      background: rgba(0,0,0,.18);
      padding:10px 12px;
      border-radius: 14px;
    }
    .kpi .label{color:var(--muted); font-size:.86rem}
    .kpi .value{font-weight:700; margin-top:4px}
    @media print{
      body{background:#fff; color:#000}
      header, nav#toc{display:none}
      section{box-shadow:none; border:1px solid #ddd; background:#fff}
      a{color:#000; text-decoration:underline}
      pre{background:#f6f6f6; border:1px solid #ddd}
      .btn{display:none}
      .backtop{display:none}
      .callout{background:#f8f8ff}
      .pagebreak{break-before: page}
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap">
      <div>
        <h1 class="title">Structure of a Vortex: London Equation with Cylindrical Symmetry</h1>
        <p class="subtitle">
          We solve the London equation for the magnetic field outside a line-like vortex core, enforce flux quantization,
          and extract the small- and large-radius asymptotics. Along the way we treat the PDE as a precise mathematical object
          (a screened Helmholtz operator) and connect the result to engineering use-cases like vortex pinning and superconducting magnet design.
        </p>
        <div class="kpi">
          <div class="card">
            <div class="label">Governing operator</div>
            <div class="value">(1 âˆ’ Î»Â²âˆ‡Â²)B = 0 (outside core)</div>
          </div>
          <div class="card">
            <div class="label">Key special function</div>
            <div class="value">Modified Bessel Kâ‚€(Ï/Î»)</div>
          </div>
          <div class="card">
            <div class="label">Physical constraint</div>
            <div class="value">Total flux = Î¦â‚€</div>
          </div>
        </div>
      </div>
      <aside class="meta" aria-label="Quick Summary">
        <h3>Quick Summary</h3>
        <ul>
          <li><strong>What:</strong> Find the cylindrically symmetric vortex-field solution of the London equation outside a line core.</li>
          <li><strong>Key physics idea:</strong> Superconductors â€œscreenâ€ magnetic fields over the penetration depth <span class="pill">Î»</span> (Meissner effect).</li>
          <li><strong>Governing equation:</strong> <span class="pill">B âˆ’ Î»Â²âˆ‡Â²B = 0</span> for Ï &gt; Î¾ (outside the normal core of radius Î¾).</li>
          <li><strong>Symmetry:</strong> Straight vortex line â‡’ field along the vortex axis: <span class="pill">B = B_z(Ï) áº‘</span>.</li>
          <li><strong>Flux quantization:</strong> <span class="pill">2Ï€âˆ«â‚€^âˆ Ï dÏ B(Ï) = Î¦â‚€</span>.</li>
          <li><strong>Main result:</strong> <span class="pill">B(Ï) = (Î¦â‚€ / 2Ï€Î»Â²) Kâ‚€(Ï/Î»)</span> (singular at Ïâ†’0, decays for Ïâ†’âˆ).</li>
          <li><strong>Asymptotics:</strong> For Î¾ â‰ª Ï â‰ª Î», <span class="pill">B(Ï) ~ (Î¦â‚€/2Ï€Î»Â²) ln(Î»/Ï)</span>; for Ï â‰« Î», <span class="pill">B(Ï) ~ (Î¦â‚€/2Ï€Î»Â²) âˆš(Ï€Î»/2Ï) e^{-Ï/Î»}</span>.</li>
          <li><strong>Meaning:</strong> The vortex field is strongly peaked near the core and exponentially screened beyond Î».</li>
        </ul>
      </aside>
    </div>
  </header>

  <div class="layout">
    <nav id="toc" aria-label="Table of Contents">
      <div class="toc-title">
        <h2 style="margin:0;">Contents</h2>
        <span class="pill">sticky</span>
      </div>
      <a href="#part0">PART 0 â€” Concept Primer</a>
      <a href="#part0b">PART 0B â€” Industry &amp; Applied Physics</a>
      <a href="#part1">PART 1 â€” Problem Analysis</a>
      <a href="#part2">PART 2 â€” Strategy &amp; Tips</a>
      <a href="#part3">PART 3 â€” Full Solution</a>
      <a href="#part4">PART 4 â€” Deeper Understanding</a>
      <a href="#part5">PART 5 â€” Optional Plot Guide</a>
      <div class="hr"></div>
      <a class="backtop" href="#top" title="Back to top">â†‘ Back to top</a>
    </nav>

    <main>
      <section id="part0">
        <article>
          <h2>PART 0 â€” Concept Primer (Theory Before Solving)</h2>

          <h3>0.1 Core definitions (symbols &amp; SI units)</h3>
          <ul>
            <li><strong>Ï</strong> â€” cylindrical radial coordinate from vortex axis (m)</li>
            <li><strong>Ï†</strong> â€” azimuthal angle (rad), <strong>z</strong> â€” axis along vortex line (m)</li>
            <li><strong>B(Ï)</strong> â€” magnetic flux density (Tesla, T). Here it points along <strong>áº‘</strong>.</li>
            <li><strong>Î»</strong> â€” London penetration depth (m): characteristic screening length of magnetic fields in a superconductor.</li>
            <li><strong>Î¾</strong> â€” coherence length (m): scale of the normal (non-superconducting) vortex core; London theory is valid only for Ï â‰³ Î¾.</li>
            <li><strong>Î¦â‚€</strong> â€” flux quantum (Weber, Wb): total flux carried by one vortex.</li>
          </ul>

          <h3>0.2 Physical meaning and intuition</h3>
          <p>
            In a type-II superconductor, magnetic field can penetrate as quantized vortices. Each vortex is a thin â€œtubeâ€ of magnetic flux:
            near the center the material is effectively normal (core radius ~ Î¾), while outside the core superconducting currents circulate and
            screen the field so it decays over Î». London theory captures that screening outside the core.
          </p>

          <div class="callout">
            <strong>Validity conditions (London model):</strong>
            <ul>
              <li>Applies in the superconducting region outside the core: <strong>Ï &gt; Î¾</strong>.</li>
              <li>Linear response: supercurrent proportional to vector potential (London relation).</li>
              <li>Static/steady field (no time dependence here).</li>
              <li>Homogeneous isotropic Î» (no anisotropy, no strong spatial variations except at core).</li>
            </ul>
          </div>

          <h3>0.3 Key laws/principles (whatâ€™s behind the London equation)</h3>
          <p>
            The London equation can be written (in one common form) as a relation between current density and vector potential, which combined
            with Maxwellâ€™s equations yields a <em>screened</em> field equation. For the magnetic field in a uniform superconductor one obtains
            a linear PDE of the form:
          </p>

          <div class="eq-header">
            <strong class="muted">Key equation (outside sources/core)</strong>
            <button class="btn" data-copy="eq-london">Copy equation</button>
          </div>
          <pre id="eq-london"><code>(1 âˆ’ Î»^2 âˆ‡^2) B = 0   (for Ï &gt; Î¾)</code></pre>

          <p>
            Mathematically this is a <strong>screened Helmholtz equation</strong> (also called a <strong>modified Helmholtz</strong> equation)
            for the field amplitude.
          </p>

          <div class="callout math-insight">
            <strong>Math Insight:</strong>
            <p class="tiny">
              The operator <code>(1 âˆ’ Î»^2 âˆ‡^2)</code> is an elliptic, linear, self-adjoint operator (with suitable boundary conditions).
              It is the same operator that appears in â€œdiffusion with absorptionâ€ and â€œYukawa screeningâ€ problems.
              Its Greenâ€™s function in 2D involves <code>Kâ‚€</code>, which is why vortices naturally produce modified Bessel functions.
            </p>
          </div>

          <h3>0.4 Common models/approximations used here</h3>
          <ul>
            <li><strong>Line-vortex approximation:</strong> long straight vortex â‡’ fields depend only on Ï, not Ï† or z.</li>
            <li><strong>Outside-core London approximation:</strong> replace complicated core physics by a boundary/normalization condition (flux quantization).</li>
            <li><strong>Far-field decay:</strong> choose the solution that vanishes as Ï â†’ âˆ (finite energy / physical screening).</li>
          </ul>

          <h3>0.5 Mini intuition examples (minimal algebra)</h3>
          <ul>
            <li><strong>No screening (Î» â†’ âˆ):</strong> the equation becomes âˆ‡Â²B = 0, and in 2D a â€œline sourceâ€ gives logarithmic behaviorâ€”this foreshadows the near-core <code>ln(Î»/Ï)</code> form.</li>
            <li><strong>Strong screening (small Î»):</strong> the field is confined near the vortex and decays rapidlyâ€”this is the Ï â‰« Î» exponential tail.</li>
          </ul>

          <h3>0.6 What to watch for (pitfalls)</h3>
          <ul>
            <li><strong>London equation is not valid at Ï â†’ 0</strong>: the core physics matters; singularity signals a missing source term or cutoff at Î¾.</li>
            <li><strong>Use the correct Laplacian in cylindrical coordinates</strong>; for B = B(Ï) only, it reduces to <code>(1/Ï) d/dÏ (Ï dB/dÏ)</code>.</li>
            <li><strong>Choose the correct Bessel solution:</strong> <code>Iâ‚€</code> grows exponentially at infinity (unphysical); <code>Kâ‚€</code> decays.</li>
            <li><strong>Flux normalization</strong> fixes the amplitude; without it, you only get the shape.</li>
          </ul>

          <a class="backtop" href="#top">â†‘ Back to top</a>
        </article>
      </section>

      <section id="part0b">
        <article>
          <h2>PART 0B â€” Industry &amp; Applied Physics Perspective</h2>

          <h3>Where this appears in industry (concrete areas)</h3>
          <ul>
            <li><strong>Superconducting magnets</strong> (MRI, NMR, accelerator magnets): vortex motion causes dissipation (â€œflux flowâ€), limiting stability and quench margins.</li>
            <li><strong>Superconducting power devices</strong> (fault-current limiters, cables): vortex dynamics governs AC losses and efficiency under alternating fields.</li>
            <li><strong>Quantum sensing</strong> (SQUIDs, superconducting qubits &amp; resonators): stray vortex fields produce noise and frequency shifts; device layouts often avoid trapping vortices.</li>
            <li><strong>Superconducting thin films</strong> in RF/microwave systems: field penetration profiles matter for surface impedance and resonator Q.</li>
          </ul>

          <h3>Why engineers care</h3>
          <ul>
            <li><strong>Performance:</strong> the field profile sets current density distribution and local heating risk.</li>
            <li><strong>Reliability &amp; safety:</strong> vortex motion can trigger thermal runaway (quench) in magnets.</li>
            <li><strong>Cost/efficiency:</strong> reducing vortex losses improves efficiency and can relax cooling requirements.</li>
            <li><strong>Manufacturability:</strong> pinning landscapes (defects) must be engineered within realistic tolerances.</li>
          </ul>

          <h3>How itâ€™s measured/validated in practice</h3>
          <ul>
            <li><strong>Magneto-optical imaging</strong> and <strong>scanning Hall probes</strong>: map B(Ï) near surfaces.</li>
            <li><strong>Scanning SQUID microscopy</strong>: extremely sensitive imaging of vortex fields.</li>
            <li><strong>Transport + AC loss measurements</strong>: infer effective Î», pinning strength, and vortex mobility.</li>
          </ul>

          <h3>Design trade-offs and non-idealities</h3>
          <ul>
            <li><strong>Anisotropic materials</strong> (layered superconductors) â‡’ direction-dependent Î» and distorted profiles.</li>
            <li><strong>Finite thickness / edges</strong> â‡’ demagnetizing effects; simple cylindrical symmetry breaks near boundaries.</li>
            <li><strong>Defects</strong> pin vortices (good for DC stability) but can raise microwave losses (bad for RF devices).</li>
          </ul>

          <div class="callout">
            <strong>From lab to product:</strong>
            <p class="tiny">
              The ideal London solution is often used as a building block. In real designs, engineers modify it by including
              finite geometry (thin films), anisotropy (tensor Î»), multiple vortices (superposition in linear regimes),
              and a core cutoff at Î¾. The <em>shape</em> remains Bessel-like, while boundaries and material complexity alter amplitudes and effective length scales.
            </p>
          </div>

          <a class="backtop" href="#top">â†‘ Back to top</a>
        </article>
      </section>

      <section id="part1">
        <article>
          <h2>PART 1 â€” Problem Analysis (No Solving Yet)</h2>

          <h3>1.1 Restate the problem (in plain words)</h3>
          <p>
            We want a cylindrically symmetric magnetic-field solution of the London equation outside a line vortex core.
            The field should be singular at the origin (reflecting a vortex line) and must carry total flux equal to one flux quantum Î¦â‚€:
          </p>

          <div class="eq-header">
            <strong class="muted">Flux constraint</strong>
            <button class="btn" data-copy="eq-flux">Copy equation</button>
          </div>
          <pre id="eq-flux"><code>2Ï€ âˆ«_0^âˆ Ï dÏ B(Ï) = Î¦_0</code></pre>

          <p>
            Then we must show two asymptotic limits for B(Ï): a logarithmic form for intermediate radii (Î¾ â‰ª Ï â‰ª Î»),
            and an exponentially decaying form for large radii (Ï â‰« Î»).
          </p>

          <h3>1.2 Given quantities, unknowns, and tasks</h3>
          <div class="grid2">
            <div class="callout">
              <strong>Given</strong>
              <ul>
                <li>London equation: <code>B âˆ’ Î»^2 âˆ‡^2 B = 0</code> for Ï &gt; Î¾</li>
                <li>Cylindrical symmetry, outside a line core</li>
                <li>Total flux condition: <code>2Ï€âˆ« Ï dÏ B = Î¦â‚€</code></li>
                <li>Core radius Î¾ where London equation is not valid</li>
              </ul>
            </div>
            <div class="callout good">
              <strong>Unknowns / Must find</strong>
              <ul>
                <li>The functional form <code>B(Ï)</code> satisfying the PDE and boundary behavior</li>
                <li>Amplitude fixed by the flux constraint</li>
                <li>Asymptotic limits for Î¾ â‰ª Ï â‰ª Î» and Ï â‰« Î»</li>
              </ul>
            </div>
          </div>

          <h3>1.3 Relevant principles and why they apply</h3>
          <ul>
            <li><strong>Symmetry reduction:</strong> cylindrical symmetry removes Ï† and z dependence, converting a PDE into an ODE in Ï.</li>
            <li><strong>Linearity:</strong> the London equation is linear, so we can use standard ODE methods and special functions.</li>
            <li><strong>Boundary condition at infinity:</strong> physical screening requires <code>B(Ï) â†’ 0</code> as Ï â†’ âˆ.</li>
            <li><strong>Flux quantization as normalization:</strong> since the PDE is homogeneous, a global constraint fixes the amplitude.</li>
          </ul>

          <h3>1.4 Assumptions (explicit)</h3>
          <div class="callout warn">
            <strong>Assumptions used</strong>
            <ul>
              <li>Infinite straight vortex line along z; fields depend only on Ï.</li>
              <li>Isotropic, homogeneous Î» (constant penetration depth).</li>
              <li>Static situation (no time dependence).</li>
              <li>London model applies only for Ï &gt; Î¾; the origin singularity is a mathematical stand-in for the core.</li>
            </ul>
          </div>

          <h3>1.5 Possible solution approaches (compare 2â€“3)</h3>
          <ul>
            <li><strong>Approach A: Direct ODE in cylindrical coordinates (best here).</strong>
              Reduce to an ODE and recognize the modified Bessel equation; impose decay at infinity; normalize by flux.</li>
            <li><strong>Approach B: Greenâ€™s function of (1 âˆ’ Î»Â²âˆ‡Â²) in 2D.</strong>
              Treat the vortex as a delta-function source; the Greenâ€™s function is proportional to Kâ‚€. Elegant, but needs distribution theory.</li>
            <li><strong>Approach C: Fourier transform in the transverse plane.</strong>
              Transform gives algebraic solution in k-space; inverse transform yields Kâ‚€. Powerful for general geometries, but heavier for pure symmetry.</li>
          </ul>

          <p><strong>Chosen approach:</strong> Approach A (direct ODE) because it is the most transparent for teaching,
            uses only symmetry and standard ODE reasoning, and makes the asymptotics straightforward.</p>

          <a class="backtop" href="#top">â†‘ Back to top</a>
        </article>
      </section>

      <section id="part2">
        <article>
          <h2>PART 2 â€” Strategy &amp; Tips (Roadmap Only)</h2>

          <ol>
            <li><strong>Model the field:</strong> assume <code>B = B(Ï) áº‘</code> by cylindrical symmetry.</li>
            <li><strong>Write the Laplacian:</strong> for a scalar function of Ï only, use <code>âˆ‡Â²B = (1/Ï) d/dÏ (Ï dB/dÏ)</code>.</li>
            <li><strong>Reduce PDE â†’ ODE:</strong> insert into <code>B âˆ’ Î»Â²âˆ‡Â²B = 0</code> to get a radial ODE.</li>
            <li><strong>Nondimensionalize:</strong> set <code>x = Ï/Î»</code> to obtain a standard form.</li>
            <li><strong>Solve the ODE:</strong> recognize solutions as modified Bessel functions <code>Iâ‚€(x)</code> and <code>Kâ‚€(x)</code>.</li>
            <li><strong>Apply boundary at infinity:</strong> discard <code>Iâ‚€</code> because it grows exponentially; keep <code>Kâ‚€</code>.</li>
            <li><strong>Fix amplitude by flux:</strong> use <code>2Ï€âˆ« Ï dÏ B(Ï) = Î¦â‚€</code> and a known integral of <code>Kâ‚€</code>.</li>
            <li><strong>Extract asymptotics:</strong> use standard expansions of <code>Kâ‚€(x)</code> for x â‰ª 1 and x â‰« 1.</li>
            <li><strong>Interpret:</strong> log behavior near core (with cutoff Î¾) and exponential screening at large Ï.</li>
          </ol>

          <div class="callout bad">
            <strong>Common mistakes</strong>
            <ul>
              <li>Using the wrong Laplacian (forgetting the <code>(1/Ï)</code> factor).</li>
              <li>Keeping <code>Iâ‚€</code> and getting a field that blows up at infinity.</li>
              <li>Forgetting that the singularity at Ïâ†’0 is outside London validity; you must interpret it with a core cutoff Î¾.</li>
              <li>Messing up the flux integral: you need <code>2Ï€ Ï dÏ</code> (area element in polar coordinates).</li>
            </ul>
          </div>

          <a class="backtop" href="#top">â†‘ Back to top</a>
        </article>
      </section>

      <section id="part3" class="pagebreak">
        <article>
          <h2>PART 3 â€” Full Solution (Detailed + Teaching)</h2>

          <h3>3.1 Physical intuition (before calculation)</h3>
          <p>
            We expect the vortex to look like a concentrated â€œtubeâ€ of magnetic flux: large B near the core,
            then a decay over the characteristic screening length Î». Since the system is effectively two-dimensional
            in the cross-section, a <em>logarithmic</em> trend can appear at small radii (as in 2D Laplace/Poisson problems),
            but screening should ultimately enforce an <em>exponential tail</em> at large radii.
          </p>

          <h3>3.2 Mathematical model (variables, domain, coordinates, BCs)</h3>
          <div class="callout">
            <strong>Model specification</strong>
            <ul>
              <li><strong>Coordinates:</strong> cylindrical (Ï, Ï†, z), with vortex along z.</li>
              <li><strong>Unknown field:</strong> scalar amplitude <code>B(Ï)</code> such that <code>ğ(Ï)=B(Ï) áº‘</code>.</li>
              <li><strong>Domain:</strong> outside core: <code>Ï âˆˆ (Î¾, âˆ)</code>. (We may extend integrals to 0 with the understanding of a cutoff at Î¾.)</li>
              <li><strong>PDE:</strong> <code>(1 âˆ’ Î»^2 âˆ‡^2) B = 0</code> for Ï &gt; Î¾.</li>
              <li><strong>Boundary condition:</strong> <code>B(Ï) â†’ 0</code> as <code>Ï â†’ âˆ</code> (screening).</li>
              <li><strong>Global constraint:</strong> <code>2Ï€âˆ«_0^âˆ Ï dÏ B(Ï) = Î¦_0</code> (flux quantization).</li>
            </ul>
          </div>

          <h3>3.3 Reduce the PDE using cylindrical symmetry</h3>
          <p>
            Because <code>B</code> depends only on Ï, the Laplacian in cylindrical coordinates simplifies.
            For any scalar <code>f(Ï)</code> (independent of Ï† and z),
          </p>

          <div class="eq-header">
            <strong class="muted">Radial Laplacian for f(Ï)</strong>
            <button class="btn" data-copy="eq-lap">Copy equation</button>
          </div>
          <pre id="eq-lap"><code>âˆ‡^2 f(Ï) = (1/Ï) d/dÏ [ Ï df/dÏ ]</code></pre>

          <p>
            Apply this to <code>B(Ï)</code> and substitute into the London equation:
          </p>

          <pre><code>B(Ï) âˆ’ Î»^2 (1/Ï) d/dÏ [ Ï dB/dÏ ] = 0   (Ï &gt; Î¾)</code></pre>

          <p>
            Multiply through by Ï to remove the denominator (valid for Ï &gt; 0):
          </p>
          <pre><code>Ï B(Ï) âˆ’ Î»^2 d/dÏ [ Ï dB/dÏ ] = 0</code></pre>

          <p>
            Expand the derivative:
          </p>
          <pre><code>d/dÏ [ Ï dB/dÏ ] = Ï d^2B/dÏ^2 + dB/dÏ</code></pre>

          <p>
            Therefore the ODE becomes:
          </p>
          <pre><code>Ï B(Ï) âˆ’ Î»^2 [ Ï B''(Ï) + B'(Ï) ] = 0</code></pre>

          <p>
            Divide by Ï (again valid for Ï &gt; 0):
          </p>
          <pre><code>B(Ï) âˆ’ Î»^2 [ B''(Ï) + (1/Ï) B'(Ï) ] = 0</code></pre>

          <h3>3.4 Nondimensionalization (scaling argument)</h3>
          <p>
            Introduce a dimensionless radius <code>x = Ï/Î»</code>. This is natural because Î» is the only length scale
            in the differential operator outside the core.
          </p>
          <p>
            Derivatives transform as:
          </p>
          <pre><code>d/dÏ = (1/Î») d/dx
d^2/dÏ^2 = (1/Î»^2) d^2/dx^2</code></pre>

          <p>
            Substitute into the ODE:
          </p>
          <pre><code>B âˆ’ Î»^2 [ (1/Î»^2) B_xx + (1/Ï)(1/Î») B_x ] = 0</code></pre>
          <p>
            Since Ï = Î»x, we have (1/Ï)(1/Î») = 1/(Î»^2 x). Multiply out:
          </p>
          <pre><code>B âˆ’ [ B_xx + (1/x) B_x ] = 0</code></pre>

          <p>
            Rearranged:
          </p>
          <pre><code>B_xx + (1/x) B_x âˆ’ B = 0</code></pre>

          <p>
            This is the standard modified Bessel equation of order 0.
          </p>

          <h3>3.5 Solve the ODE (why Bessel functions appear)</h3>
          <p>
            The ODE
          </p>
          <pre><code>B_xx + (1/x) B_x âˆ’ B = 0</code></pre>
          <p>
            is linear and has two linearly independent solutions: <code>Iâ‚€(x)</code> and <code>Kâ‚€(x)</code>,
            the modified Bessel functions of the first and second kind (order 0). Therefore:
          </p>
          <pre><code>B(Ï) = A I_0(Ï/Î») + C K_0(Ï/Î»)</code></pre>

          <p>
            Apply the boundary condition at infinity. As x â†’ âˆ:
          </p>
          <ul>
            <li><code>Iâ‚€(x) ~ e^x / âˆš(2Ï€x)</code> (grows exponentially)</li>
            <li><code>Kâ‚€(x) ~ âˆš(Ï€/(2x)) e^{-x}</code> (decays exponentially)</li>
          </ul>

          <p>
            Physical screening requires <code>B(Ï) â†’ 0</code> as <code>Ï â†’ âˆ</code>, so we must set <code>A = 0</code>.
            Thus the physically acceptable solution outside the core is:
          </p>

          <div class="eq-header">
            <strong class="muted">Shape of the solution</strong>
            <button class="btn" data-copy="eq-shape">Copy equation</button>
          </div>
          <pre id="eq-shape"><code>B(Ï) = C K_0(Ï/Î»)</code></pre>

          <h3>3.6 Fix the constant C using flux quantization</h3>
          <p>
            Use the total flux condition:
          </p>
          <pre><code>Î¦ = 2Ï€ âˆ«_0^âˆ Ï dÏ B(Ï) = Î¦_0</code></pre>

          <p>
            Substitute <code>B(Ï) = C Kâ‚€(Ï/Î»)</code>:
          </p>
          <pre><code>Î¦ = 2Ï€ C âˆ«_0^âˆ Ï K_0(Ï/Î») dÏ</code></pre>

          <p>
            Change variables to <code>x = Ï/Î»</code> (so Ï = Î»x, dÏ = Î» dx):
          </p>
          <pre><code>âˆ«_0^âˆ Ï K_0(Ï/Î») dÏ
= âˆ«_0^âˆ (Î»x) K_0(x) (Î» dx)
= Î»^2 âˆ«_0^âˆ x K_0(x) dx</code></pre>

          <p>
            A standard definite integral is:
          </p>
          <pre><code>âˆ«_0^âˆ x K_0(x) dx = 1</code></pre>

          <p>
            Therefore:
          </p>
          <pre><code>Î¦ = 2Ï€ C Î»^2</code></pre>

          <p>
            Set Î¦ = Î¦â‚€ to fix C:
          </p>
          <pre><code>C = Î¦_0 / (2Ï€ Î»^2)</code></pre>

          <div class="final-box">
            <div class="eq-header">
              <strong>Final result (field profile outside the core)</strong>
              <button class="btn" data-copy="final-answer">Copy final answer</button>
            </div>
            <pre id="final-answer"><code>B(Ï) = (Î¦_0 / (2Ï€ Î»^2)) K_0(Ï/Î»)   (Ï &gt; Î¾, cylindrical symmetry)</code></pre>
          </div>

          <h3>3.7 Show the required asymptotic limits</h3>

          <h4 style="margin:12px 0 6px;">(i) Intermediate radii: Î¾ â‰ª Ï â‰ª Î»</h4>
          <p>
            Here <code>x = Ï/Î» â‰ª 1</code>. The small-argument expansion of <code>Kâ‚€(x)</code> is:
          </p>
          <pre><code>K_0(x) = âˆ’ln(x/2) âˆ’ Î³ + O(x^2)   (x â‰ª 1)</code></pre>

          <p>
            Insert <code>x = Ï/Î»</code>:
          </p>
          <pre><code>K_0(Ï/Î») = âˆ’ln( (Ï/Î»)/2 ) âˆ’ Î³ + O((Ï/Î»)^2)
          = ln(2Î»/Ï) âˆ’ Î³ + O((Ï/Î»)^2)</code></pre>

          <p>
            Thus
          </p>
          <pre><code>B(Ï) = (Î¦_0 / (2Ï€ Î»^2)) [ ln(2Î»/Ï) âˆ’ Î³ + O((Ï/Î»)^2) ]</code></pre>

          <p>
            In many physics texts the additive constant <code>ln 2 âˆ’ Î³</code> is not emphasized because London theory is not valid
            below the core radius Î¾ anyway. Over the practical intermediate range <code>Î¾ â‰ª Ï â‰ª Î»</code>, the dominant dependence is logarithmic:
          </p>

          <div class="callout good">
            <strong>Required intermediate limit (dominant term)</strong>
            <pre><code>B(Ï) ~ (Î¦_0 / (2Ï€ Î»^2)) ln(Î»/Ï)     (Î¾ â‰ª Ï â‰ª Î»)</code></pre>
            <p class="tiny muted">
              The cutoff at Î¾ prevents taking Ï â†’ 0 literally; constants inside the log are effectively absorbed into core physics.
            </p>
          </div>

          <h4 style="margin:12px 0 6px;">(ii) Large radii: Ï â‰« Î»</h4>
          <p>
            Here <code>x = Ï/Î» â‰« 1</code>. The large-argument asymptotic of <code>Kâ‚€(x)</code> is:
          </p>
          <pre><code>K_0(x) ~ âˆš(Ï€/(2x)) e^(âˆ’x)   (x â‰« 1)</code></pre>

          <p>
            Substitute <code>x = Ï/Î»</code>:
          </p>
          <pre><code>K_0(Ï/Î») ~ âˆš(Ï€ / (2(Ï/Î»))) e^(âˆ’Ï/Î»)
        = âˆš( (Ï€Î») / (2Ï) ) e^(âˆ’Ï/Î»)</code></pre>

          <p>
            Therefore:
          </p>

          <div class="callout good">
            <strong>Required far-field limit</strong>
            <pre><code>B(Ï) ~ (Î¦_0 / (2Ï€ Î»^2)) âˆš( (Ï€Î») / (2Ï) ) exp(âˆ’Ï/Î»)     (Ï â‰« Î»)</code></pre>
          </div>

          <h3>3.8 Sanity checks</h3>
          <div class="grid2">
            <div class="callout">
              <strong>Dimensional analysis</strong>
              <ul>
                <li><code>Î¦â‚€</code> has units Wb = TÂ·mÂ².</li>
                <li><code>Î»Â²</code> has units mÂ².</li>
                <li>So <code>Î¦â‚€/(Î»Â²)</code> has units T, and <code>Kâ‚€</code> is dimensionless â‡’ <code>B</code> has units T. âœ…</li>
              </ul>
            </div>
            <div class="callout">
              <strong>Limiting behavior</strong>
              <ul>
                <li>Ï â†’ âˆ â‡’ <code>Kâ‚€(Ï/Î»)</code> decays â‡’ <code>B â†’ 0</code>. âœ…</li>
                <li>Ï â†’ 0 â‡’ <code>Kâ‚€</code> diverges logarithmically; interpreted with cutoff Î¾. âœ…</li>
                <li>Total flux integral gives exactly Î¦â‚€ by construction. âœ…</li>
              </ul>
            </div>
          </div>

          <details>
            <summary>Optional deeper note: why the â€œsingularityâ€ is expected</summary>
            <p class="tiny">
              A strictly homogeneous equation <code>(1 âˆ’ Î»Â²âˆ‡Â²)B = 0</code> cannot, by itself, create a nonzero flux without boundary/topological input.
              The vortex core effectively behaves like a source. A more distribution-aware statement often used is:
            </p>
            <pre><code>(1 âˆ’ Î»^2 âˆ‡^2) B = Î¦_0 Î´^(2)(ğ«âŠ¥)</code></pre>
            <p class="tiny">
              whose Greenâ€™s function in 2D is proportional to <code>Kâ‚€(Ï/Î»)</code>. In the present problem, the source is encoded indirectly via
              the flux constraint and the understanding that London theory excludes the core (Ï &lt; Î¾).
            </p>
          </details>

          <a class="backtop" href="#top">â†‘ Back to top</a>
        </article>
      </section>

      <section id="part4">
        <article>
          <h2>PART 4 â€” Deeper Understanding (Theory Around the Result)</h2>

          <h3>4.1 Re-interpret the final formula</h3>
          <p>
            The result
          </p>
          <pre><code>B(Ï) = (Î¦_0 / (2Ï€ Î»^2)) K_0(Ï/Î»)</code></pre>
          <p>
            separates into a <strong>scale</strong> and a <strong>shape</strong>:
          </p>
          <ul>
            <li><strong>Scale:</strong> <code>Î¦â‚€/(2Ï€Î»Â²)</code> sets the characteristic magnitude of the vortex field near the core (up to logarithms).</li>
            <li><strong>Shape:</strong> <code>Kâ‚€(Ï/Î»)</code> encodes logarithmic near-core structure and exponential screening far away.</li>
          </ul>

          <h3>4.2 Parameter dependence</h3>
          <ul>
            <li><strong>Increase Î»</strong> (weaker screening): the field extends farther (slower decay in Ï/Î»), but the overall scale <code>~1/Î»Â²</code> decreases.</li>
            <li><strong>Decrease Î»</strong> (stronger screening): field is more localized near the vortex, with a steeper exponential drop.</li>
            <li><strong>Core scale Î¾</strong> does not appear explicitly in the London solution, but it controls where you stop trusting the logarithmic divergence and how constants inside the log are set.</li>
          </ul>

          <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
          <p class="tiny">
            A Greenâ€™s-function derivation treats the vortex as a 2D delta-function source in the transverse plane:
            solve <code>(1 âˆ’ Î»Â²âˆ‡Â²)B = Î¦â‚€ Î´Â²(ğ«âŠ¥)</code>. Taking a 2D Fourier transform gives
            <code>B(k) = Î¦â‚€ / (1 + Î»Â²kÂ²)</code>. Inverting the transform yields <code>Kâ‚€(Ï/Î»)</code>.
            This method generalizes well to boundaries and multiple vortices (superposition in the linear regime).
          </p>

          <h3>4.4 Concept check (self-test Q&amp;A)</h3>
          <ul>
            <li><strong>Q:</strong> Why must we discard <code>Iâ‚€(Ï/Î»)</code>? <strong>A:</strong> It grows like <code>e^{Ï/Î»}</code> at infinity, violating screening and finite-energy expectations.</li>
            <li><strong>Q:</strong> Why is the near-core behavior logarithmic? <strong>A:</strong> In 2D, the Greenâ€™s function of Laplacian-type operators is logarithmic; for Ï â‰ª Î» the screening term is weak and the solution resembles the 2D unscreened behavior.</li>
            <li><strong>Q:</strong> What fixes the amplitude of B(Ï)? <strong>A:</strong> The homogeneous PDE leaves an overall constant; flux quantization <code>Î¦=Î¦â‚€</code> fixes it.</li>
            <li><strong>Q:</strong> What does Î» physically represent here? <strong>A:</strong> The length scale over which supercurrents screen magnetic fields; it sets the radial decay of the vortex field.</li>
          </ul>

          <a class="backtop" href="#top">â†‘ Back to top</a>
        </article>
      </section>

      <section id="part5">
        <article>
          <h2>PART 5 â€” Optional Plot Guide</h2>

          <p>
            A plot is useful here because it visually links the formula to its two hallmark behaviors:
            slow (log-like) variation at small <code>Ï/Î»</code> and rapid exponential decay at large <code>Ï/Î»</code>.
            The plot below shows a <strong>normalized</strong> field profile using the exact solution <code>Kâ‚€(Ï/Î»)</code>.
          </p>

          <figure aria-label="Static plot of normalized vortex field">
            <canvas id="plot" width="900" height="520"></canvas>
            <figcaption>
              <strong>Plot:</strong> Normalized vortex field shape vs. dimensionless radius.
              We plot <code>B(Ï) / B_ref</code> where <code>B_ref = (Î¦_0 / (2Ï€ Î»^2))</code>, so the curve is just <code>K_0(Ï/Î»)</code>.
              This is <em>shape-only</em> (symbolic result stays unchanged).
            </figcaption>
          </figure>

          <h3>How to read the plot</h3>
          <ul>
            <li><strong>x-axis:</strong> dimensionless radius <code>Ï/Î»</code> (unitless).</li>
            <li><strong>y-axis:</strong> normalized field <code>B / (Î¦â‚€/2Ï€Î»Â²) = Kâ‚€(Ï/Î»)</code> (unitless).</li>
            <li><strong>Example values:</strong> none needed; normalization removes Î¦â‚€ and Î» (the curve is universal in x).</li>
            <li><strong>Features to notice:</strong>
              <ul>
                <li>For small <code>Ï/Î»</code>, the curve is large and varies slowly (logarithmic divergence as Ïâ†’0, but physical cutoff at Î¾).</li>
                <li>For large <code>Ï/Î»</code>, the curve falls off rapidly (exponential tail).</li>
              </ul>
            </li>
          </ul>

          <a class="backtop" href="#top">â†‘ Back to top</a>
        </article>
      </section>
    </main>
  </div>

  <footer>
    <div class="hr"></div>
    <p class="tiny">
      Notes: This article uses a London-model solution valid outside the vortex core (Ï &gt; Î¾). Core physics (Ginzburgâ€“Landau)
      determines behavior inside Ï â‰² Î¾ and sets constant offsets in the near-core logarithm. The derived field profile is the standard
      screened-vortex solution used widely in superconductivity theory and engineering analyses.
    </p>
  </footer>

  <script>
    // Copy buttons for equation blocks / final answer (plain text).
    (function(){
      function copyTextFromElementId(id){
        const el = document.getElementById(id);
        if(!el) return;
        const text = el.innerText.replace(/\u00A0/g,' ');
        navigator.clipboard.writeText(text).then(()=>toast("Copied to clipboard")).catch(()=>toast("Copy failed"));
      }
      function toast(msg){
        let t = document.getElementById('toast');
        if(!t){
          t = document.createElement('div');
          t.id = 'toast';
          t.style.position='fixed';
          t.style.left='50%';
          t.style.bottom='18px';
          t.style.transform='translateX(-50%)';
          t.style.background='rgba(0,0,0,.75)';
          t.style.border='1px solid rgba(255,255,255,.15)';
          t.style.color='rgba(229,231,235,.95)';
          t.style.padding='10px 12px';
          t.style.borderRadius='999px';
          t.style.fontSize='.92rem';
          t.style.boxShadow='0 10px 22px rgba(0,0,0,.35)';
          t.style.opacity='0';
          t.style.transition='opacity .2s ease, transform .2s ease';
          t.style.zIndex='9999';
          document.body.appendChild(t);
        }
        t.textContent = msg;
        t.style.opacity='1';
        t.style.transform='translateX(-50%) translateY(-2px)';
        clearTimeout(window.__toastTimer);
        window.__toastTimer = setTimeout(()=>{
          t.style.opacity='0';
          t.style.transform='translateX(-50%) translateY(0)';
        }, 1300);
      }

      document.querySelectorAll('[data-copy]').forEach(btn=>{
        btn.addEventListener('click', ()=> copyTextFromElementId(btn.getAttribute('data-copy')));
      });
    })();

    // Static canvas plot: y = K0(x) for x in [0.1, 6] (avoid singular at 0).
    // We use accurate-enough approximations:
    // - For x <= 2: series approximation for I0 and K0 via standard rational/series (Numerical Recipes-style).
    // - For x > 2: asymptotic expansion.
    (function(){
      const canvas = document.getElementById('plot');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      function resizeAndDraw(){
        const dpr = window.devicePixelRatio || 1;
        const cssWidth = canvas.clientWidth;
        const cssHeight = Math.round(cssWidth * (520/900));
        canvas.style.height = cssHeight + "px";
        canvas.width = Math.floor(cssWidth * dpr);
        canvas.height = Math.floor(cssHeight * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
        draw(cssWidth, cssHeight);
      }

      // Approximations for modified Bessel functions I0 and K0 (order 0).
      // Source style: classic polynomial approximations used in many numerical libraries.
      function I0(x){
        const ax = Math.abs(x);
        if(ax < 3.75){
          const y = (x/3.75); const y2 = y*y;
          return 1.0 + y2*(3.5156229 + y2*(3.0899424 + y2*(1.2067492 + y2*(0.2659732 + y2*(0.0360768 + y2*0.0045813)))));
        } else {
          const y = 3.75/ax;
          return (Math.exp(ax)/Math.sqrt(ax))*(0.39894228 + y*(0.01328592 + y*(0.00225319 + y*(-0.00157565 + y*(0.00916281 + y*(-0.02057706 + y*(0.02635537 + y*(-0.01647633 + y*0.00392377))))))));
        }
      }
      function K0(x){
        const ax = Math.abs(x);
        if(ax <= 2.0){
          const y = (ax*ax)/4.0;
          // K0(x) ~ -ln(x/2) I0(x) + polynomial(y)
          const poly = -0.57721566 + y*(0.42278420 + y*(0.23069756 + y*(0.03488590 + y*(0.00262698 + y*(0.00010750 + y*0.00000740)))));
          return -Math.log(ax/2.0)*I0(ax) + poly;
        } else {
          const y = 2.0/ax;
          return (Math.exp(-ax)/Math.sqrt(ax))*(1.25331414 + y*(-0.07832358 + y*(0.02189568 + y*(-0.01062446 + y*(0.00587872 + y*(-0.00251540 + y*0.00053208))))));
        }
      }

      function draw(w,h){
        // Clear
        ctx.clearRect(0,0,w,h);

        // Plot area margins
        const m = {l:58, r:18, t:26, b:52};
        const pw = w - m.l - m.r;
        const ph = h - m.t - m.b;

        // Domain
        const xmin = 0.10, xmax = 6.0;
        // Range: determine ymax from K0(xmin), ymin near 0.
        const ymax = K0(xmin); // ~ large
        const ymin = 0.0;

        function xToPx(x){ return m.l + (x - xmin) / (xmax - xmin) * pw; }
        function yToPy(y){ return m.t + (1 - (y - ymin) / (ymax - ymin)) * ph; }

        // Background panel
        ctx.save();
        ctx.fillStyle = "rgba(0,0,0,0.18)";
        ctx.strokeStyle = "rgba(255,255,255,0.12)";
        roundRect(ctx, m.l, m.t, pw, ph, 12);
        ctx.fill();
        ctx.stroke();
        ctx.restore();

        // Gridlines
        ctx.save();
        ctx.strokeStyle = "rgba(255,255,255,0.10)";
        ctx.lineWidth = 1;
        // x ticks
        const xticks = [0,1,2,3,4,5,6];
        xticks.forEach(t=>{
          if(t < xmin || t > xmax) return;
          const px = xToPx(t);
          ctx.beginPath();
          ctx.moveTo(px, m.t);
          ctx.lineTo(px, m.t+ph);
          ctx.stroke();
        });
        // y ticks: choose 0..floor(ymax)
        const ytop = Math.floor(ymax);
        const yticks = [];
        for(let k=0; k<=ytop; k+=1){ yticks.push(k); }
        yticks.forEach(t=>{
          const py = yToPy(t);
          ctx.beginPath();
          ctx.moveTo(m.l, py);
          ctx.lineTo(m.l+pw, py);
          ctx.stroke();
        });
        ctx.restore();

        // Axes
        ctx.save();
        ctx.strokeStyle = "rgba(229,231,235,0.85)";
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(m.l, m.t+ph);
        ctx.lineTo(m.l+pw, m.t+ph);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(m.l, m.t);
        ctx.lineTo(m.l, m.t+ph);
        ctx.stroke();
        ctx.restore();

        // Labels
        ctx.save();
        ctx.fillStyle = "rgba(229,231,235,0.92)";
        ctx.font = "600 14px " + getComputedStyle(document.body).fontFamily;
        ctx.fillText("Normalized vortex field shape:  B/(Î¦â‚€/2Ï€Î»Â²) = Kâ‚€(Ï/Î»)", m.l, 18);
        ctx.font = "12px " + getComputedStyle(document.body).fontFamily;
        // x label
        ctx.fillStyle = "rgba(229,231,235,0.85)";
        ctx.fillText("Ï/Î» (dimensionless)", m.l + pw/2 - 58, m.t + ph + 40);
        // y label (rotated)
        ctx.save();
        ctx.translate(18, m.t + ph/2 + 30);
        ctx.rotate(-Math.PI/2);
        ctx.fillText("B / (Î¦â‚€/2Ï€Î»Â²) = Kâ‚€(Ï/Î»)", 0, 0);
        ctx.restore();
        ctx.restore();

        // Tick labels
        ctx.save();
        ctx.fillStyle = "rgba(229,231,235,0.80)";
        ctx.font = "12px " + getComputedStyle(document.body).fontFamily;
        xticks.forEach(t=>{
          if(t < xmin || t > xmax) return;
          const px = xToPx(t);
          ctx.fillText(String(t), px-4, m.t+ph+18);
          // tick mark
          ctx.strokeStyle="rgba(229,231,235,0.65)";
          ctx.beginPath(); ctx.moveTo(px, m.t+ph); ctx.lineTo(px, m.t+ph+6); ctx.stroke();
        });
        yticks.forEach(t=>{
          const py = yToPy(t);
          ctx.fillText(String(t), 24, py+4);
          ctx.strokeStyle="rgba(229,231,235,0.65)";
          ctx.beginPath(); ctx.moveTo(m.l-6, py); ctx.lineTo(m.l, py); ctx.stroke();
        });
        ctx.restore();

        // Curve
        ctx.save();
        ctx.strokeStyle = "rgba(125,211,252,0.95)";
        ctx.lineWidth = 2.2;
        ctx.beginPath();
        const n = 500;
        for(let i=0;i<=n;i++){
          const x = xmin + (xmax-xmin)*i/n;
          const y = K0(x);
          const px = xToPx(x);
          const py = yToPy(y);
          if(i===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);
        }
        ctx.stroke();
        ctx.restore();

        // Legend
        ctx.save();
        const lx = m.l + pw - 190, ly = m.t + 14;
        ctx.fillStyle = "rgba(0,0,0,0.30)";
        ctx.strokeStyle = "rgba(255,255,255,0.12)";
        roundRect(ctx, lx, ly, 172, 44, 10);
        ctx.fill(); ctx.stroke();
        ctx.strokeStyle = "rgba(125,211,252,0.95)";
        ctx.lineWidth = 2.2;
        ctx.beginPath(); ctx.moveTo(lx+12, ly+22); ctx.lineTo(lx+46, ly+22); ctx.stroke();
        ctx.fillStyle = "rgba(229,231,235,0.90)";
        ctx.font = "12px " + getComputedStyle(document.body).fontFamily;
        ctx.fillText("Kâ‚€(Ï/Î»)", lx+56, ly+26);
        ctx.restore();
      }

      function roundRect(ctx,x,y,w,h,r){
        const rr = Math.min(r, w/2, h/2);
        ctx.beginPath();
        ctx.moveTo(x+rr,y);
        ctx.arcTo(x+w,y,x+w,y+h,rr);
        ctx.arcTo(x+w,y+h,x,y+h,rr);
        ctx.arcTo(x,y+h,x,y,rr);
        ctx.arcTo(x,y,x+w,y,rr);
        ctx.closePath();
      }

      window.addEventListener('resize', ()=> {
        window.clearTimeout(window.__plotTimer);
        window.__plotTimer = window.setTimeout(resizeAndDraw, 90);
      });
      resizeAndDraw();
    })();
  </script>
</body>
</html>
