<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Magnetic Field Penetration in a Superconducting Plate (London Equation)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1620;
      --panel2:#111b27;
      --text:#e9eef6;
      --muted:#b7c3d6;
      --faint:#7f8fa6;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border:rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    html{scroll-behavior:smooth;}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 20% -10%, rgba(125,211,252,.15), transparent 60%),
                  radial-gradient(900px 700px at 90% 10%, rgba(167,139,250,.12), transparent 55%),
                  linear-gradient(180deg, var(--bg), #070a0e 70%);
      color:var(--text);
      line-height:1.55;
    }
    header{
      position:relative;
      padding:42px 18px 18px;
      max-width:1200px;
      margin:0 auto;
    }
    .hero{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius: calc(var(--radius) + 6px);
      box-shadow: var(--shadow);
      padding: 22px 20px;
      overflow:hidden;
    }
    .hero h1{
      margin:0 0 10px;
      font-size: clamp(1.45rem, 2.2vw + 1rem, 2.2rem);
      letter-spacing:.2px;
    }
    .hero p{margin:0; color:var(--muted); max-width:75ch;}
    .meta{
      display:flex; flex-wrap:wrap; gap:10px;
      margin-top:14px;
      color:var(--faint);
      font-size:.92rem;
    }
    .chip{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      border-radius:999px;
      padding:6px 10px;
    }

    main{
      max-width:1200px;
      margin:0 auto;
      padding: 0 18px 70px;
      display:grid;
      grid-template-columns: 300px 1fr;
      gap:18px;
      align-items:start;
    }

    nav#toc{
      position:sticky;
      top:14px;
      align-self:start;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:14px 14px 10px;
    }
    #toc h2{
      margin:0 0 10px;
      font-size:1.02rem;
      letter-spacing:.2px;
    }
    #toc a{
      display:block;
      padding:8px 10px;
      margin:4px 0;
      border-radius:12px;
      text-decoration:none;
      color:var(--muted);
      border:1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size:.95rem;
    }
    #toc a:hover{
      background: rgba(125,211,252,.08);
      border-color: rgba(125,211,252,.18);
      transform: translateY(-1px);
      color: var(--text);
    }
    #toc .mini{
      color:var(--faint);
      font-size:.85rem;
      margin-top:10px;
    }

    article{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 18px 10px;
      overflow:hidden;
    }

    section{padding: 8px 2px 16px;}
    section + section{
      border-top: 1px solid rgba(255,255,255,.08);
      padding-top:18px;
    }
    h2{
      margin: 8px 0 8px;
      font-size:1.35rem;
    }
    h3{
      margin: 12px 0 8px;
      font-size:1.12rem;
      color: var(--text);
    }
    p{margin: 8px 0; color: var(--muted);}
    ul{margin: 8px 0 8px 20px; color: var(--muted);}
    li{margin: 6px 0;}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
    }
    @media (max-width: 980px){
      main{grid-template-columns:1fr; }
      nav#toc{position:relative; top:auto;}
      .grid2{grid-template-columns:1fr;}
    }

    .callout{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      border-radius: var(--radius);
      padding: 12px 12px;
      margin: 10px 0;
    }
    .callout strong{color:var(--text);}
    .callout.assump{border-color: rgba(251,191,36,.28); background: rgba(251,191,36,.06);}
    .callout.keyeq{border-color: rgba(125,211,252,.30); background: rgba(125,211,252,.07);}
    .callout.mist{border-color: rgba(251,113,133,.28); background: rgba(251,113,133,.06);}
    .callout.final{border-color: rgba(52,211,153,.28); background: rgba(52,211,153,.06);}

    .eqbox{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      border-radius: 14px;
      padding: 12px 12px 10px;
      margin: 10px 0;
      position:relative;
      overflow:hidden;
    }
    .eq{
      font-family: var(--mono);
      color: #f3f6fb;
      white-space: pre-wrap;
      word-break: break-word;
      font-size: .97rem;
      line-height:1.45;
      margin:0;
    }
    .btnrow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    button.copy{
      appearance:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-size:.92rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.07);
      border-color: rgba(125,211,252,.25);
    }
    .toast{
      position: fixed;
      right: 14px;
      bottom: 14px;
      background: rgba(15,22,32,.92);
      border:1px solid rgba(255,255,255,.12);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      box-shadow: var(--shadow);
      opacity:0;
      transform: translateY(10px);
      transition: opacity .18s ease, transform .18s ease;
      pointer-events:none;
      font-size:.92rem;
      max-width: 320px;
    }
    .toast.show{opacity:1; transform: translateY(0);}

    figure{
      margin: 12px 0;
      border:1px solid var(--border);
      border-radius: var(--radius);
      background: rgba(255,255,255,.02);
      padding: 10px 10px 12px;
      overflow:hidden;
    }
    figcaption{color:var(--faint); font-size:.9rem; margin-top:8px;}
    canvas{width:100%; height:320px; display:block; border-radius: 14px; background: rgba(0,0,0,.18);}

    details{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
      border-radius: var(--radius);
      padding: 10px 12px;
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight:600;
    }
    .backtop{
      display:inline-block;
      margin-top: 10px;
      text-decoration:none;
      color: var(--accent);
      border:1px solid rgba(125,211,252,.25);
      padding:7px 10px;
      border-radius: 999px;
      transition: transform .12s ease, background .12s ease;
    }
    .backtop:hover{transform: translateY(-1px); background: rgba(125,211,252,.08);}

    footer{
      max-width:1200px;
      margin: 0 auto;
      padding: 0 18px 28px;
      color: var(--faint);
      font-size:.92rem;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000;}
      nav#toc{display:none;}
      header, main, footer{max-width: 100%; padding:0;}
      article{box-shadow:none; border:1px solid #bbb; background:#fff;}
      .callout, .eqbox, figure, details{break-inside: avoid;}
      section{page-break-inside: avoid;}
      a{color:#000; text-decoration:underline;}
      button.copy, .toast{display:none !important;}
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="hero">
      <h1>Magnetic Field Penetration in a Superconducting Plate</h1>
      <p>
        We solve the London “penetration equation” for a finite-thickness superconducting slab and then extract an
        effective magnetization profile in the thin-plate limit. The focus is both physical intuition and mathematical rigor,
        with notes on engineering relevance (shielding, magnet design, and superconducting components).
      </p>
      <div class="meta">
        <span class="chip">Topic: Superconductivity (London theory)</span>
        <span class="chip">Geometry: 1D slab, thickness δ</span>
        <span class="chip">Key scale: penetration depth λ</span>
        <span class="chip">Outputs: symbolic (plus one illustrative plot)</span>
      </div>
    </div>
  </header>

  <main>
    <nav id="toc" aria-label="Table of contents">
      <h2>Contents</h2>
      <a href="#quick-summary">Quick Summary</a>
      <a href="#part0">Part 0 — Concept Primer</a>
      <a href="#part0b">Part 0B — Industry & Applied Physics</a>
      <a href="#part1">Part 1 — Problem Analysis</a>
      <a href="#part2">Part 2 — Strategy & Tips</a>
      <a href="#part3">Part 3 — Full Solution</a>
      <a href="#part4">Part 4 — Deeper Understanding</a>
      <a href="#part5">Part 5 — Optional Plot Guide</a>
      <div class="mini">Tip: click any section to jump. Use the copy buttons for equations and final answers.</div>
    </nav>

    <article>
      <section id="quick-summary">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this is about:</strong> How a magnetic field penetrates a superconducting plate of finite thickness δ.</li>
          <li><strong>Key physics idea:</strong> In the London (local, linear) regime, magnetic fields are expelled but decay over the penetration depth λ.</li>
          <li><strong>Governing equation:</strong> <span style="font-family:var(--mono)">λ² ∇²B = B</span> (static London penetration equation).</li>
          <li><strong>Geometry simplification:</strong> Infinite slab in y–z, field parallel to surface, so <span style="font-family:var(--mono)">B = B(x)</span> only.</li>
          <li><strong>Main result (exact):</strong> <span style="font-family:var(--mono)">B(x) = Bₐ cosh(x/λ) / cosh(δ/(2λ))</span>.</li>
          <li><strong>Magnetization definition:</strong> In CGS, <span style="font-family:var(--mono)">B(x) − Bₐ = 4π M(x)</span> (effective, position-dependent).</li>
          <li><strong>Thin-plate limit:</strong> For <span style="font-family:var(--mono)">δ ≪ λ</span>, expand hyperbolic functions to get a quadratic profile in x.</li>
          <li><strong>Physical meaning:</strong> The interior field is slightly reduced; the “missing flux” is supported by screening currents near surfaces.</li>
        </ul>
        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="callout">
            <strong>Core definitions (symbols + SI units)</strong>
            <ul>
              <li><strong>λ</strong>: penetration depth (m). Characteristic length over which <em>B</em> decays inside a superconductor.</li>
              <li><strong>δ</strong>: plate thickness (m). Slab occupies <span style="font-family:var(--mono)">x ∈ [−δ/2, +δ/2]</span>.</li>
              <li><strong>B(x)</strong>: magnetic flux density (tesla, T in SI; gauss in CGS).</li>
              <li><strong>Bₐ</strong>: magnetic field outside the plate, parallel to its surface (T or G).</li>
              <li><strong>M(x)</strong>: effective magnetization (SI: A/m; CGS: emu/cm³). In CGS: <span style="font-family:var(--mono)">B = H + 4πM</span>.</li>
              <li><strong>∇²</strong>: Laplacian operator (1/m²). In 1D: <span style="font-family:var(--mono)">∇²B → d²B/dx²</span>.</li>
            </ul>
          </div>

          <div class="callout">
            <strong>Physical meaning & intuition</strong>
            <ul>
              <li>Perfect diamagnets would have <span style="font-family:var(--mono)">B = 0</span> inside. Real superconductors allow <em>partial</em> penetration over λ.</li>
              <li>The field profile is not arbitrary: screening supercurrents generate a spatial curvature in <em>B</em> set by λ.</li>
              <li>If the slab is <strong>thick</strong> (<span style="font-family:var(--mono)">δ ≫ λ</span>), the center is nearly field-free.</li>
              <li>If the slab is <strong>thin</strong> (<span style="font-family:var(--mono)">δ ≪ λ</span>), the field is almost uniform and close to <span style="font-family:var(--mono)">Bₐ</span>.</li>
            </ul>
          </div>
        </div>

        <div class="callout keyeq">
          <strong>Key law/principle (London model, static)</strong>
          <p>
            In the London (local, linear) regime for a homogeneous superconductor, the magnetic field satisfies:
          </p>
          <div class="eqbox">
            <pre class="eq" id="eq-london">λ² ∇²B = B</pre>
            <div class="btnrow">
              <button class="copy" data-copy-target="eq-london">Copy equation</button>
            </div>
          </div>
          <p>
            <strong>Validity conditions:</strong> static or low-frequency; fields below critical values (no vortex penetration in type-II unless specified);
            homogeneous isotropic λ; neglect edge effects (infinite slab in y–z).
          </p>
        </div>

        <h3>Common models/approximations and why they’re used</h3>
        <ul>
          <li><strong>1D reduction:</strong> symmetry + translational invariance reduce the PDE to an ODE.</li>
          <li><strong>Thin slab expansion (<span style="font-family:var(--mono)">δ/λ ≪ 1</span>):</strong> Taylor expand cosh to obtain simple polynomials useful for design estimates.</li>
          <li><strong>Linear response:</strong> magnetization proportional to applied field—important for small-signal engineering calculations.</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li><strong>Semi-infinite superconductor:</strong> if the surface is at x=0 and x&gt;0 is the superconductor, the solution is exponential: <span style="font-family:var(--mono)">B(x)=Bₐ e^(−x/λ)</span>.</li>
          <li><strong>Very thick slab:</strong> two exponentials from each surface overlap weakly; the center approaches <span style="font-family:var(--mono)">B(0) ≈ 2Bₐ e^(−δ/(2λ))</span> (tiny).</li>
          <li><strong>Very thin slab:</strong> curvature is small; B barely changes across thickness.</li>
        </ul>

        <div class="callout mist">
          <strong>What to watch for (pitfalls)</strong>
          <ul>
            <li>Confusing <strong>B</strong> and <strong>H</strong> (especially CGS vs SI). In CGS: <span style="font-family:var(--mono)">B = H + 4πM</span>; in SI: <span style="font-family:var(--mono)">B = μ₀(H + M)</span>.</li>
            <li>Sign conventions: magnetization for a superconductor is <em>diamagnetic</em> (opposes applied field).</li>
            <li>Boundary conditions: tangential <strong>H</strong> is continuous; for this slab-in-parallel-field idealization, using <span style="font-family:var(--mono)">B(±δ/2)=Bₐ</span> is standard and matches the provided result.</li>
            <li>Thin-film expansions must state what “small” means and what terms are kept (order bookkeeping).</li>
          </ul>
        </div>

        <details>
          <summary>Math Insight (interpret the core equation as a mathematical object)</summary>
          <p>
            The London equation <span style="font-family:var(--mono)">λ²∇²B = B</span> is a <strong>linear, homogeneous elliptic PDE</strong>.
            In 1D it becomes <span style="font-family:var(--mono)">B'' = (1/λ²)B</span>, whose solutions are hyperbolic functions.
            Mathematically, it says the field is an eigenfunction of the Laplacian with eigenvalue <span style="font-family:var(--mono)">1/λ²</span>.
            Physically, λ is the “screening length” that sets the curvature needed to bend B back toward zero in the bulk.
          </p>
        </details>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>
        <p>
          Superconducting magnetic screening is not just “textbook Meissner effect”—it directly impacts how devices meet field-uniformity specs,
          thermal margins, and manufacturability constraints.
        </p>

        <h3>Where this appears in industry (concrete applications)</h3>
        <ul>
          <li><strong>MRI/NMR magnets:</strong> superconducting structures and shields shape stray fields and protect nearby electronics.</li>
          <li><strong>Superconducting qubits & cryo-packaging:</strong> magnetic shielding (often multilayer) reduces decoherence; thin-film limits matter.</li>
          <li><strong>Power devices:</strong> superconducting cables, fault current limiters, and rotating machines: field penetration affects AC loss and stability.</li>
          <li><strong>Magnetically shielded enclosures:</strong> superconducting plates complement high-μ materials for ultra-low-field environments.</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><strong>Performance:</strong> residual internal fields can shift resonant frequencies, increase noise, or change inductance.</li>
          <li><strong>Reliability & safety:</strong> local field enhancements can push regions toward critical field/current, triggering quench.</li>
          <li><strong>Cost/weight:</strong> thickness δ competes with thermal conduction, mechanical robustness, and cryogenic load.</li>
          <li><strong>Manufacturability:</strong> thin films may be required (microfabrication), pushing designs into the <span style="font-family:var(--mono)">δ ≪ λ</span> regime.</li>
        </ul>

        <h3>Typical measurement/validation methods</h3>
        <ul>
          <li><strong>Hall probe / magnetometry scans</strong> near surfaces (maps field profiles and compares to London/finite-element models).</li>
          <li><strong>Muon spin rotation (μSR)</strong> and <strong>magneto-optical imaging</strong> (research/qualification for penetration and inhomogeneity).</li>
          <li><strong>Inductive methods</strong> (mutual inductance, resonators) to infer effective λ and screening in thin films.</li>
        </ul>

        <h3>Design trade-offs and constraints</h3>
        <ul>
          <li><strong>Non-idealities:</strong> anisotropic λ, finite mean free path, grain boundaries, surface roughness, and trapped flux alter profiles.</li>
          <li><strong>Edge effects:</strong> real plates are finite; currents crowd at edges—often requires 3D electromagnetic simulation.</li>
          <li><strong>Type-II vortices:</strong> above lower critical field, flux penetration occurs via vortices; London “Meissner-only” model needs modification.</li>
        </ul>

        <div class="callout">
          <strong>From lab to product</strong>
          <p>
            Engineers typically start with London-model closed forms (like this slab solution) to size thickness and estimate shielding.
            Then they add: anisotropy, multilayers, seams/holes, and critical-current constraints, and finally validate with field scans
            under realistic thermal and mechanical conditions.
          </p>
        </div>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <h3>Problem restatement (in plain words)</h3>
        <p>
          A superconducting plate (slab) of thickness δ is placed in a magnetic field parallel to its faces.
          The London penetration equation is <span style="font-family:var(--mono)">λ²∇²B = B</span>.
          With x measured perpendicular to the plate and x=0 at the center, we must:
        </p>
        <ul>
          <li><strong>(a)</strong> show the internal field profile is <span style="font-family:var(--mono)">B(x) = Bₐ cosh(x/λ) / cosh(δ/(2λ))</span>.</li>
          <li><strong>(b)</strong> define an effective magnetization by <span style="font-family:var(--mono)">B(x) − Bₐ = 4πM(x)</span> (CGS),
              and for <span style="font-family:var(--mono)">δ ≪ λ</span> show a thin-plate approximation for <span style="font-family:var(--mono)">M(x)</span>.</li>
        </ul>

        <div class="grid2">
          <div class="callout">
            <strong>Given</strong>
            <ul>
              <li>Penetration depth λ (material parameter).</li>
              <li>Plate thickness δ.</li>
              <li>External (applied) parallel field Bₐ.</li>
              <li>Coordinate: x ⟂ plate, x=0 at center, surfaces at x=±δ/2.</li>
            </ul>
          </div>
          <div class="callout">
            <strong>Unknowns / goals</strong>
            <ul>
              <li>Field profile B(x) inside the superconductor.</li>
              <li>Effective magnetization profile M(x) in the thin limit δ≪λ.</li>
              <li>Correct use of boundary conditions and asymptotic expansion.</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>London penetration equation:</strong> given directly; linear and time-independent, so superposition and standard ODE techniques apply.</li>
          <li><strong>Symmetry:</strong> slab is symmetric about x=0; thus B(x) must be even (no preferred sign of x).</li>
          <li><strong>Boundary matching:</strong> with field parallel to faces and idealized infinite slab, the internal field at the surface matches the external value used in the provided result.</li>
        </ul>

        <div class="callout assump">
          <strong>Assumptions (explicit)</strong>
          <ul>
            <li>Homogeneous isotropic superconductor with constant λ.</li>
            <li>Meissner state (no vortex penetration), linear response.</li>
            <li>Infinite extent in y and z; all variation only along x.</li>
            <li>Static field; no displacement current and no time dependence.</li>
            <li>Edge effects neglected (valid when lateral dimensions ≫ δ,λ).</li>
          </ul>
        </div>

        <h3>Possible approaches (compare 2–3)</h3>
        <ul>
          <li><strong>Direct ODE solution (best here):</strong> reduce to 1D and solve <span style="font-family:var(--mono)">B'' = B/λ²</span> with symmetry and boundary conditions. <em>Fast, exact.</em></li>
          <li><strong>Energy/variational viewpoint:</strong> minimize magnetic + kinetic energy functional leading to London equation; good for generalizations (anisotropy, multilayers) but heavier for this exercise.</li>
          <li><strong>Green’s function / eigenfunction expansion:</strong> useful for more complex geometries; overkill for constant-coefficient 1D slab.</li>
        </ul>
        <p><strong>Chosen:</strong> direct ODE solution + controlled thin-slab asymptotics.</p>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

        <ol style="color:var(--muted); margin-left:20px;">
          <li><strong>Model reduction:</strong> Use slab symmetry and invariance to set <span style="font-family:var(--mono)">B = B(x)</span> only.</li>
          <li><strong>Convert PDE→ODE:</strong> Replace <span style="font-family:var(--mono)">∇²</span> by <span style="font-family:var(--mono)">d²/dx²</span> to get <span style="font-family:var(--mono)">λ² B'' = B</span>.</li>
          <li><strong>Solve the ODE:</strong> Use constant-coefficient methods; expect exponentials or hyperbolic functions.</li>
          <li><strong>Apply symmetry:</strong> Evenness about x=0 eliminates the odd (sinh) part.</li>
          <li><strong>Apply boundary condition:</strong> Enforce <span style="font-family:var(--mono)">B(±δ/2)=Bₐ</span> to determine the remaining constant.</li>
          <li><strong>Define magnetization:</strong> In CGS use <span style="font-family:var(--mono)">4πM(x)=B(x)-Bₐ</span>.</li>
          <li><strong>Thin-slab expansion:</strong> For <span style="font-family:var(--mono)">δ≪λ</span>, expand cosh terms to second order in small parameters.</li>
          <li><strong>Sanity checks:</strong> verify dimensions, symmetry, boundary behavior, and limiting cases δ≫λ and δ≪λ.</li>
        </ol>

        <div class="callout mist">
          <strong>Common mistakes (quick tips)</strong>
          <ul>
            <li>Forgetting symmetry → keeping a spurious <span style="font-family:var(--mono)">sinh(x/λ)</span> term.</li>
            <li>Mixing up half-thickness δ/2 with thickness δ in boundary placement.</li>
            <li>Doing a thin-slab expansion but keeping inconsistent orders (e.g., keep x² terms but drop δ² terms).</li>
            <li>CGS vs SI conversion: replace <span style="font-family:var(--mono)">4π</span> by <span style="font-family:var(--mono)">μ₀</span> only in the constitutive relation, not inside the London equation itself.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation (before math)</h3>
        <p>
          Because of the Meissner effect, screening currents oppose the applied field. In a finite slab with a field parallel to its faces,
          the field cannot drop to zero instantly: it changes smoothly, with curvature set by λ. Symmetry implies the smallest field is at the
          center (x=0), and the largest is at the surfaces (x=±δ/2), matching the outside value.
        </p>

        <div class="callout keyeq">
          <strong>Mathematical model (variables, domain, boundary conditions)</strong>
          <ul>
            <li>Unknown scalar field: <span style="font-family:var(--mono)">B(x)</span> (magnitude of the magnetic flux density, parallel to slab faces).</li>
            <li>Domain: <span style="font-family:var(--mono)">x ∈ [−δ/2, +δ/2]</span>.</li>
            <li>Governing equation (1D London): <span style="font-family:var(--mono)">λ² d²B/dx² = B</span>.</li>
            <li>Symmetry: <span style="font-family:var(--mono)">B(x)=B(−x)</span> (even function).</li>
            <li>Boundary conditions: <span style="font-family:var(--mono)">B(±δ/2)=Bₐ</span>.</li>
          </ul>
        </div>

        <h3>(a) Solve the penetration equation in a slab</h3>

        <p>
          Start from the given PDE:
          <span style="font-family:var(--mono)">λ² ∇²B = B</span>.
          By translational invariance along y and z and the assumption that the field is parallel to the slab faces, the field varies only with x:
          <span style="font-family:var(--mono)">B = B(x)</span>.
          Therefore, the Laplacian reduces to a 1D second derivative:
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-ode">∇²B → d²B/dx²
⇒ λ² d²B/dx² = B</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-ode">Copy equation</button>
          </div>
        </div>

        <p>
          This is a linear constant-coefficient ODE. Rewrite it in standard form:
        </p>
        <div class="eqbox">
          <pre class="eq" id="eq-std">d²B/dx² = (1/λ²) B</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-std">Copy equation</button>
          </div>
        </div>

        <p>
          Solve via the characteristic equation. Try <span style="font-family:var(--mono)">B ∝ e^{kx}</span>. Substituting gives:
        </p>
        <div class="eqbox">
          <pre class="eq" id="eq-char">k² e^{kx} = (1/λ²) e^{kx}  ⇒  k² = 1/λ²  ⇒  k = ± 1/λ</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-char">Copy steps</button>
          </div>
        </div>

        <p>
          Hence the general solution is:
        </p>
        <div class="eqbox">
          <pre class="eq" id="eq-gen">B(x) = C₁ e^{x/λ} + C₂ e^{−x/λ}
= A cosh(x/λ) + D sinh(x/λ)</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-gen">Copy general solution</button>
          </div>
        </div>

        <p>
          <strong>Use symmetry:</strong> the slab and applied field are symmetric about x=0, so the physical solution must satisfy <span style="font-family:var(--mono)">B(x)=B(−x)</span>.
          Since <span style="font-family:var(--mono)">cosh</span> is even and <span style="font-family:var(--mono)">sinh</span> is odd, symmetry forces the odd term to vanish:
          <span style="font-family:var(--mono)">D = 0</span>.
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-even">B(x) = A cosh(x/λ)</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-even">Copy equation</button>
          </div>
        </div>

        <p>
          <strong>Apply the boundary condition</strong> at either surface (say x = δ/2):
        </p>
        <div class="eqbox">
          <pre class="eq" id="eq-bc">B(δ/2) = Bₐ
⇒ A cosh( (δ/2)/λ ) = Bₐ
⇒ A = Bₐ / cosh(δ/(2λ))</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-bc">Copy boundary steps</button>
          </div>
        </div>

        <div class="callout final">
          <strong>Final result for part (a)</strong>
          <div class="eqbox">
            <pre class="eq" id="eq-final-a">B(x) = Bₐ · cosh(x/λ) / cosh(δ/(2λ))</pre>
            <div class="btnrow">
              <button class="copy" data-copy-target="eq-final-a">Copy final B(x)</button>
            </div>
          </div>
          <p>
            This automatically satisfies: (i) even symmetry about x=0 and (ii) <span style="font-family:var(--mono)">B(±δ/2)=Bₐ</span>.
          </p>
        </div>

        <h3>(b) Effective magnetization and thin-plate approximation (δ ≪ λ)</h3>
        <p>
          The problem defines the effective magnetization profile in CGS by:
        </p>

        <div class="eqbox">
          <pre class="eq" id="eq-defM">B(x) − Bₐ = 4π M(x)   (CGS)</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-defM">Copy definition</button>
          </div>
        </div>

        <p>
          Substitute the exact B(x):
        </p>
        <div class="eqbox">
          <pre class="eq" id="eq-exactM">4π M(x) = Bₐ [ cosh(x/λ)/cosh(δ/(2λ)) − 1 ]</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-exactM">Copy exact 4πM(x)</button>
          </div>
        </div>

        <p>
          Now impose <span style="font-family:var(--mono)">δ ≪ λ</span>. Define small dimensionless parameters:
        </p>
        <div class="eqbox">
          <pre class="eq" id="eq-small">u := x/λ,   a := δ/(2λ).
Then |a| ≪ 1 and inside the slab |u| ≤ a ≪ 1.</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-small">Copy scaling</button>
          </div>
        </div>

        <p>
          Use Taylor expansions (keeping terms through second order):
        </p>
        <div class="eqbox">
          <pre class="eq" id="eq-taylor">cosh(u) = 1 + u²/2 + O(u⁴)
cosh(a) = 1 + a²/2 + O(a⁴)</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-taylor">Copy expansions</button>
          </div>
        </div>

        <p>
          Then the ratio is (using <span style="font-family:var(--mono)">1/(1+ε) = 1 − ε + O(ε²)</span> with <span style="font-family:var(--mono)">ε=a²/2</span>):
        </p>
        <div class="eqbox">
          <pre class="eq" id="eq-ratio">cosh(u)/cosh(a)
= (1 + u²/2 + O(u⁴)) · (1 + a²/2 + O(a⁴))^{−1}
≈ (1 + u²/2) · (1 − a²/2)
≈ 1 + u²/2 − a²/2  + O(a⁴)</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-ratio">Copy ratio derivation</button>
          </div>
        </div>

        <p>
          Plug back into <span style="font-family:var(--mono)">4πM(x)=Bₐ[(cosh(u)/cosh(a))−1]</span>:
        </p>
        <div class="eqbox">
          <pre class="eq" id="eq-Mthin-raw">4π M(x) ≈ Bₐ (u²/2 − a²/2)
= Bₐ/2 (x²/λ² − δ²/(4λ²))
= Bₐ ( x²/(2λ²) − δ²/(8λ²) )</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-Mthin-raw">Copy thin-limit polynomial</button>
          </div>
        </div>

        <p>
          The book’s stated form keeps the denominator as <span style="font-family:var(--mono)">1 + δ²/(8λ²)</span> (i.e., <span style="font-family:var(--mono)">cosh(δ/(2λ))</span> to second order)
          and writes the numerator as a quadratic in x. Using <span style="font-family:var(--mono)">cosh(δ/(2λ)) ≈ 1 + δ²/(8λ²)</span>, we can present:
        </p>

        <div class="callout final">
          <strong>Final result for part (b) (as requested in the problem statement, CGS)</strong>
          <div class="eqbox">
            <pre class="eq" id="eq-final-b">4π M(x) = − Bₐ / (1 + δ²/(8λ²)) · ( δ²/(4λ²) − 2x²/λ² )     for δ ≪ λ</pre>
            <div class="btnrow">
              <button class="copy" data-copy-target="eq-final-b">Copy final 4πM(x)</button>
            </div>
          </div>
          <p>
            <strong>SI note:</strong> replace <span style="font-family:var(--mono)">4π</span> by <span style="font-family:var(--mono)">μ₀</span>, i.e.
            <span style="font-family:var(--mono)">B(x) − Bₐ = μ₀ M(x)</span>.
          </p>
        </div>

        <details>
          <summary>Optional rigor note (boundary consistency at truncation order)</summary>
          <p>
            When you truncate a series, different “equally valid” O(δ²/λ²) approximations can differ by terms of the same order
            depending on whether you (i) expand the ratio and then simplify, (ii) keep a denominator unexpanded, or (iii) enforce
            surface matching exactly at the truncated polynomial level. A common thin-slab approximation that <em>does</em> satisfy
            <span style="font-family:var(--mono)">B(±δ/2)=Bₐ</span> to O(δ²) is:
          </p>
          <div class="eqbox">
            <pre class="eq" id="eq-alt-bc">4π M(x) ≈ Bₐ ( x²/(2λ²) − δ²/(8λ²) ),   δ ≪ λ,  |x| ≤ δ/2</pre>
            <div class="btnrow">
              <button class="copy" data-copy-target="eq-alt-bc">Copy boundary-consistent form</button>
            </div>
          </div>
          <p>
            This is obtained by expanding <span style="font-family:var(--mono)">cosh(x/λ)/cosh(δ/(2λ))</span> directly and it vanishes at the surfaces
            (as it must, since B equals Bₐ there exactly).
          </p>
        </details>

        <h3>Sanity checks</h3>
        <div class="callout">
          <strong>1) Dimensions</strong>
          <ul>
            <li><span style="font-family:var(--mono)">x/λ</span> and <span style="font-family:var(--mono)">δ/λ</span> are dimensionless, so cosh arguments are valid.</li>
            <li><span style="font-family:var(--mono)">M</span> has the same “field units” scaling in CGS through <span style="font-family:var(--mono)">4πM</span>.</li>
          </ul>
          <strong>2) Limiting cases</strong>
          <ul>
            <li><span style="font-family:var(--mono)">δ ≫ λ</span>: <span style="font-family:var(--mono)">cosh(δ/(2λ))</span> is huge ⇒ <span style="font-family:var(--mono)">B(0) ≈ 2Bₐ e^{−δ/(2λ)}</span> (strong expulsion).</li>
            <li><span style="font-family:var(--mono)">δ ≪ λ</span>: ratio is near 1 ⇒ B is nearly uniform and close to <span style="font-family:var(--mono)">Bₐ</span>.</li>
          </ul>
          <strong>3) Sign / physical interpretation</strong>
          <ul>
            <li>Inside, typically <span style="font-family:var(--mono)">B(x) ≤ Bₐ</span> near the center, implying <span style="font-family:var(--mono)">M</span> is diamagnetic (opposes applied field).</li>
          </ul>
        </div>

        <h3>One simple illustrative plot (example values)</h3>
        <figure>
          <canvas id="plot" aria-label="Plot of B(x)/B_a across the slab"></canvas>
          <figcaption>
            Example plot of <span style="font-family:var(--mono)">B(x)/Bₐ</span> across the slab for an illustrative choice <span style="font-family:var(--mono)">δ/λ = 1.0</span>.
            (This plot is <em>illustrative only</em>; the final results above remain symbolic.)
          </figcaption>
        </figure>

        <div class="eqbox">
          <pre class="eq" id="final-answer-plain">FINAL ANSWERS (symbolic)

(a)  B(x) = Bₐ cosh(x/λ) / cosh(δ/(2λ))

(b)  4πM(x) = B(x) − Bₐ, and for δ ≪ λ (CGS):
     4π M(x) = − Bₐ / (1 + δ²/(8λ²)) · ( δ²/(4λ²) − 2x²/λ² )
     (SI: replace 4π by μ₀ in the constitutive relation.)</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="final-answer-plain">Copy final answer</button>
          </div>
        </div>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Interpret the exact formula</h3>
        <ul>
          <li><strong>Shape control:</strong> <span style="font-family:var(--mono)">cosh(x/λ)</span> encodes the “two-surface” penetration: the field rises toward both surfaces.</li>
          <li><strong>Thickness control:</strong> dividing by <span style="font-family:var(--mono)">cosh(δ/(2λ))</span> enforces the surface matching and determines how much the two penetration profiles overlap.</li>
          <li><strong>Engineering takeaway:</strong> shielding improves rapidly once δ exceeds a few λ; for δ ≪ λ, there is little shielding.</li>
        </ul>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li>Increase <strong>λ</strong> (weaker screening): B becomes flatter and closer to Bₐ throughout.</li>
          <li>Increase <strong>δ</strong> (thicker slab): the center field drops approximately exponentially once δ ≫ λ.</li>
          <li>Increase <strong>Bₐ</strong>: in this linear London model, everything scales linearly (until critical fields/currents invalidate it).</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          One can derive the London equation and its slab solutions by minimizing an energy functional:
          magnetic energy density plus kinetic energy of supercurrents. The Euler–Lagrange equation yields
          <span style="font-family:var(--mono)">B'' = B/λ²</span> in 1D. This variational framing is powerful in industrial contexts because it
          generalizes naturally to multilayers, anisotropy, and numerical finite-element implementations.
        </p>

        <details>
          <summary>Dimensional analysis check (why λ is the only length scale)</summary>
          <p>
            In the ODE <span style="font-family:var(--mono)">B'' = (1/λ²)B</span>, the left side scales like <span style="font-family:var(--mono)">B/L²</span>.
            Balancing gives <span style="font-family:var(--mono)">L ~ λ</span>. Hence the only intrinsic decay/variation length is λ, and δ only enters
            through boundary placement, i.e., the dimensionless ratio <span style="font-family:var(--mono)">δ/λ</span>.
          </p>
        </details>

        <h3>Concept check (self-test with answers)</h3>
        <ul>
          <li><strong>Q:</strong> Why is the solution even in x? <strong>A:</strong> The geometry and applied field are symmetric about the midplane x=0, so physics cannot depend on the sign of x → eliminate the odd mode (sinh).</li>
          <li><strong>Q:</strong> What happens if δ ≫ λ? <strong>A:</strong> The center becomes nearly field-free: <span style="font-family:var(--mono)">B(0)/Bₐ = 1/cosh(δ/(2λ)) ≈ 2e^{−δ/(2λ)}</span>.</li>
          <li><strong>Q:</strong> In the thin limit, why is the variation quadratic? <strong>A:</strong> Because cosh has a Taylor series starting with 1 + (argument)²/2; symmetry forbids linear terms.</li>
          <li><strong>Q:</strong> In SI, what replaces 4π? <strong>A:</strong> The constitutive relation is <span style="font-family:var(--mono)">B = μ₀(H+M)</span>, so with the problem’s definition you use <span style="font-family:var(--mono)">B(x) − Bₐ = μ₀ M(x)</span>.</li>
        </ul>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p>
          The plot shows <span style="font-family:var(--mono)">B(x)/Bₐ</span> across the thickness of the slab.
          It is useful because it makes the symmetry and the “more penetration in thinner slabs” idea visually immediate.
        </p>
        <ul>
          <li><strong>x-axis:</strong> position x (m), from <span style="font-family:var(--mono)">−δ/2</span> to <span style="font-family:var(--mono)">+δ/2</span>.</li>
          <li><strong>y-axis:</strong> normalized field <span style="font-family:var(--mono)">B(x)/Bₐ</span> (dimensionless).</li>
          <li><strong>Example values:</strong> the canvas uses <span style="font-family:var(--mono)">δ/λ = 1.0</span> purely for illustration.</li>
          <li><strong>What to notice:</strong> the minimum occurs at x=0; the curve touches 1 at the surfaces (exact solution); curvature increases as δ/λ increases.</li>
        </ul>
        <a class="backtop" href="#top">Back to top</a>
      </section>
    </article>
  </main>

  <footer>
    <p>
      Built as a self-contained learning article (vanilla HTML/CSS/JS). No external libraries. Print-friendly layout included.
    </p>
  </footer>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    // Copy buttons
    const toast = document.getElementById('toast');
    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 1200);
    }
    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        showToast("Copied to clipboard.");
      }catch(e){
        // Fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        showToast("Copied (fallback).");
      }
    }
    document.querySelectorAll('button.copy').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('data-copy-target');
        const el = document.getElementById(id);
        if(!el) return;
        copyText(el.innerText.trim());
      });
    });

    // Plot: B(x)/Ba across slab for example δ/λ = 1.0
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    function cosh(x){ return (Math.exp(x)+Math.exp(-x))/2; }

    function drawPlot(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      const W = Math.floor(rect.width * dpr);
      const H = Math.floor(rect.height * dpr);
      canvas.width = W; canvas.height = H;

      // Layout
      const padL = 62*dpr, padR = 20*dpr, padT = 36*dpr, padB = 52*dpr;
      const plotW = W - padL - padR;
      const plotH = H - padT - padB;

      // Example values (illustrative only)
      const lambda = 1.0;              // arbitrary units
      const delta_over_lambda = 1.0;   // example
      const delta = delta_over_lambda * lambda;

      const xmin = -delta/2, xmax = +delta/2;

      // Compute y-range from exact solution
      const a = delta/(2*lambda);
      let ymin = Infinity, ymax = -Infinity;
      const N = 400;
      for(let i=0;i<=N;i++){
        const x = xmin + (xmax-xmin)*i/N;
        const y = cosh(x/lambda)/cosh(a); // B/Ba
        ymin = Math.min(ymin, y);
        ymax = Math.max(ymax, y);
      }
      // Provide some headroom
      const ypad = 0.06;
      const ylo = Math.max(0, ymin - ypad);
      const yhi = Math.min(1.05, ymax + ypad);

      // Helpers
      function X(x){ return padL + (x - xmin)/(xmax-xmin)*plotW; }
      function Y(y){ return padT + (yhi - y)/(yhi-ylo)*plotH; }

      // Clear
      ctx.clearRect(0,0,W,H);

      // Background
      ctx.fillStyle = "rgba(0,0,0,0.12)";
      ctx.fillRect(0,0,W,H);

      // Gridlines
      ctx.lineWidth = 1*dpr;
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      const xticks = 5;
      for(let i=0;i<=xticks;i++){
        const x = xmin + (xmax-xmin)*i/xticks;
        const xx = X(x);
        ctx.beginPath();
        ctx.moveTo(xx, padT);
        ctx.lineTo(xx, padT+plotH);
        ctx.stroke();
      }
      const yticks = 5;
      for(let i=0;i<=yticks;i++){
        const y = ylo + (yhi-ylo)*i/yticks;
        const yy = Y(y);
        ctx.beginPath();
        ctx.moveTo(padL, yy);
        ctx.lineTo(padL+plotW, yy);
        ctx.stroke();
      }

      // Axes
      ctx.strokeStyle = "rgba(255,255,255,0.55)";
      ctx.lineWidth = 1.2*dpr;
      ctx.beginPath();
      ctx.moveTo(padL, padT);
      ctx.lineTo(padL, padT+plotH);
      ctx.lineTo(padL+plotW, padT+plotH);
      ctx.stroke();

      // Labels
      ctx.fillStyle = "rgba(233,238,246,0.95)";
      ctx.font = `${12*dpr}px system-ui, -apple-system, Segoe UI, Roboto, Arial`;
      ctx.textAlign = "center";
      ctx.fillText("Example: Field profile inside slab (δ/λ = 1.0)", W/2, 20*dpr);

      // x label
      ctx.fillStyle = "rgba(183,195,214,0.95)";
      ctx.font = `${12*dpr}px system-ui, -apple-system, Segoe UI, Roboto, Arial`;
      ctx.fillText("x (arbitrary units)", padL + plotW/2, padT + plotH + 38*dpr);

      // y label (rotated)
      ctx.save();
      ctx.translate(20*dpr, padT + plotH/2);
      ctx.rotate(-Math.PI/2);
      ctx.textAlign = "center";
      ctx.fillText("B(x) / Bₐ", 0, 0);
      ctx.restore();

      // Tick labels
      ctx.fillStyle = "rgba(183,195,214,0.95)";
      ctx.font = `${11*dpr}px system-ui, -apple-system, Segoe UI, Roboto, Arial`;

      // x ticks
      ctx.textAlign = "center";
      ctx.textBaseline = "top";
      for(let i=0;i<=xticks;i++){
        const x = xmin + (xmax-xmin)*i/xticks;
        const xx = X(x);
        ctx.beginPath();
        ctx.moveTo(xx, padT+plotH);
        ctx.lineTo(xx, padT+plotH + 6*dpr);
        ctx.strokeStyle = "rgba(255,255,255,0.55)";
        ctx.stroke();
        ctx.fillText(x.toFixed(2), xx, padT+plotH + 10*dpr);
      }

      // y ticks
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      for(let i=0;i<=yticks;i++){
        const y = ylo + (yhi-ylo)*i/yticks;
        const yy = Y(y);
        ctx.beginPath();
        ctx.moveTo(padL - 6*dpr, yy);
        ctx.lineTo(padL, yy);
        ctx.strokeStyle = "rgba(255,255,255,0.55)";
        ctx.stroke();
        ctx.fillText(y.toFixed(3), padL - 10*dpr, yy);
      }

      // Curve
      ctx.lineWidth = 2.2*dpr;
      ctx.strokeStyle = "rgba(125,211,252,0.95)";
      ctx.beginPath();
      for(let i=0;i<=N;i++){
        const x = xmin + (xmax-xmin)*i/N;
        const y = cosh(x/lambda)/cosh(a);
        const xx = X(x), yy = Y(y);
        if(i===0) ctx.moveTo(xx,yy);
        else ctx.lineTo(xx,yy);
      }
      ctx.stroke();

      // Legend
      const lx = padL + 14*dpr, ly = padT + 10*dpr;
      ctx.fillStyle = "rgba(15,22,32,0.75)";
      ctx.strokeStyle = "rgba(255,255,255,0.16)";
      ctx.lineWidth = 1*dpr;
      const lw = 190*dpr, lh = 36*dpr;
      ctx.beginPath();
      ctx.roundRect(lx, ly, lw, lh, 10*dpr);
      ctx.fill(); ctx.stroke();

      ctx.strokeStyle = "rgba(125,211,252,0.95)";
      ctx.lineWidth = 2.2*dpr;
      ctx.beginPath();
      ctx.moveTo(lx+12*dpr, ly+18*dpr);
      ctx.lineTo(lx+46*dpr, ly+18*dpr);
      ctx.stroke();

      ctx.fillStyle = "rgba(233,238,246,0.95)";
      ctx.font = `${11.5*dpr}px system-ui, -apple-system, Segoe UI, Roboto, Arial`;
      ctx.textAlign = "left";
      ctx.textBaseline = "middle";
      ctx.fillText("Exact: B(x)/Bₐ = cosh(x/λ)/cosh(δ/2λ)", lx+54*dpr, ly+18*dpr);
    }

    // Polyfill for roundRect if needed
    if(!CanvasRenderingContext2D.prototype.roundRect){
      CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
        const rr = Math.min(r, w/2, h/2);
        this.beginPath();
        this.moveTo(x+rr, y);
        this.arcTo(x+w, y, x+w, y+h, rr);
        this.arcTo(x+w, y+h, x, y+h, rr);
        this.arcTo(x, y+h, x, y, rr);
        this.arcTo(x, y, x+w, y, rr);
        this.closePath();
        return this;
      }
    }

    window.addEventListener('resize', drawPlot, {passive:true});
    drawPlot();
  </script>
</body>
</html>
