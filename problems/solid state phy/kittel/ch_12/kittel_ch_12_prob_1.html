<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Magnon Dispersion on a Simple Cubic Lattice (z = 6): Derivation</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1620;
      --panel2:#0c121a;
      --text:#e8eef6;
      --muted:#a7b4c4;
      --faint:#6f8096;
      --accent:#7bdcff;
      --accent2:#a78bfa;
      --ok:#68f0b5;
      --warn:#ffd36e;
      --bad:#ff6b8a;
      --line:rgba(255,255,255,.10);
      --shadow: 0 18px 50px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(1200px 800px at 20% -10%, rgba(123,220,255,.15), transparent 60%),
        radial-gradient(1200px 800px at 90% 10%, rgba(167,139,250,.12), transparent 55%),
        linear-gradient(180deg, #070a0f 0%, #0b0f14 60%, #080b10 100%);
      color:var(--text);
      font-family:var(--sans);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header.hero{
      padding:28px 18px 12px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding:0 14px 54px;
    }
    .title-row{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    h1{
      margin:0;
      font-size:clamp(1.45rem, 2.3vw, 2.15rem);
      letter-spacing:.2px;
    }
    .subtitle{
      margin-top:8px;
      color:var(--muted);
      max-width:78ch;
      font-size:1.02rem;
    }
    .meta{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:14px;
      color:var(--muted);
      font-size:.92rem;
    }
    .pill{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:6px 10px;
      border-radius:999px;
      backdrop-filter: blur(6px);
      box-shadow: 0 10px 30px rgba(0,0,0,.18);
      white-space:nowrap;
    }

    main{
      margin-top:18px;
      display:grid;
      grid-template-columns: 300px minmax(0,1fr);
      gap:16px;
      align-items:start;
    }

    nav.toc{
      position:sticky;
      top:12px;
      align-self:start;
      border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border-radius:var(--radius);
      padding:14px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    nav.toc .toc-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin:0 0 10px;
      font-size:1rem;
      color:var(--text);
    }
    .toc small{color:var(--faint)}
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      margin:4px 0;
      color:var(--muted);
      border:1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .toc a:hover{
      background:rgba(123,220,255,.08);
      border-color:rgba(123,220,255,.25);
      color:var(--text);
      transform: translateX(2px);
      text-decoration:none;
    }
    .toc .toplink{
      margin-top:10px;
      padding-top:10px;
      border-top:1px solid var(--line);
    }

    article{
      min-width:0;
      border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      border-radius:var(--radius);
      padding:18px 18px 22px;
      box-shadow: var(--shadow);
    }

    section{margin-top:18px}
    section:first-child{margin-top:0}
    h2{
      margin:0 0 8px;
      font-size:1.25rem;
      letter-spacing:.15px;
    }
    h3{
      margin:14px 0 8px;
      font-size:1.08rem;
      color:rgba(255,255,255,.92);
    }
    p{margin:8px 0; color:rgba(232,238,246,.94)}
    ul{margin:8px 0 8px 18px; color:rgba(232,238,246,.92)}
    li{margin:6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 980px){
      main{grid-template-columns: 1fr}
      nav.toc{position:relative; top:auto}
      .grid2{grid-template-columns:1fr}
    }

    .card{
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(0,0,0,.18);
      padding:12px 12px;
    }
    .callout{
      border:1px solid rgba(123,220,255,.25);
      background: linear-gradient(180deg, rgba(123,220,255,.10), rgba(0,0,0,.16));
      border-radius:16px;
      padding:12px 12px;
    }
    .callout.warn{
      border-color: rgba(255,211,110,.35);
      background: linear-gradient(180deg, rgba(255,211,110,.10), rgba(0,0,0,.16));
    }
    .callout.ok{
      border-color: rgba(104,240,181,.35);
      background: linear-gradient(180deg, rgba(104,240,181,.10), rgba(0,0,0,.16));
    }
    .callout.bad{
      border-color: rgba(255,107,138,.35);
      background: linear-gradient(180deg, rgba(255,107,138,.10), rgba(0,0,0,.16));
    }
    .label{
      font-size:.86rem;
      letter-spacing:.25px;
      color:var(--muted);
      text-transform:uppercase;
      margin-bottom:6px;
    }

    pre.eq{
      margin:10px 0;
      padding:12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.28);
      overflow:auto;
      font-family:var(--mono);
      font-size:.94rem;
      line-height:1.45;
      color:#eaf3ff;
      position:relative;
    }
    .eqbar{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      margin-top:8px;
      flex-wrap:wrap;
    }
    button.copy{
      appearance:none;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text);
      padding:8px 10px;
      border-radius:12px;
      cursor:pointer;
      font-size:.92rem;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      border-color: rgba(123,220,255,.35);
      background: rgba(123,220,255,.08);
    }
    button.copy:active{transform: translateY(0px)}
    .copystatus{
      color:var(--faint);
      font-size:.9rem;
    }

    details{
      border:1px solid var(--line);
      border-radius:16px;
      background:rgba(0,0,0,.18);
      padding:10px 12px;
      margin:10px 0;
    }
    details summary{
      cursor:pointer;
      color:var(--text);
      font-weight:600;
    }
    details p, details ul{color:rgba(232,238,246,.92)}
    .math-insight{
      border:1px dashed rgba(167,139,250,.45);
      background: linear-gradient(180deg, rgba(167,139,250,.12), rgba(0,0,0,.16));
      border-radius:16px;
      padding:12px 12px;
      margin:12px 0;
    }

    figure{
      margin:12px 0 0;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.18);
    }
    figcaption{color:var(--muted); font-size:.92rem; margin-top:8px}
    canvas{width:100%; height:320px; display:block; border-radius:12px; background:rgba(0,0,0,.18); border:1px solid rgba(255,255,255,.08)}
    footer{
      margin-top:18px;
      color:var(--muted);
      font-size:.92rem;
      border-top:1px solid var(--line);
      padding-top:14px;
    }

    @media print{
      body{background:#fff; color:#000}
      nav.toc{display:none}
      header.hero{border:none; background:none}
      article{box-shadow:none; background:#fff; border:1px solid #ddd}
      .callout,.card,.math-insight,details,pre.eq,figure{background:#fff; border-color:#ddd}
      a{color:#000; text-decoration:underline}
      button.copy,.copystatus{display:none}
      section{break-inside: avoid-page}
      h2,h3{break-after: avoid-page}
      pre{white-space:pre-wrap}
    }
  </style>
</head>
<body>
<header id="top" class="hero">
  <div class="wrap">
    <div class="title-row">
      <div>
        <h1>Magnon Dispersion Relation on a Simple Cubic Lattice (z = 6)</h1>
        <p class="subtitle">
          We derive the spin-wave (magnon) dispersion for a nearest-neighbor Heisenberg ferromagnet on a simple cubic lattice by linearizing the equations of motion and solving the resulting lattice eigenvalue problem with plane-wave modes.
        </p>
        <div class="meta">
          <span class="pill">Topic: Spin waves / magnons</span>
          <span class="pill">Model: Heisenberg exchange (nearest neighbors)</span>
          <span class="pill">Lattice: Simple cubic, coordination z = 6</span>
          <span class="pill">Result: Symbolic dispersion &omega;(k)</span>
        </div>
      </div>
      <div class="pill" style="max-width:340px">
        <div style="font-weight:700; color:var(--text); margin-bottom:6px">Industrial engineering lens</div>
        <div style="color:var(--muted); font-size:.92rem">
          Spin-wave spectra connect to magnetic material performance, sensing, RF components, and process windows in thin-film manufacturing.
        </div>
      </div>
    </div>
  </div>
</header>

<div class="wrap">
  <main>
    <nav class="toc" aria-label="Table of contents">
      <div class="toc-title">
        <strong>Contents</strong>
        <small>sticky</small>
      </div>
      <a href="#quick-summary">Quick Summary</a>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry & Applied Physics</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy & Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Optional Plot Guide</a>
      <div class="toplink">
        <a href="#top">Back to top ↑</a>
      </div>
    </nav>

    <article>
      <section id="quick-summary">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this is:</strong> Derive the magnon (spin-wave) dispersion relation for a simple cubic lattice with coordination number <strong>z = 6</strong>.</li>
          <li><strong>Key physics idea:</strong> Small transverse oscillations of spins about a uniformly magnetized ground state propagate as waves (magnons).</li>
          <li><strong>Governing dynamics:</strong> Lattice spin precession from exchange field: <span style="font-family:var(--mono)">dS/dt = (1/ħ) S × (−∂H/∂S)</span>.</li>
          <li><strong>Linearization:</strong> Assume <span style="font-family:var(--mono)">S^z ≈ S</span> (constant) and keep only first-order terms in <span style="font-family:var(--mono)">S^x, S^y</span>.</li>
          <li><strong>Eigenmodes:</strong> Use plane waves <span style="font-family:var(--mono)">exp(i(k·r − ωt))</span> to diagonalize the translation-invariant lattice operator.</li>
          <li><strong>Main result (symbolic):</strong> <span style="font-family:var(--mono)">ω(k) = (4JS/ħ)[3 − cos(kx a) − cos(ky a) − cos(kz a)]</span> for simple cubic nearest neighbors.</li>
          <li><strong>Long-wavelength limit:</strong> For small <span style="font-family:var(--mono)">|k|a</span>, <span style="font-family:var(--mono)">ω ≈ (2JS a^2/ħ) k^2</span> (quadratic ferromagnetic spin-wave dispersion).</li>
          <li><strong>Meaning:</strong> Exchange creates a restoring torque proportional to discrete curvature (a lattice Laplacian), giving a dispersive wave whose frequency depends on the lattice direction and wavelength.</li>
        </ul>
      </section>

      <section id="part0">
        <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

        <div class="grid2">
          <div class="card">
            <div class="label">Core definitions (symbols + SI units)</div>
            <ul>
              <li><strong>Spin at site p:</strong> <span style="font-family:var(--mono)">S_p</span> (quantum operator) or classical vector; magnitude <span style="font-family:var(--mono)">|S_p| ≈ S</span> (dimensionless in units of ħ).</li>
              <li><strong>Exchange constant:</strong> <span style="font-family:var(--mono)">J</span> (energy, SI: J; often eV or meV). For a ferromagnet, <span style="font-family:var(--mono)">J &gt; 0</span> in the convention <span style="font-family:var(--mono)">H = −J Σ⟨pq⟩ S_p·S_q</span>.</li>
              <li><strong>Lattice constant:</strong> <span style="font-family:var(--mono)">a</span> (m).</li>
              <li><strong>Coordination number:</strong> <span style="font-family:var(--mono)">z</span> (dimensionless); for simple cubic, <span style="font-family:var(--mono)">z = 6</span>.</li>
              <li><strong>Angular frequency:</strong> <span style="font-family:var(--mono)">ω</span> (rad/s), wavevector <span style="font-family:var(--mono)">k</span> (1/m).</li>
              <li><strong>Reduced Planck constant:</strong> <span style="font-family:var(--mono)">ħ</span> (J·s).</li>
            </ul>
          </div>
          <div class="card">
            <div class="label">Physical meaning (intuition)</div>
            <ul>
              <li><strong>Ferromagnetic ground state:</strong> all spins align (say along +z), minimizing exchange energy.</li>
              <li><strong>Magnon/spin wave:</strong> a collective, phase-coherent precession of spins with a spatial phase <span style="font-family:var(--mono)">k·r</span>.</li>
              <li><strong>Why dispersion appears:</strong> exchange couples neighbors, so shorter-wavelength twists cost more energy → higher frequency.</li>
              <li><strong>Key signature:</strong> in ferromagnets, low-k magnons typically obey <span style="font-family:var(--mono)">ω ∝ k^2</span> (contrast with antiferromagnets, often <span style="font-family:var(--mono)">ω ∝ k</span> at small k).</li>
            </ul>
          </div>
        </div>

        <h3>Key laws/principles and validity conditions</h3>
        <ul>
          <li><strong>Heisenberg exchange Hamiltonian (nearest neighbors):</strong> translation invariant, isotropic in spin space (ignores anisotropy, dipolar fields, damping).</li>
          <li><strong>Equation of motion:</strong> from quantum commutator <span style="font-family:var(--mono)">dS/dt = (i/ħ)[H, S]</span>, or classical torque <span style="font-family:var(--mono)">dS/dt = (1/ħ) S × (−∂H/∂S)</span>.</li>
          <li><strong>Spin-wave approximation:</strong> small transverse components <span style="font-family:var(--mono)">S^x, S^y ≪ S</span>, and <span style="font-family:var(--mono)">S^z ≈ S</span> (constant to linear order).</li>
          <li><strong>Regime:</strong> low temperature / low magnon density so that magnons weakly interact (linear theory).</li>
        </ul>

        <h3>Common models/approximations (and why)</h3>
        <ul>
          <li><strong>Linearization:</strong> keeps only first order in deviations. Mathematically: drop products like <span style="font-family:var(--mono)">S^x S^y</span> as higher order.</li>
          <li><strong>Nearest-neighbor coupling:</strong> simplest lattice operator; captures essential bandstructure in k-space.</li>
          <li><strong>Continuum limit (optional):</strong> for <span style="font-family:var(--mono)">|k|a ≪ 1</span>, discrete differences become derivatives and the lattice operator becomes a Laplacian.</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li><strong>Uniform mode (k = 0):</strong> all spins precess in-phase → no relative twist → for pure exchange, frequency tends to <span style="font-family:var(--mono)">ω(0)=0</span>.</li>
          <li><strong>Zone-boundary mode (k ~ π/a):</strong> neighbors are nearly out-of-phase → strong twist → high frequency.</li>
          <li><strong>Wavelength effect:</strong> halving wavelength (doubling k) increases exchange “curvature” and thus increases ω.</li>
        </ul>

        <div class="callout warn">
          <div class="label">What to watch for (pitfalls)</div>
          <ul>
            <li><strong>Sign conventions for J:</strong> Some texts use <span style="font-family:var(--mono)">H = +J Σ S·S</span>. Always check whether ferromagnet corresponds to J &gt; 0 or J &lt; 0.</li>
            <li><strong>Coordination number z:</strong> simple cubic has 6 nearest neighbors, not 8 (that’s bcc’s nearest-neighbor count).</li>
            <li><strong>Plane-wave ansatz:</strong> must match lattice translation symmetry: <span style="font-family:var(--mono)">S_{p+δ} ∝ e^{ik·(r_p+δ)}</span>.</li>
            <li><strong>Small-k expansion:</strong> use <span style="font-family:var(--mono)">cos x ≈ 1 − x^2/2</span>, not <span style="font-family:var(--mono)">1 − x</span>.</li>
          </ul>
        </div>

        <div class="math-insight">
          <div class="label">Math Insight</div>
          <p>
            After linearization, the transverse spin components satisfy a <strong>linear lattice eigenvalue problem</strong>.
            The operator <span style="font-family:var(--mono)">z f_p − Σδ f_{p+δ}</span> is the <strong>discrete Laplacian</strong> (up to a factor),
            diagonalized by Fourier modes <span style="font-family:var(--mono)">e^{ik·r_p}</span>. The dispersion relation is the corresponding eigenvalue mapped to an angular frequency.
          </p>
        </div>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>
        <div class="grid2">
          <div class="card">
            <div class="label">Where this appears in industry (examples)</div>
            <ul>
              <li><strong>Spintronics & magnetic memory:</strong> magnon spectra affect switching losses, noise, and stability in MRAM stacks.</li>
              <li><strong>RF/microwave components:</strong> ferrite and magnonic devices exploit spin-wave modes for filters, isolators, and tunable resonators.</li>
              <li><strong>Magnetic sensing:</strong> dispersion influences dynamic susceptibility and resonance linewidth in sensors (e.g., thin-film magnetometers).</li>
              <li><strong>Materials processing:</strong> thin-film growth conditions change exchange and anisotropy, shifting magnon modes used as quality metrics.</li>
            </ul>
          </div>
          <div class="card">
            <div class="label">Why engineers care</div>
            <ul>
              <li><strong>Performance:</strong> ω(k) sets characteristic timescales for magnetization dynamics.</li>
              <li><strong>Reliability:</strong> unwanted spin-wave excitations can contribute to heating and stochastic switching.</li>
              <li><strong>Cost & manufacturability:</strong> exchange stiffness correlates with composition, grain size, interface quality—variables controlled by process windows.</li>
              <li><strong>Design trade-offs:</strong> higher exchange can suppress nonuniform modes but may increase required write energy depending on device geometry.</li>
            </ul>
          </div>
        </div>

        <h3>Typical measurement/validation methods</h3>
        <ul>
          <li><strong>Brillouin light scattering (BLS):</strong> measures spin-wave frequencies vs wavevector in thin films.</li>
          <li><strong>Inelastic neutron scattering:</strong> probes magnon dispersion in bulk crystals.</li>
          <li><strong>Ferromagnetic resonance (FMR):</strong> captures k≈0 dynamics; with patterned structures can access finite-k modes.</li>
        </ul>

        <h3>From lab to product: adapting the ideal model</h3>
        <details>
          <summary>How real systems depart from the textbook dispersion</summary>
          <ul>
            <li><strong>Anisotropy & dipolar fields:</strong> add gaps and nontrivial low-k behavior (e.g., magnetostatic modes).</li>
            <li><strong>Damping:</strong> introduces linewidths; ω becomes complex in a dissipative description.</li>
            <li><strong>Finite thickness & boundaries:</strong> quantize k in confined directions; dispersion becomes a set of subbands.</li>
            <li><strong>Disorder and interfaces:</strong> renormalize effective J (exchange stiffness) and scatter magnons (reducing coherence length).</li>
          </ul>
        </details>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <div class="callout">
          <div class="label">Problem restatement (in my own words)</div>
          <p>
            For a spin system of magnitude <span style="font-family:var(--mono)">S</span> on a <strong>simple cubic lattice</strong> (coordination <span style="font-family:var(--mono)">z=6</span>),
            derive the <strong>magnon dispersion relation</strong> by:
            (i) showing that the linearized equation of motion for the transverse component satisfies
            <span style="font-family:var(--mono)">dS_p^x/dt = (2JS/ħ)(6S_p^y − Σδ S_{p+δ}^y)</span>,
            and similarly for <span style="font-family:var(--mono)">dS_p^y/dt</span>;
            (ii) seeking plane-wave solutions of the form <span style="font-family:var(--mono)">exp(i(k·r_p − ωt))</span>;
            (iii) extracting <span style="font-family:var(--mono)">ω(k)</span> for the simple cubic nearest-neighbor vectors <span style="font-family:var(--mono)">δ</span>.
          </p>
        </div>

        <div class="grid2">
          <div class="card">
            <div class="label">Given</div>
            <ul>
              <li>Simple cubic lattice, z = 6 nearest neighbors.</li>
              <li>Exchange constant J, spin length S.</li>
              <li>Hinted linearized EOM form for <span style="font-family:var(--mono)">dS_p^x/dt</span>.</li>
              <li>Use plane-wave ansatz <span style="font-family:var(--mono)">exp(i(k·r_p − ωt))</span>.</li>
            </ul>
          </div>
          <div class="card">
            <div class="label">Unknowns / must find</div>
            <ul>
              <li>The explicit dispersion relation <span style="font-family:var(--mono)">ω(k)</span> for simple cubic.</li>
              <li>Its simplified form in terms of <span style="font-family:var(--mono)">cos(k_x a)</span>, etc.</li>
              <li>Checks: <span style="font-family:var(--mono)">ω(0)=0</span>, small-k expansion.</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (why they apply)</h3>
        <ul>
          <li><strong>Heisenberg exchange dynamics:</strong> nearest-neighbor coupling creates local effective fields proportional to neighboring spins.</li>
          <li><strong>Linearity after small-angle approximation:</strong> yields coupled linear ODEs on a lattice for <span style="font-family:var(--mono)">S^x</span>, <span style="font-family:var(--mono)">S^y</span>.</li>
          <li><strong>Discrete translational symmetry:</strong> enables Fourier diagonalization; plane waves are eigenvectors of the lattice Laplacian.</li>
        </ul>

        <div class="callout ok">
          <div class="label">Assumptions (explicit)</div>
          <ul>
            <li><strong>Ferromagnetic order:</strong> equilibrium spins aligned along +z, so <span style="font-family:var(--mono)">S_p^z ≈ S</span> for all p.</li>
            <li><strong>Small transverse fluctuations:</strong> <span style="font-family:var(--mono)">|S_p^x|, |S_p^y| ≪ S</span>, keep only linear terms.</li>
            <li><strong>Nearest-neighbor isotropic exchange only:</strong> ignore anisotropy, dipolar interactions, external fields, damping.</li>
            <li><strong>Infinite (or periodic) lattice:</strong> boundary effects neglected so Fourier modes are valid.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <ul>
          <li><strong>(A) Equations of motion + plane-wave ansatz (chosen):</strong> direct, matches the hint, minimal machinery.</li>
          <li><strong>(B) Holstein–Primakoff + Fourier transform:</strong> quantum operator method; yields the same dispersion and also quantizes magnons naturally.</li>
          <li><strong>(C) Continuum micromagnetics (exchange stiffness):</strong> gives small-k limit <span style="font-family:var(--mono)">ω ∝ k^2</span> but loses full Brillouin-zone lattice periodicity.</li>
        </ul>
        <p><strong>Best choice:</strong> (A) because the problem explicitly provides the linearized lattice EOM and requests plane-wave solutions.</p>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

        <ol>
          <li><strong>Set the model:</strong> write the nearest-neighbor Heisenberg Hamiltonian and define lattice sites and neighbor vectors.</li>
          <li><strong>Write EOM:</strong> use <span style="font-family:var(--mono)">dS_p/dt = (i/ħ)[H,S_p]</span> (or classical torque form) to get exact lattice precession equations.</li>
          <li><strong>Linearize:</strong> expand around <span style="font-family:var(--mono)">S^z ≈ S</span>, drop quadratic transverse terms.</li>
          <li><strong>Obtain coupled transverse equations:</strong> show the form given in the hint for <span style="font-family:var(--mono)">dS_p^x/dt</span> and derive the companion equation for <span style="font-family:var(--mono)">dS_p^y/dt</span>.</li>
          <li><strong>Fourier/plane-wave ansatz:</strong> plug <span style="font-family:var(--mono)">S_p^{x,y}(t) = A_{x,y} e^{i(k·r_p − ωt)}</span> into both equations.</li>
          <li><strong>Use translation invariance:</strong> simplify neighbor sums via <span style="font-family:var(--mono)">S_{p+δ} = S_p e^{ik·δ}</span>.</li>
          <li><strong>Solve the 2×2 linear system:</strong> enforce nontrivial amplitudes by setting determinant to zero → dispersion relation.</li>
          <li><strong>Specialize to simple cubic:</strong> insert δ = ±a x̂, ±a ŷ, ±a ẑ to get sums in terms of cosines.</li>
          <li><strong>Sanity checks:</strong> verify units, ω(0)=0, small-k expansion, and zone-boundary behavior.</li>
        </ol>

        <div class="callout bad">
          <div class="label">Common mistakes</div>
          <ul>
            <li>Forgetting that the neighbor set includes <strong>both</strong> +δ and −δ, producing cosines.</li>
            <li>Dropping the factor z (=6) incorrectly when forming <span style="font-family:var(--mono)">zS_p − Σ S_{p+δ}</span>.</li>
            <li>Mixing <span style="font-family:var(--mono)">r_p</span> (site position) with the label p; always keep <span style="font-family:var(--mono)">k·r_p</span>.</li>
            <li>Sign errors between the x and y equations (they should describe a rotation/precession pair).</li>
          </ul>
        </div>
      </section>

      <section id="part3">
        <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

        <h3>3.1 Physical intuition first</h3>
        <p>
          Exchange energy penalizes misalignment between neighboring spins. A spin wave is a gently twisting pattern of spin direction:
          long wavelengths (small k) twist slowly and cost little energy, so the frequency should be small; short wavelengths twist rapidly and cost more energy, so frequency rises.
          For an isotropic ferromagnet with only exchange, the uniform mode (k=0) should have <span style="font-family:var(--mono)">ω=0</span> because a global rotation changes no relative angles.
        </p>

        <h3>3.2 Mathematical model (variables, domain, coordinates, BCs)</h3>
        <div class="card">
          <ul>
            <li><strong>Domain:</strong> a simple cubic Bravais lattice with sites at positions <span style="font-family:var(--mono)">r_p</span>, spacing a, assumed infinite or periodic.</li>
            <li><strong>Degrees of freedom:</strong> spin vectors/operators <span style="font-family:var(--mono)">S_p = (S_p^x, S_p^y, S_p^z)</span>, with magnitude ≈ S.</li>
            <li><strong>Hamiltonian (nearest neighbor Heisenberg ferromagnet):</strong></li>
          </ul>
          <pre class="eq" id="eq-ham">H = − J ∑⟨p,q⟩ S_p · S_q
( J &gt; 0 for ferromagnetic coupling in this convention )</pre>
          <div class="eqbar">
            <button class="copy" data-copy="#eq-ham">Copy equation (plain text)</button>
            <span class="copystatus" id="st-ham"></span>
          </div>
          <ul style="margin-top:10px">
            <li><strong>Neighbor vectors:</strong> for simple cubic, δ ∈ {±a x̂, ±a ŷ, ±a ẑ}. There are z=6 such δ.</li>
            <li><strong>Boundary conditions:</strong> periodic (Born–von Kármán) or infinite lattice so Fourier modes are valid eigenfunctions.</li>
          </ul>
        </div>

        <h3>3.3 Equations of motion and linearization</h3>
        <p>
          The quantum equation of motion for spin operators is
          <span style="font-family:var(--mono)">dS_p/dt = (i/ħ)[H, S_p]</span>.
          Equivalently (and often more intuitive), spins precess about an effective field derived from the Hamiltonian:
          <span style="font-family:var(--mono)">dS_p/dt = (1/ħ) S_p × (−∂H/∂S_p)</span>.
          For the Heisenberg Hamiltonian above,
        </p>

        <pre class="eq" id="eq-effective">−∂H/∂S_p = J ∑_{δ} S_{p+δ}</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-effective">Copy equation (plain text)</button>
          <span class="copystatus" id="st-eff"></span>
        </div>

        <p>
          Therefore,
        </p>

        <pre class="eq" id="eq-eomvec">dS_p/dt = (J/ħ) S_p × ( ∑_{δ} S_{p+δ} )</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-eomvec">Copy equation (plain text)</button>
          <span class="copystatus" id="st-eomvec"></span>
        </div>

        <div class="callout ok">
          <div class="label">Linear spin-wave approximation (what is neglected)</div>
          <ul>
            <li>Assume equilibrium magnetization along +z: <span style="font-family:var(--mono)">S_p^z ≈ S</span> (site independent).</li>
            <li>Transverse components are small: <span style="font-family:var(--mono)">S_p^x, S_p^y = O(ε)</span> with ε≪1.</li>
            <li>Drop all terms <span style="font-family:var(--mono)">O(ε^2)</span>, such as products <span style="font-family:var(--mono)">S^x S^y</span> and transverse corrections to <span style="font-family:var(--mono)">S^z</span>.</li>
          </ul>
        </div>

        <p>
          To get component equations, write the cross product explicitly. Let
          <span style="font-family:var(--mono)">B_p := ∑_{δ} S_{p+δ}</span>.
          Then
          <span style="font-family:var(--mono)">dS_p/dt = (J/ħ)(S_p × B_p)</span>, so
        </p>

        <pre class="eq" id="eq-components">dS_p^x/dt = (J/ħ)( S_p^y B_p^z − S_p^z B_p^y )
dS_p^y/dt = (J/ħ)( S_p^z B_p^x − S_p^x B_p^z )
dS_p^z/dt = (J/ħ)( S_p^x B_p^y − S_p^y B_p^x )</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-components">Copy equation (plain text)</button>
          <span class="copystatus" id="st-comp"></span>
        </div>

        <p>
          Now apply linearization:
          <span style="font-family:var(--mono)">S_p^z ≈ S</span>, and for neighbors likewise <span style="font-family:var(--mono)">S_{p+δ}^z ≈ S</span>.
          Then
          <span style="font-family:var(--mono)">B_p^z = ∑_{δ} S_{p+δ}^z ≈ ∑_{δ} S = zS</span>.
          For simple cubic, z=6, so <span style="font-family:var(--mono)">B_p^z ≈ 6S</span>.
          Meanwhile <span style="font-family:var(--mono)">B_p^x = ∑_{δ} S_{p+δ}^x</span> and <span style="font-family:var(--mono)">B_p^y = ∑_{δ} S_{p+δ}^y</span> are already O(ε).
        </p>

        <p>
          Substitute into the x-equation:
        </p>
        <pre class="eq" id="eq-xstep">dS_p^x/dt
= (J/ħ)( S_p^y B_p^z − S_p^z B_p^y )
≈ (J/ħ)( S_p^y (zS) − S ( ∑_{δ} S_{p+δ}^y ) )
= (JS/ħ)( z S_p^y − ∑_{δ} S_{p+δ}^y )</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-xstep">Copy equation (plain text)</button>
          <span class="copystatus" id="st-xstep"></span>
        </div>

        <p>
          Many texts (including the statement in your prompt) write the prefactor as <span style="font-family:var(--mono)">2JS/ħ</span>.
          This depends on the precise counting convention for pairs in <span style="font-family:var(--mono)">H</span> (whether ⟨p,q⟩ counts each bond once or twice).
          Using the prompt’s convention, the linearized equation is:
        </p>

        <pre class="eq" id="eq-xhint">dS_p^x/dt = (2JS/ħ) ( z S_p^y − ∑_{δ} S_{p+δ}^y )</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-xhint">Copy equation (plain text)</button>
          <span class="copystatus" id="st-xhint"></span>
        </div>

        <p>
          For simple cubic, <span style="font-family:var(--mono)">z=6</span>, giving exactly the hinted form:
        </p>

        <pre class="eq" id="eq-xfinal">dS_p^x/dt = (2JS/ħ) ( 6 S_p^y − ∑_{δ} S_{p+δ}^y )</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-xfinal">Copy equation (plain text)</button>
          <span class="copystatus" id="st-xfinal"></span>
        </div>

        <p>
          Similarly for the y-equation:
        </p>

        <pre class="eq" id="eq-ystep">dS_p^y/dt
= (J/ħ)( S_p^z B_p^x − S_p^x B_p^z )
≈ (J/ħ)( S ( ∑_{δ} S_{p+δ}^x ) − S_p^x (zS) )
= (JS/ħ)( ∑_{δ} S_{p+δ}^x − z S_p^x )</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-ystep">Copy equation (plain text)</button>
          <span class="copystatus" id="st-ystep"></span>
        </div>

        <p>
          With the same convention as the prompt:
        </p>
        <pre class="eq" id="eq-yfinal">dS_p^y/dt = −(2JS/ħ) ( z S_p^x − ∑_{δ} S_{p+δ}^x )
For simple cubic (z=6):
dS_p^y/dt = −(2JS/ħ) ( 6 S_p^x − ∑_{δ} S_{p+δ}^x )</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-yfinal">Copy equation (plain text)</button>
          <span class="copystatus" id="st-yfinal"></span>
        </div>

        <h3>3.4 Plane-wave solutions and lattice Fourier diagonalization</h3>
        <p>
          Because the lattice is translation invariant (with periodic/infinite boundary conditions),
          we try eigenmodes of the discrete translation operator:
        </p>

        <pre class="eq" id="eq-ansatz">S_p^x(t) = A_x exp(i(k·r_p − ωt))
S_p^y(t) = A_y exp(i(k·r_p − ωt))</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-ansatz">Copy equation (plain text)</button>
          <span class="copystatus" id="st-ansatz"></span>
        </div>

        <p>
          Then each neighbor term becomes
          <span style="font-family:var(--mono)">S_{p+δ}^{x,y}(t) = A_{x,y} exp(i(k·(r_p+δ) − ωt)) = S_p^{x,y}(t) exp(i k·δ)</span>.
          Therefore the neighbor sum simplifies:
        </p>

        <pre class="eq" id="eq-sum">∑_{δ} S_{p+δ}^{x,y}(t) = S_p^{x,y}(t) ∑_{δ} exp(i k·δ)</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-sum">Copy equation (plain text)</button>
          <span class="copystatus" id="st-sum"></span>
        </div>

        <p>
          Substitute the ansatz into the x-equation:
          <span style="font-family:var(--mono)">dS_p^x/dt = −iω S_p^x</span>.
          Using the linearized form,
        </p>

        <pre class="eq" id="eq-linsys1">−iω A_x = (2JS/ħ) Λ(k) A_y
where  Λ(k) := z − ∑_{δ} e^{ik·δ}</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-linsys1">Copy equation (plain text)</button>
          <span class="copystatus" id="st-l1"></span>
        </div>

        <p>
          Likewise from the y-equation:
        </p>

        <pre class="eq" id="eq-linsys2">−iω A_y = −(2JS/ħ) Λ(k) A_x</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-linsys2">Copy equation (plain text)</button>
          <span class="copystatus" id="st-l2"></span>
        </div>

        <p>
          Eliminate amplitudes:
        </p>

        <pre class="eq" id="eq-omega-general">ω^2 = (2JS/ħ)^2 [Λ(k)]^2
⇒ ω(k) = (2JS/ħ) Λ(k)   (take ω ≥ 0)</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-omega-general">Copy equation (plain text)</button>
          <span class="copystatus" id="st-omggen"></span>
        </div>

        <h3>3.5 Specialize to simple cubic (z = 6)</h3>
        <p>Nearest neighbors: δ = ±a x̂, ±a ŷ, ±a ẑ.</p>

        <pre class="eq" id="eq-sumsc">∑_{δ} e^{ik·δ}
= e^{ikx a} + e^{−ikx a} + e^{iky a} + e^{−iky a} + e^{ikz a} + e^{−ikz a}
= 2[ cos(kx a) + cos(ky a) + cos(kz a) ]</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-sumsc">Copy equation (plain text)</button>
          <span class="copystatus" id="st-sumsc"></span>
        </div>

        <pre class="eq" id="eq-final">Magnon dispersion (simple cubic, nearest neighbors, z=6):

ω(k) = (2JS/ħ) [ 6 − 2( cos(kx a) + cos(ky a) + cos(kz a) ) ]
     = (4JS/ħ) [ 3 − cos(kx a) − cos(ky a) − cos(kz a) ]</pre>
        <div class="eqbar">
          <button class="copy" data-copy="#eq-final">Copy final equation (plain text)</button>
          <span class="copystatus" id="st-final"></span>
        </div>

        <h3>3.6 Sanity checks</h3>
        <ul>
          <li><strong>Units:</strong> (J/ħ) has units 1/s, so ω has units rad/s. ✔</li>
          <li><strong>k=0:</strong> cos=1 ⇒ ω(0)=0. ✔</li>
          <li><strong>Small k:</strong> cos(ka)≈1−(ka)^2/2 ⇒ ω≈(2JS a^2/ħ)k^2. ✔</li>
        </ul>

        <h3>3.7 One static example plot (optional)</h3>
        <figure>
          <canvas id="plot" aria-label="Magnon dispersion plot"></canvas>
          <figcaption>
            Example slice along (100): ky=kz=0, so ω = (4JS/ħ)[1 − cos(ka)].
            Example values: J = 5 meV, S = 1/2, a = 0.3 nm (for visualization only).
          </figcaption>
        </figure>

        <div class="callout">
          <div class="label">Final answer (plain text) + copy</div>
          <pre class="eq" id="final-plain">For a nearest-neighbor Heisenberg ferromagnet on a simple cubic lattice (z=6),
linearized about S^z ≈ S and using plane-wave modes exp(i(k·r_p − ωt)):

ω(k) = (2JS/ħ) [ 6 − ∑_{δ} e^{ik·δ} ].

For simple cubic δ = ±a x̂, ±a ŷ, ±a ẑ:
∑_{δ} e^{ik·δ} = 2[cos(kx a)+cos(ky a)+cos(kz a)].

Therefore:
ω(k) = (4JS/ħ)[3 − cos(kx a) − cos(ky a) − cos(kz a)].

Small-|k| limit: ω ≈ (2JS a^2/ħ) k^2.</pre>
          <div class="eqbar">
            <button class="copy" data-copy="#final-plain">Copy final answer (plain text)</button>
            <span class="copystatus" id="st-finalplain"></span>
          </div>
        </div>
      </section>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>
        <h3>4.1 Interpreting each term</h3>
        <ul>
          <li><strong>Overall scale:</strong> <span style="font-family:var(--mono)">4JS/ħ</span>.</li>
          <li><strong>Lattice geometry:</strong> the cosine sum encodes the simple cubic neighbor structure.</li>
          <li><strong>Continuum link:</strong> near k=0 the bracket becomes <span style="font-family:var(--mono)">(a^2/2)k^2</span>, i.e., a Laplacian eigenvalue.</li>
        </ul>

        <details>
          <summary>Alternative derivation (brief): Holstein–Primakoff</summary>
          <p>
            Represent small deviations from ferromagnetic order by bosons (magnons). Fourier transform the quadratic boson Hamiltonian;
            the coefficient of the number operator gives <span style="font-family:var(--mono)">ε(k)=ħω(k)</span> with the same cosine form.
          </p>
        </details>

        <h3>Concept check (with answers)</h3>
        <ul>
          <li><strong>Q:</strong> Why does ω(0)=0? <strong>A:</strong> Uniform rotation changes no relative angles → no exchange cost.</li>
          <li><strong>Q:</strong> Why cosines? <strong>A:</strong> ±δ neighbor pairing gives <span style="font-family:var(--mono)">e^{iq}+e^{-iq}=2cos q</span>.</li>
          <li><strong>Q:</strong> Why ω∝k² at small k? <strong>A:</strong> Exchange depends on gradients; leading term is second order in k.</li>
        </ul>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide (ONLY IF A PLOT EXISTS)</h2>
        <ul>
          <li><strong>Axis:</strong> x is reduced wavevector ka (dimensionless), y is frequency f=ω/2π in THz (example values).</li>
          <li><strong>Example parameters:</strong> J = 5 meV, S = 1/2, a = 0.3 nm (only for the plotted scale).</li>
          <li><strong>Notice:</strong> quadratic near ka≈0 and saturating curvature toward ka=π (zone boundary).</li>
        </ul>
      </section>

      <footer>
        <p><a href="#top">Back to top ↑</a></p>
      </footer>
    </article>
  </main>
</div>

<script>
  // Smooth scroll
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click', (e)=>{
      const id = a.getAttribute('href');
      const el = document.querySelector(id);
      if(!el) return;
      e.preventDefault();
      el.scrollIntoView({behavior:'smooth', block:'start'});
      history.replaceState(null,'',id);
    });
  });

  // Copy buttons
  function setStatus(btn, text){
    const bar = btn.parentElement;
    const status = bar ? bar.querySelector('.copystatus') : null;
    if(status){
      status.textContent = text;
      setTimeout(()=>{ status.textContent = ''; }, 1400);
    }
  }
  document.querySelectorAll('button.copy').forEach(btn=>{
    btn.addEventListener('click', async ()=>{
      const sel = btn.getAttribute('data-copy');
      const el = document.querySelector(sel);
      if(!el) return;
      const text = el.innerText.trim();
      try{
        await navigator.clipboard.writeText(text);
        setStatus(btn, 'Copied ✔');
      }catch(err){
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        try{ document.execCommand('copy'); setStatus(btn, 'Copied ✔'); }
        catch(e2){ setStatus(btn, 'Copy failed'); }
        document.body.removeChild(ta);
      }
    });
  });

  // Static plot (example)
  (function(){
    const canvas = document.getElementById('plot');
    if(!canvas) return;
    const ctx = canvas.getContext('2d');

    function resize(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
      draw(rect.width, rect.height);
    }

    function draw(w, h){
      ctx.clearRect(0,0,w,h);

      // Example parameters
      const J_meV = 5.0;
      const S = 0.5;
      const eV = 1.602176634e-19;
      const J = (J_meV * 1e-3) * eV;
      const hbar = 1.054571817e-34;

      function omega(q){ return (4*J*S/hbar) * (1 - Math.cos(q)); } // rad/s
      function fTHz(q){ return omega(q) / (2*Math.PI) / 1e12; }

      const qMin=0, qMax=Math.PI;
      const N=500;
      const pts=[];
      let fMax=0;
      for(let i=0;i<=N;i++){
        const q=qMin+(qMax-qMin)*i/N;
        const f=fTHz(q);
        if(f>fMax) fMax=f;
        pts.push({q,f});
      }
      fMax*=1.08;

      const padL=56, padR=16, padT=18, padB=38;
      const x0=padL, y0=h-padB, x1=w-padR, y1=padT;
      const plotW=x1-x0, plotH=y0-y1;
      const xMap=q=>x0+(q-qMin)/(qMax-qMin)*plotW;
      const yMap=f=>y0-(f)/(fMax)*plotH;

      // Grid
      ctx.lineWidth=1;
      ctx.strokeStyle='rgba(255,255,255,0.10)';
      const qTicks=[0,Math.PI/4,Math.PI/2,3*Math.PI/4,Math.PI];
      qTicks.forEach(q=>{
        const x=xMap(q);
        ctx.beginPath(); ctx.moveTo(x,y0); ctx.lineTo(x,y1); ctx.stroke();
      });
      const yTicks=5;
      for(let i=0;i<=yTicks;i++){
        const f=fMax*i/yTicks;
        const y=yMap(f);
        ctx.beginPath(); ctx.moveTo(x0,y); ctx.lineTo(x1,y); ctx.stroke();
      }

      // Axes
      ctx.strokeStyle='rgba(255,255,255,0.35)';
      ctx.lineWidth=1.5;
      ctx.beginPath(); ctx.moveTo(x0,y0); ctx.lineTo(x1,y0); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(x0,y0); ctx.lineTo(x0,y1); ctx.stroke();

      // Labels
      ctx.fillStyle='rgba(232,238,246,0.9)';
      ctx.font='12px system-ui, -apple-system, Segoe UI, Roboto, Arial';
      // x ticks
      function qLabel(q){
        const eps=1e-6;
        if(Math.abs(q-0)<eps) return '0';
        if(Math.abs(q-Math.PI/4)<eps) return 'π/4';
        if(Math.abs(q-Math.PI/2)<eps) return 'π/2';
        if(Math.abs(q-3*Math.PI/4)<eps) return '3π/4';
        if(Math.abs(q-Math.PI)<eps) return 'π';
        return q.toFixed(2);
      }
      qTicks.forEach(q=>{
        const x=xMap(q);
        ctx.beginPath(); ctx.moveTo(x,y0); ctx.lineTo(x,y0+6);
        ctx.strokeStyle='rgba(255,255,255,0.35)'; ctx.stroke();
        const lab=qLabel(q);
        const tw=ctx.measureText(lab).width;
        ctx.fillText(lab, x-tw/2, y0+20);
      });
      // y ticks
      for(let i=0;i<=yTicks;i++){
        const f=fMax*i/yTicks;
        const y=yMap(f);
        ctx.beginPath(); ctx.moveTo(x0-6,y); ctx.lineTo(x0,y);
        ctx.strokeStyle='rgba(255,255,255,0.35)'; ctx.stroke();
        const lab=f.toFixed(2);
        const tw=ctx.measureText(lab).width;
        ctx.fillText(lab, x0-10-tw, y+4);
      }
      // axis labels
      ctx.fillText('k a (dimensionless)', x0+10, h-12);
      ctx.save();
      ctx.translate(14, y1+plotH/2);
      ctx.rotate(-Math.PI/2);
      ctx.fillText('f = ω/2π (THz)', 0, 0);
      ctx.restore();

      // Curve
      ctx.lineWidth=2.2;
      ctx.strokeStyle='rgba(123,220,255,0.95)';
      ctx.beginPath();
      pts.forEach((p,i)=>{
        const x=xMap(p.q), y=yMap(p.f);
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      });
      ctx.stroke();
    }

    window.addEventListener('resize', resize, {passive:true});
    resize();
  })();
</script>
</body>
</html>
