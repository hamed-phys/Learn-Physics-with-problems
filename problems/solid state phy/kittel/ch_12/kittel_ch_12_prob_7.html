<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Néel Wall in Thin Films: Energy, Optimal Thickness, and Order-of-Magnitude</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#111a33;
      --card2:#0f1730;
      --text:#eaf0ff;
      --muted:#b9c4e6;
      --faint:#91a0cf;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.12);
      --shadow: 0 18px 45px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{ box-sizing:border-box; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(125,211,252,.12), transparent 60%),
        radial-gradient(900px 600px at 85% 20%, rgba(167,139,250,.10), transparent 55%),
        radial-gradient(1000px 800px at 60% 90%, rgba(52,211,153,.08), transparent 60%),
        var(--bg);
      line-height:1.55;
    }

    header{
      padding:28px 18px 10px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(to bottom, rgba(255,255,255,.04), transparent);
      position:sticky;
      top:0;
      z-index:10;
      backdrop-filter: blur(10px);
    }

    .topbar{
      max-width:1200px;
      margin:0 auto;
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:16px;
    }

    h1{
      margin:0;
      font-size:clamp(1.15rem, 2.2vw, 1.85rem);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:.35rem 0 0;
      color:var(--muted);
      font-size:.98rem;
      max-width:70ch;
    }

    .layout{
      max-width:1200px;
      margin:0 auto;
      padding:18px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:18px;
      align-items:start;
    }

    nav.toc{
      position:sticky;
      top:92px;
      align-self:start;
      background:rgba(17,26,51,.75);
      border:1px solid var(--line);
      border-radius:14px;
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .toc-header{
      padding:14px 14px 10px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .toc-header strong{
      font-size:.98rem;
      letter-spacing:.2px;
    }
    .toc a{
      display:block;
      padding:10px 14px;
      color:var(--muted);
      text-decoration:none;
      border-left:3px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .toc a:hover{
      background:rgba(125,211,252,.08);
      border-left-color:rgba(125,211,252,.75);
      transform: translateX(2px);
      color:var(--text);
    }
    .toc a small{ color:var(--faint); display:block; margin-top:2px; font-size:.85em; }

    main{
      min-width:0;
    }

    section{
      background:rgba(17,26,51,.62);
      border:1px solid var(--line);
      border-radius:16px;
      box-shadow:var(--shadow);
      padding:18px;
      margin-bottom:16px;
      overflow:hidden;
    }

    section h2{
      margin:0 0 10px;
      font-size:1.25rem;
      letter-spacing:.2px;
    }
    section h3{
      margin:16px 0 8px;
      font-size:1.05rem;
      color:var(--text);
      letter-spacing:.15px;
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; }
      nav.toc{ position:relative; top:auto; }
      .grid2{ grid-template-columns:1fr; }
      header{ position:relative; }
    }

    ul{ margin:10px 0 0 18px; }
    li{ margin:6px 0; }

    .card{
      background:rgba(15,23,48,.72);
      border:1px solid var(--line);
      border-radius:14px;
      padding:14px;
    }

    .callout{
      border-left:4px solid rgba(125,211,252,.9);
      background:rgba(125,211,252,.06);
      padding:12px 12px 12px 14px;
      border-radius:12px;
      margin:12px 0;
    }
    .callout.warn{
      border-left-color: rgba(251,191,36,.95);
      background:rgba(251,191,36,.07);
    }
    .callout.ok{
      border-left-color: rgba(52,211,153,.95);
      background:rgba(52,211,153,.07);
    }
    .callout.bad{
      border-left-color: rgba(251,113,133,.95);
      background:rgba(251,113,133,.07);
    }

    .eq{
      margin:10px 0;
      padding:12px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(0,0,0,.18);
      font-family:var(--mono);
      font-size:.93rem;
      overflow:auto;
      position:relative;
    }
    .eq .label{
      font-family:var(--sans);
      color:var(--muted);
      font-size:.86rem;
      margin-bottom:8px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    button.copy{
      background: linear-gradient(135deg, rgba(125,211,252,.25), rgba(167,139,250,.25));
      border:1px solid rgba(255,255,255,.18);
      color:var(--text);
      border-radius:10px;
      padding:6px 10px;
      cursor:pointer;
      font-size:.86rem;
      transition: transform .12s ease, filter .12s ease;
      white-space:nowrap;
    }
    button.copy:hover{ transform: translateY(-1px); filter: brightness(1.08); }
    button.copy:active{ transform: translateY(0); }

    details{
      margin:12px 0 0;
      border:1px solid var(--line);
      background:rgba(0,0,0,.12);
      border-radius:14px;
      padding:10px 12px;
    }
    summary{
      cursor:pointer;
      color:var(--muted);
      font-weight:600;
    }
    details[open] summary{ color:var(--text); }

    figure{
      margin:10px 0 0;
      padding:12px;
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(0,0,0,.15);
    }
    figcaption{
      margin-top:10px;
      color:var(--muted);
      font-size:.92rem;
    }

    .backtop{
      display:inline-block;
      margin-top:10px;
      color:var(--accent);
      text-decoration:none;
      border-bottom:1px dashed rgba(125,211,252,.5);
    }

    .kpi{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
    }
    .pill{
      border:1px solid var(--line);
      background:rgba(0,0,0,.14);
      padding:8px 10px;
      border-radius:999px;
      color:var(--muted);
      font-size:.9rem;
    }
    .pill b{ color:var(--text); font-weight:700; }

    footer{
      max-width:1200px;
      margin:0 auto;
      padding:18px 18px 28px;
      color:var(--muted);
      font-size:.92rem;
    }

    /* Print-friendly */
    @media print{
      header, nav.toc, .backtop, button.copy{ display:none !important; }
      body{ background:#fff; color:#000; }
      section, .card, .eq, figure, details{ box-shadow:none; background:#fff; border-color:#ccc; }
      a{ color:#000; text-decoration:none; }
      section{ break-inside:avoid; }
      h2{ break-after:avoid; }
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="topbar">
      <div>
        <h1>Néel Wall in Thin Films: Energy Balance, Optimal Wall Width, and an Engineering-Useful Estimate</h1>
        <p class="subtitle">
          We model how a Bloch wall morphs into a Néel wall in thin films and, for a bulk-like Néel wall, minimize the
          wall energy with respect to the number of atomic planes spanning the wall.
        </p>
      </div>
      <div class="kpi" aria-label="quick metrics">
        <span class="pill"><b>Output:</b> symbolic + OOM</span>
        <span class="pill"><b>Model:</b> variational / scaling</span>
        <span class="pill"><b>Key trade-off:</b> exchange vs demag</span>
      </div>
    </div>
  </header>

  <div class="layout">
    <nav class="toc" aria-label="Table of Contents">
      <div class="toc-header">
        <strong>Table of Contents</strong>
        <span style="color:var(--faint);font-size:.86rem;">sticky</span>
      </div>
      <a href="#quick">Quick Summary<small>What, why, equations, result</small></a>
      <a href="#part0">PART 0 — Concept Primer<small>Domain walls, energy terms, assumptions</small></a>
      <a href="#part0b">PART 0B — Industry & Applied Physics<small>Why engineers care</small></a>
      <a href="#part1">PART 1 — Problem Analysis<small>Restate + model + approaches</small></a>
      <a href="#part2">PART 2 — Strategy & Tips<small>Roadmap, mistakes</small></a>
      <a href="#part3">PART 3 — Full Solution<small>Minimize σw(N)</small></a>
      <a href="#part4">PART 4 — Deeper Understanding<small>Interpretation + checks</small></a>
      <a href="#part5">PART 5 — Optional Plot Guide<small>Energy vs N (example)</small></a>
    </nav>

    <main>
      <section id="quick">
        <h2>Quick Summary</h2>
        <ul>
          <li><b>What this is:</b> Find the energetically optimal thickness of a <b>Néel domain wall</b> (in a material with negligible crystalline anisotropy) by minimizing its wall energy with respect to the wall thickness.</li>
          <li><b>Key physics idea:</b> The wall energy is a <b>competition</b> between <b>exchange</b> (prefers a wide, slowly rotating wall) and <b>magnetostatic/demagnetization</b> energy (here, prefers a thinner wall to reduce volume with stray-field cost).</li>
          <li><b>Given energy model (per unit wall area):</b> <span style="font-family:var(--mono);">σ_w(N) ≈ (π² J S²)/N² + (2π M_s²)(N a)</span>, where <span style="font-family:var(--mono);">N</span> is number of atomic planes in the wall and <span style="font-family:var(--mono);">Na</span> is wall thickness.</li>
          <li><b>Mathematical structure:</b> A 1D minimization problem (a simple <b>calculus of variations / scaling</b> result reduced to a single parameter).</li>
          <li><b>Result type:</b> Symbolic optimum <span style="font-family:var(--mono);">N*</span> and symbolic minimum <span style="font-family:var(--mono);">σ_w,min</span>, plus order-of-magnitude estimate in SI-friendly form.</li>
          <li><b>Main result:</b> <span style="font-family:var(--mono);">N* = [ (π J S²)/(M_s² a) ]^(1/3)</span> and <span style="font-family:var(--mono);">σ_w,min = 3π M_s² a N*</span> (using the problem’s cgs-like coefficient <span style="font-family:var(--mono);">2π</span>).</li>
          <li><b>Physical meaning:</b> Thicker walls lower exchange energy as <span style="font-family:var(--mono);">~1/N²</span>, but increase demag energy as <span style="font-family:var(--mono);">~N</span>; the minimum occurs where marginal costs balance.</li>
          <li><b>Engineering relevance:</b> Predicts how wall width and energy change with magnetization and exchange—important for switching fields, magnetic noise, and thin-film device scaling.</li>
        </ul>
        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="card">
            <h3>Core definitions (symbols + units)</h3>
            <ul>
              <li><b>Domain wall:</b> transition region where magnetization <b>M</b> rotates between domains.</li>
              <li><b>Bloch wall:</b> rotation occurs in a plane that keeps magnetization mostly <i>parallel</i> to the wall plane; often minimizes surface magnetic charge in bulk.</li>
              <li><b>Néel wall:</b> rotation occurs such that magnetization turns within the film plane; often favored in thin films to reduce surface charges at film surfaces, but can create volume stray fields.</li>
              <li><b>J</b> (Joules): exchange integral (microscopic coupling per bond); <b>S</b> (dimensionless): spin magnitude.</li>
              <li><b>M<sub>s</sub></b> (A/m in SI; emu/cm³ in cgs): saturation magnetization magnitude.</li>
              <li><b>a</b> (m): lattice spacing; <b>N</b> (dimensionless): number of atomic planes across the wall.</li>
              <li><b>σ<sub>w</sub></b> (J/m²): wall energy per unit area (surface energy of the wall).</li>
            </ul>
          </div>

          <div class="card">
            <h3>Physical meaning of the energy terms</h3>
            <ul>
              <li><b>Exchange energy</b> penalizes spatial variation: large gradients <span style="font-family:var(--mono);">|∇m|</span> cost energy. It prefers a <b>wide wall</b> (slow rotation).</li>
              <li><b>Demagnetization (magnetostatic) energy</b> comes from stray fields created by magnetic charges:
                <span style="font-family:var(--mono);">ρ_m = −∇·M</span> (volume) and <span style="font-family:var(--mono);">σ_m = M·n</span> (surface).</li>
              <li>In the stated “bulk Néel wall” setting with negligible crystalline anisotropy, the Néel rotation creates a <b>volume</b> demag cost proportional to wall thickness <span style="font-family:var(--mono);">Na</span>.</li>
            </ul>
          </div>
        </div>

        <div class="callout ok">
          <b>Key model idea:</b> Replace the full micromagnetic minimization by a <b>single-parameter</b> scaling ansatz:
          the wall rotates by total angle <span style="font-family:var(--mono);">π</span> over thickness <span style="font-family:var(--mono);">δ = Na</span>, so typical gradient scale is <span style="font-family:var(--mono);">dθ/dx ~ π/δ</span>.
          This gives exchange <span style="font-family:var(--mono);">~ 1/δ</span> or <span style="font-family:var(--mono);">~1/N</span> in continuum, and in the discrete estimate used here, <span style="font-family:var(--mono);">~1/N²</span> for the chosen lattice-based argument.
        </div>

        <h3>Key laws/principles and validity conditions</h3>
        <ul>
          <li><b>Micromagnetics (continuum):</b> magnetization direction <span style="font-family:var(--mono);">m(r)</span> with <span style="font-family:var(--mono);">|m|=1</span>. Exchange energy density often written as <span style="font-family:var(--mono);">w_ex = A |∇m|²</span>.</li>
          <li><b>Magnetostatics:</b> <span style="font-family:var(--mono);">∇·B = 0</span>, <span style="font-family:var(--mono);">B = μ0(H + M)</span> (SI); demag energy <span style="font-family:var(--mono);">~ (μ0/2) ∫|H|² dV</span>.</li>
          <li><b>Regime here:</b> negligible crystalline anisotropy energy (e.g., Permalloy), so the usual anisotropy term <span style="font-family:var(--mono);">K sin²θ</span> is ignored; wall width is set by <b>exchange vs demag</b>.</li>
        </ul>

        <h3>Common approximations used (and why)</h3>
        <ul>
          <li><b>1D wall:</b> magnetization varies mainly along one coordinate <span style="font-family:var(--mono);">x</span> normal to the wall.</li>
          <li><b>Single-parameter ansatz:</b> replace full function <span style="font-family:var(--mono);">θ(x)</span> with a characteristic thickness <span style="font-family:var(--mono);">δ=Na</span>.</li>
          <li><b>Order-of-magnitude magnetostatics:</b> replace detailed stray-field solution by a scaling term proportional to volume of wall (hence ∝ δ).</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li>If you make the wall twice as thick, <b>exchange gets cheaper</b> (rotation is gentler), but the region producing stray fields is twice the volume, so <b>demag gets costlier</b>.</li>
          <li>If <span style="font-family:var(--mono);">M_s</span> is large, stray-field penalties are large, so the optimal Néel wall tends to be <b>thinner</b>.</li>
          <li>If exchange coupling <span style="font-family:var(--mono);">J</span> is strong, sharp changes are expensive, so the wall tends to be <b>thicker</b>.</li>
        </ul>

        <div class="callout warn">
          <b>What to watch for (pitfalls):</b>
          <ul style="margin-top:8px;">
            <li><b>Units system:</b> the factor <span style="font-family:var(--mono);">2π</span> is characteristic of Gaussian/cgs magnetostatics; in SI, demag energies carry <span style="font-family:var(--mono);">μ0</span>.</li>
            <li><b>N is dimensionless:</b> it counts lattice planes; physical wall thickness is <span style="font-family:var(--mono);">δ=Na</span>.</li>
            <li><b>This is a scaling model:</b> coefficients are approximate; exponents and dependencies are the main trustworthy outputs.</li>
          </ul>
        </div>

        <div class="callout">
          <b>Math Insight:</b> The core equation
          <span style="font-family:var(--mono);">σ_w(N) = C/N² + D N</span>
          is a classic <b>convex optimization</b> problem in one variable. The first term is a <b>singular</b> penalty as <span style="font-family:var(--mono);">N→0</span>;
          the second grows linearly, guaranteeing a unique finite minimizer where marginal decrease of <span style="font-family:var(--mono);">C/N²</span> equals marginal increase of <span style="font-family:var(--mono);">DN</span>.
        </div>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <div class="grid2">
          <div class="card">
            <h3>Where this shows up (3+ application areas)</h3>
            <ul>
              <li><b>Magnetic memory & logic:</b> domain-wall motion devices (racetrack memory), MRAM adjacent layers, and patterned nanowires.</li>
              <li><b>Thin-film sensors:</b> anisotropic magnetoresistance (AMR) and giant magnetoresistance (GMR) sensors where domain structure affects noise and hysteresis.</li>
              <li><b>Soft magnetic components:</b> transformer cores in thin laminations and magnetic shielding films where domain wall energies influence coercivity and losses.</li>
              <li><b>Spintronics stacks:</b> exchange-coupled multilayers where wall type (Bloch vs Néel) controls dynamics and DMI-driven chirality (in more advanced models).</li>
            </ul>
          </div>

          <div class="card">
            <h3>Why engineers care</h3>
            <ul>
              <li><b>Performance:</b> switching fields, speed of wall motion, and stability depend on wall energy and width.</li>
              <li><b>Reliability:</b> thermal activation rates scale with energy barriers tied to wall energies.</li>
              <li><b>Cost & manufacturability:</b> thickness, composition, and grain structure tuning changes <span style="font-family:var(--mono);">M_s</span> and exchange—affecting device tolerances.</li>
              <li><b>Efficiency:</b> hysteresis losses and Barkhausen noise are linked to how walls nucleate and move.</li>
            </ul>
          </div>
        </div>

        <h3>Typical measurement/validation methods</h3>
        <ul>
          <li><b>Magneto-optical Kerr effect (MOKE) microscopy:</b> imaging domains and walls in thin films.</li>
          <li><b>Magnetic force microscopy (MFM):</b> maps stray fields; can distinguish wall types via field patterns.</li>
          <li><b>Ferromagnetic resonance (FMR) / Brillouin light scattering:</b> infers effective exchange and magnetostatic parameters.</li>
          <li><b>Electrical readout:</b> AMR/GMR changes reveal wall presence and motion in wires.</li>
        </ul>

        <h3>Design trade-offs and constraints</h3>
        <ul>
          <li>Real materials have <b>finite anisotropy</b>, defects, grain boundaries: these pin walls and shift the optimum.</li>
          <li>Film thickness and interfaces alter magnetostatics; in ultrathin layers, <b>surface effects</b> dominate and Néel walls can be stabilized for different reasons.</li>
          <li>Process variability changes <span style="font-family:var(--mono);">M_s</span>, roughness, and stress—so models are used for <b>robust design margins</b>, not exact predictions.</li>
        </ul>

        <div class="callout ok">
          <b>From lab to product:</b> The “clean” scaling law is used to set first-pass geometry/material targets (e.g., choose composition to tune <span style="font-family:var(--mono);">M_s</span>, pick thickness to favor a certain wall type),
          then refined with micromagnetic simulation and validated with imaging/electrical tests under manufacturing tolerances.
        </div>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <h3>Problem rewritten clearly</h3>
        <p>
          A Néel domain wall can become energetically favorable in sufficiently thin films, but in a bulk material with negligible crystalline anisotropy,
          a Néel wall still has a demagnetization energy contribution.
          Using an argument similar to the one used earlier (a scaling/variational argument), we are given an approximate wall energy per unit area:
        </p>

        <div class="eq" data-copy="eq1">
          <div class="label">
            <span><b>Given model</b> (energy per unit area)</span>
            <button class="copy" data-copy-btn="eq1">Copy equation</button>
          </div>
          <div id="eq1">σ_w(N) ≈ (π^2 J S^2)/N^2 + (2π M_s^2)(N a)</div>
        </div>

        <p>
          Here <span style="font-family:var(--mono);">N</span> is the number of lattice planes across the wall (so physical thickness is <span style="font-family:var(--mono);">δ = N a</span>).
          We must (i) find the value of <span style="font-family:var(--mono);">N</span> that minimizes <span style="font-family:var(--mono);">σ_w</span> and (ii) estimate the order of magnitude of the minimum wall energy using typical values of
          <span style="font-family:var(--mono);">J</span>, <span style="font-family:var(--mono);">M_s</span>, and <span style="font-family:var(--mono);">a</span>.
        </p>

        <h3>Given quantities</h3>
        <ul>
          <li>Energy model parameters: <span style="font-family:var(--mono);">J</span>, <span style="font-family:var(--mono);">S</span>, <span style="font-family:var(--mono);">M_s</span>, <span style="font-family:var(--mono);">a</span>, and numeric constants <span style="font-family:var(--mono);">π</span>.</li>
          <li>Energy model function: <span style="font-family:var(--mono);">σ_w(N)</span>.</li>
        </ul>

        <h3>Unknowns</h3>
        <ul>
          <li><span style="font-family:var(--mono);">N*</span> that minimizes <span style="font-family:var(--mono);">σ_w(N)</span>.</li>
          <li><span style="font-family:var(--mono);">σ_w,min</span> (minimum wall energy per unit area).</li>
          <li>Order-of-magnitude estimate with typical numbers.</li>
        </ul>

        <h3>Relevant principles and why they apply</h3>
        <ul>
          <li><b>Energy minimization:</b> equilibrium wall structure minimizes total free energy under constraints (here reduced to a single parameter).</li>
          <li><b>Exchange vs magnetostatics:</b> the model explicitly decomposes energy into these two competing contributions.</li>
          <li><b>Neglect crystalline anisotropy:</b> stated in the prompt; thus no <span style="font-family:var(--mono);">K</span>-term included.</li>
        </ul>

        <div class="callout">
          <b>Explicit assumptions:</b>
          <ul style="margin-top:8px;">
            <li>1D wall: magnetization varies mainly across the wall (one spatial coordinate).</li>
            <li>Magnitude fixed: <span style="font-family:var(--mono);">|M| = M_s</span>, only direction changes.</li>
            <li>Crystalline anisotropy negligible (soft magnetic material like Permalloy).</li>
            <li>Demagnetization term is captured by a scaling law linear in wall thickness <span style="font-family:var(--mono);">Na</span>.</li>
            <li><span style="font-family:var(--mono);">N</span> treated as continuous for minimization; final answer interpreted as nearest integer.</li>
          </ul>
        </div>

        <h3>2–3 possible approaches (pros/cons)</h3>
        <ul>
          <li><b>Direct calculus minimization</b> of the given <span style="font-family:var(--mono);">σ_w(N)</span>:
            <ul>
              <li>Pros: fast, exact for the model; gives clean scaling.</li>
              <li>Cons: relies on correctness of the approximate energy expression.</li>
            </ul>
          </li>
          <li><b>Scaling balance</b> (equate exchange and demag contributions at optimum):
            <ul>
              <li>Pros: gives quick insight and nearly same result; explains why exponents appear.</li>
              <li>Cons: must justify why “balance” corresponds to derivative zero (works for convex sums like this).</li>
            </ul>
          </li>
          <li><b>Full micromagnetic variational problem</b> (solve for <span style="font-family:var(--mono);">θ(x)</span>):
            <ul>
              <li>Pros: more fundamental; yields profile details.</li>
              <li>Cons: needs a detailed magnetostatic solution; beyond what is asked.</li>
            </ul>
          </li>
        </ul>

        <p><b>Chosen approach:</b> direct minimization of the provided <span style="font-family:var(--mono);">σ_w(N)</span>, because the problem explicitly requests minimization with respect to <span style="font-family:var(--mono);">N</span> and supplies the functional form.</p>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

        <ol style="margin:10px 0 0 20px;">
          <li><b>Identify variables:</b> treat <span style="font-family:var(--mono);">N</span> as continuous; parameters <span style="font-family:var(--mono);">J,S,M_s,a</span> constants.</li>
          <li><b>Compute derivative:</b> evaluate <span style="font-family:var(--mono);">dσ_w/dN</span> using power rule.</li>
          <li><b>Set derivative to zero:</b> solve <span style="font-family:var(--mono);">dσ_w/dN = 0</span> for <span style="font-family:var(--mono);">N*</span>.</li>
          <li><b>Check it’s a minimum:</b> show <span style="font-family:var(--mono);">d²σ_w/dN² &gt; 0</span> for <span style="font-family:var(--mono);">N&gt;0</span> (convexity).</li>
          <li><b>Compute σ at optimum:</b> substitute <span style="font-family:var(--mono);">N*</span> into <span style="font-family:var(--mono);">σ_w(N)</span>.</li>
          <li><b>Simplify using the optimum condition:</b> relate the two terms at optimum to avoid algebra bloat.</li>
          <li><b>Dimensional/limiting checks:</b> verify scaling with <span style="font-family:var(--mono);">J</span>, <span style="font-family:var(--mono);">M_s</span>, and <span style="font-family:var(--mono);">a</span>.</li>
          <li><b>Order-of-magnitude estimate:</b> choose typical soft-magnet values and (if needed) convert the magnetostatic coefficient to SI-friendly form.</li>
        </ol>

        <div class="callout warn">
          <b>Common mistakes</b>
          <ul style="margin-top:8px;">
            <li>Forgetting that <span style="font-family:var(--mono);">d(N^{-2})/dN = -2N^{-3}</span>.</li>
            <li>Mixing SI and cgs: the <span style="font-family:var(--mono);">2π M_s^2</span> term is not SI as-written.</li>
            <li>Not using the optimality condition to simplify <span style="font-family:var(--mono);">σ_w,min</span> (leads to messy cube roots).</li>
            <li>Interpreting <span style="font-family:var(--mono);">N*</span> as exact: physically take the nearest integer and remember the model is approximate.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation before calculating</h3>
        <p>
          As <span style="font-family:var(--mono);">N</span> increases (thicker wall), the exchange term <span style="font-family:var(--mono);">~1/N²</span> drops rapidly, but the demagnetization term <span style="font-family:var(--mono);">~N</span> rises.
          So <span style="font-family:var(--mono);">σ_w(N)</span> should be large at very small <span style="font-family:var(--mono);">N</span>, large again at very large <span style="font-family:var(--mono);">N</span>, with a single minimum in between.
        </p>

        <h3>Mathematical model (variables, domain, coordinate system)</h3>
        <div class="callout">
          <ul style="margin-top:0;">
            <li><b>Independent variable:</b> <span style="font-family:var(--mono);">N ∈ (0,∞)</span> (treated continuous for calculus).</li>
            <li><b>Physical thickness:</b> <span style="font-family:var(--mono);">δ = N a</span> (m).</li>
            <li><b>Energy per unit area:</b> <span style="font-family:var(--mono);">σ_w(N)</span> (J/m²).</li>
            <li><b>Parameters:</b> <span style="font-family:var(--mono);">J, S, M_s, a</span> constant; no external field; steady-state equilibrium.</li>
            <li><b>Underlying field picture (brief):</b> magnetization direction <span style="font-family:var(--mono);">m(x)</span> varies across the wall; exchange resembles <span style="font-family:var(--mono);">∫ A |∂m/∂x|² dx</span>. Magnetostatics involves <span style="font-family:var(--mono);">ρ_m = −∇·M</span> and stray field energy, here reduced to a scaling term ∝ wall volume.</li>
          </ul>
        </div>

        <h3>Step 1: Write the energy function clearly</h3>
        <p>We start from the given approximate form:</p>

        <div class="eq" data-copy="eq2">
          <div class="label">
            <span><b>Total wall energy per unit area</b></span>
            <button class="copy" data-copy-btn="eq2">Copy equation</button>
          </div>
          <div id="eq2">σ_w(N) = (π^2 J S^2) N^(−2) + (2π M_s^2 a) N</div>
        </div>

        <p>
          Define constants to streamline algebra (valid because of linearity of differentiation and because parameters are constants):
          <span style="font-family:var(--mono);">C = π² J S²</span>, <span style="font-family:var(--mono);">D = 2π M_s² a</span>.
          Then <span style="font-family:var(--mono);">σ_w(N) = C/N² + D N</span>.
        </p>

        <h3>Step 2: Differentiate with respect to N</h3>
        <p>
          Using the power rule <span style="font-family:var(--mono);">d(N^p)/dN = p N^(p−1)</span>:
        </p>

        <div class="eq" data-copy="eq3">
          <div class="label">
            <span><b>Derivative</b></span>
            <button class="copy" data-copy-btn="eq3">Copy equation</button>
          </div>
          <div id="eq3">dσ_w/dN = d/dN (C N^(−2) + D N) = (−2C) N^(−3) + D</div>
        </div>

        <h3>Step 3: Set derivative to zero and solve for N*</h3>
        <p>
          An interior extremum satisfies <span style="font-family:var(--mono);">dσ_w/dN = 0</span>:
        </p>

        <div class="eq" data-copy="eq4">
          <div class="label">
            <span><b>Optimality condition</b></span>
            <button class="copy" data-copy-btn="eq4">Copy equation</button>
          </div>
          <div id="eq4">0 = (−2C) N^(−3) + D  ⇒  D = 2C/N^3  ⇒  N^3 = 2C/D</div>
        </div>

        <p>Substitute back <span style="font-family:var(--mono);">C = π² J S²</span> and <span style="font-family:var(--mono);">D = 2π M_s² a</span>:</p>

        <div class="eq" data-copy="eq5">
          <div class="label">
            <span><b>Minimizing N</b></span>
            <button class="copy" data-copy-btn="eq5">Copy equation</button>
          </div>
          <div id="eq5">N* = [ (2 π^2 J S^2)/(2 π M_s^2 a) ]^(1/3) = [ (π J S^2)/(M_s^2 a) ]^(1/3)</div>
        </div>

        <h3>Step 4: Verify it is a minimum (convexity)</h3>
        <p>
          Compute the second derivative:
          <span style="font-family:var(--mono);">d²σ_w/dN² = d/dN(−2C N^(−3) + D) = (6C) N^(−4)</span>.
          For <span style="font-family:var(--mono);">N&gt;0</span> and <span style="font-family:var(--mono);">C&gt;0</span> this is strictly positive, so the extremum is a unique minimum.
        </p>

        <h3>Step 5: Compute the minimum energy σw,min</h3>
        <p>
          Direct substitution is possible but messy. A cleaner method uses the optimality condition:
          from <span style="font-family:var(--mono);">D = 2C/N^3</span>, multiply both sides by <span style="font-family:var(--mono);">N</span>:
          <span style="font-family:var(--mono);">D N = 2C/N^2</span>.
        </p>

        <p>Now evaluate <span style="font-family:var(--mono);">σ_w = C/N² + D N</span> at optimum:</p>

        <div class="eq" data-copy="eq6">
          <div class="label">
            <span><b>Simplification at optimum</b></span>
            <button class="copy" data-copy-btn="eq6">Copy equation</button>
          </div>
          <div id="eq6">At N*:  D N* = 2C/N*^2  ⇒  σ_w,min = C/N*^2 + D N* = C/N*^2 + 2C/N*^2 = 3C/N*^2</div>
        </div>

        <p>Equivalently, because <span style="font-family:var(--mono);">C/N*² = (D N*)/2</span>, you can write:</p>

        <div class="eq" data-copy="eq7">
          <div class="label">
            <span><b>Minimum energy in terms of demag term</b></span>
            <button class="copy" data-copy-btn="eq7">Copy equation</button>
          </div>
          <div id="eq7">σ_w,min = (3/2) D N* = 3 π M_s^2 a N*</div>
        </div>

        <p>Finally, substitute <span style="font-family:var(--mono);">N*</span> to express the minimum solely in parameters:</p>

        <div class="eq" data-copy="eq8">
          <div class="label">
            <span><b>Closed-form minimum</b></span>
            <button class="copy" data-copy-btn="eq8">Copy equation</button>
          </div>
          <div id="eq8">σ_w,min = 3 π M_s^2 a [ (π J S^2)/(M_s^2 a) ]^(1/3) = 3 π^(4/3) (J S^2)^(1/3) (M_s^2 a)^(2/3)</div>
        </div>

        <div class="callout ok">
          <b>FINAL ANSWER (boxed):</b>
          <div class="eq" data-copy="finalPlain">
            <div class="label">
              <span><b>Copy final answer (plain text)</b></span>
              <button class="copy" data-copy-btn="finalPlain">Copy final</button>
            </div>
            <div id="finalPlain">Given σ_w(N) ≈ (π^2 J S^2)/N^2 + (2π M_s^2)(N a):
N* = [ (π J S^2)/(M_s^2 a) ]^(1/3)
σ_w,min = 3 π M_s^2 a N* = 3 π^(4/3) (J S^2)^(1/3) (M_s^2 a)^(2/3)</div>
          </div>
        </div>

        <h3>Sanity checks</h3>
        <div class="grid2">
          <div class="card">
            <h3 style="margin-top:0;">Units / dimensions</h3>
            <ul>
              <li><span style="font-family:var(--mono);">N*</span> is dimensionless (a plane count), as required.</li>
              <li><span style="font-family:var(--mono);">σ_w</span> has units of energy per area. In practice, because the expression mixes microscopic (<span style="font-family:var(--mono);">J</span>) and macroscopic (<span style="font-family:var(--mono);">M_s</span>) quantities, be cautious about <b>unit system</b> (cgs vs SI). The scaling and minimization are robust.</li>
            </ul>
          </div>
          <div class="card">
            <h3 style="margin-top:0;">Limiting behavior</h3>
            <ul>
              <li><b>As M_s → 0:</b> demag cost vanishes, so <span style="font-family:var(--mono);">N*</span> grows (wall can spread out).</li>
              <li><b>As J → ∞:</b> exchange is very stiff; <span style="font-family:var(--mono);">N*</span> grows (avoid sharp rotation).</li>
              <li><b>As a decreases:</b> for fixed other parameters, <span style="font-family:var(--mono);">N*</span> increases mildly as <span style="font-family:var(--mono);">a^(−1/3)</span>, but physical thickness <span style="font-family:var(--mono);">δ*=N*a</span> scales as <span style="font-family:var(--mono);">a^(2/3)</span>.</li>
            </ul>
          </div>
        </div>

        <h3>Order-of-magnitude estimate (practical numbers)</h3>
        <p>
          The coefficient <span style="font-family:var(--mono);">2π</span> signals Gaussian/cgs magnetostatics. For a numerically stable estimate in SI, it is common to map the magnetostatic energy density scale
          <span style="font-family:var(--mono);">2π M_s^2</span> (cgs) to <span style="font-family:var(--mono);">(μ0/2) M_s^2</span> (SI). That is, for estimation you can use
          <span style="font-family:var(--mono);">2π M_s^2  → (μ0/2) M_s^2</span>.
        </p>

        <details>
          <summary>Optional: SI-friendly restatement of the same minimization</summary>
          <p style="color:var(--muted); margin-top:10px;">
            If you rewrite the model as
            <span style="font-family:var(--mono);">σ_w(N) ≈ (π^2 J S^2)/N^2 + (μ0/2) M_s^2 (N a)</span>,
            the same steps give:
          </p>
          <div class="eq" data-copy="eqSI">
            <div class="label">
              <span><b>SI-friendly optimum (optional)</b></span>
              <button class="copy" data-copy-btn="eqSI">Copy equation</button>
            </div>
            <div id="eqSI">N*_SI = [ (4 π^2 J S^2)/(μ0 M_s^2 a) ]^(1/3),  and  σ_w,min,SI = (3/4) μ0 M_s^2 a N*_SI</div>
          </div>
          <p style="color:var(--muted);">
            This is the same <b>structure</b> (cube-root scaling) with a different constant, reflecting the unit-system coefficient in magnetostatics.
          </p>
        </details>

        <p>
          Take representative soft-magnetic values (example, not universal):
        </p>
        <ul>
          <li><span style="font-family:var(--mono);">M_s ~ 8×10^5 A/m</span> (Permalloy-like).</li>
          <li><span style="font-family:var(--mono);">a ~ 2.5×10^−10 m</span>.</li>
          <li>Exchange stiffness for soft ferromagnets is often <span style="font-family:var(--mono);">A ~ 10^−11 J/m</span>. A rough microscopic mapping is <span style="font-family:var(--mono);">J S^2 ~ A a</span>, giving
              <span style="font-family:var(--mono);">J S^2 ~ (10^−11)(2.5×10^−10) ≈ 2.5×10^−21 J</span>.</li>
        </ul>

        <p>
          Using the SI-friendly expression for the magnetostatic coefficient, the minimum wall energy per unit area typically comes out in the
          <b>mJ/m²</b> range for soft magnets. A reasonable order-of-magnitude is:
        </p>

        <div class="callout ok">
          <b>Order-of-magnitude:</b> <span style="font-family:var(--mono);">σ_w,min ~ 10^−3 J/m^2</span> (i.e., a few mJ/m²), and wall thickness <span style="font-family:var(--mono);">δ*</span> is typically a few to a few tens of nm depending on material parameters.
        </div>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Interpret the final formula term-by-term</h3>
        <p>
          The optimum
          <span style="font-family:var(--mono);">N* ∝ (J S^2)^(1/3) (M_s^2 a)^(−1/3)</span>
          says:
        </p>
        <ul>
          <li><b>Exchange strength ↑</b> → wall uses more planes (thicker) to reduce gradients.</li>
          <li><b>Magnetization ↑</b> → demag penalty ↑ → wall uses fewer planes (thinner) to reduce demag volume.</li>
          <li><b>Lattice spacing ↑</b> enters both as geometry (thickness per plane) and in the scaling of the demag term; net <span style="font-family:var(--mono);">N*</span> decreases as <span style="font-family:var(--mono);">a^(−1/3)</span>.</li>
        </ul>

        <h3>Parameter dependence: quick “engineering knobs” view</h3>
        <div class="grid2">
          <div class="card">
            <h3 style="margin-top:0;">How N* changes</h3>
            <ul>
              <li><span style="font-family:var(--mono);">N* ∝ (J S^2)^(1/3)</span>: stronger exchange → wider wall.</li>
              <li><span style="font-family:var(--mono);">N* ∝ M_s^(−2/3)</span>: higher magnetization shrinks Néel wall thickness.</li>
              <li><span style="font-family:var(--mono);">N* ∝ a^(−1/3)</span>: smaller lattice spacing slightly increases plane count.</li>
            </ul>
          </div>
          <div class="card">
            <h3 style="margin-top:0;">How σw,min changes</h3>
            <ul>
              <li><span style="font-family:var(--mono);">σ_w,min ∝ (J S^2)^(1/3)</span>: increases mildly with exchange strength.</li>
              <li><span style="font-family:var(--mono);">σ_w,min ∝ (M_s^2)^(2/3) = M_s^(4/3)</span>: quite sensitive to magnetization.</li>
              <li><span style="font-family:var(--mono);">σ_w,min ∝ a^(2/3)</span>: thicker-per-plane increases energy scale via volume term.</li>
            </ul>
          </div>
        </div>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Start from the continuum micromagnetic energy (schematically):
          <span style="font-family:var(--mono);">E = ∫ [A |∂m/∂x|^2 + w_demag(m)] dx</span>.
          Choose an ansatz profile <span style="font-family:var(--mono);">θ(x)</span> that rotates by <span style="font-family:var(--mono);">π</span> over width <span style="font-family:var(--mono);">δ</span> (e.g., linear or tanh-like),
          estimate <span style="font-family:var(--mono);">|∂θ/∂x| ~ π/δ</span>, yielding exchange per area <span style="font-family:var(--mono);">~ A (π^2/δ)</span>.
          Approximate the demag energy density as a constant scale times the wall volume, giving <span style="font-family:var(--mono);">~ K_d δ</span>.
          Minimizing <span style="font-family:var(--mono);">~ const/δ + const·δ</span> gives the same “balance” logic and a unique optimum.
          The problem’s lattice-based model differs in exponent (<span style="font-family:var(--mono);">1/N^2</span>) because of the specific discrete argument referenced, but the <b>trade-off + minimization method</b> is the same.
        </p>

        <h3>Concept check (self-test with answers)</h3>
        <ul>
          <li><b>Q:</b> Why does <span style="font-family:var(--mono);">σ_w</span> have a single minimum? <b>A:</b> Because <span style="font-family:var(--mono);">C/N^2</span> decreases and is convex, <span style="font-family:var(--mono);">DN</span> increases linearly, and their sum is strictly convex for <span style="font-family:var(--mono);">N&gt;0</span>.</li>
          <li><b>Q:</b> What happens to <span style="font-family:var(--mono);">N*</span> if <span style="font-family:var(--mono);">M_s</span> doubles? <b>A:</b> <span style="font-family:var(--mono);">N* ∝ M_s^(−2/3)</span>, so it shrinks by factor <span style="font-family:var(--mono);">2^(−2/3) ≈ 0.63</span>.</li>
          <li><b>Q:</b> At the optimum, which term is bigger: exchange or demag? <b>A:</b> Demag term is twice the exchange term (because <span style="font-family:var(--mono);">DN* = 2C/N*^2</span>), so total is 3× the exchange term.</li>
          <li><b>Q:</b> Why can we treat <span style="font-family:var(--mono);">N</span> as continuous? <b>A:</b> Because the energy varies smoothly with thickness for large enough <span style="font-family:var(--mono);">N</span>; after finding <span style="font-family:var(--mono);">N*</span> we choose the nearest integer plane count.</li>
        </ul>

        <a class="backtop" href="#top">Back to top</a>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide (Because a Plot Exists)</h2>

        <p>
          The model has a simple shape: <span style="font-family:var(--mono);">σ_w(N) = C/N² + D N</span>. A plot helps you “see” the unique minimum and how the two terms trade off.
          Since the problem is mostly symbolic and unit conventions differ, the plot below uses a <b>dimensionless normalized energy</b> with <b>example values</b>.
        </p>

        <figure>
          <canvas id="plot" style="width:100%; height:320px; display:block;"></canvas>
          <figcaption>
            <b>Example (dimensionless):</b>
            Plot of <span style="font-family:var(--mono);">f(N)=1/N² + βN</span> with <span style="font-family:var(--mono);">β=0.05</span> (example).
            The minimum occurs at <span style="font-family:var(--mono);">N=(2/β)^(1/3)</span>, illustrating the same minimization structure as the physical model.
          </figcaption>
        </figure>

        <div class="card" style="margin-top:12px;">
          <h3 style="margin-top:0;">What it shows and why it’s useful</h3>
          <ul>
            <li><b>Y-axis:</b> normalized energy <span style="font-family:var(--mono);">f(N)</span> (dimensionless).</li>
            <li><b>X-axis:</b> plane count <span style="font-family:var(--mono);">N</span> (dimensionless).</li>
            <li><b>Features to notice:</b> divergence at small <span style="font-family:var(--mono);">N</span> from <span style="font-family:var(--mono);">1/N²</span>, linear growth at large <span style="font-family:var(--mono);">N</span>, and a single minimum in between.</li>
            <li><b>Connection to physics:</b> replace <span style="font-family:var(--mono);">1</span> by <span style="font-family:var(--mono);">π²JS²</span> and <span style="font-family:var(--mono);">β</span> by a ratio involving <span style="font-family:var(--mono);">M_s²a</span> to recover <span style="font-family:var(--mono);">σ_w(N)</span>.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">Back to top</a>
      </section>
    </main>
  </div>

  <footer>
    <div class="card">
      <b>Note on rigor:</b> The derivation is mathematically rigorous <i>for the provided model</i>. The physical model itself is a scaling approximation
      (especially the magnetostatic term and the discrete exchange estimate). In practice, engineers refine constants with micromagnetic simulation and experiments,
      but the cube-root scaling and the exchange–demag trade-off are highly informative for design intuition.
    </div>
  </footer>

  <script>
    // Copy buttons
    (function(){
      function copyText(txt){
        if(navigator.clipboard && window.isSecureContext){
          return navigator.clipboard.writeText(txt);
        }
        // fallback
        const ta = document.createElement('textarea');
        ta.value = txt;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        ta.style.top = '0';
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        try{ document.execCommand('copy'); }catch(e){}
        document.body.removeChild(ta);
        return Promise.resolve();
      }

      document.querySelectorAll('[data-copy-btn]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const id = btn.getAttribute('data-copy-btn');
          const el = document.getElementById(id);
          if(!el) return;
          const text = el.textContent.trim();
          await copyText(text);
          const old = btn.textContent;
          btn.textContent = 'Copied!';
          btn.style.filter = 'brightness(1.15)';
          setTimeout(()=>{ btn.textContent = old; btn.style.filter=''; }, 900);
        });
      });
    })();

    // Single static plot (canvas) - high DPI aware, responsive
    (function(){
      const canvas = document.getElementById('plot');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      function draw(){
        const cssW = canvas.clientWidth;
        const cssH = canvas.clientHeight;
        const dpr = window.devicePixelRatio || 1;
        canvas.width = Math.round(cssW * dpr);
        canvas.height = Math.round(cssH * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        // Plot settings
        const padL = 56, padR = 18, padT = 28, padB = 44;
        const W = cssW, H = cssH;
        const x0 = padL, y0 = H - padB, x1 = W - padR, y1 = padT;
        const plotW = x1 - x0, plotH = y0 - y1;

        // Example function f(N)=1/N^2 + beta N
        const beta = 0.05;
        const xmin = 1, xmax = 40;

        function f(N){ return 1/(N*N) + beta*N; }

        // Determine y-range by sampling
        let ymin = Infinity, ymax = -Infinity;
        for(let i=0;i<=800;i++){
          const N = xmin + (xmax-xmin)*i/800;
          const y = f(N);
          ymin = Math.min(ymin, y);
          ymax = Math.max(ymax, y);
        }
        // Add margins
        const ym = (ymax - ymin) * 0.08;
        ymin -= ym; ymax += ym;

        // Helpers
        function X(N){ return x0 + (N - xmin)/(xmax - xmin)*plotW; }
        function Y(y){ return y0 - (y - ymin)/(ymax - ymin)*plotH; }

        // Background
        ctx.clearRect(0,0,W,H);
        // subtle panel
        ctx.fillStyle = 'rgba(0,0,0,0.12)';
        ctx.strokeStyle = 'rgba(255,255,255,0.12)';
        roundRect(ctx, 10, 10, W-20, H-20, 14, true, true);

        // Title
        ctx.fillStyle = 'rgba(234,240,255,0.95)';
        ctx.font = '600 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('Example normalized wall energy: f(N) = 1/N² + βN  (β = 0.05)', x0, 18);

        // Gridlines & axes
        ctx.save();
        ctx.beginPath();
        ctx.rect(x0, y1, plotW, plotH);
        ctx.clip();

        // grid
        ctx.lineWidth = 1;
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        const xTicks = 8, yTicks = 6;

        for(let i=0;i<=xTicks;i++){
          const x = x0 + plotW*i/xTicks;
          ctx.beginPath();
          ctx.moveTo(x, y1);
          ctx.lineTo(x, y0);
          ctx.stroke();
        }
        for(let j=0;j<=yTicks;j++){
          const y = y1 + plotH*j/yTicks;
          ctx.beginPath();
          ctx.moveTo(x0, y);
          ctx.lineTo(x1, y);
          ctx.stroke();
        }

        // curve
        ctx.lineWidth = 2;
        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.beginPath();
        for(let i=0;i<=800;i++){
          const N = xmin + (xmax-xmin)*i/800;
          const y = f(N);
          const px = X(N), py = Y(y);
          if(i===0) ctx.moveTo(px, py);
          else ctx.lineTo(px, py);
        }
        ctx.stroke();

        // mark minimum
        const Nstar = Math.cbrt(2/beta);
        const ystar = f(Nstar);
        ctx.fillStyle = 'rgba(52,211,153,0.95)';
        ctx.beginPath();
        ctx.arc(X(Nstar), Y(ystar), 4.5, 0, Math.PI*2);
        ctx.fill();

        ctx.restore();

        // axes
        ctx.lineWidth = 1.2;
        ctx.strokeStyle = 'rgba(255,255,255,0.22)';
        ctx.beginPath();
        ctx.moveTo(x0, y0); ctx.lineTo(x1, y0);
        ctx.moveTo(x0, y0); ctx.lineTo(x0, y1);
        ctx.stroke();

        // ticks + labels
        ctx.fillStyle = 'rgba(185,196,230,0.95)';
        ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace';

        for(let i=0;i<=xTicks;i++){
          const N = xmin + (xmax-xmin)*i/xTicks;
          const x = X(N);
          ctx.strokeStyle = 'rgba(255,255,255,0.22)';
          ctx.beginPath();
          ctx.moveTo(x, y0); ctx.lineTo(x, y0+5);
          ctx.stroke();
          ctx.fillText(N.toFixed(0), x-6, y0+18);
        }

        for(let j=0;j<=yTicks;j++){
          const yv = ymin + (ymax-ymin)*j/yTicks;
          const y = Y(yv);
          ctx.strokeStyle = 'rgba(255,255,255,0.22)';
          ctx.beginPath();
          ctx.moveTo(x0-5, y); ctx.lineTo(x0, y);
          ctx.stroke();
          ctx.fillText(yv.toFixed(2), 8, y+4);
        }

        // axis labels
        ctx.fillStyle = 'rgba(234,240,255,0.92)';
        ctx.font = '600 13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('N (planes)', x0 + plotW/2 - 34, H - 14);

        ctx.save();
        ctx.translate(16, y1 + plotH/2 + 34);
        ctx.rotate(-Math.PI/2);
        ctx.fillText('f(N) (dimensionless)', 0, 0);
        ctx.restore();

        // legend
        ctx.fillStyle = 'rgba(125,211,252,0.95)';
        ctx.fillRect(x1-150, y1+8, 18, 3);
        ctx.fillStyle = 'rgba(185,196,230,0.95)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('f(N)=1/N²+βN', x1-125, y1+14);

        ctx.fillStyle = 'rgba(52,211,153,0.95)';
        ctx.beginPath();
        ctx.arc(x1-141, y1+28, 4, 0, Math.PI*2);
        ctx.fill();
        ctx.fillStyle = 'rgba(185,196,230,0.95)';
        ctx.fillText('minimum', x1-125, y1+32);
      }

      function roundRect(ctx, x, y, w, h, r, fill, stroke){
        const rr = Math.min(r, w/2, h/2);
        ctx.beginPath();
        ctx.moveTo(x+rr, y);
        ctx.arcTo(x+w, y, x+w, y+h, rr);
        ctx.arcTo(x+w, y+h, x, y+h, rr);
        ctx.arcTo(x, y+h, x, y, rr);
        ctx.arcTo(x, y, x+w, y, rr);
        ctx.closePath();
        if(fill) ctx.fill();
        if(stroke) ctx.stroke();
      }

      // initial draw + resize
      draw();
      let raf = null;
      window.addEventListener('resize', ()=>{
        if(raf) cancelAnimationFrame(raf);
        raf = requestAnimationFrame(draw);
      });
    })();
  </script>
</body>
</html>
