<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Complex Wavevectors in a Band Gap (Nearly-Free Electron Model)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1620;
      --card:#111b27;
      --text:#e9eef5;
      --muted:#a9b6c7;
      --line:#223044;
      --accent:#7dd3fc;
      --accent2:#a7f3d0;
      --warn:#fbbf24;
      --ok:#34d399;
      --bad:#fb7185;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --radius2: 22px;
      --maxw: 1120px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1100px 700px at 20% -10%, rgba(125,211,252,.12), transparent 60%),
                  radial-gradient(900px 600px at 85% 10%, rgba(167,243,208,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.6;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      position:relative;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(17,27,39,.92), rgba(11,15,20,.92));
      backdrop-filter: blur(10px);
    }
    .wrap{
      max-width:var(--maxw);
      margin:0 auto;
      padding:28px 18px;
    }
    .hero{
      display:grid;
      grid-template-columns: 1.5fr 1fr;
      gap:16px;
      align-items:stretch;
    }
    .title{
      padding:18px 18px;
      background: linear-gradient(180deg, rgba(17,27,39,.9), rgba(15,22,32,.65));
      border:1px solid var(--line);
      border-radius:var(--radius2);
      box-shadow:var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .title:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(800px 220px at 30% 0%, rgba(125,211,252,.18), transparent 60%);
      pointer-events:none;
    }
    h1{
      margin:0 0 8px 0;
      font-size:clamp(1.35rem, 2.2vw, 2.05rem);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      font-size:0.98rem;
    }
    .meta{
      margin-top:12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      color:var(--muted);
      font-size:.92rem;
    }
    .pill{
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      padding:6px 10px;
      border-radius:999px;
    }
    .toc{
      position:sticky;
      top:10px;
      align-self:start;
      padding:16px;
      background: linear-gradient(180deg, rgba(17,27,39,.85), rgba(15,22,32,.65));
      border:1px solid var(--line);
      border-radius:var(--radius2);
      box-shadow:var(--shadow);
    }
    .toc h2{
      font-size:1rem; margin:0 0 10px 0;
      display:flex; align-items:center; gap:8px;
    }
    .toc nav a{
      display:block;
      padding:7px 10px;
      border-radius:12px;
      color:var(--text);
      border:1px solid transparent;
      font-size:.95rem;
    }
    .toc nav a:hover{
      background: rgba(125,211,252,.08);
      border-color: rgba(125,211,252,.18);
      text-decoration:none;
    }
    main .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:16px;
      margin-top:16px;
    }
    section, article{
      background: linear-gradient(180deg, rgba(17,27,39,.72), rgba(15,22,32,.52));
      border:1px solid var(--line);
      border-radius:var(--radius2);
      box-shadow:var(--shadow);
      padding:18px;
      overflow:hidden;
      position:relative;
    }
    section:after, article:after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(700px 200px at 15% 0%, rgba(167,243,208,.08), transparent 55%);
      pointer-events:none;
      opacity:.9;
    }
    section > * , article > * { position:relative; }
    h2{
      margin:0 0 10px 0;
      font-size:1.25rem;
    }
    h3{
      margin:16px 0 8px 0;
      font-size:1.08rem;
      color: var(--accent2);
    }
    p{margin:10px 0}
    ul{margin:10px 0 10px 20px}
    li{margin:6px 0}
    .callouts{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:12px;
      margin:12px 0;
    }
    .card{
      grid-column: span 12;
      background: rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:14px 14px;
    }
    @media (min-width: 900px){
      .callouts .half{ grid-column: span 6; }
      main .grid{ grid-template-columns: 1fr; }
    }
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:.92rem;
      color:var(--muted);
    }
    .dot{
      width:10px; height:10px; border-radius:50%;
      background: var(--accent);
      box-shadow:0 0 0 3px rgba(125,211,252,.14);
      flex:0 0 auto;
    }
    .eq{
      margin:12px 0;
      background: rgba(11,15,20,.55);
      border:1px dashed rgba(125,211,252,.35);
      border-radius: 14px;
      overflow:hidden;
    }
    .eq-head{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:10px 10px;
      border-bottom:1px solid rgba(125,211,252,.18);
      background: rgba(125,211,252,.06);
    }
    .eq-head strong{
      font-size:.95rem;
      color: var(--text);
    }
    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding:7px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-size:.9rem;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.28);
      transform: translateY(-1px);
    }
    .btn:active{ transform: translateY(0px) scale(.99); }
    pre, code{
      font-family: var(--mono);
      font-size:.95rem;
    }
    pre{
      margin:0;
      padding:12px 12px;
      overflow:auto;
      max-width:100%;
      color:#eaf2ff;
    }
    .assump{
      border-left:4px solid var(--warn);
      background: rgba(251,191,36,.07);
    }
    .mistakes{
      border-left:4px solid var(--bad);
      background: rgba(251,113,133,.07);
    }
    .keyeq{
      border-left:4px solid var(--accent);
      background: rgba(125,211,252,.06);
    }
    .final{
      border-left:4px solid var(--ok);
      background: rgba(52,211,153,.07);
    }
    details{
      margin:10px 0;
      border:1px solid var(--line);
      border-radius:14px;
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    summary{
      cursor:pointer;
      padding:10px 12px;
      color: var(--text);
      font-weight:600;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    details[open] summary{
      border-bottom:1px solid var(--line);
      background: rgba(167,243,208,.06);
    }
    .details-body{ padding:10px 12px; color: var(--muted); }
    figure{
      margin:12px 0;
      border:1px solid var(--line);
      border-radius: 18px;
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    figcaption{
      padding:10px 12px;
      color: var(--muted);
      border-top:1px solid var(--line);
      font-size:.92rem;
    }
    canvas{ display:block; width:100%; height:auto; }
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:8px;
      padding:8px 10px;
      border-radius: 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
    }
    .backtop:hover{
      text-decoration:none;
      background: rgba(125,211,252,.08);
      border-color: rgba(125,211,252,.22);
    }
    footer{
      border-top:1px solid var(--line);
      color: var(--muted);
      font-size:.92rem;
      padding:18px 0 30px;
    }
    /* Print-friendly */
    @media print{
      body{ background:#fff; color:#000; }
      header, .toc, .btn, .backtop{ display:none !important; }
      section, article{ box-shadow:none; border:1px solid #ddd; background:#fff; }
      .eq{ border-color:#999; background:#fff; }
      pre{ color:#000; }
      a{ color:#000; text-decoration:underline; }
      h2{ break-before: page; }
      figure{ break-inside: avoid; }
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="wrap">
      <div class="hero">
        <div class="title">
          <h1>Complex Wavevectors in the Energy Gap (Boundary of 1st Brillouin Zone)</h1>
          <p class="subtitle">
            Nearly-free electron model: how a periodic potential turns forbidden energies into <em>evanescent</em> Bloch waves with
            an imaginary wavevector, and why that matters for tunneling (Zener breakdown).
          </p>
          <div class="meta">
            <span class="pill">Quantum / Solid State</span>
            <span class="pill">Dispersion relation & eigenvalue problem</span>
            <span class="pill">Applied lens: Zener tunneling</span>
            <span class="pill">Result: symbolic (with one illustrative plot)</span>
          </div>
        </div>
        <aside class="toc" aria-label="Table of contents">
          <h2><span class="dot"></span>Table of Contents</h2>
          <nav>
            <a href="#quick">Quick Summary</a>
            <a href="#part0">PART 0 — Concept Primer</a>
            <a href="#part0b">PART 0B — Industry & Applied Physics Perspective</a>
            <a href="#part1">PART 1 — Problem Analysis</a>
            <a href="#part2">PART 2 — Strategy & Tips</a>
            <a href="#part3">PART 3 — Full Solution</a>
            <a href="#part4">PART 4 — Deeper Understanding</a>
            <a href="#part5">PART 5 — Optional Plot Guide</a>
          </nav>
        </aside>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">

      <section id="quick">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this is:</strong> Find the <strong>imaginary part</strong> of the crystal wavevector <code>k</code> for energies inside a band gap at the <strong>first Brillouin-zone boundary</strong>.</li>
          <li><strong>Key physics:</strong> Inside a gap, Bloch states become <strong>evanescent</strong>: amplitude decays as <code>exp(-Im(k)·x)</code>.</li>
          <li><strong>Model:</strong> <strong>Nearly-free electron</strong> (two-plane-wave) approximation near <code>k ≈ G/2</code>, where <code>G</code> is the smallest reciprocal lattice vector magnitude.</li>
          <li><strong>Governing math object:</strong> a <strong>2×2 eigenvalue problem</strong> (coupled modes <code>k</code> and <code>k−G</code>) giving a dispersion relation.</li>
          <li><strong>Core equation:</strong> (in the approximation leading to Eq. (46))<br/>
            <code>(E − E0)^2 = U^2 + (ħ^2 G q / (2m))^2</code>, with <code>k = G/2 + q</code>.</li>
          <li><strong>In the gap:</strong> take <code>q = iκ</code>, so <code>κ = Im(k)</code> and <code>(E − E0)^2 = U^2 − (ħ^2 G κ / (2m))^2</code>.</li>
          <li><strong>Result (symbolic):</strong><br/>
            <code>Im(k) = (2m/(ħ^2 G)) · sqrt(U^2 − (E − E0)^2)</code> for <code>|E − E0| &lt; |U|</code>.</li>
          <li><strong>Center of gap:</strong> at <code>E = E0</code>,<br/>
            <code>Im(k)_center = 2m|U|/(ħ^2 G)</code> and for small <code>Im(k)</code>:<br/>
            <code>(ħ^2/2m)[Im(k)]^2 = 2m U^2/(ħ^2 G^2)</code>.</li>
          <li><strong>Physical meaning:</strong> larger <code>Im(k)</code> → stronger decay → smaller tunneling probability (relevant to <strong>Zener tunneling</strong> under strong fields).</li>
        </ul>

        <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
      </section>

      <section id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="callouts">
          <div class="card half">
            <div class="tag"><span class="dot"></span><strong>Core definitions (symbols + SI units)</strong></div>
            <ul>
              <li><code>V(x)</code>: periodic potential (J), with <code>V(x+a)=V(x)</code>.</li>
              <li><code>G</code>: reciprocal lattice vector magnitude (m<sup>−1</sup>), smallest nonzero is <code>G=2π/a</code>.</li>
              <li><code>k</code>: Bloch wavevector (m<sup>−1</sup>), can be complex in a gap.</li>
              <li><code>U</code>: Fourier coefficient of the periodic potential at <code>G</code> (J). (Often written <code>U_G</code>.)</li>
              <li><code>m</code>: electron mass or effective mass (kg) in the nearly-free electron picture.</li>
              <li><code>ħ</code>: reduced Planck constant (J·s).</li>
              <li><code>E</code>: electron energy eigenvalue (J).</li>
              <li><code>E0</code>: free-electron energy at the zone boundary <code>k=G/2</code>, (J).</li>
            </ul>
          </div>

          <div class="card half">
            <div class="tag"><span class="dot"></span><strong>Physical meaning (intuition)</strong></div>
            <ul>
              <li>At a zone boundary, two plane waves become nearly degenerate and <strong>mix</strong>.</li>
              <li>Mixing opens a <strong>gap</strong> in energy of size <code>2|U|</code> (in this simple model).</li>
              <li>Inside the gap there is <strong>no propagating Bloch wave</strong>; instead, the wave decays:
                <code>ψ(x) ~ e^{i Re(k) x} e^{-Im(k) x}</code>.</li>
              <li><code>Im(k)</code> is an <strong>inverse decay length</strong>. Larger <code>Im(k)</code> means stronger attenuation.</li>
            </ul>
          </div>
        </div>

        <h3>Key laws / principles and validity conditions</h3>
        <ul>
          <li><strong>Time-independent Schrödinger equation</strong> (1D for clarity; generalization to 3D is analogous):
            <code>[-(ħ^2/2m) d^2/dx^2 + V(x)] ψ(x) = E ψ(x)</code>.</li>
          <li><strong>Bloch theorem:</strong> in a periodic potential, eigenstates can be written as
            <code>ψ_k(x) = e^{ikx} u_k(x)</code> with <code>u_k(x+a)=u_k(x)</code>. This remains valid for complex <code>k</code> when analytically continued.</li>
          <li><strong>Nearly-free electron approximation:</strong> the periodic potential is “weak” so only a few Fourier components matter, and near a degeneracy we can truncate to a <strong>two-mode</strong> system.</li>
          <li><strong>Regime:</strong> energies close to the Brillouin-zone edge where <code>k ≈ G/2</code>, and small detuning <code>q = k − G/2</code>.</li>
        </ul>

        <h3>Common models / approximations used (and why)</h3>
        <div class="callouts">
          <div class="card assump half">
            <strong>Approximation used here (the one behind “Eq. (46)”):</strong>
            <ul>
              <li>Keep coupling only between <code>k</code> and <code>k−G</code> via the Fourier coefficient <code>U</code>.</li>
              <li>Neglect the small <code>q^2</code> term in the <em>average</em> energy (or equivalently linearize around the zone boundary), so the dispersion reduces to a square-root form.</li>
            </ul>
          </div>
          <div class="card keyeq half">
            <strong>Why it’s valid (mathematical statement):</strong>
            <ul>
              <li>The Schrödinger operator is linear and periodic, so expanding in plane waves is natural (Fourier basis).</li>
              <li>Near a degeneracy, degenerate perturbation theory justifies truncation to the nearly-resonant subspace.</li>
              <li>Dropping higher-order terms corresponds to keeping leading order in small parameter <code>|q|/G</code>.</li>
            </ul>
          </div>
        </div>

        <h3>Mini intuition examples (conceptual, minimal algebra)</h3>
        <ul>
          <li><strong>Bragg reflection:</strong> At <code>k=G/2</code>, the lattice reflects the electron wave strongly. Two counter-propagating components form standing waves → split energies → gap.</li>
          <li><strong>Evanescent behavior:</strong> If you choose an energy where propagation is forbidden, the wave can still exist but only as a decaying field—exactly like EM evanescent waves in a stop band.</li>
          <li><strong>Decay length:</strong> If <code>Im(k)=κ</code>, then amplitude decays over length scale <code>1/κ</code>.</li>
        </ul>

        <h3>What to watch for (pitfalls)</h3>
        <ul>
          <li>Confusing <code>G</code> (reciprocal lattice vector) with a real-space length.</li>
          <li>Forgetting that the “gap” here is centered at the free-electron zone-edge energy <code>E0</code>.</li>
          <li>Mixing sign conventions: in a gap, we use <code>k = Re(k) ± iκ</code> with <code>κ &gt; 0</code>.</li>
          <li>Dropping terms inconsistently: the Eq.(46)-type approximation keeps the coupling and the linear detuning term but discards higher-order curvature in the average energy.</li>
        </ul>

        <details>
          <summary>Math Insight (core equation as a mathematical object)</summary>
          <div class="details-body">
            <p>
              The nearly-free electron model near a zone boundary reduces the PDE eigenproblem
              <code>Hψ = Eψ</code> (a linear self-adjoint operator on an infinite periodic domain) to a finite-dimensional
              <strong>matrix eigenvalue problem</strong> in a truncated Fourier basis.
              Mathematically, this is a local “two-mode coupling” problem that produces a
              <strong>square-root branch structure</strong> in the dispersion relation. The energy gap corresponds to a range where
              the real quasi-momentum ceases to exist and is replaced by a complex continuation (evanescent solution).
            </p>
          </div>
        </details>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <h3>Where this appears in industry (at least 3 areas)</h3>
        <ul>
          <li><strong>Semiconductor devices under high fields:</strong> Zener tunneling / band-to-band tunneling in diodes, power devices, and ESD events.</li>
          <li><strong>Nanoscale interconnects and thin films:</strong> Barrier layers and interfaces where evanescent states govern leakage and contact resistance.</li>
          <li><strong>Quantum and tunneling-based devices:</strong> Tunnel FETs, resonant tunneling diodes, superlattices, and quantum cascade structures where stop bands and complex <code>k</code> determine transmission.</li>
          <li><strong>Photonics/phononics analogs:</strong> Stop bands in periodic media where “complex wavevector in a band gap” has a direct parallel (evanescent Bloch modes).</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><strong>Performance:</strong> leakage current, breakdown voltage, and switching behavior depend exponentially on decay rates (often via WKB/Zener expressions).</li>
          <li><strong>Safety & reliability:</strong> high-field tunneling can trigger runaway heating, degradation, or catastrophic failure in power electronics.</li>
          <li><strong>Cost & manufacturability:</strong> controlling band gaps and effective masses through doping/strain/material choice can reduce guard-ring area, improve yield, and reduce device size.</li>
        </ul>

        <h3>Typical measurement / validation methods</h3>
        <ul>
          <li><strong>I–V characterization</strong> under reverse bias to extract breakdown mechanisms (Zener vs avalanche).</li>
          <li><strong>Temperature dependence</strong>: tunneling is typically weakly temperature-dependent compared to thermally activated transport.</li>
          <li><strong>Spectroscopy & band-structure validation</strong>: ARPES (where possible), optical absorption edges, ellipsometry, and transport effective mass extraction.</li>
        </ul>

        <h3>Design trade-offs and constraints</h3>
        <ul>
          <li>Real materials have <strong>multiple bands</strong>, anisotropic <strong>effective masses</strong>, and non-parabolic dispersion.</li>
          <li>Interfaces add <strong>band bending</strong>, defects, and trap-assisted tunneling (not captured by the idealized periodic model).</li>
          <li>Device geometry introduces <strong>nonuniform fields</strong>; the relevant tunneling path uses a spatially varying potential energy (requires WKB-type integration).</li>
        </ul>

        <details>
          <summary>From lab to product: how the ideal model is adapted</summary>
          <div class="details-body">
            <p>
              In product-grade models, the simple <code>U</code> and <code>G</code> picture is replaced by an effective complex band structure
              computed from k·p, tight-binding, or DFT-calibrated approaches. Engineers still use the same core idea:
              tunneling rates depend exponentially on an integral over <code>Im(k(E,x))</code> along the field direction, which is why even
              approximate formulas for <code>Im(k)</code> are valuable for fast design loops and sensitivity studies.
            </p>
          </div>
        </details>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>Problem restatement (in plain words)</h3>
        <p>
          Near the first Brillouin-zone boundary (<code>k ≈ G/2</code>), a weak periodic potential opens an energy gap.
          For energies <em>inside</em> this gap, the Bloch wavevector becomes complex. The task is to derive an expression for
          <code>Im(k)</code> (the decay constant) in the gap using the same approximation that produced the square-root dispersion
          (referred to as Eq. (46)), and then evaluate <code>Im(k)</code> at the <strong>center of the gap</strong>.
        </p>

        <h3>Given quantities</h3>
        <ul>
          <li><code>m</code> (electron mass / effective mass), <code>ħ</code>, reciprocal lattice magnitude <code>G</code>.</li>
          <li>Periodic potential coupling amplitude <code>U</code> (Fourier component at <code>G</code>).</li>
        </ul>

        <h3>Unknowns</h3>
        <ul>
          <li><code>Im(k)</code> as a function of energy <code>E</code> in the band gap.</li>
          <li><code>Im(k)</code> at the gap center.</li>
        </ul>

        <h3>Relevant principles / laws (and why they apply)</h3>
        <ul>
          <li><strong>Bloch theorem</strong> applies because the potential is periodic.</li>
          <li><strong>Degenerate perturbation / coupled-mode theory</strong> applies at <code>k=G/2</code> because free-electron states become degenerate there.</li>
          <li><strong>Complex wavevector continuation</strong> is used because energy lies in a forbidden band: solutions must be evanescent rather than propagating.</li>
        </ul>

        <div class="card assump">
          <strong>Assumptions (explicit):</strong>
          <ul>
            <li>Weak periodic potential → keep only coupling between <code>k</code> and <code>k−G</code> (two-wave approximation).</li>
            <li>Work near the zone boundary: <code>k = G/2 + q</code> with <code>|q| &lt;&lt; G</code>.</li>
            <li>Use the same approximation as Eq.(46): neglect higher-order curvature terms in the average energy (drop <code>q^2</code> in the average term), retaining the leading square-root structure.</li>
            <li>1D presentation for clarity; result generalizes along the field direction in 3D.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare 2–3)</h3>
        <ul>
          <li><strong>Approach A: 2×2 plane-wave eigenproblem (recommended)</strong>
            <ul>
              <li>Pros: direct, matches Eq.(46) derivation, clean path to complex <code>k</code>.</li>
              <li>Cons: requires comfort with matrix determinants.</li>
            </ul>
          </li>
          <li><strong>Approach B: Bragg reflection + coupled-mode equations</strong>
            <ul>
              <li>Pros: strong physical intuition; common in photonics/phononics.</li>
              <li>Cons: must map carefully to electron energies to avoid sign mistakes.</li>
            </ul>
          </li>
          <li><strong>Approach C: Analytic continuation of dispersion relation</strong>
            <ul>
              <li>Pros: fastest once Eq.(46) is known.</li>
              <li>Cons: easy to miss domain constraints (<code>|E−E0| &lt; |U|</code>).</li>
            </ul>
          </li>
        </ul>

        <p>
          We choose <strong>Approach A</strong> because it reproduces the approximation that leads to Eq.(46) and makes the
          transition to complex wavevectors mathematically transparent.
        </p>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

        <ol>
          <li><strong>Set the model:</strong> write the Schrödinger eigenproblem with periodic <code>V(x)</code>, and expand in plane waves.</li>
          <li><strong>Focus near the zone boundary:</strong> use <code>k = G/2 + q</code> with small <code>q</code>.</li>
          <li><strong>Truncate to two modes:</strong> keep only basis states <code>|k⟩</code> and <code>|k−G⟩</code> coupled by <code>U</code>.</li>
          <li><strong>Build the 2×2 matrix:</strong> diagonal entries are free-electron energies; off-diagonal entries are <code>U</code>.</li>
          <li><strong>Apply the Eq.(46) approximation:</strong> simplify the dispersion to the square-root form (drop the small <code>q^2</code> shift in the average energy).</li>
          <li><strong>Enter the gap:</strong> allow <code>q</code> to be imaginary, <code>q = iκ</code>, which implies <code>Im(k)=κ</code>.</li>
          <li><strong>Solve for κ(E):</strong> invert the dispersion relation for <code>κ</code> as a function of <code>E</code>.</li>
          <li><strong>Evaluate at gap center:</strong> set <code>E=E0</code> and simplify.</li>
          <li><strong>Sanity checks:</strong> units, limiting cases (<code>U→0</code>, edge of gap), sign choice.</li>
        </ol>

        <div class="card mistakes">
          <strong>Common mistakes (quick tips)</strong>
          <ul>
            <li>Using <code>k=iκ</code> instead of <code>k=G/2+iκ</code> (the real part at the boundary matters).</li>
            <li>Forgetting absolute values: the gap is set by <code>|U|</code>, not the sign of <code>U</code>.</li>
            <li>Mixing energy reference: use <code>E0 = ħ^2(G/2)^2/(2m) = ħ^2 G^2/(8m)</code> (the free-electron energy at the boundary).</li>
            <li>Dropping the wrong term: Eq.(46)-type approximation discards the <em>average</em> <code>q^2</code> shift, not the coupling term.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <article id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation (before calculating)</h3>
        <ul>
          <li>At the band edges (just outside the gap), the wave is propagating → <code>Im(k)=0</code>.</li>
          <li>Deepest inside the gap (center), propagation is most forbidden → <code>Im(k)</code> should be <strong>maximal</strong>.</li>
          <li>The dependence of <code>Im(k)</code> on energy inside the gap should look like a “semicircle” in the simplest square-root model because it comes from <code>U^2 − (E−E0)^2</code>.</li>
        </ul>

        <h3>Step 1: Mathematical model (variables, domain, operator)</h3>
        <p>
          Consider the 1D stationary Schrödinger eigenvalue problem on an infinite periodic domain:
        </p>

        <div class="eq keyeq" data-copy="[-(ħ^2/(2m)) d^2/dx^2 + V(x)] ψ(x) = E ψ(x),   with V(x+a)=V(x).">
          <div class="eq-head">
            <strong>Governing eigenproblem</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>[-(ħ^2/(2m)) d^2/dx^2 + V(x)] ψ(x) = E ψ(x),   with V(x+a)=V(x).</code></pre>
        </div>

        <p>
          Because the operator is linear and periodic, we use a plane-wave/Fourier basis and Bloch theorem.
          Near a Brillouin-zone boundary we only need the nearly-resonant Fourier components.
        </p>

        <h3>Step 2: Identify the zone boundary and define detuning</h3>
        <p>
          The first zone boundary is at <code>k = G/2</code>, where <code>G = 2π/a</code> is the smallest nonzero reciprocal lattice magnitude.
          Write
        </p>

        <div class="eq keyeq" data-copy="k = G/2 + q,   with |q| << G.">
          <div class="eq-head">
            <strong>Near-boundary parameterization</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>k = G/2 + q,   with |q| &lt;&lt; G.</code></pre>
        </div>

        <h3>Step 3: Two-wave truncation (degenerate perturbation)</h3>
        <p>
          At <code>k≈G/2</code>, the plane waves with wavevectors <code>k</code> and <code>k−G</code> have nearly the same free-electron energy.
          The periodic potential couples them through its Fourier component at <code>G</code>, which we denote by <code>U</code>.
        </p>

        <p>
          In the truncated basis <code>{ |k⟩, |k−G⟩ }</code>, the eigenproblem reduces to a 2×2 matrix:
        </p>

        <div class="eq keyeq" data-copy="det | (ε(k)−E)     U      |\n    |   U*     (ε(k−G)−E) | = 0,\nwhere ε(k)=ħ^2 k^2/(2m).">
          <div class="eq-head">
            <strong>2×2 secular equation</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>det | (ε(k)−E)     U      |
    |   U*     (ε(k−G)−E) | = 0,
where ε(k)=ħ^2 k^2/(2m).</code></pre>
        </div>

        <p>
          This step is valid because (i) the Schrödinger operator is linear, (ii) Fourier modes form a complete basis,
          and (iii) near a degeneracy, projecting onto the nearly-degenerate subspace captures the leading physics
          (degenerate perturbation theory).
        </p>

        <h3>Step 4: Reduce to a dispersion relation near <code>k=G/2</code></h3>
        <p>
          For simplicity (and matching the Eq.(46)-type approximation), we use the standard nearly-free electron result:
          the eigenvalues near the boundary can be written as a square-root form when we neglect the small average shift from <code>q^2</code>.
        </p>

        <p>
          First define the free-electron energy at the boundary:
        </p>

        <div class="eq keyeq" data-copy="E0 = ε(G/2) = ħ^2 (G/2)^2/(2m) = ħ^2 G^2/(8m).">
          <div class="eq-head">
            <strong>Zone-boundary reference energy</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>E0 = ε(G/2) = ħ^2 (G/2)^2/(2m) = ħ^2 G^2/(8m).</code></pre>
        </div>

        <p>
          Next, the detuning between the two coupled free-electron levels scales linearly with <code>q</code>. In this approximation,
          the dispersion becomes:
        </p>

        <div class="eq keyeq" data-copy="E(q) = E0 ± sqrt( U^2 + (ħ^2 G q / (2m))^2 ).">
          <div class="eq-head">
            <strong>Eq.(46)-type dispersion (square-root form)</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>E(q) = E0 ± sqrt( U^2 + (ħ^2 G q / (2m))^2 ).</code></pre>
        </div>

        <div class="card assump">
          <strong>What was neglected, precisely?</strong>
          <p>
            The more complete two-wave result includes an additional average term <code>+(ħ^2/m) q^2</code> outside the square root.
            The Eq.(46)-style approximation drops that <code>O(q^2)</code> shift in the average energy while keeping the key splitting
            mechanism (coupling <code>U</code> and linear detuning in <code>q</code> inside the square root). This is consistent to leading order in <code>|q|/G</code>.
          </p>
        </div>

        <h3>Step 5: Enter the band gap by allowing complex wavevector</h3>
        <p>
          The energy gap occurs at <code>q=0</code>, where the two energies are
          <code>E = E0 ± |U|</code>. Thus energies inside the gap satisfy:
        </p>

        <div class="eq keyeq" data-copy="E0 − |U| < E < E0 + |U|   (inside the gap).">
          <div class="eq-head">
            <strong>Energy interval of the gap</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>E0 − |U| &lt; E &lt; E0 + |U|   (inside the gap).</code></pre>
        </div>

        <p>
          For such <code>E</code>, no real <code>q</code> solves the dispersion. The standard mathematical move is an <strong>analytic continuation</strong>:
          set
        </p>

        <div class="eq keyeq" data-copy="q = iκ  with κ > 0  ⇒  k = G/2 + iκ and Im(k)=κ.">
          <div class="eq-head">
            <strong>Complex detuning and decay constant</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>q = iκ  with κ &gt; 0  ⇒  k = G/2 + iκ and Im(k)=κ.</code></pre>
        </div>

        <p>
          Physically, this means the Bloch factor <code>e^{ikx}</code> becomes <code>e^{i(G/2)x} e^{-κx}</code>, i.e., an oscillation at the boundary
          wavevector multiplied by exponential decay into the forbidden region.
        </p>

        <h3>Step 6: Solve explicitly for <code>κ(E)</code> (no magic jumps)</h3>
        <p>
          Start from the dispersion and isolate the square root:
        </p>
        <p><code>E − E0 = ± sqrt( U^2 + (ħ^2 G q / (2m))^2 )</code></p>
        <p>
          Square both sides (valid because both sides represent real quantities after the continuation; the sign is removed by squaring):
        </p>

        <div class="eq keyeq" data-copy="(E − E0)^2 = U^2 + (ħ^2 G q / (2m))^2.">
          <div class="eq-head">
            <strong>Squared dispersion relation</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>(E − E0)^2 = U^2 + (ħ^2 G q / (2m))^2.</code></pre>
        </div>

        <p>
          Substitute <code>q=iκ</code>:
        </p>
        <p>
          <code>(ħ^2 G q/(2m))^2 = (ħ^2 G/(2m))^2 (iκ)^2 = − (ħ^2 G κ/(2m))^2</code>.
        </p>

        <p>
          Therefore, inside the gap:
        </p>

        <div class="eq keyeq" data-copy="(E − E0)^2 = U^2 − (ħ^2 G κ / (2m))^2.">
          <div class="eq-head">
            <strong>Gap relation (real energy, imaginary wavevector)</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>(E − E0)^2 = U^2 − (ħ^2 G κ / (2m))^2.</code></pre>
        </div>

        <p>
          Rearrange to solve for <code>κ</code>:
        </p>
        <p>
          <code>(ħ^2 G κ/(2m))^2 = U^2 − (E − E0)^2</code>
        </p>
        <p>
          Taking the positive square root (since <code>κ&gt;0</code> for decay):
        </p>

        <div class="eq final" data-copy="Im(k) = κ(E) = (2m/(ħ^2 G)) · sqrt( U^2 − (E − E0)^2 ),   valid for |E − E0| < |U|.">
          <div class="eq-head">
            <strong>FINAL: Imaginary part of wavevector in the gap</strong>
            <button class="btn copy-btn" type="button">Copy final answer</button>
          </div>
          <pre><code>Im(k) = κ(E) = (2m/(ħ^2 G)) · sqrt( U^2 − (E − E0)^2 ),   valid for |E − E0| &lt; |U|.</code></pre>
        </div>

        <h3>Step 7: Evaluate at the center of the gap</h3>
        <p>
          The center of the gap corresponds to <code>E = E0</code>. Plug into the formula:
        </p>

        <div class="eq final" data-copy="Im(k)_center = (2m |U|)/(ħ^2 G).">
          <div class="eq-head">
            <strong>Imaginary wavevector at gap center</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>Im(k)_center = (2m |U|)/(ħ^2 G).</code></pre>
        </div>

        <p>
          The prompt also highlights the small-<code>Im(k)</code> energy scale. Multiply both sides by <code>ħ^2/(2m)</code>:
        </p>

        <div class="eq final" data-copy="(ħ^2/(2m)) [Im(k)_center]^2 = (2m U^2)/(ħ^2 G^2).">
          <div class="eq-head">
            <strong>Equivalent form (matches the provided expression)</strong>
            <button class="btn copy-btn" type="button">Copy equation</button>
          </div>
          <pre><code>(ħ^2/(2m)) [Im(k)_center]^2 = (2m U^2)/(ħ^2 G^2).</code></pre>
        </div>

        <h3>Sanity checks</h3>
        <div class="callouts">
          <div class="card half">
            <strong>Units / dimensions</strong>
            <ul>
              <li><code>Im(k)</code> must have units m<sup>−1</sup>.</li>
              <li>Right-hand side: <code>2m/(ħ^2 G)</code> has units (kg)/(J<sup>2</sup>s<sup>2</sup>·m<sup>−1</sup>) times energy → m<sup>−1</sup>. More directly:
                <code>ħ^2/m</code> has units J·m<sup>2</sup>, so <code>2m/(ħ^2 G)</code> has units 1/(J·m). Multiply by <code>sqrt(U^2−...)</code> (J) gives 1/m.</li>
            </ul>
          </div>
          <div class="card half">
            <strong>Limiting cases</strong>
            <ul>
              <li><code>U → 0</code>: gap closes; formula gives <code>Im(k)→0</code> (no forbidden region).</li>
              <li>At band edges <code>E = E0 ± |U|</code>: square root → 0 ⇒ <code>Im(k)=0</code> (transition to propagating states).</li>
              <li>At gap center <code>E=E0</code>: <code>Im(k)</code is maximal, consistent with strongest evanescence.</li>
            </ul>
          </div>
        </div>

        <h3>One static plot (illustrative)</h3>
        <p>
          The formula predicts a semicircular dependence: <code>Im(k) ∝ sqrt(U^2 − (E−E0)^2)</code> inside the gap.
          Below is a single static plot using <strong>example values</strong> purely for visualization.
        </p>

        <figure>
          <canvas id="plot" width="980" height="520" aria-label="Plot of Im(k) vs energy detuning inside the gap"></canvas>
          <figcaption>
            <strong>Example plot:</strong> normalized curve of <code>Im(k)</code> versus <code>E − E0</code> within <code>|E−E0| ≤ |U|</code>.
            The final solution remains symbolic; values here are illustrative only.
          </figcaption>
        </figure>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpret the final formula</h3>
        <p>
          The result
          <code>Im(k)= (2m/(ħ^2 G)) sqrt(U^2 − (E−E0)^2)</code>
          says the decay rate is controlled by three “knobs”:
        </p>
        <ul>
          <li><strong>Gap strength</strong> <code>|U|</code>: larger coupling → larger gap → stronger evanescence.</li>
          <li><strong>Reciprocal scale</strong> <code>G</code>: larger <code>G</code> (smaller lattice spacing) reduces <code>Im(k)</code> for fixed <code>U</code> and <code>m</code> in this approximation.</li>
          <li><strong>Inertia</strong> <code>m</code>: larger mass increases <code>Im(k)</code> (heavier electrons are “less mobile,” so forbidden regions attenuate more strongly).</li>
        </ul>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li>Increase <code>|U|</code> → increases <code>Im(k)</code> at every energy inside the gap; makes tunneling exponentially harder.</li>
          <li>Move energy toward the band edge (<code>|E−E0| → |U|</code>) → <code>Im(k) → 0</code>; evanescent state becomes propagating.</li>
          <li>At fixed <code>E</code>, increasing <code>m</code> increases <code>Im(k)</code> linearly; increasing <code>G</code> decreases it inversely.</li>
        </ul>

        <details>
          <summary>Alternative derivation idea (brief but meaningful)</summary>
          <div class="details-body">
            <p>
              You can derive the same result using a coupled-mode/Bragg reflection picture:
              write the wave as a superposition of forward and backward waves near <code>±G/2</code>, derive first-order ODEs for their envelopes,
              and obtain a stop-band condition identical in form to photonic band gaps. The stop-band solution has exponential envelopes with decay
              constant proportional to <code>sqrt(U^2 − (E−E0)^2)</code>, matching the two-state eigenvalue result.
            </p>
          </div>
        </details>

        <h3>Concept check (self-test Q&A)</h3>
        <ul>
          <li><strong>Q:</strong> Why can <code>k</code> be complex if the Hamiltonian is Hermitian?<br/>
              <strong>A:</strong> The energy eigenvalue stays real; complex <code>k</code> appears when we solve for Bloch-like spatial dependence at a real energy where propagating solutions do not exist. It is an analytic continuation describing evanescent behavior.</li>
          <li><strong>Q:</strong> Where is <code>Re(k)</code> in the gap solution?<br/>
              <strong>A:</strong> In this model near the first boundary, <code>Re(k)≈G/2</code>; the imaginary part <code>κ</code> controls decay.</li>
          <li><strong>Q:</strong> What happens to <code>Im(k)</code> at the band edges?<br/>
              <strong>A:</strong> It goes to zero continuously as <code>E→E0±|U|</code>.</li>
          <li><strong>Q:</strong> Why does tunneling depend so strongly on <code>Im(k)</code>?<br/>
              <strong>A:</strong> Transmission through forbidden regions typically scales like <code>exp(-2∫ Im(k) dx)</code>, so small changes in <code>Im(k)</code> cause exponential changes in leakage/breakdown.</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p>
          A plot is useful here because the dependence of the decay constant on energy inside the gap is not linear: it follows
          <code>Im(k) ∝ sqrt(U^2 − (E−E0)^2)</code>, which visually emphasizes that:
        </p>
        <ul>
          <li><code>Im(k)=0</code> at the band edges (<code>E−E0=±U</code>).</li>
          <li><code>Im(k)</code> is maximal at the gap center (<code>E−E0=0</code>).</li>
          <li>The shape is a “semicircle” in normalized variables.</li>
        </ul>

        <h3>What is on each axis (units)</h3>
        <ul>
          <li><strong>x-axis:</strong> <code>E − E0</code> (energy detuning, J; plotted in normalized units for clarity).</li>
          <li><strong>y-axis:</strong> <code>Im(k)</code> (m<sup>−1</sup>; plotted as normalized <code>Im(k)/Im(k)_center</code>).</li>
        </ul>

        <h3>Example values note</h3>
        <p>
          The plot uses normalized variables, equivalent to choosing <code>U=1</code> in arbitrary energy units and plotting
          <code>Im(k)/Im(k)_center = sqrt(1 − ((E−E0)/U)^2)</code>.
          This is purely illustrative and does not replace the symbolic final answer.
        </p>

        <h3>Features to notice</h3>
        <ul>
          <li><strong>Curvature:</strong> strongest near the center; suggests decay length changes most slowly near the center and most rapidly near edges.</li>
          <li><strong>Intercepts:</strong> exactly at <code>±U</code>, identifying the band edges in the approximation.</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

    </div>

    <footer>
      <div class="wrap" style="padding:0 18px;">
        <p>
          Built as a self-contained learning article: nearly-free electron band gap → complex wavevector → evanescence → engineering relevance (tunneling/breakdown).
        </p>
      </div>
    </footer>
  </main>

  <script>
    // Copy buttons for equations / final answer
    (function(){
      function copyText(txt){
        return navigator.clipboard.writeText(txt);
      }
      document.querySelectorAll('.eq').forEach(function(box){
        const btn = box.querySelector('.copy-btn');
        if(!btn) return;
        const payload = box.getAttribute('data-copy') || box.innerText.trim();
        btn.addEventListener('click', async function(){
          try{
            await copyText(payload);
            const old = btn.textContent;
            btn.textContent = 'Copied ✓';
            btn.style.borderColor = 'rgba(52,211,153,.45)';
            btn.style.background = 'rgba(52,211,153,.10)';
            setTimeout(function(){
              btn.textContent = old;
              btn.style.borderColor = '';
              btn.style.background = '';
            }, 900);
          }catch(e){
            const old = btn.textContent;
            btn.textContent = 'Copy failed';
            setTimeout(()=>btn.textContent=old, 900);
          }
        });
      });
    })();

    // One static canvas plot: normalized Im(k) vs (E-E0)/U in the gap
    (function(){
      const canvas = document.getElementById('plot');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      function draw(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const cssW = canvas.clientWidth;
        const cssH = Math.round(cssW * (520/980));
        canvas.style.height = cssH + "px";
        canvas.width = Math.round(cssW * dpr);
        canvas.height = Math.round(cssH * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        const W = cssW, H = cssH;
        ctx.clearRect(0,0,W,H);

        // Plot area
        const padL = 64, padR = 18, padT = 46, padB = 56;
        const x0 = padL, y0 = padT, x1 = W - padR, y1 = H - padB;
        const pw = x1 - x0, ph = y1 - y0;

        // Background
        ctx.fillStyle = "rgba(255,255,255,0.02)";
        ctx.fillRect(x0,y0,pw,ph);

        // Axes ranges in normalized units:
        // x = (E-E0)/U in [-1,1]
        // y = Im(k)/Im(k_center) = sqrt(1 - x^2) in [0,1]
        const xmin=-1, xmax=1, ymin=0, ymax=1;

        function X(x){ return x0 + (x - xmin) * pw/(xmax - xmin); }
        function Y(y){ return y1 - (y - ymin) * ph/(ymax - ymin); }

        // Gridlines & ticks
        ctx.lineWidth = 1;
        ctx.strokeStyle = "rgba(255,255,255,0.08)";
        ctx.fillStyle = "rgba(233,238,245,0.75)";
        ctx.font = "12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace";

        // Vertical grid at -1, -0.5, 0, 0.5, 1
        const xticks = [-1,-0.5,0,0.5,1];
        xticks.forEach(t=>{
          const xx = X(t);
          ctx.beginPath(); ctx.moveTo(xx,y0); ctx.lineTo(xx,y1); ctx.stroke();
          ctx.fillText(String(t), xx-10, y1+18);
        });
        // Horizontal grid at 0, 0.25, 0.5, 0.75, 1
        const yticks = [0,0.25,0.5,0.75,1];
        yticks.forEach(t=>{
          const yy = Y(t);
          ctx.beginPath(); ctx.moveTo(x0,yy); ctx.lineTo(x1,yy); ctx.stroke();
          ctx.fillText(String(t), x0-38, yy+4);
        });

        // Axes
        ctx.strokeStyle = "rgba(233,238,245,0.35)";
        ctx.lineWidth = 1.5;
        ctx.beginPath(); ctx.moveTo(x0,y1); ctx.lineTo(x1,y1); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(x0,y0); ctx.lineTo(x0,y1); ctx.stroke();

        // Title
        ctx.fillStyle = "rgba(233,238,245,0.92)";
        ctx.font = "600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillText("Normalized evanescent decay in the gap: Im(k)/Im(k)center vs (E−E0)/U", x0, 22);

        // Axis labels
        ctx.fillStyle = "rgba(233,238,245,0.85)";
        ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillText("x = (E − E0)/U  [dimensionless]", x0 + Math.max(0, (pw-220)/2), H-18);

        // y label rotated
        ctx.save();
        ctx.translate(18, y0 + ph/2);
        ctx.rotate(-Math.PI/2);
        ctx.fillText("y = Im(k)/Im(k)center  [dimensionless]", 0, 0);
        ctx.restore();

        // Curve: y = sqrt(1 - x^2), x in [-1,1]
        ctx.strokeStyle = "rgba(125,211,252,0.95)";
        ctx.lineWidth = 2.5;
        ctx.beginPath();
        const N = 400;
        for(let i=0;i<=N;i++){
          const x = xmin + (xmax-xmin)*i/N;
          const y = Math.sqrt(Math.max(0, 1 - x*x));
          const xx = X(x), yy = Y(y);
          if(i===0) ctx.moveTo(xx,yy); else ctx.lineTo(xx,yy);
        }
        ctx.stroke();

        // Legend
        const lx = x1 - 220, ly = y0 + 12;
        ctx.fillStyle = "rgba(0,0,0,0.35)";
        ctx.fillRect(lx, ly, 200, 44);
        ctx.strokeStyle = "rgba(255,255,255,0.12)";
        ctx.strokeRect(lx, ly, 200, 44);

        ctx.strokeStyle = "rgba(125,211,252,0.95)";
        ctx.lineWidth = 2.5;
        ctx.beginPath(); ctx.moveTo(lx+12, ly+18); ctx.lineTo(lx+52, ly+18); ctx.stroke();
        ctx.fillStyle = "rgba(233,238,245,0.9)";
        ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillText("y = √(1 − x²)  (inside gap)", lx+60, ly+22);

        // Note on example/normalized
        ctx.fillStyle = "rgba(169,182,199,0.92)";
        ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillText("Example/normalized units for visualization only", x0, y0+ph+36);
      }

      const ro = new ResizeObserver(draw);
      ro.observe(canvas);
      window.addEventListener('load', draw, {once:true});
    })();
  </script>
</body>
</html>
