<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Kronig–Penney (Delta-Function) Model: Lowest Band Energy at k=0 and Band Gap at k=π/a (P ≪ 1)</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#121a33;
      --card2:#0f1730;
      --text:#eaf0ff;
      --muted:#b8c2e0;
      --accent:#7bd3ff;
      --accent2:#a6ffcb;
      --warn:#ffd37b;
      --danger:#ff8aa6;
      --border:rgba(255,255,255,0.12);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    html{scroll-behavior:smooth;}
    body{
      margin:0;
      font-family: var(--sans);
      background: radial-gradient(1200px 900px at 20% 10%, rgba(123,211,255,0.14), transparent 55%),
                  radial-gradient(1000px 700px at 80% 30%, rgba(166,255,203,0.10), transparent 55%),
                  linear-gradient(180deg, var(--bg), #070a14 60%, #050712);
      color: var(--text);
      line-height: 1.55;
    }
    header{
      padding: 28px 18px 10px;
      max-width: 1200px;
      margin: 0 auto;
    }
    .hero{
      display:grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 18px;
      align-items: stretch;
    }
    @media (max-width: 980px){
      .hero{grid-template-columns: 1fr;}
    }
    .titleCard{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px 18px 14px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    .titleCard:before{
      content:"";
      position:absolute;
      inset:-2px -2px auto auto;
      width: 240px;
      height: 240px;
      background: radial-gradient(circle at 30% 30%, rgba(123,211,255,0.25), transparent 60%);
      transform: translate(40px,-60px);
      filter: blur(2px);
      pointer-events:none;
    }
    h1{
      margin: 0 0 8px;
      font-size: clamp(1.6rem, 2.5vw, 2.2rem);
      letter-spacing: 0.2px;
    }
    .subtitle{
      margin: 0;
      color: var(--muted);
      font-size: 0.98rem;
      max-width: 70ch;
    }
    .metaRow{
      margin-top: 12px;
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .pill{
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.03);
      color: var(--muted);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 0.85rem;
      display:inline-flex;
      align-items:center;
      gap:8px;
      backdrop-filter: blur(6px);
    }
    .pill b{color: var(--text); font-weight: 600;}
    .layout{
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 18px 60px;
      display:grid;
      grid-template-columns: 290px 1fr;
      gap: 18px;
      align-items: start;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns: 1fr;}
    }
    nav{
      position: sticky;
      top: 14px;
      align-self: start;
      background: rgba(18,26,51,0.72);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 12px;
      backdrop-filter: blur(10px);
    }
    @media (max-width: 980px){
      nav{position: relative; top: 0;}
    }
    nav h2{
      font-size: 0.95rem;
      margin: 6px 8px 10px;
      color: var(--text);
      letter-spacing: 0.2px;
    }
    .toc{
      list-style:none;
      padding: 0;
      margin: 0;
      display:flex;
      flex-direction: column;
      gap: 6px;
    }
    .toc a{
      text-decoration:none;
      color: var(--muted);
      border: 1px solid transparent;
      padding: 8px 10px;
      border-radius: 12px;
      display:block;
      transition: transform 120ms ease, border-color 120ms ease, background 120ms ease;
    }
    .toc a:hover{
      border-color: rgba(123,211,255,0.35);
      background: rgba(123,211,255,0.08);
      color: var(--text);
      transform: translateY(-1px);
    }
    main{
      display:flex;
      flex-direction: column;
      gap: 14px;
      min-width: 0;
    }
    section, article{
      background: rgba(18,26,51,0.62);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      backdrop-filter: blur(10px);
      min-width: 0;
    }
    section h2, article h2{
      margin: 0 0 10px;
      font-size: 1.18rem;
      letter-spacing: 0.2px;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 1.02rem;
      color: var(--text);
    }
    p{margin: 8px 0; color: var(--text);}
    ul{margin: 8px 0 8px 20px; color: var(--text);}
    li{margin: 6px 0;}
    .muted{color: var(--muted);}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      align-items: start;
    }
    @media (max-width: 900px){
      .grid2{grid-template-columns: 1fr;}
    }
    .callout{
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border-radius: 16px;
      padding: 12px;
      position: relative;
      overflow: hidden;
    }
    .callout strong{color: var(--text);}
    .callout.assumptions{border-color: rgba(166,255,203,0.25);}
    .callout.equations{border-color: rgba(123,211,255,0.28);}
    .callout.mistakes{border-color: rgba(255,211,123,0.28);}
    .callout.final{border-color: rgba(166,255,203,0.35); background: rgba(166,255,203,0.08);}
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size: 0.82rem;
      color: var(--muted);
      margin-bottom: 8px;
    }
    .tag span{
      width: 10px; height:10px; border-radius:50%;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(123,211,255,0.12);
    }
    .eqBlock{
      margin: 10px 0;
      padding: 12px;
      border-radius: 14px;
      background: rgba(8,12,26,0.55);
      border: 1px dashed rgba(123,211,255,0.35);
      font-family: var(--mono);
      font-size: 0.92rem;
      overflow:auto;
      position: relative;
    }
    .eqTopRow{
      display:flex;
      justify-content: space-between;
      gap: 10px;
      align-items: center;
      margin-bottom: 8px;
    }
    .btn{
      cursor:pointer;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      padding: 7px 10px;
      border-radius: 12px;
      font-size: 0.85rem;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
      user-select:none;
      white-space: nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: rgba(123,211,255,0.35);
      background: rgba(123,211,255,0.08);
    }
    .btn:active{transform: translateY(0px) scale(0.99);}
    details{
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(255,255,255,0.02);
      margin: 10px 0;
    }
    details summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 600;
    }
    details p, details ul{color: var(--muted);}
    .backTop{
      display:inline-block;
      margin-top: 10px;
      text-decoration:none;
      color: var(--accent);
      border-bottom: 1px dashed rgba(123,211,255,0.55);
      padding-bottom: 2px;
    }
    figure{
      margin: 10px 0 0;
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 16px;
      overflow:hidden;
      background: rgba(0,0,0,0.18);
    }
    figcaption{
      padding: 10px 12px;
      color: var(--muted);
      font-size: 0.9rem;
      border-top: 1px solid rgba(255,255,255,0.10);
    }
    canvas{display:block; width:100%; height: 320px;}
    footer{
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px;
      color: var(--muted);
      font-size: 0.92rem;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000;}
      nav{display:none;}
      section, article{box-shadow:none; background:#fff; border: 1px solid #ddd;}
      .eqBlock{background:#fff; color:#000;}
      .btn{display:none;}
      a{color:#000; text-decoration:underline;}
      .layout{grid-template-columns: 1fr;}
      .callout.final{background:#f4fff8;}
      .pageBreak{break-before: page;}
    }

    /* Micro-animation for section entry */
    @keyframes fadeUp{
      from{opacity:0; transform: translateY(6px);}
      to{opacity:1; transform: translateY(0);}
    }
    section, article{animation: fadeUp 220ms ease both;}
  </style>
</head>
<body>
  <a id="top"></a>
  <header>
    <div class="hero">
      <div class="titleCard">
        <h1>Kronig–Penney Model (Delta Lattice): Lowest Band Energy at k = 0 and Band Gap at k = π/a for P ≪ 1</h1>
        <p class="subtitle">
          We solve the 1D periodic Schrödinger eigenvalue problem for a delta-function lattice (weak periodic potential),
          using the exact Kronig–Penney dispersion relation and controlled small-parameter asymptotics.
        </p>
        <div class="metaRow">
          <div class="pill"><b>Model</b> 1D periodic δ-barriers</div>
          <div class="pill"><b>Regime</b> weak potential: P ≪ 1</div>
          <div class="pill"><b>Targets</b> E(k=0) and band gap at k=π/a</div>
          <div class="pill"><b>Style</b> physics + mathematical rigor</div>
        </div>
      </div>
      <div class="titleCard" style="background: linear-gradient(180deg, rgba(166,255,203,0.08), rgba(255,255,255,0.02));">
        <h2 style="margin:0 0 10px; font-size:1.15rem;">Quick Summary</h2>
        <ul style="margin:0 0 0 18px;">
          <li>We study electron bands in a 1D crystal modeled by periodic delta barriers.</li>
          <li>Core idea: Bloch’s theorem + matching across δ’s gives an exact dispersion relation.</li>
          <li>Governing eigenproblem: (−ħ²/2m) d²ψ/dx² + V(x)ψ = Eψ with periodic V(x).</li>
          <li>For δ-lattice, define x = q a with q = √(2mE)/ħ and dimensionless strength P.</li>
          <li>Exact dispersion: cos(k a) = cos(x) + (P/x) sin(x).</li>
          <li>(a) At k=0, lowest-band energy is small but nonzero: E₀ ≈ (ħ² P)/(m a²) (to leading order).</li>
          <li>(b) At k=π/a, the first gap opens; for P ≪ 1, ΔE ≈ (2 ħ² P)/(m a²).</li>
          <li>Physical meaning: weak periodic scattering lifts degeneracies at Brillouin-zone edges, creating band gaps.</li>
        </ul>
      </div>
    </div>
  </header>

  <div class="layout">
    <nav aria-label="Table of contents">
      <h2>Contents</h2>
      <ol class="toc">
        <li><a href="#part0">PART 0 — Concept Primer</a></li>
        <li><a href="#part0b">PART 0B — Industry & Applied Physics</a></li>
        <li><a href="#part1">PART 1 — Problem Analysis</a></li>
        <li><a href="#part2">PART 2 — Strategy & Tips</a></li>
        <li><a href="#part3">PART 3 — Full Solution</a></li>
        <li><a href="#part4">PART 4 — Deeper Understanding</a></li>
        <li><a href="#part5">PART 5 — Optional Plot Guide</a></li>
      </ol>
      <a class="backTop" href="#top">Back to top ↑</a>
    </nav>

    <main>
      <section id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="callout equations">
            <div class="tag"><span></span><strong>Core definitions (symbols &amp; SI units)</strong></div>
            <ul>
              <li><b>x</b> (m): 1D position along the crystal.</li>
              <li><b>a</b> (m): lattice period (spacing between barriers).</li>
              <li><b>ψ(x)</b> (m<sup>−1/2</sup>): wavefunction (normalized in 1D).</li>
              <li><b>E</b> (J): energy eigenvalue.</li>
              <li><b>m</b> (kg): electron effective mass (use <i>m*</i> in materials).</li>
              <li><b>ħ</b> (J·s): reduced Planck constant.</li>
              <li><b>k</b> (m<sup>−1</sup>): Bloch wave number (crystal momentum/ħ), defined modulo 2π/a.</li>
              <li><b>q</b> (m<sup>−1</sup>): free-region wave number, q = √(2mE)/ħ.</li>
              <li><b>P</b> (dimensionless): strength parameter of the δ barriers (defined below).</li>
            </ul>
          </div>

          <div class="callout assumptions">
            <div class="tag"><span style="background:var(--accent2); box-shadow:0 0 0 3px rgba(166,255,203,0.12);"></span>
              <strong>Physical meaning &amp; validity</strong>
            </div>
            <ul>
              <li>Periodic potential causes <b>Bloch waves</b>: ψ(x+a)=e<sup>ika</sup>ψ(x).</li>
              <li>Band gaps appear from <b>Bragg reflection</b> near zone boundaries (k ≈ ±π/a).</li>
              <li>Delta barriers model “thin, strong scattering centers” with negligible width.</li>
              <li>Weak-potential regime P ≪ 1 means small deviation from free-electron dispersion.</li>
            </ul>
          </div>
        </div>

        <h3>Mathematical model (operator form)</h3>
        <p>
          We solve a stationary eigenvalue problem on ℝ with a periodic potential:
        </p>
        <div class="eqBlock" data-copy="eq0">
          <div class="eqTopRow">
            <span class="muted">Key equation (copyable)</span>
            <button class="btn" data-copy-btn="eq0">Copy equation</button>
          </div>
<pre id="eq0">Hψ = Eψ,  where  H = -(ħ^2/2m) d^2/dx^2 + V(x),
V(x+a) = V(x),  and Bloch: ψ(x+a) = e^{ika} ψ(x).</pre>
        </div>

        <p>
          For the δ-function Kronig–Penney model (periodic δ barriers), a common convention is:
        </p>
        <div class="eqBlock" data-copy="eqV">
          <div class="eqTopRow">
            <span class="muted">Delta-lattice potential (copyable)</span>
            <button class="btn" data-copy-btn="eqV">Copy equation</button>
          </div>
<pre id="eqV">V(x) = (ħ^2/m) (P/a) Σ_{n∈ℤ} δ(x - n a).</pre>
        </div>
        <p class="muted">
          Dimensional check: δ has units 1/m, so (ħ²/m)(P/a) has units J·m, and V(x) has units J.
          Thus P is dimensionless.
        </p>

        <h3>Why δ-potentials are “solvable”</h3>
        <ul>
          <li><b>Between</b> delta spikes, V(x)=0, so ψ is a linear combination of e<sup>±iqx</sup>.</li>
          <li>At each δ spike, ψ is continuous, but ψ′ has a <b>jump condition</b> obtained by integrating Schrödinger across an infinitesimal interval.</li>
          <li>Periodic structure + linear ODE → transfer matrices → exact dispersion relation.</li>
        </ul>

        <details>
          <summary>Jump condition across a δ barrier (derivation sketch)</summary>
          <p>
            Integrate (−ħ²/2m)ψ″ + g δ(x)ψ = Eψ across (−ε, +ε). The Eψ term contributes O(ε) → 0.
            Then:
          </p>
          <div class="eqBlock">
<pre>(-ħ^2/2m) [ψ'(0^+) - ψ'(0^-)] + g ψ(0) = 0
⇒ ψ'(0^+) - ψ'(0^-) = (2m g/ħ^2) ψ(0).</pre>
          </div>
          <p class="muted">
            In our convention, g = (ħ²/m)(P/a), so the jump is ψ′(0⁺)−ψ′(0⁻) = (2P/a)ψ(0).
          </p>
        </details>

        <div class="callout" style="margin-top:12px; border-color: rgba(123,211,255,0.18);">
          <div class="tag"><span></span><strong>What to watch for (pitfalls)</strong></div>
          <ul>
            <li><b>Definitions vary:</b> different books define P with factors of 2. Always track your convention in V(x).</li>
            <li><b>q vs k:</b> q is the wave number in free regions; k is the Bloch wave number.</li>
            <li><b>Band edges:</b> occur when |cos(ka)|=1, but there can be multiple q solving the same k.</li>
            <li><b>Small-parameter asymptotics:</b> expand consistently in P and in small deviation ε from special points (x≈0 or x≈π).</li>
          </ul>
        </div>

        <div class="callout equations" style="margin-top:12px;">
          <div class="tag"><span></span><strong>Math Insight</strong></div>
          <p class="muted" style="margin:0;">
            The Kronig–Penney problem is a <b>Sturm–Liouville eigenvalue problem with periodic coefficients</b>.
            Bloch’s theorem reduces it to an eigenvalue problem on one unit cell with quasi-periodic boundary conditions.
            The dispersion relation is essentially the statement that the <b>Floquet multiplier</b> (e^{ika}) equals an eigenvalue of the one-cell transfer matrix.
          </p>
        </div>

        <a class="backTop" href="#top">Back to top ↑</a>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>
        <div class="grid2">
          <div class="callout">
            <div class="tag"><span></span><strong>Where this shows up (3+ application areas)</strong></div>
            <ul>
              <li><b>Semiconductor superlattices</b> (GaAs/AlGaAs, etc.): engineered minibands and minigaps for IR detectors and quantum cascade structures.</li>
              <li><b>Nanofabricated 1D/2D electron systems</b>: patterned gates create periodic potentials; minibands affect mobility and conductance.</li>
              <li><b>Photonic/phononic crystals</b> (analogy): periodic scattering creates band gaps for light/sound; δ-model is a simple “lumped” scatterer idealization.</li>
              <li><b>Thin-film multilayers</b>: periodic interfaces act like strong scatterers (transfer-matrix logic is identical).</li>
            </ul>
          </div>
          <div class="callout assumptions">
            <div class="tag"><span style="background:var(--accent2); box-shadow:0 0 0 3px rgba(166,255,203,0.12);"></span>
              <strong>Why engineers care</strong>
            </div>
            <ul>
              <li><b>Performance:</b> band gaps control allowed transport states → on/off ratios, leakage, tunneling currents.</li>
              <li><b>Reliability:</b> defect scattering and interface roughness perturb minibands; robust design needs gap margins.</li>
              <li><b>Cost/manufacturability:</b> periodic pattern fidelity (a, barrier strength) impacts device yield.</li>
              <li><b>Efficiency:</b> engineered dispersion enables velocity control and density-of-states shaping.</li>
            </ul>
          </div>
        </div>

        <h3>Measurement/validation methods (brief)</h3>
        <ul>
          <li><b>Angle-resolved photoemission (ARPES)</b> (where applicable) or tunneling spectroscopy to infer band edges/minigaps.</li>
          <li><b>Transport</b> (I–V, conductance oscillations) to detect minibands via resonances and temperature dependence.</li>
          <li><b>Optical spectroscopy</b> for intersubband transitions sensitive to miniband structure.</li>
        </ul>

        <h3>Design trade-offs &amp; constraints</h3>
        <ul>
          <li>Real barriers have finite width and nonuniform height; δ-model approximates them when width ≪ a and scattering is dominated by interface discontinuities.</li>
          <li>Tolerances in <b>a</b> (lithography/epitaxy) and in barrier strength map directly into uncertainties in gap size ΔE.</li>
          <li>Effective mass <b>m*</b> varies by material and can be energy-dependent; this rescales all energies via ħ²/(m*a²).</li>
        </ul>

        <details>
          <summary>From lab to product: how the ideal model is adapted</summary>
          <ul>
            <li>Replace δ barriers with finite square barriers/wells and fit an effective P that reproduces the measured minigap.</li>
            <li>Include disorder (random a or barrier height) using perturbation theory or numerical transfer matrices to predict yield and worst-case performance.</li>
            <li>Use effective-mass Schrödinger–Poisson self-consistency for realistic devices; Kronig–Penney remains a fast “first design” estimator.</li>
          </ul>
        </details>

        <a class="backTop" href="#top">Back to top ↑</a>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <p><b>Problem (rephrased):</b> For the Kronig–Penney model with a periodic delta-function potential and weak strength parameter P ≪ 1:</p>
        <ol>
          <li>(a) Find, at k = 0, the energy of the <b>lowest energy band</b> (i.e., the bottom of the first band).</li>
          <li>(b) For the same system, find the <b>band gap</b> at the Brillouin-zone boundary k = π/a.</li>
        </ol>

        <div class="grid2">
          <div class="callout">
            <div class="tag"><span></span><strong>Given quantities</strong></div>
            <ul>
              <li>Lattice period: a</li>
              <li>Electron mass (effective mass): m</li>
              <li>Weak barrier parameter: P ≪ 1 (dimensionless)</li>
              <li>Delta-lattice potential: V(x) = (ħ²/m)(P/a) Σ δ(x−na)</li>
            </ul>
          </div>
          <div class="callout assumptions">
            <div class="tag"><span style="background:var(--accent2); box-shadow:0 0 0 3px rgba(166,255,203,0.12);"></span>
              <strong>Unknowns / targets</strong>
            </div>
            <ul>
              <li>Lowest-band energy at k=0: E₀</li>
              <li>Band gap at k=π/a: ΔE = E<sub>upper</sub> − E<sub>lower</sub></li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles and why they apply</h3>
        <ul>
          <li><b>Bloch’s theorem</b> applies because V(x) is periodic: it constrains solutions via quasi-periodic boundary conditions.</li>
          <li><b>Transfer-matrix / matching conditions</b> apply because the Schrödinger equation is linear and piecewise constant (free) between δ spikes.</li>
          <li><b>Small-parameter asymptotics</b> apply because P ≪ 1; we can expand the exact dispersion relation systematically.</li>
        </ul>

        <div class="callout assumptions">
          <div class="tag"><span style="background:var(--accent2); box-shadow:0 0 0 3px rgba(166,255,203,0.12);"></span>
            <strong>Explicit assumptions</strong>
          </div>
          <ul>
            <li>1D single-particle effective-mass Schrödinger model (no electron-electron interactions).</li>
            <li>Perfect periodicity (no disorder), infinite crystal (or very large N with periodic boundary conditions).</li>
            <li>Weak periodic potential: P ≪ 1, so band effects are small perturbations of free electrons.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare 2–3)</h3>
        <ul>
          <li><b>(A) Exact Kronig–Penney dispersion + asymptotic expansion</b> (best here): gives controlled small-P formulas and clean band-edge identification.</li>
          <li><b>(B) Nearly-free-electron perturbation theory</b>: predicts ΔE ≈ 2|V<sub>G</sub>| at zone boundary; fast intuition, but requires careful mapping of δ strength to Fourier components.</li>
          <li><b>(C) Numerical root-finding</b> for dispersion: robust but not requested; loses symbolic insight.</li>
        </ul>

        <p><b>Chosen approach:</b> (A) Use the exact δ-lattice dispersion relation and expand near k=0 and k=π/a. This yields symbolic leading-order results in P with explicit intermediate steps.</p>

        <a class="backTop" href="#top">Back to top ↑</a>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

        <ol>
          <li><b>Write the exact δ-lattice dispersion</b>: relate cos(ka) to q via a transcendental equation.</li>
          <li><b>Nondimensionalize</b> with x = q a to isolate small parameters cleanly.</li>
          <li><b>(a) Expand near k=0</b>: set cos(ka)=1 and solve for small x using Taylor series, keeping leading order in P.</li>
          <li><b>Convert x to energy</b>: E = ħ²q²/(2m) = ħ²x²/(2m a²).</li>
          <li><b>(b) Expand near zone boundary</b>: set k=π/a so cos(ka)=−1 and solve for x near π (x=π+ε).</li>
          <li><b>Identify two band-edge solutions</b> at the same k=π/a (lower/upper) and compute ΔE from their energies.</li>
          <li><b>Sanity checks</b>: units, P→0 free-electron limit, sign/monotonicity, and scaling with a and m.</li>
        </ol>

        <div class="callout mistakes">
          <div class="tag"><span style="background:var(--warn); box-shadow:0 0 0 3px rgba(255,211,123,0.12);"></span>
            <strong>Common mistakes (quick tips)</strong>
          </div>
          <ul>
            <li>Mixing up <b>k</b> (Bloch) and <b>q</b> (free-region wave number).</li>
            <li>For k=π/a, forgetting there can be <b>multiple</b> q solutions (different bands) at the same k.</li>
            <li>Dropping the wrong terms in expansions: keep the <b>lowest non-vanishing</b> powers of x and P consistently.</li>
            <li>Using a different P convention without adjusting final prefactors.</li>
          </ul>
        </div>

        <a class="backTop" href="#top">Back to top ↑</a>
      </section>

      <article id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Physical intuition before calculation</h3>
        <ul>
          <li>If P → 0, the system becomes a free electron: E = ħ²k²/(2m). The “first band bottom” at k=0 is E=0.</li>
          <li>For small but nonzero P, periodic scattering pushes the lowest allowed energy slightly upward from 0 (here the δ barriers are repulsive in our convention P&gt;0).</li>
          <li>Near k=π/a, Bragg reflection couples ±k states, opening a small gap that scales linearly with the potential strength (nearly-free-electron picture).</li>
        </ul>

        <h3>Step 1: Exact dispersion relation for the δ Kronig–Penney lattice</h3>
        <p>
          For the potential
          <span class="muted">V(x) = (ħ²/m)(P/a) Σ δ(x−na)</span>,
          the Kronig–Penney dispersion relation is:
        </p>

        <div class="eqBlock" data-copy="eqDisp">
          <div class="eqTopRow">
            <span class="muted">Exact dispersion (copyable)</span>
            <button class="btn" data-copy-btn="eqDisp">Copy equation</button>
          </div>
<pre id="eqDisp">Let q = sqrt(2mE)/ħ and x = q a.
Then the δ-lattice Kronig–Penney dispersion is:

cos(k a) = cos(x) + (P/x) sin(x).</pre>
        </div>

        <p class="muted">
          Mathematical note: This comes from multiplying transfer matrices over one unit cell and equating the Floquet multiplier trace:
          Tr(M_cell) = 2 cos(ka). Linearity of the ODE and matching conditions justify the transfer-matrix method.
        </p>

        <div class="callout equations">
          <div class="tag"><span></span><strong>Nondimensionalization &amp; energy mapping</strong></div>
          <p class="muted" style="margin:0;">
            Using x = q a collapses the problem to a transcendental relation between x and ka. Energy is
            E = ħ² q²/(2m) = ħ² x²/(2m a²).
          </p>
        </div>

        <h3>Part (a): Lowest-band energy at k = 0 (P ≪ 1)</h3>
        <p>
          At k=0, we have cos(ka)=cos(0)=1, so the dispersion becomes:
        </p>

        <div class="eqBlock">
<pre>1 = cos(x) + (P/x) sin(x),   where x = q a.</pre>
        </div>

        <p>
          For the <b>lowest</b> band bottom, E is small when P is small, hence q is small and thus x ≪ 1.
          This justifies a Taylor expansion (valid because sin and cos are analytic near 0).
        </p>

        <h3>Step-by-step Taylor expansion (no jumps)</h3>
        <div class="eqBlock">
<pre>cos(x) = 1 - x^2/2 + x^4/24 + O(x^6)
sin(x) = x - x^3/6 + x^5/120 + O(x^7)</pre>
        </div>

        <p>Substitute into 1 = cos(x) + (P/x) sin(x):</p>
        <div class="eqBlock">
<pre>RHS = [1 - x^2/2 + x^4/24 + ...] + (P/x)[x - x^3/6 + x^5/120 + ...]
    = 1 - x^2/2 + x^4/24 + ... + P[1 - x^2/6 + x^4/120 + ...]</pre>
        </div>

        <p>Set RHS = 1 and cancel the 1 on both sides:</p>
        <div class="eqBlock">
<pre>0 = P - x^2/2 - (P x^2)/6 + O(x^4, P x^4).</pre>
        </div>

        <p>
          Since we expect x^2 to scale like P (small potential gives small shift), the leading balance is between P and x² terms.
          Solve for x²:
        </p>

        <div class="eqBlock">
<pre>P = x^2 (1/2 + P/6)
=> x^2 = P / (1/2 + P/6) = 6P/(3+P).</pre>
        </div>

        <p>
          Now use P ≪ 1 to expand (a controlled asymptotic expansion):
        </p>
        <div class="eqBlock">
<pre>6P/(3+P) = 2P * [3/(3+P)] = 2P * [1/(1+P/3)]
        ≈ 2P (1 - P/3 + O(P^2)).</pre>
        </div>

        <p>
          To <b>leading order</b> in P, x² ≈ 2P. Convert to energy:
        </p>
        <div class="eqBlock">
<pre>x = q a,   E = ħ^2 q^2/(2m) = ħ^2 x^2/(2m a^2)
=> E0 ≈ ħ^2 (2P)/(2m a^2) = (ħ^2 P)/(m a^2).</pre>
        </div>

        <div class="callout final" id="finalA">
          <div class="tag"><span style="background:var(--accent2); box-shadow:0 0 0 3px rgba(166,255,203,0.12);"></span>
            <strong>Final result (a): lowest-band energy at k=0</strong>
          </div>
          <div class="eqBlock" data-copy="eqFinalA" style="margin:10px 0 0; border-style: solid;">
            <div class="eqTopRow">
              <span class="muted">Copy plain text</span>
              <button class="btn" data-copy-btn="eqFinalA">Copy final (a)</button>
            </div>
<pre id="eqFinalA">For the δ-lattice Kronig–Penney model with P ≪ 1:

E_lowest(k=0) ≡ E0 ≈ (ħ^2 P)/(m a^2)   (leading order in P).

(Next correction from the same expansion: E0 ≈ (ħ^2 P)/(m a^2) * (1 - P/3 + O(P^2)).</pre>
          </div>
        </div>

        <h3>Part (b): Band gap at k = π/a (zone boundary), P ≪ 1</h3>
        <p>
          At k = π/a, we have cos(ka)=cos(π)=−1. The dispersion becomes:
        </p>
        <div class="eqBlock">
<pre>-1 = cos(x) + (P/x) sin(x).</pre>
        </div>

        <p>
          The first zone boundary corresponds (in the free-electron limit) to x ≈ π, i.e., q ≈ π/a and
          E ≈ ħ²π²/(2m a²). For weak P, the band edges lie near x=π. So set:
        </p>
        <div class="eqBlock">
<pre>x = π + ε,   with |ε| ≪ 1.</pre>
        </div>

        <h3>Expand cos and sin near π</h3>
        <div class="eqBlock">
<pre>cos(π+ε) = -cos(ε) ≈ -(1 - ε^2/2) = -1 + ε^2/2 + O(ε^4)
sin(π+ε) = -sin(ε) ≈ -ε + O(ε^3)</pre>
        </div>

        <p>Substitute into −1 = cos(x) + (P/x) sin(x):</p>
        <div class="eqBlock">
<pre>RHS ≈ (-1 + ε^2/2) + (P/(π+ε))(-ε)
   ≈ -1 + ε^2/2 - (P ε/π) + O(ε^3, P ε^2).</pre>
        </div>

        <p>Set RHS = −1 and cancel −1:</p>
        <div class="eqBlock">
<pre>0 ≈ ε^2/2 - (P/π) ε.</pre>
        </div>

        <p>Factor ε (this is the key band-edge multiplicity at fixed k):</p>
        <div class="eqBlock">
<pre>ε( ε/2 - P/π ) ≈ 0
=> ε1 = 0,  ε2 ≈ 2P/π.</pre>
        </div>

        <p>
          These correspond to <b>two distinct energies at the same Bloch wave number</b> k=π/a:
          one is the upper edge of the first band (lower energy), the other is the lower edge of the second band (higher energy).
        </p>

        <h3>Compute the energies and the gap</h3>
        <p>Energy in terms of x is E = ħ² x²/(2m a²). Therefore:</p>
        <div class="eqBlock">
<pre>E_lower = ħ^2/(2m a^2) (π + ε1)^2 = ħ^2/(2m a^2) π^2

E_upper ≈ ħ^2/(2m a^2) (π + ε2)^2
        = ħ^2/(2m a^2) (π + 2P/π)^2
        = ħ^2/(2m a^2) [π^2 + 4P + O(P^2)].</pre>
        </div>

        <p>Thus the band gap ΔE = E_upper − E_lower is:</p>
        <div class="eqBlock">
<pre>ΔE ≈ ħ^2/(2m a^2) (4P + O(P^2)) = (2 ħ^2 P)/(m a^2) + O(P^2).</pre>
        </div>

        <div class="callout final" id="finalB">
          <div class="tag"><span style="background:var(--accent2); box-shadow:0 0 0 3px rgba(166,255,203,0.12);"></span>
            <strong>Final result (b): band gap at k=π/a</strong>
          </div>
          <div class="eqBlock" data-copy="eqFinalB" style="margin:10px 0 0; border-style: solid;">
            <div class="eqTopRow">
              <span class="muted">Copy plain text</span>
              <button class="btn" data-copy-btn="eqFinalB">Copy final (b)</button>
            </div>
<pre id="eqFinalB">For the δ-lattice Kronig–Penney model with P ≪ 1, at the zone boundary k = π/a:

E_lower(k=π/a) = (ħ^2 π^2)/(2 m a^2)
E_upper(k=π/a) ≈ (ħ^2/(2 m a^2)) (π + 2P/π)^2 ≈ (ħ^2 π^2)/(2 m a^2) + (2 ħ^2 P)/(m a^2)

Band gap:
ΔE ≡ E_upper − E_lower ≈ (2 ħ^2 P)/(m a^2)   (leading order in P).</pre>
          </div>
        </div>

        <h3>Sanity checks</h3>
        <div class="grid2">
          <div class="callout">
            <div class="tag"><span></span><strong>Units / dimensions</strong></div>
            <ul>
              <li>ħ²/(m a²) has units: (J²·s²)/(kg·m²) = J. Good.</li>
              <li>E₀ ~ (ħ²/(m a²)) P → energy, since P is dimensionless.</li>
              <li>ΔE ~ (ħ²/(m a²)) P → energy.</li>
            </ul>
          </div>
          <div class="callout assumptions">
            <div class="tag"><span style="background:var(--accent2); box-shadow:0 0 0 3px rgba(166,255,203,0.12);"></span>
              <strong>Limiting cases &amp; physical meaning</strong>
            </div>
            <ul>
              <li><b>P → 0:</b> E₀ → 0 and ΔE → 0 (free electron recovered).</li>
              <li><b>Smaller a:</b> energies scale up as 1/a² (tighter periodicity → stronger quantization scale).</li>
              <li><b>Larger m:</b> energies scale down as 1/m (heavier effective mass → flatter bands, smaller gaps in energy units).</li>
              <li><b>Sign:</b> For repulsive δ barriers (P&gt;0), the lowest band is pushed upward (E₀&gt;0).</li>
            </ul>
          </div>
        </div>

        <h3>One simple static plot (dimensionless) — how the gap scales with P</h3>
        <p class="muted">
          We plot the leading-order prediction in normalized units: ΔE / (ħ²/(m a²)) ≈ 2P (no numerical constants needed).
        </p>

        <figure>
          <canvas id="gapPlot" aria-label="Band gap scaling plot"></canvas>
          <figcaption>
            Plot of normalized band gap: <span style="font-family:var(--mono);">ΔE / (ħ²/(m a²))</span> versus <span style="font-family:var(--mono);">P</span>.
            In the weak-potential regime, the gap grows linearly with slope 2.
          </figcaption>
        </figure>

        <div class="callout final pageBreak" style="margin-top:14px;">
          <div class="tag"><span style="background:var(--accent2); box-shadow:0 0 0 3px rgba(166,255,203,0.12);"></span>
            <strong>Final Answer (both parts, plain text)</strong>
          </div>

          <div class="eqBlock" data-copy="eqFinalAll" style="margin:10px 0 0; border-style: solid;">
            <div class="eqTopRow">
              <span class="muted">Copy plain text</span>
              <button class="btn" data-copy-btn="eqFinalAll">Copy final answer</button>
            </div>
<pre id="eqFinalAll">δ-lattice Kronig–Penney dispersion (with V(x) = (ħ^2/m)(P/a) Σ δ(x-na)):
cos(k a) = cos(x) + (P/x) sin(x),  where x = q a and q = sqrt(2mE)/ħ.

(a) At k = 0 (lowest band bottom) and P ≪ 1:
E0 ≈ (ħ^2 P)/(m a^2)  (leading order; next: E0 ≈ (ħ^2 P)/(m a^2)(1 - P/3 + ...)).

(b) Band gap at k = π/a and P ≪ 1:
E_lower(k=π/a) = (ħ^2 π^2)/(2 m a^2),
E_upper(k=π/a) ≈ (ħ^2 π^2)/(2 m a^2) + (2 ħ^2 P)/(m a^2),
ΔE ≈ (2 ħ^2 P)/(m a^2)  (leading order).</pre>
          </div>
        </div>

        <a class="backTop" href="#top">Back to top ↑</a>
      </article>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpreting the final formulas</h3>
        <ul>
          <li><b>Energy scale:</b> ħ²/(m a²) is the natural “lattice kinetic energy” scale (set by spacing a and mass m).</li>
          <li><b>Weak scattering:</b> both E₀ and ΔE are proportional to P at leading order; this is the signature of the nearly-free-electron regime.</li>
          <li><b>Why a gap at k=π/a:</b> the periodicity couples states differing by reciprocal lattice vector G=2π/a; at the zone edge, ±k states are degenerate and get split by the periodic potential.</li>
        </ul>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li>Increase <b>P</b> → increase E₀ and increase ΔE (stronger barriers → stronger band effects).</li>
          <li>Increase <b>a</b> → decrease energies like 1/a² (wider lattice spacing → smaller quantization scale).</li>
          <li>Increase <b>m</b> → decrease energies like 1/m (heavier effective mass → lower energy shifts and smaller gaps in eV).</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful): nearly-free-electron theory</h3>
        <p class="muted">
          In nearly-free-electron theory, at the zone boundary the gap is approximately
          ΔE ≈ 2|V<sub>G</sub>| where V<sub>G</sub> is the Fourier component of the periodic potential at reciprocal vector G = 2π/a.
          For a δ lattice, V<sub>G</sub> is essentially the same for all G (up to convention factors), yielding a gap linear in barrier strength.
          The Kronig–Penney expansion above is the “exact-model” confirmation of that linear scaling and fixes the prefactor for the chosen P convention.
        </p>

        <div class="callout equations">
          <div class="tag"><span></span><strong>Concept checks (self-test with answers)</strong></div>
          <ul>
            <li><b>Q:</b> Why can we Taylor expand sin(x) and cos(x) in part (a)? <b>A:</b> Because the lowest-band energy is small when P≪1, implying x=qa≪1; sin and cos are analytic at 0.</li>
            <li><b>Q:</b> Why does a band gap open near k=π/a? <b>A:</b> Bragg reflection makes ±k degenerate; the periodic potential couples them and splits the degeneracy.</li>
            <li><b>Q:</b> Why are there two energies at the same k=π/a? <b>A:</b> Different bands correspond to different q (hence different x) satisfying the same Bloch condition; the dispersion relation can have multiple roots.</li>
            <li><b>Q:</b> What sets the overall energy scale? <b>A:</b> ħ²/(m a²), from kinetic energy with length scale a.</li>
          </ul>
        </div>

        <a class="backTop" href="#top">Back to top ↑</a>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p>
          A plot is useful here because the key engineering takeaway in the weak-potential regime is a <b>linear design rule</b>:
          the minigap scales linearly with the barrier-strength parameter.
        </p>
        <ul>
          <li><b>What it shows:</b> normalized gap ΔE/(ħ²/(m a²)) versus P.</li>
          <li><b>Axes:</b> x-axis = P (dimensionless), y-axis = ΔE/(ħ²/(m a²)) (dimensionless).</li>
          <li><b>Values:</b> No material numbers are needed; the plot is purely symbolic in normalized units.</li>
          <li><b>Feature to notice:</b> straight line with slope 2, illustrating ΔE ≈ 2P·(ħ²/(m a²)).</li>
        </ul>

        <a class="backTop" href="#top">Back to top ↑</a>
      </section>
    </main>
  </div>

  <footer>
    <p>
      Note on conventions: Some texts define the δ strength with a factor of 2 difference, which rescales P and the prefactors in E₀ and ΔE.
      The results above are consistent with the dispersion <span style="font-family:var(--mono);">cos(ka)=cos(x)+(P/x)sin(x)</span> and
      <span style="font-family:var(--mono);">V(x)=(ħ²/m)(P/a)Σδ(x-na)</span>.
    </p>
  </footer>

  <script>
    // Copy-to-clipboard buttons
    (function(){
      function copyTextById(id){
        var el = document.getElementById(id);
        if(!el) return;
        var text = el.innerText;
        navigator.clipboard.writeText(text).then(function(){}, function(){
          // fallback
          var ta = document.createElement("textarea");
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand("copy"); }catch(e){}
          document.body.removeChild(ta);
        });
      }
      document.querySelectorAll("[data-copy-btn]").forEach(function(btn){
        btn.addEventListener("click", function(){
          var id = btn.getAttribute("data-copy-btn");
          copyTextById(id);
          var old = btn.textContent;
          btn.textContent = "Copied!";
          setTimeout(function(){ btn.textContent = old; }, 850);
        });
      });
    })();

    // Canvas plot: ΔE/(ħ^2/(m a^2)) = 2P
    (function(){
      const canvas = document.getElementById("gapPlot");
      if(!canvas) return;

      function draw(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const rect = canvas.getBoundingClientRect();
        const w = Math.max(320, rect.width);
        const h = rect.height || 320;

        canvas.width = Math.floor(w * dpr);
        canvas.height = Math.floor(h * dpr);
        const ctx = canvas.getContext("2d");
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        ctx.clearRect(0,0,w,h);

        // Plot area
        const padL = 56, padR = 18, padT = 34, padB = 44;
        const x0 = padL, y0 = h - padB, x1 = w - padR, y1 = padT;
        const pw = x1 - x0, ph = y0 - y1;

        // Data ranges
        const Pmin = 0, Pmax = 1.0;
        const Ymin = 0, Ymax = 2.2; // a bit above 2 for headroom

        function X(P){ return x0 + (P - Pmin) / (Pmax - Pmin) * pw; }
        function Y(y){ return y0 - (y - Ymin) / (Ymax - Ymin) * ph; }

        // Background
        ctx.fillStyle = "rgba(0,0,0,0.12)";
        ctx.fillRect(x0, y1, pw, ph);

        // Gridlines
        ctx.strokeStyle = "rgba(255,255,255,0.12)";
        ctx.lineWidth = 1;

        const xTicks = 6;
        for(let i=0;i<=xTicks;i++){
          const P = Pmin + (Pmax-Pmin)*i/xTicks;
          const xx = X(P);
          ctx.beginPath();
          ctx.moveTo(xx, y1);
          ctx.lineTo(xx, y0);
          ctx.stroke();
        }
        const yTicks = 6;
        for(let j=0;j<=yTicks;j++){
          const yyVal = Ymin + (Ymax-Ymin)*j/yTicks;
          const yy = Y(yyVal);
          ctx.beginPath();
          ctx.moveTo(x0, yy);
          ctx.lineTo(x1, yy);
          ctx.stroke();
        }

        // Axes
        ctx.strokeStyle = "rgba(255,255,255,0.35)";
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x1, y0);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x0, y1);
        ctx.stroke();

        // Ticks + labels
        ctx.fillStyle = "rgba(234,240,255,0.88)";
        ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "top";
        for(let i=0;i<=xTicks;i++){
          const P = Pmin + (Pmax-Pmin)*i/xTicks;
          const xx = X(P);
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y0+6);
          ctx.stroke();
          ctx.fillText(P.toFixed(1), xx, y0+10);
        }

        ctx.textAlign = "right";
        ctx.textBaseline = "middle";
        for(let j=0;j<=yTicks;j++){
          const yVal = Ymin + (Ymax-Ymin)*j/yTicks;
          const yy = Y(yVal);
          ctx.beginPath();
          ctx.moveTo(x0-6, yy);
          ctx.lineTo(x0, yy);
          ctx.stroke();
          ctx.fillText(yVal.toFixed(1), x0-10, yy);
        }

        // Title
        ctx.textAlign = "left";
        ctx.textBaseline = "alphabetic";
        ctx.font = "600 13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillText("Weak-potential band gap scaling (normalized)", x0, 18);

        // Axis labels
        ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.textAlign = "center";
        ctx.fillText("P (dimensionless)", x0 + pw/2, h - 14);

        ctx.save();
        ctx.translate(16, y1 + ph/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = "center";
        ctx.fillText("ΔE / (ħ²/(m a²)) (dimensionless)", 0, 0);
        ctx.restore();

        // Plot line: y = 2P
        ctx.strokeStyle = "rgba(123,211,255,0.95)";
        ctx.lineWidth = 2.2;
        ctx.beginPath();
        const n = 200;
        for(let i=0;i<=n;i++){
          const P = Pmin + (Pmax-Pmin)*i/n;
          const yVal = 2*P;
          const xx = X(P);
          const yy = Y(yVal);
          if(i===0) ctx.moveTo(xx, yy);
          else ctx.lineTo(xx, yy);
        }
        ctx.stroke();

        // Legend
        const lx = x1 - 170, ly = y1 + 10;
        ctx.fillStyle = "rgba(0,0,0,0.35)";
        ctx.strokeStyle = "rgba(255,255,255,0.14)";
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.roundRect(lx, ly, 160, 36, 10);
        ctx.fill();
        ctx.stroke();

        ctx.strokeStyle = "rgba(123,211,255,0.95)";
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(lx+12, ly+18);
        ctx.lineTo(lx+44, ly+18);
        ctx.stroke();

        ctx.fillStyle = "rgba(234,240,255,0.9)";
        ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.textAlign = "left";
        ctx.textBaseline = "middle";
        ctx.fillText("ΔE/(ħ²/(m a²)) ≈ 2P", lx+52, ly+18);
      }

      // Polyfill for roundRect if needed
      CanvasRenderingContext2D.prototype.roundRect = CanvasRenderingContext2D.prototype.roundRect || function (x, y, w, h, r) {
        const min = Math.min(w, h) / 2;
        r = Math.min(r, min);
        this.beginPath();
        this.moveTo(x + r, y);
        this.arcTo(x + w, y, x + w, y + h, r);
        this.arcTo(x + w, y + h, x, y + h, r);
        this.arcTo(x, y + h, x, y, r);
        this.arcTo(x, y, x + w, y, r);
        this.closePath();
        return this;
      };

      let raf = null;
      function schedule(){
        if(raf) cancelAnimationFrame(raf);
        raf = requestAnimationFrame(draw);
      }
      window.addEventListener("resize", schedule);
      schedule();
    })();
  </script>
</body>
</html>
