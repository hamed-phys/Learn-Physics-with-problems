<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nearly-Free Electron in a 2D Square Lattice: Energy Gap at the Brillouin-Zone Corner</title>
  <style>
    :root{
      --bg:#0b0f17;
      --card:#111a26;
      --muted:#9fb0c3;
      --text:#e7eef8;
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --warn:#ffd166;
      --ok:#7CFFB2;
      --danger:#ff6b6b;
      --line:rgba(255,255,255,0.10);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius:16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(110,231,255,0.12), transparent 55%),
        radial-gradient(1000px 600px at 80% 20%, rgba(167,139,250,0.10), transparent 55%),
        linear-gradient(180deg, #070a10 0%, #0b0f17 45%, #070a10 100%);
      line-height:1.55;
    }

    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}

    header{
      position:relative;
      padding:48px 18px 18px;
      border-bottom:1px solid var(--line);
      overflow:hidden;
    }
    header .wrap{
      max-width:1180px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.2fr 0.8fr;
      gap:18px;
      align-items:start;
    }
    @media (max-width: 980px){
      header .wrap{grid-template-columns:1fr}
    }

    .title{
      background:linear-gradient(90deg, rgba(110,231,255,0.18), rgba(167,139,250,0.14));
      border:1px solid var(--line);
      box-shadow:var(--shadow);
      border-radius:var(--radius);
      padding:22px 20px;
    }
    h1{
      margin:0 0 8px;
      font-size:clamp(22px, 2.6vw, 34px);
      letter-spacing:-0.02em;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      font-size:14.5px;
    }
    .meta{
      margin-top:14px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }
    .pill{
      font-size:12px;
      color:rgba(255,255,255,0.86);
      border:1px solid var(--line);
      background:rgba(255,255,255,0.06);
      padding:6px 10px;
      border-radius:999px;
      backdrop-filter: blur(6px);
    }

    .hero-card{
      border:1px solid var(--line);
      border-radius:var(--radius);
      background:rgba(17,26,38,0.82);
      box-shadow:var(--shadow);
      padding:18px 18px;
    }
    .hero-card h2{
      margin:0 0 10px;
      font-size:16px;
      color:rgba(255,255,255,0.92);
      letter-spacing:0.01em;
    }
    .bullets{
      margin:0;
      padding-left:18px;
      color:var(--muted);
      font-size:14px;
    }
    .bullets li{margin:6px 0}

    main{
      max-width:1180px;
      margin:0 auto;
      padding:18px;
      display:grid;
      grid-template-columns: 290px 1fr;
      gap:18px;
      align-items:start;
    }
    @media (max-width: 980px){
      main{grid-template-columns:1fr}
    }

    nav.toc{
      position:sticky;
      top:14px;
      border:1px solid var(--line);
      border-radius:var(--radius);
      background:rgba(17,26,38,0.70);
      box-shadow:var(--shadow);
      padding:14px;
    }
    nav.toc .toc-title{
      font-weight:700;
      font-size:13px;
      color:rgba(255,255,255,0.9);
      margin:0 0 10px;
      letter-spacing:0.04em;
      text-transform:uppercase;
    }
    nav.toc a{
      display:block;
      padding:8px 10px;
      border-radius:10px;
      color:var(--muted);
      border:1px solid transparent;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
      font-size:13.5px;
    }
    nav.toc a:hover{
      background:rgba(255,255,255,0.06);
      border-color:rgba(255,255,255,0.08);
      transform:translateY(-1px);
      text-decoration:none;
      color:rgba(255,255,255,0.88);
    }

    article{
      border:1px solid var(--line);
      border-radius:var(--radius);
      background:rgba(17,26,38,0.62);
      box-shadow:var(--shadow);
      padding:18px;
      overflow:hidden;
    }

    section{
      padding:12px 0 6px;
      border-top:1px dashed rgba(255,255,255,0.14);
    }
    section:first-of-type{border-top:none}
    h2{
      margin:0 0 10px;
      font-size:20px;
      letter-spacing:-0.01em;
    }
    h3{
      margin:16px 0 8px;
      font-size:16px;
      color:rgba(255,255,255,0.92);
    }
    p{margin:8px 0; color:rgba(231,238,248,0.92)}
    .muted{color:var(--muted)}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 860px){ .grid2{grid-template-columns:1fr} }

    .callout{
      border:1px solid rgba(255,255,255,0.10);
      border-left:3px solid var(--accent);
      background:rgba(255,255,255,0.04);
      border-radius:14px;
      padding:12px 12px;
      margin:10px 0;
    }
    .callout.warn{border-left-color:var(--warn)}
    .callout.ok{border-left-color:var(--ok)}
    .callout.danger{border-left-color:var(--danger)}
    .callout .label{
      font-weight:700;
      font-size:12px;
      letter-spacing:0.06em;
      text-transform:uppercase;
      color:rgba(255,255,255,0.82);
      margin-bottom:6px;
      display:flex;
      align-items:center;
      gap:8px;
    }

    .eqbox{
      position:relative;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(5,8,13,0.55);
      border-radius:14px;
      padding:12px 12px 12px;
      margin:10px 0;
      overflow:auto;
    }
    pre{
      margin:0;
      font-family:var(--mono);
      font-size:13px;
      color:rgba(231,238,248,0.95);
      white-space:pre-wrap;
      word-break:break-word;
      line-height:1.45;
    }
    .copybar{
      display:flex;
      justify-content:flex-end;
      gap:8px;
      margin-bottom:10px;
    }
    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,0.16);
      background:rgba(255,255,255,0.06);
      color:rgba(255,255,255,0.9);
      padding:7px 10px;
      border-radius:12px;
      font-size:12px;
      cursor:pointer;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
      user-select:none;
    }
    .btn:hover{
      background:rgba(255,255,255,0.10);
      border-color:rgba(255,255,255,0.22);
      transform: translateY(-1px);
    }
    .btn:active{transform: translateY(0px) scale(0.99)}
    .btn.small{padding:6px 9px; border-radius:10px; font-size:11.5px}

    details{
      border:1px solid rgba(255,255,255,0.10);
      border-radius:14px;
      background:rgba(255,255,255,0.03);
      padding:10px 12px;
      margin:10px 0;
    }
    summary{
      cursor:pointer;
      font-weight:700;
      color:rgba(255,255,255,0.9);
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    summary:after{
      content:"▾";
      float:right;
      color:rgba(255,255,255,0.65);
      transition: transform 160ms ease;
    }
    details[open] summary:after{transform: rotate(180deg)}

    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:10px;
      font-size:13px;
      color:rgba(255,255,255,0.78);
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.04);
      padding:8px 10px;
      border-radius:12px;
      text-decoration:none;
    }
    .backtop:hover{background:rgba(255,255,255,0.08); text-decoration:none}

    footer{
      max-width:1180px;
      margin:0 auto;
      padding:18px 18px 40px;
      color:var(--muted);
      font-size:13px;
    }

    /* micro animation */
    @keyframes glow{
      0%,100%{box-shadow:0 0 0 rgba(110,231,255,0.0)}
      50%{box-shadow:0 0 18px rgba(110,231,255,0.16)}
    }
    .final-highlight{
      border-left-color: var(--ok);
      animation: glow 2.6s ease-in-out infinite;
    }

    /* print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, nav.toc{display:none}
      article{box-shadow:none; background:#fff; border:1px solid #ccc}
      .callout, .eqbox, details{break-inside:avoid-page}
      a{color:#000; text-decoration:underline}
      .btn{display:none}
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap">
      <div class="title">
        <h1>Square Lattice (2D): Nearly-Free Electron Gap at the Brillouin-Zone Corner</h1>
        <p class="subtitle">
          Using the <strong>central equation</strong> (plane-wave expansion) to compute the band splitting at
          <span style="white-space:nowrap;">k = (π/a, π/a)</span> for
          <span style="font-family:var(--mono);">U(x,y) = -4U cos(2πx/a) cos(2πy/a)</span>.
        </p>
        <div class="meta">
          <span class="pill">Topic: Nearly-free electrons</span>
          <span class="pill">Tool: Central equation</span>
          <span class="pill">Result: Energy gap ΔE = 2U</span>
          <span class="pill">Point: BZ corner (M point)</span>
        </div>
      </div>

      <aside class="hero-card">
        <h2>Quick Summary</h2>
        <ul class="bullets">
          <li><strong>What:</strong> Find the band gap opened by a weak 2D periodic potential at the BZ corner.</li>
          <li><strong>Key idea:</strong> At a Bragg plane, free-electron states become degenerate and couple via a Fourier component <span style="font-family:var(--mono);">U_G</span>.</li>
          <li><strong>Model:</strong> Schrödinger eigenproblem <span style="font-family:var(--mono);">[ -ħ²/(2m) ∇² + U(x,y) ] ψ = E ψ</span> with Bloch waves.</li>
          <li><strong>Central equation:</strong> plane-wave coefficients satisfy a linear algebra system coupling <span style="font-family:var(--mono);">k</span> and <span style="font-family:var(--mono);">k−G</span>.</li>
          <li><strong>At k=(π/a,π/a):</strong> degeneracy between <span style="font-family:var(--mono);">|k⟩</span> and <span style="font-family:var(--mono);">|k−G₁⟩ = |−k⟩</span> with <span style="font-family:var(--mono);">G₁=(2π/a)(1,1)</span>.</li>
          <li><strong>Fourier coefficient:</strong> the potential contains <span style="font-family:var(--mono);">U_{±G₁} = -U</span>.</li>
          <li><strong>2×2 determinant:</strong> eigenvalues <span style="font-family:var(--mono);">E = E₀(k) ± |U_{G₁}|</span>.</li>
          <li><strong>Gap:</strong> <span style="font-family:var(--mono);">ΔE = 2|U_{G₁}| = 2U</span> (symbolic; sign of potential doesn’t matter for the gap size).</li>
        </ul>
      </aside>
    </div>
  </header>

  <main>
    <nav class="toc" aria-label="Table of contents">
      <div class="toc-title">Contents</div>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry & Applied Physics</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy & Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Optional Plot Guide</a>
      <a href="#refs">Notes</a>
    </nav>

    <article>
      <section id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div>
            <h3>Mathematical model (variables, operators, domain)</h3>
            <p class="muted">
              We model a single electron moving in a 2D periodic crystal potential. The governing equation is an
              eigenvalue problem for a linear differential operator.
            </p>

            <div class="eqbox" data-copy="eq1">
              <div class="copybar">
                <button class="btn small" data-copy-btn="eq1">Copy equation</button>
              </div>
              <pre id="eq1">Hamiltonian eigenproblem (2D):
H ψ(r) = E ψ(r),
H = - (ħ^2 / 2m) ∇^2 + U(r),
r = (x, y),  ∇^2 = ∂^2/∂x^2 + ∂^2/∂y^2.

Periodic potential:
U(x+a, y) = U(x, y),  U(x, y+a) = U(x, y).</pre>
            </div>

            <p>
              <strong>Boundary/periodicity condition:</strong> periodicity is in the <em>potential</em>, not necessarily the wavefunction.
              By Bloch’s theorem, eigenfunctions can be taken as
              <span style="font-family:var(--mono);">ψ_{k}(r) = e^{i k·r} u_k(r)</span>, where
              <span style="font-family:var(--mono);">u_k(r)</span> has the lattice periodicity.
            </p>
          </div>

          <div>
            <h3>Core definitions (symbols + SI units)</h3>
            <ul class="bullets">
              <li><span style="font-family:var(--mono);">a</span>: lattice constant (m)</li>
              <li><span style="font-family:var(--mono);">U(x,y)</span>: crystal potential energy (J or eV)</li>
              <li><span style="font-family:var(--mono);">m</span>: electron effective mass (kg) (here: free-electron mass unless stated)</li>
              <li><span style="font-family:var(--mono);">ħ</span>: reduced Planck constant (J·s)</li>
              <li><span style="font-family:var(--mono);">k</span>: crystal wavevector (m⁻¹)</li>
              <li><span style="font-family:var(--mono);">G</span>: reciprocal lattice vector (m⁻¹); for square lattice:
                <span style="font-family:var(--mono);">G = (2π/a)(n_x, n_y)</span>, integers <span style="font-family:var(--mono);">n_x,n_y</span></li>
              <li><span style="font-family:var(--mono);">E₀(k)=ħ²|k|²/(2m)</span>: free-electron energy (J)</li>
            </ul>

            <h3>Physical meaning (intuition)</h3>
            <p>
              In the <strong>nearly-free electron</strong> regime, <span style="font-family:var(--mono);">U(r)</span> is “weak”:
              it mainly perturbs free-electron plane waves. At special <span style="font-family:var(--mono);">k</span>-points where
              two free-electron states are <strong>degenerate</strong>, even a weak periodic potential can cause strong mixing and open a
              <strong>band gap</strong>.
            </p>
          </div>
        </div>

        <h3>Key principles & validity conditions</h3>
        <div class="callout">
          <div class="label">Validity / assumptions</div>
          <ul class="bullets">
            <li>Single-particle Schrödinger model (no electron–electron interactions explicitly).</li>
            <li>Periodic potential with square symmetry; weak enough that a <strong>truncated plane-wave basis</strong> is accurate near the gap.</li>
            <li>Gap at a zone boundary/corner dominated by the <strong>leading Fourier component</strong> that couples degenerate states.</li>
          </ul>
        </div>

        <h3>Central equation (the main tool)</h3>
        <p>
          Expand the periodic part <span style="font-family:var(--mono);">u_k(r)</span> in reciprocal lattice plane waves:
          <span style="font-family:var(--mono);">u_k(r)=∑_G c_{k}(G) e^{i G·r}</span>.
          Then
          <span style="font-family:var(--mono);">ψ_k(r)=∑_G c_{k}(G) e^{i (k+G)·r}</span>.
        </p>

        <div class="eqbox" data-copy="eq2">
          <div class="copybar">
            <button class="btn small" data-copy-btn="eq2">Copy equation</button>
          </div>
          <pre id="eq2">Central equation (plane-wave coefficients):
[ E₀(k+G) - E ] c(G) + ∑_{G'} U_{G-G'} c(G') = 0,

where  E₀(q) = ħ²|q|²/(2m),
and  U_G are Fourier coefficients of U(r):
U(r) = ∑_G U_G e^{i G·r}.</pre>
        </div>

        <details>
          <summary>Math Insight (what kind of mathematical object is this?)</summary>
          <p class="muted">
            The Schrödinger PDE is a linear eigenvalue problem for the self-adjoint operator
            <span style="font-family:var(--mono);">H = -(ħ²/2m)∇² + U(r)</span>.
            Bloch’s theorem converts it into a <strong>countably-infinite Hermitian matrix eigenproblem</strong> in the plane-wave basis.
            Truncating to a small subset near degeneracies yields a low-dimensional Hermitian matrix whose eigenvalue splitting gives the band gap.
          </p>
        </details>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul class="bullets">
          <li><strong>1D analogy:</strong> At <span style="font-family:var(--mono);">k=G/2</span>, states <span style="font-family:var(--mono);">|k⟩</span> and <span style="font-family:var(--mono);">|k-G⟩</span> are degenerate → coupling opens a gap ≈ <span style="font-family:var(--mono);">2|U_G|</span>.</li>
          <li><strong>2D generalization:</strong> The same happens on Bragg planes and at high-symmetry points (like zone corners) when a reciprocal vector links degenerate states.</li>
        </ul>

        <h3>What to watch for (pitfalls)</h3>
        <div class="callout warn">
          <div class="label">What to watch for</div>
          <ul class="bullets">
            <li>Correctly identifying which <span style="font-family:var(--mono);">G</span> actually couples <em>degenerate</em> free-electron states at the point of interest.</li>
            <li>Getting Fourier coefficients right (factors of 2 from cosines are the classic trap).</li>
            <li>Remember: the <strong>gap size</strong> uses <span style="font-family:var(--mono);">|U_G|</span>; the sign affects which branch is higher/lower, not the gap magnitude.</li>
          </ul>
        </div>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>
        <p>
          Band gaps created (or tuned) by periodic potentials are a cornerstone of modern engineered materials.
          In industry, the “periodic potential” can come from real atomic lattices, superlattices, strain patterns, or lithographically defined potentials.
        </p>

        <div class="grid2">
          <div class="callout">
            <div class="label">Where this appears (3+ concrete areas)</div>
            <ul class="bullets">
              <li><strong>Semiconductor & microelectronics:</strong> band edges and gaps govern carrier density, leakage, and switching behavior (CMOS, power devices).</li>
              <li><strong>2D materials & moiré engineering:</strong> periodic moiré potentials open mini-gaps and reshape dispersions (twisted bilayers, van der Waals heterostructures).</li>
              <li><strong>Photonics/phononics & metamaterials:</strong> mathematically analogous “band gaps” (stop bands) arise from periodic refractive index or elastic moduli.</li>
              <li><strong>Surface science:</strong> electrons in surface states feel 2D periodic corrugations; gaps influence adsorption and catalytic properties.</li>
            </ul>
          </div>

          <div class="callout">
            <div class="label">Why engineers care</div>
            <ul class="bullets">
              <li><strong>Performance:</strong> gap size affects on/off ratios, mobility trade-offs, and thermal activation.</li>
              <li><strong>Reliability:</strong> band structure controls hot-carrier effects and breakdown paths.</li>
              <li><strong>Cost/manufacturability:</strong> periodicity and potential strength depend on fabrication tolerances (strain, lithography, composition control).</li>
              <li><strong>Efficiency:</strong> band alignment impacts contact resistance and energy losses.</li>
            </ul>
          </div>
        </div>

        <div class="callout ok">
          <div class="label">How it’s validated in practice</div>
          <ul class="bullets">
            <li><strong>ARPES</strong> (angle-resolved photoemission) maps electronic dispersions and gaps in momentum space.</li>
            <li><strong>Transport</strong> (conductivity vs temperature/field) infers gaps from activation and magnetotransport signatures.</li>
            <li><strong>STM/STS</strong> probes local density of states and can detect gap openings on surfaces.</li>
          </ul>
        </div>

        <details>
          <summary>From lab to product: adapting the ideal model</summary>
          <p class="muted">
            Real devices deviate from the ideal nearly-free picture: disorder broadens bands, finite thickness adds subbands,
            strain and interfaces break symmetries, and electron–electron interactions renormalize effective masses and gaps.
            Engineers often keep the same core framework (Bloch waves + Fourier components) but use <em>effective</em> parameters
            extracted from experiments or higher-fidelity simulations (DFT, k·p, tight-binding).
          </p>
        </details>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <h3>Problem restatement</h3>
        <p>
          We have a 2D square lattice with potential
          <span style="font-family:var(--mono);">U(x,y) = -4U cos(2πx/a) cos(2πy/a)</span>.
          Using the central equation, find an approximate <strong>energy gap</strong> at the Brillouin-zone corner
          <span style="font-family:var(--mono);">k = (π/a, π/a)</span>. We are told a <strong>2×2 determinant</strong> suffices.
        </p>

        <div class="grid2">
          <div class="callout">
            <div class="label">Given</div>
            <ul class="bullets">
              <li>Lattice constant <span style="font-family:var(--mono);">a</span></li>
              <li>Potential amplitude parameter <span style="font-family:var(--mono);">U</span> (energy units)</li>
              <li>Periodic potential form in 2D</li>
              <li>Target point: <span style="font-family:var(--mono);">(π/a, π/a)</span></li>
            </ul>
          </div>
          <div class="callout">
            <div class="label">Unknowns / must find</div>
            <ul class="bullets">
              <li>Gap size <span style="font-family:var(--mono);">ΔE</span> between the two split bands at that k-point</li>
              <li>Relevant Fourier coefficient(s) <span style="font-family:var(--mono);">U_G</span> causing the splitting</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (and why)</h3>
        <ul class="bullets">
          <li><strong>Bloch theorem:</strong> periodic potential → label states by crystal momentum <span style="font-family:var(--mono);">k</span>.</li>
          <li><strong>Plane-wave/Fourier method:</strong> the central equation is the direct perturbative framework for weak periodic potentials.</li>
          <li><strong>Degenerate perturbation / 2×2 truncation:</strong> near a zone boundary where two plane waves are degenerate, the infinite system reduces to a small coupled subspace.</li>
        </ul>

        <div class="callout warn">
          <div class="label">Explicit assumptions for this problem</div>
          <ul class="bullets">
            <li><strong>Nearly-free electron:</strong> keep only the dominant coupling between the two degenerate plane waves.</li>
            <li>Ignore higher-order couplings to remote <span style="font-family:var(--mono);">k+G</span> states (their energy denominators are large).</li>
            <li>Use free-electron dispersion for the diagonal terms: <span style="font-family:var(--mono);">E₀(q)=ħ²|q|²/(2m)</span>.</li>
          </ul>
        </div>

        <h3>Possible approaches (2–3) and comparison</h3>
        <div class="grid2">
          <div class="callout">
            <div class="label">Approach A: Central equation (recommended)</div>
            <ul class="bullets">
              <li><strong>Pros:</strong> matches the prompt; clean 2×2 determinant; directly yields gap.</li>
              <li><strong>Cons:</strong> must compute Fourier coefficients carefully.</li>
            </ul>
          </div>
          <div class="callout">
            <div class="label">Approach B: Degenerate perturbation theory</div>
            <ul class="bullets">
              <li><strong>Pros:</strong> conceptually simple: diagonalize perturbation in degenerate subspace.</li>
              <li><strong>Cons:</strong> essentially the same math as the 2×2 central equation; still needs <span style="font-family:var(--mono);">U_G</span>.</li>
            </ul>
          </div>
        </div>
        <p>
          We choose <strong>Approach A</strong> because it is exactly what the problem requests and naturally produces the 2×2 determinant.
        </p>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

        <ol class="bullets">
          <li><strong>Goal:</strong> rewrite <span style="font-family:var(--mono);">U(x,y)</span> as a Fourier sum. <strong>Tool:</strong> trig-to-exponential identities. <strong>Meaning:</strong> identifies which reciprocal vectors exist in the potential.</li>
          <li><strong>Goal:</strong> list nonzero <span style="font-family:var(--mono);">U_G</span> and their values. <strong>Tool:</strong> compare to <span style="font-family:var(--mono);">U(r)=∑ U_G e^{iG·r}</span>. <strong>Meaning:</strong> coupling strengths.</li>
          <li><strong>Goal:</strong> determine which <span style="font-family:var(--mono);">G</span> connects degenerate states at <span style="font-family:var(--mono);">k=(π/a,π/a)</span>. <strong>Tool:</strong> degeneracy condition <span style="font-family:var(--mono);">E₀(k)=E₀(k−G)</span>. <strong>Meaning:</strong> the relevant 2D Bragg reflection.</li>
          <li><strong>Goal:</strong> write the 2×2 truncated central-equation matrix for the two coupled plane waves. <strong>Tool:</strong> central equation with only those two coefficients. <strong>Meaning:</strong> reduced Hermitian eigenproblem.</li>
          <li><strong>Goal:</strong> solve determinant for <span style="font-family:var(--mono);">E</span>. <strong>Tool:</strong> quadratic equation. <strong>Meaning:</strong> band splitting and gap size.</li>
          <li><strong>Goal:</strong> report the gap and do sanity checks (units, limits). <strong>Tool:</strong> dimensional analysis + physical interpretation.</li>
        </ol>

        <div class="callout danger">
          <div class="label">Common mistakes</div>
          <ul class="bullets">
            <li>Dropping a factor of 2 when converting <span style="font-family:var(--mono);">cos</span> to exponentials.</li>
            <li>Using the wrong reciprocal vector: at the corner, the key one is <span style="font-family:var(--mono);">G=(2π/a)(1,1)</span>, not <span style="font-family:var(--mono);">(2π/a)(1,0)</span> or <span style="font-family:var(--mono);">(2π/a)(0,1)</span>.</li>
            <li>Confusing “gap” (difference between split eigenvalues) with the shift of one eigenvalue.</li>
          </ul>
        </div>
      </section>

      <section id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation (before calculating)</h3>
        <p>
          At a Brillouin-zone corner, free-electron plane waves often meet a Bragg condition.
          When a reciprocal lattice vector <span style="font-family:var(--mono);">G</span> satisfies <span style="font-family:var(--mono);">k = G/2</span>,
          the states <span style="font-family:var(--mono);">|k⟩</span> and <span style="font-family:var(--mono);">|k−G⟩ = |−k⟩</span> have the same free energy.
          A weak periodic potential couples them and splits the degeneracy, opening a gap proportional to the relevant Fourier coefficient <span style="font-family:var(--mono);">U_G</span>.
        </p>

        <h3>Step 1: Fourier-expand the potential</h3>
        <p>
          Start from
          <span style="font-family:var(--mono);">U(x,y) = -4U cos(2πx/a) cos(2πy/a)</span>.
          Use the identity <span style="font-family:var(--mono);">cos A cos B = (1/2)[cos(A+B)+cos(A-B)]</span>.
          Let
          <span style="font-family:var(--mono);">A=2πx/a</span>, <span style="font-family:var(--mono);">B=2πy/a</span>.
        </p>

        <div class="eqbox" data-copy="eq3">
          <div class="copybar">
            <button class="btn small" data-copy-btn="eq3">Copy steps</button>
          </div>
          <pre id="eq3">U(x,y) = -4U cosA cosB
       = -4U * (1/2)[cos(A+B) + cos(A-B)]
       = -2U[ cos(2π(x+y)/a) + cos(2π(x-y)/a) ].</pre>
        </div>

        <p>
          Now convert each cosine to exponentials:
          <span style="font-family:var(--mono);">cos θ = (e^{iθ}+e^{-iθ})/2</span>.
          Then
          <span style="font-family:var(--mono);">-2U cos θ = -U(e^{iθ}+e^{-iθ})</span>.
          Therefore, each cosine contributes <strong>two</strong> reciprocal vectors with coefficient <strong>-U</strong>.
        </p>

        <div class="callout ok">
          <div class="label">Nonzero Fourier components</div>
          <p class="muted" style="margin-top:0">
            Compare to <span style="font-family:var(--mono);">U(r) = ∑_G U_G e^{iG·r}</span>.
            The phases are <span style="font-family:var(--mono);">2π(x±y)/a = (2π/a)(1,±1)·(x,y)</span>.
          </p>
          <div class="eqbox" data-copy="eq4" style="margin-bottom:0">
            <div class="copybar">
              <button class="btn small" data-copy-btn="eq4">Copy result</button>
            </div>
            <pre id="eq4">Reciprocal vectors present:
G1 = (2π/a)( 1,  1),   -G1
G2 = (2π/a)( 1, -1),   -G2

Fourier coefficients:
U_{+G1} = U_{-G1} = -U
U_{+G2} = U_{-G2} = -U
All other U_G = 0 (including G=0 ⇒ zero average potential).</pre>
          </div>
        </div>

        <h3>Step 2: Identify the degenerate pair at k=(π/a,π/a)</h3>
        <p>
          The free-electron dispersion in 2D is
          <span style="font-family:var(--mono);">E₀(q) = ħ²|q|²/(2m)</span>.
          Degeneracy required for a strong gap in the nearly-free model is:
        </p>

        <div class="eqbox" data-copy="eq5">
          <div class="copybar">
            <button class="btn small" data-copy-btn="eq5">Copy condition</button>
          </div>
          <pre id="eq5">Degeneracy (Bragg) condition for coupling by G:
E₀(k) = E₀(k - G)
⇔ |k|² = |k - G|².</pre>
        </div>

        <p>
          Take the corner point
          <span style="font-family:var(--mono);">k = (π/a, π/a)</span>.
          Notice that
          <span style="font-family:var(--mono);">G1 = (2π/a)(1,1)</span>
          satisfies
          <span style="font-family:var(--mono);">k = G1/2</span>.
          Then
          <span style="font-family:var(--mono);">k - G1 = -k</span>,
          and clearly <span style="font-family:var(--mono);">|k| = |-k|</span>, so the degeneracy holds exactly.
        </p>

        <details>
          <summary>Quick check that G2 does NOT create a degeneracy here</summary>
          <p class="muted">
            With <span style="font-family:var(--mono);">G2=(2π/a)(1,-1)</span>, we get
            <span style="font-family:var(--mono);">k-G2 = (π/a-2π/a, π/a+2π/a)=(-π/a, 3π/a)</span>.
            Then <span style="font-family:var(--mono);">|k|²=2(π/a)²</span> but <span style="font-family:var(--mono);">|k-G2|²=10(π/a)²</span>,
            not degenerate—so its effect on the gap at this point is much smaller (higher-order).
          </p>
        </details>

        <h3>Step 3: Write the 2×2 truncated central equation</h3>
        <p>
          Near this degeneracy, keep only the two plane-wave components corresponding to
          <span style="font-family:var(--mono);">|k⟩</span> and <span style="font-family:var(--mono);">|k-G1⟩</span>.
          In the central equation, this means we retain only two coefficients:
          <span style="font-family:var(--mono);">c_1 ≡ c(G=0)</span> (for wavevector <span style="font-family:var(--mono);">k</span>)
          and
          <span style="font-family:var(--mono);">c_2 ≡ c(G=-G1)</span> (for wavevector <span style="font-family:var(--mono);">k-G1</span>).
        </p>

        <p class="muted">
          Why this truncation is valid: the operator is linear and the plane-wave basis diagonalizes the kinetic term;
          near a degeneracy, the two nearly-equal diagonal energies dominate, while couplings to distant states have large diagonal detunings
          <span style="font-family:var(--mono);">E₀(k+G)-E</span> and contribute mainly small second-order corrections.
        </p>

        <div class="eqbox" data-copy="eq6">
          <div class="copybar">
            <button class="btn small" data-copy-btn="eq6">Copy 2×2 system</button>
          </div>
          <pre id="eq6">Let E0 ≡ E₀(k) = E₀(k-G1) (degenerate free-electron energy).

Truncated central equations:
(E0 - E) c1 + U_{G1} c2 = 0
U_{-G1} c1 + (E0 - E) c2 = 0

Matrix form:
[ E0 - E      U_{G1} ] [c1] = [0]
[ U_{-G1}     E0 - E ] [c2]   [0].</pre>
        </div>

        <p>
          Here we use that the potential is real, so
          <span style="font-family:var(--mono);">U_{-G} = U_G*</span>.
          In our case <span style="font-family:var(--mono);">U_{±G1}=-U</span>, which is real.
        </p>

        <h3>Step 4: Solve the 2×2 determinant → band splitting</h3>
        <p>
          Nontrivial solutions require the determinant to vanish:
        </p>

        <div class="eqbox" data-copy="eq7">
          <div class="copybar">
            <button class="btn small" data-copy-btn="eq7">Copy determinant</button>
          </div>
          <pre id="eq7">det | E0 - E      U_{G1} |
    | U_{-G1}     E0 - E | = 0

⇒ (E0 - E)^2 - U_{G1} U_{-G1} = 0
⇒ (E0 - E)^2 - |U_{G1}|^2 = 0.</pre>
        </div>

        <p>
          Solve for <span style="font-family:var(--mono);">E</span>:
          <span style="font-family:var(--mono);">E = E0 ± |U_{G1}|</span>.
          Since <span style="font-family:var(--mono);">U_{G1}=-U</span>, we have <span style="font-family:var(--mono);">|U_{G1}|=U</span>.
        </p>

        <div class="callout ok final-highlight">
          <div class="label">Final answer</div>
          <div class="eqbox" data-copy="final">
            <div class="copybar">
              <button class="btn" data-copy-btn="final">Copy final answer</button>
            </div>
            <pre id="final">At k = (π/a, π/a) the degenerate free-electron states |k⟩ and |k−G1⟩ with G1=(2π/a)(1,1) are coupled by U_{G1} = -U.

Eigen-energies at the zone corner:
E± = E₀(k) ± |U_{G1}| = E₀(k) ± U,

so the band gap is:
ΔE = E+ − E− = 2|U_{G1}| = 2U.</pre>
          </div>
        </div>

        <h3>Sanity checks</h3>
        <div class="grid2">
          <div class="callout">
            <div class="label">Units / dimensions</div>
            <p class="muted">
              <span style="font-family:var(--mono);">U</span> is an energy scale (J or eV), so <span style="font-family:var(--mono);">ΔE=2U</span> is also energy — consistent.
            </p>
          </div>
          <div class="callout">
            <div class="label">Limiting cases</div>
            <ul class="bullets">
              <li><strong>U → 0:</strong> <span style="font-family:var(--mono);">ΔE → 0</span>, recovering free-electron degeneracy.</li>
              <li><strong>Small U:</strong> splitting linear in <span style="font-family:var(--mono);">U</span>, exactly what degenerate perturbation predicts.</li>
            </ul>
          </div>
        </div>

        <details>
          <summary>Optional: compute E₀(k) explicitly (not required for the gap)</summary>
          <div class="eqbox" data-copy="eq8">
            <div class="copybar">
              <button class="btn small" data-copy-btn="eq8">Copy</button>
            </div>
            <pre id="eq8">k = (π/a, π/a) ⇒ |k|² = (π/a)² + (π/a)² = 2(π/a)².

So E₀(k) = ħ²|k|²/(2m) = ħ²/(2m) * 2(π/a)² = (ħ² π²)/(m a²).</pre>
          </div>
          <p class="muted">
            The gap depends only on the coupling <span style="font-family:var(--mono);">|U_G|</span> at first order; the absolute location of the split energies is centered at <span style="font-family:var(--mono);">E₀(k)</span>.
          </p>
        </details>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpreting the formula ΔE = 2U</h3>
        <p>
          The result
          <span style="font-family:var(--mono);">ΔE = 2|U_G|</span>
          is the hallmark of a <strong>two-level Hermitian coupling</strong>:
          when two basis states are degenerate (same diagonal energy) and coupled by an off-diagonal matrix element <span style="font-family:var(--mono);">U_G</span>,
          the eigenvalues split symmetrically about the original energy by <span style="font-family:var(--mono);">±|U_G|</span>.
        </p>

        <div class="callout">
          <div class="label">What controls the gap?</div>
          <ul class="bullets">
            <li><strong>Potential strength:</strong> larger <span style="font-family:var(--mono);">U</span> → larger gap (linear here).</li>
            <li><strong>Fourier “selection rule”:</strong> only reciprocal vectors present in the potential can open gaps at points they connect via degeneracy.</li>
            <li><strong>Symmetry / k-point:</strong> at different k-points, different <span style="font-family:var(--mono);">G</span> will matter (or none will, if no degeneracy is connected).</li>
          </ul>
        </div>

        <h3>Parameter dependence (qualitative)</h3>
        <ul class="bullets">
          <li>Increasing <span style="font-family:var(--mono);">U</span> increases <span style="font-family:var(--mono);">ΔE</span> proportionally (in this first-order, two-state approximation).</li>
          <li>Changing <span style="font-family:var(--mono);">a</span> does <em>not</em> change <span style="font-family:var(--mono);">ΔE</span> directly in this result; it changes where the degeneracy occurs in k-space and the kinetic energy center <span style="font-family:var(--mono);">E₀(k)</span>.</li>
          <li>Changing <span style="font-family:var(--mono);">m</span> affects <span style="font-family:var(--mono);">E₀(k)</span> but not the first-order gap size (again, within this simplified truncation).</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          You can treat <span style="font-family:var(--mono);">U(r)</span> as a perturbation and perform
          <strong>degenerate perturbation theory</strong> in the subspace spanned by plane waves
          <span style="font-family:var(--mono);">|k⟩</span> and <span style="font-family:var(--mono);">|k-G1⟩</span>.
          The perturbation matrix element between these two is exactly the Fourier coefficient <span style="font-family:var(--mono);">U_{G1}</span>.
          Diagonalizing the 2×2 perturbation matrix yields the same splitting <span style="font-family:var(--mono);">±|U_{G1}|</span>.
        </p>

        <h3>Concept check (self-test)</h3>
        <ul class="bullets">
          <li><strong>Q:</strong> Why does a gap open only at special k-points? <br><strong>A:</strong> Because strong first-order splitting requires degeneracy (or near-degeneracy) between states connected by a reciprocal vector.</li>
          <li><strong>Q:</strong> What is the physical meaning of <span style="font-family:var(--mono);">U_G</span>? <br><strong>A:</strong> It is the amplitude for scattering a plane wave by crystal momentum <span style="font-family:var(--mono);">G</span>; it sets the coupling between <span style="font-family:var(--mono);">k</span> and <span style="font-family:var(--mono);">k−G</span>.</li>
          <li><strong>Q:</strong> If the potential sign flips (<span style="font-family:var(--mono);">U → -U</span>), does the gap change? <br><strong>A:</strong> No, the gap depends on <span style="font-family:var(--mono);">|U_G|</span>, so the magnitude is unchanged; the ordering of the two eigenstates swaps.</li>
          <li><strong>Q:</strong> Why is a 2×2 truncation enough here? <br><strong>A:</strong> Only one reciprocal vector <span style="font-family:var(--mono);">G1</span> present in the potential connects the exactly degenerate pair at this k-point; other couplings are off-resonant and smaller.</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p class="muted">
          A plot isn’t necessary here because the result is purely symbolic and the key learning is the <strong>two-level splitting</strong>
          <span style="font-family:var(--mono);">E± = E₀ ± U</span>. Any plot would require choosing numerical values for <span style="font-family:var(--mono);">U</span> and would not add much insight beyond “the gap grows linearly with U,” which is already explicit in <span style="font-family:var(--mono);">ΔE=2U</span>.
        </p>
      </section>

      <section id="refs">
        <h2>Notes</h2>
        <details open>
          <summary>Dimensional analysis (quick)</summary>
          <p class="muted">
            <span style="font-family:var(--mono);">ħ²/(m a²)</span> has units of energy (J), matching <span style="font-family:var(--mono);">E₀(k)</span>.
            The Fourier coefficient <span style="font-family:var(--mono);">U</span> is given as an energy scale in the potential, so <span style="font-family:var(--mono);">ΔE=2U</span> is consistent.
          </p>
        </details>

        <details>
          <summary>Why the step “keep only two plane waves” is mathematically justified (short)</summary>
          <p class="muted">
            The central equation is an infinite linear system. At <span style="font-family:var(--mono);">k=G1/2</span>, the diagonal terms
            for <span style="font-family:var(--mono);">G=0</span> and <span style="font-family:var(--mono);">G=-G1</span> are exactly equal
            (<span style="font-family:var(--mono);">E₀(k)=E₀(k-G1)</span>), so the off-diagonal coupling produces an O(U) effect.
            Couplings to other <span style="font-family:var(--mono);">G</span> have diagonal mismatches O(ħ²(2π/a)²/2m), so their influence is
            typically O(U²/Δ) (second order) and small in the nearly-free regime.
          </p>
        </details>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>
    </article>
  </main>

  <footer>
    <p>
      Built as a self-contained learning article: nearly-free electrons, Fourier components, and a 2×2 central-equation determinant.
      Tip: if you later study other high-symmetry points, repeat the same workflow—(i) find which reciprocal vectors exist in U(r),
      (ii) check degeneracies, (iii) diagonalize the minimal coupled subspace.
    </p>
  </footer>

  <script>
    (function(){
      function copyText(id){
        const el = document.getElementById(id);
        if(!el) return;
        const txt = el.innerText;
        navigator.clipboard.writeText(txt).then(()=>{
          flashCopied(id);
        }).catch(()=>{
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = txt;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          try{ document.execCommand('copy'); flashCopied(id); }catch(e){}
          document.body.removeChild(ta);
        });
      }

      function flashCopied(id){
        const btns = document.querySelectorAll('[data-copy-btn="'+id+'"]');
        btns.forEach(btn=>{
          const old = btn.textContent;
          btn.textContent = 'Copied!';
          btn.style.borderColor = 'rgba(124,255,178,0.55)';
          btn.style.background = 'rgba(124,255,178,0.12)';
          setTimeout(()=>{
            btn.textContent = old;
            btn.style.borderColor = '';
            btn.style.background = '';
          }, 900);
        });
      }

      document.querySelectorAll('[data-copy-btn]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.getAttribute('data-copy-btn');
          copyText(id);
        });
      });
    })();
  </script>
</body>
</html>
