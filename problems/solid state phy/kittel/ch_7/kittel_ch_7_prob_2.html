<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Free-Electron Energy Bands in the Reduced Zone (fcc, [111]) — Empty Lattice</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#0f1733;
      --ink:#e9ecff;
      --muted:#b8c0ff;
      --faint:#92a0ff;
      --accent:#7aa7ff;
      --accent2:#7cffc9;
      --warn:#ffd37a;
      --ok:#a6ff9e;
      --bad:#ff8aa3;
      --line:rgba(255,255,255,.12);
      --shadow: 0 14px 34px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      --serif: ui-serif, Georgia, "Times New Roman", Times, serif;
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 12% 8%, rgba(122,167,255,.25), transparent 55%),
        radial-gradient(900px 600px at 90% 22%, rgba(124,255,201,.18), transparent 50%),
        radial-gradient(900px 600px at 40% 95%, rgba(255,138,163,.12), transparent 55%),
        linear-gradient(180deg, #070a14, var(--bg) 55%, #070a14);
      line-height:1.55;
    }

    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}

    header{
      padding:28px 18px 8px;
      max-width:1200px;
      margin:0 auto;
    }
    .hero{
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      padding:22px 18px;
      display:grid;
      gap:10px;
    }
    .kicker{
      color:var(--muted);
      letter-spacing:.08em;
      text-transform:uppercase;
      font-size:.82rem;
    }
    h1{
      margin:0;
      font-size: clamp(1.35rem, 2.4vw, 2.05rem);
      line-height:1.15;
    }
    .sub{
      margin:0;
      color:rgba(233,236,255,.85);
      max-width:72ch;
    }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      color:rgba(233,236,255,.75);
      font-size:.95rem;
    }
    .pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
    }
    .dot{
      width:8px;height:8px;border-radius:99px;
      background:var(--accent2);
      box-shadow:0 0 0 3px rgba(124,255,201,.15);
    }

    main{
      max-width:1200px;
      margin:0 auto;
      padding:18px;
      display:grid;
      grid-template-columns: 1fr;
      gap:16px;
    }

    @media (min-width: 980px){
      main{
        grid-template-columns: 340px 1fr;
        align-items:start;
      }
    }

    nav.toc{
      position:sticky;
      top:14px;
      align-self:start;
      border:1px solid var(--line);
      border-radius:var(--radius);
      background:rgba(255,255,255,.03);
      box-shadow:var(--shadow);
      padding:14px;
      overflow:hidden;
    }
    nav.toc h2{
      margin:0 0 10px;
      font-size:1.02rem;
      letter-spacing:.02em;
    }
    .toc a{
      display:block;
      padding:7px 8px;
      border-radius:10px;
      color:rgba(233,236,255,.85);
      border:1px solid transparent;
    }
    .toc a:hover{
      background:rgba(122,167,255,.08);
      border-color:rgba(122,167,255,.22);
      text-decoration:none;
    }
    .toc .small{
      margin-top:10px;
      color:rgba(233,236,255,.70);
      font-size:.9rem;
    }
    .toc .toplink{
      margin-top:10px;
      display:inline-block;
      padding:7px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
    }

    article{
      border:1px solid var(--line);
      border-radius:var(--radius);
      background:rgba(255,255,255,.03);
      box-shadow:var(--shadow);
      padding:18px;
      min-width:0;
    }

    section{padding:8px 0}
    section + section{border-top:1px solid rgba(255,255,255,.08); margin-top:12px}
    h2{
      margin:8px 0 8px;
      font-size:1.25rem;
    }
    h3{
      margin:14px 0 8px;
      font-size:1.05rem;
      color:rgba(233,236,255,.95);
    }
    p{margin:8px 0; color:rgba(233,236,255,.86)}
    ul{margin:8px 0 8px 18px; color:rgba(233,236,255,.86)}
    li{margin:6px 0}

    .grid2{
      display:grid;
      gap:12px;
      grid-template-columns: 1fr;
    }
    @media (min-width: 860px){
      .grid2{grid-template-columns: 1fr 1fr;}
    }

    .card{
      border:1px solid var(--line);
      border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      padding:14px;
      box-shadow: 0 10px 24px rgba(0,0,0,.22);
      min-width:0;
    }

    .callout{
      border-left:4px solid var(--accent);
      background:rgba(122,167,255,.08);
      padding:12px 12px 12px 12px;
      border-radius:14px;
      border:1px solid rgba(122,167,255,.22);
    }
    .callout.warn{
      border-left-color:var(--warn);
      background:rgba(255,211,122,.10);
      border-color:rgba(255,211,122,.22);
    }
    .callout.ok{
      border-left-color:var(--ok);
      background:rgba(166,255,158,.09);
      border-color:rgba(166,255,158,.18);
    }
    .callout.bad{
      border-left-color:var(--bad);
      background:rgba(255,138,163,.09);
      border-color:rgba(255,138,163,.18);
    }

    .eq{
      position:relative;
      border:1px dashed rgba(255,255,255,.18);
      background:rgba(0,0,0,.18);
      border-radius:14px;
      padding:12px 12px 10px;
      font-family:var(--mono);
      color:rgba(233,236,255,.92);
      overflow:auto;
      line-height:1.45;
    }
    .eq .label{
      display:inline-block;
      font-family:var(--sans);
      font-size:.82rem;
      color:rgba(233,236,255,.72);
      letter-spacing:.04em;
      text-transform:uppercase;
      margin-bottom:8px;
    }
    .btnrow{
      display:flex; gap:8px; flex-wrap:wrap;
      margin-top:8px;
    }
    button.copy{
      appearance:none;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:rgba(233,236,255,.9);
      padding:8px 10px;
      border-radius:12px;
      cursor:pointer;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      font-size:.92rem;
    }
    button.copy:hover{
      background:rgba(122,167,255,.10);
      border-color:rgba(122,167,255,.25);
    }
    button.copy:active{transform:translateY(1px)}
    .copyhint{
      font-size:.9rem;
      color:rgba(233,236,255,.70);
      margin-top:6px;
    }

    figure{
      margin:10px 0 0;
      border:1px solid var(--line);
      border-radius:16px;
      overflow:hidden;
      background:rgba(0,0,0,.14);
    }
    figcaption{
      padding:10px 12px;
      color:rgba(233,236,255,.78);
      font-size:.92rem;
      border-top:1px solid rgba(255,255,255,.08);
    }
    canvas{
      display:block;
      width:100%;
      height:auto;
      aspect-ratio: 16 / 9;
      background:rgba(10,14,30,.6);
    }

    details{
      border:1px solid var(--line);
      border-radius:16px;
      padding:10px 12px;
      background:rgba(255,255,255,.02);
      margin:10px 0;
    }
    summary{
      cursor:pointer;
      color:rgba(233,236,255,.9);
      font-weight:600;
    }

    .final{
      border:1px solid rgba(124,255,201,.25);
      background:rgba(124,255,201,.08);
      border-radius:16px;
      padding:14px;
    }
    .final h3{margin-top:0}
    .mono{font-family:var(--mono)}
    .tiny{font-size:.92rem; color:rgba(233,236,255,.78)}
    .hr{height:1px;background:rgba(255,255,255,.10);margin:12px 0}

    footer{
      max-width:1200px;
      margin:0 auto;
      padding:12px 18px 28px;
      color:rgba(233,236,255,.65);
      font-size:.92rem;
    }

    /* Micro-animations */
    @media (prefers-reduced-motion: no-preference){
      .hero, article, nav.toc{animation: fadeUp .35s ease both}
      @keyframes fadeUp{
        from{opacity:0; transform: translateY(6px)}
        to{opacity:1; transform: translateY(0)}
      }
    }

    /* Print-friendly */
    @media print{
      body{background:#fff;color:#000}
      nav.toc{display:none}
      header, main, footer{max-width:900px}
      article, .hero, .card, .callout, .eq, figure, details{
        box-shadow:none !important;
        background:#fff !important;
        color:#000 !important;
        border-color:#bbb !important;
      }
      a{color:#000;text-decoration:underline}
      .eq{background:#fff !important}
      button.copy{display:none}
      details{break-inside:avoid}
      section{break-inside:avoid}
      h2, h3{break-after:avoid}
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="hero">
      <div class="kicker">Solid-state physics • Empty-lattice bands • Reduced-zone scheme</div>
      <h1>Free-Electron Energy Bands in the Reduced Zone (fcc crystal, along [111])</h1>
      <p class="sub">
        We treat an fcc crystal as an <span class="mono">empty lattice</span> (periodic potential set to zero) and build the
        band “spaghetti” purely from Brillouin-zone folding: <span class="mono">E = (ħ²/2m)|k+G|²</span>.
        We then plot (conceptually and with one static canvas plot) the band energies along the [111] line from Γ to the zone boundary point
        <span class="mono">L = (2π/a)(1/2,1/2,1/2)</span>, using the lowest energy at L as the unit.
      </p>
      <div class="meta">
        <span class="pill"><span class="dot"></span> Mathematical physics lens included</span>
        <span class="pill">One static plot (canvas)</span>
        <span class="pill">Industrial engineering relevance</span>
      </div>
    </div>
  </header>

  <main>
    <nav class="toc" aria-label="Table of contents">
      <h2>Contents</h2>
      <a href="#qs">Quick Summary</a>
      <a href="#p0">PART 0 — Concept Primer</a>
      <a href="#p0b">PART 0B — Industry & Applied Physics Perspective</a>
      <a href="#p1">PART 1 — Problem Analysis</a>
      <a href="#p2">PART 2 — Strategy & Tips</a>
      <a href="#p3">PART 3 — Full Solution</a>
      <a href="#p4">PART 4 — Deeper Understanding</a>
      <a href="#p5">PART 5 — Optional Plot Guide</a>
      <div class="small">
        Tip: use the copy buttons to grab key equations and the final “answer block”.
      </div>
      <a class="toplink" href="#top">Back to top ↑</a>
    </nav>

    <article>
      <section id="qs">
        <h2>Quick Summary</h2>
        <ul>
          <li><b>What this is:</b> Construct the <b>empty-lattice</b> (“free electron”) band structure of an <b>fcc</b> crystal in the <b>reduced-zone</b> scheme.</li>
          <li><b>Key physics idea:</b> Bloch states are plane waves labeled by reciprocal vectors <span class="mono">G</span>; in the reduced zone, different <span class="mono">G</span> label different <b>bands</b> at the same <span class="mono">k</span>.</li>
          <li><b>Governing eigenproblem:</b> Schrödinger operator <span class="mono">H = -(ħ²/2m)∇² + V(r)</span>; here <span class="mono">V=0</span> so the spectrum is analytic.</li>
          <li><b>Reduced-zone band formula:</b> <span class="mono">E_G(k) = (ħ²/2m)|k+G|²</span> with <span class="mono">k</span> restricted to the 1st Brillouin zone.</li>
          <li><b>fcc reciprocal lattice:</b> the reciprocal lattice is <b>bcc</b>: <span class="mono">G=(2π/a)(h,k,l)</span> with integers <span class="mono">(h,k,l)</span> all even or all odd.</li>
          <li><b>Path:</b> along [111] take <span class="mono">k=(2π/a)(x,x,x)</span>, <span class="mono">x∈[0,1/2]</span> (Γ→L).</li>
          <li><b>Energy unit:</b> the lowest band energy at <span class="mono">L=(2π/a)(1/2,1/2,1/2)</span> is
            <span class="mono">E₀(L)= (ħ²/2m)(3π²/a²)</span>, and we plot <span class="mono">ε = E/E₀(L)</span>.</li>
          <li><b>What you learn:</b> band <b>crossings/degeneracies</b> appear naturally; a real crystal potential would <b>lift degeneracies</b> and open <b>gaps</b> at many crossings.</li>
          <li><b>Result type:</b> symbolic formulas + one static illustrative plot of several lowest folded bands.</li>
        </ul>
      </section>

      <section id="p0">
        <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

        <div class="grid2">
          <div class="card">
            <h3>Core definitions (symbols + SI units)</h3>
            <ul>
              <li><span class="mono">r</span> — position (m), <span class="mono">∇</span> — gradient (1/m), <span class="mono">∇²</span> — Laplacian (1/m²).</li>
              <li><span class="mono">ψ(r)</span> — electron wavefunction (SI: m<sup>-3/2</sup> in 3D normalization).</li>
              <li><span class="mono">ħ</span> — reduced Planck constant (J·s), <span class="mono">m</span> — electron mass (kg).</li>
              <li><span class="mono">V(r)</span> — periodic potential (J). For the <b>empty lattice</b>, set <span class="mono">V(r)=0</span>.</li>
              <li><span class="mono">k</span> — crystal wavevector in 1st Brillouin zone (1/m).</li>
              <li><span class="mono">G</span> — reciprocal lattice vector (1/m).</li>
              <li><span class="mono">a</span> — cubic lattice constant of fcc direct lattice (m).</li>
              <li><span class="mono">E</span> — energy (J); often plotted in normalized, dimensionless form.</li>
            </ul>
          </div>

          <div class="card">
            <h3>Physical meaning (intuition)</h3>
            <ul>
              <li><b>Bloch’s theorem:</b> in a periodic lattice, eigenstates look like <span class="mono">ψ_{n,k}(r)=e^{i k·r}u_{n,k}(r)</span> where <span class="mono">u</span> has lattice periodicity.</li>
              <li><b>Empty lattice:</b> if <span class="mono">V=0</span>, then <span class="mono">u</span> can be expanded in plane waves; energies become those of free electrons but <b>folded</b> into the 1st BZ.</li>
              <li><b>Reduced-zone scheme:</b> keep <span class="mono">k</span> inside 1st BZ; different reciprocal shifts <span class="mono">k+G</span> correspond to different <b>bands</b> <span class="mono">n</span>.</li>
            </ul>
          </div>
        </div>

        <div class="callout ok">
          <b>Key law / operator form (validity + assumptions):</b>
          <div class="eq" data-copy="eq1">
            <div class="label">Schrödinger eigenvalue problem</div>
            Hψ = Eψ,  where  H = -(ħ²/2m)∇² + V(r).
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-btn="eq1">Copy equation</button>
          </div>
          <p class="tiny">
            Here we take the <b>approximation</b> <span class="mono">V(r)=0</span> (empty lattice).
            Mathematically, that removes all coupling between plane-wave components, turning the band problem into a simple dispersion relation.
          </p>
        </div>

        <h3>Common models/approximations (and why)</h3>
        <ul>
          <li><b>Empty lattice (this problem):</b> set <span class="mono">V=0</span> to isolate geometric folding effects of periodicity.</li>
          <li><b>Nearly-free electron:</b> small periodic <span class="mono">V</span> treated perturbatively; it opens gaps at Bragg planes and removes degeneracies.</li>
          <li><b>Effective mass:</b> near band extrema, approximate <span class="mono">E(k)≈E(k₀)+½(k-k₀)^T(ħ² m*^{-1})(k-k₀)</span>.</li>
        </ul>

        <h3>Mini intuition examples (conceptual, minimal algebra)</h3>
        <ul>
          <li><b>1D folding:</b> free parabola <span class="mono">E∝k²</span> repeats every <span class="mono">G=2π/a</span>; in reduced zone you see multiple parabolic branches (bands) stacked.</li>
          <li><b>Degeneracy at zone boundary:</b> at a Bragg plane, <span class="mono">|k|=|k-G|</span> can hold, making two plane waves degenerate. A small periodic potential couples them and splits the energies (gap).</li>
          <li><b>Symmetry along [111]:</b> moving along a high-symmetry line forces some energies to coincide due to lattice symmetry, creating structured crossings.</li>
        </ul>

        <div class="callout warn">
          <b>What to watch for (pitfalls)</b>
          <ul>
            <li>Do not use a <b>simple-cubic</b> reciprocal lattice for fcc: fcc ↔ bcc in reciprocal space.</li>
            <li>Reduced-zone “bands” are not different particles—just different <span class="mono">G</span>-shifted plane waves labeled as bands at the same <span class="mono">k</span>.</li>
            <li>Band crossings in the empty lattice are real; in a real crystal many become <b>avoided crossings</b> (gaps) once <span class="mono">V(r)≠0</span>.</li>
          </ul>
        </div>

        <div class="callout">
          <b>Math Insight (core equation as a mathematical object)</b>
          <p>
            With <span class="mono">V(r)=0</span>, the Hamiltonian is proportional to the <b>negative Laplacian</b>.
            The eigenfunctions are Fourier modes, so the problem is a <b>spectral problem for a constant-coefficient elliptic operator</b>.
            The “band structure” arises purely from restricting <span class="mono">k</span> to the first Brillouin zone and indexing eigenmodes by reciprocal-lattice shifts <span class="mono">G</span>.
          </p>
        </div>
      </section>

      <section id="p0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>
        <div class="grid2">
          <div class="card">
            <h3>Where this appears (3+ concrete areas)</h3>
            <ul>
              <li><b>Semiconductor & metal design:</b> understanding how periodicity reshapes free-electron motion is the gateway to conductivity, effective mass, and density of states.</li>
              <li><b>Thin films / epitaxy / superlattices:</b> folding becomes dramatic when new periodicities (multilayers) shrink the BZ, changing optical and transport properties.</li>
              <li><b>Photonics / plasmonics on crystals:</b> electron dispersion affects plasmon frequencies and damping; zone folding informs where interband transitions occur.</li>
              <li><b>Reliability & process engineering:</b> microstructure (strain, defects) changes potentials and lifts degeneracies → altered resistivity and electromigration behavior.</li>
            </ul>
          </div>
          <div class="card">
            <h3>Why engineers care (IE + applied-physics angle)</h3>
            <ul>
              <li><b>Performance:</b> band curvature → mobility; crossings/gaps influence conductivity and optical absorption.</li>
              <li><b>Efficiency:</b> controlling band features helps reduce losses (e.g., in interconnects, thermoelectrics).</li>
              <li><b>Manufacturability:</b> real materials deviate from “empty lattice”; process steps (alloying, strain engineering) tune <span class="mono">V(r)</span> and thus band gaps.</li>
              <li><b>Cost & risk:</b> predicting electronic behavior early reduces iterations in materials selection and device qualification.</li>
            </ul>
          </div>
        </div>

        <h3>Measurement/validation methods (brief)</h3>
        <ul>
          <li><b>ARPES</b> (angle-resolved photoemission): directly maps <span class="mono">E(k)</span> near surfaces.</li>
          <li><b>Quantum oscillations</b> (de Haas–van Alphen, Shubnikov–de Haas): infer Fermi surface geometry tied to dispersion.</li>
          <li><b>Optical spectroscopy</b>: interband transition thresholds reveal gaps and band separations.</li>
        </ul>

        <h3>Design trade-offs & constraints</h3>
        <ul>
          <li>Real lattices have <b>nonzero periodic potentials</b>, disorder, finite temperature, and electron–phonon scattering.</li>
          <li>Strain and composition can be used to tailor band structure, but may harm <b>yield</b> (defects) or <b>reliability</b> (stress migration).</li>
        </ul>

        <div class="callout">
          <b>From lab to product</b>
          <p>
            The empty-lattice picture is rarely “the final model,” but it is a high-value first step:
            it tells you <i>where</i> degeneracies and crossings are geometrically allowed.
            In product modeling, you then add the real <span class="mono">V(r)</span> (via DFT, k·p, or nearly-free electron theory),
            plus scattering and finite-size effects, to predict transport metrics that industrial engineers track (throughput, energy efficiency, failure rate).
          </p>
        </div>
      </section>

      <section id="p1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>
        <h3>Problem rewritten (clear statement)</h3>
        <p>
          Consider the free-electron energy bands of an fcc crystal in the <b>empty-lattice approximation</b>, but expressed in the
          <b>reduced-zone scheme</b> (all wavevectors mapped into the first Brillouin zone).
          Plot, along the crystallographic direction [111], the energies of all bands up to <b>six times</b> the <b>lowest</b> band energy at the zone boundary point
          <span class="mono">k = (2π/a)(1/2,1/2,1/2)</span>. Use that lowest boundary energy as the unit.
          Explain why band edges need not lie at the zone center and how degeneracies/band crossings arise (and would be removed by a crystal potential).
        </p>

        <div class="grid2">
          <div class="card">
            <h3>Given</h3>
            <ul>
              <li>fcc direct lattice with lattice constant <span class="mono">a</span>.</li>
              <li>Empty lattice: <span class="mono">V(r)=0</span>.</li>
              <li>Reduced-zone mapping into 1st BZ.</li>
              <li>Line in k-space: [111] direction, from Γ to <span class="mono">L=(2π/a)(1/2,1/2,1/2)</span>.</li>
            </ul>
          </div>
          <div class="card">
            <h3>Unknowns / what to produce</h3>
            <ul>
              <li>Band energies <span class="mono">E_n(k)</span> in reduced-zone scheme along Γ→L.</li>
              <li>Normalization by <span class="mono">E₀(L)</span> (lowest band energy at L).</li>
              <li>Qualitative explanation of degeneracies and why real potentials lift them.</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (why they apply)</h3>
        <ul>
          <li><b>Bloch/Fourier structure:</b> periodic boundary conditions in a lattice imply states labeled by <span class="mono">k</span> modulo reciprocal vectors <span class="mono">G</span>.</li>
          <li><b>Free electron dispersion:</b> with <span class="mono">V=0</span>, energy depends only on wavevector magnitude: <span class="mono">E=(ħ²/2m)|K|²</span>.</li>
          <li><b>Reduced-zone scheme:</b> set <span class="mono">K = k+G</span> with <span class="mono">k</span> constrained to the first BZ; each <span class="mono">G</span> becomes a band index.</li>
        </ul>

        <div class="callout warn">
          <b>Assumptions (explicit)</b>
          <ul>
            <li>Single-electron Schrödinger equation; no interactions, no spin–orbit, no phonons.</li>
            <li>Perfect periodicity; no disorder or finite-size quantization.</li>
            <li>Empty lattice: <span class="mono">V(r)=0</span> so plane waves are exact eigenstates.</li>
            <li>We study a 1D path in k-space ([111]) inside the 3D first BZ.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <ul>
          <li><b>A1 — Direct formula + enumeration of G:</b> Use <span class="mono">E_G(k)=(ħ²/2m)|k+G|²</span>, enumerate bcc reciprocal vectors, sort energies at each k. <b>Pros:</b> systematic, matches “plot all bands up to…”; <b>Cons:</b> bookkeeping.</li>
          <li><b>A2 — Geometric Bragg-plane reasoning:</b> Identify which plane waves become degenerate at Γ and L using symmetry/Bragg conditions. <b>Pros:</b> insight on crossings; <b>Cons:</b> incomplete for “all bands up to 6×” unless combined with enumeration.</li>
          <li><b>A3 — Nearly-free electron perturbation:</b> Add small <span class="mono">V_G</span> to show gap opening. <b>Pros:</b> explains lifting degeneracy; <b>Cons:</b> beyond the “empty lattice” energy plot (though we can comment).</li>
        </ul>

        <p><b>Chosen approach:</b> A1 (direct formula + reciprocal-vector enumeration) gives the cleanest reduced-zone “band list” along [111], and A2 will be used to interpret degeneracies and crossings.</p>
      </section>

      <section id="p2">
        <h2>PART 2 — Strategy & Tips (roadmap only)</h2>
        <ol>
          <li><b>Set up the eigenproblem:</b> start from <span class="mono">H=-(ħ²/2m)∇²</span>; identify plane-wave eigenfunctions and eigenvalues.</li>
          <li><b>Impose lattice periodicity (Bloch):</b> show that wavevectors differing by reciprocal vectors <span class="mono">G</span> represent the same crystal momentum <span class="mono">k</span> in reduced zone.</li>
          <li><b>Specify fcc reciprocal lattice:</b> write <span class="mono">G=(2π/a)(h,k,l)</span> with <span class="mono">h,k,l</span> all even or all odd.</li>
          <li><b>Parameterize [111] path:</b> take <span class="mono">k=(2π/a)(x,x,x)</span>, <span class="mono">x∈[0,1/2]</span>.</li>
          <li><b>Nondimensionalize:</b> normalize by <span class="mono">E₀(L)</span> so the plot is dimensionless and independent of material constants (for empty lattice).</li>
          <li><b>Compute band energies:</b> for each allowed <span class="mono">G</span>, compute <span class="mono">ε_G(x)=E_G(k)/E₀(L)</span>.</li>
          <li><b>Sort into bands:</b> for each <span class="mono">x</span>, sort energies and keep those ≤ 6.</li>
          <li><b>Interpret degeneracies:</b> identify which <span class="mono">G</span> choices produce equal energies at Γ or L.</li>
          <li><b>Explain “edges not at zone center”:</b> show that minima of some <span class="mono">|k+G|²</span> parabolas occur away from Γ in the reduced-zone coordinate.</li>
        </ol>

        <div class="callout bad">
          <b>Common mistakes</b>
          <ul>
            <li>Using wrong reciprocal lattice (fcc ↔ bcc).</li>
            <li>Forgetting the reduced-zone condition: <span class="mono">k</span> stays in the 1st BZ, <span class="mono">G</span> changes instead.</li>
            <li>Mixing the path parameter: along Γ→L, <span class="mono">x</span> runs only to <span class="mono">1/2</span>.</li>
            <li>Normalizing with the wrong energy scale (must be the <b>lowest</b> band at L, not some arbitrary free-electron energy).</li>
          </ul>
        </div>
      </section>

      <section id="p3">
        <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

        <h3>Qualitative expectation (before calculating)</h3>
        <p>
          In free space, energy is a single parabola <span class="mono">E∝|K|²</span>.
          In a crystal’s reduced-zone representation, that same parabola is <b>replicated</b> by reciprocal vectors <span class="mono">G</span>,
          producing many parabolic branches. These branches will <b>cross</b> often (degeneracies), especially on high-symmetry lines like [111].
          At the zone boundary point L, we expect degeneracy because <span class="mono">k</span> sits on a Bragg plane: a plane wave with wavevector <span class="mono">k</span> can have the same kinetic energy as one with <span class="mono">k-G</span> for certain <span class="mono">G</span>.
        </p>

        <h3>Step 1 — Mathematical model (variables, domain, operator form)</h3>
        <p>
          We solve the single-electron time-independent Schrödinger equation in 3D:
        </p>
        <div class="eq" data-copy="eq2">
          <div class="label">Model and domain</div>
          Find ψ(r) and E such that:
          [-(ħ²/2m) ∇² + V(r)] ψ(r) = E ψ(r),  for r ∈ ℝ³,
          with V(r + R) = V(r) for all direct lattice vectors R.
          Empty lattice approximation: V(r) = 0.
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq2">Copy equation</button>
        </div>
        <p class="tiny">
          <b>Why each step is valid:</b> With <span class="mono">V=0</span>, the operator is linear with constant coefficients; Fourier modes diagonalize <span class="mono">∇²</span>,
          so we can find the full spectrum by plane waves.
        </p>

        <h3>Step 2 — Solve the empty-lattice eigenproblem (plane waves)</h3>
        <p>
          Try a plane wave eigenfunction <span class="mono">ψ_K(r)=exp(iK·r)</span>, where <span class="mono">K</span> is a (continuous) wavevector in free space.
          Then:
        </p>
        <div class="eq" data-copy="eq3">
          <div class="label">Laplacian on a plane wave</div>
          ∇² e^{iK·r} = (iK)·(iK) e^{iK·r} = -|K|² e^{iK·r}.
          Therefore:
          H e^{iK·r} = (ħ²/2m) |K|² e^{iK·r},
          so E(K) = (ħ²/2m) |K|².
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq3">Copy equation</button>
        </div>

        <p>
          This is the free-electron dispersion. The “band structure” appears only after enforcing crystal momentum labeling.
        </p>

        <h3>Step 3 — Reduced-zone labeling via reciprocal lattice (Bloch equivalence)</h3>
        <p>
          In a periodic lattice, Bloch’s theorem implies that crystal momentum <span class="mono">k</span> is defined modulo reciprocal lattice vectors <span class="mono">G</span>.
          Thus any free-space wavevector can be decomposed as:
        </p>
        <div class="eq" data-copy="eq4">
          <div class="label">Reduced-zone decomposition</div>
          K = k + G,
          where k is chosen inside the 1st Brillouin zone (reduced-zone),
          and G is a reciprocal lattice vector.
          Empty-lattice “bands” are:
          E_G(k) = (ħ²/2m) |k + G|².
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq4">Copy equation</button>
        </div>

        <p>
          <b>Interpretation:</b> At a fixed reduced-zone <span class="mono">k</span>, each allowed <span class="mono">G</span> gives one energy level.
          Sorting these energies by size gives the band index <span class="mono">n</span>.
        </p>

        <h3>Step 4 — fcc reciprocal lattice (bcc condition)</h3>
        <p>
          For an fcc direct lattice with cubic constant <span class="mono">a</span>, the reciprocal lattice is bcc. In conventional cubic coordinates,
          reciprocal vectors can be written as:
        </p>
        <div class="eq" data-copy="eq5">
          <div class="label">Reciprocal lattice vectors for fcc</div>
          G = (2π/a) (h, k, l),
          where (h,k,l) ∈ ℤ³ and h,k,l are either all even or all odd.
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq5">Copy equation</button>
        </div>

        <details>
          <summary>Optional deeper note: why “all even or all odd”?</summary>
          <p>
            The bcc reciprocal lattice can be described as the set of integer triples with parity constraint.
            This is the standard crystallographic selection rule: fcc has structure factor that vanishes unless (h,k,l) are all even or all odd,
            and equivalently its reciprocal lattice nodes are exactly those points.
          </p>
        </details>

        <h3>Step 5 — Parameterize the [111] path Γ→L</h3>
        <p>
          Along [111], choose:
        </p>
        <div class="eq" data-copy="eq6">
          <div class="label">[111] line parameterization</div>
          k(x) = (2π/a) (x, x, x),  with x ∈ [0, 1/2].
          Γ corresponds to x=0.
          L corresponds to x=1/2, i.e. k_L = (2π/a)(1/2,1/2,1/2).
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq6">Copy equation</button>
        </div>

        <h3>Step 6 — Normalize energies (nondimensionalization + dimensional check)</h3>
        <p>
          The problem instructs: use the <b>lowest band energy at L</b> as the unit.
          In the empty lattice, the lowest energy at L comes from <span class="mono">G=0</span> (also degenerate with some other <span class="mono">G</span>, but the value is the same).
          Compute:
        </p>
        <div class="eq" data-copy="eq7">
          <div class="label">Energy unit at L</div>
          |k_L| = |(2π/a)(1/2,1/2,1/2)| = (2π/a) * (√3/2) = (π√3)/a.
          E0(L) = (ħ²/2m)|k_L|² = (ħ²/2m) * (3π²/a²).
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq7">Copy equation</button>
        </div>

        <p>
          Define the dimensionless energy <span class="mono">ε = E / E0(L)</span>. Since both numerator and denominator scale as (ħ²/2m)(1/a²),
          <span class="mono">ε</span> is dimensionless and depends only on the geometry of <span class="mono">k</span> and <span class="mono">G</span>.
        </p>

        <h3>Step 7 — A clean dimensionless formula along [111]</h3>
        <p>
          Introduce dimensionless wavevectors <span class="mono">q = (a/2π)k</span> and <span class="mono">g = (a/2π)G</span>.
          Then along [111], <span class="mono">q=(x,x,x)</span> and <span class="mono">g=(h,k,l)</span> with the parity rule.
          Because <span class="mono">k=(2π/a)q</span> and <span class="mono">G=(2π/a)g</span>,
        </p>

        <div class="eq" data-copy="eq8">
          <div class="label">Normalized reduced-zone band energies</div>
          E_g(k) = (ħ²/2m)(2π/a)² |q + g|².
          Since |q_L|² = |(1/2,1/2,1/2)|² = 3/4,
          ε_g(x) = E_g(k(x)) / E0(L) = |q+g|² / |q_L|² = (4/3)| (x,x,x) + (h,k,l) |².
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq8">Copy equation</button>
        </div>

        <p>
          Expand the norm explicitly (no “magic jump”):
          for <span class="mono">q=(x,x,x)</span> and <span class="mono">g=(h,k,l)</span>,
          <span class="mono">|q+g|²=(x+h)²+(x+k)²+(x+l)²</span>. Therefore,
        </p>

        <div class="eq" data-copy="eq9">
          <div class="label">Explicit quadratic in x</div>
          ε_{hkl}(x) = (4/3)[(x+h)² + (x+k)² + (x+l)²]
                    = (4/3)[3x² + 2x(h+k+l) + (h²+k²+l²)].
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq9">Copy equation</button>
        </div>

        <p class="tiny">
          <b>Mathematical validity:</b> This expansion uses linearity of the dot product and distributivity:
          <span class="mono">|v|²=v·v</span> and <span class="mono">(q+g)·(q+g)=q·q+2q·g+g·g</span>.
        </p>

        <h3>Step 8 — Identify bands up to ε ≤ 6 (procedure)</h3>
        <p>
          For each <span class="mono">x∈[0,1/2]</span> (Γ→L), enumerate reciprocal vectors <span class="mono">(h,k,l)</span> satisfying the parity rule,
          compute <span class="mono">ε_{hkl}(x)</span>, sort energies, and keep those with <span class="mono">ε≤6</span>.
          Those sorted curves are the reduced-zone “bands” (empty lattice).
        </p>

        <details>
          <summary>Optional: quick examples of analytic band branches (a few low-|g| choices)</summary>
          <ul>
            <li><b>g=(0,0,0):</b> ε = (4/3)·3x² = 4x² (so ε(1/2)=1).</li>
            <li><b>g=(-1,-1,-1):</b> ε = (4/3)·3(x-1)² = 4(x-1)² (so ε(1/2)=1; degeneracy at L).</li>
            <li><b>g=(-2,0,0) and permutations:</b> ε = (4/3)[(x-2)²+x²+x²] = (4/3)(3x²-4x+4),
              giving ε(1/2)=11/3≈3.667 (within the “≤6” range).</li>
          </ul>
        </details>

        <h3>Step 9 — One static plot (illustrative) of lowest folded bands (ε ≤ 6)</h3>
        <p>
          The plot below shows several lowest energy branches along Γ→L, in the reduced-zone scheme, normalized by <span class="mono">E0(L)</span>.
          Crossings are visible (empty lattice). In a real crystal, many such crossings become avoided due to coupling by <span class="mono">V(r)</span>.
        </p>

        <figure>
          <canvas id="bandPlot" aria-label="Reduced-zone empty-lattice bands along [111] in fcc"></canvas>
          <figcaption>
            <b>Empty-lattice (fcc) reduced-zone bands along [111]</b>.
            Horizontal axis: κ = |k|/|k<sub>L</sub>| (Γ→L means κ:0→1). Vertical axis: ε = E/E0(L).
            Curves are computed from ε<sub>g</sub>(x)=(4/3)|q+g|² with bcc reciprocal vectors (h,k,l all even or all odd), then sorted into bands.
          </figcaption>
        </figure>

        <h3>Step 10 — Why band edges need not be at the zone center (Γ)</h3>
        <p>
          Each branch <span class="mono">ε_{hkl}(x)</span> is a quadratic function of <span class="mono">x</span>.
          Its minimum along the line occurs where <span class="mono">dε/dx=0</span> (calculus, valid since ε is differentiable in x):
        </p>

        <div class="eq" data-copy="eq10">
          <div class="label">Minimization along [111]</div>
          ε_{hkl}(x) = (4/3)[3x² + 2xS + Q],  where S=h+k+l, Q=h²+k²+l².
          dε/dx = (4/3)[6x + 2S].
          Set dε/dx = 0 ⇒ 6x + 2S = 0 ⇒ x* = -S/3.
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq10">Copy equation</button>
        </div>

        <p>
          Since the reduced-zone line only allows <span class="mono">x∈[0,1/2]</span>, many branches have their quadratic minimum at an interior point (if <span class="mono">x*</span> lies in that interval),
          not necessarily at <span class="mono">x=0</span>. This is the precise mathematical reason band edges need not occur at Γ in the reduced-zone picture.
        </p>

        <h3>Step 11 — Degeneracies and crossings (and why a crystal potential removes many)</h3>
        <p>
          Degeneracy occurs whenever <span class="mono">|k+G₁|² = |k+G₂|²</span> for two distinct reciprocal vectors.
          At the L point, one simple degeneracy is:
        </p>

        <div class="eq" data-copy="eq11">
          <div class="label">Example degeneracy at L</div>
          At x=1/2:
          For g₁=(0,0,0): q+g₁=(1/2,1/2,1/2) ⇒ |q+g₁|²=3/4.
          For g₂=(-1,-1,-1): q+g₂=(-1/2,-1/2,-1/2) ⇒ |q+g₂|²=3/4.
          Hence ε_{000}(1/2)=ε_{-1,-1,-1}(1/2)=1.
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-btn="eq11">Copy equation</button>
        </div>

        <p>
          In the <b>nearly-free-electron</b> picture (small but nonzero periodic <span class="mono">V</span>), plane waves differing by a reciprocal vector can couple.
          Mathematically, the Hamiltonian in the plane-wave basis gains off-diagonal terms proportional to Fourier components <span class="mono">V_G</span>.
          Near a degeneracy, a 2×2 effective matrix forms and splits the energy levels (gap), removing the crossing (unless symmetry forbids coupling).
        </p>

        <div class="final" id="finalAnswer">
          <h3>Final Answer (boxed)</h3>
          <div class="eq" data-copy="finalBlock">
            Reduced-zone empty-lattice bands for an fcc crystal:

            Reciprocal lattice (bcc):
            G = (2π/a)(h,k,l), where h,k,l are integers all even or all odd.

            Along [111] from Γ to L:
            k(x) = (2π/a)(x,x,x), with x ∈ [0, 1/2],
            L corresponds to x=1/2.

            Free-electron (empty lattice) band energies:
            E_{hkl}(x) = (ħ²/2m) |k(x) + G_{hkl}|².

            Use the unit E0(L) = (ħ²/2m)|k_L|² = (ħ²/2m)(3π²/a²).
            Then the normalized energies are:
            ε_{hkl}(x) = E_{hkl}(x)/E0(L) = (4/3)[(x+h)² + (x+k)² + (x+l)²]
                       = (4/3)[3x² + 2x(h+k+l) + (h²+k²+l²)].

            The reduced-zone bands E_n(k) are obtained by, for each x, sorting ε_{hkl}(x)
            over all allowed (h,k,l) and keeping all branches with ε ≤ 6.

            Degeneracies/band crossings occur when |k+G1|² = |k+G2|²; e.g. at L:
            ε_{000}(1/2)=ε_{-1,-1,-1}(1/2)=1.
            A nonzero periodic potential V(r) couples plane waves and typically lifts these degeneracies (opens gaps).
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-btn="finalBlock">Copy final answer (plain text)</button>
          </div>
        </div>

        <h3>Sanity checks</h3>
        <div class="grid2">
          <div class="callout ok">
            <b>Units/dimensions</b>
            <p>
              <span class="mono">E=(ħ²/2m)|k|²</span> has units:
              <span class="mono">ħ²</span> (J²·s²) divided by kg gives J²·s²/kg; multiplying by 1/m² yields J.
              The normalized <span class="mono">ε</span> is dimensionless.
            </p>
          </div>
          <div class="callout ok">
            <b>Limiting cases</b>
            <ul>
              <li>At Γ (x=0): ε<sub>hkl</sub>(0)=(4/3)(h²+k²+l²) — pure reciprocal-shell energies; many degeneracies.</li>
              <li>At L (x=1/2): lowest branch gives ε=1 by construction, and additional branches fall at higher ε.</li>
              <li>If you “turn off” folding (ignore G≠0), you recover a single parabola ε=4x².</li>
            </ul>
          </div>
        </div>

        <div class="callout">
          <b>Physical interpretation (plain language)</b>
          <p>
            The reduced-zone band diagram is just the free-electron parabola repeated by reciprocal vectors and then “folded” back into the first Brillouin zone.
            Crossings are normal in the empty lattice because different plane waves do not interact when <span class="mono">V=0</span>.
            In real materials, periodic potential Fourier components cause those waves to mix, splitting degeneracies and generating true band gaps.
          </p>
        </div>
      </section>

      <section id="p4">
        <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

        <h3>Re-interpret the final formula: what controls what?</h3>
        <ul>
          <li><span class="mono">x</span> sets where you are along Γ→L (i.e., how large k is along [111]).</li>
          <li><span class="mono">S=h+k+l</span> controls the <b>linear-in-x</b> tilt of the parabola along this path (shifts where the minimum occurs).</li>
          <li><span class="mono">Q=h²+k²+l²</span> sets the overall offset (how “high” the band sits).</li>
          <li>The coefficient <span class="mono">(4/3)</span> is purely geometric from normalization by <span class="mono">|q_L|²=3/4</span>.</li>
        </ul>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li>Changing <span class="mono">a</span> rescales all absolute energies as <span class="mono">1/a²</span>, but <span class="mono">ε</span> is unchanged (empty-lattice geometry only).</li>
          <li>Changing electron effective mass (in real solids) would scale energies as <span class="mono">1/m*</span>, but again not the dimensionless geometry of crossings.</li>
          <li>Increasing |g| (larger h,k,l) generally pushes bands upward; only a finite number fall under ε≤6.</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Instead of enumerating <span class="mono">G</span>, you can view the problem as follows:
          the set of energies at a given reduced-zone <span class="mono">k</span> is the set of squared distances from the point <span class="mono">q=(a/2π)k</span>
          to all reciprocal lattice points <span class="mono">g</span> (bcc nodes). Thus band ordering is a <b>nearest-neighbor distance ordering problem in reciprocal space</b>.
          Along [111], this becomes a structured family of quadratics in one parameter.
        </p>

        <h3>Concept check (self-test with answers)</h3>
        <ul>
          <li><b>Q:</b> Why do we get many bands in an empty lattice when the electron is “free”? <br><b>A:</b> Because we restrict <span class="mono">k</span> to the 1st BZ and label different plane waves by different <span class="mono">G</span>, creating many folded branches.</li>
          <li><b>Q:</b> What causes a gap in the nearly-free-electron model? <br><b>A:</b> Nonzero Fourier components of <span class="mono">V(r)</span> couple degenerate plane waves at Bragg planes, splitting eigenvalues.</li>
          <li><b>Q:</b> Why can a band minimum occur away from Γ? <br><b>A:</b> Each branch is a quadratic in <span class="mono">x</span> with minimum at <span class="mono">x* = -(h+k+l)/3</span>, which may lie inside (0,1/2).</li>
          <li><b>Q:</b> What is special about the point <span class="mono">L</span> here? <br><b>A:</b> It’s a zone boundary point on [111]; symmetry/Bragg conditions produce degeneracies there (e.g., <span class="mono">g=0</span> and <span class="mono">g=-1,-1,-1</span>).</li>
        </ul>
      </section>

      <section id="p5">
        <h2>PART 5 — Optional Plot Guide (PLOT EXISTS)</h2>
        <div class="callout">
          <b>What the plot shows and why it’s useful</b>
          <ul>
            <li>It visualizes <b>zone folding</b>: multiple parabolic branches appear when we keep <span class="mono">k</span> inside the 1st BZ and vary <span class="mono">G</span>.</li>
            <li>It makes <b>band crossings</b> obvious—these are the degeneracies that a real periodic potential tends to remove (gap opening).</li>
            <li>It demonstrates that band “edges” (minima/maxima along the path) can occur away from Γ because each branch has its own shifted minimum.</li>
          </ul>
        </div>

        <h3>Axes and units</h3>
        <ul>
          <li><b>x-axis:</b> κ = |k|/|k<sub>L</sub>|, dimensionless. Along Γ→L, κ runs from 0 to 1.</li>
          <li><b>y-axis:</b> ε = E/E0(L), dimensionless, where <span class="mono">E0(L)=(ħ²/2m)(3π²/a²)</span>.</li>
        </ul>

        <h3>Values used</h3>
        <p>
          No material numbers are needed because the plotted quantity is normalized. The plot is produced by enumerating reciprocal lattice points
          (integers all even or all odd) in a finite range sufficient to capture all bands with ε≤6 along the path.
        </p>

        <h3>Features to notice</h3>
        <ul>
          <li><b>Crossings:</b> intersections of curves indicate degeneracy in the empty lattice.</li>
          <li><b>Degeneracy at L:</b> the lowest band reaches ε=1 at κ=1 by definition; another band meets it there (example given in the solution).</li>
          <li><b>Curvature:</b> all branches are quadratic in the path parameter (because they come from squared norms).</li>
        </ul>
      </section>

      <div class="hr"></div>
      <p class="copyhint">
        Copy tip: The “Final Answer” block contains the complete recipe and equations. Use its copy button for plain-text export.
      </p>
    </article>
  </main>

  <footer>
    <div>
      <b>Note:</b> This is the <i>empty-lattice</i> (V=0) reduced-zone construction. In real fcc materials, the periodic potential mixes plane waves and removes many crossings.
      The point of this exercise is to see how much of “band structure” comes purely from lattice geometry and symmetry.
    </div>
  </footer>

  <script>
    // ---------- Copy buttons ----------
    (function(){
      function getTextForCopy(id){
        const el = document.querySelector('[data-copy="'+id+'"]');
        if(!el) return '';
        return el.innerText.replace(/\n{3,}/g, '\n\n').trim();
      }
      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position='fixed';
          ta.style.left='-9999px';
          document.body.appendChild(ta);
          ta.focus(); ta.select();
          let ok=false;
          try{ ok = document.execCommand('copy'); }catch(_){ ok=false; }
          document.body.removeChild(ta);
          return ok;
        }
      }
      document.querySelectorAll('button.copy[data-copy-btn]').forEach(btn=>{
        const id = btn.getAttribute('data-copy-btn');
        btn.addEventListener('click', async ()=>{
          const text = getTextForCopy(id);
          const ok = await copyText(text);
          const old = btn.textContent;
          btn.textContent = ok ? 'Copied ✓' : 'Copy failed';
          setTimeout(()=>btn.textContent=old, 900);
        });
      });
    })();

    // ---------- Band plot (static canvas, but computed on load) ----------
    (function(){
      const canvas = document.getElementById('bandPlot');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      function resize(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const rect = canvas.getBoundingClientRect();
        const w = Math.max(320, Math.floor(rect.width));
        const h = Math.floor(w * 9/16);
        canvas.width = Math.floor(w * dpr);
        canvas.height = Math.floor(h * dpr);
        canvas.style.height = h + 'px';
        ctx.setTransform(dpr,0,0,dpr,0,0);
        draw(w,h);
      }

      // Enumerate bcc reciprocal vectors g=(h,k,l) with parity constraint (all even or all odd).
      function enumerateG(range){
        const gs = [];
        for(let h=-range; h<=range; h++){
          for(let k=-range; k<=range; k++){
            for(let l=-range; l<=range; l++){
              const allEven = (h%2===0) && (k%2===0) && (l%2===0);
              const allOdd  = (Math.abs(h%2)===1) && (Math.abs(k%2)===1) && (Math.abs(l%2)===1);
              if(!(allEven || allOdd)) continue;
              // skip very large |g| shells that cannot possibly contribute under epsilon<=6 near our path,
              // but keep enough to be safe.
              gs.push([h,k,l]);
            }
          }
        }
        return gs;
      }

      // epsilon_{hkl}(x) = (4/3)*[(x+h)^2+(x+k)^2+(x+l)^2], x in [0, 1/2]
      function epsHKL(h,k,l,x){
        const a = x + h, b = x + k, c = x + l;
        return (4/3) * (a*a + b*b + c*c);
      }

      function draw(w,h){
        // Clear
        ctx.clearRect(0,0,w,h);

        // Plot settings
        const padL = 56, padR = 18, padT = 24, padB = 46;
        const x0 = padL, x1 = w - padR;
        const y0 = h - padB, y1 = padT;

        const xmin = 0, xmax = 1; // kappa = |k|/|kL|
        const ymin = 0, ymax = 6; // epsilon

        function X(x){ return x0 + (x - xmin) * (x1 - x0) / (xmax - xmin); }
        function Y(y){ return y0 - (y - ymin) * (y0 - y1) / (ymax - ymin); }

        // Background panel
        ctx.save();
        ctx.fillStyle = 'rgba(255,255,255,0.03)';
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        ctx.lineWidth = 1;
        roundRect(ctx, 10, 10, w-20, h-20, 14);
        ctx.fill();
        ctx.stroke();
        ctx.restore();

        // Gridlines
        ctx.save();
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        ctx.lineWidth = 1;
        ctx.setLineDash([4,6]);

        for(let i=0;i<=6;i++){
          const yy = Y(i);
          ctx.beginPath();
          ctx.moveTo(x0, yy);
          ctx.lineTo(x1, yy);
          ctx.stroke();
        }
        for(let i=0;i<=5;i++){
          const xx = X(i/5);
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y1);
          ctx.stroke();
        }
        ctx.restore();

        // Axes
        ctx.save();
        ctx.strokeStyle = 'rgba(233,236,255,0.75)';
        ctx.lineWidth = 1.2;
        ctx.setLineDash([]);
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x1, y0);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x0, y1);
        ctx.stroke();
        ctx.restore();

        // Ticks + labels
        ctx.save();
        ctx.fillStyle = 'rgba(233,236,255,0.85)';
        ctx.strokeStyle = 'rgba(233,236,255,0.65)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        for(let i=0;i<=5;i++){
          const xx = X(i/5);
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y0+6);
          ctx.stroke();
          ctx.fillText((i/5).toFixed(1), xx, y0+9);
        }
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        for(let i=0;i<=6;i++){
          const yy = Y(i);
          ctx.beginPath();
          ctx.moveTo(x0-6, yy);
          ctx.lineTo(x0, yy);
          ctx.stroke();
          ctx.fillText(String(i), x0-10, yy);
        }

        // Axis titles
        ctx.textAlign = 'center';
        ctx.textBaseline = 'bottom';
        ctx.fillText('κ = |k| / |k_L|  (Γ → L along [111])', (x0+x1)/2, h-10);
        ctx.save();
        ctx.translate(16, (y0+y1)/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        ctx.fillText('ε = E / E0(L)', 0, 0);
        ctx.restore();

        // Title
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.font = '13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = 'rgba(233,236,255,0.9)';
        ctx.fillText('Empty-lattice reduced-zone bands (fcc), ε ≤ 6', x0, 12);

        ctx.restore();

        // Compute bands
        const gs = enumerateG(3); // range chosen to capture all ε≤6 curves along path safely
        const samples = 240;
        const bandsToDraw = 10;   // draw first 10 sorted bands (within range) for readability

        // For each kappa, compute energies and sort; build band curves by sorted index.
        const curves = Array.from({length: bandsToDraw}, ()=>[]);
        for(let i=0;i<=samples;i++){
          const kappa = xmin + (xmax-xmin)*(i/samples); // 0..1
          const x = kappa/2; // since kappa = |k|/|kL| = (x)/(1/2) = 2x
          const energies = [];
          for(const g of gs){
            const e = epsHKL(g[0],g[1],g[2],x);
            if(e <= ymax + 0.15) energies.push(e);
          }
          energies.sort((a,b)=>a-b);
          for(let b=0;b<bandsToDraw;b++){
            curves[b].push({x:kappa, y: energies[b]!==undefined ? energies[b] : NaN});
          }
        }

        // Draw curves (use distinct but unspecified colors by cycling HSL without fixed palette? We'll still set strokeStyle; requirement says no specific colors unless asked.
        // However canvas needs a color; use grayscale with varying alpha to avoid "specific colors".
        ctx.save();
        ctx.lineWidth = 1.6;
        for(let b=0;b<bandsToDraw;b++){
          const alpha = 0.85 - 0.06*b;
          ctx.strokeStyle = `rgba(233,236,255,${Math.max(0.25,alpha)})`;
          ctx.beginPath();
          let started=false;
          for(const p of curves[b]){
            if(!isFinite(p.y) || p.y<ymin || p.y>ymax) { started=false; continue; }
            const xx = X(p.x), yy = Y(p.y);
            if(!started){ ctx.moveTo(xx,yy); started=true; }
            else ctx.lineTo(xx,yy);
          }
          ctx.stroke();
        }

        // Emphasize lowest band
        ctx.strokeStyle = 'rgba(124,255,201,0.85)';
        ctx.lineWidth = 2.2;
        ctx.beginPath();
        let s=false;
        for(const p of curves[0]){
          if(!isFinite(p.y)) { s=false; continue; }
          const xx = X(p.x), yy = Y(p.y);
          if(!s){ ctx.moveTo(xx,yy); s=true; } else ctx.lineTo(xx,yy);
        }
        ctx.stroke();

        // Mark L point and ε=1
        ctx.fillStyle = 'rgba(124,255,201,0.9)';
        const lx = X(1), ly = Y(1);
        ctx.beginPath(); ctx.arc(lx, ly, 3.5, 0, Math.PI*2); ctx.fill();
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = 'rgba(233,236,255,0.85)';
        ctx.textAlign = 'left';
        ctx.textBaseline = 'bottom';
        ctx.fillText('Lowest band hits ε=1 at L', lx-160, ly-6);

        // small legend
        ctx.textAlign='left';
        ctx.textBaseline='top';
        ctx.fillStyle='rgba(233,236,255,0.75)';
        ctx.fillText('Highlighted: band 1 (lowest)', x0, y1+6);

        ctx.restore();
      }

      function roundRect(ctx, x, y, w, h, r){
        const rr = Math.min(r, w/2, h/2);
        ctx.beginPath();
        ctx.moveTo(x+rr, y);
        ctx.arcTo(x+w, y, x+w, y+h, rr);
        ctx.arcTo(x+w, y+h, x, y+h, rr);
        ctx.arcTo(x, y+h, x, y, rr);
        ctx.arcTo(x, y, x+w, y, rr);
        ctx.closePath();
      }

      window.addEventListener('resize', resize, {passive:true});
      resize();
    })();
  </script>
</body>
</html>
