<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Hyperfine Effects on ESR in Metals — Moments of the Random Hyperfine Field</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1621;
      --panel2:#101b2a;
      --text:#e9eef6;
      --muted:#b7c3d6;
      --faint:#7f8aa3;
      --accent:#77b7ff;
      --accent2:#8cffc1;
      --warn:#ffd37a;
      --danger:#ff7a9a;
      --border:rgba(255,255,255,0.10);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 15% -10%, rgba(119,183,255,0.18), transparent 60%),
        radial-gradient(900px 500px at 90% 10%, rgba(140,255,193,0.10), transparent 55%),
        radial-gradient(800px 500px at 30% 110%, rgba(255,211,122,0.08), transparent 55%),
        var(--bg);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:40px 20px 22px;
      border-bottom:1px solid var(--border);
    }
    .wrap{max-width:1180px; margin:0 auto;}
    .title{
      display:grid;
      gap:10px;
    }
    .title h1{
      margin:0;
      font-size:clamp(1.5rem, 2.6vw, 2.2rem);
      letter-spacing:0.2px;
    }
    .subtitle{
      color:var(--muted);
      font-size:1.02rem;
      max-width:80ch;
    }

    .layout{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:22px;
      padding:22px 20px 60px;
      align-items:start;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns:1fr}
    }

    /* Sticky TOC */
    nav.toc{
      position:sticky;
      top:14px;
      align-self:start;
      background: linear-gradient(180deg, rgba(16,27,42,0.95), rgba(15,22,33,0.88));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(8px);
    }
    .toc .toc-head{
      padding:14px 14px 10px;
      border-bottom:1px solid var(--border);
    }
    .toc .toc-head strong{
      display:block;
      font-size:0.95rem;
      letter-spacing:0.3px;
    }
    .toc .toc-head span{
      display:block;
      margin-top:6px;
      color:var(--faint);
      font-size:0.86rem;
    }
    .toc ul{
      list-style:none;
      padding:10px 10px 12px;
      margin:0;
      display:grid;
      gap:6px;
    }
    .toc a{
      display:block;
      padding:9px 10px;
      border-radius:12px;
      color:var(--muted);
      border:1px solid transparent;
      transition: transform 140ms ease, background 140ms ease, border-color 140ms ease;
    }
    .toc a:hover{
      background: rgba(119,183,255,0.08);
      border-color: rgba(119,183,255,0.18);
      transform: translateY(-1px);
      text-decoration:none;
      color:var(--text);
    }

    main article{
      background: rgba(15,22,33,0.72);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(8px);
    }

    section{
      padding:22px 20px;
      border-top:1px solid var(--border);
    }
    section:first-child{border-top:none}
    h2{
      margin:0 0 10px;
      font-size:1.35rem;
      letter-spacing:0.2px;
    }
    h3{
      margin:18px 0 8px;
      font-size:1.1rem;
      color:var(--text);
    }
    p{margin:10px 0; color:var(--muted)}
    ul{margin:10px 0 0 18px; color:var(--muted)}
    li{margin:6px 0}

    .grid2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:14px;
    }
    @media (max-width: 800px){
      .grid2{grid-template-columns:1fr}
    }

    .card{
      background: linear-gradient(180deg, rgba(16,27,42,0.85), rgba(15,22,33,0.7));
      border:1px solid var(--border);
      border-radius: 16px;
      padding:14px 14px 12px;
    }
    .card strong{display:block; margin-bottom:6px}
    .callout{
      border-left:4px solid var(--accent);
      background: rgba(119,183,255,0.08);
    }
    .warn{
      border-left-color: var(--warn);
      background: rgba(255,211,122,0.08);
    }
    .danger{
      border-left-color: var(--danger);
      background: rgba(255,122,154,0.08);
    }
    .ok{
      border-left-color: var(--accent2);
      background: rgba(140,255,193,0.07);
    }

    .eq{
      margin:10px 0 8px;
      padding:12px 12px;
      background: rgba(0,0,0,0.28);
      border:1px solid var(--border);
      border-radius: 14px;
      position:relative;
      overflow:hidden;
    }
    .eq pre{
      margin:0;
      font-family: var(--mono);
      font-size:0.95rem;
      color: var(--text);
      white-space: pre-wrap;
      word-break: break-word;
    }
    .btnrow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:8px;
    }
    button.copy{
      appearance:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,0.06);
      color: var(--text);
      padding:8px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-size:0.88rem;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      background: rgba(119,183,255,0.10);
      border-color: rgba(119,183,255,0.22);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius: 999px;
      border:1px solid var(--border);
      color: var(--muted);
      background: rgba(255,255,255,0.04);
      font-size:0.86rem;
    }
    .meta{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }

    details{
      border:1px solid var(--border);
      border-radius: 16px;
      padding:10px 12px;
      background: rgba(255,255,255,0.03);
      margin-top:12px;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight:600;
    }
    details p, details ul{color:var(--muted)}
    .backtop{
      display:inline-block;
      margin-top:14px;
      padding:8px 10px;
      border-radius: 12px;
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
    }

    footer{
      padding:22px 20px 34px;
      color: var(--faint);
      font-size:0.92rem;
      border-top:1px solid var(--border);
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, nav.toc, .backtop, button.copy{display:none !important}
      main article{box-shadow:none; border:1px solid #ccc; background:#fff}
      section{break-inside:avoid}
      .eq{background:#f7f7f7; border:1px solid #ddd}
      p, ul{color:#111}
      h2,h3{color:#000}
      a{color:#000; text-decoration:underline}
    }

    /* subtle micro-animation */
    @keyframes pop {
      from { transform: translateY(2px); opacity:0.8; }
      to   { transform: translateY(0); opacity:1; }
    }
    .flash{
      animation: pop 240ms ease;
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap title">
      <h1>Hyperfine Effects on ESR in Metals: Moments of a Random Hyperfine Field</h1>
      <div class="subtitle">
        We model the hyperfine field seen by a conduction electron as the average of many random nuclear-spin contributions.
        The task is to compute the second and fourth moments of that field and interpret what they mean for ESR line broadening.
      </div>
      <div class="meta">
        <span class="pill">Topic: ESR / hyperfine interaction</span>
        <span class="pill">Method: random variables + symmetry</span>
        <span class="pill">Result: symbolic moments ⟨B²⟩ and ⟨B⁴⟩</span>
      </div>
    </div>
  </header>

  <div class="wrap layout">
    <nav class="toc" aria-label="Table of contents">
      <div class="toc-head">
        <strong>Table of Contents</strong>
        <span>Sticky • click to jump</span>
      </div>
      <ul>
        <li><a href="#quick">Quick Summary</a></li>
        <li><a href="#part0">PART 0 — Concept Primer</a></li>
        <li><a href="#part0b">PART 0B — Industry & Applied Physics</a></li>
        <li><a href="#part1">PART 1 — Problem Analysis</a></li>
        <li><a href="#part2">PART 2 — Strategy & Tips</a></li>
        <li><a href="#part3">PART 3 — Full Solution</a></li>
        <li><a href="#part4">PART 4 — Deeper Understanding</a></li>
        <li><a href="#part5">PART 5 — Optional Plot Guide</a></li>
      </ul>
    </nav>

    <main>
      <article>
        <section id="quick">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this is about:</strong> A conduction electron in a metal experiences a <em>random</em> hyperfine magnetic field from many nuclei.</li>
            <li><strong>Key physics idea:</strong> Many independent nuclear spins contribute; by symmetry ⟨B⟩ = 0 but fluctuations ⟨B²⟩ ≠ 0.</li>
            <li><strong>Governing model:</strong> A random-field average
              <span class="pill" style="margin-left:6px;">B = (a/N) Σ I<sub>j</sub></span>
              with I<sub>j</sub> equally likely ±1/2.</li>
            <li><strong>Main results:</strong>
              ⟨B²⟩ scales like <em>1/N</em> (central-limit style), and ⟨B⁴⟩ scales like <em>1/N²</em>.</li>
            <li><strong>What it physically means:</strong> More nuclei in the “interaction volume” reduce hyperfine-field noise and narrow ESR broadening.</li>
            <li><strong>Result type:</strong> Fully symbolic (no numbers needed).</li>
            <li><strong>Mathematical core:</strong> Compute moments of a sum of i.i.d. zero-mean random variables using linearity of expectation and independence.</li>
          </ul>
        </section>

        <section id="part0">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <div class="grid2">
            <div class="card callout">
              <strong>Core definitions (symbols + units)</strong>
              <ul>
                <li><strong>B</strong>: z-component of effective magnetic field at the electron (tesla, T).</li>
                <li><strong>a</strong>: hyperfine coupling scale turned into “field units” in this simplified model (T). (Think: a proportionality between nuclear spin and field.)</li>
                <li><strong>N</strong>: number of nuclei effectively coupled to the electron (dimensionless count).</li>
                <li><strong>I<sub>j</sub></strong>: z-component of nuclear spin variable for nucleus j; here modeled as a random variable taking values ±1/2 (dimensionless in units of ℏ, but the ±1/2 is the only needed value).</li>
                <li><strong>⟨·⟩</strong>: ensemble average (statistical expectation) over random nuclear-spin configurations.</li>
              </ul>
            </div>

            <div class="card ok">
              <strong>Physical meaning & intuition</strong>
              <p>
                In a metal, conduction electrons move rapidly. Over short times the electron “samples” many nuclei,
                and the hyperfine interaction can be approximated as an <em>effective random magnetic field</em>.
                If nuclear spins are unpolarized, their contributions cancel on average, but there are fluctuations that broaden ESR lines.
              </p>
              <ul>
                <li>Average field ⟨B⟩ is typically zero (no net nuclear polarization).</li>
                <li>Noise level is set by variance ⟨B²⟩.</li>
                <li>Non-Gaussianity / tails are probed by ⟨B⁴⟩ (kurtosis-related).</li>
              </ul>
            </div>
          </div>

          <h3>Key principles and validity conditions</h3>
          <div class="card">
            <ul>
              <li><strong>Linearity of expectation:</strong> ⟨X + Y⟩ = ⟨X⟩ + ⟨Y⟩ always.</li>
              <li><strong>Independence:</strong> If I<sub>i</sub> and I<sub>j</sub> are independent, then ⟨f(I<sub>i</sub>) g(I<sub>j</sub>)⟩ = ⟨f(I<sub>i</sub>)⟩⟨g(I<sub>j</sub>)⟩.</li>
              <li><strong>Symmetry (unpolarized spins):</strong> Since ±1/2 are equally likely, ⟨I<sub>j</sub>⟩ = 0 and all odd moments ⟨I<sub>j</sub><sup>2m+1</sup>⟩ = 0.</li>
              <li><strong>Many-nuclei limit:</strong> For large N, sums of i.i.d. variables approach Gaussian behavior (Central Limit Theorem), explaining why ⟨B⁴⟩ ≈ 3⟨B²⟩².</li>
            </ul>
          </div>

          <h3>Common models / approximations in this topic</h3>
          <div class="card warn">
            <strong>Why this “random field” model is used</strong>
            <ul>
              <li><strong>Effective-field approximation:</strong> Replace microscopic hyperfine Hamiltonian by an effective field along z for a given electron spin component.</li>
              <li><strong>Uncorrelated nuclei:</strong> Treat different nuclei as statistically independent (reasonable at high temperature or weak nuclear-nuclear correlations).</li>
              <li><strong>Two-valued nuclear spin:</strong> Use I<sub>j</sub> = ±1/2 for simplicity (spin-1/2 nuclei). More general I gives different moments but same scaling in N.</li>
            </ul>
          </div>

          <h3>Mini intuition examples (no heavy algebra)</h3>
          <div class="grid2">
            <div class="card">
              <strong>Example 1: One nucleus (N = 1)</strong>
              <p>If N = 1, then B = a I<sub>1</sub> takes values ±a/2. The variance is large: ⟨B²⟩ = a²/4.</p>
            </div>
            <div class="card">
              <strong>Example 2: Many nuclei (large N)</strong>
              <p>When you average N random ±1/2 contributions, the typical sum scales like √N, so the average (divide by N) scales like 1/√N. Hence ⟨B²⟩ ∝ 1/N.</p>
            </div>
          </div>

          <h3>What to watch for (pitfalls)</h3>
          <div class="card danger">
            <ul>
              <li>Forgetting the factor <strong>(a/N)</strong> when computing moments.</li>
              <li>Assuming ⟨(Σ I<sub>j</sub>)²⟩ = (Σ ⟨I<sub>j</sub>⟩)² (false; you need variances).</li>
              <li>Missing combinatorial factors in the fourth moment (the “6” in X<sub>i</sub>²X<sub>j</sub>² terms).</li>
              <li>Confusing ⟨B⁴⟩ with ⟨B²⟩²; they are related but not identical for finite N.</li>
            </ul>
          </div>

          <div class="card callout" style="margin-top:12px;">
            <strong>Math Insight (core equation as a mathematical object)</strong>
            <p>
              The hyperfine field is a <em>normalized sum</em> of i.i.d. random variables:
              <span class="pill">B = (a/N) Σ I<sub>j</sub></span>.
              Mathematically, this is the same structure behind the <em>Central Limit Theorem</em>: fluctuations scale as 1/√N, and the fourth moment approaches the Gaussian identity
              ⟨B⁴⟩ → 3⟨B²⟩² as N grows.
            </p>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="part0b">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>

          <div class="card">
            <strong>Where this appears in industry (concrete areas)</strong>
            <ul>
              <li><strong>Spintronics & magnetic sensors:</strong> Hyperfine-induced dephasing limits spin coherence in metals/semiconductors, affecting MR sensors and spin-transport devices.</li>
              <li><strong>Quantum technologies:</strong> Hyperfine fields are a dominant noise source for electron spins in solid-state qubits (materials selection and isotopic purification matter).</li>
              <li><strong>ESR/EPR metrology & materials characterization:</strong> ESR linewidths and line shapes provide fingerprints of impurities, defects, and local magnetic environments.</li>
            </ul>
          </div>

          <div class="grid2">
            <div class="card ok">
              <strong>Why engineers care</strong>
              <ul>
                <li><strong>Performance:</strong> Spin coherence time T<sub>2</sub> often sets device bandwidth and sensitivity.</li>
                <li><strong>Reliability:</strong> Random local fields can drift with temperature, stress, and microstructure.</li>
                <li><strong>Cost & manufacturability:</strong> Isotopic purification reduces hyperfine noise but increases cost; process windows must be balanced.</li>
              </ul>
            </div>
            <div class="card warn">
              <strong>Measurement/validation methods</strong>
              <ul>
                <li><strong>ESR/EPR spectroscopy:</strong> linewidth and higher-moment line-shape analysis (Gaussian vs Lorentzian contributions).</li>
                <li><strong>NMR / Knight shift:</strong> probes hyperfine coupling and electron-nuclear interactions indirectly.</li>
                <li><strong>Noise spectroscopy:</strong> measures effective field fluctuations via spin-echo / relaxation rates.</li>
              </ul>
            </div>
          </div>

          <div class="card">
            <strong>Design trade-offs & constraints (real materials)</strong>
            <ul>
              <li><strong>Non-idealities:</strong> nuclei may not be independent (dipolar correlations), and electron wavefunctions weight nuclei unequally (non-uniform couplings).</li>
              <li><strong>Tolerances:</strong> microstructure, grain boundaries, and impurities change the effective N (interaction volume) and thus the noise level.</li>
              <li><strong>Thermal & field conditions:</strong> partial nuclear polarization (low T, high B) breaks the ± symmetry, giving ⟨B⟩ ≠ 0.</li>
            </ul>
          </div>

          <div class="card callout">
            <strong>From lab to product</strong>
            <p>
              The idealized model uses equal couplings and independent spins. In products, engineers often replace
              <span class="pill">B = (a/N) Σ I<sub>j</sub></span>
              by a weighted sum <span class="pill">B = Σ A<sub>j</sub> I<sub>j</sub></span>, where A<sub>j</sub> comes from device geometry/material wavefunctions.
              The same moment-method logic still applies, but with sums over A<sub>j</sub>² and A<sub>j</sub>⁴ instead of simple N-scaling.
            </p>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="part1">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <div class="card">
            <strong>Problem restatement (in plain words)</strong>
            <p>
              A conduction electron experiences an effective z-directed hyperfine field defined by
              <span class="pill">B = (a/N) Σ<sub>j=1..N</sub> I<sub>j</sub></span>,
              where each nuclear spin component I<sub>j</sub> is an independent random variable taking values ±1/2 with equal probability.
              Compute the second moment ⟨B²⟩, and show that for large N the fourth moment satisfies ⟨B⁴⟩ = 3 (a/2N)⁴ N².
            </p>
          </div>

          <div class="grid2">
            <div class="card">
              <strong>Given</strong>
              <ul>
                <li>B = (a/N) Σ I<sub>j</sub></li>
                <li>I<sub>j</sub> = +1/2 or −1/2 with probability 1/2 each</li>
                <li>(Implicit) I<sub>j</sub> are i.i.d. (independent and identically distributed)</li>
              </ul>
            </div>
            <div class="card">
              <strong>Unknowns / what to prove</strong>
              <ul>
                <li>(a) ⟨B²⟩ = (a/2N)² N</li>
                <li>(b) ⟨B⁴⟩ = 3 (a/2N)⁴ N² for N ≫ 1</li>
              </ul>
            </div>
          </div>

          <h3>Relevant principles (and why they apply)</h3>
          <div class="card">
            <ul>
              <li><strong>Expectation algebra:</strong> expanding powers of sums and taking ⟨·⟩ term-by-term is valid by linearity.</li>
              <li><strong>Symmetry:</strong> ⟨I<sub>j</sub>⟩ = 0 implies all terms containing an odd power of any I<sub>j</sub> vanish.</li>
              <li><strong>Independence:</strong> allows factorization like ⟨I<sub>i</sub>² I<sub>j</sub>²⟩ = ⟨I<sub>i</sub>²⟩⟨I<sub>j</sub>²⟩ for i ≠ j.</li>
            </ul>
          </div>

          <div class="card warn">
            <strong>Assumptions (explicit)</strong>
            <ul>
              <li><strong>Unpolarized nuclei:</strong> P(+1/2)=P(−1/2)=1/2 (no net nuclear magnetization).</li>
              <li><strong>Statistical independence:</strong> nuclear spins are uncorrelated.</li>
              <li><strong>Uniform coupling:</strong> each nucleus contributes equally (same prefactor a/N).</li>
              <li><strong>Large-N approximation in (b):</strong> keep leading order in N (drop lower-order terms).</li>
            </ul>
          </div>

          <h3>Possible approaches (compare)</h3>
          <div class="grid2">
            <div class="card">
              <strong>Approach 1: Direct expansion (best here)</strong>
              <ul>
                <li>Expand (Σ I<sub>j</sub>)² and (Σ I<sub>j</sub>)⁴.</li>
                <li>Use symmetry + independence to kill many terms.</li>
                <li><em>Pros:</em> exact, transparent, minimal machinery.</li>
                <li><em>Cons:</em> bookkeeping for 4th moment (but manageable).</li>
              </ul>
            </div>
            <div class="card">
              <strong>Approach 2: Cumulants / CLT reasoning</strong>
              <ul>
                <li>Use that sums become Gaussian for large N.</li>
                <li>Then ⟨B⁴⟩ ≈ 3⟨B²⟩².</li>
                <li><em>Pros:</em> very fast for large N.</li>
                <li><em>Cons:</em> less explicit; needs a variance computed anyway.</li>
              </ul>
            </div>
          </div>

          <div class="card ok">
            <strong>Chosen approach</strong>
            <p>
              We will use <strong>direct expansion</strong> because it yields (a) exactly and (b) with a clean large-N limit,
              and it teaches the combinatorics that underlies Gaussian behavior.
            </p>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="part2">
          <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

          <div class="card">
            <strong>Roadmap (8 steps)</strong>
            <ol style="margin:10px 0 0 18px; color:var(--muted)">
              <li><strong>Define the random variables</strong> I<sub>j</sub> and compute their basic moments ⟨I⟩, ⟨I²⟩, ⟨I⁴⟩.</li>
              <li><strong>Write B</strong> as B = (a/N) S with S = Σ I<sub>j</sub>.</li>
              <li><strong>Compute ⟨B²⟩</strong> by expanding S², keeping only surviving terms using ⟨I⟩=0 and independence.</li>
              <li><strong>Interpret ⟨B²⟩ physically</strong> as fluctuation strength ∝ 1/N.</li>
              <li><strong>Compute ⟨B⁴⟩</strong> by expanding S⁴ and classifying terms by index patterns (i⁴ and i²j² survive).</li>
              <li><strong>Handle combinatorics</strong>: count how many i²j² terms appear and their coefficient.</li>
              <li><strong>Take large-N limit</strong> to simplify ⟨B⁴⟩ to leading order in N.</li>
              <li><strong>Sanity checks</strong>: dimensions, limiting cases (N=1, N→∞), and Gaussian relation ⟨B⁴⟩ ≈ 3⟨B²⟩².</li>
            </ol>
          </div>

          <div class="card danger">
            <strong>Common mistakes</strong>
            <ul>
              <li>Dropping cross terms too early: in ⟨S²⟩ the cross terms vanish only <em>after</em> taking expectations.</li>
              <li>For ⟨S⁴⟩, forgetting that X<sub>i</sub>²X<sub>j</sub>² terms have coefficient 6 (not 2, not 4).</li>
              <li>Applying the Gaussian identity ⟨B⁴⟩=3⟨B²⟩² without stating it is a <em>large-N</em> consequence.</li>
            </ul>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="part3">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>Qualitative expectation (before calculating)</h3>
          <div class="card">
            <p>
              Each nucleus contributes a random ±(a/2N) to the field. Adding N independent contributions,
              the sum fluctuates like √N, so the average (divide by N) fluctuates like 1/√N.
              Therefore we expect:
            </p>
            <ul>
              <li>⟨B⟩ = 0 (no net polarization).</li>
              <li>Typical size B<sub>rms</sub> = √⟨B²⟩ ∝ 1/√N.</li>
              <li>⟨B⁴⟩ ∝ 1/N², and for large N it should approach the Gaussian relation ⟨B⁴⟩ ≈ 3⟨B²⟩².</li>
            </ul>
          </div>

          <h3>Mathematical model (variables, domain, assumptions)</h3>
          <div class="card callout">
            <p>
              We model the nuclear-spin configuration as a discrete probability space:
              each I<sub>j</sub> ∈ {−1/2, +1/2} with P=1/2, and the joint distribution factorizes (independence).
              There is no PDE here; the “operator” is the <strong>expectation functional</strong> ⟨·⟩ acting on random variables:
              it is linear and respects factorization under independence.
            </p>
            <div class="eq" data-copy>
<pre>Random variables:
I_j ∈ {−1/2, +1/2},   P(I_j = +1/2)=P(I_j = −1/2)=1/2,  independent

Field:
B = (a/N) Σ_{j=1}^N I_j

Goal: compute ⟨B^2⟩ and ⟨B^4⟩ (large-N form)</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy key equations</button>
            </div>
          </div>

          <h3>Step 1: Basic moments of a single nuclear variable</h3>
          <div class="card">
            <p>Let I be a generic copy of I<sub>j</sub>. Because it takes values ±1/2 equally often:</p>
            <div class="eq" data-copy>
<pre>⟨I⟩ = (1/2)(+1/2) + (1/2)(−1/2) = 0

⟨I^2⟩ = (1/2)(1/2)^2 + (1/2)(1/2)^2 = 1/4

⟨I^4⟩ = (1/2)(1/2)^4 + (1/2)(1/2)^4 = 1/16</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy these moments</button>
            </div>
            <p>
              <strong>Why this matters:</strong> ⟨I⟩=0 enforces symmetry (odd terms vanish), while ⟨I²⟩ and ⟨I⁴⟩ set the scale of fluctuations.
            </p>
          </div>

          <h3>Step 2: Compute ⟨B²⟩</h3>
          <div class="card">
            <p>
              Define the sum S = Σ<sub>j=1..N</sub> I<sub>j</sub>, so B = (a/N) S. Then
            </p>

            <div class="eq" data-copy>
<pre>⟨B^2⟩ = (a^2/N^2) ⟨S^2⟩
S^2 = (Σ_{j=1}^N I_j)^2 = Σ_{j=1}^N I_j^2 + 2 Σ_{1≤i&lt;j≤N} I_i I_j</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy expansion</button>
            </div>

            <p>
              Now take expectation ⟨·⟩ term-by-term (valid by linearity). For i ≠ j, independence gives ⟨I<sub>i</sub>I<sub>j</sub>⟩ = ⟨I<sub>i</sub>⟩⟨I<sub>j</sub>⟩ = 0·0 = 0.
              Therefore the cross terms vanish.
            </p>

            <div class="eq" data-copy>
<pre>⟨S^2⟩ = Σ_{j=1}^N ⟨I_j^2⟩ + 2 Σ_{i&lt;j} ⟨I_i I_j⟩
      = Σ_{j=1}^N (1/4) + 2 Σ_{i&lt;j} 0
      = N/4</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy ⟨S²⟩</button>
            </div>

            <p>Insert into ⟨B²⟩ = (a²/N²)⟨S²⟩:</p>
            <div class="eq" data-copy>
<pre>⟨B^2⟩ = (a^2/N^2) (N/4) = a^2/(4N) = (a/2N)^2 N</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy final ⟨B²⟩</button>
            </div>

            <div class="card ok" style="margin-top:12px;">
              <strong>Result (a) — boxed</strong>
              <div class="eq" data-copy>
<pre>⟨B^2⟩ = (a/2N)^2 N = a^2/(4N)</pre>
              </div>
              <div class="btnrow">
                <button class="copy" type="button" data-copy-btn>Copy result (a)</button>
              </div>
            </div>
          </div>

          <h3>Step 3: Compute ⟨B⁴⟩ (with careful combinatorics)</h3>
          <div class="card">
            <p>
              Again B = (a/N)S, so ⟨B⁴⟩ = (a⁴/N⁴)⟨S⁴⟩. We expand S⁴ and keep only terms whose expectation does not vanish.
              Because each I<sub>j</sub> has ⟨I<sub>j</sub>⟩=0, any product containing an odd power of some index will average to zero.
            </p>

            <details>
              <summary>Optional deeper note: why “odd-power” terms vanish</summary>
              <p>
                Consider a term like ⟨I_i^3 I_j⟩ with i≠j. Independence implies
                ⟨I_i^3 I_j⟩ = ⟨I_i^3⟩⟨I_j⟩. But ⟨I_j⟩=0 by symmetry, and ⟨I_i^3⟩=0 as well.
                Similarly, ⟨I_i I_j I_k I_l⟩ with all indices distinct factorizes into ⟨I_i⟩⟨I_j⟩⟨I_k⟩⟨I_l⟩ = 0.
              </p>
            </details>

            <p>
              The only surviving index patterns in ⟨S⁴⟩ are:
            </p>
            <ul>
              <li><strong>All four factors from the same index:</strong> I<sub>i</sub><sup>4</sup></li>
              <li><strong>Two factors from i and two from j (i≠j):</strong> I<sub>i</sub><sup>2</sup> I<sub>j</sub><sup>2</sup></li>
            </ul>

            <p>
              Start from the multinomial expansion. A standard (and verifiable) identity for independent zero-mean variables is:
            </p>

            <div class="eq" data-copy>
<pre>⟨(Σ_{j=1}^N I_j)^4⟩
= Σ_{j=1}^N ⟨I_j^4⟩  + 6 Σ_{1≤i&lt;j≤N} ⟨I_i^2 I_j^2⟩</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy 4th-moment identity</button>
            </div>

            <p>
              <strong>Why the coefficient is 6:</strong>
              for fixed distinct i and j, the term I<sub>i</sub><sup>2</sup>I<sub>j</sub><sup>2</sup> can arise from choosing which two of the four factors come from i:
              that count is “4 choose 2” = 6.
            </p>

            <p>
              Using independence, ⟨I<sub>i</sub><sup>2</sup>I<sub>j</sub><sup>2</sup>⟩ = ⟨I<sub>i</sub><sup>2</sup>⟩⟨I<sub>j</sub><sup>2</sup>⟩ = (1/4)(1/4)=1/16.
              Also ⟨I<sub>j</sub><sup>4</sup>⟩=1/16.
            </p>

            <div class="eq" data-copy>
<pre>⟨S^4⟩ = Σ_{j=1}^N (1/16) + 6 Σ_{i&lt;j} (1/16)
      = N/16 + 6 * [N(N−1)/2] * (1/16)
      = N/16 + 3N(N−1)/16
      = (3N^2 − 2N)/16</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy ⟨S⁴⟩ derivation</button>
            </div>

            <p>
              Therefore
            </p>
            <div class="eq" data-copy>
<pre>⟨B^4⟩ = (a^4/N^4) ⟨S^4⟩
      = (a^4/N^4) * (3N^2 − 2N)/16
      = (a^4/16) * (3N^2 − 2N) / N^4</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy exact ⟨B⁴⟩</button>
            </div>

            <p>
              For <strong>N ≫ 1</strong>, the leading term is (3N²)/16, so:
            </p>
            <div class="eq" data-copy>
<pre>⟨B^4⟩ ≈ (a^4/N^4) * (3N^2/16)
      = 3 a^4 / (16 N^2)
      = 3 (a/2N)^4 N^2</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy large-N ⟨B⁴⟩</button>
            </div>

            <div class="card ok" style="margin-top:12px;">
              <strong>Result (b) — boxed (large N)</strong>
              <div class="eq" data-copy>
<pre>For N ≫ 1:
⟨B^4⟩ = 3 (a/2N)^4 N^2 = 3 a^4/(16 N^2)</pre>
              </div>
              <div class="btnrow">
                <button class="copy" type="button" data-copy-btn>Copy result (b)</button>
              </div>
            </div>
          </div>

          <h3>Sanity checks</h3>
          <div class="grid2">
            <div class="card">
              <strong>Dimensional analysis</strong>
              <ul>
                <li>a has units of magnetic field (T) in this model.</li>
                <li>⟨B²⟩ has units T²: a²/(4N) → T² ✔</li>
                <li>⟨B⁴⟩ has units T⁴: 3a⁴/(16N²) → T⁴ ✔</li>
              </ul>
            </div>
            <div class="card">
              <strong>Limiting cases</strong>
              <ul>
                <li>N=1: ⟨B²⟩ = a²/4 (matches B=±a/2) ✔</li>
                <li>N→∞: ⟨B²⟩→0 and ⟨B⁴⟩→0 (self-averaging) ✔</li>
                <li>Large N: ⟨B⁴⟩ ≈ 3⟨B²⟩² (Gaussian-like) ✔</li>
              </ul>
            </div>
          </div>

          <div class="card callout" style="margin-top:12px;">
            <strong>Physical interpretation (plain language)</strong>
            <p>
              The electron feels a fluctuating hyperfine field due to random nuclear spins.
              The fluctuation strength falls as 1/√N, meaning that in materials (or device regions) where the electron overlaps many nuclei,
              hyperfine-induced ESR broadening is reduced. The fourth moment confirms that for large N the distribution becomes nearly Gaussian.
            </p>
          </div>

          <h3>Final answer (copy-friendly)</h3>
          <div class="card ok">
            <div class="eq" id="finalAnswer" data-copy>
<pre>(a) ⟨B^2⟩ = (a^2/N^2) ⟨(Σ_{j=1}^N I_j)^2⟩
          = (a^2/N^2) (N⟨I^2⟩)
          = (a^2/N^2) (N/4)
          = a^2/(4N) = (a/2N)^2 N.

(b) ⟨B^4⟩ = (a^4/N^4) ⟨(Σ_{j=1}^N I_j)^4⟩
          = (a^4/N^4)[ N⟨I^4⟩ + 6 Σ_{i<j} ⟨I_i^2⟩⟨I_j^2⟩ ]
          = (a^4/N^4)[ N/16 + 3N(N−1)/16 ]
          = (a^4/N^4)(3N^2 − 2N)/16
          ≈ 3a^4/(16N^2) = 3 (a/2N)^4 N^2   for N ≫ 1.</pre>
            </div>
            <div class="btnrow">
              <button class="copy" type="button" data-copy-btn>Copy final answer</button>
            </div>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="part4">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>Re-reading the formula: what controls what?</h3>
          <div class="card">
            <ul>
              <li><strong>Coupling scale a:</strong> multiplies the field linearly, so moments scale as a² and a⁴.</li>
              <li><strong>Number of nuclei N:</strong> averaging over more nuclei reduces noise:
                <span class="pill">⟨B²⟩ ∝ 1/N</span> and <span class="pill">⟨B⁴⟩ ∝ 1/N²</span>.</li>
              <li><strong>Spin value ±1/2:</strong> sets ⟨I²⟩=1/4 and ⟨I⁴⟩=1/16; different nuclear spin magnitudes change constants but not N-scaling.</li>
            </ul>
          </div>

          <h3>Parameter dependence (qualitative)</h3>
          <div class="card">
            <ul>
              <li>Increase <strong>a</strong> → larger hyperfine broadening (moments grow strongly).</li>
              <li>Increase <strong>N</strong> (more nuclei sampled) → narrower distribution of B, smaller ESR broadening.</li>
              <li>If nuclei are partially polarized (bias), then ⟨I⟩ ≠ 0 → you would get ⟨B⟩ ≠ 0 and additional terms in moments.</li>
            </ul>
          </div>

          <h3>Alternative derivation idea (brief but meaningful)</h3>
          <div class="card callout">
            <p>
              In the large-N regime, the Central Limit Theorem says S = Σ I<sub>j</sub> approaches a Gaussian with variance N⟨I²⟩.
              For a zero-mean Gaussian variable X, the identity ⟨X⁴⟩ = 3⟨X²⟩² holds exactly.
              Once ⟨B²⟩ is known, you can infer ⟨B⁴⟩ ≈ 3⟨B²⟩², reproducing part (b) as the leading large-N term.
            </p>
          </div>

          <h3>Concept check (self-test, with answers)</h3>
          <div class="card">
            <ul>
              <li><strong>Q:</strong> Why is ⟨B⟩ = 0? <strong>A:</strong> Each I<sub>j</sub> is symmetric ±1/2, so ⟨I<sub>j</sub>⟩=0 and thus ⟨B⟩=(a/N)Σ⟨I<sub>j</sub>⟩=0.</li>
              <li><strong>Q:</strong> What sets the scale of ESR broadening in this model? <strong>A:</strong> The rms field √⟨B²⟩ = a/(2√N).</li>
              <li><strong>Q:</strong> Where does the “3” in ⟨B⁴⟩ come from? <strong>A:</strong> It reflects Gaussian-like pairing of indices; combinatorially it arises from the 6 ways to choose 2 of 4 factors for i in i²j² terms, leading to 3N(N−1) contributions.</li>
              <li><strong>Q:</strong> Does ⟨B⁴⟩ = 3⟨B²⟩² hold exactly for finite N? <strong>A:</strong> Not exactly; finite-N corrections exist. Here ⟨B⁴⟩ = (a⁴/N⁴)(3N²−2N)/16, which approaches 3⟨B²⟩² as N→∞.</li>
            </ul>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <section id="part5">
          <h2>PART 5 — Optional Plot Guide</h2>
          <div class="card">
            <p>
              A plot is not necessary here because the problem is purely symbolic and the key takeaway is the <strong>scaling</strong>:
              ⟨B²⟩ ∝ 1/N and ⟨B⁴⟩ ∝ 1/N². Any plot would only illustrate these power laws without adding new reasoning.
            </p>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <footer>
          <div class="wrap">
            <p>
              Notes: This solution treats the hyperfine field as a sum of independent, equally coupled spin-1/2 nuclei.
              Real materials may require weighted couplings, correlated nuclei, or dynamic averaging, but the same moment-based logic is a standard starting point for ESR line-shape intuition.
            </p>
          </div>
        </footer>
      </article>
    </main>
  </div>

  <script>
    // Copy buttons for equation blocks and final answer
    (function(){
      function getNearestCopyBlock(btn){
        // Find the closest ancestor section and then a previous sibling or nearest .eq with [data-copy]
        // Simpler: walk up to parent, then query within parent for the first .eq[data-copy] preceding the button.
        const container = btn.closest('.card') || btn.parentElement;
        if(!container) return null;
        // Prefer the nearest previous .eq within the same card
        const eq = container.querySelector('.eq[data-copy]');
        return eq;
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.opacity = '0';
          document.body.appendChild(ta);
          ta.select();
          try{
            document.execCommand('copy');
            document.body.removeChild(ta);
            return true;
          }catch(err){
            document.body.removeChild(ta);
            return false;
          }
        }
      }

      function flash(el){
        el.classList.remove('flash');
        void el.offsetWidth;
        el.classList.add('flash');
      }

      document.querySelectorAll('[data-copy-btn]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const eq = getNearestCopyBlock(btn);
          if(!eq) return;
          const pre = eq.querySelector('pre');
          const text = pre ? pre.textContent.trim() : eq.textContent.trim();
          const ok = await copyText(text);
          btn.textContent = ok ? 'Copied ✓' : 'Copy failed';
          flash(btn);
          setTimeout(()=>{ btn.textContent = 'Copy'; }, 900);
        });

        // Set initial text label to match context where possible
        // If button already has custom text (e.g. "Copy final answer"), keep it.
      });

      // Preserve custom labels but set generic "Copy" for those without
      document.querySelectorAll('button.copy').forEach(b=>{
        const t = b.textContent.trim();
        if(t === '') b.textContent = 'Copy';
      });
    })();
  </script>
</body>
</html>