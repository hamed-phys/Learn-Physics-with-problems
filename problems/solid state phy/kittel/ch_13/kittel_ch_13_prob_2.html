<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Rotating Coordinate System in Magnetization Dynamics (NMR/ESR): Derivative Rules, Rotating-Frame Bloch Equation, and the π-Pulse</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1621;
      --card:#121b28;
      --text:#e7eef9;
      --muted:#a9b7cc;
      --line:rgba(231,238,249,0.12);
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#86efac;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius:16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    html,body{height:100%;}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 15% -10%, rgba(125,211,252,0.12), transparent 50%),
        radial-gradient(900px 600px at 90% 10%, rgba(167,139,250,0.12), transparent 55%),
        radial-gradient(900px 700px at 40% 120%, rgba(134,239,172,0.08), transparent 50%),
        var(--bg);
      line-height:1.55;
    }

    header{
      padding: 28px 18px 10px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(to bottom, rgba(18,27,40,0.65), rgba(11,15,20,0));
      position: relative;
      overflow:hidden;
    }
    header::after{
      content:"";
      position:absolute;
      inset:-60px -40px auto auto;
      width:280px; height:280px;
      background: radial-gradient(circle at 30% 30%, rgba(125,211,252,0.22), transparent 60%);
      filter: blur(6px);
      transform: rotate(12deg);
      pointer-events:none;
    }

    .wrap{
      max-width: 1180px;
      margin:0 auto;
      padding: 0 18px 60px;
    }

    .title{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      align-items:end;
      padding: 8px 0 18px;
    }
    h1{
      margin:0;
      font-size: clamp(1.5rem, 2.4vw, 2.4rem);
      letter-spacing: 0.2px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      max-width: 90ch;
    }

    .layout{
      display:grid;
      grid-template-columns: 290px 1fr;
      gap:16px;
      align-items:start;
      margin-top: 18px;
    }

    nav{
      position: sticky;
      top: 14px;
      align-self:start;
      background: rgba(18,27,40,0.65);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    nav .navhead{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    nav .navhead strong{
      font-size: 0.95rem;
      letter-spacing:0.3px;
    }
    nav ul{
      list-style:none;
      margin:0;
      padding: 10px 10px 12px;
      display:grid;
      gap:6px;
    }
    nav a{
      display:block;
      padding: 9px 10px;
      border-radius: 12px;
      color: var(--text);
      text-decoration:none;
      font-size: 0.92rem;
      border: 1px solid transparent;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
    }
    nav a:hover{
      background: rgba(125,211,252,0.10);
      border-color: rgba(125,211,252,0.22);
      transform: translateY(-1px);
    }

    main{
      min-width:0;
      display:grid;
      gap:16px;
    }

    section, article{
      background: rgba(18,27,40,0.62);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    .sec-pad{ padding: 18px; }

    h2{
      margin:0 0 10px;
      font-size: clamp(1.2rem, 1.6vw, 1.5rem);
      letter-spacing:0.2px;
    }
    h3{
      margin: 16px 0 8px;
      font-size: 1.05rem;
      letter-spacing:0.2px;
      color: rgba(231,238,249,0.95);
    }
    p{ margin: 8px 0; color: rgba(231,238,249,0.92); }
    ul,ol{ margin: 8px 0 8px 22px; color: rgba(231,238,249,0.92); }
    li{ margin: 4px 0; }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; }
      nav{ position: relative; top:auto; }
      .grid2{ grid-template-columns: 1fr; }
    }

    .callouts{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
      margin-top: 10px;
    }
    .callout{
      grid-column: span 12;
      border:1px solid var(--line);
      border-radius: 14px;
      padding: 12px 12px;
      background: rgba(15,22,33,0.55);
      position:relative;
      overflow:hidden;
    }
    .callout::before{
      content:"";
      position:absolute;
      inset:0 auto 0 0;
      width:4px;
      background: linear-gradient(to bottom, var(--accent), var(--accent2));
      opacity:0.9;
    }
    .callout h4{
      margin: 0 0 6px;
      font-size: 0.95rem;
      letter-spacing:0.2px;
    }
    .callout small, .callout .muted{ color: var(--muted); }
    .callout.good::before{ background: linear-gradient(to bottom, var(--good), rgba(134,239,172,0.4));}
    .callout.warn::before{ background: linear-gradient(to bottom, var(--warn), rgba(251,191,36,0.4));}
    .callout.bad::before{ background: linear-gradient(to bottom, var(--bad), rgba(251,113,133,0.45));}

    .eqbox{
      border:1px solid rgba(125,211,252,0.25);
      background: rgba(10,14,20,0.55);
      border-radius: 14px;
      padding: 12px;
      margin: 10px 0;
      overflow:auto;
    }
    .eqbox pre{
      margin:0;
      font-family: var(--mono);
      font-size: 0.92rem;
      line-height: 1.45;
      color: rgba(231,238,249,0.95);
      white-space: pre-wrap;
    }
    .eqhdr{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    .eqhdr span{
      font-size: 0.9rem;
      color: var(--muted);
    }

    button.copy{
      appearance:none;
      border:1px solid rgba(231,238,249,0.16);
      background: rgba(231,238,249,0.06);
      color: var(--text);
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-size: 0.86rem;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
      white-space:nowrap;
    }
    button.copy:hover{
      background: rgba(125,211,252,0.12);
      border-color: rgba(125,211,252,0.28);
      transform: translateY(-1px);
    }
    button.copy:active{ transform: translateY(0px) scale(0.99); }

    details{
      border:1px solid var(--line);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(15,22,33,0.45);
      margin: 10px 0;
    }
    details summary{
      cursor:pointer;
      font-weight: 650;
      color: rgba(231,238,249,0.95);
    }

    .mini{
      font-size: 0.95rem;
      color: rgba(231,238,249,0.9);
    }
    .muted{ color: var(--muted); }

    .final{
      border:1px solid rgba(134,239,172,0.24);
      background: rgba(7,13,10,0.55);
    }
    .final::before{
      background: linear-gradient(to bottom, var(--good), rgba(134,239,172,0.25));
    }

    .backtop{
      display:inline-block;
      margin-top: 12px;
      color: var(--accent);
      text-decoration:none;
      font-weight:650;
    }
    .backtop:hover{ text-decoration: underline; }

    footer{
      margin-top: 16px;
      padding: 16px 18px 28px;
      color: var(--muted);
      font-size: 0.92rem;
      border-top:1px solid var(--line);
    }

    /* Print-friendly */
    @media print{
      body{ background:#fff; color:#000; }
      header, nav{ display:none !important; }
      section, article{
        background:#fff !important;
        box-shadow:none !important;
        border: 1px solid #ddd !important;
      }
      .wrap{ max-width: 100%; padding:0; }
      .layout{ grid-template-columns: 1fr; }
      .eqbox{ border:1px solid #ccc; background:#fff; }
      .callout{ background:#fff; }
      button.copy{ display:none !important; }
      a.backtop{ display:none !important; }
      .pagebreak{ break-before: page; }
    }

    /* Subtle micro-animation */
    @keyframes fadeInUp{
      from{ opacity:0; transform: translateY(6px); }
      to{ opacity:1; transform: translateY(0); }
    }
    section, article{ animation: fadeInUp 240ms ease both; }
  </style>
</head>

<body>
  <a id="top"></a>
  <header>
    <div class="wrap">
      <div class="title">
        <h1>Rotating Coordinate System for Magnetization Dynamics: Derivative Rules, Rotating-Frame Bloch Equation, and the π-Pulse</h1>
        <p class="subtitle">
          A mathematically careful tutorial on how rotating frames simplify precession problems (NMR/ESR), with an applied-engineering lens and a clean path from lab-frame fields to rotating-frame control pulses.
        </p>
      </div>
    </div>
  </header>

  <div class="wrap">
    <div class="layout">
      <nav aria-label="Table of contents">
        <div class="navhead">
          <strong>Contents</strong>
          <span class="muted" style="font-size:0.85rem;">sticky</span>
        </div>
        <ul>
          <li><a href="#quick">Quick Summary</a></li>
          <li><a href="#part0">PART 0 — Concept Primer</a></li>
          <li><a href="#part0b">PART 0B — Industry & Applied Physics</a></li>
          <li><a href="#part1">PART 1 — Problem Analysis</a></li>
          <li><a href="#part2">PART 2 — Strategy & Tips</a></li>
          <li><a href="#part3">PART 3 — Full Solution</a></li>
          <li><a href="#part4">PART 4 — Deeper Understanding</a></li>
          <li><a href="#part5">PART 5 — Optional Plot Guide</a></li>
        </ul>
      </nav>

      <main>
        <section id="quick">
          <div class="sec-pad">
            <h2>Quick Summary</h2>
            <ul>
              <li><strong>What this problem is about:</strong> how time-derivatives transform between the lab frame and a coordinate system rotating with angular velocity <span class="mini">Ω</span>, and how that simplifies magnetization precession.</li>
              <li><strong>Key physics idea:</strong> a rotating frame adds an extra “apparent” term <span class="mini">Ω ×</span> in time derivatives; in magnetization dynamics this looks like an additional effective magnetic field <span class="mini">B<sub>eff</sub> = B + Ω/γ</span>.</li>
              <li><strong>Governing equation:</strong> (no relaxation) <span class="mini">dM/dt = γ M × B</span> in the lab frame.</li>
              <li><strong>Rotating-frame equation:</strong> <span class="mini">(dM/dt)<sub>R</sub> = γ M × (B + Ω/γ)</span>.</li>
              <li><strong>Control result (π-pulse):</strong> if <span class="mini">Ω = −γ B<sub>0</sub> ẑ</span> cancels the static field in the rotating frame, then a constant pulse <span class="mini">B<sub>1</sub> x̂</span> flips <span class="mini">M</span> from <span class="mini">+ẑ</span> to <span class="mini">−ẑ</span> in time <span class="mini">t = π/(|γ| B<sub>1</sub>)</span> (symbolic).</li>
              <li><strong>What it means physically:</strong> in the lab, that “dc” rotating-frame pulse is an RF field rotating in the transverse plane at the Larmor frequency—i.e., a resonant circularly polarized drive.</li>
              <li><strong>Result type:</strong> fully symbolic; includes sign/dimension checks and lab-frame interpretation.</li>
            </ul>
          </div>
        </section>

        <article id="part0">
          <div class="sec-pad">
            <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

            <h3>Core definitions (symbols + SI units)</h3>
            <ul>
              <li><strong>Vector in time:</strong> <span class="mini">F(t) = F<sub>x</sub>(t) x̂ + F<sub>y</sub>(t) ŷ + F<sub>z</sub>(t) ẑ</span> (units depend on context).</li>
              <li><strong>Rotating basis:</strong> <span class="mini">x̂(t), ŷ(t), ẑ(t)</span> rotate with angular velocity <span class="mini">Ω</span> (SI: rad/s), typically about <span class="mini">ẑ</span>.</li>
              <li><strong>Angular velocity vector:</strong> <span class="mini">Ω</span> points along the instantaneous rotation axis (right-hand rule).</li>
              <li><strong>Magnetization:</strong> <span class="mini">M</span> (SI: A/m) is magnetic moment per volume.</li>
              <li><strong>Gyromagnetic ratio:</strong> <span class="mini">γ</span> (SI: rad·s<sup>−1</sup>·T<sup>−1</sup>), may be positive or negative depending on the particle/system.</li>
              <li><strong>Magnetic field:</strong> <span class="mini">B</span> (SI: Tesla, T).</li>
            </ul>

            <h3>Physical meaning & intuition</h3>
            <p>
              A rotating coordinate system is a bookkeeping trick: you describe a moving vector using axes that themselves rotate.
              The vector can appear to change more slowly (or even become stationary) when viewed in a rotating frame.
              In magnetization problems, this is powerful because magnetization precesses about a strong static field at the Larmor frequency;
              rotating the axes at that frequency can remove the fast motion.
            </p>

            <h3>Key laws / validity conditions</h3>
            <ul>
              <li><strong>Kinematics of rotating frames:</strong> for any physical vector <span class="mini">F</span>, the lab and rotating-frame derivatives differ by <span class="mini">Ω × F</span>.</li>
              <li><strong>Bloch/torque (no relaxation):</strong> <span class="mini">dM/dt = γ M × B</span>, valid when magnetization undergoes coherent precession and relaxation (T<sub>1</sub>, T<sub>2</sub>) is neglected.</li>
              <li><strong>Assumes classical-vector dynamics:</strong> quantum effects are encoded through <span class="mini">γ</span> and effective fields, but the equation is an ODE for a 3D vector.</li>
            </ul>

            <div class="callouts">
              <div class="callout warn">
                <h4>What to watch for (pitfalls & sign conventions)</h4>
                <ul>
                  <li><strong>Sign of γ:</strong> affects precession direction. Many flip-time formulas use <span class="mini">|γ|</span> to report durations.</li>
                  <li><strong>Which frame rotates relative to which:</strong> “frame rotates with angular velocity Ω” means the basis vectors satisfy <span class="mini">d ê/dt = Ω × ê</span> in the lab.</li>
                  <li><strong>Cross product ordering:</strong> <span class="mini">M × B</span> not <span class="mini">B × M</span>.</li>
                  <li><strong>Units check:</strong> <span class="mini">Ω/γ</span> has Tesla units because <span class="mini">[Ω]=s⁻¹</span>, <span class="mini">[γ]=s⁻¹·T⁻¹</span>.</li>
                </ul>
              </div>
            </div>

            <h3>Common models/approximations used here</h3>
            <ul>
              <li><strong>No relaxation:</strong> omit phenomenological damping/relaxation terms (pure precession).</li>
              <li><strong>Uniform magnetization (“macrospin”):</strong> treat <span class="mini">M</span> as spatially uniform, so we solve an ODE (no <span class="mini">∇</span> operators needed).</li>
              <li><strong>Rotating-wave viewpoint:</strong> interpreting rotating-frame “dc” transverse fields as resonant RF fields in the lab.</li>
            </ul>

            <details>
              <summary>Mini intuition examples (conceptual)</summary>
              <ul>
                <li><strong>Spinning top analogy:</strong> if you rotate your camera at the same rate as the top’s spin, the top looks almost stationary.</li>
                <li><strong>Vector on a turntable:</strong> a vector fixed to the table has zero time-derivative in the table frame, but in the lab it changes as <span class="mini">Ω × F</span>.</li>
                <li><strong>NMR precession:</strong> in a strong <span class="mini">B<sub>0</sub> ẑ</span>, magnetization whirls rapidly around z; rotating at the Larmor frequency turns that into a slow motion driven by the small RF field.</li>
              </ul>
            </details>

            <a class="backtop" href="#top">Back to top ↑</a>
          </div>
        </article>

        <article id="part0b">
          <div class="sec-pad">
            <h2>PART 0B — Industry & Applied Physics Perspective</h2>

            <h3>Where this appears in industry (concrete areas)</h3>
            <ul>
              <li><strong>MRI & NMR instrumentation:</strong> RF pulse design, slice selection, and spin manipulation rely on rotating-frame analysis.</li>
              <li><strong>ESR/EPR spectroscopy:</strong> resonant driving and detection of electron spins is naturally expressed via effective rotating-frame fields.</li>
              <li><strong>Magnetic sensors & spintronics (macrospin control):</strong> ferromagnetic resonance (FMR), magnetic memory switching, and microwave magnetization dynamics often use rotating-frame simplifications.</li>
              <li><strong>Quantum technologies:</strong> qubit control pulses (Rabi oscillations) are essentially rotating-frame rotations, even when written in quantum language.</li>
            </ul>

            <h3>Why engineers care (performance, reliability, cost)</h3>
            <ul>
              <li><strong>Performance:</strong> predicting flip angles and resonance conditions prevents under/over-rotation, boosting signal and contrast (MRI) or spectral accuracy (NMR/ESR).</li>
              <li><strong>Energy & thermal constraints:</strong> RF power deposition (e.g., SAR in MRI) and coil heating depend on pulse amplitude and duration—directly tied to <span class="mini">t = θ/(|γ|B<sub>1</sub>)</span>.</li>
              <li><strong>Manufacturability & tolerances:</strong> coil non-idealities, field inhomogeneity, and frequency detuning map to rotating-frame effective fields and must be budgeted.</li>
            </ul>

            <h3>Typical measurement/validation methods</h3>
            <ul>
              <li><strong>Calibration of B<sub>1</sub>:</strong> measure Rabi oscillations / nutation curves to map pulse length to rotation angle.</li>
              <li><strong>Frequency response:</strong> sweep drive frequency to find resonance (Larmor/FMR), which corresponds to detuning in the rotating frame.</li>
              <li><strong>Field mapping:</strong> MRI shimming or probe-based mapping to quantify <span class="mini">B<sub>0</sub></span> nonuniformity; this becomes spatially varying detuning.</li>
            </ul>

            <div class="callout">
              <h4>From lab to product (ideal model → real system)</h4>
              <p class="mini">
                The ideal derivation assumes a single uniform magnetization vector and perfectly known fields.
                Real devices incorporate: relaxation (T<sub>1</sub>, T<sub>2</sub>), B<sub>0</sub>/B<sub>1</sub> inhomogeneity, finite bandwidth pulses, coil transfer functions,
                and safety constraints. Engineers still use the same rotating-frame backbone—then add corrections (detuning, damping, spatial distributions) for robust design.
              </p>
            </div>

            <a class="backtop" href="#top">Back to top ↑</a>
          </div>
        </article>

        <article id="part1">
          <div class="sec-pad">
            <h2>PART 1 — Problem Analysis (no solving yet)</h2>

            <h3>Problem restatement (in plain words)</h3>
            <p>
              A vector is written in a basis of unit vectors that rotate with angular velocity <span class="mini">Ω</span>.
              You must:
            </p>
            <ol>
              <li>(a) Prove the derivative transformation: <span class="mini">dF/dt = (dF/dt)<sub>R</sub> + Ω × F</span>, where <span class="mini">(dF/dt)<sub>R</sub></span> is the time derivative “as seen in” the rotating frame.</li>
              <li>(b) Use (a) to rewrite the magnetization equation (a precession equation) in the rotating frame, showing the effective field shift by <span class="mini">Ω/γ</span>.</li>
              <li>(c) Choose <span class="mini">Ω = −γ B<sub>0</sub> ẑ</span> so the static field disappears in the rotating frame; then apply a constant pulse <span class="mini">B<sub>1</sub> x̂</span> for time <span class="mini">t</span> and find <span class="mini">t</span> that flips <span class="mini">M</span> from <span class="mini">+ẑ</span> to <span class="mini">−ẑ</span> (no relaxation).</li>
              <li>(d) Interpret that pulse in the laboratory frame.</li>
            </ol>

            <h3>Given quantities</h3>
            <ul>
              <li>Rotating basis with angular velocity <span class="mini">Ω</span> such that <span class="mini">d x̂/dt = Ω × x̂</span>, etc.</li>
              <li>Magnetization initially along <span class="mini">ẑ</span>.</li>
              <li>Chosen rotation rate <span class="mini">Ω = −γ B<sub>0</sub> ẑ</span>.</li>
              <li>Applied (rotating-frame) pulse field <span class="mini">B<sub>1</sub> x̂</span> for time <span class="mini">t</span>.</li>
              <li>Neglect relaxation effects.</li>
            </ul>

            <h3>Unknowns / what must be shown</h3>
            <ul>
              <li>Derivative identity (a).</li>
              <li>Rotating-frame magnetization equation (b).</li>
              <li>Pulse length <span class="mini">t</span> for a complete inversion (c).</li>
              <li>Lab-frame description of the pulse (d).</li>
            </ul>

            <h3>Mathematical model (variables, domain, coordinate system, BC/IC)</h3>
            <div class="callout">
              <h4>Model</h4>
              <ul class="mini">
                <li><strong>State:</strong> magnetization vector <span class="mini">M(t) ∈ ℝ³</span>.</li>
                <li><strong>Time domain:</strong> <span class="mini">t ∈ [0, T]</span>, with pulse applied on <span class="mini">[0, t_p]</span>.</li>
                <li><strong>Coordinate systems:</strong>
                  <ul>
                    <li>Lab frame L: fixed orthonormal basis <span class="mini">{x̂, ŷ, ẑ}</span>.</li>
                    <li>Rotating frame R: orthonormal basis <span class="mini">{x̂_R(t), ŷ_R(t), ẑ_R(t)}</span> rotating with angular velocity <span class="mini">Ω</span> (here about z).</li>
                  </ul>
                </li>
                <li><strong>Dynamics (ODE):</strong> <span class="mini">dM/dt = γ M × B(t)</span> (lab), equivalently a linear ODE in components with a skew-symmetric generator.</li>
                <li><strong>Initial condition:</strong> <span class="mini">M(0) = M0 ẑ</span> (magnitude <span class="mini">M0</span>).</li>
                <li><strong>Boundary conditions:</strong> none (initial-value problem).</li>
              </ul>
            </div>

            <h3>Relevant principles (and why others don’t apply)</h3>
            <ul>
              <li><strong>Vector kinematics in rotating frames:</strong> needed because the basis is time-dependent.</li>
              <li><strong>Cross-product torque/precession law:</strong> gives magnetization time evolution without needing spatial PDEs.</li>
              <li><strong>No Maxwell PDE solving:</strong> fields are prescribed; we are not computing <span class="mini">∇×B</span>, etc.</li>
              <li><strong>No relaxation/damping:</strong> explicitly neglected, so we avoid dissipative terms.</li>
            </ul>

            <h3>Assumptions (explicit)</h3>
            <div class="callout warn">
              <h4>Assumptions</h4>
              <ul class="mini">
                <li>Rigid rotation of axes with constant (or instantaneous) angular velocity <span class="mini">Ω</span>.</li>
                <li>Uniform magnetization; no spatial gradients (macrospin).</li>
                <li>During part (c), effective field in rotating frame is exactly along <span class="mini">x̂_R</span> (perfect resonance; static field canceled).</li>
                <li>Relaxation neglected: magnitude <span class="mini">|M|</span> conserved.</li>
              </ul>
            </div>

            <h3>Possible approaches (compare 2–3)</h3>
            <ul>
              <li><strong>Approach A (component differentiation):</strong> write <span class="mini">F = Σ F_i ê_i(t)</span>, differentiate term-by-term, use <span class="mini">d ê_i/dt = Ω × ê_i</span>. <em>Pros:</em> direct, transparent. <em>Cons:</em> needs careful bookkeeping.</li>
              <li><strong>Approach B (rotation matrices):</strong> write <span class="mini">F_L = R(t) F_R</span>, differentiate using <span class="mini">Ṙ Rᵀ</span> as skew-symmetric matrix representing <span class="mini">Ω×</span>. <em>Pros:</em> very “mathematical-physics” and compact. <em>Cons:</em> slightly more abstract.</li>
              <li><strong>Approach C (geometric argument):</strong> vector fixed in rotating frame changes in lab as <span class="mini">Ω×F</span>; add intrinsic change. <em>Pros:</em> intuition-driven. <em>Cons:</em> may hide steps if not written carefully.</li>
            </ul>
            <p><strong>Chosen:</strong> we’ll do Approach A (explicit) plus a brief matrix note for insight, because the problem statement gives <span class="mini">d x̂/dt = Ω×x̂</span> directly.</p>

            <a class="backtop" href="#top">Back to top ↑</a>
          </div>
        </article>

        <article id="part2">
          <div class="sec-pad">
            <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

            <ol>
              <li><strong>Goal:</strong> derive <span class="mini">dF/dt</span> with a rotating basis. <strong>Tool:</strong> product rule on <span class="mini">F_i(t) ê_i(t)</span>. <strong>Meaning:</strong> separates intrinsic change of components from basis rotation.</li>
              <li><strong>Goal:</strong> identify what <span class="mini">(dF/dt)<sub>R</sub></span> means. <strong>Tool:</strong> define it as time derivative holding the rotating basis fixed (differentiate only components). <strong>Meaning:</strong> “what an observer in the rotating frame sees.”</li>
              <li><strong>Goal:</strong> rewrite magnetization ODE in rotating frame. <strong>Tool:</strong> apply the derivative identity to <span class="mini">F=M</span> and rearrange. <strong>Meaning:</strong> rotation becomes an effective field shift.</li>
              <li><strong>Goal:</strong> choose <span class="mini">Ω=-γB0 ẑ</span> to cancel the static field term. <strong>Tool:</strong> interpret <span class="mini">B + Ω/γ</span>. <strong>Meaning:</strong> in R, only the control field remains.</li>
              <li><strong>Goal:</strong> compute pulse time for inversion. <strong>Tool:</strong> rotation about a fixed axis at angular speed <span class="mini">ω1=|γ|B1</span>. <strong>Meaning:</strong> pulse area sets flip angle.</li>
              <li><strong>Goal:</strong> map rotating-frame “dc” pulse to lab-frame RF field. <strong>Tool:</strong> express <span class="mini">x̂_R(t)</span> in lab basis. <strong>Meaning:</strong> pulse is a transverse field rotating at <span class="mini">Ω</span>.</li>
            </ol>

            <div class="callout bad">
              <h4>Common mistakes</h4>
              <ul class="mini">
                <li>Forgetting the product rule: you must differentiate both <span class="mini">F_i(t)</span> and <span class="mini">ê_i(t)</span>.</li>
                <li>Mixing up <span class="mini">(d/dt)<sub>L</sub></span> and <span class="mini">(d/dt)<sub>R</sub></span>.</li>
                <li>Using <span class="mini">Ω/γ</span> with wrong units (it must be Tesla).</li>
                <li>Using <span class="mini">t=π/(γB1)</span> without addressing sign; report durations using <span class="mini">|γ|</span>.</li>
                <li>Describing the lab pulse as “dc”: it is only dc in the rotating frame; in the lab it rotates in the transverse plane.</li>
              </ul>
            </div>

            <a class="backtop" href="#top">Back to top ↑</a>
          </div>
        </article>

        <article id="part3">
          <div class="sec-pad">
            <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

            <h3>Physical intuition before calculating</h3>
            <p>
              If the axes rotate, a vector can change “because it truly changes” and also “because your ruler is turning.”
              The extra term <span class="mini">Ω×F</span> captures the latter. For magnetization, the rotating-frame trick is a way to subtract out the fast Larmor precession,
              leaving only the dynamics due to the control field (the pulse).
            </p>

            <div class="callout">
              <h4>Key equation to be proven (a)</h4>
              <p class="mini"><strong>Claim:</strong> dF/dt = (dF/dt)<sub>R</sub> + Ω × F.</p>
            </div>

            <h3>(a) Derivative rule in a rotating basis</h3>
            <p>
              Write the vector in the rotating basis (as stated in the problem):
            </p>

            <div class="eqbox">
              <pre>F(t) = Fx(t) x̂(t) + Fy(t) ŷ(t) + Fz(t) ẑ(t).</pre>
            </div>

            <p>
              Differentiate in the <strong>lab frame</strong> (i.e., ordinary time derivative of the physical vector):
              use the product rule term-by-term.
            </p>

            <div class="eqbox">
              <pre>dF/dt
= (dFx/dt) x̂ + Fx (d x̂/dt)
+ (dFy/dt) ŷ + Fy (d ŷ/dt)
+ (dFz/dt) ẑ + Fz (d ẑ/dt).</pre>
            </div>

            <p>
              The problem gives the kinematic rule for the rotating unit vectors:
            </p>

            <div class="eqbox">
              <pre>d x̂/dt = Ω × x̂,
d ŷ/dt = Ω × ŷ,
d ẑ/dt = Ω × ẑ.</pre>
            </div>

            <p>
              Substitute these into the product rule expansion. Group the “component-derivative” terms and the “basis-rotation” terms:
            </p>

            <div class="eqbox">
              <pre>dF/dt
= [(dFx/dt) x̂ + (dFy/dt) ŷ + (dFz/dt) ẑ]
  + Ω × [Fx x̂ + Fy ŷ + Fz ẑ].</pre>
            </div>

            <p>
              Recognize that <span class="mini">Fx x̂ + Fy ŷ + Fz ẑ = F</span>. Now define the rotating-frame derivative as the derivative of the components with the rotating basis treated as fixed:
            </p>

            <div class="eqbox">
              <pre>(dF/dt)R ≡ (dFx/dt) x̂ + (dFy/dt) ŷ + (dFz/dt) ẑ.</pre>
            </div>

            <p>
              Therefore:
            </p>

            <div class="eqbox">
              <pre>dF/dt = (dF/dt)R + Ω × F.</pre>
            </div>

            <details>
              <summary>Optional deeper note: matrix/operator form (compact)</summary>
              <p class="mini">
                Let R(t) map rotating components to lab components: F_L = R F_R.
                Then dF_L/dt = Ṙ F_R + R dF_R/dt.
                Using RᵀṘ as a skew-symmetric generator equivalent to (Ω×), we get the same identity.
              </p>
            </details>

            <h3>(b) Magnetization equation in the rotating frame</h3>
            <p>
              Start from the (no-relaxation) precession equation in the lab:
            </p>

            <div class="eqbox">
              <pre>dM/dt = γ M × Ba(t).</pre>
            </div>

            <p>
              Apply (a) with F = M:
            </p>

            <div class="eqbox">
              <pre>dM/dt = (dM/dt)R + Ω × M.</pre>
            </div>

            <p>
              Substitute and solve for (dM/dt)R:
            </p>

            <div class="eqbox">
              <pre>(dM/dt)R + Ω × M = γ M × Ba
⇒ (dM/dt)R = γ M × Ba − Ω × M.</pre>
            </div>

            <p>
              Use Ω × M = − M × Ω to combine cross products:
            </p>

            <div class="eqbox">
              <pre>(dM/dt)R
= γ M × Ba + M × Ω
= γ M × (Ba + Ω/γ).</pre>
            </div>

            <div class="callout good">
              <h4>Sanity check</h4>
              <ul class="mini">
                <li>Units: Ω/γ has Tesla units, so it legitimately adds to B.</li>
                <li>Meaning: in a rotating frame, rotation contributes an effective field shift.</li>
              </ul>
            </div>

            <div class="callout">
              <h4>Math Insight</h4>
              <p class="mini">
                The operator v ↦ a×v is linear and represented by a skew-symmetric matrix. Therefore the ODE generates a rotation on the sphere |M|=const.
              </p>
            </div>

            <h3>(c) Pulse length for inversion (π-pulse)</h3>
            <p>
              Choose the rotation rate:
            </p>

            <div class="eqbox">
              <pre>Ω = −γ B0 ẑ.</pre>
            </div>

            <p>
              If Ba includes a static term B0 ẑ, then in the rotating frame:
            </p>

            <div class="eqbox">
              <pre>Beff = Ba + Ω/γ.
Along z:  B0 ẑ + Ω/γ = B0 ẑ − B0 ẑ = 0.</pre>
            </div>

            <p>
              Now apply a constant pulse in the rotating frame: B_pulse = B1 x̂ for time t. During the pulse:
            </p>

            <div class="eqbox">
              <pre>(dM/dt)R = γ M × (B1 x̂).</pre>
            </div>

            <p>
              This is precession about the x-axis with angular speed ω1 = |γ| B1. The rotation angle is |θ| = |γ| B1 t.
              To flip M from +ẑ to −ẑ, we need a rotation by π about x:
            </p>

            <div class="eqbox">
              <pre>|γ| B1 t = π  ⇒  t = π/(|γ| B1).</pre>
            </div>

            <div class="callout final">
              <h4>Final answer</h4>
              <div class="eqbox" style="margin:10px 0 0;">
                <pre>tπ = π/(|γ| B1)</pre>
              </div>
              <p class="mini muted">
                (Shortest positive pulse length for M: +ẑ → −ẑ, neglecting relaxation.)
              </p>
            </div>

            <h3>(d) Pulse as viewed in the laboratory frame</h3>
            <p>
              The rotating-frame pulse is constant: B_pulse,R = B1 x̂R. But x̂R rotates in the lab.
              For rotation about z with angular speed Ω:
            </p>

            <div class="eqbox">
              <pre>x̂R(t) = cos(Ωt) x̂L + sin(Ωt) ŷL,
ŷR(t) = −sin(Ωt) x̂L + cos(Ωt) ŷL,
ẑR = ẑL.</pre>
            </div>

            <p>
              Therefore, the lab-frame pulse field is:
            </p>

            <div class="eqbox">
              <pre>Bpulse,L(t) = B1 x̂R(t)
= B1[cos(Ωt) x̂L + sin(Ωt) ŷL],
for 0 ≤ t ≤ tπ.</pre>
            </div>

            <p>
              With Ω = −γ B0 ẑ, this is a transverse RF field rotating at the Larmor angular frequency (up to sign):
              an on-resonance circularly polarized drive producing a clean π flip.
            </p>

            <a class="backtop" href="#top">Back to top ↑</a>
          </div>
        </article>

        <article id="part4" class="pagebreak">
          <div class="sec-pad">
            <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

            <h3>Re-interpreting the final formulas</h3>
            <ul>
              <li><strong>Effective field:</strong> Beff = B + Ω/γ means “choose Ω to subtract a known precession.” Setting Ω = −γB0 ẑ cancels B0 ẑ.</li>
              <li><strong>Pulse area:</strong> θ = |γ|∫B1(t)dt. Square pulse → θ = |γ|B1 t, so π pulse → tπ = π/(|γ|B1).</li>
            </ul>

            <h3>Parameter dependence</h3>
            <ul>
              <li>Increase B1 → increase ω1 → shorter tπ.</li>
              <li>Increase |γ| → faster response → shorter tπ.</li>
              <li>Detuning (Ω ≠ −γB0) introduces residual z-field in Beff, tilting the rotation axis and causing imperfect inversion.</li>
            </ul>

            <h3>Alternative derivation idea</h3>
            <p>
              Use rotation matrices: F_L = R(t)F_R. Differentiation gives dF_L/dt = R dF_R/dt + Ṙ F_R.
              The generator Ṙ Rᵀ is skew-symmetric and corresponds to Ω×, yielding the same identity.
            </p>

            <div class="callout">
              <h4>Concept check (answers included)</h4>
              <ul class="mini">
                <li><strong>Q:</strong> Why does Ω/γ act like a magnetic field?<br><strong>A:</strong> It has Tesla units and enters inside γ M×(·) exactly like B.</li>
                <li><strong>Q:</strong> Does |M| change here?<br><strong>A:</strong> No: M·(M×B)=0 ⇒ d|M|²/dt = 0.</li>
                <li><strong>Q:</strong> What is the lab nature of a “dc” rotating-frame pulse?<br><strong>A:</strong> A transverse field rotating at Ω (RF at resonance).</li>
              </ul>
            </div>

            <a class="backtop" href="#top">Back to top ↑</a>
          </div>
        </article>

        <article id="part5">
          <div class="sec-pad">
            <h2>PART 5 — Optional Plot Guide</h2>
            <p class="mini">
              No plot is necessary: the results are exact geometric rotations and a closed-form pulse duration tπ = π/(|γ|B1). A numeric plot would require arbitrary parameter choices and adds little.
            </p>
            <a class="backtop" href="#top">Back to top ↑</a>
          </div>
        </article>

        <footer>
          <div>
            <strong>Note:</strong> Relaxation is neglected. Real systems add T1/T2 (or damping) and inhomogeneities, but the rotating-frame transformation remains the backbone for analysis and engineering pulse design.
          </div>
        </footer>
      </main>
    </div>
  </div>
</body>
</html>