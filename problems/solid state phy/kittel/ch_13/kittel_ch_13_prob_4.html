<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FMR in a Uniaxial Anisotropy Field: Why ω0 = γ(B0 + Ba) with Ba = 2K/Ms</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#101a33;
      --panel2:#0f1730;
      --text:#eaf0ff;
      --muted:#b8c3e6;
      --faint:#7f8ab3;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 10% 10%, rgba(125,211,252,.18), transparent 55%),
                  radial-gradient(900px 600px at 90% 25%, rgba(167,139,250,.18), transparent 55%),
                  radial-gradient(800px 700px at 60% 90%, rgba(52,211,153,.12), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }

    header{
      padding: 28px 18px 18px;
      position:relative;
      overflow:hidden;
    }
    .wrap{
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 14px 40px;
    }

    .hero{
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap: 16px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .hero{grid-template-columns:1fr}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 18px 16px;
      backdrop-filter: blur(6px);
    }

    h1{
      margin:0 0 10px;
      font-size: clamp(1.6rem, 3.3vw, 2.3rem);
      letter-spacing:.2px;
      line-height:1.15;
    }
    .subtitle{
      margin: 8px 0 0;
      color: var(--muted);
      font-size: 1rem;
      max-width: 70ch;
    }
    .meta{
      margin-top: 12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      color: var(--faint);
      font-size:.92rem;
    }
    .pill{
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
    }

    .layout{
      display:grid;
      grid-template-columns: 280px 1fr;
      gap: 16px;
      margin-top: 14px;
      align-items:start;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns:1fr}
    }

    nav.toc{
      position: sticky;
      top: 12px;
      align-self:start;
      max-height: calc(100vh - 24px);
      overflow:auto;
      padding: 14px;
    }
    nav.toc h2{
      margin: 0 0 10px;
      font-size: 1rem;
      color: var(--muted);
      letter-spacing:.3px;
    }
    nav.toc a{
      display:block;
      padding: 7px 10px;
      border-radius: 12px;
      color: var(--text);
      text-decoration:none;
      border: 1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size: .95rem;
    }
    nav.toc a:hover{
      background: rgba(125,211,252,.08);
      border-color: rgba(125,211,252,.25);
      transform: translateY(-1px);
    }
    nav.toc .small{
      font-size:.88rem;
      color: var(--faint);
      margin-top: 8px;
    }

    main article{
      padding: 0;
    }

    section{
      margin-top: 16px;
      padding: 18px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: rgba(16,26,51,.62);
      box-shadow: 0 8px 22px rgba(0,0,0,.22);
    }

    section h2{
      margin: 0 0 10px;
      font-size: 1.25rem;
      letter-spacing:.2px;
    }
    section h3{
      margin: 14px 0 8px;
      font-size: 1.06rem;
      color: var(--muted);
    }

    ul{margin: 8px 0 0 20px}
    li{margin: 6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 820px){
      .grid2{grid-template-columns:1fr}
    }

    .callout{
      border-radius: 16px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      padding: 12px 12px 10px;
      margin-top: 10px;
    }
    .callout strong{color: var(--text)}
    .callout.assumptions{border-color: rgba(251,191,36,.35); background: rgba(251,191,36,.08)}
    .callout.keyeq{border-color: rgba(125,211,252,.35); background: rgba(125,211,252,.08)}
    .callout.mistakes{border-color: rgba(251,113,133,.35); background: rgba(251,113,133,.07)}
    .callout.final{border-color: rgba(52,211,153,.38); background: rgba(52,211,153,.08)}
    .callout.math{border-color: rgba(167,139,250,.38); background: rgba(167,139,250,.08)}

    .eq{
      font-family: var(--mono);
      font-size: .95rem;
      white-space: pre-wrap;
      word-break: break-word;
      line-height:1.45;
      padding: 10px 10px;
      border-radius: 14px;
      border: 1px dashed rgba(255,255,255,.18);
      background: rgba(0,0,0,.18);
      margin: 10px 0 6px;
    }

    .eqrow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .btn{
      appearance:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      cursor:pointer;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size: .92rem;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.10);
      border-color: rgba(125,211,252,.25);
    }
    .btn:active{transform: translateY(0px)}
    .btn.small{padding:6px 10px; font-size:.88rem}
    .btn.good{border-color: rgba(52,211,153,.35)}
    .btn.warn{border-color: rgba(251,191,36,.35)}
    .btn.bad{border-color: rgba(251,113,133,.35)}

    details{
      margin-top: 10px;
      border: 1px solid var(--border);
      border-radius: 16px;
      background: rgba(0,0,0,.14);
      overflow:hidden;
    }
    summary{
      cursor:pointer;
      padding: 12px 12px;
      color: var(--muted);
      font-weight: 600;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    details[open] summary{border-bottom:1px solid var(--border)}
    details .content{padding: 12px 12px 10px}

    .toplink{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top: 10px;
      color: var(--accent);
      text-decoration:none;
      font-weight:600;
    }
    .toplink:hover{text-decoration:underline}

    footer{
      padding: 16px 18px 34px;
      color: var(--faint);
      font-size: .92rem;
    }

    /* print-friendly */
    @media print{
      body{background:#fff; color:#000}
      nav.toc{display:none}
      .card, section{box-shadow:none; background:#fff; border:1px solid #ddd}
      .btn{display:none}
      a{color:#000}
      .eq{background:#fff; border:1px solid #aaa}
      header{padding: 10px 0}
      section{break-inside: avoid; page-break-inside: avoid}
      h2, h3{page-break-after: avoid}
    }
  </style>
</head>

<body>
<header id="top">
  <div class="wrap">
    <div class="hero">
      <div class="card">
        <h1>Ferromagnetic Resonance (FMR) in a Uniaxial Anisotropy Field</h1>
        <p class="subtitle">
          A step-by-step derivation (with mathematical-physics rigor) showing why a uniaxial anisotropy
          shifts the FMR frequency as if it adds an effective field: <span style="color:var(--accent);font-weight:700">ω<sub>0</sub> = γ(B<sub>0</sub> + B<sub>a</sub>)</span>,
          with <span style="color:var(--accent);font-weight:700">B<sub>a</sub> = 2K/M<sub>s</sub></span>.
        </p>
        <div class="meta">
          <span class="pill">Geometry: sphere (uniform mode)</span>
          <span class="pill">Anisotropy: uniaxial, K&gt;0 (easy axis)</span>
          <span class="pill">Field: B<sub>0</sub> along z</span>
          <span class="pill">Model: Landau–Lifshitz (no damping)</span>
        </div>
      </div>

      <div class="card">
        <h2 style="margin:0 0 10px;font-size:1.15rem;color:var(--muted)">Quick Summary</h2>
        <ul>
          <li><strong>Problem:</strong> Find the FMR frequency of a spherical uniaxial ferromagnet in an external field B<sub>0</sub>ẑ.</li>
          <li><strong>Key idea:</strong> Anisotropy energy produces an <em>effective field</em> that adds to the applied field in the uniform precession mode.</li>
          <li><strong>Governing dynamics:</strong> d<strong>M</strong>/dt = −γ <strong>M</strong> × <strong>B</strong><sub>eff</sub> (linearized about equilibrium).</li>
          <li><strong>Anisotropy energy density:</strong> u<sub>K</sub> = K sin²θ = K(1 − (M<sub>z</sub>/M<sub>s</sub>)²).</li>
          <li><strong>Effective anisotropy field:</strong> <strong>B</strong><sub>a</sub> = (2K/M<sub>s</sub>²) M<sub>z</sub> ẑ ≈ (2K/M<sub>s</sub>)ẑ near equilibrium.</li>
          <li><strong>Result type:</strong> symbolic; shows anisotropy causes a rigid frequency shift (a “field offset”).</li>
          <li><strong>Final result:</strong> ω<sub>0</sub> = γ(B<sub>0</sub> + B<sub>a</sub>), with B<sub>a</sub> = 2K/M<sub>s</sub>.</li>
        </ul>
      </div>
    </div>

    <div class="layout">
      <nav class="toc card" aria-label="Table of contents">
        <h2>Table of Contents</h2>
        <a href="#part0">PART 0 — Concept Primer</a>
        <a href="#part0b">PART 0B — Industry &amp; Applied Physics</a>
        <a href="#part1">PART 1 — Problem Analysis</a>
        <a href="#part2">PART 2 — Strategy &amp; Tips</a>
        <a href="#part3">PART 3 — Full Solution</a>
        <a href="#part4">PART 4 — Deeper Understanding</a>
        <a href="#part5">PART 5 — Optional Plot Guide</a>
        <div class="small">Tip: Use the copy buttons to save key equations and the final answer.</div>
      </nav>

      <main>
        <article aria-label="FMR anisotropy field article">

          <section id="part0">
            <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

            <h3>0.1 Core definitions (symbols + SI units)</h3>
            <ul>
              <li><strong>M</strong> (A/m): magnetization vector of the ferromagnet.</li>
              <li>M<sub>s</sub> (A/m): saturation magnetization (assumed constant in magnitude in the uniform mode).</li>
              <li><strong>m</strong> = <strong>M</strong>/M<sub>s</sub> (dimensionless): unit magnetization direction (|<strong>m</strong>| = 1).</li>
              <li>θ (rad): angle between <strong>M</strong> and the crystal easy axis (here the z-axis).</li>
              <li>K (J/m³): uniaxial anisotropy energy density constant (given K &gt; 0).</li>
              <li><strong>B</strong> (T): magnetic flux density; <strong>B</strong><sub>0</sub> = B<sub>0</sub>ẑ is the applied field.</li>
              <li>γ (rad·s<sup>−1</sup>·T<sup>−1</sup>): gyromagnetic ratio (magnitude; sign absorbed in precession direction).</li>
              <li>u (J/m³): magnetic energy density.</li>
            </ul>

            <h3>0.2 Physical meaning: what the quantities represent</h3>
            <ul>
              <li><strong>FMR</strong> is the small-angle precession of <strong>M</strong> about an effective field <strong>B</strong><sub>eff</sub>.</li>
              <li><strong>Anisotropy energy</strong> “prefers” certain magnetization directions. For K&gt;0 in u<sub>K</sub>=K sin²θ, the minimum is at θ=0 (easy axis along z), so magnetization wants to align with ±z.</li>
              <li><strong>Effective field</strong> is the field that, if inserted into the torque equation, reproduces the same torque as the energy landscape.</li>
            </ul>

            <h3>0.3 Key law/principle and validity conditions</h3>
            <div class="callout keyeq">
              <strong>Landau–Lifshitz (no damping) uniform-mode dynamics</strong>
              <div class="eq" id="eq-ll">
dM/dt = -γ ( M × B_eff )
              </div>
              <div class="eqrow">
                <button class="btn small" data-copy-target="eq-ll">Copy equation</button>
              </div>
              <p style="margin:8px 0 0;color:var(--muted)">
                Valid when the magnetization behaves like a (nearly) rigid vector of constant magnitude and we consider small deviations about equilibrium (linear response).
              </p>
            </div>

            <div class="callout assumptions">
              <strong>Common assumptions in textbook FMR (used here)</strong>
              <ul>
                <li><strong>Macrospin / uniform mode:</strong> <strong>M</strong>(r,t) ≈ uniform in space (no spin-wave spatial variation).</li>
                <li><strong>Constant magnitude:</strong> |<strong>M</strong>| = M<sub>s</sub>, so only direction changes.</li>
                <li><strong>Small-angle precession:</strong> transverse components M<sub>x</sub>, M<sub>y</sub> are small compared to M<sub>s</sub>.</li>
                <li><strong>Spherical specimen:</strong> simplifies demagnetizing effects for the uniform mode (isotropic shape).</li>
              </ul>
            </div>

            <h3>0.4 Typical models/approximations and why they’re used</h3>
            <ul>
              <li><strong>Energy-to-field mapping:</strong> define <strong>B</strong><sub>eff</sub> via a functional derivative of energy density with respect to magnetization (torque comes from energy gradients).</li>
              <li><strong>Linearization:</strong> keep only first-order terms in (M<sub>x</sub>, M<sub>y</sub>) to obtain a solvable eigenfrequency.</li>
              <li><strong>Shape choice (sphere):</strong> avoids anisotropic demagnetizing “Kittel formula” complications; the resonance becomes a simple precession frequency about an effective z-field.</li>
            </ul>

            <h3>0.5 Mini intuition examples (minimal algebra)</h3>
            <ul>
              <li><strong>Pure Zeeman:</strong> if only B<sub>0</sub>ẑ exists, <strong>M</strong> precesses at ω=γB<sub>0</sub>.</li>
              <li><strong>Add a restoring “spring” to z:</strong> uniaxial anisotropy behaves like an additional field pushing <strong>M</strong> toward z; precession is faster, like ω=γ(B<sub>0</sub>+something).</li>
              <li><strong>Stronger K:</strong> steeper energy vs θ, so stronger restoring torque, so higher resonance frequency.</li>
            </ul>

            <h3>0.6 What to watch for (pitfalls)</h3>
            <ul>
              <li>Mixing <strong>B</strong> and <strong>H</strong>: in SI, B=μ<sub>0</sub>(H+M). Many FMR texts quote results in terms of H; here the problem statement uses B.</li>
              <li>Sign conventions for γ: the direction of precession depends on sign; the <em>frequency magnitude</em> is what we report.</li>
              <li>For anisotropy field, remember it comes from <em>derivative of energy density</em> with respect to magnetization (not with respect to θ directly unless you convert carefully).</li>
              <li>Linearization: keep only first-order transverse terms and treat M<sub>z</sub>≈M<sub>s</sub> in prefactors when consistent.</li>
            </ul>

            <div class="callout math">
              <strong>Math Insight (core equation as a mathematical object)</strong>
              <p style="margin:8px 0 0">
                After linearization, the Landau–Lifshitz equation becomes a <strong>linear ODE eigenvalue problem</strong> for the transverse components (M<sub>x</sub>, M<sub>y</sub>):
                a 2×2 constant-coefficient system whose eigenvalues are ±iω. This is mathematically analogous to a <strong>harmonic oscillator</strong> (conservative, purely imaginary eigenvalues) generated by an antisymmetric “rotation” operator (cross product with ẑ).
              </p>
            </div>

            <a class="toplink" href="#top">Back to top ↑</a>
          </section>

          <section id="part0b">
            <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>

            <h3>Where this appears in industry (concrete areas)</h3>
            <ul>
              <li><strong>Spintronics &amp; MRAM:</strong> uniaxial anisotropy sets switching stability and write currents; FMR characterizes anisotropy and damping.</li>
              <li><strong>Microwave/RF magnetic components:</strong> ferrite isolators, circulators, tunable filters—FMR determines operating bands and losses.</li>
              <li><strong>Magnetic sensors and metrology:</strong> anisotropy fields are extracted from FMR to calibrate thin-film properties for Hall sensors, GMR/TMR stacks, and compass modules.</li>
              <li><strong>Non-destructive evaluation:</strong> FMR shifts reveal stress/texture changes in magnetic materials (process monitoring, heat treatment verification).</li>
            </ul>

            <h3>Why engineers care (performance, reliability, cost)</h3>
            <ul>
              <li><strong>Performance:</strong> resonance frequency sets usable GHz bandwidth; anisotropy field is a “design knob.”</li>
              <li><strong>Reliability:</strong> anisotropy and M<sub>s</sub> drift with temperature/aging; FMR provides a sensitive diagnostic.</li>
              <li><strong>Manufacturability:</strong> K depends on crystallographic texture, stress, and interfaces—process variations directly shift FMR and device specs.</li>
              <li><strong>Cost/efficiency:</strong> correct anisotropy reduces required bias fields and power in RF systems.</li>
            </ul>

            <h3>Typical measurement/validation methods</h3>
            <ul>
              <li><strong>Vector Network Analyzer FMR (VNA-FMR):</strong> measure absorption vs frequency or field; fit to extract K, M<sub>s</sub>, damping.</li>
              <li><strong>Cavity FMR:</strong> high sensitivity, precise linewidth measurement (materials characterization).</li>
              <li><strong>Broadband stripline / coplanar waveguide:</strong> common for wafers and thin films; integrates well with production-line metrology.</li>
            </ul>

            <h3>Design trade-offs and constraints</h3>
            <ul>
              <li><strong>Non-idealities:</strong> real samples have inhomogeneous K, surface roughness, multi-domain behavior, and finite damping → linewidth broadening.</li>
              <li><strong>Geometry matters:</strong> spheres are ideal; real devices are thin films or patterned shapes with anisotropic demagnetizing fields, changing the resonance condition.</li>
              <li><strong>Temperature:</strong> M<sub>s</sub>(T) and K(T) shift ω<sub>0</sub>; engineers must budget margins in GHz designs.</li>
            </ul>

            <div class="callout">
              <strong>From lab to product</strong>
              <p style="margin:8px 0 0;color:var(--muted)">
                The “sphere + uniform macrospin” model is the clean calibration limit. In products, one replaces the simple ω=γ(B<sub>0</sub>+B<sub>a</sub>) by a Kittel-type formula including
                demagnetizing factors, exchange (for non-uniform modes), and damping. Still, the key industrial takeaway survives:
                <em>anisotropy behaves like an effective field shift</em> that moves resonance and switching thresholds.
              </p>
            </div>

            <a class="toplink" href="#top">Back to top ↑</a>
          </section>

          <section id="part1">
            <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

            <h3>1.1 Restate the problem in clear words</h3>
            <p style="margin:6px 0 0">
              We have a <strong>spherical</strong> specimen made of a <strong>uniaxial ferromagnetic crystal</strong>. The anisotropy energy density is
              u<sub>K</sub> = K sin²θ, where θ is the angle between magnetization <strong>M</strong> and the z-axis (easy axis), and K&gt;0.
              An external magnetic field <strong>B</strong><sub>0</sub> = B<sub>0</sub>ẑ is applied. Show that the <strong>FMR angular frequency</strong> is
              ω<sub>0</sub> = γ(B<sub>0</sub> + B<sub>a</sub>) with B<sub>a</sub> = 2K/M<sub>s</sub>.
            </p>

            <h3>1.2 Given quantities</h3>
            <ul>
              <li>Specimen shape: sphere</li>
              <li>Uniaxial anisotropy energy density: u<sub>K</sub>(θ) = K sin²θ, with K&gt;0</li>
              <li>External field: <strong>B</strong><sub>0</sub> = B<sub>0</sub>ẑ</li>
              <li>Saturation magnetization magnitude: M<sub>s</sub> (assumed constant)</li>
              <li>Gyromagnetic ratio: γ</li>
            </ul>

            <h3>1.3 Unknowns</h3>
            <ul>
              <li>Resonance angular frequency ω<sub>0</sub></li>
              <li>Effective anisotropy field magnitude B<sub>a</sub></li>
            </ul>

            <h3>1.4 What must be proved</h3>
            <div class="callout final">
              <strong>Target statement</strong>
              <div class="eq" id="eq-target">
ω0 = γ (B0 + Ba),   where   Ba = 2K / Ms
              </div>
              <div class="eqrow">
                <button class="btn small good" data-copy-target="eq-target">Copy final statement</button>
              </div>
            </div>

            <h3>1.5 Relevant principles and why they apply</h3>
            <ul>
              <li><strong>Energy-based effective field:</strong> anisotropy creates a torque because u<sub>K</sub> depends on magnetization direction; the torque is captured via an effective field obtained from energy derivatives.</li>
              <li><strong>Landau–Lifshitz precession:</strong> the uniform mode dynamics of a single-domain-like magnetization is precession around <strong>B</strong><sub>eff</sub>.</li>
              <li><strong>Spherical geometry:</strong> removes directional demagnetizing complications (for uniform mode), enabling a simple “effective z-field” picture.</li>
            </ul>

            <h3>1.6 Explicit assumptions</h3>
            <div class="callout assumptions">
              <ul>
                <li>Uniform magnetization mode (macrospin), no spatial dependence: ∇<strong>M</strong>=0, so exchange terms (∝∇²<strong>M</strong>) are absent.</li>
                <li>Small-angle precession about equilibrium along +z (since K&gt;0 and B<sub>0</sub> is along +z).</li>
                <li>Damping neglected for resonance frequency (it mainly affects linewidth, small shift for weak damping).</li>
                <li>Magnitude fixed: |<strong>M</strong>|=M<sub>s</sub>, so dynamics lives on the sphere |<strong>m</strong>|=1.</li>
              </ul>
            </div>

            <h3>1.7 Possible approaches (compare 2–3)</h3>
            <div class="grid2">
              <div class="callout">
                <strong>Approach A: Linearize Landau–Lifshitz with energy-derived B<sub>eff</sub></strong>
                <ul>
                  <li><em>Pros:</em> direct, transparent, matches problem statement, minimal extra machinery.</li>
                  <li><em>Cons:</em> must be careful with SI definitions (B vs H) and linearization consistency.</li>
                </ul>
              </div>
              <div class="callout">
                <strong>Approach B: Small-oscillation / variational method</strong>
                <ul>
                  <li><em>Pros:</em> highlights “energy curvature → frequency” structure (mathematical physics view).</li>
                  <li><em>Cons:</em> longer; still needs mapping to gyromagnetic dynamics (non-canonical coordinates).</li>
                </ul>
              </div>
              <div class="callout">
                <strong>Approach C: Kittel formula (general ellipsoid) specialized to sphere</strong>
                <ul>
                  <li><em>Pros:</em> quick if memorized; connects to broader engineering cases.</li>
                  <li><em>Cons:</em> can look like a “magic formula” unless derived; problem asks to show it.</li>
                </ul>
              </div>
            </div>

            <p style="margin:10px 0 0;color:var(--muted)">
              <strong>Chosen approach:</strong> Approach A (linearize Landau–Lifshitz using an effective field from the anisotropy energy),
              because it is the shortest rigorous derivation that explicitly yields B<sub>a</sub>=2K/M<sub>s</sub>.
            </p>

            <a class="toplink" href="#top">Back to top ↑</a>
          </section>

          <section id="part2">
            <h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

            <ol style="margin:8px 0 0 20px">
              <li><strong>Set coordinates:</strong> take easy axis and applied field along z; write <strong>M</strong>=(M<sub>x</sub>,M<sub>y</sub>,M<sub>z</sub>).</li>
              <li><strong>Write energy density:</strong> u = u<sub>Z</sub> + u<sub>K</sub>, with u<sub>K</sub>=K(1-(M<sub>z</sub>/M<sub>s</sub>)²).</li>
              <li><strong>Define effective field:</strong> <strong>B</strong><sub>eff</sub> = −∂u/∂<strong>M</strong> (for the parts written in B-units) → compute anisotropy contribution explicitly.</li>
              <li><strong>Find equilibrium:</strong> show <strong>M</strong> aligns with +z (minimum energy) for B<sub>0</sub>&gt;0 and K&gt;0.</li>
              <li><strong>Linearize:</strong> assume M<sub>x</sub>, M<sub>y</sub> small, M<sub>z</sub>≈M<sub>s</sub>; keep only first-order terms.</li>
              <li><strong>Write linear ODE system:</strong> obtain dM<sub>x</sub>/dt and dM<sub>y</sub>/dt from d<strong>M</strong>/dt = −γ <strong>M</strong>×<strong>B</strong><sub>eff</sub>.</li>
              <li><strong>Solve eigenfrequency:</strong> combine into second-order equation or use complex variable M<sub>+</sub>=M<sub>x</sub>+iM<sub>y</sub>.</li>
              <li><strong>Identify B<sub>a</sub>:</strong> read off ω=γ(B<sub>0</sub>+B<sub>a</sub>) and match B<sub>a</sub>=2K/M<sub>s</sub>.</li>
              <li><strong>Sanity checks:</strong> units, limiting cases K→0, physical interpretation.</li>
            </ol>

            <div class="callout mistakes">
              <strong>Common mistakes</strong>
              <ul>
                <li>Using u<sub>K</sub>=K sin²θ but forgetting sin²θ = 1 − cos²θ and cosθ = M<sub>z</sub>/M<sub>s</sub>.</li>
                <li>Taking the derivative with respect to θ instead of <strong>M</strong> without converting variables carefully.</li>
                <li>Keeping higher-order terms (like M<sub>x</sub>M<sub>y</sub>) during linearization (should be dropped).</li>
                <li>Confusing B<sub>a</sub> with μ<sub>0</sub>H<sub>a</sub>; the problem’s final expression is in B-units.</li>
              </ul>
            </div>

            <a class="toplink" href="#top">Back to top ↑</a>
          </section>

          <section id="part3">
            <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

            <h3>3.1 Qualitative expectation (before calculating)</h3>
            <p style="margin:6px 0 0">
              With K&gt;0, u<sub>K</sub>=K sin²θ penalizes tilting away from the z-axis. So, when the magnetization precesses slightly about z,
              anisotropy provides an extra restoring torque, making precession faster than the pure Zeeman case. We therefore expect
              ω to look like γ times an “effective z-field” equal to B<sub>0</sub> plus an anisotropy contribution.
            </p>

            <h3>3.2 Mathematical model (variables, domain, equations, conditions)</h3>
            <div class="callout math">
              <strong>Model statement (mathematical physics)</strong>
              <ul>
                <li><strong>Unknown:</strong> <strong>M</strong>(t) ∈ ℝ³ with constraint |<strong>M</strong>(t)|=M<sub>s</sub>.</li>
                <li><strong>Domain:</strong> spherical sample; uniform mode implies no spatial dependence: <strong>M</strong>(r,t)=<strong>M</strong>(t).</li>
                <li><strong>Coordinate system:</strong> z-axis is the uniaxial crystal axis and applied field direction.</li>
                <li><strong>Dynamics (ODE):</strong> d<strong>M</strong>/dt = −γ <strong>M</strong>×<strong>B</strong><sub>eff</sub>, a first-order nonlinear constrained ODE on the sphere S².</li>
                <li><strong>Energy density:</strong> u(<strong>M</strong>) = u<sub>Z</sub> + u<sub>K</sub>, with u<sub>K</sub> = K sin²θ.</li>
                <li><strong>Small-oscillation condition:</strong> linearize about equilibrium <strong>M</strong>=M<sub>s</sub>ẑ, keeping O(M<sub>x</sub>,M<sub>y</sub>) terms.</li>
              </ul>
            </div>

            <h3>3.3 Write the energy density explicitly in terms of magnetization components</h3>
            <p style="margin:6px 0 0">
              Because θ is the angle between <strong>M</strong> and z, we have cosθ = M<sub>z</sub>/|<strong>M</strong>| = M<sub>z</sub>/M<sub>s</sub>.
              Therefore:
            </p>
            <div class="eq" id="eq-sin">
sin^2θ = 1 - cos^2θ = 1 - (M_z/Ms)^2
u_K = K sin^2θ = K [ 1 - (M_z^2/Ms^2) ]
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-sin">Copy equation</button>
            </div>

            <p style="margin:10px 0 0">
              The Zeeman energy density written in <strong>B</strong>-form (matching the problem’s use of B) is:
            </p>
            <div class="eq" id="eq-zeeman">
u_Z = - M · B0 = - M_z B0     (with B0 along +z)
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-zeeman">Copy equation</button>
            </div>

            <p style="margin:10px 0 0;color:var(--muted)">
              So the total energy density (up to an irrelevant constant K) is:
            </p>
            <div class="eq" id="eq-utotal">
u(M) = -B0 M_z + K [ 1 - (M_z^2/Ms^2) ]
     = (constant)  - B0 M_z  - K (M_z^2/Ms^2)
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-utotal">Copy equation</button>
            </div>

            <h3>3.4 Effective field from energy: why and how</h3>
            <p style="margin:6px 0 0">
              The torque form d<strong>M</strong>/dt = −γ<strong>M</strong>×<strong>B</strong><sub>eff</sub> is conservative when <strong>B</strong><sub>eff</sub> derives from an energy.
              The mapping is chosen so that the work/energy change corresponds to the field acting on magnetization.
              For an energy density u expressed as a function of <strong>M</strong>, an effective field in B-units is defined by:
            </p>

            <div class="callout keyeq">
              <strong>Energy-to-field definition (B-units)</strong>
              <div class="eq" id="eq-beffdef">
B_eff := - ∂u/∂M
(i.e., componentwise: (B_eff)_i = - ∂u/∂M_i )
              </div>
              <div class="eqrow">
                <button class="btn small" data-copy-target="eq-beffdef">Copy equation</button>
              </div>
              <p style="margin:8px 0 0;color:var(--muted)">
                Here u contains the Zeeman term written as u<sub>Z</sub>=−M·B<sub>0</sub>, so this convention reproduces B<sub>0</sub> exactly.
                (In many texts one instead defines H<sub>eff</sub> via u=−μ<sub>0</sub>M·H and then H<sub>eff</sub>=−(1/μ<sub>0</sub>)∂u/∂M. The problem’s final answer is in B, so we stay in B.)
              </p>
            </div>

            <h3>3.5 Compute the anisotropy effective field explicitly (no jumps)</h3>
            <p style="margin:6px 0 0">
              From u(M) above, u depends only on M<sub>z</sub> (for this uniaxial case with easy axis along z).
              Therefore:
            </p>

            <div class="eq" id="eq-deriv">
∂u/∂M_x = 0
∂u/∂M_y = 0

∂u/∂M_z = ∂/∂M_z [ -B0 M_z - K (M_z^2/Ms^2) ]
        = -B0 - K * (2 M_z / Ms^2)
        = -B0 - (2K/Ms^2) M_z
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-deriv">Copy equation</button>
            </div>

            <p style="margin:10px 0 0">
              Using <strong>B</strong><sub>eff</sub> = −∂u/∂<strong>M</strong>, we obtain:
            </p>
            <div class="eq" id="eq-beff">
B_eff,x = 0
B_eff,y = 0
B_eff,z = B0 + (2K/Ms^2) M_z

So:  B_eff = [ B0 + (2K/Ms^2) M_z ] z-hat
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-beff">Copy equation</button>
            </div>

            <p style="margin:10px 0 0;color:var(--muted)">
              This step is valid because u is a smooth scalar function of the components (M<sub>x</sub>,M<sub>y</sub>,M<sub>z</sub>) in the macrospin approximation,
              so the gradient ∂u/∂<strong>M</strong> is well-defined and linearization will be justified near equilibrium.
            </p>

            <h3>3.6 Equilibrium direction and small-angle approximation</h3>
            <p style="margin:6px 0 0">
              For B<sub>0</sub>&gt;0 and K&gt;0, the energy is minimized by maximizing M<sub>z</sub> (subject to |<strong>M</strong>|=M<sub>s</sub>), i.e.:
              <strong>M</strong><sub>eq</sub> = M<sub>s</sub>ẑ.
              Now consider small deviations:
            </p>
            <div class="eq" id="eq-small">
M(t) = (Mx, My, Mz), with |M| = Ms
Small-angle: |Mx|,|My| << Ms
Then: Mz = sqrt(Ms^2 - Mx^2 - My^2) ≈ Ms  (to first order)
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-small">Copy equation</button>
            </div>

            <div class="callout assumptions">
              <strong>Mathematical implication of “small-angle”</strong>
              <p style="margin:8px 0 0">
                We keep terms O(M<sub>x</sub>) and O(M<sub>y</sub>) in the dynamical equations and drop O(M<sub>x</sub>², M<sub>y</sub>², M<sub>x</sub>M<sub>y</sub>) corrections.
                In particular, in prefactors like B<sub>eff,z</sub> = B<sub>0</sub> + (2K/M<sub>s</sub>²)M<sub>z</sub>, we may set M<sub>z</sub>≈M<sub>s</sub> because replacing M<sub>z</sub> by M<sub>s</sub> introduces only second-order errors.
              </p>
            </div>

            <p style="margin:10px 0 0">
              Therefore, to linear order:
            </p>
            <div class="eq" id="eq-ba">
B_eff ≈ ( B0 + 2K/Ms ) z-hat
Define: Ba := 2K/Ms
So: B_eff ≈ (B0 + Ba) z-hat
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-ba">Copy equation</button>
            </div>

            <h3>3.7 Linearize the Landau–Lifshitz equation and extract ω</h3>
            <p style="margin:6px 0 0">
              Start from:
            </p>
            <div class="eq" id="eq-ll2">
dM/dt = -γ ( M × B_eff )
with  B_eff ≈ (B0 + Ba) z-hat
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-ll2">Copy equation</button>
            </div>

            <p style="margin:10px 0 0">
              Compute the cross product explicitly. Let B̃ := (B<sub>0</sub>+B<sub>a</sub>).
              Then:
            </p>
            <div class="eq" id="eq-cross">
M × (B̃ z-hat) = B̃ ( M × z-hat )

If M = (Mx, My, Mz), then
M × z-hat = (Mx,My,Mz) × (0,0,1) = ( My*(-1), Mx*(+1), 0 ) = ( -My, Mx, 0 )

So:
M × (B̃ z-hat) = B̃ ( -My, Mx, 0 )
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-cross">Copy equation</button>
            </div>

            <p style="margin:10px 0 0">
              Insert into d<strong>M</strong>/dt = −γ(…):
            </p>
            <div class="eq" id="eq-ode">
dMx/dt = -γ * [ B̃ * (-My) ] =  γ B̃ My
dMy/dt = -γ * [ B̃ * ( Mx) ] = -γ B̃ Mx
dMz/dt = 0   (to linear order)
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-ode">Copy equation</button>
            </div>

            <p style="margin:10px 0 0">
              Differentiate the first equation with respect to time and substitute the second:
            </p>
            <div class="eq" id="eq-sho">
d^2 Mx/dt^2 = γ B̃ dMy/dt = γ B̃ (-γ B̃ Mx) = -(γ B̃)^2 Mx

Thus:  d^2 Mx/dt^2 + (γ B̃)^2 Mx = 0
Similarly: d^2 My/dt^2 + (γ B̃)^2 My = 0
            </div>
            <div class="eqrow">
              <button class="btn small" data-copy-target="eq-sho">Copy equation</button>
            </div>

            <p style="margin:10px 0 0">
              This is a harmonic-oscillator equation with angular frequency:
            </p>

            <div class="callout final">
              <strong>Final result (boxed)</strong>
              <div class="eq" id="eq-final">
ω0 = γ B̃ = γ (B0 + Ba),
Ba = 2K / Ms
              </div>
              <div class="eqrow">
                <button class="btn small good" data-copy-target="eq-final">Copy final answer</button>
                <button class="btn small" id="copy-final-plain">Copy final answer (plain text)</button>
              </div>
              <p style="margin:8px 0 0;color:var(--muted)">
                Interpretation: the anisotropy energy acts like an additional static field along the easy axis, increasing the precession rate.
              </p>
            </div>

            <h3>3.8 Sanity checks (dimensions, limits, sign)</h3>

            <div class="grid2">
              <div class="callout">
                <strong>Dimensional analysis</strong>
                <p style="margin:8px 0 0">
                  K has units J/m³. M<sub>s</sub> has units A/m. In SI, 1 T = 1 N/(A·m).
                  Note J/m³ = N·m/m³ = N/m², so:
                </p>
                <div class="eq" id="eq-dim">
[K/Ms] = (N/m^2) / (A/m) = N/(A·m) = T
So Ba = 2K/Ms has units of Tesla ✔
                </div>
                <div class="eqrow">
                  <button class="btn small" data-copy-target="eq-dim">Copy check</button>
                </div>
              </div>

              <div class="callout">
                <strong>Limiting cases</strong>
                <ul>
                  <li>K→0 ⇒ B<sub>a</sub>→0 ⇒ ω<sub>0</sub>→γB<sub>0</sub> (pure Zeeman precession).</li>
                  <li>B<sub>0</sub>→0 but K&gt;0 ⇒ ω<sub>0</sub>→γ(2K/M<sub>s</sub>) (anisotropy alone sustains a restoring torque around the easy axis).</li>
                </ul>
              </div>
            </div>

            <div class="callout">
              <strong>Sign / direction reasoning</strong>
              <p style="margin:8px 0 0">
                For K&gt;0 the easy axis is along z, so small deviations increase energy and the anisotropy field points along z (for M<sub>z</sub>&gt;0),
                reinforcing B<sub>0</sub>. Hence B<sub>a</sub> enters with a <strong>plus</strong> sign in ω<sub>0</sub> = γ(B<sub>0</sub>+B<sub>a</sub>).
              </p>
            </div>

            <details>
              <summary>Optional deeper note: why the “sphere” matters</summary>
              <div class="content">
                <p style="margin:0">
                  In general, FMR in a finite sample depends on demagnetizing fields: <strong>H</strong><sub>d</sub> = −<hat N>·<strong>M</strong>.
                  For an ellipsoid, the uniform mode remains exact, but the resonance becomes
                  ω = γ√((H<sub>eff</sub>+…)(H<sub>eff</sub>+…)) (Kittel formula).
                  A sphere has N<sub>x</sub>=N<sub>y</sub>=N<sub>z</sub>=1/3, so shape contributions are isotropic; with field and easy axis along z,
                  the resonance simplifies to precession about an effective z-field, giving the clean additive shift shown here.
                </p>
              </div>
            </details>

            <a class="toplink" href="#top">Back to top ↑</a>
          </section>

          <section id="part4">
            <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

            <h3>4.1 Re-interpret the formula term-by-term</h3>
            <ul>
              <li><strong>γB<sub>0</sub>:</strong> the basic Larmor precession rate around the applied bias field.</li>
              <li><strong>γB<sub>a</sub>:</strong> the extra precession rate due to <em>crystal anisotropy</em>. Since B<sub>a</sub>=2K/M<sub>s</sub>, it is larger when:
                <ul>
                  <li>K is large (strong preference for the easy axis),</li>
                  <li>M<sub>s</sub> is small (less “magnetic inertia” for a given anisotropy energy density).</li>
                </ul>
              </li>
            </ul>

            <h3>4.2 Parameter dependence (qualitative + quantitative)</h3>
            <div class="callout">
              <ul>
                <li>Increase <strong>K</strong> by 10% ⇒ B<sub>a</sub> increases by 10% ⇒ ω<sub>0</sub> increases by γ·(10% of 2K/M<sub>s</sub>).</li>
                <li>Increase <strong>M<sub>s</sub></strong> by 10% ⇒ B<sub>a</sub> decreases by about 9.1% (since B<sub>a</sub>∝1/M<sub>s</sub>).</li>
                <li>Increase <strong>B<sub>0</sub></strong> ⇒ ω<sub>0</sub> increases linearly with slope γ (straight-line tuning in bias field).</li>
              </ul>
            </div>

            <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
            <details>
              <summary>Alternative: small-oscillation/eigenvalue viewpoint from linear operators</summary>
              <div class="content">
                <p style="margin:0">
                  Near equilibrium, the dynamics is a linear system
                  d<strong>u</strong>/dt = <strong>A</strong><strong>u</strong> for <strong>u</strong>=(M<sub>x</sub>,M<sub>y</sub>)ᵀ,
                  where <strong>A</strong> is an antisymmetric matrix proportional to (B<sub>0</sub>+B<sub>a</sub>):
                  <span class="eq" style="margin-top:8px" id="eq-matrix">
A = γ(B0+Ba) [ [0,  1],
              [-1, 0] ]
Eigenvalues: λ = ± i γ(B0+Ba)
⇒ ω0 = γ(B0+Ba)
                  </span>
                  This frames FMR as an eigenfrequency of a rotation generator (a skew-symmetric operator).
                </p>
                <div class="eqrow">
                  <button class="btn small" data-copy-target="eq-matrix">Copy matrix form</button>
                </div>
              </div>
            </details>

            <h3>4.4 Concept check (self-test with answers)</h3>
            <ul>
              <li><strong>Q:</strong> If K=0, what happens to the resonance? <strong>A:</strong> ω<sub>0</sub>=γB<sub>0</sub> (pure Larmor precession).</li>
              <li><strong>Q:</strong> Why does K&gt;0 increase ω<sub>0</sub>? <strong>A:</strong> It adds a restoring torque toward the easy axis, equivalent to an added z-directed field.</li>
              <li><strong>Q:</strong> Where did the factor 2 come from in B<sub>a</sub>=2K/M<sub>s</sub>? <strong>A:</strong> From differentiating −K(M<sub>z</sub>²/M<sub>s</sub>²) with respect to M<sub>z</sub>, yielding −2K M<sub>z</sub>/M<sub>s</sub>².</li>
              <li><strong>Q:</strong> Why can we replace M<sub>z</sub> by M<sub>s</sub> in B<sub>eff,z</sub> during linearization? <strong>A:</strong> Because M<sub>z</sub>=M<sub>s</sub>+O(M<sub>x</sub>²,M<sub>y</sub>²), and we drop second-order terms.</li>
              <li><strong>Q:</strong> Does damping change ω<sub>0</sub> strongly? <strong>A:</strong> Weak damping mainly broadens the resonance; the frequency shift is typically small to first order.</li>
            </ul>

            <a class="toplink" href="#top">Back to top ↑</a>
          </section>

          <section id="part5">
            <h2>PART 5 — Optional Plot Guide</h2>
            <div class="callout">
              <strong>No plot is necessary here.</strong>
              <p style="margin:8px 0 0;color:var(--muted)">
                The result is purely symbolic and already linear in B<sub>0</sub>. A plot would require choosing numerical values for K, M<sub>s</sub>, and γ,
                which is not needed to prove the statement. Conceptually, ω<sub>0</sub> vs B<sub>0</sub> is just a straight line with slope γ and intercept γB<sub>a</sub>.
              </p>
            </div>

            <a class="toplink" href="#top">Back to top ↑</a>
          </section>

        </article>
      </main>
    </div>
  </div>
</header>

<footer class="wrap">
  <div class="card">
    <strong>Plain-text final answer (for quick copy/paste):</strong>
    <div class="eq" id="final-plain">
ω0 = γ (B0 + Ba),  with  Ba = 2K/Ms.
    </div>
    <div class="eqrow">
      <button class="btn small good" data-copy-target="final-plain">Copy</button>
    </div>
    <p style="margin:10px 0 0">
      If you want, I can also show how this generalizes to thin films (demagnetizing factors) and how B<sub>a</sub> relates to the commonly used anisotropy field in H-units.
    </p>
  </div>
</footer>

<script>
  // Copy helpers
  function copyText(text){
    if (navigator.clipboard && navigator.clipboard.writeText) {
      return navigator.clipboard.writeText(text);
    }
    // Fallback
    const ta = document.createElement('textarea');
    ta.value = text;
    ta.style.position = 'fixed';
    ta.style.left = '-9999px';
    document.body.appendChild(ta);
    ta.select();
    try { document.execCommand('copy'); } catch(e) {}
    document.body.removeChild(ta);
    return Promise.resolve();
  }

  function flashBtn(btn, ok=true){
    const old = btn.textContent;
    btn.textContent = ok ? 'Copied!' : 'Copy failed';
    btn.style.borderColor = ok ? 'rgba(52,211,153,.55)' : 'rgba(251,113,133,.55)';
    btn.style.background = ok ? 'rgba(52,211,153,.12)' : 'rgba(251,113,133,.10)';
    setTimeout(()=>{
      btn.textContent = old;
      btn.style.borderColor = '';
      btn.style.background = '';
    }, 900);
  }

  document.querySelectorAll('[data-copy-target]').forEach(btn=>{
    btn.addEventListener('click', async ()=>{
      const id = btn.getAttribute('data-copy-target');
      const el = document.getElementById(id);
      const text = (el ? el.textContent : '').trim();
      try{
        await copyText(text);
        flashBtn(btn, true);
      }catch(e){
        flashBtn(btn, false);
      }
    });
  });

  // Dedicated plain-text final answer button
  const finalBtn = document.getElementById('copy-final-plain');
  if(finalBtn){
    finalBtn.addEventListener('click', async ()=>{
      const text =
`ω0 = γ (B0 + Ba)
Ba = 2K/Ms`;
      try{
        await copyText(text);
        flashBtn(finalBtn, true);
      }catch(e){
        flashBtn(finalBtn, false);
      }
    });
  }
</script>
</body>
</html>