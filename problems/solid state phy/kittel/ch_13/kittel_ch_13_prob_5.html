<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Exchange Frequency Resonance in a Two-Sublattice Ferrimagnet (Derivation)</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#0f1624;
      --panel2:#111b2d;
      --text:#e9eef7;
      --muted:#b7c3d9;
      --faint:#7f8aa3;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,0.10);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius:16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    html{scroll-behavior:smooth;}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 600px at 15% -10%, rgba(125,211,252,0.15), transparent 60%),
                  radial-gradient(900px 500px at 95% 10%, rgba(167,139,250,0.12), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }

    header{
      padding: 28px 18px 18px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,0.03), transparent);
    }

    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 0 14px 42px;
    }

    .title{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      align-items:start;
    }

    h1{
      margin:0;
      font-size: clamp(1.45rem, 2.4vw, 2.25rem);
      letter-spacing: 0.2px;
    }
    .subtitle{
      color: var(--muted);
      max-width: 90ch;
      font-size: 1.02rem;
    }

    main{
      display:grid;
      grid-template-columns: 310px 1fr;
      gap: 18px;
      margin-top: 18px;
    }

    nav{
      position: sticky;
      top: 12px;
      align-self:start;
      background: rgba(15,22,36,0.72);
      backdrop-filter: blur(10px);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    nav .navhead{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(125,211,252,0.10), transparent);
    }
    nav .navhead strong{display:block;}
    nav .navhead span{
      display:block;
      color: var(--muted);
      font-size: 0.92rem;
      margin-top: 4px;
    }
    nav ul{
      list-style:none;
      margin:0;
      padding: 10px 10px 12px;
      display:grid;
      gap: 6px;
    }
    nav a{
      display:block;
      padding: 9px 10px;
      border-radius: 12px;
      text-decoration:none;
      color: var(--text);
      border: 1px solid transparent;
      transition: transform 140ms ease, background 140ms ease, border-color 140ms ease;
      font-size: 0.98rem;
    }
    nav a:hover{
      background: rgba(255,255,255,0.05);
      border-color: rgba(125,211,252,0.25);
      transform: translateY(-1px);
    }
    nav a small{
      display:block;
      color: var(--muted);
      font-size: 0.84rem;
      margin-top: 2px;
    }

    article{
      background: rgba(15,22,36,0.55);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    section{
      padding: 18px 18px;
      border-top: 1px solid var(--line);
    }
    section:first-child{border-top:none;}

    h2{
      margin: 0 0 10px;
      font-size: 1.35rem;
      letter-spacing: 0.2px;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 1.1rem;
      color: var(--text);
    }
    p{margin: 10px 0;}
    ul{margin: 8px 0 10px 18px;}
    li{margin: 4px 0; color: var(--muted);}
    .muted{color: var(--muted);}
    .faint{color: var(--faint);}

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 980px){
      main{grid-template-columns: 1fr;}
      nav{position: relative; top: 0;}
      .grid2{grid-template-columns: 1fr;}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.04), transparent);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 12px 12px;
    }

    .callout{
      border-radius: var(--radius);
      border: 1px solid var(--line);
      padding: 12px 12px;
      background: rgba(17,27,45,0.55);
      position: relative;
      overflow:hidden;
    }
    .callout:before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(600px 160px at 10% 0%, rgba(125,211,252,0.10), transparent 55%),
                  radial-gradient(600px 160px at 90% 0%, rgba(167,139,250,0.08), transparent 55%);
      pointer-events:none;
    }
    .callout > *{position:relative;}
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-weight: 650;
      font-size: 0.92rem;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.03);
      margin-bottom: 8px;
    }
    .tag .dot{
      width: 10px; height: 10px; border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(125,211,252,0.12);
    }
    .tag.warn .dot{background: var(--warn); box-shadow: 0 0 0 6px rgba(251,191,36,0.12);}
    .tag.ok .dot{background: var(--ok); box-shadow: 0 0 0 6px rgba(52,211,153,0.12);}
    .tag.bad .dot{background: var(--bad); box-shadow: 0 0 0 6px rgba(251,113,133,0.12);}

    .eqbox{
      border: 1px solid rgba(125,211,252,0.25);
      background: rgba(125,211,252,0.06);
      border-radius: var(--radius);
      padding: 12px;
      overflow:auto;
    }
    pre, code{
      font-family: var(--mono);
      font-size: 0.95rem;
      color: var(--text);
    }
    pre{margin:0; white-space: pre-wrap; word-break: break-word;}
    .eqrow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
    }
    .btn{
      appearance:none;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      cursor:pointer;
      transition: transform 140ms ease, background 140ms ease, border-color 140ms ease;
      font-weight: 650;
      font-size: 0.92rem;
      flex: 0 0 auto;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,0.06);
      border-color: rgba(125,211,252,0.25);
    }
    .btn:active{transform: translateY(0px) scale(0.99);}
    .btn.small{padding: 6px 8px; font-size: 0.88rem;}
    .btn.okflash{border-color: rgba(52,211,153,0.6); background: rgba(52,211,153,0.10);}

    details{
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.03);
      border-radius: var(--radius);
      padding: 10px 12px;
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      font-weight: 700;
      color: var(--text);
    }
    details p, details li{color: var(--muted);}

    figure{
      margin: 12px 0 0;
      border: 1px solid var(--line);
      border-radius: var(--radius);
      overflow:hidden;
      background: rgba(0,0,0,0.15);
    }
    figcaption{
      padding: 10px 12px;
      border-top: 1px solid var(--line);
      color: var(--muted);
      font-size: 0.92rem;
    }
    canvas{
      width: 100%;
      height: 320px;
      display:block;
    }

    .backtop{
      display:inline-block;
      margin-top: 12px;
      color: var(--accent);
      text-decoration:none;
      font-weight: 650;
    }
    .backtop:hover{text-decoration:underline;}

    footer{
      margin-top: 18px;
      padding: 16px 14px 28px;
      color: var(--muted);
      border-top: 1px solid var(--line);
      font-size: 0.95rem;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000;}
      nav{display:none;}
      article, section, header{box-shadow:none; border-color:#ddd; background:#fff;}
      .btn{display:none;}
      a{color:#000; text-decoration:none;}
      .callout, .eqbox{border-color:#ccc; background:#f7f7f7;}
      figure{border-color:#ccc;}
      section{break-inside: avoid;}
      h2{break-after: avoid;}
    }

    /* tiny micro-animation */
    .pulse{
      animation: pulse 3.2s ease-in-out infinite;
    }
    @keyframes pulse{
      0%, 100%{filter: brightness(1);}
      50%{filter: brightness(1.06);}
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap">
      <div class="title">
        <h1>Exchange Frequency Resonance in a Two-Sublattice Ferrimagnet</h1>
        <div class="subtitle">
          A mathematically rigorous, physics-friendly derivation (with an applied/industrial lens) of the
          <span class="pulse" style="color:var(--accent); font-weight:700;">exchange frequency resonance</span>
          for coupled sublattice magnetizations.
        </div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <main>
      <nav aria-label="Table of contents">
        <div class="navhead">
          <strong>Table of Contents</strong>
          <span>Sticky quick navigation</span>
        </div>
        <ul>
          <li><a href="#quick">Quick Summary <small>Result + key equations</small></a></li>
          <li><a href="#part0">PART 0 — Concept Primer <small>Ferrimagnets, exchange, dynamics</small></a></li>
          <li><a href="#part0b">PART 0B — Industry & Applied <small>Why engineers care</small></a></li>
          <li><a href="#part1">PART 1 — Problem Analysis <small>Given/unknowns/assumptions</small></a></li>
          <li><a href="#part2">PART 2 — Strategy & Tips <small>Roadmap + mistakes</small></a></li>
          <li><a href="#part3">PART 3 — Full Solution <small>Step-by-step derivation</small></a></li>
          <li><a href="#part4">PART 4 — Deeper Understanding <small>Interpretation + checks</small></a></li>
          <li><a href="#part5">PART 5 — Optional Plot Guide <small>How to read the plot</small></a></li>
        </ul>
      </nav>

      <article>
        <!-- Quick Summary -->
        <section id="quick">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this is:</strong> small-angle magnetization dynamics in a <em>ferrimagnet</em> with two coupled sublattices A and B.</li>
            <li><strong>Key physics idea:</strong> <em>exchange (molecular) fields</em> couple the precession of the two sublattice magnetizations, producing a high-frequency “optical” mode.</li>
            <li><strong>Governing equations:</strong> undamped Landau–Lifshitz dynamics for each sublattice,
              <code>dM/dt = -γ ( M × B_eff )</code>, with molecular fields <code>B_A = -λ M_B</code>, <code>B_B = -λ M_A</code>.</li>
            <li><strong>Mathematical object:</strong> a <em>linear ODE eigenvalue problem</em> obtained by linearizing around the antiparallel equilibrium and solving for normal modes.</li>
            <li><strong>Result type:</strong> symbolic resonance frequency. The nonzero mode satisfies
              <code>ω0 = |λ(γA|MB| − γB|MA|)|</code>, hence
              <code>ω0^2 = λ^2(γA|MB| − γB|MA|)^2</code>.</li>
            <li><strong>Physical meaning:</strong> the resonance is set by <em>exchange strength</em> and the “mismatch” between the two sublattices’ gyromagnetic responses weighted by their magnetization magnitudes.</li>
            <li><strong>Bonus insight:</strong> there is also a <em>zero-frequency</em> mode (global rotation) because, with only isotropic exchange and no anisotropy/external field, the energy is rotationally invariant.</li>
          </ul>

          <div class="callout">
            <div class="tag ok"><span class="dot"></span>Key Result (copyable)</div>
            <div class="eqbox">
              <div class="eqrow">
                <pre id="eq-key">ω0^2 = λ^2 ( γA |MB| − γB |MA| )^2
ω0  = |λ( γA |MB| − γB |MA| )|</pre>
                <button class="btn" data-copy="#eq-key" aria-label="Copy key equation">Copy</button>
              </div>
            </div>
          </div>
          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <!-- PART 0 -->
        <section id="part0">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <div class="grid2">
            <div class="card">
              <h3>Core definitions (symbols + SI units)</h3>
              <ul>
                <li><code>M_A, M_B</code>: sublattice magnetization vectors (A/m).</li>
                <li><code>|M_A|, |M_B|</code>: magnitudes (A/m). We will denote equilibrium magnitudes by <code>M_A</code> and <code>M_B</code> (positive scalars).</li>
                <li><code>γ_A, γ_B</code>: gyromagnetic ratios (rad·s<sup>−1</sup>·T<sup>−1</sup>).</li>
                <li><code>B_A, B_B</code>: effective (molecular/exchange) magnetic fields acting on each sublattice (T).</li>
                <li><code>λ</code>: molecular-field (exchange) coupling constant. From <code>B = -λ M</code>, its SI unit is T·m/A.</li>
                <li><code>t</code>: time (s), <code>ω</code>: angular frequency (rad/s).</li>
              </ul>
            </div>

            <div class="card">
              <h3>Physical meaning (intuition)</h3>
              <ul>
                <li><strong>Ferrimagnet:</strong> two sublattices are <em>antiparallel</em> at rest but generally have different magnitudes, so a net magnetization can remain.</li>
                <li><strong>Molecular field:</strong> an effective internal field caused by exchange; each sublattice feels a field proportional to the other’s magnetization.</li>
                <li><strong>Resonance:</strong> small transverse “wiggles” of <code>M_A</code> and <code>M_B</code> can form normal modes; one is high-frequency and is the “exchange frequency resonance.”</li>
              </ul>
            </div>
          </div>

          <h3>Key laws/principles and validity conditions</h3>
          <div class="callout">
            <div class="tag"><span class="dot"></span>Dynamics law: (undamped) Landau–Lifshitz form</div>
            <p class="muted">
              For each sublattice <code>i ∈ {A,B}</code>, the (undamped) precession equation is
              a first-order vector ODE expressing torque balance:
            </p>
            <div class="eqbox">
              <div class="eqrow">
                <pre id="eq-ll">dM_i/dt = -γ_i ( M_i × B_i )</pre>
                <button class="btn" data-copy="#eq-ll">Copy</button>
              </div>
            </div>
            <ul>
              <li><strong>Why valid here:</strong> we are modeling coherent, uniform precession (no spatial variation), ignoring damping, and assuming exchange can be represented by a mean-field (molecular-field) term.</li>
              <li><strong>What it implies mathematically:</strong> <code>|M_i|</code> is conserved because <code>M_i · (M_i × B_i)=0</code> (orthogonality of cross product), so the dynamics live on a sphere in magnetization space.</li>
            </ul>
          </div>

          <h3>Common models/approximations used and why</h3>
          <ul>
            <li><strong>Molecular-field (mean-field) exchange:</strong> replace microscopic exchange by effective fields <code>B_A=-λ M_B</code>, <code>B_B=-λ M_A</code>. This makes the problem tractable and captures the leading coupling.</li>
            <li><strong>Uniform (macrospin) mode:</strong> assume no spatial dependence, so no PDEs in space (no ∇ terms). In a fuller micromagnetic model, one would add exchange stiffness terms ~ <code>∇²M</code> and anisotropy.</li>
            <li><strong>Small-angle linearization:</strong> assume transverse components are small, allowing linear ODEs and an eigenfrequency calculation.</li>
          </ul>

          <h3>Mini intuition examples (quick)</h3>
          <ul>
            <li><strong>Single magnetization in constant field:</strong> if <code>B = B0 ẑ</code>, then transverse components precess at <code>ω = |γ|B0</code>.</li>
            <li><strong>Two coupled oscillators analogy:</strong> two “spins” coupled by exchange resemble two coupled oscillators: one in-phase mode (often lower frequency) and one out-of-phase mode (often higher frequency).</li>
          </ul>

          <h3>What to watch for (pitfalls)</h3>
          <ul>
            <li><strong>Sign conventions:</strong> the sign in <code>dM/dt = -γ M×B</code> vs <code>+γ M×B</code> changes phase rotation direction but not the final <code>ω0^2</code>.</li>
            <li><strong>Equilibrium directions:</strong> “opposite at rest” means <code>M_A</code> and <code>M_B</code> are antiparallel; be consistent when defining +z.</li>
            <li><strong>Linearization:</strong> keep only first-order terms in transverse components; drop products like <code>mA×mB</code>.</li>
            <li><strong>Units:</strong> check that <code>λM</code> has units of Tesla, so <code>γλM</code> has units of s<sup>−1</sup>.</li>
          </ul>

          <div class="callout">
            <div class="tag"><span class="dot"></span>Math Insight</div>
            <p class="muted">
              After linearization, the dynamics become a constant-coefficient linear system
              <code>ẋ = A x</code> (an ODE eigenvalue problem). Normal-mode frequencies are determined by the
              eigenvalues of <code>A</code>; oscillations correspond to purely imaginary eigenvalues
              <code>±iω</code>. Here, symmetry produces one zero eigenvalue (Goldstone mode) and one nonzero eigenvalue (exchange resonance).
            </p>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <!-- PART 0B -->
        <section id="part0b">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>

          <h3>Where this shows up (concrete applications)</h3>
          <ul>
            <li><strong>High-frequency magnetic devices:</strong> ferrimagnetic resonances in GHz–THz regimes for isolators, filters, and emerging THz components.</li>
            <li><strong>Spintronics & magnonics:</strong> sublattice “optical” modes in ferrimagnets (and antiferromagnets) are candidates for ultrafast information processing using spin waves.</li>
            <li><strong>Magnetic sensing and metrology:</strong> resonance frequencies provide a handle on exchange coupling and sublattice magnetizations, useful for material qualification and quality control.</li>
          </ul>

          <h3>Why engineers care (performance, reliability, cost)</h3>
          <ul>
            <li><strong>Performance:</strong> resonance sets operating frequency windows; exchange modes can enable ultrafast response compared with ferromagnetic FMR.</li>
            <li><strong>Reliability:</strong> temperature dependence of <code>|M_A|</code>, <code>|M_B|</code> shifts <code>ω0</code>; designers must ensure stable operation over spec temperature ranges.</li>
            <li><strong>Manufacturability:</strong> composition, defects, and inter-sublattice coupling variations change effective <code>λ</code>, impacting device-to-device variability.</li>
          </ul>

          <h3>Typical measurement/validation methods</h3>
          <ul>
            <li><strong>FMR/AFMR spectroscopy:</strong> microwave/THz absorption vs frequency to locate resonance peaks.</li>
            <li><strong>Time-resolved magneto-optics:</strong> pump–probe (e.g., TR-MOKE) to observe ultrafast precession and extract mode frequencies.</li>
            <li><strong>Material characterization:</strong> magnetometry (for <code>|M_A|, |M_B|</code> trends) plus fitting resonance data to infer <code>λ</code>.</li>
          </ul>

          <h3>Design trade-offs and constraints (non-idealities)</h3>
          <ul>
            <li><strong>Damping:</strong> real materials have losses (Gilbert damping), broadening resonances and reducing Q-factor.</li>
            <li><strong>Anisotropy & external fields:</strong> add restoring torques and shift mode frequencies; the “pure exchange” formula is an ideal baseline.</li>
            <li><strong>Spatial nonuniformity:</strong> films/devices support standing spin-wave modes; then ∇² terms matter and the spectrum becomes dispersive.</li>
          </ul>

          <details>
            <summary>From lab to product: how the ideal model is adapted</summary>
            <p>
              In practice, engineers start with the ideal exchange-only macrospin model to estimate frequency scales,
              then add: (i) anisotropy fields from crystal symmetry and shape, (ii) external bias fields, (iii) damping,
              and (iv) spatial mode structure (exchange stiffness, boundary conditions). The exchange resonance derived
              here remains a key “anchor” parameter because it isolates the inter-sublattice coupling physics.
            </p>
          </details>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <!-- PART 1 -->
        <section id="part1">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <h3>Problem restatement (in plain words)</h3>
          <p class="muted">
            We have a ferrimagnet with two sublattices A and B, magnetizations <code>M_A</code> and <code>M_B</code>
            that are antiparallel at equilibrium. Each sublattice experiences a molecular (exchange) field proportional
            to the other’s magnetization:
            <code>B_A = -λ M_B</code>, <code>B_B = -λ M_A</code>.
            With gyromagnetic ratios <code>γ_A</code> and <code>γ_B</code>, show that the system has a resonance at
            <code>ω0^2 = λ^2(γ_A|M_B| − γ_B|M_A|)^2</code>.
          </p>

          <div class="grid2">
            <div class="card">
              <h3>Given</h3>
              <ul>
                <li>Two sublattices A and B with magnetization vectors <code>M_A(t)</code>, <code>M_B(t)</code>.</li>
                <li>Antiparallel equilibrium: <code>M_B</code> opposite to <code>M_A</code> at rest.</li>
                <li>Gyromagnetic ratios: <code>γ_A</code>, <code>γ_B</code>.</li>
                <li>Molecular fields: <code>B_A = -λ M_B</code>, <code>B_B = -λ M_A</code>.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Unknown / to prove</h3>
              <ul>
                <li>The resonance (normal-mode) frequency <code>ω0</code> of small oscillations.</li>
                <li>Specifically show:
                  <code>ω0^2 = λ^2(γ_A|M_B| − γ_B|M_A|)^2</code>.
                </li>
              </ul>
            </div>
          </div>

          <h3>Relevant principles (why they apply)</h3>
          <ul>
            <li><strong>Landau–Lifshitz precession:</strong> exchange fields act like effective magnetic fields producing torque <code>M×B</code>.</li>
            <li><strong>Small-oscillation theory:</strong> linearize the ODEs about equilibrium; resonances are eigenfrequencies of the linear system.</li>
            <li><strong>Rotational symmetry:</strong> with only isotropic exchange and no anisotropy/external field, expect one zero mode (global rotation).</li>
          </ul>

          <div class="callout">
            <div class="tag warn"><span class="dot"></span>Assumptions (explicit)</div>
            <ul>
              <li><strong>Uniform (macrospin) dynamics:</strong> no spatial variation → no PDE terms like <code>∇²M</code>.</li>
              <li><strong>Undamped dynamics:</strong> ignore damping (no Gilbert term).</li>
              <li><strong>Small-angle motion:</strong> transverse components are small, so we keep only first-order terms.</li>
              <li><strong>Fixed magnitudes:</strong> <code>|M_A|</code>, <code>|M_B|</code> constant under pure precession.</li>
            </ul>
          </div>

          <h3>Possible approaches (compare)</h3>
          <ol class="muted">
            <li><strong>Direct linearization in components (x,y):</strong> write ODEs for <code>M_{Ax}, M_{Ay}, M_{Bx}, M_{By}</code>.
              <br/><span class="faint">Pros: transparent; Cons: algebra can be longer.</span></li>
            <li><strong>Complex transverse variables:</strong> use <code>m_+ = m_x + i m_y</code> to convert cross products into factors of <code>±i</code>.
              <br/><span class="faint">Pros: compact and clean; Cons: requires comfort with complex representation.</span></li>
            <li><strong>Energy + Poisson bracket/LL formalism:</strong> derive linearized equations from an exchange energy and canonical structure.
              <br/><span class="faint">Pros: very “theoretical physics”; Cons: heavier machinery than needed.</span></li>
          </ol>

          <p class="muted"><strong>Choice:</strong> We’ll use the complex transverse-variable approach because it is rigorous, compact,
            and highlights the eigenvalue structure that produces the resonance.</p>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <!-- PART 2 -->
        <section id="part2">
          <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

          <ol class="muted">
            <li><strong>Set equilibrium geometry:</strong> choose a coordinate axis (z) so equilibrium magnetizations are antiparallel along z.</li>
            <li><strong>Write the dynamical model:</strong> use <code>dM_i/dt = -γ_i(M_i×B_i)</code> with <code>B_A=-λM_B</code>, <code>B_B=-λM_A</code>.</li>
            <li><strong>Decompose into longitudinal + transverse parts:</strong> <code>M_i = (equilibrium) + (small transverse)</code>.</li>
            <li><strong>Linearize cross products:</strong> keep only terms first order in transverse components; drop products of small terms.</li>
            <li><strong>Convert transverse vectors to complex scalars:</strong> define <code>m_+ = m_x + i m_y</code> so <code>(ẑ×m)_+ = i m_+</code>.</li>
            <li><strong>Obtain a linear ODE system:</strong> two coupled first-order equations for <code>m_{A+}</code>, <code>m_{B+}</code>.</li>
            <li><strong>Find normal modes:</strong> compute eigenvalues (or identify a convenient combined variable) to extract <code>ω0</code>.</li>
            <li><strong>Sanity checks:</strong> confirm units, limiting cases, and interpret the physical content (zero mode + exchange mode).</li>
          </ol>

          <div class="callout">
            <div class="tag bad"><span class="dot"></span>Common mistakes</div>
            <ul>
              <li>Forgetting that equilibrium <code>M_B</code> points opposite to <code>M_A</code> (sign errors in <code>B_A</code>, <code>B_B</code>).</li>
              <li>Keeping second-order small terms (e.g., <code>mA×mB</code>) which should be dropped in linear theory.</li>
              <li>Mixing up <code>|M_A|</code> (a scalar magnitude) with vector <code>M_A</code>.</li>
              <li>Not checking dimensions: <code>γλM</code> must have units of s<sup>−1</sup>.</li>
            </ul>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <!-- PART 3 -->
        <section id="part3">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>Qualitative expectation (before calculating)</h3>
          <p class="muted">
            Because each sublattice feels a field proportional to the other’s magnetization, a small transverse tilt of one
            produces a transverse field on the other, which then torques it back. This creates a restoring “exchange” torque.
            We therefore expect a <em>high-frequency</em> normal mode whose scale is set by <code>λ</code> times magnetization magnitudes and gyromagnetic ratios.
            Also, with no anisotropy/external field, we expect one <em>zero-frequency</em> mode corresponding to rotating both sublattices together.
          </p>

          <h3>Step 1: Mathematical model (variables, domain, coordinates)</h3>
          <div class="callout">
            <div class="tag"><span class="dot"></span>Model statement (ODE system)</div>
            <ul>
              <li><strong>Unknowns:</strong> <code>M_A(t), M_B(t) ∈ ℝ³</code>.</li>
              <li><strong>Time domain:</strong> <code>t ∈ ℝ</code> (or <code>t ≥ 0</code> for an initial-value problem).</li>
              <li><strong>Coordinate system:</strong> choose Cartesian basis <code>(x̂, ŷ, ẑ)</code> with equilibrium along <code>ẑ</code>.</li>
              <li><strong>Dynamics:</strong>
                <div class="eqbox" style="margin-top:8px;">
                  <div class="eqrow">
                    <pre id="eq-model">dM_A/dt = -γ_A ( M_A × B_A )
dM_B/dt = -γ_B ( M_B × B_B )
B_A = -λ M_B
B_B = -λ M_A</pre>
                    <button class="btn" data-copy="#eq-model">Copy</button>
                  </div>
                </div>
              </li>
              <li><strong>Initial condition (conceptual):</strong> small transverse perturbation about equilibrium, e.g. <code>M_A(0)=M_A ẑ + small</code>, <code>M_B(0)=-M_B ẑ + small</code>.</li>
            </ul>
            <p class="muted">
              <strong>Why each step is allowed:</strong> The right-hand sides are smooth bilinear functions of <code>M_A, M_B</code>,
              so local existence/uniqueness follows from standard ODE theory. Linearity will emerge after we linearize about equilibrium.
            </p>
          </div>

          <h3>Step 2: Choose the equilibrium and expand around it</h3>
          <p class="muted">
            Let equilibrium (rest) magnetizations be antiparallel along z:
          </p>
          <div class="eqbox">
            <div class="eqrow">
              <pre id="eq-eq">M_A0 =  + M_A ẑ
M_B0 =  - M_B ẑ
with M_A &gt; 0, M_B &gt; 0 (scalar magnitudes)</pre>
              <button class="btn" data-copy="#eq-eq">Copy</button>
            </div>
          </div>

          <p class="muted">
            The corresponding molecular fields at equilibrium are:
          </p>
          <div class="eqbox">
            <div class="eqrow">
              <pre id="eq-fields">B_A0 = -λ M_B0 = -λ(-M_B ẑ) = +λ M_B ẑ
B_B0 = -λ M_A0 = -λ(+M_A ẑ) = -λ M_A ẑ</pre>
              <button class="btn" data-copy="#eq-fields">Copy</button>
            </div>
          </div>

          <p class="muted">
            Each sublattice magnetization is aligned with its effective field (so torque is zero), hence this is a valid equilibrium:
            <code>M_A0 × B_A0 = 0</code> and <code>M_B0 × B_B0 = 0</code>.
          </p>

          <h3>Step 3: Introduce small transverse components (linearization setup)</h3>
          <p class="muted">
            Write the magnetizations as equilibrium plus small transverse perturbations:
          </p>
          <div class="eqbox">
            <div class="eqrow">
              <pre id="eq-pert">M_A(t) = M_A ẑ + m_A(t)
M_B(t) = -M_B ẑ + m_B(t)

where m_A · ẑ = 0,  m_B · ẑ = 0  (transverse components, small)</pre>
              <button class="btn" data-copy="#eq-pert">Copy</button>
            </div>
          </div>

          <p class="muted">
            Then the effective fields become (using <code>B_A=-λM_B</code>, <code>B_B=-λM_A</code>):
          </p>
          <div class="eqbox">
            <div class="eqrow">
              <pre id="eq-beff">B_A(t) = -λ M_B(t) = -λ(-M_B ẑ + m_B) = +λ M_B ẑ - λ m_B
B_B(t) = -λ M_A(t) = -λ(+M_A ẑ + m_A) = -λ M_A ẑ - λ m_A</pre>
              <button class="btn" data-copy="#eq-beff">Copy</button>
            </div>
          </div>

          <div class="callout">
            <div class="tag warn"><span class="dot"></span>Linearization rule (explicit)</div>
            <p class="muted">
              We keep only first-order terms in <code>m_A</code>, <code>m_B</code>.
              Therefore, in products like <code>(M_A ẑ + m_A) × (λM_B ẑ - λ m_B)</code>, we keep:
              <code>(M_A ẑ)×(-λ m_B)</code> and <code>m_A×(λM_B ẑ)</code>, but drop <code>m_A×m_B</code> (second order).
            </p>
          </div>

          <h3>Step 4: Linearize the Landau–Lifshitz equations</h3>
          <p class="muted">
            Start from <code>dM_A/dt = -γ_A(M_A×B_A)</code>. Since <code>d(M_A ẑ)/dt=0</code>, we have <code>dm_A/dt = dM_A/dt</code>.
            Compute the cross product to first order:
          </p>

          <div class="eqbox">
            <div class="eqrow">
<pre id="eq-linA">dm_A/dt = -γ_A [ (M_A ẑ) × (-λ m_B)  +  m_A × ( +λ M_B ẑ ) ]</pre>
              <button class="btn" data-copy="#eq-linA">Copy</button>
            </div>
          </div>

          <p class="muted">
            Factor out <code>λ</code> and use the identity <code>m_A × ẑ = - ẑ × m_A</code>:
          </p>

          <div class="eqbox">
            <div class="eqrow">
<pre id="eq-linA2">dm_A/dt = -γ_A [ -λ M_A (ẑ × m_B) + λ M_B (m_A × ẑ) ]
        = -γ_A [ -λ M_A (ẑ × m_B) - λ M_B (ẑ × m_A) ]
        =  γ_A λ [ M_A (ẑ × m_B) + M_B (ẑ × m_A) ]</pre>
              <button class="btn" data-copy="#eq-linA2">Copy</button>
            </div>
          </div>

          <p class="muted">
            Now for sublattice B: <code>dM_B/dt = -γ_B(M_B×B_B)</code>, with <code>M_B = -M_B ẑ + m_B</code> and <code>B_B = -λ M_A ẑ - λ m_A</code>.
            Keeping only first-order terms:
          </p>

          <div class="eqbox">
            <div class="eqrow">
<pre id="eq-linB">dm_B/dt = -γ_B [ (-M_B ẑ) × (-λ m_A)  +  m_B × (-λ M_A ẑ) ]
        = -γ_B [  λ M_B (ẑ × m_A)    - λ M_A (m_B × ẑ) ]</pre>
              <button class="btn" data-copy="#eq-linB">Copy</button>
            </div>
          </div>

          <p class="muted">
            Again use <code>m_B × ẑ = - ẑ × m_B</code>:
          </p>

          <div class="eqbox">
            <div class="eqrow">
<pre id="eq-linB2">dm_B/dt = -γ_B [ λ M_B (ẑ × m_A) + λ M_A (ẑ × m_B) ]
        = -γ_B λ [ M_B (ẑ × m_A) + M_A (ẑ × m_B) ]</pre>
              <button class="btn" data-copy="#eq-linB2">Copy</button>
            </div>
          </div>

          <h3>Step 5: Convert cross products into a clean complex ODE system</h3>
          <p class="muted">
            Define the transverse complex amplitudes:
          </p>
          <div class="eqbox">
            <div class="eqrow">
              <pre id="eq-complex">m_{A+} = m_{Ax} + i m_{Ay}
m_{B+} = m_{Bx} + i m_{By}</pre>
              <button class="btn" data-copy="#eq-complex">Copy</button>
            </div>
          </div>

          <p class="muted">
            For a transverse vector <code>m</code>, one verifies (by component algebra) that:
          </p>
          <div class="eqbox">
            <div class="eqrow">
              <pre id="eq-identity">(ẑ × m)_+ = i m_+</pre>
              <button class="btn" data-copy="#eq-identity">Copy</button>
            </div>
          </div>

          <details>
            <summary>Optional verification of (ẑ×m)_+ = i m_+</summary>
            <p>
              Write <code>m = (m_x, m_y, 0)</code>. Then <code>ẑ×m = ( -m_y, m_x, 0)</code>.
              Hence <code>(ẑ×m)_+ = (-m_y) + i(m_x) = i(m_x + i m_y) = i m_+</code>.
            </p>
          </details>

          <p class="muted">
            Apply this identity to the linearized ODEs:
          </p>

          <div class="eqbox">
            <div class="eqrow">
<pre id="eq-coupled">d(m_{A+})/dt = γ_A λ [ M_A (ẑ×m_B)_+ + M_B (ẑ×m_A)_+ ]
            = γ_A λ [ M_A (i m_{B+}) + M_B (i m_{A+}) ]
            = i γ_A λ ( M_B m_{A+} + M_A m_{B+} )

d(m_{B+})/dt = -γ_B λ [ M_B (ẑ×m_A)_+ + M_A (ẑ×m_B)_+ ]
            = -γ_B λ [ M_B (i m_{A+}) + M_A (i m_{B+}) ]
            = -i γ_B λ ( M_B m_{A+} + M_A m_{B+} )</pre>
              <button class="btn" data-copy="#eq-coupled">Copy</button>
            </div>
          </div>

          <p class="muted">
            This is now a constant-coefficient linear ODE system in the two complex unknowns <code>m_{A+}</code>, <code>m_{B+}</code>.
            Resonances correspond to exponential solutions <code>∝ e^{iωt}</code>.
          </p>

          <h3>Step 6: Identify the normal modes via a combined variable</h3>
          <p class="muted">
            Notice both equations share the same combination <code>S = M_B m_{A+} + M_A m_{B+}</code>. Define:
          </p>
          <div class="eqbox">
            <div class="eqrow">
              <pre id="eq-S">S(t) := M_B m_{A+}(t) + M_A m_{B+}(t)</pre>
              <button class="btn" data-copy="#eq-S">Copy</button>
            </div>
          </div>

          <p class="muted">
            Differentiate <code>S</code> using linearity of differentiation (valid because this is an ODE with smooth solutions):
          </p>

          <div class="eqbox">
            <div class="eqrow">
<pre id="eq-Sdot">dS/dt = M_B d(m_{A+})/dt + M_A d(m_{B+})/dt
      = M_B [ i γ_A λ ( M_B m_{A+} + M_A m_{B+} ) ]
        + M_A [ -i γ_B λ ( M_B m_{A+} + M_A m_{B+} ) ]
      = i λ ( γ_A M_B - γ_B M_A ) ( M_B m_{A+} + M_A m_{B+} )
      = i λ ( γ_A M_B - γ_B M_A ) S</pre>
              <button class="btn" data-copy="#eq-Sdot">Copy</button>
            </div>
          </div>

          <p class="muted">
            This scalar ODE is solved immediately:
          </p>
          <div class="eqbox">
            <div class="eqrow">
              <pre id="eq-Ssol">S(t) = S(0) exp( i ω t ),  where  ω = λ( γ_A M_B - γ_B M_A )</pre>
              <button class="btn" data-copy="#eq-Ssol">Copy</button>
            </div>
          </div>

          <p class="muted">
            Therefore the system has a mode oscillating at angular frequency
            <code>ω0 = |λ(γ_A M_B - γ_B M_A)|</code>.
            Since <code>M_A</code> and <code>M_B</code> here are positive scalar magnitudes, this matches the statement
            <code>ω0 = |λ(γ_A|M_B| − γ_B|M_A|)|</code>.
          </p>

          <h3>Step 7: Existence of the zero-frequency mode (completeness)</h3>
          <p class="muted">
            The same structure shows a second mode: if <code>S = M_B m_{A+} + M_A m_{B+} = 0</code>,
            then from the coupled equations <code>d(m_{A+})/dt = d(m_{B+})/dt = 0</code>. This is the global-rotation (Goldstone) mode
            present when no anisotropy or external field breaks rotational symmetry.
          </p>

          <h3>Final result (boxed)</h3>
          <div class="callout">
            <div class="tag ok"><span class="dot"></span>Final Answer</div>
            <div class="eqbox">
              <div class="eqrow">
<pre id="eq-final">Exchange frequency resonance:

ω0 = |λ( γA |MB| − γB |MA| )|

Equivalently,
ω0^2 = λ^2 ( γA |MB| − γB |MA| )^2</pre>
                <button class="btn" data-copy="#eq-final">Copy</button>
              </div>
            </div>
            <div style="margin-top:10px;">
              <button class="btn" data-copy="#eq-final" id="btn-copy-final">Copy Final Answer (plain text)</button>
            </div>
          </div>

          <h3>Sanity checks</h3>
          <div class="grid2">
            <div class="card">
              <h3>Dimensional analysis</h3>
              <ul>
                <li><code>[B] = T</code>, <code>[M] = A/m</code>, so from <code>B = λ M</code>: <code>[λ] = T·m/A</code>.</li>
                <li><code>[γ] = (rad/s)/T</code>. Therefore <code>[γ λ M] = (rad/s)/T · (T·m/A) · (A/m) = rad/s</code>.</li>
                <li>Thus <code>ω0</code> has correct units of angular frequency.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Limiting cases</h3>
              <ul>
                <li><strong>No coupling:</strong> <code>λ → 0</code> ⇒ <code>ω0 → 0</code> (no restoring exchange torque).</li>
                <li><strong>Compensation condition:</strong> if <code>γA|MB| = γB|MA|</code>, then <code>ω0 = 0</code>; the “optical” restoring effect cancels in this ideal exchange-only macrospin model.</li>
                <li><strong>Stronger sublattice response:</strong> increasing <code>|MB|</code> (or <code>γA</code>) increases <code>ω0</code> linearly, and similarly for <code>|MA|</code>, <code>γB</code> with opposite sign inside the difference.</li>
              </ul>
            </div>
          </div>

          <h3>Plain-language interpretation</h3>
          <p class="muted">
            The exchange resonance frequency is proportional to the exchange-field strength scale <code>λ</code>
            and to an effective “imbalance” between the two sublattices:
            the A sublattice’s tendency to precess in the B-generated field (∝ <code>γA|MB|</code>)
            minus the B sublattice’s tendency to precess in the A-generated field (∝ <code>γB|MA|</code>).
          </p>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <!-- PART 4 -->
        <section id="part4">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>Re-interpret the formula term-by-term</h3>
          <ul>
            <li><code>λ</code>: sets the <strong>exchange-field scale</strong> (<code>B_ex ~ λM</code>); stronger coupling → higher resonance frequency.</li>
            <li><code>γA|MB|</code>: A’s precession strength in the field created by B (since <code>B_A ~ λ|MB|</code>).</li>
            <li><code>γB|MA|</code>: B’s precession strength in the field created by A.</li>
            <li>The <strong>difference</strong> reflects the two-sublattice character (optical mode depends on relative response).</li>
          </ul>

          <h3>Parameter dependence (qualitative and quantitative)</h3>
          <div class="callout">
            <div class="tag"><span class="dot"></span>Sensitivity summary</div>
            <ul>
              <li><strong>Linear in λ:</strong> <code>ω0 ∝ |λ|</code>.</li>
              <li><strong>Linear in magnetization magnitudes:</strong> increasing <code>|MB|</code> increases <code>ω0</code> if the term <code>γA|MB|</code> dominates.</li>
              <li><strong>Linear in gyromagnetic ratios:</strong> materials/ions with different effective <code>γ</code> shift resonance directly.</li>
              <li><strong>Near compensation:</strong> if <code>γA|MB| ≈ γB|MA|</code>, small changes in temperature/composition can produce large <em>relative</em> changes in <code>ω0</code>.</li>
            </ul>
          </div>

          <h3>Alternative derivation idea (brief but meaningful)</h3>
          <details>
            <summary>Energy + linear response viewpoint</summary>
            <p>
              One can start from an exchange energy density (macrospin) like
              <code>E = + (λ/2) M_A · M_B</code> (up to sign conventions) and define effective fields by variational derivatives
              <code>B_A = -∂E/∂M_A</code>, <code>B_B = -∂E/∂M_B</code>, reproducing <code>B_A=-λM_B</code>, <code>B_B=-λM_A</code>.
              Linearizing the resulting Hamiltonian-like LL dynamics around the antiparallel minimum yields the same normal-mode frequencies.
              In that language, the resonance comes from the curvature (second variation) of the energy around equilibrium.
            </p>
          </details>

          <h3>Concept check (self-test with answers)</h3>
          <ul>
            <li><strong>Q:</strong> Why do we get a zero-frequency mode? <strong>A:</strong> With only isotropic exchange, the system is rotationally symmetric; a uniform rotation costs no energy, hence no restoring torque → ω=0.</li>
            <li><strong>Q:</strong> What mathematical step turns the physics into an eigenvalue problem? <strong>A:</strong> Small-angle linearization produces a linear constant-coefficient ODE system whose eigenvalues give mode frequencies.</li>
            <li><strong>Q:</strong> What sets the scale of the exchange field? <strong>A:</strong> <code>B_ex ~ λ M</code>, so larger magnetization and coupling increase the torque and frequency.</li>
            <li><strong>Q:</strong> If damping were added, what would change? <strong>A:</strong> Eigenvalues acquire negative real parts (decay), and resonance peaks broaden; the undamped ω remains the center frequency (approximately, for small damping).</li>
          </ul>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>

        <!-- Optional plot (we include one simple plot) -->
        <section id="part5">
          <h2>PART 5 — Optional Plot Guide</h2>

          <p class="muted">
            A plot is not strictly necessary for this symbolic proof, but a single static plot can help you “see” the main scaling:
            <strong>ω0 is linear in λ</strong> for fixed material parameters. The plot below uses <em>example values</em> only
            (clearly labeled) and does not alter the symbolic final result.
          </p>

          <figure>
            <canvas id="plot" aria-label="Plot of omega0 versus lambda (example values)"></canvas>
            <figcaption>
              <strong>Example plot:</strong> ω0 versus λ using example values
              (γA = 1.76×10<sup>11</sup> rad·s<sup>−1</sup>·T<sup>−1</sup>, γB = 1.40×10<sup>11</sup> rad·s<sup>−1</sup>·T<sup>−1</sup>,
              |MA| = 2.0×10<sup>5</sup> A/m, |MB| = 3.0×10<sup>5</sup> A/m). Axes: λ (T·m/A) and ω0 (rad/s).
            </figcaption>
          </figure>

          <div class="callout" style="margin-top:12px;">
            <div class="tag"><span class="dot"></span>How to read this plot</div>
            <ul>
              <li><strong>x-axis:</strong> coupling <code>λ</code> (T·m/A).</li>
              <li><strong>y-axis:</strong> resonance frequency <code>ω0</code> (rad/s).</li>
              <li><strong>Feature to notice:</strong> straight line through the origin → <code>ω0 ∝ |λ|</code>.</li>
              <li><strong>Example values:</strong> chosen only to render a concrete curve; the derivation remains fully symbolic.</li>
            </ul>
          </div>

          <a class="backtop" href="#top">Back to top ↑</a>
        </section>
      </article>
    </main>

    <footer>
      <div class="wrap" style="padding:0;">
        <p>
          <strong>Note:</strong> This article derived the exchange-only two-sublattice resonance.
          In real ferrimagnets, anisotropy fields, external bias, damping, and spatial exchange stiffness
          (terms involving <code>∇</code> and <code>∇²</code>) shift and broaden the spectrum, but the exchange resonance scale
          derived here remains a foundational reference point.
        </p>
      </div>
    </footer>
  </div>

  <script>
    // Copy buttons: copy plain text from a selector
    (function(){
      function flash(btn){
        btn.classList.add('okflash');
        const prev = btn.textContent;
        btn.textContent = "Copied!";
        setTimeout(()=>{ btn.textContent = prev; btn.classList.remove('okflash'); }, 900);
      }
      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.setAttribute('readonly','');
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          document.body.appendChild(ta);
          ta.select();
          try{
            document.execCommand('copy');
            document.body.removeChild(ta);
            return true;
          }catch(err){
            document.body.removeChild(ta);
            return false;
          }
        }
      }

      document.querySelectorAll('[data-copy]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const sel = btn.getAttribute('data-copy');
          const el = document.querySelector(sel);
          if(!el) return;
          const ok = await copyText(el.textContent.trim());
          if(ok) flash(btn);
        });
      });
    })();

    // Simple static plot: omega0 vs lambda using example values (crisp on high-DPI)
    (function(){
      const canvas = document.getElementById('plot');
      if(!canvas) return;

      function draw(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const rect = canvas.getBoundingClientRect();
        const W = Math.max(300, Math.floor(rect.width));
        const H = Math.max(240, Math.floor(rect.height));
        canvas.width = Math.floor(W * dpr);
        canvas.height = Math.floor(H * dpr);

        const ctx = canvas.getContext('2d');
        ctx.setTransform(dpr,0,0,dpr,0,0);
        ctx.clearRect(0,0,W,H);

        // Plot settings
        const padL = 56, padR = 18, padT = 28, padB = 46;
        const x0 = padL, y0 = H - padB, x1 = W - padR, y1 = padT;
        const pw = x1 - x0, ph = y0 - y1;

        // Example parameters (do not affect symbolic answer)
        const gammaA = 1.76e11; // rad/s/T
        const gammaB = 1.40e11; // rad/s/T
        const MA = 2.0e5; // A/m
        const MB = 3.0e5; // A/m
        const K = Math.abs(gammaA*MB - gammaB*MA); // factor multiplying lambda

        // x range for lambda
        const lamMin = 0.0;
        const lamMax = 8.0e-6; // T*m/A (example range)
        // y range for omega0
        const wMin = 0.0;
        const wMax = K * lamMax;

        function xMap(lam){ return x0 + (lam - lamMin)/(lamMax - lamMin) * pw; }
        function yMap(w){ return y0 - (w - wMin)/(wMax - wMin) * ph; }

        // Background grid
        ctx.lineWidth = 1;
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        ctx.fillStyle = 'rgba(255,255,255,0.85)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';

        const nx = 6, ny = 5;
        for(let i=0;i<=nx;i++){
          const x = x0 + (i/nx)*pw;
          ctx.beginPath(); ctx.moveTo(x,y0); ctx.lineTo(x,y1); ctx.stroke();
        }
        for(let j=0;j<=ny;j++){
          const y = y0 - (j/ny)*ph;
          ctx.beginPath(); ctx.moveTo(x0,y); ctx.lineTo(x1,y); ctx.stroke();
        }

        // Axes
        ctx.strokeStyle = 'rgba(255,255,255,0.38)';
        ctx.lineWidth = 1.5;
        ctx.beginPath();
        ctx.moveTo(x0,y0); ctx.lineTo(x1,y0);
        ctx.moveTo(x0,y0); ctx.lineTo(x0,y1);
        ctx.stroke();

        // Ticks + labels
        ctx.fillStyle = 'rgba(233,238,247,0.92)';
        ctx.strokeStyle = 'rgba(255,255,255,0.38)';
        ctx.lineWidth = 1;

        // x ticks
        for(let i=0;i<=nx;i++){
          const lam = lamMin + (i/nx)*(lamMax-lamMin);
          const x = xMap(lam);
          ctx.beginPath(); ctx.moveTo(x,y0); ctx.lineTo(x,y0+6); ctx.stroke();
          const txt = (lam*1e6).toFixed(1); // micro
          ctx.fillText(txt, x-10, y0+22);
        }
        // y ticks
        for(let j=0;j<=ny;j++){
          const w = wMin + (j/ny)*(wMax-wMin);
          const y = yMap(w);
          ctx.beginPath(); ctx.moveTo(x0,y); ctx.lineTo(x0-6,y); ctx.stroke();
          const txt = (w/1e9).toFixed(1); // GHz-ish in rad/s: label in 1e9 rad/s
          ctx.fillText(txt, x0-42, y+4);
        }

        // Titles
        ctx.font = '14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = 'rgba(233,238,247,0.95)';
        ctx.fillText('Example scaling: ω0 vs λ  (ω0 = |λ(γA|MB| − γB|MA|)|)', x0, 18);

        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = 'rgba(233,238,247,0.90)';
        ctx.fillText('λ (×10⁻⁶ T·m/A)', x0 + pw/2 - 46, H-16);
        ctx.save();
        ctx.translate(16, y1 + ph/2 + 34);
        ctx.rotate(-Math.PI/2);
        ctx.fillText('ω0 (×10⁹ rad/s)', 0, 0);
        ctx.restore();

        // Line: omega0 = K * lambda
        ctx.lineWidth = 2.2;
        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.beginPath();
        const N = 200;
        for(let k=0;k<=N;k++){
          const lam = lamMin + (k/N)*(lamMax-lamMin);
          const w = K * lam;
          const x = xMap(lam);
          const y = yMap(w);
          if(k===0) ctx.moveTo(x,y);
          else ctx.lineTo(x,y);
        }
        ctx.stroke();

        // Legend
        const lx = x0 + 10, ly = y1 + 10;
        ctx.fillStyle = 'rgba(17,27,45,0.70)';
        ctx.strokeStyle = 'rgba(255,255,255,0.12)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.roundRect(lx, ly, 240, 44, 10);
        ctx.fill();
        ctx.stroke();

        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(lx+12, ly+22); ctx.lineTo(lx+44, ly+22);
        ctx.stroke();

        ctx.fillStyle = 'rgba(233,238,247,0.92)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('ω0 = K λ (example constants)', lx+52, ly+26);
      }

      // roundRect polyfill for older contexts
      CanvasRenderingContext2D.prototype.roundRect = CanvasRenderingContext2D.prototype.roundRect || function(x,y,w,h,r){
        const rr = Math.min(r, w/2, h/2);
        this.beginPath();
        this.moveTo(x+rr, y);
        this.arcTo(x+w, y, x+w, y+h, rr);
        this.arcTo(x+w, y+h, x, y+h, rr);
        this.arcTo(x, y+h, x, y, rr);
        this.arcTo(x, y, x+w, y, rr);
        this.closePath();
        return this;
      };

      draw();
      const ro = new ResizeObserver(()=>draw());
      ro.observe(canvas);
      window.addEventListener('deviceorientation', draw, {passive:true});
    })();
  </script>
</body>
</html>