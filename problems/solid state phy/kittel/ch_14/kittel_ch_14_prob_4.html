<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Helicon Waves in a One-Carrier Metal: Dielectric Response and k² Dispersion</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#0f1624;
      --panel2:#0c1320;
      --text:#e7eefc;
      --muted:#b9c6e4;
      --faint:#8ea0c8;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#86efac;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --line2:rgba(125,211,252,.20);
      --shadow: 0 12px 30px rgba(0,0,0,.45);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 10% 10%, rgba(167,139,250,.12), transparent 55%),
        radial-gradient(900px 600px at 90% 20%, rgba(125,211,252,.12), transparent 55%),
        radial-gradient(800px 500px at 40% 90%, rgba(134,239,172,.08), transparent 55%),
        var(--bg);
      line-height:1.6;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:28px 18px 16px;
      border-bottom:1px solid var(--line);
      position:relative;
      overflow:hidden;
    }
    header::after{
      content:"";
      position:absolute; inset:-80px -100px auto -100px;
      height:180px;
      background:linear-gradient(90deg, rgba(125,211,252,.18), rgba(167,139,250,.18), rgba(134,239,172,.14));
      filter:blur(18px);
      opacity:.65;
      transform:skewY(-4deg);
      pointer-events:none;
    }
    .wrap{
      max-width:1180px;
      margin:0 auto;
      padding:0 18px 56px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:18px;
    }
    .hero{
      position:relative;
      max-width:1180px;
      margin:0 auto;
      padding:0 18px 18px;
    }
    .title{
      position:relative;
      z-index:1;
      padding:18px 0 8px;
    }
    h1{
      margin:0;
      font-size: clamp(1.35rem, 2.1vw + .8rem, 2.35rem);
      letter-spacing:.2px;
      line-height:1.15;
    }
    .subtitle{
      margin:.55rem 0 0;
      color:var(--muted);
      max-width:72ch;
    }

    nav.toc{
      position:sticky;
      top:14px;
      align-self:start;
      background:linear-gradient(180deg, rgba(15,22,36,.92), rgba(15,22,36,.78));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(8px);
      transform: translateZ(0);
      animation: pop .45s ease-out both;
    }
    @keyframes pop { from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)} }
    .toc header{
      border:none;
      padding:14px 14px 10px;
      background:linear-gradient(90deg, rgba(125,211,252,.10), rgba(167,139,250,.10));
    }
    .toc header h2{
      margin:0;
      font-size:1rem;
      letter-spacing:.3px;
    }
    .toc .links{
      padding:10px 10px 12px;
      display:grid;
      gap:6px;
    }
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      color:var(--muted);
      border:1px solid transparent;
      background:transparent;
      transition: all .18s ease;
      font-size:.95rem;
    }
    .toc a:hover{
      border-color: var(--line2);
      background: rgba(125,211,252,.06);
      color: var(--text);
      text-decoration:none;
      transform: translateX(2px);
    }
    main{
      min-width:0;
      padding-top:14px;
    }
    section{
      background:linear-gradient(180deg, rgba(15,22,36,.88), rgba(12,19,32,.80));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:18px 16px;
      margin:0 0 16px;
      overflow:hidden;
      position:relative;
    }
    section::before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(700px 240px at 20% 0%, rgba(125,211,252,.07), transparent 60%);
      pointer-events:none;
    }
    h2{
      position:relative;
      margin:0 0 10px;
      font-size:1.25rem;
      letter-spacing:.2px;
    }
    h3{
      position:relative;
      margin:14px 0 6px;
      font-size:1.05rem;
      color: var(--text);
    }
    p, li{color:var(--muted)}
    ul{margin:8px 0 0 1.1rem}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      position:relative;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns:1fr}
      nav.toc{position:relative; top:auto}
      .grid2{grid-template-columns:1fr}
    }

    .card{
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px 12px 10px;
      background: rgba(0,0,0,.16);
      position:relative;
    }
    .callout{
      border-left:4px solid var(--accent);
      background: rgba(125,211,252,.07);
      padding:12px 12px 10px;
      border-radius:14px;
      border:1px solid rgba(125,211,252,.20);
    }
    .callout.warn{border-left-color:var(--warn); background: rgba(251,191,36,.08); border-color: rgba(251,191,36,.22)}
    .callout.ok{border-left-color:var(--ok); background: rgba(134,239,172,.08); border-color: rgba(134,239,172,.22)}
    .callout.bad{border-left-color:var(--bad); background: rgba(251,113,133,.08); border-color: rgba(251,113,133,.22)}
    .kicker{
      font-size:.83rem;
      color:var(--faint);
      letter-spacing:.35px;
      text-transform:uppercase;
      margin:0 0 6px;
    }

    .eq{
      margin:10px 0 8px;
      padding:12px 12px 10px;
      background: rgba(0,0,0,.24);
      border:1px solid var(--line);
      border-radius:14px;
      position:relative;
      overflow:hidden;
    }
    pre{
      margin:0;
      white-space:pre-wrap;
      word-break:break-word;
      font-family:var(--mono);
      font-size:.95rem;
      color: var(--text);
      line-height:1.45;
    }
    .btnrow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:10px;
      position:relative;
    }
    button.copy{
      border:1px solid var(--line2);
      background: rgba(125,211,252,.10);
      color: var(--text);
      padding:8px 10px;
      border-radius:12px;
      cursor:pointer;
      transition: transform .14s ease, background .14s ease;
      font-size:.92rem;
    }
    button.copy:hover{transform: translateY(-1px); background: rgba(125,211,252,.16)}
    button.copy:active{transform: translateY(0px)}
    .small{font-size:.95rem; color:var(--muted)}
    details{
      border:1px solid var(--line);
      border-radius:16px;
      padding:10px 12px;
      background: rgba(0,0,0,.14);
      margin:10px 0 0;
    }
    summary{
      cursor:pointer;
      color:var(--text);
      font-weight:600;
    }
    .backtop{
      display:inline-block;
      margin-top:10px;
      padding:7px 10px;
      border-radius:12px;
      border:1px solid var(--line2);
      background: rgba(167,139,250,.10);
      color:var(--text);
      transition: transform .14s ease, background .14s ease;
    }
    .backtop:hover{transform: translateY(-1px); background: rgba(167,139,250,.16); text-decoration:none}
    figure{
      margin:12px 0 0;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.16);
      position:relative;
      overflow:hidden;
    }
    figcaption{
      margin-top:8px;
      color:var(--faint);
      font-size:.92rem;
    }
    canvas{width:100%; height:320px; display:block; border-radius:12px; border:1px solid rgba(255,255,255,.10); background: rgba(0,0,0,.22)}
    footer{
      max-width:1180px;
      margin:0 auto;
      padding:18px;
      color:var(--faint);
      border-top:1px solid var(--line);
      font-size:.95rem;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, nav.toc, .backtop, button.copy{display:none !important}
      section{box-shadow:none; background:#fff; border:1px solid #ddd}
      p, li{color:#111}
      pre{color:#000}
      a{color:#000; text-decoration:underline}
      section{break-inside:avoid; page-break-inside:avoid}
      h2{page-break-after:avoid}
    }
  </style>
</head>

<body>
  <a id="top"></a>
  <header>
    <div class="hero">
      <div class="title">
        <h1>Helicon Waves (One-Carrier Case): Dielectric Response, Circular Modes, and the k² Dispersion</h1>
        <p class="subtitle">
          A physics-tutor style derivation (with mathematical-physics rigor and an applied/industrial lens) of the classic
          helicon-wave dispersion in a conductor placed in a strong static magnetic field, in the low-frequency regime
          ω ≪ ω<sub>h</sub>.
        </p>
      </div>
    </div>
  </header>

  <div class="wrap">
    <nav class="toc" aria-label="Table of contents">
      <header>
        <h2>Table of Contents</h2>
      </header>
      <div class="links">
        <a href="#qs">Quick Summary</a>
        <a href="#p0">PART 0 — Concept Primer</a>
        <a href="#p0b">PART 0B — Industry & Applied Physics Perspective</a>
        <a href="#p1">PART 1 — Problem Analysis</a>
        <a href="#p2">PART 2 — Strategy & Tips</a>
        <a href="#p3">PART 3 — Full Solution</a>
        <a href="#p4">PART 4 — Deeper Understanding</a>
        <a href="#p5">PART 5 — Optional Plot Guide</a>
      </div>
    </nav>

    <main>
      <section id="qs">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this problem is about:</strong> Helicon waves (low-frequency electromagnetic waves) in a conductor with a static magnetic field, for a <em>single</em> carrier type (holes) of concentration <em>p</em>.</li>
          <li><strong>Key physics idea:</strong> In a magnetic field, the conductivity becomes a tensor; the medium supports <em>circularly polarized eigenmodes</em> (±), each with its own effective dielectric response.</li>
          <li><strong>Governing model:</strong> Maxwell’s equations + Drude/Hall equation of motion for carriers; use Fourier plane waves and circular basis to diagonalize the tensor.</li>
          <li><strong>Low-frequency regime:</strong> ω ≪ ω<sub>h</sub> (cyclotron frequency of holes). This makes the Hall response dominate and yields a very large |ε<sub>+</sub>|, allowing the “1” term in ε to be neglected.</li>
          <li><strong>Result (symbolic):</strong> Effective dielectric (for the + circular mode) in cgs:
            <span class="small">ε<sub>+</sub> ≈ − ω<sub>p</sub><sup>2</sup> /(ω ω<sub>h</sub>)</span>,
            hence <span class="small">D<sup>(+)</sup> = ε<sub>+</sub> E<sup>(+)</sup> ≈ −(4πe<sup>2</sup>p)/(m<sub>h</sub> ω ω<sub>h</sub>) E<sup>(+)</sup></span>.</li>
          <li><strong>Helicon dispersion (cgs):</strong> ω = (B c / (4π e p)) k² (sign depends on carrier charge / polarization convention).</li>
          <li><strong>Numerical estimate (sodium metal, example):</strong> For k = 1 cm<sup>−1</sup>, B = 1000 G, and p ≈ 2.5×10<sup>22</sup> cm<sup>−3</sup>, |ω| ≈ 0.20 s<sup>−1</sup> ⇒ f ≈ 0.031 Hz (very low).</li>
          <li><strong>Physical meaning:</strong> The wave is “guided” by the Hall current; the k² law is a hallmark of helicons (akin to whistler waves in plasmas).</li>
        </ul>

        <div class="callout ok">
          <div class="kicker">Key equations (copyable)</div>
          <div class="eq" data-copy="eq1">
<pre id="eq1">ω_h = eB/(m_h c)      (cgs cyclotron frequency for holes, magnitude)
ω_p^2 = 4π e^2 p / m_h (cgs plasma frequency squared)

ε_+(ω) = 1 − ω_p^2 / [ω(ω + ω_h)]  ≈  − ω_p^2/(ω ω_h)   for ω ≪ ω_h

D^(+) = ε_+ E^(+) ≈ − (4π e^2 p)/(m_h ω ω_h) E^(+)

Helicon dispersion (cgs):
ω = (B c)/(4π e p) * k^2   (sign set by polarization + carrier charge convention)</pre>
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq1">Copy key equations</button>
          </div>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="p0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <article class="card">
            <p class="kicker">Core definitions (symbols & units)</p>
            <ul>
              <li><strong>B</strong>: static magnetic field (cgs: gauss, G).</li>
              <li><strong>p</strong>: hole concentration (cm<sup>−3</sup> in cgs usage).</li>
              <li><strong>m<sub>h</sub></strong>: effective hole mass (g in cgs).</li>
              <li><strong>e</strong>: elementary charge magnitude (statC in cgs; treat as positive magnitude here).</li>
              <li><strong>c</strong>: speed of light (cm/s in cgs).</li>
              <li><strong>ω</strong>: angular frequency (s<sup>−1</sup>).</li>
              <li><strong>k</strong>: wavenumber magnitude (cm<sup>−1</sup> in cgs).</li>
              <li><strong>ω<sub>h</sub></strong>: cyclotron frequency magnitude for holes:
                <span class="small">ω<sub>h</sub> = eB/(m<sub>h</sub>c)</span>.</li>
              <li><strong>ω<sub>p</sub></strong>: (hole) plasma frequency:
                <span class="small">ω<sub>p</sub><sup>2</sup> = 4πe<sup>2</sup>p/m<sub>h</sub></span>.</li>
            </ul>
          </article>

          <article class="card">
            <p class="kicker">Physical meaning (intuition)</p>
            <ul>
              <li>In a conductor, an electric field drives carrier motion → current <strong>j</strong>.</li>
              <li>With a magnetic field, carriers feel Lorentz force ∝ <strong>v × B</strong>, turning the response sideways (Hall effect).</li>
              <li>The medium becomes <strong>gyrotropic</strong>: right/left circular polarizations are natural eigenmodes.</li>
              <li>Helicon waves are low-frequency EM waves where the restoring “force” is mainly the Hall current rather than displacement current.</li>
            </ul>
          </article>
        </div>

        <h3>Key laws/principles and validity conditions</h3>
        <div class="callout">
          <ul>
            <li><strong>Maxwell (cgs):</strong>
              <span class="small">∇×E = −(1/c) ∂B/∂t</span>,&nbsp;
              <span class="small">∇×B = (4π/c) j + (1/c) ∂D/∂t</span>,&nbsp;
              and (typically) <span class="small">∇·B=0</span>, <span class="small">∇·D=4πρ</span>.</li>
            <li><strong>Linear material response:</strong> Use <span class="small">D = ε·E</span>, where ε is a tensor in a magnetized conductor.</li>
            <li><strong>One-carrier Drude/Hall dynamics (collisionless idealization here):</strong> (in frequency domain)
              <span class="small">−iω m_h v = e(E + (v×B)/c)</span> for holes (charge +e).</li>
            <li><strong>Regime:</strong> ω ≪ ω<sub>h</sub> and long wavelengths in a good conductor so that the “1” in ε can be neglected relative to the large Hall/plasma term.</li>
          </ul>
        </div>

        <h3>Common models/approximations and why they’re used</h3>
        <ul>
          <li><strong>Plane-wave ansatz</strong> E, B ∝ exp[i(k·r − ωt)] turns PDEs into algebraic equations (Fourier method).</li>
          <li><strong>Circular basis</strong> (E<sub>±</sub> = E<sub>x</sub> ± iE<sub>y</sub>) diagonalizes gyrotropic tensors (symmetry under rotations about B).</li>
          <li><strong>Low-frequency asymptotic</strong> ω/ω<sub>h</sub> ≪ 1 simplifies ε<sub>+</sub> dramatically, yielding the helicon k² law.</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li><strong>Without B:</strong> conductor supports strongly damped EM waves (skin effect); no preferred handedness.</li>
          <li><strong>With B:</strong> Hall currents can transport energy in a rotating fashion; circular polarization becomes “easy”.</li>
          <li><strong>Why k²?</strong> The wave equation mixes ∇× and the Hall-driven constitutive law; after eliminating fields, ω scales like k² (diffusion-like scaling but for a propagating rotating mode).</li>
        </ul>

        <div class="callout warn">
          <p class="kicker">What to watch for (pitfalls)</p>
          <ul>
            <li><strong>Sign conventions:</strong> Using e as a magnitude vs signed charge changes the sign of ω for a chosen circular polarization.</li>
            <li><strong>cgs vs SI:</strong> Factors of 4π and c differ. This problem’s final dispersion is explicitly in <strong>cgs</strong>.</li>
            <li><strong>Neglecting “1” in ε:</strong> Only valid if |ω<sub>p</sub><sup>2</sup>/(ω ω<sub>h</sub>)| ≫ 1.</li>
            <li><strong>Geometry:</strong> Standard helicon derivation assumes propagation along B (k ∥ B); otherwise mode structure is more complicated.</li>
          </ul>
        </div>

        <div class="callout ok">
          <p class="kicker">Math Insight</p>
          <p class="small">
            In Fourier space, Maxwell + constitutive relations form a <strong>linear eigenvalue problem</strong> for the field polarization:
            a matrix M(k,ω) acting on E equals zero. Nontrivial solutions require det M = 0, which is precisely the <strong>dispersion relation</strong>.
            Choosing a circular basis reduces M to blocks (symmetry/diagonalization), making det M easy to evaluate.
          </p>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="p0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <div class="grid2">
          <article class="card">
            <p class="kicker">Where this appears (applications)</p>
            <ul>
              <li><strong>Magneto-transport characterization</strong> of metals/semimetals: extracting carrier density and mobility from Hall-dominated wave propagation.</li>
              <li><strong>Non-destructive evaluation (NDE)</strong> in conductive components under magnetic bias: helicon-like modes relate to how currents and fields penetrate materials.</li>
              <li><strong>RF and microwave devices in magnetic fields</strong> (gyrotropic media): circular modes and handedness are central in isolators/circulators (conceptually similar math, different materials).</li>
              <li><strong>Plasma/space physics crossover</strong>: helicon sources (in plasmas) and whistler-like dispersions share the same mathematical structure (Hall term dominance).</li>
            </ul>
          </article>
          <article class="card">
            <p class="kicker">Why engineers care</p>
            <ul>
              <li><strong>Performance:</strong> Hall-dominated transport controls losses, signal penetration, and mode conversion in magnetized conductors.</li>
              <li><strong>Reliability:</strong> Strong magnetic fields + currents can cause heating and electromigration; understanding current pathways matters.</li>
              <li><strong>Cost/validation:</strong> Dispersion-based diagnostics can infer material parameters without destructive sampling.</li>
              <li><strong>Manufacturability:</strong> Real devices have finite geometry; boundary conditions can shift mode spectra (important for tolerances).</li>
            </ul>
          </article>
        </div>

        <h3>Typical measurement/validation methods</h3>
        <ul>
          <li><strong>RF coil excitation + pickup</strong> in a magnetic field to detect phase velocity/attenuation vs frequency.</li>
          <li><strong>Hall and magnetoresistance measurements</strong> to cross-check p, m*, and scattering time τ used in models.</li>
          <li><strong>Impedance spectroscopy</strong> in magnetized samples to probe tensor conductivity elements.</li>
        </ul>

        <h3>Design trade-offs and constraints</h3>
        <div class="callout">
          <ul>
            <li><strong>Finite-size effects:</strong> Helicon modes can become waveguide-like; boundaries enforce discrete k⊥ and alter dispersion.</li>
            <li><strong>Losses (collisions):</strong> A finite τ introduces damping and can spoil clean k² scaling at very low ω.</li>
            <li><strong>Material non-idealities:</strong> Multiple carrier types, anisotropic masses, and inhomogeneous p(r) complicate ε(ω).</li>
            <li><strong>Magnetic-field limits:</strong> Industrial magnets have tolerances and gradients; dispersion depends linearly on B.</li>
          </ul>
        </div>

        <details>
          <summary>From lab to product: how the idealized model is adapted</summary>
          <p class="small">
            In products, you rarely have an infinite homogeneous medium. Engineers replace plane waves by
            waveguide/finite-element eigenmodes with boundary conditions (surface impedance, finite conductivity),
            and include damping via τ (complex ε). The core “Hall-driven circular mode” physics remains, but the
            dispersion becomes geometry- and loss-dependent.
          </p>
        </details>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="p1">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <h3>Problem restatement (in plain words)</h3>
        <p>
          We have a conducting specimen with only one type of mobile carrier (holes) of concentration p. A static magnetic
          field B is applied. In the low-frequency limit ω ≪ ω<sub>h</sub> = eB/(m<sub>h</sub>c), we must:
        </p>
        <ol>
          <li class="small">
            Show that for the + circularly polarized mode, the displacement-field response is dominated by a term giving
            D<sup>(+)</sup> proportional to 4πe²p/(m<sub>h</sub> ω ω<sub>h</sub>) (with the “1” term in ε neglected).
          </li>
          <li class="small">
            Show the dispersion becomes the helicon law: ω = (Bc/(4πep)) k² (cgs).
          </li>
          <li class="small">
            For k = 1 cm<sup>−1</sup> and B = 1000 G, estimate the helicon frequency in sodium metal and interpret the sign.
          </li>
        </ol>

        <div class="grid2">
          <article class="card">
            <p class="kicker">Given</p>
            <ul>
              <li>One carrier type: holes (+e), density p.</li>
              <li>Static B (take B along +z).</li>
              <li>Low-frequency limit ω ≪ ω<sub>h</sub>.</li>
              <li>Target wavenumber k and field B for numeric estimate.</li>
            </ul>
          </article>
          <article class="card">
            <p class="kicker">Unknowns / to be found</p>
            <ul>
              <li>Effective dielectric response for circular polarization (+ mode).</li>
              <li>Dispersion relation ω(k).</li>
              <li>Numerical ω and f = ω/(2π) for sodium.</li>
            </ul>
          </article>
        </div>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>Carrier equation of motion</strong> (Drude/Hall, collisionless for this derivation): needed to relate j to E in presence of B.</li>
          <li><strong>Maxwell’s curl equations</strong>: needed to connect E, B, and j into a wave equation and extract dispersion.</li>
          <li><strong>Rotational symmetry about B</strong>: motivates using circular polarization to diagonalize the response tensor.</li>
        </ul>

        <div class="callout warn">
          <p class="kicker">Assumptions (explicit)</p>
          <ul>
            <li>Homogeneous, isotropic (aside from B) medium; one carrier type; linear response.</li>
            <li>Propagation chosen along the magnetic field: <strong>k ∥ B</strong> (standard helicon setup).</li>
            <li>Neglect collisions (or treat them as small enough not to change leading dispersion in the stated limit).</li>
            <li>Low-frequency asymptotic ω/ω<sub>h</sub> ≪ 1, and |ε<sub>+</sub>| ≫ 1 so the “1” in ε<sub>+</sub> can be dropped.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <div class="grid2">
          <article class="card">
            <h3 style="margin-top:0">Approach A: Conductivity tensor → dielectric tensor → wave equation</h3>
            <ul>
              <li><strong>Pros:</strong> Clean linear-algebra route; naturally yields ε<sub>±</sub>.</li>
              <li><strong>Cons:</strong> Must be careful with cgs factors and sign conventions.</li>
            </ul>
          </article>
          <article class="card">
            <h3 style="margin-top:0">Approach B: Directly eliminate v and j in Maxwell equations (Hall-MHD-like)</h3>
            <ul>
              <li><strong>Pros:</strong> Intuitive: Hall current as restoring mechanism.</li>
              <li><strong>Cons:</strong> More algebra; easier to lose polarization structure.</li>
            </ul>
          </article>
        </div>

        <p>
          We will use <strong>Approach A</strong> because the problem explicitly references circularly polarized modes and
          a dielectric response D<sup>(+)</sup>.
        </p>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="p2">
        <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

        <ol>
          <li class="small"><strong>Set coordinates:</strong> choose B = B ẑ, propagation k = k ẑ. (Uses symmetry.)</li>
          <li class="small"><strong>Write the carrier equation of motion</strong> in frequency domain: −iω m v = e(E + v×B/c).</li>
          <li class="small"><strong>Solve for v(E)</strong> in the x–y plane; identify circular combinations v<sub>±</sub>, E<sub>±</sub>.</li>
          <li class="small"><strong>Compute current:</strong> j = e p v (holes). This gives σ<sub>±</sub>(ω).</li>
          <li class="small"><strong>Convert σ to ε:</strong> in cgs, ε(ω) = 1 + (4π i/ω) σ(ω). Obtain ε<sub>±</sub>.</li>
          <li class="small"><strong>Apply low-ω limit:</strong> ω ≪ ω<sub>h</sub> to simplify ε<sub>+</sub> and justify neglecting “1”.</li>
          <li class="small"><strong>Wave equation:</strong> for k ∥ ẑ and transverse E, use k² = (ω²/c²) ε<sub>+</sub>.</li>
          <li class="small"><strong>Solve for ω(k):</strong> get ω ∝ k² with the stated prefactor.</li>
          <li class="small"><strong>Estimate for sodium:</strong> pick p ≈ atomic density (one conduction electron per atom), plug numbers, compute f.</li>
          <li class="small"><strong>Interpret sign:</strong> connect to handedness of circular polarization and carrier charge.</li>
        </ol>

        <div class="callout bad">
          <p class="kicker">Common mistakes</p>
          <ul>
            <li>Mixing SI and cgs (missing 4π or c in ω<sub>h</sub>).</li>
            <li>Forgetting that ε = 1 + (4π i/ω)σ in cgs, not ε = 1 + iσ/(ε0 ω) (SI).</li>
            <li>Dropping the wrong term in ε: you drop “1” only after showing |ω<sub>p</sub><sup>2</sup>/(ω ω<sub>h</sub>)| ≫ 1.</li>
            <li>Using k not parallel to B (then circular modes are not that simple).</li>
          </ul>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="p3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation (before math)</h3>
        <p>
          In the ω ≪ ω<sub>h</sub> regime, the magnetic field strongly bends carrier motion. A transverse electric field produces
          a large sideways (Hall) current, and the system prefers circularly rotating fields (eigenmodes). Because this Hall-driven
          response is strong, the effective dielectric function for one circular polarization becomes very large in magnitude and scales like
          1/(ω), which then forces the wave dispersion to scale like ω ∝ k².
        </p>

        <div class="callout">
          <p class="kicker">Mathematical model (variables, domain, operators)</p>
          <ul>
            <li>Spatial domain: uniform bulk conductor (idealized infinite medium).</li>
            <li>Coordinates: choose B = B ẑ, and consider waves propagating along z: k = k ẑ.</li>
            <li>Fields: E(r,t), B(r,t), D(r,t), current j(r,t).</li>
            <li>PDEs (Maxwell, cgs):</li>
          </ul>
          <div class="eq" data-copy="eq_model">
<pre id="eq_model">∇×E = -(1/c) ∂B/∂t
∇×B = (4π/c) j + (1/c) ∂D/∂t
D = ε·E   (tensor ε due to magnetic field)
Plane wave ansatz: E(r,t)=Re{E0 e^{i(k·r-ωt)}}, similarly for B</pre>
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq_model">Copy model equations</button>
          </div>
        </div>

        <h3>Step 1: Carrier dynamics in frequency domain</h3>
        <p>
          For holes (charge +e), neglecting collisions, the linearized equation of motion is:
        </p>
        <div class="eq" data-copy="eq_motion">
<pre id="eq_motion">m_h dv/dt = e ( E + (v×B)/c )

Assume time dependence e^{-iωt}:
-iω m_h v = e ( E + (v×B)/c )</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_motion">Copy equation of motion</button>
        </div>

        <p>
          Because k ∥ B ∥ ẑ, helicon modes are transverse (E has x–y components, E·k = 0). We therefore focus on the x–y plane.
          Write B = B ẑ and v = (v_x, v_y, 0). Then
          v×B = (v_x, v_y, 0)×(0,0,B) = (v_y B, −v_x B, 0).
        </p>

        <h3>Step 2: Solve for v in components (no “magic jumps”)</h3>
        <p>Component equations:</p>
        <div class="eq" data-copy="eq_components">
<pre id="eq_components">-iω m_h v_x = e ( E_x + (B/c) v_y )
-iω m_h v_y = e ( E_y - (B/c) v_x )</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_components">Copy component system</button>
        </div>

        <p>
          Define the hole cyclotron frequency (magnitude) in cgs:
        </p>
        <div class="eq" data-copy="eq_omega_h">
<pre id="eq_omega_h">ω_h = eB/(m_h c)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_omega_h">Copy ω_h</button>
        </div>

        <p>
          Divide the component equations by m<sub>h</sub> and use ω<sub>h</sub>:
        </p>
        <div class="eq" data-copy="eq_components2">
<pre id="eq_components2">-iω v_x = (e/m_h) E_x + ω_h v_y
-iω v_y = (e/m_h) E_y - ω_h v_x</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_components2">Copy rewritten system</button>
        </div>

        <h3>Step 3: Diagonalize using circular polarization (symmetry argument)</h3>
        <p>
          Because the system is invariant under rotations about z, it is natural to use eigenvectors of rotation:
          right/left circular components. Define
        </p>
        <div class="eq" data-copy="eq_circ_defs">
<pre id="eq_circ_defs">E_± = E_x ± i E_y
v_± = v_x ± i v_y</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_circ_defs">Copy circular definitions</button>
        </div>

        <p>
          To combine the component equations, take (first) ± i×(second). Start with v<sub>+</sub>:
        </p>

        <div class="eq" data-copy="eq_diag">
<pre id="eq_diag">From:
-iω v_x = (e/m_h) E_x + ω_h v_y
-iω v_y = (e/m_h) E_y - ω_h v_x

Compute v_+ = v_x + i v_y:
-iω (v_x + i v_y)
= (e/m_h)(E_x + i E_y) + ω_h v_y + i(-ω_h v_x)
= (e/m_h) E_+ + ω_h (v_y - i v_x)
But (v_y - i v_x) = -i (v_x + i v_y) = -i v_+

So:
-iω v_+ = (e/m_h) E_+  - i ω_h v_+

⇒ -i(ω - ω_h) v_+ = (e/m_h) E_+

⇒ v_+ = (e/m_h) * E_+ / [-i(ω - ω_h)]</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_diag">Copy diagonalization steps</button>
        </div>

        <p>
          Similarly, for v<sub>−</sub> you get:
        </p>
        <div class="eq" data-copy="eq_vminus">
<pre id="eq_vminus">v_- = (e/m_h) * E_- / [-i(ω + ω_h)]</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_vminus">Copy v_- relation</button>
        </div>

        <div class="callout ok">
          <p class="kicker">Why this step is valid (math justification)</p>
          <p class="small">
            The x–y linear system has constant coefficients and is invariant under rotations about ẑ. The circular basis vectors
            are eigenvectors of the rotation operator, so they diagonalize any linear response tensor built from δ<sub>ij</sub> and ε<sub>ijk</sub>B<sub>k</sub>.
            Algebraically, we formed linear combinations that eliminate cross-coupling between x and y, yielding two scalar equations.
          </p>
        </div>

        <h3>Step 4: Current and conductivity eigenvalues</h3>
        <p>
          For holes, current density is j = e p v, so the circular components satisfy
          j<sub>±</sub> = e p v<sub>±</sub> = σ<sub>±</sub> E<sub>±</sub>.
          Hence:
        </p>
        <div class="eq" data-copy="eq_sigma">
<pre id="eq_sigma">σ_+ = e p * (e/m_h) / [-i(ω - ω_h)] = (e^2 p / m_h) * i / (ω - ω_h)
σ_- = (e^2 p / m_h) * i / (ω + ω_h)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_sigma">Copy σ_±</button>
        </div>

        <h3>Step 5: Convert conductivity to dielectric response (cgs)</h3>
        <p>
          In cgs (Gaussian) units, the relation between dielectric function and conductivity is
        </p>
        <div class="eq" data-copy="eq_eps_sigma">
<pre id="eq_eps_sigma">ε(ω) = 1 + (4π i / ω) σ(ω)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_eps_sigma">Copy ε–σ relation</button>
        </div>

        <p>
          Apply this to each circular eigenvalue:
        </p>
        <div class="eq" data-copy="eq_eps_pm">
<pre id="eq_eps_pm">ε_+ = 1 + (4π i/ω) σ_+
    = 1 + (4π i/ω) * (e^2 p/m_h) * i/(ω - ω_h)
    = 1 - (4π e^2 p/m_h) * 1/[ω(ω - ω_h)]

ε_- = 1 - (4π e^2 p/m_h) * 1/[ω(ω + ω_h)]</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_eps_pm">Copy ε_± derivation</button>
        </div>

        <p>
          Introduce the plasma frequency (cgs):
        </p>
        <div class="eq" data-copy="eq_omega_p">
<pre id="eq_omega_p">ω_p^2 = 4π e^2 p / m_h</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_omega_p">Copy ω_p</button>
        </div>

        <p>
          Then
        </p>
        <div class="eq" data-copy="eq_eps_compact">
<pre id="eq_eps_compact">ε_+ = 1 - ω_p^2 / [ω(ω - ω_h)]
ε_- = 1 - ω_p^2 / [ω(ω + ω_h)]</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_eps_compact">Copy compact ε_±</button>
        </div>

        <h3>Step 6: Low-frequency limit ω ≪ ω<sub>h</sub> and the requested D<sup>(+)</sup></h3>
        <p>
          For ω ≪ ω<sub>h</sub>, expand (ω − ω<sub>h</sub>) ≈ −ω<sub>h</sub>. This is a controlled asymptotic:
          ω/ω<sub>h</sub> is the small parameter. Therefore
        </p>
        <div class="eq" data-copy="eq_lowomega">
<pre id="eq_lowomega">ε_+ = 1 - ω_p^2 / [ω(ω - ω_h)]
    ≈ 1 - ω_p^2 / [ω(-ω_h)]
    = 1 + ω_p^2/(ω ω_h)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_lowomega">Copy low-ω expansion</button>
        </div>

        <p>
          The problem statement says: “The term in ε has been neglected.” That refers to dropping the additive “1” compared to the large term
          ω<sub>p</sub><sup>2</sup>/(ω ω<sub>h</sub>). Mathematically, we require
        </p>
        <div class="eq" data-copy="eq_drop1">
<pre id="eq_drop1">|ω_p^2/(ω ω_h)| ≫ 1  ⇒  ε_+ ≈ ω_p^2/(ω ω_h)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_drop1">Copy neglect condition</button>
        </div>

        <p>
          Then the displacement field for the + circular mode is
        </p>
        <div class="eq" data-copy="eq_Dplus">
<pre id="eq_Dplus">D^(+) = ε_+ E^(+) ≈ (ω_p^2/(ω ω_h)) E^(+)
      = (4π e^2 p / m_h) * (1/(ω ω_h)) * E^(+)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_Dplus">Copy D^(+) result</button>
        </div>

        <p>
          This matches the requested magnitude form. (Depending on polarization and sign conventions used in the source text, a minus sign
          may appear; the key scaling is the same and the dispersion sign is discussed below.)
        </p>

        <details>
          <summary>Connection to the “E×B drift” form (the (ε0 vE)/ω style)</summary>
          <p class="small">
            Using ω<sub>h</sub> = eB/(m<sub>h</sub>c), the prefactor becomes:
            (4π e² p)/(m<sub>h</sub> ω ω<sub>h</sub>) = (4π e² p)/(m<sub>h</sub> ω) · (m<sub>h</sub>c/(eB))
            = (4π e p c)/(B ω).
            Many texts rewrite this using the E×B drift speed v<sub>E</sub> = c|E|/B and/or a characteristic charge density factor; the key point is the same:
            the effective response is enhanced by c/B and scales like 1/ω.
          </p>
        </details>

        <h3>Step 7: Derive the helicon dispersion relation</h3>
        <p>
          For propagation along z, a transverse plane wave satisfies the standard relation (in an isotropic medium) but now with the
          polarization-dependent ε<sub>+</sub>:
        </p>
        <div class="eq" data-copy="eq_wave">
<pre id="eq_wave">For k ∥ ẑ and transverse E:
k^2 = (ω^2/c^2) ε_+    (for the + eigenmode)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_wave">Copy wave relation</button>
        </div>

        <p>
          Substitute the low-frequency ε<sub>+</sub> ≈ ω<sub>p</sub><sup>2</sup>/(ω ω<sub>h</sub>):
        </p>
        <div class="eq" data-copy="eq_disp_steps">
<pre id="eq_disp_steps">k^2 = (ω^2/c^2) * (ω_p^2/(ω ω_h))
    = (ω/c^2) * (ω_p^2/ω_h)

Solve for ω:
ω = (c^2 k^2) * (ω_h/ω_p^2)</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_disp_steps">Copy dispersion steps</button>
        </div>

        <p>
          Now insert ω<sub>h</sub> = eB/(m<sub>h</sub>c) and ω<sub>p</sub><sup>2</sup> = 4πe<sup>2</sup>p/m<sub>h</sub>:
        </p>
        <div class="eq" data-copy="eq_disp_final">
<pre id="eq_disp_final">ω = c^2 k^2 * [ (eB/(m_h c)) / (4π e^2 p/m_h) ]
  = c^2 k^2 * [ eB/(c) ] * [ 1/(4π e^2 p) ]
  = (B c)/(4π e p) * k^2</pre>
        </div>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq_disp_final">Copy final dispersion</button>
        </div>

        <div class="callout ok">
          <p class="kicker">Final Answer (boxed)</p>
          <div class="eq" data-copy="final_ans">
<pre id="final_ans">Part (a), cgs (one carrier: holes):
ε_+(ω) = 1 − ω_p^2/[ω(ω − ω_h)]  ≈  ω_p^2/(ω ω_h)   for ω ≪ ω_h and |ω_p^2/(ω ω_h)| ≫ 1

Thus:
D^(+) = ε_+ E^(+) ≈ (4π e^2 p)/(m_h ω ω_h) · E^(+)

Part (b), helicon dispersion (cgs):
ω = (B c)/(4π e p) · k^2    (the sign depends on carrier charge / circular polarization convention)

Numerical estimate (sodium metal, example):
Take p ≈ 2.5×10^22 cm^−3, B=1000 G, k=1 cm^−1:
|ω| ≈ 0.20 s^−1  ⇒  f = |ω|/(2π) ≈ 0.031 Hz
(The frequency can be negative; its sign labels the rotation sense of the circularly polarized mode.)</pre>
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-target="final_ans">Copy final answer</button>
          </div>
        </div>

        <h3>Sanity checks</h3>
        <div class="grid2">
          <article class="card">
            <h3 style="margin-top:0">1) Dimensional analysis (cgs)</h3>
            <p class="small">
              In ω = (Bc/(4π e p))k²: B has units that combine with e and p to make (Bc/(e p)) have dimensions of
              (length²/time). Multiplying by k² (1/length²) yields 1/time, as required for ω.
            </p>
          </article>
          <article class="card">
            <h3 style="margin-top:0">2) Limiting cases</h3>
            <ul>
              <li class="small">B → 0 ⇒ ω → 0: no helicon propagation without magnetic-field-induced Hall response.</li>
              <li class="small">p ↑ ⇒ ω ↓: more carriers make Hall-driven rotation “heavier,” lowering ω at fixed k.</li>
              <li class="small">k ↑ ⇒ ω grows like k²: hallmark helicon behavior.</li>
            </ul>
          </article>
        </div>

        <div class="callout warn">
          <p class="kicker">Sign of ω (direction reasoning)</p>
          <p class="small">
            In many texts, the dispersion is written ω = (Bc/(4π n q))k² with q the signed carrier charge.
            For electrons (q = −e), ω is negative for a fixed polarization convention; for holes (q = +e) it is positive.
            The problem statement notes a “negative frequency”: that is a bookkeeping device indicating the <em>handedness</em>
            (sense of rotation) of the circularly polarized mode, not a negative energy.
          </p>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="p4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpreting the final formula</h3>
        <ul>
          <li><strong>Linear in B:</strong> the stronger the magnetization, the stronger the Hall coupling, hence faster rotation/propagation.</li>
          <li><strong>Inverse in p:</strong> more carriers dilute the Hall-induced rotational response per carrier, reducing ω.</li>
          <li><strong>Quadratic in k:</strong> shorter wavelengths require stronger spatial curl (∇×), which couples to Hall current to set ω.</li>
        </ul>

        <h3>Parameter dependence (qualitative + quantitative)</h3>
        <div class="callout">
          <ul>
            <li><strong>Doubling B</strong> doubles ω at fixed k, p.</li>
            <li><strong>Doubling k</strong> increases ω by 4× (because ω ∝ k²).</li>
            <li><strong>Doubling p</strong> halves ω (ω ∝ 1/p).</li>
          </ul>
        </div>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <details>
          <summary>Hall-MHD style elimination (concept sketch)</summary>
          <p class="small">
            Start from j = σ·E (Hall tensor) and Maxwell. In the helicon regime, the displacement current is negligible compared to conduction/Hall current,
            so ∇×B ≈ (4π/c)j. Combine with Faraday’s law (∇×E = −(1/c)∂B/∂t) and the Hall relation (E ≈ (1/(epc)) j×B in the strong-field limit).
            Eliminating E and j yields a closed evolution equation for B resembling ∂B/∂t ∝ ∇×(∇×B), whose Fourier transform gives ω ∝ k².
          </p>
        </details>

        <h3>Concept check (self-test)</h3>
        <ul>
          <li><strong>Q:</strong> Why do circular polarizations decouple when k ∥ B? <strong>A:</strong> Rotational symmetry about B makes the response tensor commute with rotations; circular basis diagonalizes it.</li>
          <li><strong>Q:</strong> What condition justifies dropping the “1” in ε<sub>+</sub>? <strong>A:</strong> |ω<sub>p</sub><sup>2</sup>/(ω ω<sub>h</sub>)| ≫ 1.</li>
          <li><strong>Q:</strong> Why does ω increase with k? <strong>A:</strong> Larger k means stronger spatial curl; Hall coupling converts that into faster temporal rotation (ω ∝ k²).</li>
          <li><strong>Q:</strong> What physical knob lowers ω at fixed k? <strong>A:</strong> Increasing carrier density p.</li>
        </ul>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="p5">
        <h2>PART 5 — Optional Plot Guide</h2>

        <p>
          A plot is useful here because the central qualitative message is <strong>ω grows quadratically with k</strong>.
          Below is a single static plot of ω(k) using <em>example values</em> appropriate to the numeric estimate (sodium-like density, B = 1000 G).
          The final analytic results above remain the primary answer.
        </p>

        <figure>
          <canvas id="plot" aria-label="Plot of helicon dispersion omega vs k"></canvas>
          <figcaption>
            Helicon dispersion example (cgs): ω = (Bc/(4π e p)) k² with B = 1000 G and p = 2.5×10²² cm⁻³ (example).
            Axes: k (cm⁻¹) vs ω (s⁻¹).
          </figcaption>
        </figure>

        <div class="callout">
          <p class="kicker">What to notice</p>
          <ul>
            <li>The curve starts at ω = 0 when k = 0 (no spatial variation ⇒ no wave).</li>
            <li>Quadratic curvature: doubling k quadruples ω.</li>
            <li>The absolute scale is small for typical metallic carrier densities (very low frequency at k ~ 1 cm⁻¹).</li>
          </ul>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>
    </main>
  </div>

  <footer>
    <p>
      Notes: This article used Gaussian cgs conventions because the problem statement requests the helicon dispersion “in CGS.”
      If you want, I can provide the SI translation (with ε<sub>0</sub>, μ<sub>0</sub>) as a compact appendix.
    </p>
  </footer>

  <script>
    // Copy buttons
    function copyTextFromEl(id){
      const el = document.getElementById(id);
      const text = el ? el.innerText : "";
      if(!text) return;
      navigator.clipboard.writeText(text).then(()=>toast("Copied ✓")).catch(()=>toast("Copy failed"));
    }
    function toast(msg){
      const t = document.createElement("div");
      t.textContent = msg;
      t.style.position="fixed";
      t.style.bottom="16px";
      t.style.left="50%";
      t.style.transform="translateX(-50%)";
      t.style.background="rgba(15,22,36,.92)";
      t.style.border="1px solid rgba(125,211,252,.30)";
      t.style.color="#e7eefc";
      t.style.padding="10px 12px";
      t.style.borderRadius="14px";
      t.style.boxShadow="0 12px 30px rgba(0,0,0,.45)";
      t.style.zIndex="9999";
      t.style.fontSize=".95rem";
      t.style.backdropFilter="blur(6px)";
      document.body.appendChild(t);
      setTimeout(()=>{ t.style.opacity="0"; t.style.transition="opacity .25s ease"; }, 900);
      setTimeout(()=>{ t.remove(); }, 1200);
    }
    document.querySelectorAll("button.copy").forEach(btn=>{
      btn.addEventListener("click", ()=> copyTextFromEl(btn.dataset.copyTarget));
    });

    // Plot: omega vs k (single static plot, crisp on high DPI)
    const canvas = document.getElementById("plot");
    const ctx = canvas.getContext("2d");

    function drawPlot(){
      const dpr = window.devicePixelRatio || 1;
      const rect = canvas.getBoundingClientRect();
      const W = Math.max(320, rect.width);
      const H = Math.max(260, rect.height);

      canvas.width = Math.round(W * dpr);
      canvas.height = Math.round(H * dpr);
      canvas.style.width = W + "px";
      canvas.style.height = H + "px";
      ctx.setTransform(dpr,0,0,dpr,0,0);

      // Example parameters (cgs)
      const B = 1000;                 // gauss
      const c = 2.99792458e10;        // cm/s
      const e = 4.80320427e-10;       // statC
      const p = 2.5e22;               // cm^-3 (example sodium-like)
      const A = (B * c) / (4 * Math.PI * e * p); // omega = A k^2

      // Plot ranges
      const kMin = 0, kMax = 4.0; // cm^-1
      function omega(k){ return A * k * k; }
      const wMax = omega(kMax) * 1.12;

      // Layout
      const padL = 56, padR = 16, padT = 34, padB = 46;
      const x0 = padL, y0 = H - padB;
      const x1 = W - padR, y1 = padT;

      function xMap(k){ return x0 + (k - kMin) * (x1 - x0) / (kMax - kMin); }
      function yMap(w){ return y0 - (w - 0) * (y0 - y1) / (wMax - 0); }

      // Background clear
      ctx.clearRect(0,0,W,H);

      // Title
      ctx.fillStyle = "rgba(231,238,252,0.92)";
      ctx.font = "600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("Helicon dispersion example: ω = A k² (cgs)", padL, 20);

      // Gridlines and ticks
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.lineWidth = 1;

      // X grid/ticks
      const xTicks = 5;
      for(let i=0;i<=xTicks;i++){
        const k = kMin + i*(kMax-kMin)/xTicks;
        const x = xMap(k);
        ctx.beginPath();
        ctx.moveTo(x, y0);
        ctx.lineTo(x, y1);
        ctx.stroke();

        ctx.fillStyle = "rgba(185,198,228,0.85)";
        ctx.font = "12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace";
        ctx.fillText(k.toFixed(1), x-10, y0+18);
      }

      // Y grid/ticks
      const yTicks = 5;
      for(let i=0;i<=yTicks;i++){
        const w = i*(wMax)/yTicks;
        const y = yMap(w);
        ctx.beginPath();
        ctx.moveTo(x0, y);
        ctx.lineTo(x1, y);
        ctx.stroke();

        ctx.fillStyle = "rgba(185,198,228,0.85)";
        ctx.font = "12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace";
        ctx.fillText(w.toExponential(2), 6, y+4);
      }

      // Axes
      ctx.strokeStyle = "rgba(125,211,252,0.55)";
      ctx.lineWidth = 1.5;
      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x1, y0);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x0, y1);
      ctx.stroke();

      // Axis labels
      ctx.fillStyle = "rgba(231,238,252,0.92)";
      ctx.font = "600 13px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("k (cm⁻¹)", (x0+x1)/2 - 28, H - 14);

      // y label (rotated)
      ctx.save();
      ctx.translate(16, (y0+y1)/2 + 20);
      ctx.rotate(-Math.PI/2);
      ctx.fillText("ω (s⁻¹)", 0, 0);
      ctx.restore();

      // Curve
      ctx.strokeStyle = "rgba(167,139,250,0.90)";
      ctx.lineWidth = 2.2;
      ctx.beginPath();
      const N = 200;
      for(let i=0;i<=N;i++){
        const k = kMin + i*(kMax-kMin)/N;
        const w = omega(k);
        const x = xMap(k);
        const y = yMap(w);
        if(i===0) ctx.moveTo(x,y);
        else ctx.lineTo(x,y);
      }
      ctx.stroke();

      // Legend
      const lx = x1 - 210, ly = y1 + 8;
      ctx.fillStyle = "rgba(0,0,0,0.35)";
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.lineWidth = 1;
      roundRect(ctx, lx, ly, 200, 44, 10, true, true);

      ctx.strokeStyle = "rgba(167,139,250,0.90)";
      ctx.lineWidth = 2.2;
      ctx.beginPath();
      ctx.moveTo(lx+12, ly+16);
      ctx.lineTo(lx+46, ly+16);
      ctx.stroke();

      ctx.fillStyle = "rgba(231,238,252,0.92)";
      ctx.font = "12.5px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("ω = A k² (example A)", lx+54, ly+20);

      ctx.fillStyle = "rgba(185,198,228,0.85)";
      ctx.font = "12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace";
      ctx.fillText("B=1000 G, p=2.5×10²² cm⁻³", lx+12, ly+36);
    }

    function roundRect(ctx, x, y, w, h, r, fill, stroke) {
      if (typeof r === 'number') r = {tl:r, tr:r, br:r, bl:r};
      ctx.beginPath();
      ctx.moveTo(x + r.tl, y);
      ctx.lineTo(x + w - r.tr, y);
      ctx.quadraticCurveTo(x + w, y, x + w, y + r.tr);
      ctx.lineTo(x + w, y + h - r.br);
      ctx.quadraticCurveTo(x + w, y + h, x + w - r.br, y + h);
      ctx.lineTo(x + r.bl, y + h);
      ctx.quadraticCurveTo(x, y + h, x, y + h - r.bl);
      ctx.lineTo(x, y + r.tl);
      ctx.quadraticCurveTo(x, y, x + r.tl, y);
      ctx.closePath();
      if (fill) ctx.fill();
      if (stroke) ctx.stroke();
    }

    // Redraw on resize (responsive)
    const ro = new ResizeObserver(()=>drawPlot());
    ro.observe(canvas);
    drawPlot();
  </script>
</body>
</html>