<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Surface Plasmons at a Plasma–Vacuum Interface (Electrostatic Derivation)</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#0f1623;
      --panel2:#121c2c;
      --text:#e9eef7;
      --muted:#b6c2d9;
      --faint:#7f90ad;
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }

    html,body{height:100%;}
    body{
      margin:0;
      font-family:var(--sans);
      background:
        radial-gradient(1200px 600px at 15% 15%, rgba(110,231,255,.12), transparent 60%),
        radial-gradient(900px 500px at 85% 25%, rgba(167,139,250,.12), transparent 55%),
        linear-gradient(180deg, #070a10 0%, #0b0f17 40%, #070a10 100%);
      color:var(--text);
      line-height:1.55;
      overflow-x:hidden;
    }

    a{color:var(--accent); text-decoration:none;}
    a:hover{filter:brightness(1.1); text-decoration:underline;}

    header{
      position:relative;
      padding: 34px 18px 20px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.03), transparent);
    }

    .wrap{
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 14px;
    }

    .hero{
      display:grid;
      grid-template-columns: 1.3fr .7fr;
      gap:16px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .hero{grid-template-columns:1fr; }
    }

    h1{
      margin:0 0 8px;
      font-size: clamp(1.65rem, 2.8vw, 2.35rem);
      letter-spacing: .2px;
    }
    .subtitle{
      color:var(--muted);
      margin:0;
      font-size: 1.02rem;
      max-width: 70ch;
    }

    .metaCard{
      background: rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 12px;
      display:flex;
      flex-direction:column;
      gap:10px;
      overflow:hidden;
    }
    .metaRow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.02);
      color: var(--muted);
      font-size: .92rem;
      white-space:nowrap;
    }
    .dot{
      width:9px;height:9px;border-radius:999px;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(110,231,255,.12);
      flex:0 0 auto;
    }
    .dot.purple{background: var(--accent2); box-shadow: 0 0 0 3px rgba(167,139,250,.12);}
    .dot.green{background: var(--ok); box-shadow: 0 0 0 3px rgba(52,211,153,.12);}

    main{
      padding: 18px 0 50px;
    }

    /* Layout: sticky TOC + content */
    .layout{
      display:grid;
      grid-template-columns: 300px 1fr;
      gap: 18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns: 1fr;}
    }

    nav.toc{
      position: sticky;
      top: 12px;
      align-self:start;
      background: rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 12px;
      overflow:hidden;
    }
    @media (max-width: 980px){
      nav.toc{ position:relative; top:auto; }
    }

    .toc h2{
      margin:0 0 6px;
      font-size: 1.05rem;
      color: var(--text);
      letter-spacing:.2px;
    }
    .toc .hint{
      margin:0 0 10px;
      font-size:.9rem;
      color: var(--faint);
    }
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius: 12px;
      color: var(--muted);
      border:1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }
    .toc a:hover{
      background: rgba(110,231,255,.08);
      border-color: rgba(110,231,255,.22);
      transform: translateX(2px);
      text-decoration:none;
      color: var(--text);
    }

    article{
      min-width: 0;
      display:flex;
      flex-direction:column;
      gap: 16px;
    }

    section{
      background: rgba(255,255,255,.03);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
    }

    section h2{
      margin: 0 0 10px;
      font-size: 1.35rem;
      letter-spacing:.2px;
    }
    section h3{
      margin: 14px 0 8px;
      font-size: 1.08rem;
      color: var(--text);
    }
    p{margin: 8px 0; color: var(--muted);}
    ul{margin: 8px 0 8px 22px; color: var(--muted);}
    li{margin:6px 0;}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 860px){
      .grid2{grid-template-columns: 1fr;}
    }

    .card{
      background: rgba(0,0,0,.18);
      border:1px solid var(--line);
      border-radius: var(--radius2);
      padding: 12px;
    }

    .callout{
      border-radius: var(--radius2);
      border:1px solid var(--line);
      padding: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(0,0,0,.12));
      position:relative;
      overflow:hidden;
    }
    .callout::before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(800px 120px at 20% 10%, rgba(110,231,255,.10), transparent 55%);
      pointer-events:none;
    }
    .callout strong{color: var(--text);}
    .labelRow{
      display:flex;
      align-items:center;
      gap:10px;
      margin-bottom:8px;
    }
    .tag{
      font-size: .78rem;
      letter-spacing:.16em;
      text-transform:uppercase;
      color: var(--text);
      background: rgba(110,231,255,.10);
      border:1px solid rgba(110,231,255,.25);
      padding: 3px 8px;
      border-radius: 999px;
      width: fit-content;
    }
    .tag.warn{background: rgba(251,191,36,.10); border-color: rgba(251,191,36,.28);}
    .tag.ok{background: rgba(52,211,153,.10); border-color: rgba(52,211,153,.26);}
    .tag.bad{background: rgba(251,113,133,.10); border-color: rgba(251,113,133,.25);}
    .tag.purple{background: rgba(167,139,250,.10); border-color: rgba(167,139,250,.25);}

    .eq{
      background: rgba(0,0,0,.28);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px 10px 8px;
      overflow:auto;
      position:relative;
    }
    .eq pre{
      margin:0;
      font-family: var(--mono);
      font-size: .95rem;
      line-height: 1.35;
      color: #eaf2ff;
      white-space: pre-wrap;
    }
    .copyBtn{
      position:absolute;
      top:8px;
      right:8px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: var(--text);
      font-size: .85rem;
      padding: 6px 9px;
      border-radius: 12px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .copyBtn:hover{
      background: rgba(110,231,255,.10);
      border-color: rgba(110,231,255,.25);
      transform: translateY(-1px);
    }
    .copyBtn:active{transform: translateY(0);}

    details{
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      padding: 10px 12px;
      background: rgba(0,0,0,.12);
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 600;
    }
    details p, details ul{color: var(--muted);}

    .backTop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:10px;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      width: fit-content;
    }
    .backTop:hover{
      background: rgba(110,231,255,.08);
      border-color: rgba(110,231,255,.22);
      color: var(--text);
      text-decoration:none;
    }

    figure{
      margin: 10px 0 0;
      padding: 12px;
      border-radius: var(--radius2);
      border: 1px solid var(--line);
      background: rgba(0,0,0,.16);
    }
    figcaption{
      margin-top: 8px;
      color: var(--faint);
      font-size: .92rem;
    }
    canvas{width:100%; height:320px; display:block; border-radius: 12px;}

    footer{
      margin-top: 16px;
      color: var(--faint);
      font-size: .92rem;
      padding: 14px 0 30px;
      text-align:center;
    }

    /* micro-animations */
    @media (prefers-reduced-motion: no-preference){
      section{animation: rise .35s ease both;}
      section:nth-child(1){animation-delay:.02s;}
      section:nth-child(2){animation-delay:.04s;}
      section:nth-child(3){animation-delay:.06s;}
      section:nth-child(4){animation-delay:.08s;}
      section:nth-child(5){animation-delay:.10s;}
      section:nth-child(6){animation-delay:.12s;}
      @keyframes rise{
        from{opacity:0; transform: translateY(8px);}
        to{opacity:1; transform: translateY(0);}
      }
    }

    /* print */
    @media print{
      body{background:#fff; color:#000;}
      header, nav.toc{position:static; box-shadow:none;}
      section, .metaCard{box-shadow:none;}
      .copyBtn, .backTop{display:none !important;}
      a{color:#000; text-decoration:underline;}
      section{break-inside:avoid; page-break-inside:avoid;}
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="wrap">
      <div class="hero">
        <div>
          <h1>Surface Plasmons at a Plasma–Vacuum Interface (Electrostatic Derivation)</h1>
          <p class="subtitle">
            We solve a classic boundary-value problem: a semi-infinite plasma for z &gt; 0 touching vacuum for z &lt; 0.
            Using Laplace’s equation and electromagnetic boundary conditions, we obtain the surface-plasmon frequency
            and the key condition ε(ω) = −1 that pins it.
          </p>
        </div>
        <div class="metaCard">
          <div class="metaRow">
            <span class="pill"><span class="dot"></span> Quasi-electrostatic surface mode</span>
            <span class="pill"><span class="dot purple"></span> Boundary-value / PDE method</span>
          </div>
          <div class="metaRow">
            <span class="pill"><span class="dot green"></span> Result: ω<sub>s</sub> = ω<sub>p</sub>/√2</span>
            <span class="pill">Domains: z&gt;0 plasma, z&lt;0 vacuum</span>
          </div>
          <div class="metaRow">
            <span class="pill">Key operators: ∇, ∇·, ∇×, ∇²</span>
            <span class="pill">Fields: E = −∇φ, D = εE</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="layout">
      <nav class="toc" aria-label="Table of Contents">
        <h2>Table of Contents</h2>
        <p class="hint">Sticky, click to jump.</p>
        <a href="#quick-summary">Quick Summary</a>
        <a href="#part0">PART 0 — Concept Primer</a>
        <a href="#part0b">PART 0B — Industry & Applied Physics Perspective</a>
        <a href="#part1">PART 1 — Problem Analysis</a>
        <a href="#part2">PART 2 — Strategy & Tips</a>
        <a href="#part3">PART 3 — Full Solution</a>
        <a href="#part4">PART 4 — Deeper Understanding</a>
        <a href="#part5">PART 5 — Optional Plot Guide</a>
      </nav>

      <article>
        <!-- Quick Summary -->
        <section id="quick-summary">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this is:</strong> Solve for an electrostatic surface mode (surface plasmon) at a flat plasma–vacuum interface z = 0.</li>
            <li><strong>Key physics idea:</strong> A surface charge oscillation creates an evanescent potential on both sides; boundary conditions quantize the allowed frequency.</li>
            <li><strong>Governing PDE:</strong> In each half-space (no free volume charge in the quasi-static region), the potential satisfies <strong>Laplace’s equation</strong> ∇²φ = 0.</li>
            <li><strong>Fields:</strong> E = −∇φ, and the displacement field is D = ε(ω)E in plasma, D = E in vacuum (ε = 1).</li>
            <li><strong>Boundary conditions:</strong> Tangential E continuous at z = 0; normal D continuous at z = 0 (no external free surface charge imposed).</li>
            <li><strong>Main mathematical move:</strong> Use separable evanescent solutions φ ∝ cos(kx) e^{∓kz} and enforce continuity conditions.</li>
            <li><strong>Core condition:</strong> Normal-D continuity gives <strong>ε(ω) = −1</strong> for the surface mode.</li>
            <li><strong>Final result (symbolic):</strong> Using a collisionless Drude plasma ε(ω) = 1 − ω<sub>p</sub>²/ω², the surface plasmon frequency is
              <strong>ω<sub>s</sub> = ω<sub>p</sub>/√2</strong> (Stern–Ferrell result).
            </li>
          </ul>
          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 0 -->
        <section id="part0">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <div class="grid2">
            <div class="card">
              <h3>Core definitions (symbols + SI units)</h3>
              <ul>
                <li><strong>φ(x,z)</strong>: electrostatic potential (V).</li>
                <li><strong>E</strong> = −∇φ: electric field (V/m).</li>
                <li><strong>D</strong> = ε(ω)E: electric displacement (C/m²). (Here ε is the <em>relative</em> permittivity; vacuum has ε = 1.)</li>
                <li><strong>k</strong>: in-plane wavenumber along x (1/m).</li>
                <li><strong>ω</strong>: angular frequency (rad/s).</li>
                <li><strong>ω<sub>p</sub></strong>: plasma frequency, ω<sub>p</sub>² = n e²/(m ε₀) (rad/s) in SI; in “ε relative” form we often write ε(ω) = 1 − ω<sub>p</sub>²/ω².</li>
              </ul>
            </div>

            <div class="card">
              <h3>Physical meaning (intuition)</h3>
              <ul>
                <li>A <strong>surface plasmon</strong> is a collective electron oscillation bound to an interface.</li>
                <li>Its fields are <strong>evanescent</strong> away from the surface: energy is confined near z = 0.</li>
                <li>In the quasi-electrostatic limit (phase velocity ≪ c or k large), magnetic effects are subdominant and we can use <strong>Laplace + boundary conditions</strong>.</li>
              </ul>
            </div>
          </div>

          <h3>Key laws and validity conditions</h3>
          <div class="callout">
            <div class="labelRow">
              <span class="tag ok">Key laws</span>
              <span class="pill">Electrostatics (harmonic time dependence)</span>
            </div>
            <ul>
              <li><strong>Gauss’s law:</strong> ∇·D = ρ<sub>free</sub>. In each homogeneous region with no imposed free charge: ∇·D = 0.</li>
              <li><strong>Faraday’s law:</strong> ∇×E = −∂B/∂t. In the quasi-static approximation for these modes, E is approximately curl-free, so E = −∇φ is consistent.</li>
              <li><strong>Constitutive relation:</strong> D = ε(ω)E (linear, isotropic, local response).</li>
              <li><strong>Laplace equation:</strong> If ε is constant within a region and ∇·D = 0, then ∇·(εE)=0 ⇒ ε∇·E=0 ⇒ ∇·E=0 ⇒ ∇²φ = 0.</li>
            </ul>
          </div>

          <h3>Common model used: collisionless Drude plasma</h3>
          <p>
            For a simple electron gas with negligible damping (γ ≈ 0), the frequency-domain dielectric function is
            ε(ω) = 1 − ω<sub>p</sub>²/ω².
            This is the minimal model behind the Stern–Ferrell surface-plasmon frequency.
          </p>

          <details>
            <summary>Mini-derivation of ε(ω) = 1 − ωp²/ω² (optional)</summary>
            <p>
              Take electron equation of motion for displacement x(t) under an electric field E(t):
              m d²x/dt² = −e E. With harmonic dependence ~ e^{-iωt}, we have −mω² x = −e E ⇒ x = (e/m)(E/ω²).
              Polarization P = −n e x = −n e (e/m)(E/ω²) = −(n e²/(m ω²)) E.
              In SI: D = ε₀E + P = ε₀(1 − ωp²/ω²)E, where ωp² = n e²/(m ε₀).
              Hence relative ε(ω) = 1 − ωp²/ω².
            </p>
          </details>

          <h3>What to watch for (pitfalls)</h3>
          <ul>
            <li><strong>Sign conventions:</strong> E = −∇φ; if you guess φ, always differentiate carefully.</li>
            <li><strong>Evanescence direction:</strong> physical solutions must decay as |z| → ∞ in each half-space.</li>
            <li><strong>Boundary conditions:</strong> tangential E continuous; normal D jumps only if there is a free surface charge.</li>
            <li><strong>Electrostatic vs full EM:</strong> this derivation yields a k-independent ω<sub>s</sub>; full Maxwell theory gives dispersive surface plasmon–polaritons.</li>
          </ul>

          <div class="callout">
            <div class="labelRow">
              <span class="tag purple">Math Insight</span>
              <span class="pill">Laplace equation as an eigenfunction generator</span>
            </div>
            <p>
              Here ∇²φ = 0 is a <strong>linear elliptic PDE</strong>. In a translationally invariant geometry (in x),
              separation of variables produces harmonic x-dependence (cos(kx), sin(kx)) and exponential z-dependence (e^{±kz}).
              The boundary conditions then act like an <strong>eigenvalue condition</strong> that selects ω through ε(ω).
            </p>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 0B -->
        <section id="part0b">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>

          <div class="grid2">
            <div class="card">
              <h3>Where this appears in industry (examples)</h3>
              <ul>
                <li><strong>Plasmonic sensing:</strong> surface plasmon resonance (SPR) biosensors detect refractive-index changes near a metal surface.</li>
                <li><strong>Nanophotonics / on-chip optics:</strong> subwavelength confinement for waveguides, modulators, and photodetectors.</li>
                <li><strong>Materials & coatings:</strong> optical properties of thin metallic films, metamaterials, and EMI/ESD coatings depend on electron collective response.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Why engineers care</h3>
              <ul>
                <li><strong>Performance:</strong> field confinement controls sensitivity and device footprint.</li>
                <li><strong>Reliability:</strong> real materials have damping (finite γ), roughness, and temperature dependence that shift/broaden resonances.</li>
                <li><strong>Cost & manufacturability:</strong> surface quality, film thickness control, and material choice determine yield and reproducibility.</li>
              </ul>
            </div>
          </div>

          <h3>Typical measurement / validation methods</h3>
          <ul>
            <li><strong>Optical reflectivity (Kretschmann / Otto geometries):</strong> measure resonance dip vs angle/wavelength to infer ε(ω) and mode conditions.</li>
            <li><strong>Ellipsometry:</strong> retrieve complex ε(ω) for thin films, essential for predicting plasmonic response.</li>
            <li><strong>EELS / near-field microscopy:</strong> map localized surface plasmon modes at the nanoscale.</li>
          </ul>

          <h3>Design trade-offs & constraints</h3>
          <ul>
            <li><strong>Non-ideal ε(ω):</strong> metals have complex ε(ω)=ε′+iε″; ε′≈−1 is necessary but losses (ε″) limit Q-factor.</li>
            <li><strong>Surface roughness:</strong> scatters and damps surface waves, reducing propagation length.</li>
            <li><strong>Finite thickness:</strong> thin films support coupled surface modes (symmetric/antisymmetric), shifting frequencies from the semi-infinite result.</li>
          </ul>

          <div class="callout">
            <div class="labelRow">
              <span class="tag ok">From lab to product</span>
              <span class="pill">Ideal interface → real stack</span>
            </div>
            <p>
              The textbook condition ε(ω)=−1 is a starting point. Product designs replace “vacuum” with dielectrics
              (ε<sub>d</sub>≠1), include complex ε(ω), finite thickness layers, and roughness. The practical criterion becomes
              Re{ε(ω)} ≈ −ε<sub>d</sub> while ensuring losses (Im{ε}) stay small enough for the required sensitivity or propagation.
            </p>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 1 -->
        <section id="part1">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <h3>Problem restatement (in plain words)</h3>
          <p>
            A plasma occupies the half-space z &gt; 0 and vacuum occupies z &lt; 0, with a flat interface at z = 0.
            In the plasma region, a Laplace-equation solution for the potential is given:
            φ<sub>p</sub>(x,z) = A cos(kx) e^{-kz}, which implies electric field components E<sub>z</sub> and E<sub>x</sub>.
            (a) Find the corresponding vacuum potential φ<sub>0</sub>(x,z) for z &lt; 0 that satisfies continuity of the tangential electric field at z = 0.
            (b) Use D = ε(ω)E in plasma and D = E in vacuum to impose continuity of the normal displacement D<sub>z</sub> at z = 0 and show this requires ε(ω)=−1.
            Then, using ε(ω) = 1 − ω<sub>p</sub>²/ω², deduce the surface plasmon frequency ω<sub>s</sub>.
          </p>

          <div class="grid2">
            <div class="card">
              <h3>Given</h3>
              <ul>
                <li>Geometry: interface plane z = 0; plasma for z &gt; 0; vacuum for z &lt; 0.</li>
                <li>Potential in plasma: φ<sub>p</sub>(x,z) = A cos(kx) e^{-kz}.</li>
                <li>Relation E = −∇φ.</li>
                <li>Constitutive: D<sub>p</sub> = ε(ω) E<sub>p</sub>, D<sub>0</sub> = E<sub>0</sub> (vacuum ε=1).</li>
              </ul>
            </div>
            <div class="card">
              <h3>Unknowns / must show</h3>
              <ul>
                <li>Vacuum potential φ<sub>0</sub>(x,z) decaying as z → −∞.</li>
                <li>Verify tangential-field continuity (E<sub>x</sub> continuous at z=0).</li>
                <li>Use D-normal continuity to obtain ε(ω)=−1.</li>
                <li>Compute ω<sub>s</sub> in Drude plasma: ω<sub>s</sub>² = (1/2) ω<sub>p</sub>².</li>
              </ul>
            </div>
          </div>

          <h3>Relevant principles (and why they apply)</h3>
          <ul>
            <li><strong>Laplace equation:</strong> valid in each region where ∇·D=0 and ε is uniform in that region, yielding ∇²φ=0.</li>
            <li><strong>Boundary conditions from Maxwell’s equations:</strong>
              tangential E continuity comes from ∇×E = −∂B/∂t (no infinite B impulse);
              normal D continuity comes from Gauss’s law ∇·D = ρ<sub>free</sub> (no imposed free surface charge).
            </li>
            <li><strong>Linearity and superposition:</strong> Laplace’s equation is linear, so separable sinusoidal solutions are valid and can be matched at boundaries.</li>
          </ul>

          <div class="callout">
            <div class="labelRow">
              <span class="tag warn">Assumptions</span>
              <span class="pill">Stated explicitly</span>
            </div>
            <ul>
              <li>Quasi-electrostatic approximation: E ≈ −∇φ, magnetic induction effects neglected for the mode frequency condition.</li>
              <li>Homogeneous, isotropic plasma characterized by a scalar ε(ω) (local response).</li>
              <li>No externally imposed free surface charge at the boundary (so D<sub>z</sub> is continuous).</li>
              <li>Fields decay away from the interface: evanescent in both half-spaces.</li>
            </ul>
          </div>

          <h3>Possible approaches (compare)</h3>
          <ul>
            <li><strong>(1) PDE separation (chosen):</strong> Solve ∇²φ=0 in each half-space with decaying exponentials and match boundary conditions.
              <em>Pros:</em> direct, transparent, minimal machinery. <em>Cons:</em> quasi-static only.</li>
            <li><strong>(2) Fourier transform in x:</strong> treat boundary condition matching in k-space.
              <em>Pros:</em> generalizes to arbitrary surface patterns. <em>Cons:</em> overkill for a single sinusoid.</li>
            <li><strong>(3) Full Maxwell SPP derivation:</strong> solve wave equations and get dispersive ω(k).
              <em>Pros:</em> more complete. <em>Cons:</em> not needed here; problem is explicitly Laplace-based.</li>
          </ul>

          <p><strong>Best choice:</strong> Approach (1) matches the given ansatz and uses the minimal correct physics for this exercise.</p>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 2 -->
        <section id="part2">
          <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

          <ol style="color:var(--muted); margin: 8px 0 8px 22px;">
            <li><strong>Set the model:</strong> define regions, coordinates, and governing PDE ∇²φ=0 in each half-space.</li>
            <li><strong>Use the given plasma potential:</strong> φ<sub>p</sub>=A cos(kx)e^{-kz}; compute E<sub>x</sub>, E<sub>z</sub> via E=−∇φ.</li>
            <li><strong>Guess vacuum potential form:</strong> choose φ<sub>0</sub>=B cos(kx)e^{+kz} (decays for z→−∞) and compute E<sub>x0</sub>, E<sub>z0</sub>.</li>
            <li><strong>Apply tangential E continuity at z=0:</strong> E<sub>x0</sub>(0)=E<sub>xp</sub>(0) to fix B.</li>
            <li><strong>Apply normal D continuity at z=0:</strong> D<sub>z0</sub>(0)=D<sub>zp</sub>(0) with D<sub>p</sub>=ε(ω)E<sub>p</sub>, D<sub>0</sub>=E<sub>0</sub>, giving a condition on ε(ω).</li>
            <li><strong>Insert Drude ε(ω):</strong> ε(ω)=1−ω<sub>p</sub>²/ω², solve ε(ω)=−1 for ω.</li>
            <li><strong>Check sanity:</strong> evanescence, units, and limiting behavior.</li>
          </ol>

          <div class="callout">
            <div class="labelRow">
              <span class="tag bad">Common mistakes</span>
              <span class="pill">Avoid these</span>
            </div>
            <ul>
              <li>Forgetting the minus sign in E = −∇φ (flips E-components and breaks boundary matching).</li>
              <li>Picking the wrong exponential in vacuum: for z&lt;0, the decaying choice is e^{+kz} (since kz→−∞).</li>
              <li>Confusing continuity of E<sub>z</sub> with continuity of D<sub>z</sub>; it’s D<sub>z</sub> that’s continuous when no free surface charge is imposed.</li>
              <li>Dropping ε(ω) too early: the surface mode exists precisely because ε depends on ω.</li>
            </ul>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 3 -->
        <section id="part3">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>Physical intuition (before equations)</h3>
          <p>
            A surface charge oscillation at z=0 produces electric fields that are strongest at the surface and decay
            away into both media. Since the interface is flat and uniform in y, a sinusoidal variation along x
            naturally produces an exponential decay in z with the same k. The boundary conditions then constrain which
            material response ε(ω) can support such a self-consistent surface oscillation. Because ε(ω) depends on ω,
            the boundary condition becomes a <em>frequency selection rule</em>.
          </p>

          <h3>Mathematical model (variables, domains, coordinates, BCs)</h3>
          <div class="callout">
            <div class="labelRow">
              <span class="tag">Model</span>
              <span class="pill">Elliptic PDE + interface conditions</span>
            </div>
            <ul>
              <li>Coordinates: (x,z) with interface at z=0, translational invariance in y (suppressed).</li>
              <li>Domains:
                <ul>
                  <li>Plasma region: Ω<sub>p</sub> = {z &gt; 0}, permittivity ε(ω).</li>
                  <li>Vacuum region: Ω<sub>0</sub> = {z &lt; 0}, permittivity 1.</li>
                </ul>
              </li>
              <li>Governing equation in each region (no imposed free charge in the bulk):
                <div class="eq">
                  <button class="copyBtn" data-copy="eq-laplace">Copy</button>
                  <pre id="eq-laplace">∇²φ = 0   in z > 0 and in z < 0</pre>
                </div>
              </li>
              <li>Field definitions:
                <div class="eq">
                  <button class="copyBtn" data-copy="eq-fielddef">Copy</button>
                  <pre id="eq-fielddef">E = -∇φ,   D = ε(ω) E (plasma),   D = E (vacuum)</pre>
                </div>
              </li>
              <li>Boundary conditions at z=0:
                <ul>
                  <li>Tangential E continuous: E<sub>x0</sub>(0) = E<sub>xp</sub>(0).</li>
                  <li>Normal D continuous (no imposed free surface charge): D<sub>z0</sub>(0) = D<sub>zp</sub>(0).</li>
                </ul>
              </li>
              <li>Decay conditions: φ<sub>p</sub> finite as z→+∞; φ<sub>0</sub> finite as z→−∞ (evanescent).</li>
            </ul>
          </div>

          <h3>Given plasma potential and its electric field</h3>
          <p>The problem gives the plasma solution (z&gt;0):</p>
          <div class="eq">
            <button class="copyBtn" data-copy="eq-phi-plasma">Copy</button>
            <pre id="eq-phi-plasma">φ_p(x,z) = A cos(kx) e^{-kz},   z > 0</pre>
          </div>

          <p>
            Compute E = −∇φ. Since ∂/∂x (cos(kx)) = −k sin(kx) and ∂/∂z (e^{-kz}) = −k e^{-kz}:
          </p>

          <div class="eq">
            <button class="copyBtn" data-copy="eq-derivs-plasma">Copy</button>
            <pre id="eq-derivs-plasma">∂φ_p/∂x = A (-k sin(kx)) e^{-kz} = -kA sin(kx) e^{-kz}
∂φ_p/∂z = A cos(kx) (-k e^{-kz}) = -kA cos(kx) e^{-kz}</pre>
          </div>

          <p>Therefore</p>
          <div class="eq">
            <button class="copyBtn" data-copy="eq-E-plasma">Copy</button>
            <pre id="eq-E-plasma">E_xp = -∂φ_p/∂x =  kA sin(kx) e^{-kz}
E_zp = -∂φ_p/∂z =  kA cos(kx) e^{-kz}</pre>
          </div>
          <p>
            (This matches the components stated in the problem.)
          </p>

          <h3>(a) Find the vacuum potential by tangential-field continuity</h3>
          <p>
            In vacuum (z&lt;0), Laplace’s equation ∇²φ=0 admits separated solutions with the same x-dependence:
            φ<sub>0</sub>(x,z) = B cos(kx) f(z). Plugging into ∇²φ=0 yields f″(z) − k² f(z)=0, so f(z)=C e^{kz}+D e^{-kz}.
          </p>

          <details>
            <summary>Separation step (optional detail)</summary>
            <p>
              Let φ(x,z)=X(x)Z(z). Then ∇²φ = X''(x)Z(z) + X(x)Z''(z) = 0 ⇒ X''/X = -Z''/Z = -k².
              So X solves X'' + k²X = 0 giving sin/cos(kx), and Z solves Z'' - k²Z = 0 giving e^{±kz}.
            </p>
          </details>

          <p>
            For z&lt;0, the physically acceptable (decaying as z→−∞) exponential is <strong>e^{kz}</strong>
            because kz→−∞ and e^{kz}→0, whereas e^{-kz} would diverge.
            So take
          </p>

          <div class="eq">
            <button class="copyBtn" data-copy="eq-phi-vac-ansatz">Copy</button>
            <pre id="eq-phi-vac-ansatz">φ_0(x,z) = B cos(kx) e^{kz},   z < 0</pre>
          </div>

          <p>Compute the vacuum field:</p>
          <div class="eq">
            <button class="copyBtn" data-copy="eq-E-vac">Copy</button>
            <pre id="eq-E-vac">∂φ_0/∂x = -kB sin(kx) e^{kz}      ⇒  E_x0 = -∂φ_0/∂x =  kB sin(kx) e^{kz}
∂φ_0/∂z =  kB cos(kx) e^{kz}       ⇒  E_z0 = -∂φ_0/∂z = -kB cos(kx) e^{kz}</pre>
          </div>

          <p>
            Tangential E continuity at z=0 requires E<sub>x0</sub>(x,0)=E<sub>xp</sub>(x,0):
          </p>
          <div class="eq">
            <button class="copyBtn" data-copy="eq-tan-bc">Copy</button>
            <pre id="eq-tan-bc">kB sin(kx) = kA sin(kx)   for all x  ⇒  B = A</pre>
          </div>

          <p>
            Hence the vacuum potential is exactly
          </p>
          <div class="eq">
            <button class="copyBtn" data-copy="eq-phi-vac-final">Copy</button>
            <pre id="eq-phi-vac-final">φ_0(x,z) = A cos(kx) e^{kz},   z < 0</pre>
          </div>

          <h3>(b) Normal D continuity ⇒ ε(ω) = −1</h3>
          <p>
            Now apply the normal displacement boundary condition at z=0. In vacuum, D<sub>0</sub>=E<sub>0</sub>.
            In plasma, D<sub>p</sub>=ε(ω)E<sub>p</sub>. Therefore, continuity of the normal component gives:
          </p>

          <div class="eq">
            <button class="copyBtn" data-copy="eq-D-bc">Copy</button>
            <pre id="eq-D-bc">D_z0(0) = D_zp(0)
E_z0(0) = ε(ω) E_zp(0)</pre>
          </div>

          <p>
            Evaluate E<sub>z0</sub> and E<sub>zp</sub> at z=0 (using B=A already):
          </p>

          <div class="eq">
            <button class="copyBtn" data-copy="eq-Ez-at0">Copy</button>
            <pre id="eq-Ez-at0">E_zp(x,0) =  kA cos(kx)
E_z0(x,0) = -kA cos(kx)</pre>
          </div>

          <p>
            Substitute into E<sub>z0</sub>(0) = ε(ω) E<sub>zp</sub>(0):
          </p>
          <div class="eq">
            <button class="copyBtn" data-copy="eq-eps-cond">Copy</button>
            <pre id="eq-eps-cond">-kA cos(kx) = ε(ω) [kA cos(kx)]  ⇒  ε(ω) = -1</pre>
          </div>

          <p>
            This is the classic surface-mode condition at a vacuum interface. More generally, if the lower half-space
            has permittivity ε<sub>d</sub>, the condition becomes ε(ω) = −ε<sub>d</sub>.
          </p>

          <h3>Insert the plasma dielectric function and solve for ω<sub>s</sub></h3>
          <p>
            Using the (collisionless) Drude plasma model,
          </p>
          <div class="eq">
            <button class="copyBtn" data-copy="eq-drude">Copy</button>
            <pre id="eq-drude">ε(ω) = 1 - (ω_p^2/ω^2)</pre>
          </div>

          <p>
            Set ε(ω) = −1:
          </p>
          <div class="eq">
            <button class="copyBtn" data-copy="eq-solve">Copy</button>
            <pre id="eq-solve">1 - (ω_p^2/ω^2) = -1
⇒ 2 = ω_p^2/ω^2
⇒ ω^2 = (1/2) ω_p^2
⇒ ω_s = ω_p / √2</pre>
          </div>

          <div class="callout">
            <div class="labelRow">
              <span class="tag ok">Final Answer</span>
              <span class="pill">Stern–Ferrell surface plasmon</span>
            </div>
            <div class="eq" style="margin-top:8px;">
              <button class="copyBtn" data-copy="final-answer">Copy</button>
              <pre id="final-answer">Vacuum potential (z < 0):   φ_0(x,z) = A cos(kx) e^{kz}

Interface condition from normal-D continuity:   ε(ω) = -1

For a Drude plasma ε(ω)=1-(ω_p^2/ω^2):
Surface plasmon frequency:   ω_s^2 = (1/2) ω_p^2   ⇒   ω_s = ω_p / √2</pre>
            </div>
          </div>

          <h3>Sanity checks</h3>
          <div class="grid2">
            <div class="card">
              <h3>Units / dimensions</h3>
              <ul>
                <li>ε(ω) is dimensionless; condition ε = −1 is dimensionally consistent.</li>
                <li>ω<sub>s</sub>² = (1/2)ω<sub>p</sub>² has units (rad/s)², so ω<sub>s</sub> has units rad/s.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Physical interpretation</h3>
              <ul>
                <li>Evanescence: e^{-kz} decays into plasma as z→+∞; e^{kz} decays into vacuum as z→−∞.</li>
                <li>Sign flip in E<sub>z</sub> across interface reflects the field lines from an oscillating surface charge distribution.</li>
                <li>Frequency is <strong>k-independent</strong> here because we used the electrostatic (Laplace) model; full EM introduces ω(k).</li>
              </ul>
            </div>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 4 -->
        <section id="part4">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>Re-interpreting the condition ε(ω) = −1</h3>
          <p>
            The surface mode exists when the interface can support a self-consistent bound field without external driving.
            The normal-field components must satisfy D<sub>z</sub> continuity, which effectively requires opposite-signed normal E on either side.
            Since E<sub>z0</sub>(0) = −E<sub>zp</sub>(0) from the evanescent forms, the material must provide ε(ω)=−1 to compensate.
          </p>

          <h3>Parameter dependence (qualitative)</h3>
          <ul>
            <li><strong>Electron density n:</strong> ω<sub>p</sub> ∝ √n, so ω<sub>s</sub> ∝ √n. Higher carrier density pushes the surface plasmon frequency up.</li>
            <li><strong>Effective mass m:</strong> ω<sub>p</sub> ∝ 1/√m, so heavier carriers reduce ω<sub>s</sub>.</li>
            <li><strong>Ambient dielectric:</strong> replacing vacuum with ε<sub>d</sub> gives (in the same quasi-static logic) ε(ω) = −ε<sub>d</sub>,
              which shifts ω<sub>s</sub> lower when ε<sub>d</sub> &gt; 1.</li>
          </ul>

          <h3>Alternative derivation idea (brief but meaningful)</h3>
          <p>
            You can derive the same condition using <strong>Gauss’s law on a pillbox</strong> straddling the interface:
            the jump in D<sub>z</sub> equals the free surface charge density. For a self-sustained surface oscillation with no imposed external free charge,
            the net “free” contribution is effectively internal to the plasma response, so the boundary condition reduces to D<sub>z0</sub>=D<sub>zp</sub>.
            Combined with the evanescent-field relation E<sub>z0</sub>=−E<sub>zp</sub> at z=0, you again obtain ε(ω)=−1.
          </p>

          <div class="callout">
            <div class="labelRow">
              <span class="tag purple">Concept check (with answers)</span>
            </div>
            <ul>
              <li><strong>Q:</strong> Why does the vacuum solution use e^{kz} rather than e^{-kz} for z&lt;0?
                <br><strong>A:</strong> Because we require decay as z→−∞; e^{kz}→0 while e^{-kz}→∞.</li>
              <li><strong>Q:</strong> Which component is guaranteed continuous across an interface (no surface currents/charges)? E<sub>x</sub> or E<sub>z</sub>?
                <br><strong>A:</strong> E<sub>tangential</sub> (e.g., E<sub>x</sub>) is continuous; D<sub>normal</sub> (not E<sub>z</sub> necessarily) is continuous if no free surface charge is present.</li>
              <li><strong>Q:</strong> What is the mathematical “type” of ∇²φ=0?
                <br><strong>A:</strong> A linear elliptic PDE; solutions are harmonic functions determined by boundary data.</li>
              <li><strong>Q:</strong> Why is ω<sub>s</sub> independent of k in this problem?
                <br><strong>A:</strong> The electrostatic Laplace model has no wave-propagation time scale (no c), so k only sets spatial decay, not frequency. Full Maxwell theory restores ω(k).</li>
            </ul>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 5 -->
        <section id="part5">
          <h2>PART 5 — Optional Plot Guide</h2>

          <p>
            A plot is useful here because the surface-plasmon condition is a simple <strong>intersection problem</strong>:
            find ω where ε(ω) crosses −1. We keep the final physics symbolic, but the plot uses normalized variables.
          </p>

          <figure>
            <canvas id="plot" aria-label="Plot of epsilon(omega) and the line epsilon=-1"></canvas>
            <figcaption>
              Static plot (example values): normalized permittivity ε(ω)=1−(ω<sub>p</sub>²/ω²) versus ω/ω<sub>p</sub>,
              and the horizontal line ε=−1. The intersection occurs at ω/ω<sub>p</sub>=1/√2.
            </figcaption>
          </figure>

          <div class="grid2" style="margin-top:12px;">
            <div class="card">
              <h3>Axes / units</h3>
              <ul>
                <li>x-axis: Ω = ω/ω<sub>p</sub> (dimensionless).</li>
                <li>y-axis: ε (dimensionless).</li>
              </ul>
            </div>
            <div class="card">
              <h3>What to notice</h3>
              <ul>
                <li>As Ω→∞, ε→1 (vacuum-like response at high frequency).</li>
                <li>As Ω→0, ε→−∞ (strong negative permittivity).</li>
                <li>The surface mode condition is where ε hits −1: Ω=1/√2.</li>
              </ul>
            </div>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <footer>
          <p>
            Built for learning: Laplace PDE + boundary conditions ⇒ ε(ω)=−1 ⇒ ω<sub>s</sub>=ω<sub>p</sub>/√2.
            <br/>Tip for next step: extend to a dielectric cladding (ε<sub>d</sub>) or to full Maxwell SPP dispersion ω(k).
          </p>
        </footer>
      </article>
    </div>
  </main>

  <script>
    // Smooth scroll for TOC links
    (function(){
      const links = document.querySelectorAll('nav.toc a[href^="#"]');
      for (const a of links){
        a.addEventListener('click', (e) => {
          e.preventDefault();
          const id = a.getAttribute('href').slice(1);
          const el = document.getElementById(id);
          if(!el) return;
          el.scrollIntoView({behavior:'smooth', block:'start'});
          history.replaceState(null, '', '#' + id);
        });
      }
    })();

    // Copy buttons (plain text)
    (function(){
      function copyText(text){
        if(navigator.clipboard && window.isSecureContext){
          return navigator.clipboard.writeText(text);
        }
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        ta.style.top = '0';
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        try { document.execCommand('copy'); } catch(e){}
        document.body.removeChild(ta);
        return Promise.resolve();
      }

      document.querySelectorAll('.copyBtn').forEach(btn => {
        btn.addEventListener('click', async () => {
          const targetId = btn.getAttribute('data-copy');
          const el = document.getElementById(targetId);
          if(!el) return;
          const text = el.textContent.trim();
          const old = btn.textContent;
          try{
            await copyText(text);
            btn.textContent = 'Copied!';
            btn.style.borderColor = 'rgba(52,211,153,.35)';
            btn.style.background = 'rgba(52,211,153,.12)';
            setTimeout(() => {
              btn.textContent = old;
              btn.style.borderColor = '';
              btn.style.background = '';
            }, 900);
          }catch(err){
            btn.textContent = 'Copy failed';
            setTimeout(() => btn.textContent = old, 900);
          }
        });
      });
    })();

    // Single static plot using <canvas> (high-DPI crisp)
    (function(){
      const canvas = document.getElementById('plot');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      function draw(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const cssW = canvas.clientWidth;
        const cssH = canvas.clientHeight;
        canvas.width = Math.round(cssW * dpr);
        canvas.height = Math.round(cssH * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        // Plot area
        const pad = {l:54, r:16, t:28, b:46};
        const W = cssW, H = cssH;
        const x0 = pad.l, y0 = H - pad.b;
        const x1 = W - pad.r, y1 = pad.t;

        // Background
        ctx.clearRect(0,0,W,H);
        ctx.fillStyle = 'rgba(0,0,0,0.12)';
        roundRect(ctx, 0, 0, W, H, 12);
        ctx.fill();

        // Axes ranges (dimensionless)
        // Ω = ω/ωp from 0.35 to 2.5 (avoid singular near 0)
        const xmin = 0.35, xmax = 2.5;
        const ymin = -6.0, ymax = 2.0;

        const X = (x) => x0 + (x - xmin) * (x1 - x0) / (xmax - xmin);
        const Y = (y) => y0 - (y - ymin) * (y0 - y1) / (ymax - ymin);

        // Gridlines
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        ctx.lineWidth = 1;

        // x ticks
        const xticks = [0.5, 1.0, 1.5, 2.0, 2.5];
        xticks.forEach(v => {
          const xx = X(v);
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y1);
          ctx.stroke();
        });
        // y ticks
        const yticks = [-6,-4,-2,0,2];
        yticks.forEach(v => {
          const yy = Y(v);
          ctx.beginPath();
          ctx.moveTo(x0, yy);
          ctx.lineTo(x1, yy);
          ctx.stroke();
        });

        // Axes
        ctx.strokeStyle = 'rgba(255,255,255,0.28)';
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x1, y0);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x0, y1);
        ctx.stroke();

        // Labels
        ctx.fillStyle = 'rgba(233,238,247,0.95)';
        ctx.font = '600 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';
        ctx.fillText('ε(ω) vs ω/ωp (example: Drude, γ=0)', x0, 18);

        ctx.fillStyle = 'rgba(182,194,217,0.95)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';

        // x-axis label
        ctx.fillText('Ω = ω/ωp (dimensionless)', Math.max(x0, (x0+x1)/2 - 80), H - 14);

        // y-axis label (rotated)
        ctx.save();
        ctx.translate(16, (y0+y1)/2 + 40);
        ctx.rotate(-Math.PI/2);
        ctx.fillText('ε (dimensionless)', 0, 0);
        ctx.restore();

        // Tick labels
        ctx.fillStyle = 'rgba(182,194,217,0.9)';
        xticks.forEach(v => {
          const xx = X(v);
          ctx.fillText(v.toFixed(1), xx - 10, y0 + 18);
          // tick mark
          ctx.strokeStyle = 'rgba(255,255,255,0.28)';
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y0+6);
          ctx.stroke();
        });
        yticks.forEach(v => {
          const yy = Y(v);
          ctx.fillText(String(v), x0 - 28, yy + 4);
          ctx.strokeStyle = 'rgba(255,255,255,0.28)';
          ctx.beginPath();
          ctx.moveTo(x0-6, yy);
          ctx.lineTo(x0, yy);
          ctx.stroke();
        });

        // Curve: ε(Ω)=1-1/Ω^2 (take ωp=1 normalized)
        ctx.lineWidth = 2;
        ctx.strokeStyle = 'rgba(110,231,255,0.95)';
        ctx.beginPath();
        let first = true;
        const N = 500;
        for(let i=0;i<=N;i++){
          const om = xmin + (xmax-xmin)*i/N;
          const eps = 1 - 1/(om*om);
          const xx = X(om);
          const yy = Y(eps);
          if(first){ ctx.moveTo(xx,yy); first=false; }
          else{ ctx.lineTo(xx,yy); }
        }
        ctx.stroke();

        // Line ε = -1
        ctx.lineWidth = 2;
        ctx.strokeStyle = 'rgba(167,139,250,0.90)';
        ctx.beginPath();
        ctx.moveTo(x0, Y(-1));
        ctx.lineTo(x1, Y(-1));
        ctx.stroke();

        // Intersection at Ω=1/sqrt(2)
        const omS = 1/Math.sqrt(2);
        const epsS = -1;
        const xi = X(omS), yi = Y(epsS);
        ctx.fillStyle = 'rgba(52,211,153,0.95)';
        ctx.beginPath();
        ctx.arc(xi, yi, 4.2, 0, Math.PI*2);
        ctx.fill();

        // Annotation
        ctx.fillStyle = 'rgba(233,238,247,0.95)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';
        ctx.fillText('Surface mode: ε = −1 at Ω = 1/√2', Math.min(xi+10, x1-210), Math.max(yi-10, y1+14));

        // Legend
        const lx = x1 - 230, ly = y1 + 10;
        // legend box
        ctx.fillStyle = 'rgba(0,0,0,0.25)';
        ctx.strokeStyle = 'rgba(255,255,255,0.12)';
        roundRect(ctx, lx, ly, 214, 44, 10);
        ctx.fill();
        ctx.stroke();

        // legend lines
        ctx.lineWidth = 2;
        ctx.strokeStyle = 'rgba(110,231,255,0.95)';
        ctx.beginPath(); ctx.moveTo(lx+12, ly+16); ctx.lineTo(lx+42, ly+16); ctx.stroke();
        ctx.fillStyle = 'rgba(182,194,217,0.95)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';
        ctx.fillText('ε(Ω)=1−1/Ω²', lx+52, ly+20);

        ctx.strokeStyle = 'rgba(167,139,250,0.90)';
        ctx.beginPath(); ctx.moveTo(lx+12, ly+32); ctx.lineTo(lx+42, ly+32); ctx.stroke();
        ctx.fillStyle = 'rgba(182,194,217,0.95)';
        ctx.fillText('ε = −1', lx+52, ly+36);
      }

      function roundRect(ctx, x, y, w, h, r){
        const rr = Math.min(r, w/2, h/2);
        ctx.beginPath();
        ctx.moveTo(x+rr, y);
        ctx.arcTo(x+w, y, x+w, y+h, rr);
        ctx.arcTo(x+w, y+h, x, y+h, rr);
        ctx.arcTo(x, y+h, x, y, rr);
        ctx.arcTo(x, y, x+w, y, rr);
        ctx.closePath();
      }

      const ro = new ResizeObserver(draw);
      ro.observe(canvas);
      draw();
      window.addEventListener('resize', draw);
    })();
  </script>
</body>
</html>