<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Magnetoplasma Frequency of the Uniform Plasmon Mode (Sphere in Uniform B)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1620;
      --card:#111b27;
      --ink:#eaf0f7;
      --muted:#b9c4d2;
      --faint:#7f8ea3;
      --accent:#7dd3fc;
      --accent2:#a7f3d0;
      --warn:#fbbf24;
      --danger:#fb7185;
      --ok:#86efac;
      --line:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background: radial-gradient(1200px 700px at 70% -10%, rgba(125,211,252,.18), transparent 60%),
                  radial-gradient(900px 600px at 15% 10%, rgba(167,243,208,.12), transparent 55%),
                  linear-gradient(180deg, #070a0f, var(--bg));
      line-height:1.55;
    }
    header{
      padding:28px 18px 10px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.03), transparent);
      position:relative;
      overflow:hidden;
    }
    header .wrap{
      max-width:1200px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.4fr .6fr;
      gap:18px;
      align-items:start;
    }
    h1{
      margin:0 0 8px;
      font-size: clamp(1.4rem, 2.2vw, 2.1rem);
      letter-spacing:.2px;
    }
    .subtitle{
      color:var(--muted);
      margin:0 0 14px;
      font-size:1rem;
    }
    .meta{
      padding:14px 14px;
      background:rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
    }
    .meta strong{color:var(--accent)}
    .pillrow{
      display:flex; flex-wrap:wrap; gap:8px; margin-top:10px;
    }
    .pill{
      font-size:.85rem;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--muted);
    }

    main{
      max-width:1200px;
      margin:0 auto;
      padding:18px 18px 70px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:18px;
    }
    @media (max-width: 980px){
      main{grid-template-columns:1fr}
    }

    /* Sticky TOC */
    nav{
      position: sticky;
      top: 12px;
      align-self:start;
      background:rgba(15,22,32,.65);
      backdrop-filter: blur(10px);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:14px;
    }
    nav h2{
      font-size:1rem;
      margin:0 0 10px;
      color:var(--accent);
      letter-spacing:.3px;
    }
    .toc a{
      display:block;
      padding:8px 10px;
      margin:4px 0;
      border-radius:12px;
      color:var(--muted);
      text-decoration:none;
      border:1px solid transparent;
      transition: transform .08s ease, background .15s ease, border-color .15s ease;
    }
    .toc a:hover{
      background:rgba(125,211,252,.08);
      border-color:rgba(125,211,252,.22);
      transform: translateY(-1px);
      color:var(--ink);
    }
    .toc small{color:var(--faint)}
    @media (max-width:980px){
      nav{position:relative; top:auto}
    }

    article{
      background:rgba(15,22,32,.35);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    section{
      padding:18px 18px;
      border-top:1px solid var(--line);
    }
    section:first-child{border-top:none}
    h2{
      margin:0 0 10px;
      font-size:1.25rem;
      letter-spacing:.2px;
    }
    h3{
      margin:14px 0 8px;
      font-size:1.05rem;
      color:var(--accent2);
    }
    p{margin:10px 0; color:var(--ink)}
    ul{margin:8px 0 10px 20px; color:var(--muted)}
    li{margin:6px 0}
    .grid2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    @media (max-width:760px){ .grid2{grid-template-columns:1fr} }

    .card{
      background: rgba(17,27,39,.6);
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 12px 12px;
    }
    .callout{
      border-left: 4px solid var(--accent);
      background: rgba(125,211,252,.08);
      padding: 12px 12px;
      border-radius: 14px;
      border:1px solid rgba(125,211,252,.20);
    }
    .callout.warn{
      border-left-color: var(--warn);
      background: rgba(251,191,36,.08);
      border-color: rgba(251,191,36,.22);
    }
    .callout.danger{
      border-left-color: var(--danger);
      background: rgba(251,113,133,.08);
      border-color: rgba(251,113,133,.22);
    }
    .callout.ok{
      border-left-color: var(--ok);
      background: rgba(134,239,172,.08);
      border-color: rgba(134,239,172,.22);
    }
    .eq{
      position:relative;
      margin:10px 0;
      padding:12px 12px 12px 12px;
      border-radius: 14px;
      border: 1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.03);
      font-family: var(--mono);
      color: #e9fbff;
      overflow:auto;
    }
    .eq .label{
      font-family: var(--sans);
      font-size:.85rem;
      color: var(--muted);
      margin-bottom:6px;
    }
    .copybtn{
      position:absolute;
      top:10px; right:10px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.25);
      color: var(--muted);
      cursor:pointer;
      font-size:.82rem;
      transition: transform .08s ease, background .15s ease, color .15s ease;
      user-select:none;
    }
    .copybtn:hover{transform: translateY(-1px); background: rgba(125,211,252,.10); color: var(--ink)}
    .copybtn:active{transform: translateY(0px)}
    details{
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
      border-radius: 16px;
      padding: 10px 12px;
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      color: var(--muted);
      font-weight:600;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    summary::after{
      content:"▾";
      float:right;
      color:var(--faint);
      transition: transform .15s ease;
    }
    details[open] summary::after{transform: rotate(180deg)}
    .backtop{
      display:inline-block;
      margin-top:10px;
      color: var(--accent);
      text-decoration:none;
      border-bottom:1px dashed rgba(125,211,252,.35);
    }
    figure{
      margin: 10px 0 0;
      padding: 12px;
      border: 1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.02);
    }
    figcaption{
      margin-top:8px;
      color:var(--muted);
      font-size:.92rem;
    }
    canvas{width:100%; height:320px; display:block; border-radius:12px;}
    footer{
      max-width:1200px;
      margin: 0 auto;
      padding: 0 18px 40px;
      color: var(--faint);
      font-size:.92rem;
    }
    .kpi{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    .kpi .item{
      padding:10px 10px;
      border-radius:16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
    }
    .kpi .item .t{color:var(--faint); font-size:.85rem}
    .kpi .item .v{font-weight:700; color:var(--ink)}
    @media (max-width:760px){ .kpi{grid-template-columns:1fr} }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      nav{display:none}
      header, article, section, figure, .card, .callout, .eq, details{box-shadow:none !important; background:#fff !important; color:#000 !important}
      .copybtn{display:none}
      a{color:#000; text-decoration:underline}
      section{page-break-inside:avoid}
      h2{page-break-after:avoid}
    }
  </style>
</head>
<body>
<a id="top"></a>
<header>
  <div class="wrap">
    <div>
      <h1>Magnetoplasma Frequency: Uniform Plasmon Mode of a Sphere in a Uniform Magnetic Field</h1>
      <p class="subtitle">
        We derive the <em>magnetoplasmon</em> eigenfrequencies for the rigid (uniform) dipole oscillation of an electron gas in a conducting sphere, with a constant magnetic field <span style="white-space:nowrap;">B = B ẑ</span> and motion constrained to the <span style="white-space:nowrap;">x–y</span> plane.
      </p>
      <div class="pillrow">
        <span class="pill">Applied EM + Plasmas</span>
        <span class="pill">Mathematical physics (eigenmodes)</span>
        <span class="pill">Industrial relevance: magnetized conductors</span>
        <span class="pill">Symbolic result + sanity limits</span>
      </div>
    </div>
    <div class="meta">
      <div><strong>Core outputs:</strong></div>
      <div class="kpi">
        <div class="item">
          <div class="t">Cyclotron frequency</div>
          <div class="v">ω<sub>c</sub> = eB/(mc)</div>
        </div>
        <div class="item">
          <div class="t">Sphere dipole plasmon</div>
          <div class="v">ω<sub>0</sub> = √(4πne²/(3m))</div>
        </div>
        <div class="item">
          <div class="t">Magnetoplasmon modes</div>
          <div class="v">ω<sub>±</sub> = ½(√(ω<sub>c</sub>²+4ω<sub>0</sub>²) ± ω<sub>c</sub>)</div>
        </div>
      </div>
      <p style="margin:10px 0 0;color:var(--muted);">
        Conventions: Gaussian-cgs (since ω<sub>c</sub> uses <span style="white-space:nowrap;">c</span>), electron charge magnitude <span style="white-space:nowrap;">e&gt;0</span>.
      </p>
    </div>
  </div>
</header>

<main>
  <nav aria-label="Table of Contents">
    <h2>Table of Contents</h2>
    <div class="toc">
      <a href="#qs">Quick Summary <small>• key equations & result</small></a>
      <a href="#p0">PART 0 — Concept Primer</a>
      <a href="#p0b">PART 0B — Industry & Applied Physics</a>
      <a href="#p1">PART 1 — Problem Analysis</a>
      <a href="#p2">PART 2 — Strategy & Tips</a>
      <a href="#p3">PART 3 — Full Solution</a>
      <a href="#p4">PART 4 — Deeper Understanding</a>
      <a href="#p5">PART 5 — Optional Plot Guide</a>
    </div>
  </nav>

  <article>
    <section id="qs">
      <h2>Quick Summary</h2>
      <ul>
        <li><strong>What this problem is:</strong> Find the eigenfrequencies of the <em>uniform (dipole) plasmon mode</em> of a sphere placed in a constant magnetic field <span style="white-space:nowrap;">B = B ẑ</span>, with motion in the <span style="white-space:nowrap;">x–y</span> plane.</li>
        <li><strong>Key physics idea:</strong> The uniform plasmon of a sphere is a <em>rigid displacement</em> of the electron cloud relative to the positive background, creating a uniform internal restoring electric field (a harmonic oscillator).</li>
        <li><strong>Magnetic field effect:</strong> The Lorentz force couples <span style="white-space:nowrap;">x</span> and <span style="white-space:nowrap;">y</span>, producing two circularly polarized normal modes with split frequencies.</li>
        <li><strong>Governing ODE (model):</strong> <span style="white-space:nowrap;">m r¨ = -m ω<sub>0</sub>² r + q (r˙ × B)/c</span> with <span style="white-space:nowrap;">q = -e</span> (electron), restricted to <span style="white-space:nowrap;">r=(x,y,0)</span>.</li>
        <li><strong>Sphere dipole plasmon frequency:</strong> <span style="white-space:nowrap;">ω<sub>0</sub> = √(4π n e²/(3m))</span>.</li>
        <li><strong>Final symbolic result:</strong> <span style="white-space:nowrap;">ω<sub>±</sub> = ½(√(ω<sub>c</sub>² + 4ω<sub>0</sub>²) ± ω<sub>c</sub>)</span>, where <span style="white-space:nowrap;">ω<sub>c</sub>=eB/(mc)</span>.</li>
        <li><strong>Meaning:</strong> The plasmon becomes two magnetoplasmons: one tends to cyclotron motion when restoring forces are weak; the other becomes a low-frequency drift-like mode.</li>
      </ul>

      <div class="callout ok">
        <strong>Math Insight:</strong>
        The core calculation is an <em>eigenvalue problem</em> for a linear ODE system with gyroscopic coupling:
        a 2D isotropic harmonic oscillator plus an antisymmetric “rotation” operator (from <span style="white-space:nowrap;">v×B</span>).
        Diagonalizing in the circular polarization basis turns it into two quadratic characteristic equations for <span style="white-space:nowrap;">ω</span>.
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="p0">
      <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

      <div class="grid2">
        <div class="card">
          <h3>Core definitions (symbols + units)</h3>
          <ul>
            <li><strong>n</strong> — electron number density <span style="white-space:nowrap;">[cm⁻³]</span> (Gaussian) or <span style="white-space:nowrap;">[m⁻³]</span> (SI); here we remain in Gaussian-cgs.</li>
            <li><strong>e</strong> — magnitude of electron charge <span style="white-space:nowrap;">[statC]</span>; electron charge is <span style="white-space:nowrap;">q=-e</span>.</li>
            <li><strong>m</strong> — electron mass <span style="white-space:nowrap;">[g]</span>.</li>
            <li><strong>B</strong> — magnetic flux density (magnetic field) <span style="white-space:nowrap;">[gauss]</span>.</li>
            <li><strong>c</strong> — speed of light <span style="white-space:nowrap;">[cm/s]</span>.</li>
            <li><strong>ω<sub>c</sub></strong> — cyclotron frequency <span style="white-space:nowrap;">ω<sub>c</sub>=eB/(mc)</span> <span style="white-space:nowrap;">[s⁻¹]</span>.</li>
            <li><strong>ω<sub>p</sub></strong> — bulk plasma frequency <span style="white-space:nowrap;">ω<sub>p</sub>=√(4πne²/m)</span> <span style="white-space:nowrap;">[s⁻¹]</span>.</li>
            <li><strong>ω<sub>0</sub></strong> — sphere’s uniform (dipole) plasmon frequency <span style="white-space:nowrap;">ω<sub>0</sub>=ω<sub>p</sub>/√3</span> <span style="white-space:nowrap;">[s⁻¹]</span>.</li>
          </ul>
        </div>

        <div class="card">
          <h3>Physical meaning (intuition)</h3>
          <ul>
            <li>The <strong>uniform plasmon mode</strong> of a conducting sphere is the whole electron fluid shifting by a small vector <span style="white-space:nowrap;">r(t)</span> relative to the fixed positive ions.</li>
            <li>This creates a <strong>uniform polarization</strong> inside the sphere, hence a <strong>uniform internal electric field</strong> that pulls the electrons back: a harmonic oscillator.</li>
            <li>A uniform <strong>magnetic field</strong> adds a velocity-dependent sideways force, turning linear oscillation into <strong>circularly polarized</strong> normal modes.</li>
          </ul>
        </div>
      </div>

      <h3>Key laws/principles + validity conditions</h3>
      <ul>
        <li><strong>Maxwell electrostatics (quasi-static):</strong> For the uniform mode we treat the restoring field from static charge separation.
          Mathematically, <span style="white-space:nowrap;">∇×E = 0</span> and <span style="white-space:nowrap;">∇·E = 4πρ</span>.</li>
        <li><strong>Newton–Lorentz for electron fluid CM:</strong> For rigid translation the electron cloud behaves like a single effective mass point:
          <span style="white-space:nowrap;">m r¨ = q(E + r˙×B/c)</span>.</li>
        <li><strong>Uniform displacement approximation:</strong> Mode wavelength is “infinite” compared to sphere size (dipole mode), so internal field is uniform and the displacement is spatially constant.</li>
        <li><strong>Neglects:</strong> collisions (damping), radiation losses, retardation (valid when sphere ≪ wavelength), and spatial dispersion.</li>
      </ul>

      <h3>Common models/approximations and why</h3>
      <ul>
        <li><strong>Jellium model:</strong> Positive background charge fixed; electrons move collectively. Useful for metals, doped semiconductors, plasmas.</li>
        <li><strong>Rigid-shift (Kohn-like) mode:</strong> For a harmonic restoring potential, the center-of-mass coordinate decouples and oscillates cleanly.</li>
        <li><strong>Quasi-electrostatic internal field:</strong> Dipole polarization of a uniformly charged sphere gives a simple restoring field and an analytic ω<sub>0</sub>.</li>
      </ul>

      <h3>Mini intuition examples (minimal algebra)</h3>
      <ul>
        <li><strong>No magnetic field:</strong> electrons shift → surface charge appears → internal uniform E pulls back → oscillation at ω<sub>0</sub>.</li>
        <li><strong>Strong magnetic field:</strong> motion tends to circular cyclotron orbits; restoring electric force slightly perturbs the orbit frequency.</li>
        <li><strong>Very weak restoring force:</strong> one mode becomes nearly free cyclotron motion; the other becomes very slow (like a drift mode).</li>
      </ul>

      <div class="callout warn">
        <strong>What to watch for (pitfalls)</strong>
        <ul>
          <li><strong>Sign conventions:</strong> electron charge is <span style="white-space:nowrap;">q=-e</span>; keep track of the Lorentz force direction.</li>
          <li><strong>Units:</strong> the appearance of <span style="white-space:nowrap;">c</span> in ω<sub>c</sub> indicates Gaussian-cgs; in SI, ω<sub>c</sub>=eB/m (no c).</li>
          <li><strong>Which plasmon?</strong> For a sphere, the uniform dipole mode is ω<sub>p</sub>/√3, not ω<sub>p</sub>.</li>
          <li><strong>Mode restriction:</strong> Problem asks motion in the <span style="white-space:nowrap;">x–y</span> plane (perpendicular to B).</li>
        </ul>
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="p0b">
      <h2>PART 0B — Industry & Applied Physics Perspective</h2>

      <div class="grid2">
        <div class="card">
          <h3>Where this appears (3+ concrete areas)</h3>
          <ul>
            <li><strong>Magneto-plasmonic sensors:</strong> tuning plasmon resonances with magnetic fields to shift spectral response and improve selectivity.</li>
            <li><strong>Semiconductor/2DEG devices in B:</strong> magnetoplasmon resonances used to characterize carrier density and effective mass (e.g., Hall bars, THz spectroscopy).</li>
            <li><strong>Plasma processing & confinement:</strong> magnetized plasma oscillations influence stability and impedance in RF sources and industrial plasma reactors.</li>
            <li><strong>EM shielding & metamaterials:</strong> magnetized conductor inclusions can yield non-reciprocal effective media (bias-controlled response).</li>
          </ul>
        </div>
        <div class="card">
          <h3>Why engineers care</h3>
          <ul>
            <li><strong>Performance:</strong> resonance frequency controls absorption, transmission, and coupling to RF/THz fields.</li>
            <li><strong>Reliability:</strong> strong B-fields can split resonances and shift operating points; ignoring this can cause detuning.</li>
            <li><strong>Cost/efficiency:</strong> measuring ω<sub>±</sub>(B) allows extraction of <span style="white-space:nowrap;">n</span> and <span style="white-space:nowrap;">m*</span> without destructive tests.</li>
            <li><strong>Manufacturability:</strong> real particles deviate from perfect spheres; mode splitting patterns help diagnose shape/anisotropy issues.</li>
          </ul>
        </div>
      </div>

      <h3>Typical measurement/validation methods</h3>
      <ul>
        <li><strong>Optical/THz spectroscopy:</strong> observe absorption peaks vs B; fit ω<sub>±</sub>(B).</li>
        <li><strong>Impedance/RF reflectometry:</strong> resonant response of embedded particles or plasmas in cavities.</li>
        <li><strong>Magneto-transport + microwave:</strong> correlate cyclotron resonance with magnetoplasmon splitting to extract effective mass and damping.</li>
      </ul>

      <h3>Design trade-offs & constraints (non-idealities)</h3>
      <ul>
        <li><strong>Damping (collisions):</strong> finite conductivity adds linewidth; quality factor matters for sensors and resonators.</li>
        <li><strong>Shape and boundaries:</strong> ellipsoids shift ω<sub>0</sub>; surface roughness broadens and splits modes.</li>
        <li><strong>Retardation & radiation:</strong> for larger particles, quasi-static assumption breaks; radiative losses appear.</li>
        <li><strong>Material dispersion:</strong> effective mass <span style="white-space:nowrap;">m*</span> and density <span style="white-space:nowrap;">n</span> may be frequency- and temperature-dependent.</li>
      </ul>

      <div class="callout">
        <strong>From lab to product:</strong>
        In real devices, the “ideal sphere in uniform B” becomes a biased inclusion embedded in a host medium with finite losses.
        Engineers typically replace <span style="white-space:nowrap;">ω<sub>0</sub></span> by a geometry- and environment-corrected resonance,
        add damping <span style="white-space:nowrap;">γ</span> (Drude scattering), and validate with spectroscopy or RF network measurements.
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="p1">
      <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

      <p><strong>Restated problem:</strong> A conducting sphere contains a uniform electron gas (density <span style="white-space:nowrap;">n</span>) in a fixed positive background. Place the sphere in a constant uniform magnetic field <span style="white-space:nowrap;">B</span> along the <span style="white-space:nowrap;">z</span>-axis. Using the “uniform displacement” method (Problem 5), find the frequency (eigenfrequencies) of the sphere’s uniform plasmon mode, taking motion in the <span style="white-space:nowrap;">x–y</span> plane. The answer must reduce to cyclotron motion in one limit and to <span style="white-space:nowrap;">ω<sub>0</sub>=√(4πne²/(3m))</span> in another.</p>

      <div class="grid2">
        <div class="card">
          <h3>Given</h3>
          <ul>
            <li>Sphere with uniform electron density <span style="white-space:nowrap;">n</span>.</li>
            <li>Magnetic field <span style="white-space:nowrap;">B = B ẑ</span> (constant).</li>
            <li>Electron mass <span style="white-space:nowrap;">m</span>, charge <span style="white-space:nowrap;">q=-e</span>.</li>
            <li>Uniform plasmon method: treat electron cloud as rigidly displaced.</li>
          </ul>
        </div>
        <div class="card">
          <h3>Unknowns / what to find</h3>
          <ul>
            <li>The magnetoplasmon eigenfrequencies <span style="white-space:nowrap;">ω</span> for motion in <span style="white-space:nowrap;">x–y</span>.</li>
            <li>Show correct limiting cases:
              <ul>
                <li><span style="white-space:nowrap;">B→0</span> (or <span style="white-space:nowrap;">ω<sub>c</sub>→0</span>): recover <span style="white-space:nowrap;">ω=ω<sub>0</sub></span>.</li>
                <li>Weak restoring force (or high B): one mode tends to <span style="white-space:nowrap;">ω<sub>c</sub></span>.</li>
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <h3>Relevant principles and why they apply</h3>
      <ul>
        <li><strong>Electrostatic restoring field in a polarized sphere:</strong> A rigid displacement creates uniform polarization; by symmetry, internal <span style="white-space:nowrap;">E</span> is uniform.</li>
        <li><strong>Newton–Lorentz for collective coordinate:</strong> For uniform translation, internal pressure terms cancel in the center-of-mass equation; only net electromagnetic forces remain.</li>
        <li><strong>Linearity:</strong> Small displacement implies linear restoring force (Hooke’s law form).</li>
      </ul>

      <div class="callout ok">
        <strong>Assumptions (explicit)</strong>
        <ul>
          <li>Small displacement: keep only linear terms in <span style="white-space:nowrap;">r</span> and <span style="white-space:nowrap;">r˙</span>.</li>
          <li>Quasi-static field: neglect retardation and radiation; sphere size small relative to EM wavelength at ω.</li>
          <li>Collisionless (no damping): ignore scattering; purely real eigenfrequencies.</li>
          <li>Uniform sphere, isotropic mass <span style="white-space:nowrap;">m</span>, uniform density <span style="white-space:nowrap;">n</span>.</li>
          <li>Motion restricted to <span style="white-space:nowrap;">x–y</span> plane (perpendicular to B).</li>
        </ul>
      </div>

      <h3>Possible approaches (compare)</h3>
      <div class="grid2">
        <div class="card">
          <h3>Approach A: Rigid CM equation + electrostatic field (best)</h3>
          <ul>
            <li>Compute restoring <span style="white-space:nowrap;">E</span> inside displaced sphere, then write Lorentz equation.</li>
            <li><strong>Pros:</strong> shortest, fully analytic, exposes physics and limits.</li>
            <li><strong>Cons:</strong> relies on knowing polarized-sphere field.</li>
          </ul>
        </div>
        <div class="card">
          <h3>Approach B: Hydrodynamic plasma model</h3>
          <ul>
            <li>Start from fluid momentum equation with <span style="white-space:nowrap;">∂t</span> and <span style="white-space:nowrap;">v×B</span>, plus Poisson for <span style="white-space:nowrap;">E</span>.</li>
            <li><strong>Pros:</strong> generalizes to non-uniform modes and includes pressure.</li>
            <li><strong>Cons:</strong> more PDE machinery than needed for the uniform mode.</li>
          </ul>
        </div>
      </div>

      <p><strong>Chosen method:</strong> Approach A, because the problem explicitly references the “method of Problem 5” (rigid shift of electron cloud), which naturally yields a linear ODE eigenvalue problem.</p>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="p2">
      <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

      <ol style="color:var(--muted); margin-left:18px;">
        <li><strong>Define the collective coordinate</strong> <span style="white-space:nowrap;">r(t)=(x(t),y(t),0)</span> describing the electron cloud displacement (goal: reduce many-body motion to one vector).</li>
        <li><strong>Find the induced charge/polarization</strong> from a small uniform shift (tool: symmetry + polarization of a sphere).</li>
        <li><strong>Compute the internal restoring field</strong> <span style="white-space:nowrap;">E(r)</span> (tool: electrostatics; result should be uniform and linear in <span style="white-space:nowrap;">r</span>).</li>
        <li><strong>Write the Lorentz-force ODE</strong> for an electron (or CM) in that field with <span style="white-space:nowrap;">B=B ẑ</span> (tool: Newton–Lorentz).</li>
        <li><strong>Project into components</strong> in the <span style="white-space:nowrap;">x–y</span> plane (goal: a 2×2 linear system with gyroscopic coupling).</li>
        <li><strong>Assume harmonic time dependence</strong> <span style="white-space:nowrap;">e^{-iωt}</span> (tool: linearity; converts ODE → algebraic eigenvalue problem).</li>
        <li><strong>Solve the determinant condition</strong> for <span style="white-space:nowrap;">ω</span> (goal: two eigenfrequencies).</li>
        <li><strong>Sanity checks</strong>: dimensions, <span style="white-space:nowrap;">B→0</span> limit, strong-B or weak-restoring-force limit.</li>
      </ol>

      <div class="callout danger">
        <strong>Common mistakes</strong>
        <ul>
          <li>Using <span style="white-space:nowrap;">ω<sub>p</sub></span> instead of the sphere dipole frequency <span style="white-space:nowrap;">ω<sub>0</sub>=ω<sub>p</sub>/√3</span>.</li>
          <li>Dropping the electron sign: the Lorentz term direction changes with charge.</li>
          <li>Mixing SI and Gaussian: <span style="white-space:nowrap;">ω<sub>c</sub></span> has <span style="white-space:nowrap;">c</span> only in Gaussian-cgs.</li>
          <li>Forgetting there are <strong>two</strong> circularly polarized modes (splitting).</li>
        </ul>
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="p3">
      <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

      <h3>3.1 Physical intuition before calculating</h3>
      <p>
        Without a magnetic field, the electron cloud’s uniform displacement creates a dipole-like surface charge and a uniform internal electric field that restores the cloud to equilibrium.
        That is a 2D isotropic harmonic oscillator in the plane: frequency <span style="white-space:nowrap;">ω<sub>0</sub></span>.
        Turning on <span style="white-space:nowrap;">B ẑ</span> adds a sideways velocity force, so the natural motions become clockwise/counterclockwise circular oscillations with split frequencies.
      </p>

      <h3>3.2 Mathematical model (variables, domain, coordinates, conditions)</h3>
      <div class="callout">
        <ul>
          <li><strong>Domain:</strong> conducting sphere of radius <span style="white-space:nowrap;">R</span> with uniform electron density <span style="white-space:nowrap;">n</span> and fixed positive background (jellium).</li>
          <li><strong>Coordinate system:</strong> Cartesian with <span style="white-space:nowrap;">B = B ẑ</span>. Motion restricted to <span style="white-space:nowrap;">x–y</span> plane: <span style="white-space:nowrap;">r(t)=(x(t),y(t),0)</span>.</li>
          <li><strong>Unknown:</strong> eigenfrequencies <span style="white-space:nowrap;">ω</span> of small oscillations.</li>
          <li><strong>Boundary/initial conditions:</strong> free oscillations (no driving), so solve homogeneous ODE with nontrivial solutions; initial conditions select mode amplitudes but not ω.</li>
          <li><strong>Electrostatics inside sphere:</strong> <span style="white-space:nowrap;">∇×E=0</span>, <span style="white-space:nowrap;">∇·E=4πρ</span> (quasi-static).</li>
        </ul>
      </div>

      <h3>3.3 Step 1 — Restoring electric field for a uniformly displaced electron sphere</h3>
      <p>
        Let the electron cloud be displaced by a small vector <span style="white-space:nowrap;">r</span> relative to the ions.
        This produces a uniform polarization <span style="white-space:nowrap;">P</span> inside the sphere:
      </p>

      <div class="eq" id="eqP">
        <div class="label">Uniform polarization from rigid shift</div>
        <button class="copybtn" data-copy="P = - n e r">Copy</button>
        P = - n e r
      </div>

      <p>
        Explanation: polarization is dipole moment per unit volume. Shifting a density <span style="white-space:nowrap;">-ne</span> by <span style="white-space:nowrap;">r</span> gives dipole density <span style="white-space:nowrap;">(-ne) r</span>.
        The minus sign reflects the negative electron charge.
      </p>

      <p>
        For a uniformly polarized sphere in electrostatics, the internal electric field is uniform and given by:
      </p>

      <div class="eq" id="eqEsphere">
        <div class="label">Field inside a uniformly polarized sphere (Gaussian-cgs)</div>
        <button class="copybtn" data-copy="E_int = - (4π/3) P">Copy</button>
        E_int = - (4π/3) P
      </div>

      <p>
        This result follows from symmetry (only a uniform field is compatible with uniform <span style="white-space:nowrap;">P</span> inside a sphere) and the standard bound-charge relations
        <span style="white-space:nowrap;">ρ_b = -∇·P = 0</span> (uniform P) and <span style="white-space:nowrap;">σ_b = P·n̂</span> on the surface, which creates a dipole field.
      </p>

      <p>
        Substitute <span style="white-space:nowrap;">P = -ne r</span> into <span style="white-space:nowrap;">E_int</span>:
      </p>

      <div class="eq" id="eqErest">
        <div class="label">Restoring field in terms of displacement</div>
        <button class="copybtn" data-copy="E_int = (4π n e / 3) r">Copy</button>
        E_int = (4π n e / 3) r
      </div>

      <p>
        Notice the field points in the <em>same direction</em> as <span style="white-space:nowrap;">r</span>. Since electrons have charge <span style="white-space:nowrap;">q=-e</span>, the electric force <span style="white-space:nowrap;">qE</span> points opposite <span style="white-space:nowrap;">r</span>, i.e., it is restoring.
      </p>

      <h3>3.4 Step 2 — Equation of motion including the magnetic field</h3>
      <p>
        The Newton–Lorentz equation for an electron (equivalently, the electron cloud’s center-of-mass per electron) is:
      </p>

      <div class="eq" id="eqLorentz">
        <div class="label">Newton–Lorentz ODE (Gaussian-cgs)</div>
        <button class="copybtn" data-copy="m r¨ = q (E_int + r˙ × B / c),  q = -e">Copy</button>
        m r¨ = q (E_int + r˙ × B / c), &nbsp; q = -e
      </div>

      <p>
        Insert <span style="white-space:nowrap;">E_int = (4π n e / 3) r</span> and <span style="white-space:nowrap;">q=-e</span>:
      </p>

      <div class="eq" id="eqODEvector">
        <div class="label">Vector ODE for the uniform mode</div>
        <button class="copybtn" data-copy="m r¨ = -e ( (4π n e / 3) r ) - (e/c) r˙ × B">Copy</button>
        m r¨ = -e ( (4π n e / 3) r ) - (e/c) r˙ × B
      </div>

      <p>
        Define the sphere’s dipole plasmon frequency:
      </p>

      <div class="eq" id="eqw0">
        <div class="label">Uniform (dipole) plasmon frequency of a sphere</div>
        <button class="copybtn" data-copy="ω0^2 = (4π n e^2)/(3 m)">Copy</button>
        ω0² = (4π n e²)/(3 m)
      </div>

      <p>
        and cyclotron frequency:
      </p>

      <div class="eq" id="eqwc">
        <div class="label">Cyclotron frequency (Gaussian-cgs)</div>
        <button class="copybtn" data-copy="ωc = eB/(m c)">Copy</button>
        ωc = eB/(m c)
      </div>

      <p>
        Divide the ODE by <span style="white-space:nowrap;">m</span> and restrict to <span style="white-space:nowrap;">r=(x,y,0)</span> with <span style="white-space:nowrap;">B=B ẑ</span>.
        Compute <span style="white-space:nowrap;">r˙×B</span>:
      </p>
      <div class="eq" id="eqcross">
        <div class="label">Cross product in components</div>
        <button class="copybtn" data-copy="(x˙, y˙, 0) × (0, 0, B) = (y˙ B, -x˙ B, 0)">Copy</button>
        (x˙, y˙, 0) × (0, 0, B) = (y˙ B, -x˙ B, 0)
      </div>

      <p>
        Therefore the component equations become (using the sign from electron charge carefully):
      </p>

      <div class="eq" id="eqcomponents">
        <div class="label">Coupled linear ODEs in the x–y plane</div>
        <button class="copybtn" data-copy="x¨ + ω0^2 x + ωc y˙ = 0
y¨ + ω0^2 y - ωc x˙ = 0">Copy</button>
x¨ + ω0² x + ωc y˙ = 0
y¨ + ω0² y - ωc x˙ = 0
      </div>

      <p>
        These are linear with constant coefficients, so harmonic solutions exist and superpose (linearity justifies the Fourier ansatz).
      </p>

      <h3>3.5 Step 3 — Solve the eigenvalue problem (harmonic ansatz)</h3>
      <p>
        Assume free oscillations of the form:
        <span style="white-space:nowrap;">x(t)=X e^{-iωt}</span>, <span style="white-space:nowrap;">y(t)=Y e^{-iωt}</span>.
        Then <span style="white-space:nowrap;">x˙=-iωX e^{-iωt}</span>, <span style="white-space:nowrap;">x¨=-ω²X e^{-iωt}</span>, and similarly for <span style="white-space:nowrap;">y</span>.
        Substitute into the ODEs and cancel the common factor <span style="white-space:nowrap;">e^{-iωt}</span>:
      </p>

      <div class="eq" id="eqmatrix">
        <div class="label">Algebraic system (eigenmode condition)</div>
        <button class="copybtn" data-copy="(ω0^2 - ω^2) X - i ω ωc Y = 0
(ω0^2 - ω^2) Y + i ω ωc X = 0">Copy</button>
(ω0² - ω²) X - i ω ωc Y = 0
(ω0² - ω²) Y + i ω ωc X = 0
      </div>

      <p>
        This is a homogeneous linear system in <span style="white-space:nowrap;">(X,Y)</span>. Nontrivial solutions exist only if the determinant is zero:
      </p>

      <div class="eq" id="eqdet">
        <div class="label">Determinant condition</div>
        <button class="copybtn" data-copy="(ω0^2 - ω^2)^2 - (ω^2 ωc^2) = 0">Copy</button>
(ω0² - ω²)² - (ω² ωc²) = 0
      </div>

      <p>
        Solve:
      </p>
      <div class="eq" id="eqquad">
        <div class="label">Reduce to quadratics (take square root consistently)</div>
        <button class="copybtn" data-copy="(ω0^2 - ω^2) = ± ω ωc  ⇒  ω^2 ± ω ωc - ω0^2 = 0">Copy</button>
(ω0² - ω²) = ± ω ωc  ⇒  ω² ± ω ωc - ω0² = 0
      </div>

      <p>
        Each sign gives a quadratic equation in ω. Solving (and keeping the positive-frequency roots):
      </p>

      <div class="eq" id="eqfinal">
        <div class="label">Final eigenfrequencies (magnetoplasmon splitting)</div>
        <button class="copybtn" data-copy="ω± = (1/2) ( sqrt(ωc^2 + 4 ω0^2) ± ωc ),   with  ω0^2 = 4π n e^2/(3m),  ωc = eB/(mc)">Copy</button>
ω± = (1/2) ( √(ωc² + 4 ω0²) ± ωc ),
with  ω0² = 4π n e²/(3m),  ωc = eB/(mc)
      </div>

      <div class="callout ok">
        <strong>Final Answer (boxed):</strong>
        The uniform (dipole) plasmon of a sphere in <span style="white-space:nowrap;">B ẑ</span> splits into two circularly polarized magnetoplasmon modes:
        <span style="white-space:nowrap;">ω<sub>±</sub> = ½(√(ω<sub>c</sub>² + 4ω<sub>0</sub>²) ± ω<sub>c</sub>)</span>,
        where <span style="white-space:nowrap;">ω<sub>0</sub>=√(4πne²/(3m))</span> and <span style="white-space:nowrap;">ω<sub>c</sub>=eB/(mc)</span>.
      </div>

      <h3>3.6 Sanity checks</h3>

      <div class="grid2">
        <div class="card">
          <h3>Units/dimensions</h3>
          <ul>
            <li><span style="white-space:nowrap;">ω<sub>0</sub>² ∝ (ne²/m)</span> has units of <span style="white-space:nowrap;">s⁻²</span> in Gaussian-cgs (same as ω<sub>p</sub>²).</li>
            <li><span style="white-space:nowrap;">ω<sub>c</sub> = eB/(mc)</span> has units <span style="white-space:nowrap;">s⁻¹</span>.</li>
            <li>Therefore <span style="white-space:nowrap;">√(ω<sub>c</sub>²+4ω<sub>0</sub>²)</span> is a frequency; ω± are frequencies.</li>
          </ul>
        </div>
        <div class="card">
          <h3>Limiting cases (required by problem)</h3>
          <ul>
            <li><strong>No magnetic field:</strong> <span style="white-space:nowrap;">ω<sub>c</sub>→0</span> ⇒ <span style="white-space:nowrap;">ω<sub>±</sub>→½(2ω<sub>0</sub>)=ω<sub>0</sub></span> (degenerate, as expected).</li>
            <li><strong>Weak restoring force / strong B:</strong> <span style="white-space:nowrap;">ω<sub>0</sub>≪ω<sub>c</sub></span>:
              <details>
                <summary>Show the asymptotic expansion</summary>
                <div class="eq">
                  √(ωc² + 4ω0²) = ωc √(1 + 4ω0²/ωc²)
                  ≈ ωc (1 + 2ω0²/ωc²) = ωc + 2ω0²/ωc
                </div>
                Then:
                <div class="eq">
                  ω+ ≈ ½(ωc + 2ω0²/ωc + ωc) = ωc + ω0²/ωc  → ωc
                  ω- ≈ ½(ωc + 2ω0²/ωc - ωc) = ω0²/ωc  → 0
                </div>
              </details>
              So one mode approaches the cyclotron frequency <span style="white-space:nowrap;">ω<sub>c</sub></span>, as demanded.
            </li>
          </ul>
        </div>
      </div>

      <h3>3.7 Static plot (dimensionless splitting)</h3>
      <p>
        To visualize the splitting without choosing numerical material parameters, plot the dimensionless frequencies
        <span style="white-space:nowrap;">Ω<sub>±</sub> = ω<sub>±</sub>/ω<sub>0</sub></span> versus <span style="white-space:nowrap;">β = ω<sub>c</sub>/ω<sub>0</sub></span>:
        <span style="white-space:nowrap;">Ω<sub>±</sub> = ½(√(β²+4) ± β)</span>.
      </p>

      <figure>
        <canvas id="plot" aria-label="Magnetoplasmon splitting plot"></canvas>
        <figcaption>
          Dimensionless magnetoplasmon frequencies for a sphere: <span style="white-space:nowrap;">Ω±=½(√(β²+4)±β)</span>, with <span style="white-space:nowrap;">β=ωc/ω0</span>.
          At β=0 the two modes coincide at Ω=1; at large β, Ω+→β (cyclotron-like) and Ω−→1/β (slow mode).
        </figcaption>
      </figure>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="p4">
      <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

      <h3>4.1 Re-interpret the final formula</h3>
      <ul>
        <li><strong>ω<sub>0</sub></strong> sets the “electrostatic stiffness” of the sphere’s uniform polarization: larger density <span style="white-space:nowrap;">n</span> → stronger restoring field → higher resonance.</li>
        <li><strong>ω<sub>c</sub></strong> sets the “gyroscopic coupling” strength: larger B → stronger coupling between x and y velocities.</li>
        <li>The square root <span style="white-space:nowrap;">√(ω<sub>c</sub>²+4ω<sub>0</sub>²)</span> is the natural combined scale from adding a restoring operator and an antisymmetric rotation operator.</li>
      </ul>

      <div class="callout">
        <strong>Operator viewpoint (Math Insight, expanded):</strong>
        In the plane, define the 90° rotation operator <span style="white-space:nowrap;">J</span> by
        <span style="white-space:nowrap;">J(x,y) = (y,-x)</span>, so that <span style="white-space:nowrap;">r˙×ẑ = J r˙</span>.
        The ODE becomes:
        <div class="eq">
          r¨ + ω0² r + ωc J r˙ = 0
        </div>
        This is a linear constant-coefficient system. Because <span style="white-space:nowrap;">J</span> has eigenvectors of circular polarization
        <span style="white-space:nowrap;">(1, ± i)</span>, the system diagonalizes in that basis, yielding the two quadratic characteristic equations.
      </div>

      <h3>4.2 Parameter dependence (qualitative)</h3>
      <ul>
        <li>Increasing <strong>n</strong> increases <strong>ω<sub>0</sub></strong> and therefore increases both ω<sub>+</sub> and ω<sub>−</sub> (at fixed B), though their splitting depends strongly on ω<sub>c</sub>/ω<sub>0</sub>.</li>
        <li>Increasing <strong>B</strong> increases <strong>ω<sub>c</sub></strong>: ω<sub>+</sub> grows roughly linearly with B at large B, while ω<sub>−</sub> decreases roughly like 1/B at large B.</li>
        <li>Increasing <strong>m</strong> (or effective mass <span style="white-space:nowrap;">m*</span> in materials) decreases both ω<sub>0</sub> and ω<sub>c</sub>; the net effect depends on which ratio is held fixed.</li>
      </ul>

      <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
      <p>
        A fluid derivation starts from the collisionless momentum equation (linearized) for electron velocity <span style="white-space:nowrap;">v</span> and density perturbation <span style="white-space:nowrap;">δn</span>:
      </p>
      <div class="eq">
        m ∂v/∂t = -e (E + v×B/c),  &nbsp; ∂(δn)/∂t + n ∇·v = 0,  &nbsp; ∇·E = 4π(-e δn)
      </div>
      <p>
        For the uniform dipole mode, <span style="white-space:nowrap;">v</span> is spatially uniform and <span style="white-space:nowrap;">∇·v</span> vanishes in the bulk; the dynamics reduces to the same center-of-mass ODE we solved.
        This is essentially the “lowest” (dipole) eigenmode of the coupled Maxwell–fluid system under quasi-static conditions.
      </p>

      <h3>4.4 Concept check (self-test with answers)</h3>
      <ul>
        <li><strong>Q:</strong> Why is ω<sub>0</sub> for a sphere equal to ω<sub>p</sub>/√3? <br><strong>A:</strong> The internal restoring field for a uniformly polarized sphere is reduced by the depolarization factor 1/3, giving <span style="white-space:nowrap;">ω<sub>0</sub>² = ω<sub>p</sub>²/3</span>.</li>
        <li><strong>Q:</strong> Why are there two frequencies, not one? <br><strong>A:</strong> The magnetic field breaks time-reversal symmetry and couples x and y; the normal modes are clockwise/counterclockwise circular polarizations with different eigenvalues.</li>
        <li><strong>Q:</strong> Which mode becomes cyclotron-like at strong B? <br><strong>A:</strong> The upper branch ω<sub>+</sub> → ω<sub>c</sub> when ω<sub>0</sub>≪ω<sub>c</sub>.</li>
        <li><strong>Q:</strong> What happens if you allow motion along z (parallel to B)? <br><strong>A:</strong> The Lorentz force vanishes for parallel motion, so that degree behaves like the B=0 oscillator at ω<sub>0</sub> (in this ideal model).</li>
      </ul>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="p5">
      <h2>PART 5 — Optional Plot Guide</h2>

      <div class="callout">
        <strong>What the plot shows and why it’s useful:</strong>
        It visualizes how a single plasmon resonance at <span style="white-space:nowrap;">ω=ω<sub>0</sub></span> splits into two magnetoplasmon branches as the magnetic field increases.
        This helps you immediately read off the two key limits: degeneracy at <span style="white-space:nowrap;">B=0</span> and cyclotron-like behavior at strong B.
      </div>

      <ul>
        <li><strong>x-axis:</strong> <span style="white-space:nowrap;">β = ω<sub>c</sub>/ω<sub>0</sub></span> (dimensionless magnetic-field strength).</li>
        <li><strong>y-axis:</strong> <span style="white-space:nowrap;">Ω = ω/ω<sub>0</sub></span> (dimensionless frequency).</li>
        <li><strong>Curves:</strong> <span style="white-space:nowrap;">Ω<sub>±</sub> = ½(√(β²+4) ± β)</span>.</li>
        <li><strong>Features to notice:</strong>
          <ul>
            <li>At <span style="white-space:nowrap;">β=0</span>: <span style="white-space:nowrap;">Ω<sub>+</sub>=Ω<sub>−</sub>=1</span>.</li>
            <li>As <span style="white-space:nowrap;">β→∞</span>: <span style="white-space:nowrap;">Ω<sub>+</sub>≈β</span> (cyclotron-like), <span style="white-space:nowrap;">Ω<sub>−</sub>≈1/β</span> (slow mode).</li>
          </ul>
        </li>
      </ul>

      <div class="eq" id="eqFinalCopy">
        <div class="label">Final answer (plain text)</div>
        <button class="copybtn" data-copy="For a sphere with electron density n in uniform B = B z-hat (motion in x–y), the uniform plasmon splits into two magnetoplasmon modes:
ω± = (1/2) ( sqrt(ωc^2 + 4 ω0^2) ± ωc ),
where ωc = eB/(mc) and ω0 = sqrt(4π n e^2/(3m)).">Copy</button>
For a sphere with electron density n in uniform B = B z-hat (motion in x–y), the uniform plasmon splits into two magnetoplasmon modes:
ω± = (1/2) ( sqrt(ωc^2 + 4 ω0^2) ± ωc ),
where ωc = eB/(mc) and ω0 = sqrt(4π n e^2/(3m)).
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>
  </article>
</main>

<footer>
  <p>
    Notes: This derivation assumes a collisionless, quasi-electrostatic uniform mode of a sphere (dipole mode).
    In real materials, damping (Drude scattering), shape anisotropy, and radiative effects can shift and broaden the resonance.
  </p>
</footer>

<script>
  // Copy-to-clipboard for equation blocks
  (function(){
    function copyText(text){
      if(navigator.clipboard && window.isSecureContext){
        return navigator.clipboard.writeText(text);
      }
      // fallback
      const ta = document.createElement('textarea');
      ta.value = text;
      ta.style.position='fixed';
      ta.style.left='-9999px';
      ta.style.top='-9999px';
      document.body.appendChild(ta);
      ta.focus();
      ta.select();
      try{ document.execCommand('copy'); }catch(e){}
      document.body.removeChild(ta);
      return Promise.resolve();
    }
    document.querySelectorAll('.copybtn').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const text = btn.getAttribute('data-copy') || '';
        const old = btn.textContent;
        await copyText(text);
        btn.textContent = 'Copied ✓';
        setTimeout(()=>btn.textContent = old, 900);
      });
    });
  })();

  // Canvas plot: Ω± vs β
  (function(){
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    function dpr(){ return window.devicePixelRatio || 1; }

    function resize(){
      const rect = canvas.getBoundingClientRect();
      const r = dpr();
      canvas.width = Math.floor(rect.width * r);
      canvas.height = Math.floor(rect.height * r);
      ctx.setTransform(r,0,0,r,0,0); // draw in CSS pixels
      draw(rect.width, rect.height);
    }

    function draw(w, h){
      ctx.clearRect(0,0,w,h);

      // Layout
      const padL = 54, padR = 18, padT = 22, padB = 44;
      const x0 = padL, y0 = h - padB, x1 = w - padR, y1 = padT;

      // Axes ranges
      const betaMin = 0, betaMax = 5;
      const yMin = 0, yMax = 5.2; // enough for Ω+ at beta=5 -> ~ (sqrt(29)+5)/2 ~ 5.19

      const X = (beta)=> x0 + (beta - betaMin) * (x1 - x0) / (betaMax - betaMin);
      const Y = (yy)=> y0 - (yy - yMin) * (y0 - y1) / (yMax - yMin);

      // Helpers
      function line(xa, ya, xb, yb){
        ctx.beginPath(); ctx.moveTo(xa,ya); ctx.lineTo(xb,yb); ctx.stroke();
      }
      function text(str, x, y, align='left', base='alphabetic'){
        ctx.textAlign = align; ctx.textBaseline = base;
        ctx.fillText(str, x, y);
      }

      // Grid
      ctx.lineWidth = 1;
      ctx.strokeStyle = 'rgba(255,255,255,0.10)';
      ctx.fillStyle = 'rgba(255,255,255,0.75)';
      ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';

      // vertical grid + ticks
      for(let b=0; b<=5; b++){
        const xx = X(b);
        line(xx, y1, xx, y0);
        ctx.fillStyle = 'rgba(255,255,255,0.75)';
        text(String(b), xx, y0+18, 'center', 'alphabetic');
      }
      // horizontal grid + ticks
      for(let yy=0; yy<=5; yy++){
        const yyPix = Y(yy);
        line(x0, yyPix, x1, yyPix);
        ctx.fillStyle = 'rgba(255,255,255,0.75)';
        text(String(yy), x0-10, yyPix, 'right', 'middle');
      }

      // Axes
      ctx.strokeStyle = 'rgba(255,255,255,0.45)';
      ctx.lineWidth = 1.4;
      line(x0, y0, x1, y0);
      line(x0, y0, x0, y1);

      // Title and labels
      ctx.fillStyle = 'rgba(255,255,255,0.92)';
      ctx.font = '13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      text('Magnetoplasmon splitting (dimensionless)', (x0+x1)/2, 10, 'center', 'top');

      ctx.fillStyle = 'rgba(255,255,255,0.85)';
      ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      text('β = ωc / ω0', (x0+x1)/2, h-10, 'center', 'alphabetic');

      // y label rotated
      ctx.save();
      ctx.translate(14, (y0+y1)/2);
      ctx.rotate(-Math.PI/2);
      text('Ω = ω / ω0', 0, 0, 'center', 'alphabetic');
      ctx.restore();

      // Curves
      function OmegaPlus(beta){ return 0.5*(Math.sqrt(beta*beta + 4) + beta); }
      function OmegaMinus(beta){ return 0.5*(Math.sqrt(beta*beta + 4) - beta); }

      function drawCurve(f, stroke){
        ctx.strokeStyle = stroke;
        ctx.lineWidth = 2.2;
        ctx.beginPath();
        const N = 260;
        for(let i=0;i<=N;i++){
          const beta = betaMin + (betaMax-betaMin)*i/N;
          const yy = f(beta);
          const xx = X(beta), yPix = Y(yy);
          if(i===0) ctx.moveTo(xx,yPix); else ctx.lineTo(xx,yPix);
        }
        ctx.stroke();
      }

      // No explicit color choices were requested; use default strokeStyle values derived from theme.
      // We'll keep them subtle and different via opacity.
      drawCurve(OmegaPlus, 'rgba(125,211,252,0.95)');
      drawCurve(OmegaMinus, 'rgba(167,243,208,0.90)');

      // Legend
      const lx = x1 - 190, ly = y1 + 8;
      ctx.fillStyle = 'rgba(0,0,0,0.25)';
      ctx.strokeStyle = 'rgba(255,255,255,0.12)';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.roundRect(lx, ly, 176, 44, 10);
      ctx.fill(); ctx.stroke();

      ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      // plus
      ctx.strokeStyle = 'rgba(125,211,252,0.95)';
      ctx.lineWidth = 3;
      line(lx+12, ly+14, lx+34, ly+14);
      ctx.fillStyle = 'rgba(255,255,255,0.88)';
      text('Ω+ = ½(√(β²+4)+β)', lx+42, ly+18, 'left', 'middle');
      // minus
      ctx.strokeStyle = 'rgba(167,243,208,0.90)';
      ctx.lineWidth = 3;
      line(lx+12, ly+32, lx+34, ly+32);
      ctx.fillStyle = 'rgba(255,255,255,0.88)';
      text('Ω− = ½(√(β²+4)−β)', lx+42, ly+36, 'left', 'middle');
    }

    // Polyfill for roundRect if missing
    if(!CanvasRenderingContext2D.prototype.roundRect){
      CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
        const rr = Math.min(r, w/2, h/2);
        this.beginPath();
        this.moveTo(x+rr, y);
        this.arcTo(x+w, y, x+w, y+h, rr);
        this.arcTo(x+w, y+h, x, y+h, rr);
        this.arcTo(x, y+h, x, y, rr);
        this.arcTo(x, y, x+w, y, rr);
        this.closePath();
        return this;
      };
    }

    window.addEventListener('resize', resize, {passive:true});
    resize();
  })();
</script>
</body>
</html>