<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Alfvén Waves in an Electron–Hole Solid (Magnetized Plasma in a Semiconductor)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#101826;
      --panel2:#0f1520;
      --text:#e8eef7;
      --muted:#b7c3d6;
      --faint:#7f90aa;
      --accent:#7dd3fc;
      --accent2:#a7f3d0;
      --warn:#fbbf24;
      --ok:#34d399;
      --bad:#fb7185;
      --border:rgba(255,255,255,.10);
      --border2:rgba(255,255,255,.06);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --serif: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
      --radius: 16px;
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family: var(--sans);
      background: radial-gradient(1200px 700px at 15% 10%, rgba(125,211,252,.10), transparent 60%),
                  radial-gradient(900px 600px at 80% 20%, rgba(167,243,208,.08), transparent 55%),
                  radial-gradient(900px 600px at 50% 90%, rgba(251,191,36,.06), transparent 60%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }

    header{
      padding: 38px 18px 18px;
      border-bottom:1px solid var(--border2);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .wrap{
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 12px;
    }
    .title{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
      align-items:start;
    }
    h1{
      font-size: clamp(1.55rem, 2.6vw, 2.25rem);
      line-height:1.15;
      margin:0;
      letter-spacing:-0.02em;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      max-width: 90ch;
    }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 10px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: rgba(16,24,38,.55);
      box-shadow: 0 6px 18px rgba(0,0,0,.18);
      color:var(--muted);
      font-size: .92rem;
      backdrop-filter: blur(6px);
    }
    .dot{
      width:8px;height:8px;border-radius:50%;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(125,211,252,.12);
    }

    main{
      padding: 20px 12px 60px;
    }

    .layout{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
    }

    nav{
      position: sticky;
      top: 14px;
      align-self:start;
      background: rgba(16,24,38,.55);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    nav .navhead{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--border2);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    nav .navhead strong{
      font-size: .95rem;
      letter-spacing:.02em;
      color: var(--text);
    }
    nav .navlinks{
      padding: 8px 10px 12px;
      display:grid;
      gap: 2px;
    }
    nav a{
      display:block;
      padding: 9px 10px;
      border-radius: 12px;
      color: var(--muted);
      text-decoration:none;
      border: 1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size:.94rem;
    }
    nav a:hover{
      background: rgba(255,255,255,.05);
      border-color: rgba(255,255,255,.08);
      transform: translateY(-1px);
      color: var(--text);
    }
    nav .small{
      padding: 10px 14px 14px;
      border-top: 1px solid var(--border2);
      color: var(--faint);
      font-size: .88rem;
    }

    article{
      background: rgba(16,24,38,.45);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    section{
      padding: 18px 18px 6px;
      border-top: 1px solid var(--border2);
    }
    section:first-child{border-top:none}
    h2{
      margin: 0 0 10px;
      font-size: clamp(1.15rem, 1.9vw, 1.45rem);
      letter-spacing:-0.01em;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 1.05rem;
      color: var(--text);
    }
    p{margin: 0 0 12px; color: var(--muted)}
    ul,ol{margin: 8px 0 12px; color: var(--muted)}
    li{margin: 6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns: 1fr}
      nav{position:relative; top:auto}
      .grid2{grid-template-columns:1fr}
    }

    .card{
      background: rgba(15,21,32,.75);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px 12px 10px;
      box-shadow: 0 10px 24px rgba(0,0,0,.20);
    }
    .callouts{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin: 10px 0 14px;
    }
    .callout{
      border-left: 4px solid var(--accent);
      background: rgba(125,211,252,.08);
      border-radius: 12px;
      padding: 12px 12px 10px;
      border: 1px solid rgba(125,211,252,.18);
    }
    .callout.warn{
      border-left-color: var(--warn);
      background: rgba(251,191,36,.10);
      border-color: rgba(251,191,36,.20);
    }
    .callout.ok{
      border-left-color: var(--ok);
      background: rgba(52,211,153,.08);
      border-color: rgba(52,211,153,.18);
    }
    .callout.bad{
      border-left-color: var(--bad);
      background: rgba(251,113,133,.08);
      border-color: rgba(251,113,133,.18);
    }
    .callout strong{color: var(--text)}
    .callout p{margin:6px 0 0; color: var(--muted)}

    .eqwrap{
      margin: 10px 0 14px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(0,0,0,.25);
      overflow:hidden;
    }
    .eqbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding: 10px 10px;
      border-bottom: 1px solid var(--border2);
      background: rgba(255,255,255,.03);
    }
    .eqbar .label{
      font-size:.92rem;
      color: var(--text);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .eqbar .label .mini{
      font-size:.82rem;
      color: var(--faint);
      padding: 2px 8px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(16,24,38,.55);
    }
    pre{
      margin:0;
      padding: 12px 12px 14px;
      overflow:auto;
      font-family: var(--mono);
      font-size: .93rem;
      color: #eaf2ff;
      white-space: pre-wrap;
      word-break: break-word;
    }
    code{font-family: var(--mono)}
    .btn{
      cursor:pointer;
      border:1px solid var(--border);
      background: rgba(16,24,38,.55);
      color: var(--text);
      padding: 7px 10px;
      border-radius: 12px;
      font-size: .88rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.16);
    }
    .btn:active{transform: translateY(0)}
    .muted{color: var(--faint)}
    .kpi{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
      margin: 10px 0 14px;
    }
    .kpi .box{
      background: rgba(255,255,255,.03);
      border:1px solid var(--border);
      border-radius: 14px;
      padding: 10px;
    }
    .kpi .box .t{font-size:.82rem; color: var(--faint)}
    .kpi .box .v{font-size:1.05rem; color: var(--text); margin-top:2px}
    @media (max-width: 720px){
      .kpi{grid-template-columns:1fr}
    }

    details{
      margin: 10px 0 14px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
      overflow:hidden;
    }
    summary{
      cursor:pointer;
      padding: 12px 12px;
      color: var(--text);
      font-weight: 600;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    details .inside{
      padding: 0 12px 12px;
      color: var(--muted);
      border-top: 1px solid var(--border2);
    }

    figure{
      margin: 12px 0 16px;
      padding: 12px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: rgba(0,0,0,.20);
    }
    figcaption{
      margin-top: 8px;
      color: var(--faint);
      font-size: .9rem;
    }
    canvas{width:100%; height:auto; display:block; border-radius: 12px; border:1px solid rgba(255,255,255,.08)}
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(16,24,38,.55);
      color: var(--muted);
      text-decoration:none;
      font-size:.92rem;
      margin: 8px 0 14px;
    }
    .backtop:hover{color: var(--text); background: rgba(255,255,255,.06)}
    footer{
      padding: 18px;
      border-top: 1px solid var(--border2);
      color: var(--faint);
      font-size: .9rem;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      nav{display:none}
      article, section, .card, .eqwrap, figure, details{box-shadow:none; background:#fff; border-color:#ddd}
      p,li{color:#111}
      .btn{display:none}
      .pill{border-color:#ddd; background:#fff; color:#111}
      header{border-bottom:1px solid #ddd; background:#fff}
      .callout{background:#fff; border-color:#ddd}
      pre{color:#000}
      a{color:#000; text-decoration:underline}
      section{break-inside:avoid-page}
      h2,h3{break-after:avoid-page}
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap">
      <div class="title">
        <div>
          <h1>Alfvén Waves in a Magnetized Electron–Hole Solid</h1>
          <p class="subtitle">
            Deriving the transverse circular response of electrons and holes in a uniform magnetic field and showing how it produces an
            Alfvén-like wave with speed v<sub>A</sub> = B / √(4πρ) in the low-frequency regime.
          </p>
          <div class="meta">
            <span class="pill"><span class="dot"></span>Physics + Mathematical Physics</span>
            <span class="pill"><span class="dot" style="background:var(--accent2)"></span>Semiconductors / Semimetals</span>
            <span class="pill"><span class="dot" style="background:var(--warn)"></span>CGS (Gaussian) units</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap layout">
      <nav aria-label="Table of contents">
        <div class="navhead">
          <strong>Table of Contents</strong>
          <span class="muted" style="font-size:.86rem;">sticky</span>
        </div>
        <div class="navlinks">
          <a href="#quick">Quick Summary</a>
          <a href="#primer">PART 0 — Concept Primer</a>
          <a href="#industry">PART 0B — Industry & Applied Perspective</a>
          <a href="#analysis">PART 1 — Problem Analysis</a>
          <a href="#strategy">PART 2 — Strategy & Tips</a>
          <a href="#solution">PART 3 — Full Solution</a>
          <a href="#deeper">PART 4 — Deeper Understanding</a>
          <a href="#plotguide">PART 5 — Optional Plot Guide</a>
        </div>
        <div class="small">
          Tip: use the copy buttons on equation blocks to grab plain-text formulas.
        </div>
      </nav>

      <article>
        <!-- Quick Summary -->
        <section id="quick">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this is:</strong> A magnetized electron–hole “plasma” in a solid (semimetal or compensated semiconductor) supports an Alfvén-like electromagnetic wave.</li>
            <li><strong>Key physics idea:</strong> In a strong static magnetic field <code>B = B ẑ</code>, low-frequency transverse motion is dominated by the Lorentz force, giving a polarization that depends on the <em>mass density</em> of carriers.</li>
            <li><strong>Model:</strong> Two species (electrons, holes) with number density <code>n</code>, masses <code>m_e</code>, <code>m_h</code>, charges <code>-e</code>, <code>+e</code>, driven by a circularly polarized electric field <code>E^+ e^{-iωt}</code> in the x–y plane.</li>
            <li><strong>Governing equations:</strong> Newton–Lorentz ODEs for each carrier plus Maxwell’s wave equation in a dielectric medium:
              <code>m_s d^2 r_s/dt^2 = q_s (E + (1/c) v_s × B)</code>, and <code>ω^2 ε(ω) = c^2 k^2</code> for a transverse plane wave.</li>
            <li><strong>Part (a) result:</strong> Complex transverse displacements
              <code>ξ_e = eE^+ / (m_e ω(ω + ω_e))</code>, <code>ξ_h = -eE^+ / (m_h ω(ω - ω_h))</code>,
              with cyclotron frequencies <code>ω_e = eB/(m_e c)</code>, <code>ω_h = eB/(m_h c)</code> (Gaussian CGS).</li>
            <li><strong>Part (b) result:</strong> For <code>ω ≪ ω_e, ω_h</code>, polarization
              <code>P^+ = n e (ξ_h - ξ_e) = n c^2 (m_e + m_h) E^+ / B^2</code>,
              so <code>ε(ω) = ε_l + 4π c^2 ρ / B^2</code>, with <code>ρ = n(m_e + m_h)</code>.</li>
            <li><strong>Dispersion (Alfvén wave):</strong> If <code>ε_l</code> is negligible:
              <code>ω^2 = (B^2/(4πρ)) k^2</code> ⇒ constant speed <code>v_A = ω/k = B/√(4πρ)</code>.</li>
            <li><strong>Physical meaning:</strong> The magnetic field gives an effective “tension” and the carrier mass density gives inertia—exactly the logic of Alfvén waves in plasmas.</li>
          </ul>

          <div class="callouts">
            <div class="callout ok">
              <strong>Outcome you should remember</strong>
              <p>
                In the low-frequency, strongly magnetized limit, the medium behaves like an “Alfvén dielectric” with
                <code>ε(ω) ≈ 4π c^2 ρ/B^2</code>, giving <code>ω = v_A k</code>.
              </p>
            </div>
          </div>
        </section>

        <!-- PART 0 -->
        <section id="primer">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <div class="grid2">
            <div class="card">
              <h3>Core definitions (symbols + SI meaning; CGS used here)</h3>
              <ul>
                <li><code>n</code> — number density of electrons and holes (CGS: cm<sup>-3</sup>).</li>
                <li><code>m_e, m_h</code> — effective masses (CGS: g).</li>
                <li><code>q_e = -e</code>, <code>q_h = +e</code> — charges (statcoulomb in CGS Gaussian).</li>
                <li><code>B</code> — static magnetic field magnitude (Gauss), here <code>B = B ẑ</code>.</li>
                <li><code>c</code> — speed of light (cm/s in CGS).</li>
                <li><code>E(t)</code> — transverse electric field; circular component <code>E^+ = E_x + i E_y</code>.</li>
                <li><code>ξ = x + i y</code> — complex transverse displacement (cm).</li>
                <li><code>ω</code> — wave angular frequency (s<sup>-1</sup>), time dependence <code>e^{-iωt}</code>.</li>
                <li><code>ω_e = eB/(m_e c)</code>, <code>ω_h = eB/(m_h c)</code> — cyclotron frequencies (s<sup>-1</sup>).</li>
                <li><code>P</code> — polarization (statvolt/cm equivalent), with <code>D = εE = ε_l E + 4πP</code> in CGS.</li>
                <li><code>ε(ω)</code> — frequency-dependent dielectric function (dimensionless).</li>
                <li><code>ρ = n(m_e+m_h)</code> — mass density of carriers (g/cm<sup>3</sup>).</li>
              </ul>
            </div>

            <div class="card">
              <h3>Physical meaning & intuition</h3>
              <ul>
                <li><strong>Magnetic field</strong> bends carrier trajectories: the Lorentz force is perpendicular to velocity, producing circular (cyclotron) motion.</li>
                <li><strong>Circular polarization</strong> diagonalizes the Lorentz coupling in the x–y plane; each handedness sees a simple scalar ODE.</li>
                <li><strong>Low-frequency regime</strong> (<code>ω ≪ ω_c</code>) makes the Lorentz term dominate over inertial acceleration in a specific way, giving a large, nearly “E×B” drift.</li>
                <li><strong>Polarization</strong> comes from relative electron–hole displacement: the medium develops dipole moment density proportional to <code>ne(ξ_h-ξ_e)</code>.</li>
                <li><strong>Wave propagation</strong> in a dielectric: Maxwell’s equations reduce to <code>ω^2 ε(ω) = c^2 k^2</code> for a transverse plane wave in a uniform medium.</li>
              </ul>
            </div>
          </div>

          <div class="callouts">
            <div class="callout">
              <strong>Key laws / validity conditions</strong>
              <p>
                We use the <em>collisionless</em> Newton–Lorentz equation (no damping term) and linear response (displacement proportional to field).
                Valid when: small oscillations, uniform <code>B</code>, spatially uniform driving field over a cyclotron orbit scale, and frequencies where carrier–carrier collisions can be neglected (or are weak).
              </p>
            </div>
          </div>

          <h3>Common models/approximations used here</h3>
          <ul>
            <li><strong>Effective mass model:</strong> electrons and holes behave like free particles with masses <code>m_e, m_h</code>.</li>
            <li><strong>Linear response:</strong> keep only terms linear in <code>E</code> and displacement.</li>
            <li><strong>Plane-wave EM field:</strong> <code>E(r,t) = Re{E_0 e^{i(kz-ωt)}}</code>, propagation along <code>z</code>.</li>
            <li><strong>Low-frequency (Alfvén) limit:</strong> <code>ω/ω_e ≪ 1</code>, <code>ω/ω_h ≪ 1</code> so we can expand denominators.</li>
            <li><strong>Neglect host-lattice dielectric constant</strong> (optional step): set <code>ε_l</code> small compared to carrier contribution.</li>
          </ul>

          <h3>Mini intuition examples (no heavy algebra)</h3>
          <ul>
            <li><strong>Single electron in B:</strong> Without <code>E</code>, it circles at <code>ω_e</code>. With a rotating <code>E</code>, it responds strongly when the drive rotation matches its cyclotron rotation (resonance).</li>
            <li><strong>Two-species (e–h):</strong> Electrons and holes drift similarly at leading order (the classic <code>E×B</code>-type drift), but their <em>small difference</em> creates a net polarization proportional to <code>m_e+m_h</code>.</li>
            <li><strong>Wave picture:</strong> If the polarization is large, the wave “feels” an effective permittivity and travels at a reduced speed <code>v_A</code> set by <code>B</code> and inertia density <code>ρ</code>.</li>
          </ul>

          <div class="callouts">
            <div class="callout warn">
              <strong>What to watch for (pitfalls)</strong>
              <p>
                (1) Sign conventions in circular polarization and cyclotron terms; (2) remembering CGS relations <code>D = ε_l E + 4πP</code>;
                (3) expanding correctly in the small parameter <code>ω/ω_c</code>; (4) units: Gauss, cm, g, s in CGS.
              </p>
            </div>
          </div>

          <details>
            <summary>Math Insight: why circular polarization helps</summary>
            <div class="inside">
              <p>
                In the x–y plane, the Lorentz force couples x and y through a 90° rotation (a skew-symmetric operator).
                Writing transverse vectors in the helical basis (or complex coordinate) turns this rotation into multiplication by ±i,
                diagonalizing the dynamics. Mathematically, you are choosing eigenvectors of the linear operator that represents the cross product with <code>ẑ</code>.
              </p>
            </div>
          </details>

          <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
        </section>

        <!-- PART 0B -->
        <section id="industry">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>

          <div class="grid2">
            <div class="card">
              <h3>Where this appears (3+ concrete areas)</h3>
              <ul>
                <li><strong>THz / mm-wave semiconductor magneto-optics:</strong> circularly polarized response under <code>B</code> drives Faraday/Kerr effects and magnetoplasmonic modes.</li>
                <li><strong>Compensated semiconductors & semimetals:</strong> electron–hole fluids (e.g., Ge, bismuth-like systems) can support collective electromagnetic modes affecting high-frequency transport.</li>
                <li><strong>Plasma-like waves in solid-state devices:</strong> high-mobility channels under magnetic bias (Hall devices, sensors) show wave/impedance behaviors influenced by carrier inertia.</li>
                <li><strong>Magnetized materials diagnostics:</strong> probing carrier effective mass density via dispersion of magneto-electromagnetic waves.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Why engineers care</h3>
              <ul>
                <li><strong>Performance:</strong> dispersion affects signal velocity, impedance, and loss in high-frequency components under magnetic bias.</li>
                <li><strong>Reliability:</strong> strong fields can shift resonances (cyclotron) and create unexpected coupling, heating, or EMI issues.</li>
                <li><strong>Cost & manufacturability:</strong> high-mobility materials and clean compensation control are expensive; knowing when lattice <code>ε_l</code> dominates guides material choice.</li>
                <li><strong>Design constraints:</strong> real samples have scattering (finite τ), boundaries, anisotropic masses, and nonuniform <code>B</code>; these perturb the ideal Alfvén picture.</li>
              </ul>
            </div>
          </div>

          <h3>Typical measurement/validation methods</h3>
          <ul>
            <li><strong>Terahertz time-domain spectroscopy (THz-TDS)</strong> under magnetic field to extract <code>ε(ω)</code> and circular dichroism.</li>
            <li><strong>Microwave transmission / resonators</strong> to measure dispersion <code>ω(k)</code> and phase velocity in magnetized samples.</li>
            <li><strong>Magneto-transport + optical</strong> cross-validation: cyclotron resonance (effective masses) + carrier density (Hall) gives <code>ρ</code> for predicted <code>v_A</code>.</li>
          </ul>

          <details>
            <summary>From lab to product: adapting the ideal model</summary>
            <div class="inside">
              <p>
                Practical models add damping (a friction term <code>m v/τ</code>), spatial nonuniformity, and boundary conditions (waveguides, finite thickness).
                Those convert the clean dispersion <code>ω=v_A k</code> into a complex dispersion with attenuation and mode quantization.
                Still, the <em>scaling</em> <code>v_A ∝ B / √ρ</code> remains a powerful design rule.
              </p>
            </div>
          </details>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 1 -->
        <section id="analysis">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <h3>Restating the problem</h3>
          <p>
            A solid contains equal densities <code>n</code> of electrons (mass <code>m_e</code>) and holes (mass <code>m_h</code>) in a uniform magnetic field
            <code>B = B ẑ</code>. Using the complex coordinate <code>ξ = x + i y</code> for circularly polarized transverse motion with time dependence <code>e^{-iωt}</code>,
            show:
          </p>
          <ol>
            <li>(a) The electron and hole displacements in a circularly polarized electric field
              <code>E^+ e^{-iωt} = (E_x + iE_y)e^{-iωt}</code> are
              <code>ξ_e = eE^+/(m_e ω(ω+ω_e))</code> and <code>ξ_h = -eE^+/(m_h ω(ω-ω_h))</code>, with <code>ω_e = eB/(m_e c)</code>, <code>ω_h = eB/(m_h c)</code>.</li>
            <li>(b) In the regime <code>ω ≪ ω_e, ω_h</code>, show the polarization
              <code>P^+ = ne(ξ_h-ξ_e) = n c^2 (m_e+m_h) E^+/B^2</code>, hence
              <code>ε(ω) = ε_l + 4πP^+/E^+ = ε_l + 4π c^2 ρ/B^2</code> where <code>ρ = n(m_e+m_h)</code>.
              If <code>ε_l</code> is negligible, the dispersion from <code>ω^2 ε(ω)=c^2k^2</code> becomes
              <code>ω^2 = (B^2/(4πρ)) k^2</code>, with wave speed <code>v_A=B/√(4πρ)</code>, and evaluate the example numbers.
            </li>
          </ol>

          <div class="kpi">
            <div class="box">
              <div class="t">Given</div>
              <div class="v"><code>n, m_e, m_h, B ẑ</code></div>
            </div>
            <div class="box">
              <div class="t">Unknowns</div>
              <div class="v"><code>ξ_e, ξ_h, P^+, ε(ω), ω(k)</code></div>
            </div>
            <div class="box">
              <div class="t">Regime</div>
              <div class="v"><code>ω ≪ ω_e, ω_h</code></div>
            </div>
          </div>

          <h3>Relevant principles and why they apply</h3>
          <ul>
            <li><strong>Newton–Lorentz dynamics:</strong> carriers are accelerated by <code>E</code> and deflected by <code>v×B</code>; this is the microscopic origin of magneto-dielectric response.</li>
            <li><strong>Linear polarization:</strong> <code>P = n q (displacement)</code> for small oscillations; here the relevant dipole moment comes from electron–hole separation.</li>
            <li><strong>Maxwell wave equation in a uniform medium:</strong> for transverse plane waves, <code>∇×(∇×E) = -(1/c^2) ∂^2D/∂t^2</code> leads to the dispersion relation <code>k^2 = ε(ω) ω^2 / c^2</code>.</li>
          </ul>
          <p class="muted">
            What we <em>don’t</em> use: detailed band structure, spatial inhomogeneity, collisions, or boundary quantization—because the problem targets the cleanest bulk dispersion.
          </p>

          <div class="callouts">
            <div class="callout warn">
              <strong>Assumptions (explicit)</strong>
              <p>
                Uniform bulk medium; small-amplitude linear response; collisionless (no damping); isotropic effective masses; propagation along <code>z</code> with transverse fields;
                low-frequency limit used only in part (b) after exact expressions from part (a).
              </p>
            </div>
          </div>

          <h3>Possible approaches (compare)</h3>
          <div class="grid2">
            <div class="card">
              <h3>Approach A — Complex coordinate / circular basis (best here)</h3>
              <ul>
                <li><strong>Pros:</strong> Diagonalizes Lorentz coupling; yields compact denominators <code>(ω±ω_c)</code>.</li>
                <li><strong>Cons:</strong> Sign conventions can be subtle; must carefully define <code>E^+</code> and <code>ξ</code>.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Approach B — 2×2 matrix in (x,y)</h3>
              <ul>
                <li><strong>Pros:</strong> Sign-tracking is more “mechanical”; transparent linear algebra.</li>
                <li><strong>Cons:</strong> Longer; must invert a coupled system; circular modes emerge only after diagonalization.</li>
              </ul>
            </div>
          </div>
          <p>
            We choose <strong>Approach A</strong> because the problem explicitly introduces <code>ξ = x + i y</code> and <code>E^+ = E_x + iE_y</code>,
            signaling circular-mode diagonalization as the intended method.
          </p>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 2 -->
        <section id="strategy">
          <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

          <ol>
            <li><strong>Set the coordinate system:</strong> <code>B=B ẑ</code>, transverse motion in x–y plane; define <code>ξ=x+iy</code> and <code>E^+=E_x+iE_y</code>.</li>
            <li><strong>Write Newton–Lorentz ODEs:</strong> for each species <code>s∈{e,h}</code>, write <code>m_s d^2ξ_s/dt^2</code> in terms of <code>E^+</code> and the magnetic term.</li>
            <li><strong>Use harmonic time dependence:</strong> assume <code>ξ_s(t)=ξ_s e^{-iωt}</code> and <code>E^+(t)=E^+ e^{-iωt}</code> to turn ODEs into algebraic equations.</li>
            <li><strong>Solve for displacements:</strong> isolate <code>ξ_e</code>, <code>ξ_h</code> and express in terms of <code>ω</code>, <code>ω_e</code>, <code>ω_h</code>.</li>
            <li><strong>Build polarization:</strong> use dipole density from electron–hole separation: <code>P^+=ne(ξ_h-ξ_e)</code>.</li>
            <li><strong>Low-frequency expansion:</strong> expand <code>1/(ω±ω_c)</code> for <code>ω≪ω_c</code> to get a simple mass-density form.</li>
            <li><strong>Dielectric function:</strong> use CGS relation <code>D=ε_l E + 4πP</code> ⇒ <code>ε(ω)=ε_l + 4πP^+/E^+</code>.</li>
            <li><strong>Dispersion:</strong> plug into <code>ω^2 ε(ω)=c^2k^2</code> and simplify to obtain <code>ω=v_A k</code>.</li>
            <li><strong>Sanity checks:</strong> dimensions, limits (<code>B→0</code>, <code>n→0</code>), and numerical estimate.</li>
          </ol>

          <div class="callouts">
            <div class="callout bad">
              <strong>Common mistakes</strong>
              <p>
                Mixing SI and CGS (especially factors of <code>4π</code> and <code>c</code>), expanding <code>1/(ω±ω_c)</code> with wrong sign,
                forgetting that polarization comes from <em>relative</em> displacement <code>ξ_h-ξ_e</code>, or dropping <code>ε_l</code> too early.
              </p>
            </div>
          </div>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 3 -->
        <section id="solution">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>Qualitative expectation (before calculating)</h3>
          <p>
            With <code>B</code> along <code>ẑ</code>, the Lorentz force couples x and y like a rotation. A circularly polarized <code>E</code>
            should produce a circular displacement with a denominator involving <code>ω</code> and the cyclotron frequency.
            In the low-frequency limit, both species share a leading drift, but their small difference yields a polarization proportional to the <em>sum</em> of masses,
            i.e. to carrier mass density <code>ρ</code>. That should make the wave speed scale like <code>B/√ρ</code>.
          </p>

          <div class="callouts">
            <div class="callout">
              <strong>Mathematical model (explicit)</strong>
              <p>
                Two species <code>s∈{e,h}</code> with displacements <code>r_s(t)=(x_s(t),y_s(t),0)</code> in a uniform medium.
                ODEs (Newton–Lorentz):
                <code>m_s d^2 r_s/dt^2 = q_s (E(t) + (1/c) (dr_s/dt) × (B ẑ))</code>.
                We assume spatial dependence only through a plane wave later; for the microscopic response we treat the local field as uniform in space.
              </p>
            </div>
          </div>

          <h3>Step 1 — Convert Lorentz force to complex form</h3>
          <p>
            Define the complex transverse displacement and field:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Definitions <span class="mini">setup</span></div>
              <button class="btn" data-copy="eq1">Copy</button>
            </div>
            <pre id="eq1">ξ_s(t) = x_s(t) + i y_s(t)
E^+(t) = E_x(t) + i E_y(t)
B = B ẑ</pre>
          </div>

          <p>
            For <code>v_s = d r_s/dt</code>, the magnetic term is <code>(v_s × B ẑ)/c</code>.
            In the x–y plane, the cross product rotates the vector by 90°. In complex form, this becomes proportional to <code>i dξ_s/dt</code>.
            The net result (consistent with the problem’s circular-mode convention) can be written as:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Complex Newton–Lorentz equation <span class="mini">ODE</span></div>
              <button class="btn" data-copy="eq2">Copy</button>
            </div>
            <pre id="eq2">m_s d²ξ_s/dt²  + i (q_s B/c) dξ_s/dt  =  q_s E^+(t)</pre>
          </div>

          <p class="muted">
            Why this step is valid: the dynamics is linear, and the mapping from (x,y) to <code>ξ=x+iy</code> is a linear change of variables.
            The cross product with <code>ẑ</code> is a linear operator on the transverse plane, and circular basis vectors are its eigenvectors.
          </p>

          <details>
            <summary>Optional deeper note: operator viewpoint (∇ and linear algebra)</summary>
            <div class="inside">
              <p>
                On the transverse plane, define the linear operator <code>J</code> that rotates vectors by +90°: <code>J(x̂)=ŷ</code>, <code>J(ŷ)=-x̂</code>.
                Then <code>v×(B ẑ)=B J v</code> up to sign conventions, and the ODE becomes
                <code>m_s r̈_s + (q_s B/c) J ṙ_s = q_s E</code>. The eigenvectors of <code>J</code> are the circularly polarized directions,
                turning the 2D coupled system into a scalar complex ODE.
              </p>
            </div>
          </details>

          <h3>Step 2 — Insert harmonic time dependence</h3>
          <p>
            Use the problem’s time convention:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Harmonic ansatz <span class="mini">Fourier</span></div>
              <button class="btn" data-copy="eq3">Copy</button>
            </div>
            <pre id="eq3">E^+(t) = E^+ e^{-iωt}
ξ_s(t) = ξ_s e^{-iωt}</pre>
          </div>

          <p>
            Then derivatives become:
            <code>dξ_s/dt = -iω ξ_s e^{-iωt}</code>, <code>d²ξ_s/dt² = -ω² ξ_s e^{-iωt}</code>.
            Substitute into the complex ODE:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Algebraic response equation <span class="mini">solve</span></div>
              <button class="btn" data-copy="eq4">Copy</button>
            </div>
            <pre id="eq4">m_s (-ω²) ξ_s  + i (q_s B/c) (-iω) ξ_s  =  q_s E^+
⇒ -m_s ω² ξ_s + (q_s B/c) ω ξ_s = q_s E^+</pre>
          </div>

          <p>
            Factor out <code>ω</code>:
          </p>
          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Factorization <span class="mini">structure</span></div>
              <button class="btn" data-copy="eq5">Copy</button>
            </div>
            <pre id="eq5">ω [ -m_s ω + (q_s B/c) ] ξ_s = q_s E^+</pre>
          </div>

          <h3>Step 3 — Solve for electron displacement (q = −e)</h3>
          <p>
            For electrons, <code>q_e = -e</code>. Define the (positive) electron cyclotron frequency
            <code>ω_e = eB/(m_e c)</code>.
            Insert <code>q_s=-e</code> into the factorized equation:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Electron response <span class="mini">(a)</span></div>
              <button class="btn" data-copy="eq6">Copy</button>
            </div>
            <pre id="eq6">ω [ -m_e ω + (-e) B/c ] ξ_e = (-e) E^+
⇒ ω [ -m_e ω - eB/c ] ξ_e = -e E^+
Multiply by (-1):
ω [ m_e ω + eB/c ] ξ_e = e E^+
Use eB/c = m_e ω_e:
ω [ m_e (ω + ω_e) ] ξ_e = e E^+
⇒ ξ_e = e E^+ / ( m_e ω (ω + ω_e) )</pre>
          </div>

          <p class="muted">
            This matches the required expression for <code>ξ_e</code>. The denominator shows a cyclotron-shifted resonance structure in the circular channel.
          </p>

          <h3>Step 4 — Solve for hole displacement (q = +e)</h3>
          <p>
            For holes, <code>q_h = +e</code> and <code>ω_h = eB/(m_h c)</code>. Repeat the same algebra:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Hole response <span class="mini">(a)</span></div>
              <button class="btn" data-copy="eq7">Copy</button>
            </div>
            <pre id="eq7">ω [ -m_h ω + (e) B/c ] ξ_h = e E^+
⇒ ω [ -m_h ω + eB/c ] ξ_h = e E^+
Factor out (-1) inside bracket:
ω [ -m_h (ω - (eB/(m_h c))) ] ξ_h = e E^+
⇒ - ω m_h (ω - ω_h) ξ_h = e E^+
⇒ ξ_h = - e E^+ / ( m_h ω (ω - ω_h) )</pre>
          </div>

          <div class="callouts">
            <div class="callout ok">
              <strong>Part (a) final result (boxed)</strong>
              <p>
                <code>ξ_e = eE^+ / (m_e ω(ω + ω_e))</code>, &nbsp;
                <code>ξ_h = -eE^+ / (m_h ω(ω - ω_h))</code>,
                with <code>ω_e = eB/(m_e c)</code>, <code>ω_h = eB/(m_h c)</code> (CGS Gaussian).
              </p>
            </div>
          </div>

          <h3>Step 5 — Polarization from electron–hole separation</h3>
          <p>
            Each electron–hole pair contributes a dipole moment <code>p = e(r_h - r_e)</code>.
            With number density <code>n</code>, the polarization is dipole moment per unit volume:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Polarization definition <span class="mini">(b)</span></div>
              <button class="btn" data-copy="eq8">Copy</button>
            </div>
            <pre id="eq8">P^+ = n e (ξ_h - ξ_e)</pre>
          </div>

          <h3>Step 6 — Low-frequency expansion (ω ≪ ω_e, ω_h)</h3>
          <p>
            We now expand the factors <code>1/(ω±ω_c)</code> for small <code>ω/ω_c</code>.
            Use the standard Taylor expansions (valid because <code>|ω/ω_c| ≪ 1</code> so the geometric series converges):
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Asymptotic expansions <span class="mini">ω/ωc ≪ 1</span></div>
              <button class="btn" data-copy="eq9">Copy</button>
            </div>
            <pre id="eq9">1/(ω + ω_e) = (1/ω_e) * 1/(1 + ω/ω_e) ≈ (1/ω_e) (1 - ω/ω_e + ...)
1/(ω - ω_h) = (-1/ω_h) * 1/(1 - ω/ω_h) ≈ (-1/ω_h) (1 + ω/ω_h + ...)</pre>
          </div>

          <p>
            Apply these to <code>ξ_e</code> and <code>ξ_h</code>:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Expanded displacements <span class="mini">intermediate</span></div>
              <button class="btn" data-copy="eq10">Copy</button>
            </div>
            <pre id="eq10">ξ_e = eE^+ / [m_e ω(ω+ω_e)]
    ≈ eE^+ / (m_e ω ω_e) * (1 - ω/ω_e + ...)

ξ_h = -eE^+ / [m_h ω(ω-ω_h)]
    ≈ -eE^+ / (m_h ω) * [(-1/ω_h)(1 + ω/ω_h + ...)]
    =  eE^+ / (m_h ω ω_h) * (1 + ω/ω_h + ...)</pre>
          </div>

          <p>
            Note the leading terms are the same once we insert <code>ω_e, ω_h</code>:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Leading drift equality <span class="mini">cE/(ωB)</span></div>
              <button class="btn" data-copy="eq11">Copy</button>
            </div>
            <pre id="eq11">m_e ω_e = eB/c  ⇒  e/(m_e ω_e) = c/B
m_h ω_h = eB/c  ⇒  e/(m_h ω_h) = c/B

So:
ξ_e ≈ (cE^+)/(ωB) (1 - ω/ω_e + ...)
ξ_h ≈ (cE^+)/(ωB) (1 + ω/ω_h + ...)</pre>
          </div>

          <p>
            Therefore their difference cancels at leading order and the first non-canceling term is:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Difference ξ_h − ξ_e <span class="mini">key step</span></div>
              <button class="btn" data-copy="eq12">Copy</button>
            </div>
            <pre id="eq12">ξ_h - ξ_e ≈ (cE^+)/(ωB) [ (1 + ω/ω_h) - (1 - ω/ω_e) ]
          = (cE^+)/(ωB) [ ω/ω_h + ω/ω_e ]
          = (cE^+)/B [ 1/ω_h + 1/ω_e ]</pre>
          </div>

          <p>
            Substitute <code>1/ω_e = m_e c/(eB)</code> and <code>1/ω_h = m_h c/(eB)</code>:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Mass-sum simplification <span class="mini">ρ appears</span></div>
              <button class="btn" data-copy="eq13">Copy</button>
            </div>
            <pre id="eq13">1/ω_h + 1/ω_e = (m_h c)/(eB) + (m_e c)/(eB) = (m_e + m_h) c/(eB)

⇒ ξ_h - ξ_e ≈ (cE^+)/B * (m_e + m_h) c/(eB)
          = (m_e + m_h) c² E^+ / (e B²)</pre>
          </div>

          <p>
            Now compute polarization:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Polarization in Alfvén regime <span class="mini">(b)</span></div>
              <button class="btn" data-copy="eq14">Copy</button>
            </div>
            <pre id="eq14">P^+ = n e (ξ_h - ξ_e)
   ≈ n e * [ (m_e + m_h) c² E^+ / (e B²) ]
   = n c² (m_e + m_h) E^+ / B²</pre>
          </div>

          <div class="callouts">
            <div class="callout ok">
              <strong>Part (b) polarization (boxed)</strong>
              <p><code>P^+ = n c² (m_e + m_h) E^+ / B²</code>  for  <code>ω ≪ ω_e, ω_h</code>.</p>
            </div>
          </div>

          <h3>Step 7 — Dielectric function in CGS Gaussian</h3>
          <p>
            In CGS Gaussian, the constitutive relation is:
            <code>D = ε_l E + 4πP</code>. For the circular component:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Dielectric function <span class="mini">CGS</span></div>
              <button class="btn" data-copy="eq15">Copy</button>
            </div>
            <pre id="eq15">ε(ω) = ε_l + 4π P^+/E^+</pre>
          </div>

          <p>
            Substitute <code>P^+</code> and define carrier mass density <code>ρ = n(m_e+m_h)</code>:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Carrier-density form <span class="mini">ρ</span></div>
              <button class="btn" data-copy="eq16">Copy</button>
            </div>
            <pre id="eq16">ε(ω) = ε_l + 4π [ n c² (m_e + m_h) / B² ]
     = ε_l + 4π c² ρ / B²</pre>
          </div>

          <h3>Step 8 — Wave equation and dispersion relation</h3>
          <p>
            For a homogeneous medium and transverse plane waves propagating along <code>z</code>,
            Maxwell’s equations (operator form) give:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Maxwell operator step <span class="mini">∇×</span></div>
              <button class="btn" data-copy="eq17">Copy</button>
            </div>
            <pre id="eq17">∇×E = -(1/c) ∂B/∂t
∇×H =  (1/c) ∂D/∂t   (in CGS, H=B if μ≈1)
With D = ε(ω) E (frequency domain)

For a transverse plane wave E ⟂ k, k = k ẑ:
k² E = (ω²/c²) ε(ω) E
⇒ ω² ε(ω) = c² k²</pre>
          </div>

          <p>
            If the lattice contribution <code>ε_l</code> can be neglected relative to the carrier term (as the problem states),
            then:
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Alfvén dispersion <span class="mini">final</span></div>
              <button class="btn" data-copy="eq18">Copy</button>
            </div>
            <pre id="eq18">ε(ω) ≈ 4π c² ρ / B²
Plug into ω² ε(ω) = c² k²:

ω² (4π c² ρ / B²) = c² k²
⇒ ω² = (B²/(4π ρ)) k²

Thus phase/group velocity:
v_A = ω/k = B / √(4π ρ)</pre>
          </div>

          <div class="callouts">
            <div class="callout ok">
              <strong>Final Answer (boxed)</strong>
              <p style="margin-top:8px" class="muted">Use the button to copy the full final-results block as plain text.</p>
              <div class="eqwrap" style="margin-top:10px">
                <div class="eqbar">
                  <div class="label">Final results (a)–(b) <span class="mini">copy-ready</span></div>
                  <button class="btn" data-copy="finalBlock">Copy</button>
                </div>
                <pre id="finalBlock">Given B = B ẑ, ξ = x + i y, E^+ = E_x + i E_y, time dependence e^{-iωt}:

Cyclotron frequencies (CGS Gaussian):
ω_e = eB/(m_e c),   ω_h = eB/(m_h c)

(a) Displacements:
ξ_e =  eE^+ / [ m_e ω(ω + ω_e) ]
ξ_h = -eE^+ / [ m_h ω(ω - ω_h) ]

(b) Polarization and dielectric function (ω ≪ ω_e, ω_h):
P^+ = n e (ξ_h - ξ_e) = n c² (m_e + m_h) E^+ / B²

Define carrier mass density ρ = n(m_e + m_h):
ε(ω) = ε_l + 4π P^+/E^+ = ε_l + 4π c² ρ / B²

If ε_l negligible, EM dispersion for propagation along z:
ω² ε(ω) = c² k²  ⇒  ω² = (B²/(4πρ)) k²

Alfvén wave speed:
v_A = ω/k = B / √(4πρ)</pre>
              </div>
            </div>
          </div>

          <h3>Sanity checks</h3>
          <div class="grid2">
            <div class="card">
              <h3>Dimensional analysis (CGS)</h3>
              <ul>
                <li><code>v_A = B/√(4πρ)</code> has units of speed: in CGS, <code>B²/(4π)</code> has the dimensions of energy density, so dividing by mass density <code>ρ</code> gives (speed)<sup>2</sup>.</li>
                <li><code>ε(ω)</code> is dimensionless: <code>4π c² ρ/B²</code> is dimensionless in Gaussian CGS.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Limiting cases</h3>
              <ul>
                <li><strong>n → 0 (ρ → 0):</strong> carrier contribution vanishes; the Alfvén branch disappears (no inertia/polarization from carriers).</li>
                <li><strong>B → 0:</strong> <code>v_A → 0</code>; the magnetic “restoring” effect is gone (the derivation’s <code>ω≪ω_c</code> regime also fails since <code>ω_c→0</code>).</li>
                <li><strong>Large ρ:</strong> heavier carrier mass density slows the wave, consistent with <code>v_A ∝ 1/√ρ</code>.</li>
              </ul>
            </div>
          </div>

          <h3>Numerical estimate (given in the problem)</h3>
          <p>
            Use the stated values (CGS): <code>B = 10 kG = 10^4 G</code>, <code>n = 10^18 cm^-3</code>, and total mass per electron–hole pair
            <code>m ≈ 10^-27 g</code> (so <code>ρ = n m = 10^18 × 10^-27 = 10^-9 g/cm^3</code>).
          </p>

          <div class="eqwrap">
            <div class="eqbar">
              <div class="label">Velocity estimate <span class="mini">numbers</span></div>
              <button class="btn" data-copy="eq19">Copy</button>
            </div>
            <pre id="eq19">ρ = 10^-9 g/cm^3
4πρ ≈ 1.256×10^-8
√(4πρ) ≈ 1.12×10^-4
v_A = B/√(4πρ) ≈ (10^4)/(1.12×10^-4) ≈ 8.9×10^7 cm/s ≈ 10^8 cm/s</pre>
          </div>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 4 -->
        <section id="deeper">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>Re-interpreting the final formulas</h3>
          <ul>
            <li><strong>Why ρ appears:</strong> the polarization in the Alfvén regime is proportional to <code>n(m_e+m_h)</code> because the leading <code>E×B</code>-type drift cancels between species, leaving the first correction that depends on inertia (mass).</li>
            <li><strong>Why B appears as B²:</strong> strong magnetic field constrains transverse motion; larger <code>B</code> reduces displacement for a given <code>E</code> (hence <code>P ∝ 1/B²</code>), while simultaneously increasing the wave speed <code>v_A ∝ B</code>.</li>
            <li><strong>Dispersion is linear:</strong> <code>ω = v_A k</code> means no cutoff in this ideal model; phase and group velocities coincide.</li>
          </ul>

          <div class="callouts">
            <div class="callout">
              <strong>Math Insight (core equation as an object)</strong>
              <p>
                The dispersion relation <code>ω² = (B²/(4πρ)) k²</code> is the hallmark of a <em>hyperbolic wave equation</em> with constant wave speed:
                in real space it corresponds to <code>∂²ψ/∂t² = v_A² ∂²ψ/∂z²</code> for an appropriate field variable ψ.
                Mathematically, it is an eigenvalue relation from Fourier transforming a linear PDE in z and t.
              </p>
            </div>
          </div>

          <h3>Parameter dependence (qualitative + quantitative)</h3>
          <ul>
            <li><strong>Increase B:</strong> <code>v_A ∝ B</code> increases linearly; waves propagate faster.</li>
            <li><strong>Increase n:</strong> increases <code>ρ</code>, so <code>v_A ∝ 1/√n</code> decreases; heavier “plasma” is harder to accelerate.</li>
            <li><strong>Increase effective masses:</strong> increases <code>ρ</code> and decreases <code>v_A</code>; also changes cyclotron frequencies <code>ω_e, ω_h</code>, altering the validity range of <code>ω≪ω_c</code>.</li>
            <li><strong>Include ε_l:</strong> the full dispersion is <code>ω²(ε_l + 4πc²ρ/B²) = c²k²</code>; lattice permittivity reduces the role of carriers when <code>ε_l</code> dominates.</li>
          </ul>

          <h3>Alternative derivation idea (brief but meaningful)</h3>
          <p>
            Instead of solving for <code>ξ_e</code> and <code>ξ_h</code> explicitly, you can derive the effective dielectric tensor of a magnetized two-fluid system,
            then project onto the circular <code>(+)</code> polarization eigenmode. In that approach, <code>ε(ω)</code> emerges from the conductivity
            <code>J = σ(ω)E</code> via <code>ε(ω) = ε_l + (4π i/ω) σ(ω)</code> (CGS). The same low-frequency expansion produces the Alfvén form.
          </p>

          <h3>Concept check (self-test)</h3>
          <ul>
            <li><strong>Q:</strong> Why does the leading term of <code>ξ_e</code> and <code>ξ_h</code> cancel in <code>ξ_h-ξ_e</code>? <strong>A:</strong> Both species share the same leading drift scaling <code>cE/(ωB)</code>; polarization depends on their difference, so the first nonzero term is the next order in <code>ω/ω_c</code>.</li>
            <li><strong>Q:</strong> What sets the Alfvén speed scaling <code>B/√ρ</code>? <strong>A:</strong> <code>B</code> provides the electromagnetic restoring “stiffness” (via magnetic energy density), while <code>ρ</code> provides inertia.</li>
            <li><strong>Q:</strong> What breaks the ideal constant-speed prediction in real solids? <strong>A:</strong> Collisions (finite τ), boundaries, anisotropic masses, and coupling to the lattice (phonons) introduce attenuation and modified mode structure.</li>
            <li><strong>Q:</strong> Why is circular polarization mathematically convenient? <strong>A:</strong> It diagonalizes the 2D rotation operator associated with the Lorentz force, turning coupled ODEs into scalar algebraic equations in frequency space.</li>
          </ul>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <!-- PART 5 -->
        <section id="plotguide">
          <h2>PART 5 — Optional Plot Guide</h2>

          <p>
            A plot is useful here because the main prediction is a <strong>linear dispersion</strong> <code>ω = v_A k</code>.
            Below is a single static plot (example values only) illustrating that straight-line relationship.
          </p>

          <figure>
            <canvas id="dispersionCanvas" width="900" height="520" aria-label="Dispersion plot ω vs k"></canvas>
            <figcaption>
              Static example plot: <code>ω = v_A k</code> with example <code>v_A = 9×10^7 cm/s</code>. Axes: <code>k</code> (cm<sup>-1</sup>) and <code>ω</code> (s<sup>-1</sup>).
              This is illustrative; the symbolic result is the real deliverable.
            </figcaption>
          </figure>

          <div class="callouts">
            <div class="callout">
              <strong>What to notice</strong>
              <p>
                The slope is the wave speed <code>v_A</code>. If <code>B</code> increases, the line steepens; if <code>n</code> or effective masses increase (increasing <code>ρ</code>),
                the line flattens. There is no curvature in this ideal limit because <code>ε(ω)</code> becomes approximately constant in the Alfvén regime.
              </p>
            </div>
          </div>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <footer>
          <div><strong>Note on units:</strong> This solution follows the problem’s CGS (Gaussian) conventions, including <code>D = ε_l E + 4πP</code> and cyclotron frequencies <code>ω_c = eB/(mc)</code>.</div>
        </footer>
      </article>
    </div>
  </main>

  <script>
    // Copy-to-clipboard (plain text)
    (function(){
      function copyText(text){
        if (navigator.clipboard && window.isSecureContext){
          return navigator.clipboard.writeText(text);
        }
        // Fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        ta.style.top = '0';
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        try{ document.execCommand('copy'); }catch(e){}
        document.body.removeChild(ta);
        return Promise.resolve();
      }

      document.querySelectorAll('[data-copy]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const id = btn.getAttribute('data-copy');
          const el = document.getElementById(id);
          if (!el) return;
          const text = el.innerText.trim();
          const old = btn.textContent;
          await copyText(text);
          btn.textContent = 'Copied ✓';
          setTimeout(()=>btn.textContent = old, 900);
        });
      });
    })();

    // One static canvas plot: ω vs k (linear dispersion)
    (function(){
      const canvas = document.getElementById('dispersionCanvas');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      function draw(){
        // Handle high-DPI crispness
        const dpr = window.devicePixelRatio || 1;
        const cssW = canvas.clientWidth;
        const cssH = Math.round(cssW * (520/900));
        canvas.style.height = cssH + 'px';
        canvas.width = Math.floor(cssW * dpr);
        canvas.height = Math.floor(cssH * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        const W = cssW, H = cssH;
        ctx.clearRect(0,0,W,H);

        // Plot area
        const padL = 64, padR = 18, padT = 38, padB = 54;
        const x0 = padL, y0 = H - padB;
        const x1 = W - padR, y1 = padT;
        const pw = x1 - x0, ph = y0 - y1;

        // Example values (clearly labeled in caption)
        const vA = 9e7; // cm/s
        const kMax = 2000; // cm^-1
        const wMax = vA * kMax; // s^-1

        // Background
        ctx.fillStyle = 'rgba(255,255,255,0.02)';
        ctx.fillRect(x0,y1,pw,ph);

        // Gridlines
        ctx.lineWidth = 1;
        ctx.strokeStyle = 'rgba(255,255,255,0.07)';
        const nx = 8, ny = 6;
        for(let i=0;i<=nx;i++){
          const x = x0 + (pw*i/nx);
          ctx.beginPath(); ctx.moveTo(x,y1); ctx.lineTo(x,y0); ctx.stroke();
        }
        for(let j=0;j<=ny;j++){
          const y = y0 - (ph*j/ny);
          ctx.beginPath(); ctx.moveTo(x0,y); ctx.lineTo(x1,y); ctx.stroke();
        }

        // Axes
        ctx.strokeStyle = 'rgba(255,255,255,0.22)';
        ctx.lineWidth = 1.2;
        ctx.beginPath(); ctx.moveTo(x0,y1); ctx.lineTo(x0,y0); ctx.lineTo(x1,y0); ctx.stroke();

        // Tick labels
        ctx.fillStyle = 'rgba(232,238,247,0.92)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        for(let i=0;i<=nx;i++){
          const k = kMax*i/nx;
          const x = x0 + (pw*i/nx);
          ctx.beginPath();
          ctx.moveTo(x,y0); ctx.lineTo(x,y0+5);
          ctx.strokeStyle = 'rgba(255,255,255,0.25)';
          ctx.stroke();
          ctx.fillText(Math.round(k).toString(), x, y0+8);
        }
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        for(let j=0;j<=ny;j++){
          const w = wMax*j/ny;
          const y = y0 - (ph*j/ny);
          ctx.beginPath();
          ctx.moveTo(x0-5,y); ctx.lineTo(x0,y);
          ctx.strokeStyle = 'rgba(255,255,255,0.25)';
          ctx.stroke();
          // show in scientific-ish compact form
          const label = (w===0) ? '0' : (w/1e11).toFixed(1) + '×10¹¹';
          ctx.fillText(label, x0-8, y);
        }

        // Axis titles
        ctx.fillStyle = 'rgba(232,238,247,0.95)';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'bottom';
        ctx.font = '13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('k (cm⁻¹)', x0 + pw/2, H-12);

        ctx.save();
        ctx.translate(16, y1 + ph/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        ctx.fillText('ω (s⁻¹)', 0, 0);
        ctx.restore();

        // Title
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.font = '14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('Example linear dispersion: ω = v_A k', x0, 10);
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = 'rgba(183,195,214,0.95)';
        ctx.fillText('Example v_A = 9×10⁷ cm/s (illustrative only)', x0, 28);

        // Line ω = vA k
        function xMap(k){ return x0 + (k/kMax)*pw; }
        function yMap(w){ return y0 - (w/wMax)*ph; }

        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(xMap(0), yMap(0));
        ctx.lineTo(xMap(kMax), yMap(wMax));
        ctx.stroke();

        // Legend
        const lx = x1 - 220, ly = y1 + 10;
        ctx.fillStyle = 'rgba(16,24,38,0.65)';
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.roundRect(lx, ly, 210, 44, 10);
        ctx.fill(); ctx.stroke();

        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(lx+14, ly+22);
        ctx.lineTo(lx+44, ly+22);
        ctx.stroke();

        ctx.fillStyle = 'rgba(232,238,247,0.92)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.textAlign = 'left';
        ctx.textBaseline = 'middle';
        ctx.fillText('ω = v_A k', lx+54, ly+22);
      }

      // Polyfill for roundRect if needed
      if (!CanvasRenderingContext2D.prototype.roundRect) {
        CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
          const min = Math.min(w,h)/2;
          r = Math.min(r,min);
          this.beginPath();
          this.moveTo(x+r,y);
          this.arcTo(x+w,y,x+w,y+h,r);
          this.arcTo(x+w,y+h,x,y+h,r);
          this.arcTo(x,y+h,x,y,r);
          this.arcTo(x,y,x+w,y,r);
          this.closePath();
          return this;
        };
      }

      draw();
      window.addEventListener('resize', draw, {passive:true});
    })();
  </script>
</body>
</html>