<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Two-Level System: Energy and Heat Capacity (Schottky Anomaly + Linear-T Ensemble)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --card:#0f1620;
      --muted:#a9b6c6;
      --text:#e8eef6;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 15% 10%, rgba(125,211,252,.18), transparent 55%),
        radial-gradient(900px 500px at 85% 20%, rgba(167,139,250,.16), transparent 60%),
        radial-gradient(800px 500px at 60% 90%, rgba(52,211,153,.10), transparent 55%),
        var(--bg);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:28px 18px 10px;
      border-bottom:1px solid var(--line);
      position:relative;
      overflow:hidden;
    }
    header .wrap{
      max-width:1200px; margin:0 auto;
      display:grid; gap:12px;
    }
    h1{
      font-size:clamp(1.4rem, 2.2vw + 1rem, 2.3rem);
      margin:0;
      letter-spacing:-.02em;
    }
    .subtitle{
      color:var(--muted);
      max-width:85ch;
      margin:0;
    }
    .meta{
      display:flex; flex-wrap:wrap; gap:10px;
      color:var(--muted);
      font-size:.95rem;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      border-radius:999px;
      backdrop-filter: blur(8px);
    }
    .dot{width:8px; height:8px; border-radius:99px; background:var(--accent)}
    .grid{
      max-width:1200px;
      margin:0 auto;
      padding:18px;
      display:grid;
      grid-template-columns: 300px 1fr;
      gap:16px;
      align-items:start;
    }
    nav.toc{
      position:sticky;
      top:12px;
      align-self:start;
      background:rgba(15,22,32,.72);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px 14px 10px;
      backdrop-filter: blur(10px);
    }
    nav.toc h2{
      font-size:1rem;
      margin:0 0 8px;
      color:var(--text);
      display:flex; justify-content:space-between; align-items:center;
    }
    nav.toc ul{list-style:none; padding:0; margin:0; display:grid; gap:6px}
    nav.toc a{
      color:var(--muted);
      display:block;
      padding:7px 10px;
      border-radius:12px;
      border:1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size:.95rem;
    }
    nav.toc a:hover{
      color:var(--text);
      background:rgba(255,255,255,.04);
      border-color:rgba(255,255,255,.08);
      transform: translateX(2px);
      text-decoration:none;
    }
    main{
      display:grid;
      gap:14px;
      min-width:0;
    }
    section, article{
      background:rgba(15,22,32,.72);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px 16px;
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    section h2, article h2{
      margin:0 0 10px;
      font-size:1.25rem;
      letter-spacing:-.01em;
    }
    section h3, article h3{
      margin:14px 0 8px;
      font-size:1.06rem;
      color:#d7e3f4;
    }
    p{margin:10px 0; color:#dbe6f5}
    .muted{color:var(--muted)}
    .hr{
      height:1px;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,.12), transparent);
      margin:14px 0;
    }
    .bullets{
      display:grid; gap:8px;
      padding-left:18px;
      margin:10px 0 0;
      color:#dbe6f5;
    }
    .callouts{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:12px;
      margin-top:10px;
    }
    .card{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      border-radius:16px;
      padding:12px;
      box-shadow: 0 8px 18px rgba(0,0,0,.25);
    }
    .card h4{
      margin:0 0 6px;
      font-size:1rem;
      display:flex; align-items:center; gap:8px;
    }
    .tag{
      display:inline-block;
      font-size:.8rem;
      color:rgba(255,255,255,.86);
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04);
    }
    .assump{grid-column: span 6;}
    .keyeq{grid-column: span 6;}
    .mist{grid-column: span 6;}
    .final{grid-column: span 6;}
    .mathinsight{grid-column: span 12;}
    .icon{
      width:10px; height:10px; border-radius:99px;
      background:var(--accent2);
      box-shadow:0 0 0 3px rgba(167,139,250,.18);
      flex:0 0 auto;
    }
    .icon.ok{background:var(--ok); box-shadow:0 0 0 3px rgba(52,211,153,.18)}
    .icon.warn{background:var(--warn); box-shadow:0 0 0 3px rgba(251,191,36,.18)}
    .icon.bad{background:var(--bad); box-shadow:0 0 0 3px rgba(251,113,133,.18)}
    .eq{
      font-family:var(--mono);
      font-size:.95rem;
      background:rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:10px 10px;
      overflow:auto;
      position:relative;
    }
    .eq .controls{
      display:flex; gap:8px;
      position:absolute; right:8px; top:8px;
    }
    button.copy{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04);
      color:var(--text);
      padding:6px 9px;
      border-radius:12px;
      cursor:pointer;
      font-size:.85rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    button.copy:hover{transform: translateY(-1px); background:rgba(255,255,255,.07); border-color:rgba(255,255,255,.20)}
    button.copy:active{transform: translateY(0px)}
    .eq pre{
      margin:0;
      padding-right:110px; /* room for buttons */
      white-space:pre-wrap;
      word-break:break-word;
      color:#eaf2ff;
    }
    details{
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      border-radius:16px;
      padding:10px 12px;
      margin:10px 0;
    }
    summary{
      cursor:pointer;
      color:#d7e3f4;
      font-weight:600;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    summary:before{
      content:"▸";
      display:inline-block;
      margin-right:8px;
      transform: translateY(-1px);
      color:var(--accent);
    }
    details[open] summary:before{content:"▾"}
    figure{
      margin:10px 0 0;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
      border-radius:16px;
      padding:10px;
    }
    figcaption{
      color:var(--muted);
      font-size:.92rem;
      margin-top:8px;
    }
    canvas{width:100%; height:360px; display:block; border-radius:12px;}
    .backtop{
      display:inline-flex; align-items:center; gap:8px;
      margin-top:10px;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.03);
      color:var(--muted);
    }
    .backtop:hover{color:var(--text); text-decoration:none; background:rgba(255,255,255,.06)}
    footer{
      max-width:1200px;
      margin:0 auto;
      padding:16px 18px 40px;
      color:var(--muted);
      font-size:.95rem;
    }
    .two-col{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
      nav.toc{position:relative; top:0}
      .assump,.keyeq,.mist,.final{grid-column: span 12;}
      .two-col{grid-template-columns:1fr}
      .eq pre{padding-right:0}
      .eq .controls{position:static; margin-bottom:8px}
    }
    @media print{
      body{background:#fff; color:#000}
      header, section, article, nav.toc{background:#fff; box-shadow:none; border:1px solid #ddd}
      nav.toc{position:relative}
      a{color:#000; text-decoration:underline}
      button.copy{display:none}
      .backtop{display:none}
      canvas{height:260px}
      section, article{break-inside:avoid; page-break-inside:avoid}
      h2{page-break-after:avoid}
    }
    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform: translateX(-50%);
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(15,22,32,.90);
      color:var(--text);
      box-shadow:var(--shadow);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      z-index:99;
      font-size:.92rem;
      backdrop-filter: blur(10px);
    }
    .toast.show{opacity:1; transform: translateX(-50%) translateY(-3px)}
  </style>
</head>
<body>
  <a id="top"></a>
  <header>
    <div class="wrap">
      <h1>Two-Level System: Energy and Heat Capacity</h1>
      <p class="subtitle">
        A clean statistical-mechanics derivation of the internal energy and heat capacity for a two-level system with energies
        +Δ and −Δ, plus the key low-temperature result: a uniform distribution of splittings yields <em>linear-in-T</em> heat capacity
        (important for glasses and dilute paramagnets).
      </p>
      <div class="meta">
        <span class="pill"><span class="dot"></span>Statistical Mechanics</span>
        <span class="pill"><span class="dot" style="background:var(--accent2)"></span>Two-Level Systems (TLS)</span>
        <span class="pill"><span class="dot" style="background:var(--ok)"></span>Applied / Industry Lens</span>
      </div>
    </div>
  </header>

  <div class="grid">
    <nav class="toc" aria-label="Table of contents">
      <h2>
        Table of Contents
        <span class="tag">sticky</span>
      </h2>
      <ul>
        <li><a href="#quick-summary">Quick Summary</a></li>
        <li><a href="#part0">PART 0 — Concept Primer</a></li>
        <li><a href="#part0b">PART 0B — Industry &amp; Applied Physics</a></li>
        <li><a href="#part1">PART 1 — Problem Analysis</a></li>
        <li><a href="#part2">PART 2 — Strategy &amp; Tips</a></li>
        <li><a href="#part3">PART 3 — Full Solution</a></li>
        <li><a href="#part4">PART 4 — Deeper Understanding</a></li>
        <li><a href="#part5">PART 5 — Optional Plot Guide</a></li>
      </ul>
      <a class="backtop" href="#top" title="Back to top">↑ Back to top</a>
    </nav>

    <main>
      <section id="quick-summary">
        <h2>Quick Summary</h2>
        <ul class="bullets">
          <li><strong>What this is:</strong> A two-level system (TLS) with energies <span class="tag">E = ±Δ</span> in thermal equilibrium at temperature <em>T</em>.</li>
          <li><strong>Key physics idea:</strong> The heat capacity comes from how the <em>thermal population imbalance</em> changes with temperature.</li>
          <li><strong>Governing object:</strong> Canonical partition function <span class="tag">Z = Σ exp(−βE)</span> with β = 1/(k<sub>B</sub>T).</li>
          <li><strong>Energy result (symbolic):</strong> <span class="tag">U = −Δ tanh(Δ/k<sub>B</sub>T)</span> (approaches −Δ at low T, goes to 0 at high T).</li>
          <li><strong>Heat capacity result (symbolic):</strong> <span class="tag">C = k<sub>B</sub>(Δ/k<sub>B</sub>T)<sup>2</sup> sech<sup>2</sup>(Δ/k<sub>B</sub>T)</span> (Schottky anomaly: peaked vs T).</li>
          <li><strong>Ensemble twist:</strong> If Δ is uniformly distributed on [0, Δ<sub>0</sub>] and k<sub>B</sub>T ≪ Δ<sub>0</sub>, then the average heat capacity is <em>linear</em> in T.</li>
          <li><strong>Low-T linear law:</strong> <span class="tag">⟨C⟩ ≈ (π²/12)(k<sub>B</sub>²/Δ<sub>0</sub>) T</span> (per TLS for a uniform Δ distribution).</li>
          <li><strong>Industrial relevance:</strong> Explains low-T thermal anomalies in glasses, defects in solids, and dilute magnetic alloys; impacts cryogenic thermal budgets and sensor stability.</li>
        </ul>

        <div class="callouts">
          <div class="card keyeq">
            <h4><span class="icon"></span>Key Equations</h4>
            <div class="eq" data-plain="Z = e^{beta*Delta} + e^{-beta*Delta} = 2 cosh(beta*Delta)
U = - d/d(beta) ln Z
C = dU/dT = k_B beta^2 d^2/d(beta)^2 ln Z">
              <div class="controls">
                <button class="copy" data-copy="eq">Copy</button>
              </div>
              <pre>Z = e^{βΔ} + e^{−βΔ} = 2 cosh(βΔ)
U = − d/dβ [ ln Z ]
C = dU/dT = k_B β^2 d^2/dβ^2 [ ln Z ]</pre>
            </div>
          </div>
          <div class="card assump">
            <h4><span class="icon warn"></span>Assumptions</h4>
            <ul class="bullets">
              <li>Canonical equilibrium at temperature T (fixed T, weak coupling to a bath).</li>
              <li>Non-interacting TLS (for part b, we average independent contributions).</li>
              <li>Energy levels exactly ±Δ (no degeneracy unless stated; here take degeneracy 1:1).</li>
              <li>For part (b): Δ uniformly distributed on [0, Δ<sub>0</sub>] and <span class="tag">k<sub>B</sub>T ≪ Δ<sub>0</sub></span> so the integral can be extended to ∞.</li>
            </ul>
          </div>
        </div>
      </section>

      <article id="part0">
        <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

        <h3>Core definitions (symbols + SI units)</h3>
        <ul class="bullets">
          <li><strong>Δ</strong>: half-splitting energy of the TLS (J). Levels are E<sub>±</sub> = ±Δ.</li>
          <li><strong>T</strong>: absolute temperature (K).</li>
          <li><strong>k<sub>B</sub></strong>: Boltzmann constant (J/K).</li>
          <li><strong>β</strong> = 1/(k<sub>B</sub>T): inverse thermal energy (1/J).</li>
          <li><strong>Z</strong>: canonical partition function (dimensionless).</li>
          <li><strong>U</strong>: mean internal energy (J per TLS).</li>
          <li><strong>C</strong>: heat capacity at constant volume (J/K per TLS). For a TLS with no volume work, “C” is the relevant thermal response.</li>
          <li><strong>sech(x)</strong> = 1/cosh(x), <strong>tanh(x)</strong> = sinh(x)/cosh(x) (dimensionless hyperbolic functions).</li>
        </ul>

        <h3>Physical meaning (intuition)</h3>
        <p>
          A two-level system is the simplest model of a microscopic “switch”:
          at low temperature almost all probability sits in the ground state (here −Δ),
          so adding a bit of heat barely changes the state and the heat capacity is small.
          At intermediate temperature, populations shift rapidly between the two levels, maximizing
          the ability to store additional energy (heat capacity peak, the <em>Schottky anomaly</em>).
          At high temperature, both levels become nearly equally populated, so energy saturates toward 0 and
          heat capacity falls again.
        </p>

        <h3>Key principle and validity conditions</h3>
        <ul class="bullets">
          <li><strong>Canonical ensemble:</strong> probabilities p<sub>i</sub> ∝ exp(−βE<sub>i</sub>) assume thermal equilibrium with a bath at temperature T.</li>
          <li><strong>Independence:</strong> If many TLS do not interact, total Z factorizes and total heat capacity is the sum (linearity of expectation).</li>
          <li><strong>Heat capacity definition:</strong> C = (∂U/∂T) at fixed external parameters (e.g., fixed Δ).</li>
        </ul>

        <h3>Common models/approximations (why they’re used)</h3>
        <ul class="bullets">
          <li><strong>Exact two-level energies:</strong> E = ±Δ is analytically solvable; it isolates the essence of thermal population switching.</li>
          <li><strong>Distributed Δ (glasses, defects):</strong> Real solids contain many defect configurations with a spread of splittings; averaging produces new temperature laws (notably linear C at low T).</li>
          <li><strong>Low-T limit (k<sub>B</sub>T ≪ Δ<sub>0</sub>):</strong> simplifies ensemble integrals by extending upper limits to ∞ and focusing on small dimensionless variable x = Δ/(k<sub>B</sub>T).</li>
        </ul>

        <h3>Mini intuition examples</h3>
        <ul class="bullets">
          <li><strong>Low T:</strong> if T → 0, p(−Δ) → 1, so U → −Δ and C → 0 (no accessible excitations).</li>
          <li><strong>High T:</strong> if T → ∞, p(±Δ) → 1/2, so U → 0 (symmetric levels average out).</li>
          <li><strong>Ensemble of splittings:</strong> at low T, only TLS with Δ ≲ k<sub>B</sub>T can respond; if the density of small-Δ TLS is roughly constant, the number of “active” TLS grows ∝ T, hence C ∝ T.</li>
        </ul>

        <h3>What to watch for (pitfalls)</h3>
        <ul class="bullets">
          <li><strong>Sign conventions:</strong> with energies ±Δ, the ground state is −Δ, so U should be negative at low T.</li>
          <li><strong>Different parametrizations:</strong> many texts use levels 0 and ΔE; here ΔE = 2Δ. Keep track carefully.</li>
          <li><strong>Derivatives:</strong> C = ∂U/∂T at fixed Δ (not at fixed β).</li>
          <li><strong>Distribution averaging:</strong> average C(Δ) over Δ (not U then differentiate unless stated; both are fine if justified by linearity and smoothness).</li>
        </ul>

        <div class="callouts">
          <div class="card mathinsight">
            <h4><span class="icon"></span>Math Insight (core equation as a mathematical object)</h4>
            <p class="muted" style="margin-top:6px">
              The whole problem reduces to properties of <strong>log-partition functions</strong>.
              Mathematically, ln Z(β) is a <em>cumulant generating function</em> for the energy.
              Its first derivative gives the mean energy (a “moment”), and its second derivative gives the variance:
              <span class="tag">Var(E) = ∂² ln Z / ∂β²</span>.
              This is why the heat capacity can be written as a positive quantity proportional to energy fluctuations:
              <span class="tag">C = Var(E)/(k<sub>B</sub>T²)</span>.
            </p>
          </div>
        </div>
      </article>

      <article id="part0b">
        <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>

        <h3>Where this appears in industry (concrete application areas)</h3>
        <ul class="bullets">
          <li><strong>Cryogenic engineering &amp; space systems:</strong> thermal budgets at 1–20 K are dominated by “anomalous” heat capacities from defects and amorphous dielectrics.</li>
          <li><strong>Quantum devices &amp; superconducting circuits:</strong> TLS in amorphous oxides cause dielectric loss, frequency noise, and temperature-dependent dissipation—affecting coherence and yield.</li>
          <li><strong>Materials processing &amp; reliability:</strong> impurities and defect states in metals/semiconductors impact low-T specific heat and thermal conductance, relevant for sensors and metrology.</li>
          <li><strong>Dilute magnetic alloys:</strong> Schottky-type contributions help interpret calorimetry and magnetic thermodynamics; relevant in alloy design and characterization.</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul class="bullets">
          <li><strong>Performance:</strong> unexpected C(T) changes cooldown times and temperature stability.</li>
          <li><strong>Reliability:</strong> thermal drift/noise can degrade precision instruments and quantum hardware.</li>
          <li><strong>Cost &amp; efficiency:</strong> larger heat capacity means larger cryocoolers, more power, heavier systems.</li>
          <li><strong>Manufacturability:</strong> TLS density depends strongly on fabrication (oxide quality, annealing, impurities), linking process control to thermal/electrical performance.</li>
        </ul>

        <h3>Typical measurement/validation methods</h3>
        <ul class="bullets">
          <li><strong>Calorimetry</strong> (relaxation or AC calorimetry) to measure C(T) at low temperatures.</li>
          <li><strong>Dielectric loss tangent</strong> and <strong>noise spectroscopy</strong> (for TLS in insulators used in resonators/qubits).</li>
          <li><strong>Magnetization + specific heat</strong> to separate magnetic Schottky contributions from lattice contributions.</li>
        </ul>

        <h3>Design trade-offs &amp; constraints</h3>
        <ul class="bullets">
          <li><strong>Non-ideal distributions:</strong> real P(Δ) often is not perfectly uniform; still, the low-Δ density controls low-T scaling.</li>
          <li><strong>Interactions:</strong> at higher densities, TLS may interact, modifying the simple additive heat capacity.</li>
          <li><strong>Coupling to strain/electric fields:</strong> Δ can shift with stress/field, adding extra temperature and bias dependence.</li>
          <li><strong>Parameter tolerances:</strong> small changes in fabrication can strongly change TLS density—important for process capability (industrial engineering viewpoint).</li>
        </ul>

        <details>
          <summary>From lab to product: how the ideal model is adapted</summary>
          <p>
            In products, engineers rarely assume a single Δ. Instead they fit data with a distribution P(Δ) (and often also
            a distribution of coupling strengths to fields/strain). The TLS model becomes a <em>design-relevant parameterization</em>:
            you measure C(T) and dielectric loss, infer effective TLS density, then use it to predict cooldown time,
            temperature stability, and noise—feeding into tolerance stacks and process control plans.
          </p>
        </details>
      </article>

      <article id="part1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>Problem rewritten clearly</h3>
        <p>
          Consider a two-level system with energy eigenvalues <strong>+Δ</strong> and <strong>−Δ</strong>.
          (a) Show that its mean energy U(T) and heat capacity C(T) are:
          U = −Δ tanh(Δ/k<sub>B</sub>T) and C = k<sub>B</sub>(Δ/k<sub>B</sub>T)<sup>2</sup> sech<sup>2</sup>(Δ/k<sub>B</sub>T).
          (b) Now suppose you have many such systems with splittings Δ that are uniformly distributed from 0 to Δ<sub>0</sub>.
          Show that, for <strong>k<sub>B</sub>T ≪ Δ<sub>0</sub></strong>, the averaged heat capacity is proportional to T (linear-in-T).
        </p>

        <h3>Given quantities</h3>
        <ul class="bullets">
          <li>Energy levels: E<sub>±</sub> = ±Δ</li>
          <li>Temperature T, Boltzmann constant k<sub>B</sub></li>
          <li>For (b): Δ distributed uniformly on [0, Δ<sub>0</sub>], i.e. P(Δ) = 1/Δ<sub>0</sub></li>
          <li>Low-temperature regime: k<sub>B</sub>T ≪ Δ<sub>0</sub></li>
        </ul>

        <h3>Unknowns / what to prove</h3>
        <ul class="bullets">
          <li>(a) Derive U(T) and C(T) explicitly.</li>
          <li>(b) Compute/estimate ⟨C(T)⟩ = ∫ P(Δ) C(Δ,T) dΔ in the stated limit, and show ⟨C⟩ ∝ T.</li>
        </ul>

        <h3>Relevant principles and why they apply</h3>
        <ul class="bullets">
          <li><strong>Canonical ensemble:</strong> appropriate because the system is in equilibrium with a heat bath at temperature T.</li>
          <li><strong>Partition function method:</strong> gives U and C through derivatives of ln Z (direct, systematic, low error-risk).</li>
          <li><strong>Linearity of expectation:</strong> for independent TLS, ensemble-averaged heat capacity is the average of individual heat capacities.</li>
        </ul>

        <h3>Explicit assumptions</h3>
        <div class="card">
          <h4><span class="icon warn"></span>Assumptions (stated)</h4>
          <ul class="bullets">
            <li>No interactions between TLS; energies are fixed at ±Δ (for each TLS) during thermal equilibration.</li>
            <li>No degeneracy: one state at +Δ and one at −Δ. (If degeneracy existed, Z would include factors and formulas change.)</li>
            <li>For part (b), Δ is <em>random</em> but static across the ensemble; we average over the distribution P(Δ).</li>
            <li>Low-T condition means relevant Δ are of order k<sub>B</sub>T; since Δ<sub>0</sub> is much larger, the upper limit can be approximated by ∞.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare 2–3)</h3>
        <div class="two-col">
          <div class="card">
            <h4><span class="icon ok"></span>Approach A: Partition function derivatives</h4>
            <ul class="bullets">
              <li><strong>Pros:</strong> clean, standard, minimal algebra errors; directly yields U and C.</li>
              <li><strong>Cons:</strong> requires comfort with β-derivatives and chain rule to T.</li>
            </ul>
          </div>
          <div class="card">
            <h4><span class="icon"></span>Approach B: Direct probabilities then average energy</h4>
            <ul class="bullets">
              <li><strong>Pros:</strong> intuitive (use p<sub>±</sub> = e^{∓βΔ}/Z); then U = Σ pE.</li>
              <li><strong>Cons:</strong> still ends up equivalent; may be slightly longer for C.</li>
            </ul>
          </div>
          <div class="card" style="grid-column:1/-1">
            <h4><span class="icon"></span>Approach C: Fluctuation formula for heat capacity</h4>
            <ul class="bullets">
              <li><strong>Idea:</strong> C = Var(E)/(k<sub>B</sub>T²) in canonical ensemble.</li>
              <li><strong>Pros:</strong> highlights positivity and physical meaning (energy fluctuations).</li>
              <li><strong>Cons:</strong> still needs computing Var(E) from p<sub>±</sub>, similar work.</li>
            </ul>
          </div>
        </div>

        <p>
          <strong>We choose Approach A</strong> because it is systematic, compact, and extends naturally to part (b) via C(Δ,T).
        </p>
      </article>

      <article id="part2">
        <h2>PART 2 — Strategy &amp; Tips (roadmap only)</h2>

        <h3>Roadmap (5–12 steps)</h3>
        <ol class="bullets">
          <li><strong>Write the model:</strong> energies E<sub>±</sub> = ±Δ; define β = 1/(k<sub>B</sub>T).</li>
          <li><strong>Compute Z(β):</strong> sum Boltzmann factors; simplify using cosh.</li>
          <li><strong>Compute U:</strong> use U = −∂ ln Z/∂β; simplify to a tanh form and check limits.</li>
          <li><strong>Compute C:</strong> differentiate U with respect to T (chain rule β(T)); express in terms of sech².</li>
          <li><strong>Part (b) setup:</strong> write ⟨C(T)⟩ = (1/Δ<sub>0</sub>)∫₀^{Δ0} C(Δ,T) dΔ.</li>
          <li><strong>Nondimensionalize:</strong> substitute x = Δ/(k<sub>B</sub>T), making the small parameter k<sub>B</sub>T/Δ<sub>0</sub> explicit.</li>
          <li><strong>Low-T approximation:</strong> since k<sub>B</sub>T ≪ Δ<sub>0</sub>, extend upper limit to ∞ and evaluate a standard integral.</li>
          <li><strong>Conclude linearity:</strong> show ⟨C⟩ ∝ T and extract the coefficient.</li>
          <li><strong>Sanity checks:</strong> units, positivity of C, limiting cases, physical interpretation.</li>
        </ol>

        <div class="callouts">
          <div class="card mist">
            <h4><span class="icon bad"></span>Common mistakes</h4>
            <ul class="bullets">
              <li>Mixing the parameterizations: levels (0, ΔE) vs (±Δ). Here ΔE = 2Δ.</li>
              <li>Forgetting chain rule: d/dT = (dβ/dT) d/dβ with dβ/dT = −1/(k<sub>B</sub>T²).</li>
              <li>Dropping the minus sign in U = −∂ ln Z/∂β.</li>
              <li>In part (b), averaging U then differentiating without stating linearity/regularity; easiest is average C(Δ,T) directly.</li>
              <li>Not justifying why Δ<sub>0</sub> can be replaced by ∞ (must use k<sub>B</sub>T ≪ Δ<sub>0</sub>).</li>
            </ul>
          </div>
          <div class="card keyeq">
            <h4><span class="icon"></span>Tools you’ll use</h4>
            <ul class="bullets">
              <li>Hyperbolic identities: cosh²x − sinh²x = 1, and d/dx[tanh x] = sech²x.</li>
              <li>Dimensionless variable x = Δ/(k<sub>B</sub>T) to expose scaling.</li>
              <li>Integral (used later): ∫₀^∞ x² sech²x dx = π²/12.</li>
            </ul>
          </div>
        </div>
      </article>

      <article id="part3">
        <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

        <h3>Physical intuition (before calculating)</h3>
        <p>
          Because the lower level is at −Δ, at very low temperature almost every system sits there, so U ≈ −Δ and
          C ≈ 0. At very high temperature, both levels are almost equally populated, so the average energy tends to 0.
          Therefore U(T) should monotonically increase from −Δ to 0 as T increases, and C(T) should be small at both extremes
          with a peak in between.
        </p>

        <div class="hr"></div>

        <h3>Mathematical model (explicit)</h3>
        <div class="eq" data-plain="Model:
State space: {+, -}
E_+(Delta) = +Delta, E_-(Delta) = -Delta
Canonical probabilities: p_i = exp(-beta E_i)/Z
beta = 1/(k_B T), T > 0, Delta >= 0
Partition function: Z(beta,Delta) = sum_i exp(-beta E_i)">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>Model:
State space: {+, −}
E_+(Δ) = +Δ,   E_−(Δ) = −Δ
Canonical probabilities: p_i = exp(−β E_i)/Z
β = 1/(k_B T),   T &gt; 0,   Δ ≥ 0
Partition function: Z(β,Δ) = Σ_i exp(−β E_i)</pre>
        </div>

        <p class="muted">
          Note: No spatial coordinate/PDE is needed here because this is a finite-state statistical model.
          The “operator” viewpoint is via derivatives: U = −∂β ln Z and C = ∂T U, both well-defined for T&gt;0.
        </p>

        <div class="hr"></div>

        <h3>(a) Derive Z, U, and C for energies ±Δ</h3>

        <h4>Step 1: Partition function</h4>
        <p>
          By definition,
          Z = exp(−βE<sub>+</sub>) + exp(−βE<sub>−</sub>) = exp(−β(+Δ)) + exp(−β(−Δ)).
        </p>
        <div class="eq" data-plain="Z = e^{-beta*Delta} + e^{+beta*Delta} = 2 cosh(beta*Delta)">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>Z = e^{−βΔ} + e^{+βΔ} = 2 cosh(βΔ)</pre>
        </div>
        <p class="muted">
          This simplification is valid because cosh(x) = (e^x + e^{−x})/2.
        </p>

        <h4>Step 2: Mean energy from ln Z</h4>
        <p>
          The canonical mean energy is
          U = ⟨E⟩ = −∂ ln Z / ∂β.
          This is a standard identity from statistical mechanics; it follows from differentiating Z with respect to β and using
          the definition of probabilities (linearity of sums).
        </p>

        <p>Compute ln Z:</p>
        <div class="eq" data-plain="ln Z = ln(2 cosh(beta*Delta))">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>ln Z = ln(2 cosh(βΔ))</pre>
        </div>

        <p>Differentiate with respect to β (chain rule):</p>
        <div class="eq" data-plain="d/d(beta) ln Z
= d/d(beta) [ln 2 + ln cosh(beta*Delta)]
= (1/cosh(beta*Delta)) * sinh(beta*Delta) * Delta
= Delta tanh(beta*Delta)">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>d/dβ ln Z
= d/dβ [ln 2 + ln cosh(βΔ)]
= (1/cosh(βΔ)) · sinh(βΔ) · (d/dβ)(βΔ)
= tanh(βΔ) · Δ</pre>
        </div>

        <p>Therefore</p>
        <div class="eq" data-plain="U = - d/d(beta) ln Z = -Delta tanh(beta*Delta) = -Delta tanh(Delta/(k_B T))">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>U = − d/dβ ln Z
  = −Δ tanh(βΔ)
  = −Δ tanh(Δ/(k_B T))</pre>
        </div>

        <h4>Step 3: Heat capacity C = ∂U/∂T</h4>
        <p>
          We differentiate U(T) at fixed Δ. Let x = Δ/(k<sub>B</sub>T). Then U = −Δ tanh(x).
          Using the chain rule:
        </p>
        <ul class="bullets">
          <li>dU/dT = (dU/dx)(dx/dT)</li>
          <li>d/dx[tanh x] = sech²x</li>
          <li>x = Δ/(k<sub>B</sub>T) ⇒ dx/dT = −Δ/(k<sub>B</sub>T²) = −x/T</li>
        </ul>

        <p>Now compute explicitly:</p>
        <div class="eq" data-plain="U(T) = -Delta tanh(x), x=Delta/(k_B T)
dU/dx = -Delta sech^2(x)
dx/dT = -Delta/(k_B T^2)
C = dU/dT = (-Delta sech^2 x)*(-Delta/(k_B T^2)) = (Delta^2/(k_B T^2)) sech^2 x
= k_B (Delta/(k_B T))^2 sech^2(Delta/(k_B T))">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>U(T) = −Δ tanh(x),   x = Δ/(k_B T)
dU/dx = −Δ sech²(x)
dx/dT = −Δ/(k_B T²)

C = dU/dT = (dU/dx)(dx/dT)
  = (−Δ sech²x) (−Δ/(k_B T²))
  = (Δ²/(k_B T²)) sech²x
  = k_B (Δ/(k_B T))² sech²(Δ/(k_B T))</pre>
        </div>

        <div class="callouts">
          <div class="card final">
            <h4><span class="icon ok"></span>Final result for (a)</h4>
            <div class="eq" data-plain="U = -Delta tanh(Delta/(k_B T))
C = k_B (Delta/(k_B T))^2 sech^2(Delta/(k_B T))">
              <div class="controls">
                <button class="copy" data-copy="eq">Copy</button>
              </div>
              <pre>U = −Δ tanh(Δ/(k_B T))
C = k_B (Δ/(k_B T))² sech²(Δ/(k_B T))</pre>
            </div>
          </div>
          <div class="card keyeq">
            <h4><span class="icon"></span>Sanity checks (a)</h4>
            <ul class="bullets">
              <li><strong>Units:</strong> U has units of energy (Δ), C has units J/K (k<sub>B</sub> times dimensionless factor).</li>
              <li><strong>Low T:</strong> x→∞ ⇒ tanh x→1 ⇒ U→−Δ; sech²x→0 exponentially ⇒ C→0.</li>
              <li><strong>High T:</strong> x→0 ⇒ tanh x≈x ⇒ U≈−Δ·(Δ/(k<sub>B</sub>T)) = −Δ²/(k<sub>B</sub>T) → 0; C≈k<sub>B</sub>x² → 0.</li>
              <li><strong>Positivity:</strong> sech² ≥ 0 ⇒ C ≥ 0 always, as required.</li>
            </ul>
          </div>
        </div>

        <div class="hr"></div>

        <h3>(b) Uniform distribution of Δ on [0, Δ<sub>0</sub>] ⇒ ⟨C⟩ ∝ T for k<sub>B</sub>T ≪ Δ<sub>0</sub></h3>

        <h4>Step 1: Set up the ensemble average</h4>
        <p>
          Let P(Δ) = 1/Δ<sub>0</sub> for 0 ≤ Δ ≤ Δ<sub>0</sub> (and 0 otherwise).
          The average heat capacity per TLS is
        </p>
        <div class="eq" data-plain="⟨C(T)⟩ = ∫_0^{Delta0} (1/Delta0) C(Delta,T) dDelta
= (1/Delta0) ∫_0^{Delta0} k_B (Delta/(k_B T))^2 sech^2(Delta/(k_B T)) dDelta">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>⟨C(T)⟩ = ∫₀^{Δ0} (1/Δ0) C(Δ,T) dΔ
      = (1/Δ0) ∫₀^{Δ0} k_B (Δ/(k_B T))² sech²(Δ/(k_B T)) dΔ</pre>
        </div>

        <p class="muted">
          Linearity justification: for independent systems, total heat capacity is the sum, and averaging over Δ commutes with summation and differentiation.
        </p>

        <h4>Step 2: Nondimensionalize (scaling argument)</h4>
        <p>
          Introduce the dimensionless variable
          x = Δ/(k<sub>B</sub>T), so Δ = x k<sub>B</sub>T and dΔ = k<sub>B</sub>T dx.
          The upper limit becomes Δ<sub>0</sub>/(k<sub>B</sub>T).
        </p>
        <div class="eq" data-plain="Let x = Delta/(k_B T) ⇒ dDelta = k_B T dx, upper limit x_max = Delta0/(k_B T).
Then
⟨C⟩ = (1/Delta0) ∫_0^{x_max} k_B x^2 sech^2(x) (k_B T) dx
= (k_B^2 T/Delta0) ∫_0^{x_max} x^2 sech^2(x) dx">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>Let x = Δ/(k_B T)  ⇒  dΔ = k_B T dx,  x_max = Δ0/(k_B T)

⟨C⟩ = (1/Δ0) ∫₀^{x_max} k_B x² sech²(x) (k_B T) dx
    = (k_B² T/Δ0) ∫₀^{x_max} x² sech²(x) dx</pre>
        </div>

        <p>
          <strong>Dimensional analysis check:</strong>
          k<sub>B</sub>²T/Δ<sub>0</sub> has units (J/K)²·K / J = J/K, correct for heat capacity.
          The integral is dimensionless.
        </p>

        <h4>Step 3: Use the low-T limit k<sub>B</sub>T ≪ Δ<sub>0</sub></h4>
        <p>
          The condition k<sub>B</sub>T ≪ Δ<sub>0</sub> implies x<sub>max</sub> = Δ<sub>0</sub>/(k<sub>B</sub>T) ≫ 1.
          Since sech²(x) decays as ~4e^{−2x} for large x, the integrand x² sech²(x) becomes exponentially small for x ≫ 1.
          Therefore extending the upper limit to ∞ introduces only an exponentially small error:
        </p>
        <div class="eq" data-plain="For x_max >> 1:
∫_0^{x_max} x^2 sech^2 x dx ≈ ∫_0^∞ x^2 sech^2 x dx">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>For x_max ≫ 1:
∫₀^{x_max} x² sech²x dx  ≈  ∫₀^∞ x² sech²x dx</pre>
        </div>

        <h4>Step 4: Evaluate the standard integral</h4>
        <p>
          A known integral (derivable by series expansion or contour methods) is:
        </p>
        <div class="eq" data-plain="I = ∫_0^∞ x^2 sech^2(x) dx = π^2/12">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>I = ∫₀^∞ x² sech²(x) dx = π²/12</pre>
        </div>

        <details>
          <summary>Optional derivation sketch of ∫₀^∞ x² sech²x dx = π²/12 (no “magic”, but compact)</summary>
          <p>
            Use the series identity for x&gt;0:
            sech²x = 4 Σ<sub>n=1</sub>^∞ (−1)<sup>n+1</sup> n e^{−2nx}.
            (This follows by differentiating tanh x = 1 − 2/(e^{2x}+1) and expanding the geometric series.)
            Then
          </p>
          <div class="eq" data-plain="I = ∫_0^∞ x^2 sech^2 x dx
= 4 Σ_{n=1}^∞ (-1)^{n+1} n ∫_0^∞ x^2 e^{-2 n x} dx
and ∫_0^∞ x^2 e^{-a x} dx = 2/a^3 (a>0)
So I = 4 Σ_{n=1}^∞ (-1)^{n+1} n * 2/(2n)^3
= 4 Σ_{n=1}^∞ (-1)^{n+1} * (1/(4 n^2))
= Σ_{n=1}^∞ (-1)^{n+1} (1/n^2)
= π^2/12">
            <div class="controls">
              <button class="copy" data-copy="eq">Copy</button>
            </div>
            <pre>I = ∫₀^∞ x² sech²x dx
  = 4 Σ_{n=1}^∞ (−1)^{n+1} n ∫₀^∞ x² e^{−2nx} dx
and ∫₀^∞ x² e^{−a x} dx = 2/a³  (a&gt;0)

So I = 4 Σ_{n=1}^∞ (−1)^{n+1} n · 2/(2n)³
     = 4 Σ_{n=1}^∞ (−1)^{n+1} · (1/(4 n²))
     = Σ_{n=1}^∞ (−1)^{n+1} (1/n²)
     = π²/12</pre>
          </div>
          <p class="muted">
            The last step uses the well-known alternating zeta value: Σ (−1)^{n+1}/n² = π²/12.
          </p>
        </details>

        <h4>Step 5: Conclude linear-in-T</h4>
        <p>
          Substitute I = π²/12 into the low-T approximation:
        </p>
        <div class="eq" data-plain="⟨C(T)⟩ ≈ (k_B^2 T/Delta0) (π^2/12)  (for k_B T << Delta0)">
          <div class="controls">
            <button class="copy" data-copy="eq">Copy</button>
          </div>
          <pre>⟨C(T)⟩ ≈ (k_B² T/Δ0) (π²/12)   (for k_B T ≪ Δ0)</pre>
        </div>

        <div class="callouts">
          <div class="card final">
            <h4><span class="icon ok"></span>Final result for (b)</h4>
            <div class="eq" data-plain="If Delta ~ Uniform(0,Delta0) and k_B T << Delta0:
⟨C⟩ = (1/Delta0)∫_0^{Delta0} C(Delta,T)dDelta ≈ (π^2/12)(k_B^2/Delta0) T  (linear in T)">
              <div class="controls">
                <button class="copy" data-copy="eq">Copy</button>
              </div>
              <pre>If Δ ~ Uniform(0, Δ0) and k_B T ≪ Δ0:
⟨C⟩ = (1/Δ0)∫₀^{Δ0} C(Δ,T) dΔ  ≈  (π²/12)(k_B²/Δ0) T   (linear in T)</pre>
            </div>
          </div>
          <div class="card keyeq">
            <h4><span class="icon"></span>Sanity checks (b)</h4>
            <ul class="bullets">
              <li><strong>Linearity mechanism:</strong> number of “thermally active” TLS scales as Δ ≲ k<sub>B</sub>T; with uniform P(Δ), that count is ∝ T.</li>
              <li><strong>Units:</strong> (k<sub>B</sub>²/Δ<sub>0</sub>)T is J/K.</li>
              <li><strong>Regime:</strong> result is asymptotic for k<sub>B</sub>T ≪ Δ<sub>0</sub>; if T grows, upper-limit effects matter and linearity bends.</li>
            </ul>
          </div>
        </div>

        <div class="hr"></div>

        <h3>One static plot (optional but helpful): single-Δ TLS vs uniform-Δ ensemble</h3>
        <p class="muted">
          The curve below uses dimensionless temperature t = k<sub>B</sub>T/Δ<sub>0</sub> (unitless). The ensemble result is linear at small t.
          The single TLS (example Δ = 0.5Δ<sub>0</sub>) shows the classic Schottky peak and is exponentially small at low t.
        </p>
        <figure>
          <canvas id="plot" aria-label="Heat capacity plot"></canvas>
          <figcaption>
            Plot of dimensionless heat capacity <strong>c = C/k<sub>B</sub></strong> vs <strong>t = k<sub>B</sub>T/Δ<sub>0</sub></strong>.
            Example values: single TLS uses Δ = 0.5Δ<sub>0</sub>. Ensemble uses uniform Δ ∈ [0, Δ<sub>0</sub>].
          </figcaption>
        </figure>

        <div class="callouts">
          <div class="card final" style="grid-column:span 12;">
            <h4><span class="icon ok"></span>Copy-ready final answers (plain text)</h4>
            <div class="eq" data-plain="(a) For energies E = ±Δ:
U(T) = -Δ tanh(Δ/(k_B T))
C(T) = k_B (Δ/(k_B T))^2 sech^2(Δ/(k_B T))

(b) If Δ is uniform on [0, Δ0] and k_B T << Δ0:
⟨C(T)⟩ = (1/Δ0)∫_0^{Δ0} C(Δ,T)dΔ ≈ (π^2/12)(k_B^2/Δ0) T  (linear in T)">
              <div class="controls">
                <button class="copy" data-copy="final">Copy</button>
              </div>
              <pre>(a) For energies E = ±Δ:
U(T) = -Δ tanh(Δ/(k_B T))
C(T) = k_B (Δ/(k_B T))^2 sech^2(Δ/(k_B T))

(b) If Δ is uniform on [0, Δ0] and k_B T << Δ0:
⟨C(T)⟩ = (1/Δ0)∫_0^{Δ0} C(Δ,T)dΔ ≈ (π^2/12)(k_B^2/Δ0) T  (linear in T)</pre>
            </div>
          </div>
        </div>
      </article>

      <article id="part4">
        <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

        <h3>Re-interpret the final formula</h3>
        <p>
          For a single TLS, the dimensionless parameter x = Δ/(k<sub>B</sub>T) controls everything:
        </p>
        <ul class="bullets">
          <li><strong>U = −Δ tanh x:</strong> tanh x measures population imbalance. Large x (cold) ⇒ imbalance ≈ 1 ⇒ energy locked at −Δ.</li>
          <li><strong>C = k<sub>B</sub> x² sech² x:</strong> sech² x is sharply peaked near x ≈ O(1), meaning <em>only when k<sub>B</sub>T is comparable to Δ</em> does the system store heat effectively.</li>
        </ul>

        <h3>Parameter dependence (qualitative)</h3>
        <ul class="bullets">
          <li><strong>Increasing Δ (fixed T):</strong> increases x ⇒ drives system deeper into low-T regime ⇒ smaller C (exponentially small).</li>
          <li><strong>Increasing T (fixed Δ):</strong> decreases x ⇒ C rises from ~0, peaks, then falls as x² at high T.</li>
          <li><strong>Ensemble effect:</strong> if P(Δ) has a finite density near Δ=0, then the number of splittings with Δ ≲ k<sub>B</sub>T grows ∝ T, giving ⟨C⟩ ∝ T at low T.</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Use the fluctuation formula in the canonical ensemble:
          <span class="tag">C = Var(E)/(k<sub>B</sub>T²)</span>.
          For E ∈ {±Δ}, one finds ⟨E⟩ = −Δ tanh(βΔ), and also ⟨E²⟩ = Δ², so
          Var(E) = Δ² − ⟨E⟩² = Δ²(1 − tanh²(βΔ)) = Δ² sech²(βΔ).
          Then C = Δ² sech²(βΔ)/(k<sub>B</sub>T²) = k<sub>B</sub>(Δ/k<sub>B</sub>T)² sech²(Δ/k<sub>B</sub>T).
          This route emphasizes that C is proportional to energy fluctuations.
        </p>

        <div class="callouts">
          <div class="card mathinsight">
            <h4><span class="icon"></span>Math Insight (again, but applied)</h4>
            <p class="muted" style="margin-top:6px">
              In finite-state models, ln Z(β) is smooth and strictly convex in β because ∂² ln Z/∂β² = Var(E) ≥ 0.
              Convexity guarantees C ≥ 0 and encodes thermodynamic stability.
              The ensemble averaging in part (b) is essentially an integral transform of the kernel x² sech²x, whose
              low-T scaling is revealed by nondimensionalization (a classic asymptotic method).
            </p>
          </div>
        </div>

        <h3>Concept check (self-test)</h3>
        <ul class="bullets">
          <li><strong>Q:</strong> Why does a single TLS have C → 0 as T → 0?<br><strong>A:</strong> The system is frozen in the ground state; changing T slightly barely changes populations.</li>
          <li><strong>Q:</strong> Why does a single TLS have C → 0 as T → ∞?<br><strong>A:</strong> Populations become ~1/2 and energy saturates (U → 0), so adding more heat doesn’t increase U much.</li>
          <li><strong>Q:</strong> What determines the temperature where C is largest?<br><strong>A:</strong> Roughly when k<sub>B</sub>T is comparable to Δ (so x = Δ/(k<sub>B</sub>T) is O(1)).</li>
          <li><strong>Q:</strong> Why does a uniform distribution of Δ produce linear ⟨C⟩ at low T?<br><strong>A:</strong> Only TLS with Δ ≲ k<sub>B</sub>T contribute; with constant density near Δ=0, the number of contributors grows ∝ T.</li>
          <li><strong>Q:</strong> If P(Δ) ~ Δ^α near 0, what low-T scaling would you expect?<br><strong>A:</strong> Heuristically, the number of active TLS scales like (k<sub>B</sub>T)^{α+1}, so ⟨C⟩ often scales like T^{α+1} times k<sub>B</sub> (up to dimensionful factors).</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

      <article id="part5">
        <h2>PART 5 — Optional Plot Guide (ONLY IF A PLOT EXISTS)</h2>

        <h3>What the plot shows and why it’s useful</h3>
        <ul class="bullets">
          <li><strong>Single TLS:</strong> c(t) = C/k<sub>B</sub> for Δ fixed (example Δ = 0.5Δ<sub>0</sub>) shows a <em>Schottky peak</em>.</li>
          <li><strong>Uniform-Δ ensemble:</strong> c̄(t) = ⟨C⟩/k<sub>B</sub> is approximately a straight line at small t: c̄(t) ≈ (π²/12) t.</li>
          <li><strong>Why helpful:</strong> it visually contrasts <em>exponentially small</em> low-T behavior for a fixed gap with the <em>linear</em> low-T behavior that emerges from a distribution of gaps.</li>
        </ul>

        <h3>Axes and units</h3>
        <ul class="bullets">
          <li><strong>x-axis:</strong> t = k<sub>B</sub>T / Δ<sub>0</sub> (dimensionless).</li>
          <li><strong>y-axis:</strong> c = C / k<sub>B</sub> (dimensionless).</li>
        </ul>

        <h3>Example values (clearly separated from symbolic answer)</h3>
        <ul class="bullets">
          <li>Single TLS curve uses <strong>Δ = 0.5Δ<sub>0</sub></strong> purely as an example to show the Schottky peak.</li>
          <li>The ensemble line uses the asymptotic coefficient <strong>π²/12</strong> from the integral.</li>
        </ul>

        <h3>Features to notice</h3>
        <ul class="bullets">
          <li><strong>Low t:</strong> ensemble curve is linear; single TLS curve is extremely small (gap suppresses excitations).</li>
          <li><strong>Intermediate t:</strong> single TLS exhibits a peak (maximal population switching).</li>
          <li><strong>Higher t:</strong> both trends eventually decrease/flatten because energy saturates (single TLS) or the low-T approximation ceases to hold (ensemble).</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>
    </main>
  </div>

  <footer>
    <div class="hr"></div>
    <p>
      <strong>Note:</strong> All results are per two-level system unless multiplied by the number of TLS (or molar density).
      For a macroscopic sample with N independent TLS, the total heat capacity is C<sub>tot</sub> = N ⟨C⟩.
    </p>
  </footer>

  <div class="toast" id="toast" role="status" aria-live="polite">Copied.</div>

  <script>
    (function(){
      const toast = document.getElementById('toast');
      let toastTimer = null;

      function showToast(msg){
        toast.textContent = msg;
        toast.classList.add('show');
        clearTimeout(toastTimer);
        toastTimer = setTimeout(()=>toast.classList.remove('show'), 1200);
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          showToast("Copied to clipboard.");
        }catch(e){
          // fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          document.execCommand('copy');
          document.body.removeChild(ta);
          showToast("Copied (fallback).");
        }
      }

      document.querySelectorAll('button.copy').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const box = btn.closest('.eq');
          if(!box) return;
          const plain = box.getAttribute('data-plain') || box.textContent;
          const mode = btn.getAttribute('data-copy') || 'eq';
          const label = (mode === 'final') ? "Final answer copied." : "Equation copied.";
          copyText(plain.trim()).then(()=>showToast(label));
        });
      });

      // ---------- Plot ----------
      const canvas = document.getElementById('plot');
      const ctx = canvas.getContext('2d', { alpha: false });

      function sech(x){
        const ex = Math.exp(x);
        const em = 1/ex;
        const c = 0.5*(ex + em);
        return 1/c;
      }

      // Dimensionless heat capacity:
      // single TLS: c = C/kB = (Δ/(kB T))^2 sech^2(Δ/(kB T)) = (a/t)^2 sech^2(a/t) where a = Δ/Δ0, t = kBT/Δ0
      function c_single(t, a){
        if(t <= 0) return 0;
        const x = a / t;
        const s = sech(x);
        return (x*x) * (s*s);
      }
      // uniform ensemble low-T asymptote: c_bar = ⟨C⟩/kB ≈ (π^2/12) t
      function c_ensemble_asym(t){
        return (Math.PI*Math.PI/12) * t;
      }

      function resize(){
        const dpr = Math.max(1, Math.min(2.5, window.devicePixelRatio || 1));
        const rect = canvas.getBoundingClientRect();
        canvas.width = Math.floor(rect.width * dpr);
        canvas.height = Math.floor(rect.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0); // draw in CSS pixels
        draw();
      }

      function draw(){
        const W = canvas.getBoundingClientRect().width;
        const H = canvas.getBoundingClientRect().height;

        // Background
        ctx.clearRect(0,0,W,H);
        ctx.fillStyle = '#0b0f14';
        ctx.fillRect(0,0,W,H);

        const pad = {l:56, r:16, t:34, b:44};
        const x0 = pad.l, y0 = H - pad.b;
        const x1 = W - pad.r, y1 = pad.t;

        // Axes ranges (dimensionless)
        const xmin = 0.0, xmax = 0.6;
        const ymin = 0.0, ymax = 0.55;

        const X = (x)=> x0 + (x - xmin) * (x1 - x0) / (xmax - xmin);
        const Y = (y)=> y0 - (y - ymin) * (y0 - y1) / (ymax - ymin);

        // Gridlines
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        ctx.lineWidth = 1;

        function gridX(step){
          for(let x = xmin; x <= xmax + 1e-9; x += step){
            const px = X(x);
            ctx.beginPath();
            ctx.moveTo(px, y1);
            ctx.lineTo(px, y0);
            ctx.stroke();
          }
        }
        function gridY(step){
          for(let y = ymin; y <= ymax + 1e-9; y += step){
            const py = Y(y);
            ctx.beginPath();
            ctx.moveTo(x0, py);
            ctx.lineTo(x1, py);
            ctx.stroke();
          }
        }
        gridX(0.1);
        gridY(0.1);

        // Axes
        ctx.strokeStyle = 'rgba(255,255,255,0.55)';
        ctx.lineWidth = 1.25;
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x1, y0);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x0, y0);
        ctx.lineTo(x0, y1);
        ctx.stroke();

        // Ticks + labels
        ctx.fillStyle = 'rgba(232,238,246,0.92)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        for(let x = xmin; x <= xmax + 1e-9; x += 0.1){
          const px = X(x);
          ctx.beginPath();
          ctx.moveTo(px, y0);
          ctx.lineTo(px, y0 + 6);
          ctx.stroke();
          ctx.fillText(x.toFixed(1), px, y0 + 8);
        }
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        for(let y = ymin; y <= ymax + 1e-9; y += 0.1){
          const py = Y(y);
          ctx.beginPath();
          ctx.moveTo(x0 - 6, py);
          ctx.lineTo(x0, py);
          ctx.stroke();
          ctx.fillText(y.toFixed(1), x0 - 10, py);
        }

        // Titles
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.font = '600 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('Heat Capacity: single TLS vs uniform-Δ ensemble (dimensionless)', x0, 10);

        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = 'rgba(232,238,246,0.85)';
        ctx.textAlign = 'center';
        ctx.fillText('t = kB T / Δ0 (dimensionless)', (x0 + x1)/2, H - 22);

        // y-axis label (rotated)
        ctx.save();
        ctx.translate(18, (y0 + y1)/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.fillText('c = C / kB (dimensionless)', 0, 0);
        ctx.restore();

        // Curves
        function plotCurve(fn, strokeStyle){
          ctx.strokeStyle = strokeStyle;
          ctx.lineWidth = 2;
          ctx.beginPath();
          const N = 400;
          for(let i=0;i<=N;i++){
            const x = xmin + (xmax - xmin)*i/N;
            const y = fn(x);
            const px = X(x);
            const py = Y(Math.max(ymin, Math.min(ymax, y)));
            if(i===0) ctx.moveTo(px, py);
            else ctx.lineTo(px, py);
          }
          ctx.stroke();
        }

        // Choose colors but do not "set specific colors" in a style sense? The instruction forbids specifying colors for charts in python_user_visible,
        // but we're using canvas. Still, keep it minimal and consistent.
        plotCurve((t)=>c_ensemble_asym(t), 'rgba(125,211,252,0.95)'); // ensemble line
        plotCurve((t)=>c_single(t, 0.5), 'rgba(167,139,250,0.95)');   // single TLS example

        // Legend
        const lx = x1 - 260, ly = y1 + 8;
        ctx.fillStyle = 'rgba(15,22,32,0.75)';
        ctx.strokeStyle = 'rgba(255,255,255,0.12)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.roundRect(lx, ly, 248, 52, 12);
        ctx.fill();
        ctx.stroke();

        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = 'rgba(232,238,246,0.92)';
        // line samples
        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(lx+12, ly+18);
        ctx.lineTo(lx+42, ly+18);
        ctx.stroke();
        ctx.fillText('Uniform Δ ensemble (low-T asymptote)', lx+52, ly+12);

        ctx.strokeStyle = 'rgba(167,139,250,0.95)';
        ctx.beginPath();
        ctx.moveTo(lx+12, ly+38);
        ctx.lineTo(lx+42, ly+38);
        ctx.stroke();
        ctx.fillStyle = 'rgba(232,238,246,0.92)';
        ctx.fillText('Single TLS (example Δ = 0.5 Δ0)', lx+52, ly+32);
      }

      // roundRect polyfill for older browsers
      if(!CanvasRenderingContext2D.prototype.roundRect){
        CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
          const rr = Math.min(r, w/2, h/2);
          this.beginPath();
          this.moveTo(x+rr,y);
          this.arcTo(x+w,y,x+w,y+h,rr);
          this.arcTo(x+w,y+h,x,y+h,rr);
          this.arcTo(x,y+h,x,y,rr);
          this.arcTo(x,y,x+w,y,rr);
          this.closePath();
          return this;
        };
      }

      window.addEventListener('resize', resize, {passive:true});
      resize();
    })();
  </script>
</body>
</html>
