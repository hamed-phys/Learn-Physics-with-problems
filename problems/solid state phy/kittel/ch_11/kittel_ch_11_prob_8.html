<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Paramagnetism of an S = 1 Spin System: Magnetization vs Field and Temperature</title>
  <style>
    :root{
      --bg: #0b1220;
      --panel:#0f1a2e;
      --panel2:#111f38;
      --text:#e9eefc;
      --muted:#b9c4e6;
      --faint:#92a0cc;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line: rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{ box-sizing:border-box; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1100px 700px at 20% -10%, rgba(125,211,252,.18), transparent 55%),
        radial-gradient(900px 650px at 110% 10%, rgba(167,139,250,.16), transparent 55%),
        radial-gradient(1200px 900px at 40% 120%, rgba(52,211,153,.10), transparent 60%),
        var(--bg);
      line-height: 1.55;
    }

    header{
      position:relative;
      padding: 28px 18px 10px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 0 14px 44px;
    }
    .title{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 16px;
      align-items: end;
    }
    h1{
      margin:0;
      font-size: clamp(1.55rem, 2.6vw, 2.35rem);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:.35rem 0 0;
      color: var(--muted);
      max-width: 70ch;
      font-size: 1.02rem;
    }
    .meta{
      justify-self:end;
      text-align:right;
      color: var(--faint);
      font-size: .92rem;
    }
    .pillrow{
      display:flex;
      flex-wrap:wrap;
      gap: 8px;
      margin-top: 14px;
    }
    .pill{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      padding: 7px 10px;
      border-radius: 999px;
      font-size:.9rem;
      color: var(--muted);
    }
    .pill b{ color: var(--text); font-weight:650; }

    main{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
      margin-top: 18px;
    }

    nav.toc{
      position: sticky;
      top: 12px;
      border: 1px solid var(--line);
      background: rgba(15,26,46,.78);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 10px;
      overflow:hidden;
    }
    .toc h2{
      margin: 0 0 10px;
      font-size: 1.02rem;
      letter-spacing:.3px;
    }
    .toc a{
      display:block;
      padding: 8px 10px;
      border-radius: 12px;
      color: var(--muted);
      text-decoration:none;
      border: 1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size:.95rem;
    }
    .toc a:hover{
      background: rgba(255,255,255,.04);
      border-color: rgba(125,211,252,.25);
      transform: translateX(2px);
      color: var(--text);
    }
    .toc .mini{
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed var(--line);
      color: var(--faint);
      font-size:.9rem;
    }
    .toc .mini a{ font-size:.92rem; }

    article{
      min-width: 0;
    }

    section{
      border: 1px solid var(--line);
      background: rgba(15,26,46,.62);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 18px 16px;
      margin-bottom: 16px;
      overflow:hidden;
    }
    section h2{
      margin: 0 0 10px;
      font-size: 1.35rem;
      letter-spacing: .2px;
    }
    section h3{
      margin: 14px 0 8px;
      font-size: 1.12rem;
      color: var(--text);
    }
    p{ margin: 8px 0; color: var(--muted); }
    ul, ol{ margin: 8px 0 8px 22px; color: var(--muted); }
    li{ margin: 6px 0; }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 980px){
      main{ grid-template-columns: 1fr; }
      nav.toc{ position: relative; top:auto; }
      .title{ grid-template-columns: 1fr; }
      .meta{ justify-self:start; text-align:left; }
      .grid2{ grid-template-columns: 1fr; }
    }

    .callouts{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 10px;
    }
    @media (max-width: 820px){
      .callouts{ grid-template-columns: 1fr; }
    }

    .card{
      border: 1px solid var(--line);
      border-radius: 16px;
      background: rgba(17,31,56,.55);
      padding: 12px 12px 10px;
    }
    .card h4{
      margin:0 0 6px;
      font-size: 1.02rem;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap: 8px;
    }
    .dot{
      width: 10px; height:10px; border-radius:50%;
      background: var(--accent);
      box-shadow: 0 0 0 4px rgba(125,211,252,.12);
      flex:0 0 auto;
    }
    .dot.purple{
      background: var(--accent2);
      box-shadow: 0 0 0 4px rgba(167,139,250,.12);
    }
    .dot.green{
      background: var(--good);
      box-shadow: 0 0 0 4px rgba(52,211,153,.12);
    }
    .dot.warn{
      background: var(--warn);
      box-shadow: 0 0 0 4px rgba(251,191,36,.12);
    }
    .dot.bad{
      background: var(--bad);
      box-shadow: 0 0 0 4px rgba(251,113,133,.12);
    }

    .eqbox{
      margin-top: 10px;
      border: 1px solid rgba(125,211,252,.25);
      background: rgba(125,211,252,.06);
      border-radius: 16px;
      padding: 12px;
      position: relative;
      overflow:hidden;
    }
    .eqbox .label{
      font-size:.88rem;
      color: var(--text);
      font-weight: 700;
      letter-spacing:.25px;
      margin-bottom: 8px;
      display:flex;
      align-items:center;
      gap: 8px;
    }
    .eqbox pre{
      margin:0;
      padding: 10px 10px;
      background: rgba(0,0,0,.22);
      border: 1px solid var(--line);
      border-radius: 14px;
      color: #eaf2ff;
      font-family: var(--mono);
      font-size: .95rem;
      overflow:auto;
      line-height: 1.45;
      white-space: pre-wrap;
    }

    .btnrow{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      margin-top: 10px;
    }
    button.copy{
      appearance:none;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.05);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
      font-weight: 650;
      font-size: .93rem;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      border-color: rgba(125,211,252,.38);
      background: rgba(125,211,252,.08);
    }
    button.copy:active{ transform: translateY(0); }

    details{
      border: 1px dashed var(--line);
      border-radius: 16px;
      padding: 10px 12px;
      background: rgba(255,255,255,.03);
      margin-top: 10px;
    }
    details summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 700;
      letter-spacing:.2px;
    }
    details p, details ul{ color: var(--muted); }

    .math-insight{
      border: 1px solid rgba(167,139,250,.30);
      background: rgba(167,139,250,.08);
      border-radius: 16px;
      padding: 12px;
      margin-top: 12px;
    }
    .math-insight strong{ color: var(--text); }

    figure{
      margin: 12px 0 0;
      border: 1px solid var(--line);
      border-radius: 16px;
      background: rgba(17,31,56,.45);
      overflow:hidden;
    }
    figcaption{
      padding: 10px 12px;
      border-top: 1px solid var(--line);
      color: var(--faint);
      font-size: .92rem;
    }
    canvas{
      width: 100%;
      height: 320px;
      display:block;
      background: rgba(0,0,0,.14);
    }

    .backtop{
      display:inline-block;
      margin-top: 8px;
      color: var(--accent);
      text-decoration:none;
      font-weight:650;
    }
    .backtop:hover{ text-decoration: underline; }

    footer{
      color: var(--faint);
      padding: 18px 0 40px;
      border-top: 1px solid var(--line);
      margin-top: 14px;
      font-size: .92rem;
    }

    /* Print-friendly */
    @media print{
      body{ background: #fff; color:#000; }
      header, nav.toc, .pillrow, .btnrow, .backtop{ display:none !important; }
      main{ display:block; }
      section{ box-shadow:none; background:#fff; border:1px solid #ddd; }
      .eqbox{ background:#f7fbff; border-color:#9cc8ff; }
      .math-insight{ background:#faf7ff; border-color:#c7b3ff; }
      a{ color:#000; text-decoration:none; }
      section{ break-inside: avoid; page-break-inside: avoid; }
      h2{ page-break-after: avoid; }
    }
  </style>
</head>

<body>
<header id="top">
  <div class="wrap">
    <div class="title">
      <div>
        <h1>Paramagnetism of an S = 1 Spin System</h1>
        <p class="subtitle">
          Derive the magnetization <span style="white-space:nowrap;">M(B,T)</span> for non-interacting spins with
          spin quantum number <b>S=1</b>, magnetic moment magnitude <b>μ</b>, and concentration <b>n</b>, then show the
          low-field Curie-law limit.
        </p>
        <div class="pillrow" aria-label="topic tags">
          <span class="pill"><b>Domain</b>: statistical mechanics</span>
          <span class="pill"><b>Model</b>: independent spins</span>
          <span class="pill"><b>Key tool</b>: partition function</span>
          <span class="pill"><b>Output</b>: symbolic + asymptotic</span>
        </div>
      </div>
      <div class="meta">
        <div><b>Focus:</b> physics tutoring + applied/industrial lens</div>
        <div><b>Core result:</b> Brillouin function (J=1)</div>
      </div>
    </div>
  </div>
</header>

<div class="wrap">
  <main>
    <nav class="toc" aria-label="Table of contents">
      <h2>Table of Contents</h2>
      <a href="#quick">Quick Summary</a>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry & Applied Physics</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy & Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Optional Plot Guide</a>
      <div class="mini">
        <div><b>Copy tools:</b></div>
        <a href="#keyeq">Key equations</a>
        <a href="#finalans">Final answer</a>
      </div>
    </nav>

    <article>

      <section id="quick">
        <h2>Quick Summary</h2>
        <ul>
          <li><b>What:</b> Magnetization of a paramagnet made of non-interacting <b>S=1</b> spins in a uniform magnetic field <b>B</b>.</li>
          <li><b>Key physics idea:</b> Spins occupy Zeeman-split energy levels; thermal populations (Boltzmann weights) set the average magnetic moment.</li>
          <li><b>Governing object:</b> Single-spin partition function <span style="white-space:nowrap;">Z₁(B,T)</span> and free energy <span style="white-space:nowrap;">F = -kT ln Z</span>.</li>
          <li><b>Key equation:</b> Magnetization is the field derivative of free energy:
            <span style="white-space:nowrap;">M = -∂F/∂B = n kT ∂(ln Z₁)/∂B</span>.
          </li>
          <li><b>Exact result (symbolic):</b> <span style="white-space:nowrap;">M(B,T) = n μ · [2 sinh(μB/kT)] / [1 + 2 cosh(μB/kT)]</span>.</li>
          <li><b>Low-field limit:</b> For <span style="white-space:nowrap;">μB ≪ kT</span>, magnetization is linear in <b>B</b> (Curie law):
            <span style="white-space:nowrap;">M ≈ (2 n μ² / 3kT) B</span>.
          </li>
          <li><b>Physical meaning:</b> Increasing <b>B</b> aligns spins; increasing <b>T</b> randomizes them, reducing alignment.</li>
          <li><b>Engineering hook:</b> The linear slope <span style="white-space:nowrap;">χ = ∂M/∂B</span> is the (paramagnetic) susceptibility used in sensing, materials characterization, and temperature-dependent calibration.</li>
        </ul>
        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="card">
            <h4><span class="dot"></span>Core definitions (symbols + SI units)</h4>
            <ul>
              <li><b>B</b>: magnetic flux density (tesla, T).</li>
              <li><b>μ</b>: magnetic moment magnitude of one spin (A·m² = J/T).</li>
              <li><b>S</b>: spin quantum number; here <b>S=1</b> so <b>m ∈ {−1,0,+1}</b>.</li>
              <li><b>n</b>: concentration (number density) of spins (m⁻³).</li>
              <li><b>T</b>: absolute temperature (K).</li>
              <li><b>k</b>: Boltzmann constant (J/K).</li>
              <li><b>β</b>: inverse temperature, <b>β = 1/(kT)</b> (J⁻¹).</li>
              <li><b>M</b>: magnetization (magnetic moment per volume) (A/m). In this problem: <b>M = n⟨μ_z⟩</b>.</li>
            </ul>
          </div>

          <div class="card">
            <h4><span class="dot purple"></span>Physical meaning (intuition)</h4>
            <ul>
              <li>A magnetic field defines a preferred axis (take it as <b>z</b>).</li>
              <li>Each spin can align in discrete projections <b>m</b> along the field.</li>
              <li>The field shifts energies via the <b>Zeeman interaction</b>: lower energy for alignment with the field.</li>
              <li>Thermal agitation competes with alignment; <b>μB/kT</b> is the key dimensionless competition parameter.</li>
            </ul>
          </div>
        </div>

        <h3>Key laws/principles and validity conditions</h3>
        <ul>
          <li><b>Boltzmann distribution:</b> In thermal equilibrium, probability of a microstate with energy <b>E</b> is <b>p ∝ e^{−βE}</b>.</li>
          <li><b>Canonical ensemble:</b> Valid when the spin system exchanges heat with a bath at fixed <b>T</b>.</li>
          <li><b>Non-interacting spins:</b> Assumes spin-spin interactions are negligible (dilute paramagnet, weak exchange).</li>
          <li><b>Uniform field:</b> <b>B</b> is spatially constant; magnetization is uniform.</li>
        </ul>

        <h3>Common models/approximations used and why</h3>
        <ul>
          <li><b>Zeeman-only Hamiltonian:</b> Keep only <b>H = −μ·B</b> → simplest paramagnet model.</li>
          <li><b>Low-field (Curie) expansion:</b> If <b>μB ≪ kT</b>, expand hyperbolic functions to get linear response.</li>
          <li><b>High-field saturation:</b> If <b>μB ≫ kT</b>, almost all spins occupy the lowest energy aligned state → <b>M → nμ</b>.</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li><b>At B = 0:</b> the three m-levels are degenerate; populations equal → average projection is zero → <b>M=0</b>.</li>
          <li><b>At T → ∞:</b> thermal energy dominates; populations nearly equal even if B ≠ 0 → <b>M → 0</b>.</li>
          <li><b>At T → 0 with B&gt;0:</b> system falls into lowest Zeeman energy (m=+1) → <b>M → nμ</b> (full alignment).</li>
        </ul>

        <div class="callouts">
          <div class="card">
            <h4><span class="dot warn"></span>What to watch for (pitfalls)</h4>
            <ul>
              <li><b>Sign conventions:</b> Ensure the Zeeman energy decreases for alignment with the field.</li>
              <li><b>μ vs gμ<sub>B</sub>:</b> Here μ is given; do not reintroduce g-factors unless specified.</li>
              <li><b>n vs N:</b> Magnetization uses <b>number density n</b>; total moment would use <b>N</b>.</li>
              <li><b>Linear response:</b> The Curie law is only valid when <b>μB/kT ≪ 1</b>.</li>
            </ul>
          </div>

          <div class="math-insight">
            <strong>Math Insight (core equation as a mathematical object):</strong>
            <p>
              The partition function <b>Z₁(B,T)</b> is a <em>moment-generating function</em> for the discrete random variable
              <b>m</b>. Differentiating <b>ln Z₁</b> with respect to the “field-like” parameter <b>B</b> produces the mean:
              <span style="white-space:nowrap;">⟨m⟩ = (1/βμ) ∂(ln Z₁)/∂B</span>.
              This is a standard <em>log-derivative identity</em> in probability/stat mech.
            </p>
          </div>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>
        <p>
          Paramagnetism is not just a textbook curiosity—it is a practical <b>thermo-magnetic transfer function</b> linking
          field, temperature, and material response. Industrial engineers and applied physicists often care about it because
          magnetization affects sensing, calibration, and materials selection.
        </p>

        <h3>Where this appears in industry (concrete application areas)</h3>
        <ul>
          <li><b>Magnetic sensing & instrumentation:</b> susceptibility-based sensors (e.g., magnetic balance methods, SQUID/VCM characterization) rely on predictable <span style="white-space:nowrap;">M(B,T)</span>.</li>
          <li><b>Materials QA/QC:</b> paramagnetic impurity concentration estimation (e.g., transition-metal ions) from magnetization curves.</li>
          <li><b>Cryogenics & superconducting systems:</b> “background” paramagnetism of components influences field maps and stability near strong magnets.</li>
          <li><b>MRI/medical devices (materials side):</b> understanding weak magnetic responses reduces artifacts and helps select low-susceptibility components.</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><b>Performance:</b> susceptibility determines signal strength in sensors and affects electromagnetic compatibility.</li>
          <li><b>Reliability:</b> temperature dependence (<span style="white-space:nowrap;">∝ 1/T</span> in low field) can cause drift; needs compensation.</li>
          <li><b>Cost/Manufacturability:</b> impurities and heat treatments can change effective μ and n, shifting magnetic response.</li>
        </ul>

        <h3>Typical measurement/validation methods</h3>
        <ul>
          <li><b>VSM (Vibrating Sample Magnetometer):</b> measures M vs B quickly across temperatures.</li>
          <li><b>SQUID magnetometry:</b> ultra-sensitive M measurements, often used at low T.</li>
          <li><b>Magneto-thermal calibration:</b> fit measured M(B,T) to model to extract μ, n (or effective g-factor).</li>
        </ul>

        <h3>Design trade-offs and constraints (non-idealities)</h3>
        <ul>
          <li><b>Interactions:</b> real materials may have exchange coupling → deviations from simple Curie law.</li>
          <li><b>Anisotropy/crystal fields:</b> split levels beyond Zeeman → changes Z₁ and M.</li>
          <li><b>Inhomogeneous fields:</b> spatial gradients produce non-uniform magnetization and forces.</li>
          <li><b>Finite relaxation times:</b> at AC fields, response can lag; the equilibrium formula applies only if the system equilibrates.</li>
        </ul>

        <details>
          <summary>From lab to product: adapting the ideal model</summary>
          <p>
            In real devices, engineers often replace μ and n by <b>effective parameters</b> (μ<sub>eff</sub>, n<sub>eff</sub>) extracted from calibration,
            and add correction terms for background diamagnetism, demagnetizing fields (geometry-dependent), and temperature gradients.
            The equilibrium model here provides the <b>baseline constitutive relation</b> that those corrections build upon.
          </p>
        </details>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <h3>Restate the problem</h3>
        <p>
          We have a system of non-interacting spins with <b>S=1</b>, each carrying magnetic moment magnitude <b>μ</b>, in a uniform magnetic field <b>B</b>
          at temperature <b>T</b>. The spin concentration is <b>n</b> (number per volume). We must:
        </p>
        <ol>
          <li>Find the magnetization <b>M(B,T)</b> as a function of field and temperature.</li>
          <li>Show that in the low-field limit <b>μB ≪ kT</b>, the magnetization reduces to
            <span style="white-space:nowrap;">M ≈ (2 n μ² / 3kT) B</span>.
          </li>
        </ol>

        <div class="callouts">
          <div class="card">
            <h4><span class="dot green"></span>Given</h4>
            <ul>
              <li>S = 1</li>
              <li>magnetic moment magnitude μ (per spin)</li>
              <li>concentration n (spins per volume)</li>
              <li>field B, temperature T</li>
            </ul>
          </div>
          <div class="card">
            <h4><span class="dot purple"></span>Unknowns / targets</h4>
            <ul>
              <li>Magnetization M(B,T)</li>
              <li>Low-field asymptotic expansion for μB/kT ≪ 1</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles and why they apply</h3>
        <ul>
          <li><b>Zeeman splitting:</b> a magnetic moment in a magnetic field has energy <b>E = −μ·B</b>. With quantized projection, energies are discrete.</li>
          <li><b>Canonical ensemble:</b> equilibrium at temperature T implies Boltzmann weights for each level.</li>
          <li><b>Magnetization from free energy:</b> in equilibrium, <span style="white-space:nowrap;">M = −∂F/∂B</span>, where <span style="white-space:nowrap;">F = −kT ln Z</span>.</li>
        </ul>

        <div class="eqbox">
          <div class="label" id="keyeq"><span class="dot"></span>Mathematical model (variables, domain, conditions)</div>
          <pre id="eq-key-text">System: dilute, non-interacting S=1 spins in uniform magnetic field B (take B along +z).
State space per spin: m ∈ {−1, 0, +1} (eigenvalues of S_z/ħ).
Energy levels (Zeeman): E_m(B) = − m μ B.
Thermal equilibrium at temperature T: p_m = exp(−β E_m)/Z1, with β = 1/(kT).
Single-spin partition function: Z1(B,T) = Σ_m exp(−β E_m).
Magnetization (per volume): M(B,T) = n ⟨μ_z⟩ = n Σ_m (m μ) p_m.
No spatial dependence: ∇M = 0, ∇B = 0 (uniform field, uniform magnetization).
Boundary/initial conditions: not needed (equilibrium algebraic statistical model).</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-key-text">Copy key equations (plain text)</button>
          </div>
        </div>

        <h3>Assumptions (explicit)</h3>
        <div class="card">
          <h4><span class="dot warn"></span>Assumptions box</h4>
          <ul>
            <li>Spins are <b>independent</b> (no exchange coupling, no dipole-dipole interactions).</li>
            <li>Field is <b>uniform and static</b>; we are computing <b>equilibrium</b> magnetization (not dynamic response).</li>
            <li>Magnetic moment couples only through the Zeeman term; no crystal-field splitting or anisotropy included.</li>
            <li>Magnetization defined along the field direction (z-axis).</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <ol>
          <li><b>Partition function → ⟨m⟩ directly (best here):</b> short, systematic, generalizes to any S; yields exact closed form.</li>
          <li><b>Free energy derivative:</b> compute Z, then <span style="white-space:nowrap;">M = n kT ∂(ln Z₁)/∂B</span>; elegant and connects to thermodynamics.</li>
          <li><b>Brillouin function lookup:</b> quick if you recognize S=1 case, but less educational and risks sign/parameter mistakes.</li>
        </ol>
        <p><b>Chosen approach:</b> use the partition function plus the log-derivative identity (most transparent and mathematically controlled).</p>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

        <ol>
          <li><b>Set the axis:</b> choose B along +z so only μ<sub>z</sub> matters. (Symmetry: rotational symmetry around B)</li>
          <li><b>List spin projections:</b> for S=1, allowed m are −1, 0, +1. (Quantum eigenvalues of S<sub>z</sub>)</li>
          <li><b>Write energies:</b> Zeeman energies E<sub>m</sub> = −m μ B. (Hamiltonian term −μ·B)</li>
          <li><b>Build Z₁:</b> sum Boltzmann factors exp(−βE<sub>m</sub>) over m. (Canonical ensemble definition)</li>
          <li><b>Compute ⟨m⟩:</b> weighted average of m using probabilities p<sub>m</sub>. (Expectation value)</li>
          <li><b>Convert to M:</b> ⟨μ<sub>z</sub>⟩ = μ⟨m⟩, then M = n⟨μ<sub>z</sub>⟩. (From microscopic to macroscopic)</li>
          <li><b>Nondimensionalize:</b> introduce x = μB/kT. (Scaling clarifies regimes)</li>
          <li><b>Low-field limit:</b> expand sinh/cosh for small x and keep lowest order. (Asymptotic expansion)</li>
          <li><b>Sanity checks:</b> B→0 gives M→0, large B gives saturation M→nμ, units consistent.</li>
        </ol>

        <div class="callouts">
          <div class="card">
            <h4><span class="dot bad"></span>Common mistakes</h4>
            <ul>
              <li>Forgetting the <b>m=0</b> state (important for S=1).</li>
              <li>Mixing up <b>μB</b> with <b>μ·B</b>; here alignment gives energy <b>−m μ B</b>.</li>
              <li>Using <b>sin/cos</b> instead of <b>sinh/cosh</b> (Boltzmann sums produce hyperbolic functions).</li>
              <li>Dropping factors of <b>n</b> when converting per-spin moment to magnetization.</li>
              <li>Applying low-field expansion outside its domain (<b>μB/kT</b> not small).</li>
            </ul>
          </div>
          <div class="card">
            <h4><span class="dot green"></span>Quick tip</h4>
            <p>
              Always introduce the dimensionless parameter <b>x = μB/(kT)</b>. It tells you immediately whether you’re in the
              linear-response regime (x≪1) or saturation regime (x≫1).
            </p>
          </div>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation before calculating</h3>
        <ul>
          <li><b>Odd in B:</b> reversing B should reverse M, so M(B,T) should be an odd function of B.</li>
          <li><b>Monotone in |B|:</b> increasing |B| increases alignment, so |M| increases, approaching saturation.</li>
          <li><b>Decreases with T:</b> higher temperature randomizes spins, reducing magnetization.</li>
        </ul>

        <h3>Step 1 — Choose coordinates and list states</h3>
        <p>
          Take the magnetic field uniform and along the +z axis: <b>B = B ẑ</b>.
          For a spin with <b>S=1</b>, the allowed eigenvalues of the z-projection are
          <b>m = −1, 0, +1</b>.
        </p>

        <h3>Step 2 — Zeeman energies</h3>
        <p>
          The Zeeman interaction energy of a magnetic moment in a field is
          <b>E = −μ·B</b>. With quantized projection along z, the z-component of the moment is
          <b>μ<sub>z</sub> = m μ</b> (μ is the given magnitude scale per step in m).
          Therefore the energy of level m is:
        </p>

        <div class="eqbox">
          <div class="label"><span class="dot"></span>Zeeman spectrum (S=1)</div>
          <pre id="eq-zeeman">E_m(B) = − μ_z B = − (m μ) B,  where m ∈ {−1, 0, +1}.</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-zeeman">Copy equation (plain text)</button>
          </div>
        </div>

        <p>
          <b>Why this step is valid:</b> the field picks out a direction (z), and in equilibrium for a uniform field we only need the discrete eigen-energies.
          The model is linear in B because the Zeeman Hamiltonian is linear in the field.
        </p>

        <h3>Step 3 — Single-spin partition function Z₁</h3>
        <p>
          In the canonical ensemble, the single-spin partition function is the sum over all spin states:
        </p>

        <div class="eqbox">
          <div class="label"><span class="dot purple"></span>Partition function</div>
          <pre id="eq-z1">Z1(B,T) = Σ_m exp(−β E_m) = Σ_{m=−1,0,+1} exp(−β (−m μ B))
        = Σ_{m=−1,0,+1} exp(β m μ B).</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-z1">Copy equation (plain text)</button>
          </div>
        </div>

        <p>
          Define the dimensionless parameter (nondimensionalization / scaling):
        </p>
        <div class="eqbox">
          <div class="label"><span class="dot green"></span>Dimensionless field–temperature ratio</div>
          <pre id="eq-x">x ≡ β μ B = μB/(kT).  (dimensionless)</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-x">Copy equation (plain text)</button>
          </div>
        </div>

        <p>
          Then the sum becomes:
        </p>
        <div class="eqbox">
          <div class="label"><span class="dot"></span>Evaluate Z₁ explicitly</div>
          <pre id="eq-z1eval">Z1 = e^{−x} + 1 + e^{+x} = 1 + 2 cosh(x).</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-z1eval">Copy equation (plain text)</button>
          </div>
        </div>

        <h3>Step 4 — Compute the thermal average ⟨m⟩</h3>
        <p>
          The probability of each m is <b>p_m = e^{β m μ B}/Z₁</b>. The expectation value is:
        </p>

        <div class="eqbox">
          <div class="label"><span class="dot purple"></span>Expectation value (showing steps)</div>
          <pre id="eq-mavg">⟨m⟩ = Σ_m m p_m
     = (1/Z1) Σ_{m=−1,0,+1} m e^{β m μ B}
     = (1/Z1) [ (−1)e^{−x} + 0·1 + (+1)e^{+x} ]
     = (e^{x} − e^{−x}) / Z1
     = (2 sinh x) / (1 + 2 cosh x).</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-mavg">Copy derivation (plain text)</button>
          </div>
        </div>

        <p>
          <b>Why this step is valid:</b> this is a linear expectation over a discrete state space; the canonical probabilities form a normalized measure because
          Z₁ is the normalizing constant.
        </p>

        <details>
          <summary>Equivalent thermodynamic identity (alternative within this step)</summary>
          <p>
            Since <span style="white-space:nowrap;">Z₁ = Σ_m e^{β m μ B}</span>, we have
            <span style="white-space:nowrap;">∂(ln Z₁)/∂B = (1/Z₁) ∂Z₁/∂B</span>.
            But <span style="white-space:nowrap;">∂Z₁/∂B = Σ_m (β m μ) e^{β m μ B}</span>, hence
            <span style="white-space:nowrap;">(1/βμ) ∂(ln Z₁)/∂B = (1/Z₁) Σ_m m e^{β m μ B} = ⟨m⟩</span>.
            This is the log-derivative identity mentioned earlier.
          </p>
        </details>

        <h3>Step 5 — Convert to magnetization M(B,T)</h3>
        <p>
          The average magnetic moment along the field for one spin is
          <b>⟨μ<sub>z</sub>⟩ = μ⟨m⟩</b>.
          Magnetization is magnetic moment per unit volume:
          <b>M = n⟨μ<sub>z</sub>⟩</b>.
        </p>

        <div class="eqbox" id="finalans">
          <div class="label"><span class="dot green"></span>Final exact result (S=1 paramagnet)</div>
          <pre id="eq-final">Let x = μB/(kT). Then

M(B,T) = n μ ⟨m⟩
       = n μ * [ 2 sinh(x) ] / [ 1 + 2 cosh(x) ].

Equivalently,
M(B,T) = n μ * ( e^{x} − e^{−x} ) / ( 1 + e^{x} + e^{−x} ).</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-final">Copy final answer (plain text)</button>
          </div>
        </div>

        <h3>Sanity checks</h3>
        <div class="grid2">
          <div class="card">
            <h4><span class="dot"></span>Units / dimensions</h4>
            <ul>
              <li>x = μB/(kT) is dimensionless because μB has units of energy (J) and kT is energy (J).</li>
              <li>⟨m⟩ is dimensionless, so M has units n·μ → (m⁻³)(A·m²) = A/m, correct.</li>
            </ul>
          </div>
          <div class="card">
            <h4><span class="dot green"></span>Limiting cases</h4>
            <ul>
              <li><b>B → 0:</b> x→0 → sinh x→0 → M→0.</li>
              <li><b>B → +∞:</b> x→∞ → ⟨m⟩→1 → M→nμ (saturation).</li>
              <li><b>B → −∞:</b> ⟨m⟩→−1 → M→−nμ.</li>
            </ul>
          </div>
        </div>

        <h3>Step 6 — Low-field limit μB ≪ kT (asymptotics)</h3>
        <p>
          The limit μB ≪ kT is exactly <b>x ≪ 1</b>. Use Taylor expansions:
        </p>
        <div class="eqbox">
          <div class="label"><span class="dot warn"></span>Small-x expansions (showing what is neglected)</div>
          <pre id="eq-exp">sinh x = x + x^3/6 + O(x^5)
cosh x = 1 + x^2/2 + O(x^4)

Denominator: 1 + 2 cosh x = 1 + 2(1 + x^2/2 + O(x^4))
                           = 3 + x^2 + O(x^4)

Numerator: 2 sinh x = 2(x + x^3/6 + O(x^5))
                    = 2x + (x^3)/3 + O(x^5)</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-exp">Copy expansions (plain text)</button>
          </div>
        </div>

        <p>
          Keep only the leading order in x (linear response). Since the denominator is <b>3 + O(x²)</b>, we have:
        </p>

        <div class="eqbox">
          <div class="label"><span class="dot green"></span>Leading-order reduction</div>
          <pre id="eq-low">⟨m⟩ = (2 sinh x)/(1 + 2 cosh x)
    ≈ (2x)/(3)  (dropping O(x^3) and higher).

Therefore:
M = n μ ⟨m⟩ ≈ n μ * (2/3) x
           = n μ * (2/3) * (μB/(kT))
           = (2 n μ^2 / (3 k T)) B.</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="eq-low">Copy low-field result (plain text)</button>
          </div>
        </div>

        <p>
          This matches the requested form. The coefficient of B is the (volume) susceptibility in the low-field regime:
          <span style="white-space:nowrap;"><b>χ = ∂M/∂B ≈ 2 n μ² / (3 k T)</b></span>.
        </p>

        <figure>
          <canvas id="plot" aria-label="Magnetization curve plot"></canvas>
          <figcaption>
            Static example plot (dimensionless form): m̄(x) = M/(nμ) vs x = μB/(kT) for S=1.
            Shows exact curve and low-field linear approximation.
          </figcaption>
        </figure>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpret the final formula</h3>
        <ul>
          <li>The magnetization is controlled by the single dimensionless ratio <b>x = μB/(kT)</b>.</li>
          <li><b>Numerator 2 sinh x</b> measures the imbalance between +m and −m populations.</li>
          <li><b>Denominator 1 + 2 cosh x</b> counts total weighted population across all three m-states; the <b>m=0</b> state makes S=1 different from S=1/2.</li>
        </ul>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li><b>Increase B:</b> x increases → M increases and saturates at <b>±nμ</b>.</li>
          <li><b>Increase T:</b> x decreases → M decreases; in low field <b>M ∝ 1/T</b>.</li>
          <li><b>Increase μ:</b> stronger coupling to B → larger magnetization and larger susceptibility.</li>
          <li><b>Increase n:</b> more spins per volume → M scales linearly with n.</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Start from the Helmholtz free energy density (per volume) of independent spins:
          <span style="white-space:nowrap;">f(B,T) = −n kT ln Z₁(B,T)</span>.
          Then use the thermodynamic constitutive relation
          <span style="white-space:nowrap;">M = −∂f/∂B</span>.
          This yields the same result because <span style="white-space:nowrap;">∂(ln Z₁)/∂B</span> generates ⟨m⟩.
        </p>

        <details>
          <summary>Concept check (self-test) with answers</summary>
          <ul>
            <li><b>Q:</b> Why is M an odd function of B? <b>A:</b> Because replacing B→−B swaps the energies of m=+1 and m=−1, flipping the population imbalance and thus ⟨m⟩→−⟨m⟩.</li>
            <li><b>Q:</b> What sets the crossover from linear to saturation? <b>A:</b> The dimensionless x = μB/(kT). Linear response holds for x≪1; saturation begins when x≫1.</li>
            <li><b>Q:</b> What role does the m=0 state play? <b>A:</b> It adds weight to the denominator (more “unpolarized” population), reducing ⟨m⟩ relative to a two-level (S=1/2) system at the same x.</li>
            <li><b>Q:</b> What is the maximum possible magnetization magnitude? <b>A:</b> |M| ≤ nμ because |⟨m⟩| ≤ 1 for S=1.</li>
          </ul>
        </details>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p>
          The plot is included because it visually reinforces two key ideas:
          (i) <b>linear response</b> at small x, and (ii) <b>saturation</b> at large x.
        </p>
        <ul>
          <li><b>x-axis:</b> x = μB/(kT) (dimensionless).</li>
          <li><b>y-axis:</b> m̄(x) = M/(nμ) (dimensionless magnetization per spin, bounded between −1 and +1).</li>
          <li><b>Curves shown:</b> exact m̄(x) = 2 sinh x / (1 + 2 cosh x) and the low-field approximation m̄ ≈ (2/3)x.</li>
          <li><b>Features to notice:</b> same initial slope at x=0, then the exact curve bends over and approaches 1 (saturation), while the linear approximation keeps growing and becomes invalid.</li>
        </ul>
        <p style="color:var(--faint);">
          Note: No numeric material constants are needed because the plot uses the natural nondimensional variables.
        </p>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <footer>
        <p>
          Built as a self-contained learning article: equilibrium paramagnetism for S=1 using canonical ensemble methods,
          with explicit low-field asymptotics and an applied engineering perspective.
        </p>
      </footer>

    </article>
  </main>
</div>

<script>
  // Copy buttons (plain text)
  (function(){
    function copyText(text){
      navigator.clipboard.writeText(text).then(()=>{
        // subtle feedback: temporarily change button text
      }).catch(()=>{ /* ignore */ });
    }
    document.querySelectorAll('button.copy').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('data-copy-target');
        const el = document.getElementById(id);
        if(!el) return;
        const text = el.innerText.replace(/\u00A0/g,' ');
        const original = btn.textContent;
        copyText(text);
        btn.textContent = "Copied ✓";
        setTimeout(()=> btn.textContent = original, 900);
      });
    });
  })();

  // Canvas plot: dimensionless magnetization mbar(x) for S=1
  (function(){
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    function mbarExact(x){
      // 2 sinh x / (1 + 2 cosh x)
      const sh = Math.sinh(x);
      const ch = Math.cosh(x);
      return (2*sh)/(1 + 2*ch);
    }
    function mbarLin(x){
      return (2/3)*x;
    }

    function resizeAndDraw(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      canvas.width = Math.round(rect.width * dpr);
      canvas.height = Math.round(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0); // draw in CSS pixels

      const W = rect.width, H = rect.height;
      ctx.clearRect(0,0,W,H);

      // Layout
      const padL = 56, padR = 18, padT = 34, padB = 46;
      const plotW = W - padL - padR;
      const plotH = H - padT - padB;

      // Axis ranges (dimensionless)
      const xMin = 0, xMax = 4.0;
      const yMin = 0, yMax = 1.05;

      function X(x){ return padL + (x - xMin) * plotW / (xMax - xMin); }
      function Y(y){ return padT + plotH - (y - yMin) * plotH / (yMax - yMin); }

      // Gridlines
      ctx.lineWidth = 1;
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.fillStyle = "rgba(255,255,255,0.75)";
      ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";

      // Title
      ctx.fillStyle = "rgba(233,238,252,0.95)";
      ctx.font = "600 13px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("S = 1 paramagnet (dimensionless): m̄(x) = M/(nμ)", padL, 18);

      // x ticks
      const xTicks = [0,1,2,3,4];
      ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillStyle = "rgba(185,196,230,0.95)";
      xTicks.forEach(t=>{
        const xx = X(t);
        ctx.beginPath();
        ctx.moveTo(xx, padT);
        ctx.lineTo(xx, padT + plotH);
        ctx.stroke();

        ctx.fillText(String(t), xx-3, padT + plotH + 18);
      });

      // y ticks
      const yTicks = [0,0.2,0.4,0.6,0.8,1.0];
      yTicks.forEach(t=>{
        const yy = Y(t);
        ctx.beginPath();
        ctx.moveTo(padL, yy);
        ctx.lineTo(padL + plotW, yy);
        ctx.stroke();

        ctx.fillText(t.toFixed(1), 10, yy+4);
      });

      // Axes
      ctx.strokeStyle = "rgba(255,255,255,0.35)";
      ctx.lineWidth = 1.25;
      ctx.beginPath();
      ctx.moveTo(padL, padT);
      ctx.lineTo(padL, padT + plotH);
      ctx.lineTo(padL + plotW, padT + plotH);
      ctx.stroke();

      // Axis labels
      ctx.fillStyle = "rgba(233,238,252,0.9)";
      ctx.font = "600 12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("x = μB/(kT)", padL + plotW - 74, padT + plotH + 38);

      ctx.save();
      ctx.translate(18, padT + 10);
      ctx.rotate(-Math.PI/2);
      ctx.fillText("m̄ = M/(nμ)", 0, 0);
      ctx.restore();

      // Curves
      function drawCurve(fn, strokeStyle, dash){
        ctx.strokeStyle = strokeStyle;
        ctx.lineWidth = 2;
        ctx.setLineDash(dash || []);
        ctx.beginPath();
        const N = 260;
        for(let i=0;i<=N;i++){
          const x = xMin + (xMax-xMin)*i/N;
          const y = fn(x);
          const xx = X(x), yy = Y(Math.min(Math.max(y,yMin),yMax));
          if(i===0) ctx.moveTo(xx,yy);
          else ctx.lineTo(xx,yy);
        }
        ctx.stroke();
        ctx.setLineDash([]);
      }

      // Use two distinguishable styles without specifying named colors: rely on RGBA values only.
      drawCurve(mbarExact, "rgba(125,211,252,0.95)", []);         // exact
      drawCurve(mbarLin,   "rgba(167,139,250,0.85)", [6,5]);      // linear approx

      // Legend
      const lx = padL + 10, ly = padT + 8;
      ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillStyle = "rgba(233,238,252,0.92)";
      ctx.fillText("Legend", lx, ly);

      // Exact swatch
      ctx.strokeStyle = "rgba(125,211,252,0.95)";
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(lx, ly+12);
      ctx.lineTo(lx+26, ly+12);
      ctx.stroke();
      ctx.fillStyle = "rgba(185,196,230,0.95)";
      ctx.fillText("Exact: 2 sinh x / (1 + 2 cosh x)", lx+34, ly+16);

      // Linear swatch
      ctx.strokeStyle = "rgba(167,139,250,0.85)";
      ctx.lineWidth = 3;
      ctx.setLineDash([6,5]);
      ctx.beginPath();
      ctx.moveTo(lx, ly+30);
      ctx.lineTo(lx+26, ly+30);
      ctx.stroke();
      ctx.setLineDash([]);
      ctx.fillStyle = "rgba(185,196,230,0.95)";
      ctx.fillText("Low-field: (2/3) x", lx+34, ly+34);
    }

    window.addEventListener('resize', resizeAndDraw, {passive:true});
    resizeAndDraw();
  })();
</script>

</body>
</html>
