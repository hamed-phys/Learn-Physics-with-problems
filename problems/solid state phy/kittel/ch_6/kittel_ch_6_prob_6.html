<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="color-scheme" content="light dark"/>
  <title>Frequency Dependence of Electrical Conductivity (Drude AC Conductivity)</title>
  <style>
    :root{
      --bg: #0b0d10;
      --panel: #11151a;
      --text: #e9eef5;
      --muted: #b9c3d3;
      --faint: #93a4bc;
      --line: rgba(255,255,255,.10);
      --line2: rgba(255,255,255,.16);
      --accent: #7dd3fc;
      --accent2:#a7f3d0;
      --warn:#fbbf24;
      --ok:#86efac;
      --bad:#fb7185;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --radius2: 22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --maxw: 1120px;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f7f8fb;
        --panel:#ffffff;
        --text:#0b1220;
        --muted:#334155;
        --faint:#64748b;
        --line: rgba(2,6,23,.10);
        --line2: rgba(2,6,23,.16);
        --accent:#0284c7;
        --accent2:#059669;
        --warn:#b45309;
        --ok:#047857;
        --bad:#be123c;
        --shadow: 0 10px 30px rgba(2,6,23,.10);
      }
    }
    html{scroll-behavior:smooth;}
    body{
      margin:0;
      font-family: var(--sans);
      background: radial-gradient(1200px 600px at 25% -10%, rgba(125,211,252,.15), transparent 60%),
                  radial-gradient(900px 500px at 90% 0%, rgba(167,243,208,.12), transparent 55%),
                  var(--bg);
      color: var(--text);
      line-height: 1.6;
    }
    header{
      border-bottom: 1px solid var(--line);
      background: linear-gradient(to bottom, rgba(255,255,255,.04), transparent);
    }
    .wrap{max-width: var(--maxw); margin: 0 auto; padding: 22px 18px;}
    .hero{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
      align-items: start;
    }
    @media (max-width: 900px){
      .hero{grid-template-columns: 1fr;}
    }
    h1{
      margin: 6px 0 8px;
      font-size: clamp(1.55rem, 2.7vw, 2.25rem);
      letter-spacing: -0.02em;
      line-height: 1.2;
    }
    .subtitle{
      color: var(--muted);
      margin:0;
      font-size: 1.02rem;
      max-width: 75ch;
    }
    .badges{
      display:flex; flex-wrap:wrap; gap:8px; margin-top:12px;
    }
    .badge{
      font-size:.82rem;
      color: var(--muted);
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      padding:6px 10px;
      border-radius: 999px;
      backdrop-filter: blur(6px);
    }

    main{position:relative;}
    .grid{
      display:grid;
      grid-template-columns: 260px 1fr;
      gap: 18px;
      align-items:start;
      margin-top: 18px;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr;}
    }

    /* Sticky TOC */
    nav.toc{
      position: sticky;
      top: 14px;
      align-self: start;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius: var(--radius2);
      padding: 14px 12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
    }
    @media (max-width: 980px){
      nav.toc{position:relative; top:auto;}
    }
    .toc h2{
      margin: 0 0 10px;
      font-size: 0.95rem;
      letter-spacing: .02em;
      text-transform: uppercase;
      color: var(--faint);
    }
    .toc a{
      display:block;
      color: var(--muted);
      text-decoration:none;
      padding: 7px 10px;
      border-radius: 12px;
      border: 1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size: .95rem;
    }
    .toc a:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.25);
      transform: translateX(2px);
      color: var(--text);
    }
    .toc .mini{
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed var(--line);
      font-size: .9rem;
      color: var(--faint);
    }
    .toc .mini a{font-size:.92rem;}

    section{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 18px 16px;
      margin-bottom: 16px;
      backdrop-filter: blur(8px);
      overflow:hidden;
    }
    section h2{
      margin: 0 0 10px;
      font-size: 1.25rem;
      letter-spacing: -0.01em;
    }
    section h3{
      margin: 16px 0 8px;
      font-size: 1.06rem;
      color: var(--text);
    }
    p{margin: 8px 0;}
    ul,ol{margin: 8px 0 8px 22px;}
    li{margin: 6px 0;}
    .muted{color: var(--muted);}
    .small{font-size: .92rem; color: var(--muted);}
    .kpi{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
    }
    @media (max-width: 680px){
      .kpi{grid-template-columns:1fr;}
    }
    .card{
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding: 12px 12px;
      background: rgba(255,255,255,.02);
    }
    .card strong{display:block; margin-bottom:4px;}
    .callout{
      border:1px solid var(--line2);
      border-left: 4px solid var(--accent);
      background: linear-gradient(180deg, rgba(125,211,252,.10), rgba(255,255,255,.02));
      border-radius: var(--radius);
      padding: 12px 12px;
      margin: 12px 0;
    }
    .callout.warn{border-left-color: var(--warn); background: linear-gradient(180deg, rgba(251,191,36,.14), rgba(255,255,255,.02));}
    .callout.ok{border-left-color: var(--ok); background: linear-gradient(180deg, rgba(134,239,172,.12), rgba(255,255,255,.02));}
    .callout.bad{border-left-color: var(--bad); background: linear-gradient(180deg, rgba(251,113,133,.12), rgba(255,255,255,.02));}
    .eq{
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(0,0,0,.20);
      padding: 12px 12px;
      font-family: var(--mono);
      font-size: .95rem;
      overflow:auto;
      margin: 10px 0;
    }
    @media (prefers-color-scheme: light){
      .eq{background: rgba(2,6,23,.05);}
    }
    .eq .label{
      font-family: var(--sans);
      font-size: .82rem;
      color: var(--faint);
      text-transform: uppercase;
      letter-spacing: .06em;
      margin-bottom: 8px;
    }

    .btnrow{display:flex; gap:10px; flex-wrap:wrap; margin: 10px 0 2px;}
    button.copy{
      border:1px solid var(--line2);
      background: rgba(255,255,255,.04);
      color: var(--text);
      border-radius: 999px;
      padding: 8px 12px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size: .92rem;
    }
    button.copy:hover{transform: translateY(-1px); background: rgba(125,211,252,.10); border-color: rgba(125,211,252,.30);}
    button.copy:active{transform: translateY(0px) scale(.99);}
    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(0,0,0,.75);
      color: white;
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      font-size: .92rem;
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease;
      z-index: 50;
      backdrop-filter: blur(10px);
    }
    @media (prefers-color-scheme: light){
      .toast{background: rgba(2,6,23,.80);}
    }
    .toast.show{opacity: 1;}

    details{
      border:1px dashed var(--line);
      border-radius: var(--radius);
      padding: 10px 12px;
      margin: 10px 0;
      background: rgba(255,255,255,.02);
    }
    summary{
      cursor:pointer;
      color: var(--muted);
      font-weight: 650;
    }
    summary:hover{color: var(--text);}
    .toplink{
      display:inline-block;
      margin-top: 8px;
      color: var(--accent);
      text-decoration:none;
      border-bottom: 1px dashed rgba(125,211,252,.35);
    }
    .toplink:hover{border-bottom-style: solid;}

    figure{
      margin: 12px 0 4px;
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      overflow:hidden;
      background: rgba(255,255,255,.02);
    }
    figcaption{
      padding: 10px 12px;
      border-top: 1px solid var(--line);
      color: var(--muted);
      font-size: .92rem;
    }
    canvas{display:block; width:100%; height: 340px;}
    @media (max-width: 520px){
      canvas{height: 300px;}
    }

    footer{
      border-top:1px solid var(--line);
      color: var(--muted);
      padding: 18px 0;
      font-size: .92rem;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000;}
      nav.toc{display:none;}
      section{box-shadow:none; background:#fff; break-inside: avoid; page-break-inside: avoid;}
      header{background:#fff;}
      .toast{display:none;}
      button.copy{display:none;}
      a{color:#000; text-decoration: underline;}
      .eq{background:#fff;}
      figure{break-inside: avoid;}
    }
  </style>
</head>
<body>
  <a id="top"></a>
  <header>
    <div class="wrap hero">
      <div>
        <h1>Frequency Dependence of Electrical Conductivity: Deriving the Drude AC Conductivity</h1>
        <p class="subtitle">
          Starting from the electron drift ODE <span class="muted">(a linear, damped response model)</span>, we derive the complex conductivity
          <span class="muted">σ(ω)</span> and interpret its real/imaginary parts as dissipation and energy storage.
        </p>
        <div class="badges" aria-label="topic badges">
          <span class="badge">Drude model</span>
          <span class="badge">Linear response</span>
          <span class="badge">Complex phasors</span>
          <span class="badge">Applied RF/THz transport</span>
          <span class="badge">Mathematical physics (ODE + Fourier)</span>
        </div>
      </div>
      <div class="card">
        <strong>Problem target result</strong>
        <div class="eq" style="margin:10px 0 0;">
          <div class="label">Goal</div>
          σ(ω) = σ(0) · (1 + i ω τ) / (1 + (ω τ)^2),  &nbsp;where&nbsp; σ(0) = n e^2 τ / m
        </div>
        <p class="small">We will derive this exactly (symbolic), then sanity-check limits ωτ ≪ 1 and ωτ ≫ 1.</p>
      </div>
    </div>
  </header>

  <main class="wrap grid">
    <nav class="toc" aria-label="Table of Contents">
      <h2>Contents</h2>
      <a href="#qs">Quick Summary</a>
      <a href="#p0">PART 0 — Concept Primer</a>
      <a href="#p0b">PART 0B — Industry & Applied Physics</a>
      <a href="#p1">PART 1 — Problem Analysis</a>
      <a href="#p2">PART 2 — Strategy & Tips</a>
      <a href="#p3">PART 3 — Full Solution</a>
      <a href="#p4">PART 4 — Deeper Understanding</a>
      <a href="#p5">PART 5 — Optional Plot Guide</a>
      <div class="mini">
        <a href="#plot">Jump to plot</a>
        <a href="#final">Jump to final answer</a>
      </div>
    </nav>

    <article aria-label="Lesson article content">
      <section id="qs">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this is about:</strong> deriving how a material’s conductivity depends on driving frequency <span class="muted">ω</span> in the Drude (free-electron) model.</li>
          <li><strong>Key physics idea:</strong> electrons accelerate under <span class="muted">E(t)</span> but are damped by collisions modeled as a relaxation time <span class="muted">τ</span>.</li>
          <li><strong>Governing equation:</strong> a linear ODE for drift velocity <span class="muted">v(t)</span>:
            <span class="muted">m(dv/dt + v/τ) = −eE(t)</span>.</li>
          <li><strong>Constitutive link:</strong> current density <span class="muted">J(t) = −ne v(t)</span>, and in frequency domain <span class="muted">J(ω)=σ(ω)E(ω)</span>.</li>
          <li><strong>Result type:</strong> symbolic complex function <span class="muted">σ(ω)</span>, whose real part is dissipative (loss) and imaginary part is reactive (phase lag / energy storage).</li>
          <li><strong>Final result:</strong> <span class="muted">σ(ω) = σ(0)/(1 − iωτ) = σ(0)(1+iωτ)/(1+(ωτ)^2)</span>, with <span class="muted">σ(0)=ne²τ/m</span>.</li>
          <li><strong>Important limits:</strong> <span class="muted">ωτ≪1 ⇒ σ≈σ(0)</span> (DC), <span class="muted">ωτ≫1 ⇒ Re σ ~ σ(0)/(ωτ)^2</span> (loss drops) and <span class="muted">Im σ ~ σ(0)/(ωτ)</span>.</li>
        </ul>
      </section>

      <section id="p0">
        <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

        <h3>Core definitions (symbols + SI units)</h3>
        <div class="kpi">
          <div class="card">
            <strong>n</strong>
            <div class="small">carrier number density [m<sup>−3</sup>]</div>
          </div>
          <div class="card">
            <strong>e</strong>
            <div class="small">elementary charge magnitude [C]; electron charge is <span class="muted">−e</span></div>
          </div>
          <div class="card">
            <strong>m</strong>
            <div class="small">electron (effective) mass [kg]</div>
          </div>
          <div class="card">
            <strong>τ</strong>
            <div class="small">momentum relaxation time [s]</div>
          </div>
          <div class="card">
            <strong>E(t), E(ω)</strong>
            <div class="small">electric field [V/m] in time and frequency domain</div>
          </div>
          <div class="card">
            <strong>v(t)</strong>
            <div class="small">drift velocity (ensemble average) [m/s]</div>
          </div>
          <div class="card">
            <strong>J(t), J(ω)</strong>
            <div class="small">current density [A/m<sup>2</sup>]</div>
          </div>
          <div class="card">
            <strong>σ(ω)</strong>
            <div class="small">complex conductivity [S/m] at angular frequency ω [rad/s]</div>
          </div>
        </div>

        <h3>Physical meaning (intuition)</h3>
        <ul>
          <li><strong>Drift velocity</strong> is the small average velocity superimposed on random thermal motion due to the applied field.</li>
          <li><strong>Relaxation time τ</strong> is a phenomenological average time over which momentum “forgets” its previous value due to collisions (phonons, impurities, etc.).</li>
          <li><strong>Complex σ(ω)</strong> encodes both magnitude and phase between <span class="muted">J</span> and <span class="muted">E</span>:
            <span class="muted">Re σ</span> ↔ dissipated power, <span class="muted">Im σ</span> ↔ reactive (inertial) response.</li>
        </ul>

        <h3>Key laws/principles and validity conditions</h3>
        <div class="callout ok">
          <strong>Model assumptions (Drude / relaxation-time approximation):</strong>
          <ul>
            <li>Electrons behave as (quasi-)free classical particles with effective mass <span class="muted">m</span>.</li>
            <li>Collisions are summarized by a single constant <span class="muted">τ</span> (memoryless exponential relaxation).</li>
            <li>Field is spatially uniform (no ∇ dependence), and response is linear: <span class="muted">J ∝ E</span>.</li>
            <li>We focus on steady-state sinusoidal driving (transients ignored after long time).</li>
          </ul>
        </div>

        <h3>Common models/approximations and why they’re used</h3>
        <ul>
          <li><strong>Relaxation-time approximation</strong>: replace complex collision physics with linear damping <span class="muted">−(m/τ)v</span>, yielding a solvable ODE and correct qualitative AC behavior.</li>
          <li><strong>Phasor (complex exponential) method</strong>: convert time derivatives into algebraic factors <span class="muted">−iω</span>, exploiting linearity of the ODE.</li>
          <li><strong>Frequency-domain constitutive relation</strong>: define <span class="muted">σ(ω)</span> via <span class="muted">J(ω)=σ(ω)E(ω)</span>, a standard linear systems viewpoint.</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ol>
          <li><strong>DC field (ω=0):</strong> collisions balance force → constant drift → finite <span class="muted">σ(0)</span>.</li>
          <li><strong>Very fast driving (ωτ ≫ 1):</strong> electrons cannot follow the rapidly changing field → reduced dissipative conduction (smaller <span class="muted">Re σ</span>).</li>
          <li><strong>Intermediate ωτ ~ 1:</strong> inertia and damping compete → strong phase lag between current and field.</li>
        </ol>

        <h3>What to watch for (pitfalls)</h3>
        <div class="callout warn">
          <ul>
            <li><strong>Sign conventions:</strong> whether you use <span class="muted">e^{+iωt}</span> or <span class="muted">e^{-iωt}</span> changes <span class="muted">±iω</span>. The final physical <span class="muted">Re σ</span> is the same, but <span class="muted">Im σ</span> flips sign.</li>
            <li><strong>Electron charge:</strong> electron is <span class="muted">−e</span>, so <span class="muted">J = −ne v</span> (not <span class="muted">+ne v</span>).</li>
            <li><strong>Transient vs steady state:</strong> an exponentially decaying transient exists; AC conductivity uses the steady-state periodic solution.</li>
            <li><strong>Units check:</strong> make sure <span class="muted">σ</span> ends in [S/m].</li>
          </ul>
        </div>

        <div class="callout">
          <strong>Math Insight (as a mathematical object):</strong>
          <p>
            The drift ODE is a <em>linear time-invariant</em> (LTI) first-order system:
            <span class="muted">(d/dt + 1/τ)v = f(t)</span>.
            In frequency space, it becomes an algebraic “transfer function”
            <span class="muted">H(ω)=1/(1−iωτ)</span>, a classic hallmark of a stable, causal, exponentially relaxing response.
          </p>
        </div>

        <a class="toplink" href="#top">Back to top</a>
      </section>

      <section id="p0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <h3>Where this appears in industry (concrete areas)</h3>
        <ul>
          <li><strong>RF & microwave electronics:</strong> frequency-dependent conduction affects impedance matching, loss, and skin-depth behavior in conductors and doped semiconductors.</li>
          <li><strong>THz spectroscopy & material metrology:</strong> extracting <span class="muted">τ</span> and <span class="muted">n</span> from measured complex conductivity is common in semiconductor characterization and thin-film QA.</li>
          <li><strong>Plasmonics / photonics:</strong> metals at optical/IR frequencies often use Drude-like permittivity models; conductivity connects to optical losses and dispersion.</li>
          <li><strong>Power electronics & EMC:</strong> frequency-dependent losses influence thermal design, efficiency, and electromagnetic compatibility.</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><strong>Performance:</strong> loss (heating) is controlled by <span class="muted">Re σ(ω)</span>; phase/dispersion by <span class="muted">Im σ(ω)</span>.</li>
          <li><strong>Reliability & safety:</strong> Joule heating scales with <span class="muted">Re σ</span> and field amplitude; it drives thermal stress and aging.</li>
          <li><strong>Cost & manufacturability:</strong> doping levels, impurities, and microstructure change <span class="muted">n</span> and <span class="muted">τ</span>, impacting yield and consistency.</li>
        </ul>

        <h3>Typical measurement/validation methods</h3>
        <ul>
          <li><strong>Four-point probe</strong> for DC σ(0), combined with temperature sweeps to infer scattering mechanisms.</li>
          <li><strong>Impedance spectroscopy</strong> (kHz–MHz) measuring complex admittance to obtain <span class="muted">σ(ω)</span>.</li>
          <li><strong>Terahertz time-domain spectroscopy (THz-TDS)</strong> extracting complex conductivity from transmitted/reflected pulses (thin films, semiconductors).</li>
        </ul>

        <h3>Design trade-offs and constraints</h3>
        <ul>
          <li><strong>Higher carrier density n</strong> increases σ(0) but can worsen optical losses or change mobility via additional scattering.</li>
          <li><strong>Longer τ (higher mobility)</strong> improves DC conductivity yet can increase reactive effects and modify high-frequency response.</li>
          <li><strong>Non-idealities:</strong> multiple carrier types, frequency-dependent τ(ω), grain boundaries, and anisotropy can require extended models beyond simple Drude.</li>
        </ul>

        <details>
          <summary>From lab to product: how the idealized model is adapted</summary>
          <p class="muted">
            In real devices, engineers often replace a single τ with an effective mobility μ (or a distribution of relaxation times),
            include multiple Drude terms for multiple bands/carriers, and couple σ(ω) into Maxwell boundary-value problems
            (skin depth, waveguides, thin-film stacks). The “simple” σ(ω) becomes an ingredient inside full EM simulations.
          </p>
        </details>

        <a class="toplink" href="#top">Back to top</a>
      </section>

      <section id="p1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>Restate the problem (in plain words)</h3>
        <p>
          You are given the Drude drift equation for electrons,
          <span class="muted">m(dv/dt + v/τ) = −eE</span>.
          Show that when the electric field oscillates at angular frequency <span class="muted">ω</span>,
          the conductivity is
          <span class="muted">σ(ω)=σ(0)(1+iωτ)/(1+(ωτ)²)</span>,
          where <span class="muted">σ(0)=ne²τ/m</span>.
        </p>

        <h3>Given quantities</h3>
        <ul>
          <li>ODE: <span class="muted">m(dv/dt + v/τ) = −eE(t)</span></li>
          <li>Carrier density <span class="muted">n</span>, electron charge magnitude <span class="muted">e</span>, mass <span class="muted">m</span>, relaxation time <span class="muted">τ</span></li>
        </ul>

        <h3>Unknowns</h3>
        <ul>
          <li>Complex conductivity <span class="muted">σ(ω)</span></li>
          <li>Relationship between <span class="muted">J</span> and <span class="muted">E</span> at frequency <span class="muted">ω</span></li>
        </ul>

        <h3>What must be found/proved</h3>
        <ul>
          <li>Derive <span class="muted">σ(ω)=σ(0)(1+iωτ)/(1+(ωτ)²)</span> and identify <span class="muted">σ(0)=ne²τ/m</span>.</li>
        </ul>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>Newton’s 2nd law with damping:</strong> the Drude model is a momentum-balance law with linear drag <span class="muted">m v/τ</span>.</li>
          <li><strong>Linearity:</strong> the ODE is linear in <span class="muted">v</span> and <span class="muted">E</span>, enabling sinusoidal steady-state / Fourier methods.</li>
          <li><strong>Constitutive definition of conductivity:</strong> in frequency domain, linear response implies <span class="muted">J(ω)=σ(ω)E(ω)</span>.</li>
        </ul>

        <h3>Explicit mathematical model (variables, domains, coordinates, conditions)</h3>
        <div class="callout">
          <strong>Mathematical model statement (rigorous):</strong>
          <ul>
            <li><strong>Unknown:</strong> drift velocity vector <span class="muted">v(t) ∈ ℝ³</span> (ensemble mean).</li>
            <li><strong>Independent variable:</strong> time <span class="muted">t ∈ [0,∞)</span>.</li>
            <li><strong>Given forcing:</strong> spatially uniform electric field <span class="muted">E(t)</span>. For AC, take a single-frequency harmonic:
              <span class="muted">E(t)=Re{E₀ e^{-iωt}}</span>, with complex amplitude <span class="muted">E₀</span>.</li>
            <li><strong>ODE (vector form):</strong> <span class="muted">m(dv/dt + v/τ) = −eE(t)</span>, applied component-wise.</li>
            <li><strong>Initial condition:</strong> <span class="muted">v(0)=v₀</span> (arbitrary). For conductivity, we use the <em>steady-state</em> solution after transients decay.</li>
            <li><strong>Boundary conditions:</strong> none (spatially uniform “lumped” material model). If spatial variation were included, one would couple to Maxwell equations with operators <span class="muted">∇·</span>, <span class="muted">∇×</span>, etc.; here those are not required.</li>
          </ul>
        </div>

        <h3>Assumptions (idealizations)</h3>
        <div class="callout ok">
          <ul>
            <li>Uniform, isotropic medium; ignore spatial gradients <span class="muted">(∇ = 0 in this reduced model)</span>.</li>
            <li>Single relaxation time τ (constant, frequency-independent).</li>
            <li>Linear regime: field small enough that response remains proportional to <span class="muted">E</span>.</li>
            <li>One carrier type (electrons) with density <span class="muted">n</span>.</li>
          </ul>
        </div>

        <h3>2–3 approaches (pros/cons)</h3>
        <ol>
          <li><strong>Phasor / complex exponential method:</strong> assume steady-state <span class="muted">v(t)=Re{v̂ e^{-iωt}}</span>.
            <br><span class="muted">Pros:</span> fastest, clean algebra. <span class="muted">Cons:</span> must track sign convention carefully.</li>
          <li><strong>Fourier transform method:</strong> transform the ODE; derivative becomes multiplication by <span class="muted">−iω</span>.
            <br><span class="muted">Pros:</span> very general (arbitrary signals). <span class="muted">Cons:</span> heavier formalism than needed.</li>
          <li><strong>Time-domain solve + take sinusoidal steady state:</strong> solve ODE with integrating factor.
            <br><span class="muted">Pros:</span> exposes transient decay explicitly. <span class="muted">Cons:</span> more steps.</li>
        </ol>

        <p><strong>Chosen approach:</strong> phasor method (with a short time-domain check) because the system is linear and the question is explicitly about a single frequency ω.</p>

        <a class="toplink" href="#top">Back to top</a>
      </section>

      <section id="p2">
        <h2>PART 2 — Strategy & Tips (roadmap only)</h2>
        <ol>
          <li><strong>Specify harmonic driving</strong> <span class="muted">E(t)=Re{E₀ e^{-iωt}}</span> to isolate frequency ω.</li>
          <li><strong>Assume steady-state response</strong> <span class="muted">v(t)=Re{v̂ e^{-iωt}}</span> (transients decay because τ &gt; 0).</li>
          <li><strong>Differentiate</strong>: <span class="muted">dv/dt → Re{(−iω)v̂ e^{-iωt}}</span>.</li>
          <li><strong>Substitute into the ODE</strong> and cancel the common factor <span class="muted">e^{-iωt}</span> using linearity.</li>
          <li><strong>Solve algebraically for v̂</strong> in terms of E₀.</li>
          <li><strong>Relate current and velocity</strong>: <span class="muted">Ĵ = −ne v̂</span>.</li>
          <li><strong>Define conductivity</strong> in frequency domain: <span class="muted">Ĵ = σ(ω) E₀</span>.</li>
          <li><strong>Simplify</strong> to match the requested form and identify <span class="muted">σ(0)</span>.</li>
          <li><strong>Sanity checks</strong>: units, ωτ limits, physical meaning of real/imag parts.</li>
        </ol>

        <div class="callout bad">
          <strong>Common mistakes</strong>
          <ul>
            <li>Mixing <span class="muted">e^{+iωt}</span> and <span class="muted">e^{-iωt}</span> mid-derivation.</li>
            <li>Using <span class="muted">J=ne v</span> for electrons (wrong sign).</li>
            <li>Forgetting that σ(ω) is generally complex (phase matters).</li>
            <li>Dropping τ or ωτ without stating the approximation.</li>
          </ul>
        </div>

        <a class="toplink" href="#top">Back to top</a>
      </section>

      <section id="p3">
        <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

        <h3>Physical intuition first (what to expect)</h3>
        <p>
          Because electrons have inertia (mass <span class="muted">m</span>) and collisions (time <span class="muted">τ</span>), the drift velocity cannot instantaneously follow an oscillating field.
          At low frequency, collisions establish a quasi-steady drift → σ ≈ constant.
          At high frequency, the velocity lags strongly → reduced dissipative conduction and a significant reactive component.
        </p>

        <h3>Step 1 — Start from the given drift equation</h3>
        <div class="eq" id="eq1">
          <div class="label">Given ODE (vector, component-wise)</div>
          m ( dv/dt + v/τ ) = − e E(t)
        </div>

        <p class="muted">
          This is linear in v and E. Since τ &gt; 0, the homogeneous solution decays exponentially, ensuring a unique steady-state under sinusoidal forcing.
        </p>

        <h3>Step 2 — Specify sinusoidal driving and use phasors (complex amplitudes)</h3>
        <p>
          Take a single-frequency electric field (spatially uniform) as:
        </p>
        <div class="eq" id="eq2">
          <div class="label">Harmonic field (phasor convention)</div>
          E(t) = Re{ E0 e^(−i ω t) }
        </div>
        <p>
          By linearity of the ODE, the steady-state response for v(t) will have the same time dependence:
        </p>
        <div class="eq" id="eq3">
          <div class="label">Steady-state drift (phasor form)</div>
          v(t) = Re{ v̂ e^(−i ω t) }
        </div>

        <details>
          <summary>Why is it valid to assume the same frequency?</summary>
          <p class="muted">
            The operator <span style="font-family:var(--mono)">(d/dt + 1/τ)</span> is linear and time-invariant.
            For an LTI system, a complex exponential input <span style="font-family:var(--mono)">e^(−iωt)</span> is an eigenfunction:
            derivatives only multiply by <span style="font-family:var(--mono)">−iω</span>.
            Therefore the output is the same exponential times a constant (the transfer function).
          </p>
        </details>

        <h3>Step 3 — Compute dv/dt explicitly (no magic jumps)</h3>
        <p>
          Starting from <span class="muted">v(t)=Re{v̂ e^{-iωt}}</span>, differentiate the complex form:
        </p>
        <div class="eq" id="eq4">
          <div class="label">Time derivative</div>
          d/dt [ v̂ e^(−i ω t) ] = (−i ω) v̂ e^(−i ω t)
        </div>
        <p class="muted">
          Taking the real part afterward is allowed because differentiation is linear: <span style="font-family:var(--mono)">d/dt(Re{z}) = Re{d z/dt}</span>.
        </p>

        <h3>Step 4 — Substitute into the ODE and cancel the common factor</h3>
        <p>
          Substitute the complex forms (dropping <span class="muted">Re{·}</span> temporarily, since the ODE holds for each component and real/imag parts separately):
        </p>
        <div class="eq" id="eq5">
          <div class="label">Substitution</div>
          m [ (−i ω) v̂ e^(−i ω t) + (1/τ) v̂ e^(−i ω t) ] = − e E0 e^(−i ω t)
        </div>
        <p>
          Factor out <span class="muted">e^{-iωt}</span> (nonzero for all t), then divide both sides by it:
        </p>
        <div class="eq" id="eq6">
          <div class="label">Algebraic phasor equation</div>
          m ( −i ω + 1/τ ) v̂ = − e E0
        </div>

        <p class="muted">
          This step is valid because the equation is linear and all terms share the same time dependence in steady state.
        </p>

        <h3>Step 5 — Solve for the velocity amplitude v̂</h3>
        <p>
          Solve the algebraic equation for v̂:
        </p>
        <div class="eq" id="eq7">
          <div class="label">Solve for v̂</div>
          v̂ = [ − e / m ] · E0 / ( 1/τ − i ω )
        </div>
        <p>
          Multiply numerator and denominator by τ to make the dimensionless group <span class="muted">ωτ</span> appear:
        </p>
        <div class="eq" id="eq8">
          <div class="label">Introduce ωτ (nondimensionalization)</div>
          v̂ = [ − e τ / m ] · E0 / ( 1 − i ω τ )
        </div>

        <div class="callout">
          <strong>Scaling / nondimensionalization insight:</strong>
          <p class="muted">
            The only relevant dimensionless parameter is <span style="font-family:var(--mono)">ωτ</span>.
            It compares the drive timescale <span style="font-family:var(--mono)">1/ω</span> to the relaxation timescale <span style="font-family:var(--mono)">τ</span>.
            This is why all curves can be plotted versus <span style="font-family:var(--mono)">ωτ</span> universally.
          </p>
        </div>

        <h3>Step 6 — Convert velocity to current density</h3>
        <p>
          For electrons (charge <span class="muted">−e</span>), the current density is
        </p>
        <div class="eq" id="eq9">
          <div class="label">Current density definition</div>
          J(t) = − n e v(t)
        </div>
        <p>
          Therefore for complex amplitudes (phasors),
        </p>
        <div class="eq" id="eq10">
          <div class="label">Phasor current</div>
          Ĵ = − n e v̂
        </div>
        <p>
          Substitute v̂ from Step 5:
        </p>
        <div class="eq" id="eq11">
          <div class="label">Substitute v̂</div>
          Ĵ = − n e · [ − e τ / m ] · E0 / ( 1 − i ω τ )
             = ( n e^2 τ / m ) · E0 / ( 1 − i ω τ )
        </div>

        <h3>Step 7 — Define σ(ω) by Ĵ = σ(ω) E0</h3>
        <p>
          By definition of (complex) conductivity in frequency domain,
        </p>
        <div class="eq" id="eq12">
          <div class="label">Definition</div>
          Ĵ = σ(ω) E0
        </div>
        <p>
          Comparing with Step 6,
        </p>
        <div class="eq" id="eq13">
          <div class="label">Complex conductivity (compact form)</div>
          σ(ω) = ( n e^2 τ / m ) · 1 / ( 1 − i ω τ )
        </div>
        <p>
          Identify the DC conductivity by setting ω=0:
        </p>
        <div class="eq" id="eq14">
          <div class="label">DC conductivity</div>
          σ(0) = n e^2 τ / m
        </div>
        <p>
          Now rewrite σ(ω) into the requested rational form by multiplying numerator and denominator by the complex conjugate <span class="muted">(1 + iωτ)</span>:
        </p>
        <div class="eq" id="eq15">
          <div class="label">Rationalized form</div>
          σ(ω) = σ(0) · (1 + i ω τ) / [ (1 − i ω τ)(1 + i ω τ) ]
               = σ(0) · (1 + i ω τ) / (1 + (ω τ)^2)
        </div>

        <div class="callout ok" id="final">
          <strong>Final Answer (boxed):</strong>
          <div class="eq" id="eqFinal">
            <div class="label">Result</div>
            σ(ω) = σ(0) (1 + i ω τ) / (1 + (ω τ)^2),   where   σ(0) = n e^2 τ / m
          </div>
          <div class="btnrow">
            <button class="copy" data-copy="σ(ω) = σ(0) (1 + i ω τ) / (1 + (ω τ)^2)\nσ(0) = n e^2 τ / m">Copy final answer (plain text)</button>
          </div>
        </div>

        <h3>Sanity checks</h3>

        <div class="callout">
          <strong>1) Dimensional analysis (units)</strong>
          <p class="muted">
            Check <span style="font-family:var(--mono)">σ(0)=n e^2 τ / m</span>:
            <br>
            n [m<sup>−3</sup>], e [C], τ [s], m [kg] ⇒ n e² τ / m has units
            <span style="font-family:var(--mono)">(m^−3)(C^2)(s)/kg</span>.
            Using <span style="font-family:var(--mono)">1 S = 1 A/V</span> and
            <span style="font-family:var(--mono)">1 V = kg·m^2/(s^3·A)</span>,
            one finds <span style="font-family:var(--mono)">S/m = (C^2 s)/(kg m^3)</span>, matching exactly.
          </p>
        </div>

        <div class="callout">
          <strong>2) Limiting cases (asymptotics)</strong>
          <ul>
            <li>
              <strong>Low frequency (ωτ ≪ 1):</strong>
              <span class="muted">σ(ω)=σ(0)(1+iωτ)/(1+(ωτ)^2)</span>.
              Expand denominator: <span class="muted">1/(1+(ωτ)^2) ≈ 1 − (ωτ)^2 + …</span>.
              So
              <span class="muted">σ(ω) ≈ σ(0)[1 + iωτ − (ωτ)^2 + …]</span>,
              hence <span class="muted">Re σ ≈ σ(0)</span>, <span class="muted">Im σ ≈ σ(0) ωτ</span>.
            </li>
            <li>
              <strong>High frequency (ωτ ≫ 1):</strong>
              Using the rational form,
              <span class="muted">Re σ = σ(0)/(1+(ωτ)^2) ≈ σ(0)/(ωτ)^2</span>,
              <span class="muted">Im σ = σ(0) ωτ/(1+(ωτ)^2) ≈ σ(0)/(ωτ)</span>.
              Dissipation drops faster (<span class="muted">~(ωτ)^−2</span>) than the reactive part (<span class="muted">~(ωτ)^−1</span>).
            </li>
          </ul>
        </div>

        <div class="callout">
          <strong>3) Physical interpretation (plain language)</strong>
          <p class="muted">
            The factor <span style="font-family:var(--mono)">1/(1 − iωτ)</span> means the drift velocity (hence current) lags behind the driving field.
            Collisions (τ) set how quickly the electron momentum relaxes; at high ω, electrons cannot keep up, so real power absorption decreases.
          </p>
        </div>

        <div class="btnrow">
          <button class="copy" data-copy="Key equations:\n(1) m(dv/dt + v/τ) = −eE(t)\n(2) J(t) = −ne v(t)\n(3) σ(ω) = (ne^2 τ/m) · 1/(1 − iωτ)\n(4) σ(ω) = σ(0)(1 + iωτ)/(1 + (ωτ)^2), σ(0)=ne^2 τ/m">Copy key equations (plain text)</button>
        </div>

        <a class="toplink" href="#top">Back to top</a>
      </section>

      <section id="p4">
        <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

        <h3>Re-interpret the final formula</h3>
        <p>
          Write σ(ω) in separated real and imaginary parts using the final form:
        </p>
        <div class="eq" id="eqReIm">
          <div class="label">Real and imaginary parts</div>
          σ(ω) = σ(0) (1 + i ω τ) / (1 + (ω τ)^2)
          ⇒ Re σ(ω) = σ(0) / (1 + (ω τ)^2)
          ⇒ Im σ(ω) = σ(0) (ω τ) / (1 + (ω τ)^2)
        </div>
        <ul>
          <li><strong>Re σ(ω):</strong> controls Joule heating: average power density under harmonic fields is
            <span class="muted">&lt;P&gt; = (1/2) Re{σ(ω)} |E0|^2</span> (phasor convention).</li>
          <li><strong>Im σ(ω):</strong> indicates reactive (inertial) current component—energy sloshes between field and carrier motion without net dissipation over a cycle.</li>
        </ul>

        <h3>Parameter dependence (qualitative + quantitative)</h3>
        <ul>
          <li><strong>Increasing n:</strong> scales σ(ω) up linearly at all ω (more carriers).</li>
          <li><strong>Increasing τ:</strong> increases σ(0) linearly, but also shifts the “roll-off” to lower ω because ωτ grows faster for a given ω. The crossover is around <span class="muted">ω ~ 1/τ</span>.</li>
          <li><strong>Increasing m:</strong> decreases conductivity (harder to accelerate carriers), since σ ∝ 1/m.</li>
          <li><strong>Frequency ω:</strong> controls phase lag and reduces <span class="muted">Re σ</span> beyond <span class="muted">ωτ ≳ 1</span>.</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <details>
          <summary>Fourier transform / operator viewpoint</summary>
          <p class="muted">
            Treat the ODE as an operator equation:
            <span style="font-family:var(--mono)">m( d/dt + 1/τ ) v(t) = −e E(t)</span>.
            Taking the Fourier transform (or evaluating at a single frequency) uses the eigenfunction property:
            <span style="font-family:var(--mono)">d/dt ↔ −iω</span>.
            Hence
            <span style="font-family:var(--mono)">m(−iω + 1/τ) v̂(ω) = −e Ê(ω)</span>
            which yields the same σ(ω) immediately.
          </p>
        </details>

        <h3>Concept check (self-test with answers)</h3>
        <ul>
          <li><strong>Q:</strong> What does ωτ measure? <strong>A:</strong> the ratio of collision time to field period; it controls how well electrons follow the oscillation.</li>
          <li><strong>Q:</strong> Why is σ(ω) complex? <strong>A:</strong> because current can be out of phase with E due to inertia and damping (a phase-lag response).</li>
          <li><strong>Q:</strong> What happens to Re σ as ω increases? <strong>A:</strong> it decreases as <span class="muted">1/(1+(ωτ)^2)</span>, meaning less dissipative conduction at high frequency.</li>
          <li><strong>Q:</strong> If τ → 0, what happens? <strong>A:</strong> carriers relax instantly, σ(0)=ne²τ/m → 0, so conduction vanishes in this model (extreme strong-scattering limit).</li>
          <li><strong>Q:</strong> If τ → ∞ (no collisions), is DC conductivity finite? <strong>A:</strong> no—σ(0) would diverge; collisions are essential for finite resistivity in Drude.</li>
        </ul>

        <a class="toplink" href="#top">Back to top</a>
      </section>

      <section id="plot">
        <h2>One Helpful Plot (Normalized Conductivity vs ωτ)</h2>
        <p class="muted">
          Because the result is universal in the dimensionless parameter <span style="font-family:var(--mono)">x = ωτ</span>,
          we can plot normalized real and imaginary parts:
          <span style="font-family:var(--mono)">Re σ/σ0</span> and <span style="font-family:var(--mono)">Im σ/σ0</span> as functions of <span style="font-family:var(--mono)">x</span>.
        </p>

        <figure>
          <canvas id="drudeCanvas" aria-label="Plot of normalized Drude conductivity vs omega tau"></canvas>
          <figcaption>
            Static plot (dimensionless): <span style="font-family:var(--mono)">Re σ/σ0 = 1/(1+x^2)</span> and
            <span style="font-family:var(--mono)">Im σ/σ0 = x/(1+x^2)</span>, where <span style="font-family:var(--mono)">x = ωτ</span>.
          </figcaption>
        </figure>

        <details>
          <summary>Optional note: connection to Maxwell operators (∇·, ∇×)</summary>
          <p class="muted">
            In full electromagnetics, σ(ω) enters Ampère–Maxwell law:
            <span style="font-family:var(--mono)">∇×H = J + ∂D/∂t</span> with <span style="font-family:var(--mono)">J = σ(ω)E</span>.
            Combining with <span style="font-family:var(--mono)">∇×E = −∂B/∂t</span> yields wave equations involving the Laplacian <span style="font-family:var(--mono)">∇²</span>.
            Here we focused on the local material response (constitutive relation) that would be inserted into those PDEs.
          </p>
        </details>

        <a class="toplink" href="#top">Back to top</a>
      </section>

      <section id="p5">
        <h2>PART 5 — Optional Plot Guide (ONLY IF A PLOT EXISTS)</h2>

        <h3>What the plot shows (and why it’s useful)</h3>
        <ul>
          <li>The plot visualizes how conduction transitions from mostly resistive (<span class="muted">Re σ ≈ 1</span>) at low <span class="muted">ωτ</span> to mostly reactive at higher <span class="muted">ωτ</span>.</li>
          <li><span class="muted">Re σ/σ0</span> decays as <span class="muted">1/(1+(ωτ)^2)</span>, showing reduced dissipative loss at high frequency.</li>
          <li><span class="muted">Im σ/σ0</span> rises from 0, peaks near <span class="muted">ωτ=1</span>, then decays ~ <span class="muted">1/(ωτ)</span>, illustrating maximal phase-lag around the crossover.</li>
        </ul>

        <h3>Axes and units</h3>
        <ul>
          <li><strong>x-axis:</strong> <span class="muted">x = ωτ</span> (dimensionless)</li>
          <li><strong>y-axis:</strong> normalized conductivity parts <span class="muted">Re σ/σ0</span> and <span class="muted">Im σ/σ0</span> (dimensionless)</li>
        </ul>

        <h3>Example values?</h3>
        <p class="muted">
          No numeric material parameters are needed because the curves depend only on the dimensionless product <span style="font-family:var(--mono)">ωτ</span>.
          This makes the plot universal rather than parameter-specific.
        </p>

        <h3>Features to notice</h3>
        <ul>
          <li><strong>Intercept:</strong> at <span class="muted">ωτ=0</span>, <span class="muted">Re σ/σ0 = 1</span> and <span class="muted">Im σ/σ0 = 0</span>.</li>
          <li><strong>Crossover:</strong> around <span class="muted">ωτ≈1</span>, resistive and reactive effects are comparable.</li>
          <li><strong>Asymptotes:</strong> for large <span class="muted">ωτ</span>, <span class="muted">Re σ/σ0 ~ 1/(ωτ)^2</span> and <span class="muted">Im σ/σ0 ~ 1/(ωτ)</span>.</li>
        </ul>

        <a class="toplink" href="#top">Back to top</a>
      </section>

      <footer>
        <div class="wrap" style="padding:0;">
          <p>
            <strong>Takeaway:</strong> The Drude AC conductivity is the frequency response of a first-order linear relaxation ODE.
            Its universal dependence on <span class="muted">ωτ</span> explains why many materials become less dissipative (in the Drude sense) at sufficiently high frequencies.
          </p>
        </div>
      </footer>
    </article>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite">Copied.</div>

  <script>
    // Copy-to-clipboard (plain text)
    (function(){
      const toast = document.getElementById('toast');
      let tHandle = null;

      function showToast(msg){
        toast.textContent = msg || "Copied.";
        toast.classList.add('show');
        clearTimeout(tHandle);
        tHandle = setTimeout(()=>toast.classList.remove('show'), 1100);
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          showToast("Copied to clipboard.");
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.opacity = '0';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          try{
            document.execCommand('copy');
            showToast("Copied to clipboard.");
          }catch(err){
            showToast("Copy failed (browser blocked).");
          }
          document.body.removeChild(ta);
        }
      }

      document.querySelectorAll('button.copy').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const text = btn.getAttribute('data-copy') || '';
          copyText(text);
        });
      });
    })();

    // Canvas plot: normalized Re and Im parts vs x = ωτ
    (function(){
      const canvas = document.getElementById('drudeCanvas');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      function resize(){
        const dpr = Math.max(1, Math.floor(window.devicePixelRatio || 1));
        const rect = canvas.getBoundingClientRect();
        const w = Math.max(320, Math.floor(rect.width));
        const h = Math.max(260, Math.floor(rect.height));
        canvas.width = w * dpr;
        canvas.height = h * dpr;
        ctx.setTransform(dpr,0,0,dpr,0,0);
        draw(w,h);
      }

      function draw(w,h){
        ctx.clearRect(0,0,w,h);

        // Theme-aware colors from computed styles
        const cs = getComputedStyle(document.documentElement);
        const text = cs.getPropertyValue('--text').trim() || '#e9eef5';
        const muted = cs.getPropertyValue('--muted').trim() || '#b9c3d3';
        const line = cs.getPropertyValue('--line').trim() || 'rgba(255,255,255,.10)';
        const accent = cs.getPropertyValue('--accent').trim() || '#7dd3fc';
        const accent2 = cs.getPropertyValue('--accent2').trim() || '#a7f3d0';

        // Plot margins
        const m = {l:56, r:18, t:34, b:46};
        const pw = w - m.l - m.r;
        const ph = h - m.t - m.b;

        // Axes ranges
        const xMin = 0, xMax = 6; // ωτ from 0 to 6
        const yMin = 0, yMax = 1.05; // normalized values

        function X(x){ return m.l + (x - xMin) / (xMax - xMin) * pw; }
        function Y(y){ return m.t + (1 - (y - yMin)/(yMax - yMin)) * ph; }

        // Background
        ctx.fillStyle = 'rgba(255,255,255,0.02)';
        ctx.fillRect(0,0,w,h);

        // Gridlines & ticks
        ctx.strokeStyle = line;
        ctx.lineWidth = 1;

        // x ticks at 0..6
        ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = muted;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';

        for(let xi=0; xi<=6; xi++){
          const xx = X(xi);
          // grid
          ctx.beginPath();
          ctx.moveTo(xx, m.t);
          ctx.lineTo(xx, m.t+ph);
          ctx.stroke();
          // tick label
          ctx.fillText(String(xi), xx, m.t+ph+8);
        }

        // y ticks at 0,0.25,0.5,0.75,1.0
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        const yTicks = [0,0.25,0.5,0.75,1.0];
        for(const yt of yTicks){
          const yy = Y(yt);
          ctx.beginPath();
          ctx.moveTo(m.l, yy);
          ctx.lineTo(m.l+pw, yy);
          ctx.stroke();
          ctx.fillText(yt.toFixed(2).replace(/\.00$/,''), m.l-8, yy);
        }

        // Axes
        ctx.strokeStyle = 'rgba(255,255,255,0.20)';
        // y-axis
        ctx.beginPath();
        ctx.moveTo(m.l, m.t);
        ctx.lineTo(m.l, m.t+ph);
        ctx.stroke();
        // x-axis
        ctx.beginPath();
        ctx.moveTo(m.l, m.t+ph);
        ctx.lineTo(m.l+pw, m.t+ph);
        ctx.stroke();

        // Title
        ctx.fillStyle = text;
        ctx.textAlign = 'left';
        ctx.textBaseline = 'alphabetic';
        ctx.font = '600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('Normalized Drude Conductivity vs x = ωτ', m.l, 20);

        // Axis labels
        ctx.fillStyle = muted;
        ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.textAlign = 'center';
        ctx.fillText('x = ωτ (dimensionless)', m.l + pw/2, h - 14);

        // y label (rotated)
        ctx.save();
        ctx.translate(16, m.t + ph/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.fillText('Re σ/σ0 and Im σ/σ0 (dimensionless)', 0, 0);
        ctx.restore();

        // Functions
        function reSigma(x){ return 1/(1+x*x); }
        function imSigma(x){ return x/(1+x*x); }

        // Draw curve helper
        function drawCurve(fn, strokeStyle, dash){
          ctx.save();
          ctx.strokeStyle = strokeStyle;
          ctx.lineWidth = 2;
          if(dash) ctx.setLineDash(dash);
          ctx.beginPath();
          const N = 400;
          for(let i=0;i<=N;i++){
            const x = xMin + (xMax - xMin)*i/N;
            const y = fn(x);
            const xx = X(x), yy = Y(y);
            if(i===0) ctx.moveTo(xx,yy);
            else ctx.lineTo(xx,yy);
          }
          ctx.stroke();
          ctx.restore();
        }

        drawCurve(reSigma, accent, null);
        drawCurve(imSigma, accent2, [6,4]);

        // Legend
        const lx = m.l + pw - 180;
        const ly = m.t + 10;

        ctx.save();
        ctx.fillStyle = 'rgba(0,0,0,0.18)';
        ctx.strokeStyle = line;
        ctx.lineWidth = 1;
        roundRect(ctx, lx, ly, 170, 56, 12);
        ctx.fill();
        ctx.stroke();

        ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = text;
        ctx.textAlign = 'left';
        ctx.textBaseline = 'middle';

        // Re
        ctx.strokeStyle = accent;
        ctx.lineWidth = 2;
        ctx.setLineDash([]);
        ctx.beginPath();
        ctx.moveTo(lx+12, ly+18);
        ctx.lineTo(lx+40, ly+18);
        ctx.stroke();
        ctx.fillText('Re σ/σ0 = 1/(1+x²)', lx+48, ly+18);

        // Im
        ctx.strokeStyle = accent2;
        ctx.lineWidth = 2;
        ctx.setLineDash([6,4]);
        ctx.beginPath();
        ctx.moveTo(lx+12, ly+38);
        ctx.lineTo(lx+40, ly+38);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillText('Im σ/σ0 = x/(1+x²)', lx+48, ly+38);

        ctx.restore();

        // Helper: rounded rectangle
        function roundRect(c, x, y, ww, hh, rr){
          const r = Math.min(rr, ww/2, hh/2);
          c.beginPath();
          c.moveTo(x+r, y);
          c.arcTo(x+ww, y, x+ww, y+hh, r);
          c.arcTo(x+ww, y+hh, x, y+hh, r);
          c.arcTo(x, y+hh, x, y, r);
          c.arcTo(x, y, x+ww, y, r);
          c.closePath();
        }
      }

      window.addEventListener('resize', resize, {passive:true});
      resize();
    })();
  </script>
</body>
</html>
