<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title>Chemical Potential of a 2D Fermi Gas — Full Derivation (Math-Physics + Applied)</title>
  <style>
    :root{
      --bg:#0b0d10;
      --panel:#11151b;
      --panel2:#0f1318;
      --text:#e9eef7;
      --muted:#a9b4c4;
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 14px 40px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:24px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --maxw: 1200px;
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg:#f7f9fc;
        --panel:#ffffff;
        --panel2:#f3f6fb;
        --text:#101827;
        --muted:#4b5563;
        --line:rgba(16,24,39,.12);
        --shadow: 0 14px 40px rgba(16,24,39,.12);
      }
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 600px at 20% -10%, rgba(110,231,255,.12), transparent 60%),
                  radial-gradient(900px 500px at 120% 10%, rgba(167,139,250,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.6;
    }

    header{
      position:relative;
      padding: clamp(18px, 2.6vw, 34px) 18px 16px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(to bottom, rgba(0,0,0,.18), transparent);
    }

    .wrap{max-width:var(--maxw); margin:0 auto; display:grid; grid-template-columns: 320px 1fr; gap:18px; padding: 18px;}
    @media (max-width: 980px){
      .wrap{grid-template-columns:1fr; }
    }

    .title{
      max-width:var(--maxw);
      margin:0 auto;
      padding: 0 18px;
    }

    h1{
      margin: 8px 0 8px;
      font-size: clamp(22px, 2.2vw, 34px);
      letter-spacing: .2px;
      line-height:1.18;
    }

    .subtitle{
      color:var(--muted);
      max-width: 70ch;
      margin:0 0 6px;
      font-size: clamp(14px, 1.25vw, 16px);
    }

    .badgeRow{
      display:flex; flex-wrap:wrap; gap:10px; margin:12px 0 4px;
    }
    .badge{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      color: var(--muted);
      box-shadow: 0 10px 24px rgba(0,0,0,.10);
      backdrop-filter: blur(10px);
    }

    nav.toc{
      position:sticky;
      top: 14px;
      align-self:start;
      background: linear-gradient(to bottom, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius: var(--radius2);
      padding: 14px 12px;
      box-shadow: var(--shadow);
      overflow:hidden;
      transform: translateZ(0);
    }
    nav.toc:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(600px 220px at 20% 0%, rgba(110,231,255,.16), transparent 60%),
                  radial-gradient(600px 220px at 80% 0%, rgba(167,139,250,.14), transparent 60%);
      opacity:.6; pointer-events:none;
      filter: blur(10px);
    }
    nav.toc > *{position:relative}
    .toc h2{
      margin:0 0 10px;
      font-size: 14px;
      letter-spacing: .08em;
      text-transform: uppercase;
      color: var(--muted);
    }
    .toc a{
      display:block;
      padding: 8px 10px;
      margin: 4px 0;
      border-radius: 12px;
      color: var(--text);
      text-decoration:none;
      border: 1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size: 14px;
    }
    .toc a:hover{
      background: rgba(110,231,255,.10);
      border-color: rgba(110,231,255,.25);
      transform: translateX(2px);
    }

    main{
      display:flex;
      flex-direction:column;
      gap: 16px;
    }

    section, article{
      background: linear-gradient(to bottom, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      padding: clamp(14px, 2vw, 22px);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    section:before, article:before{
      content:"";
      position:absolute; inset:-1px;
      background: radial-gradient(900px 260px at 10% 0%, rgba(110,231,255,.10), transparent 60%),
                  radial-gradient(900px 260px at 90% 0%, rgba(167,139,250,.09), transparent 60%);
      opacity:.35; pointer-events:none;
    }
    section > *, article > *{position:relative}

    h2{
      margin: 0 0 10px;
      font-size: clamp(18px, 1.55vw, 22px);
      line-height:1.25;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 16px;
      line-height:1.25;
      color: var(--text);
    }
    p{margin: 8px 0}
    ul, ol{margin: 8px 0 8px 20px}
    li{margin: 6px 0}
    .muted{color: var(--muted)}
    .grid2{display:grid; grid-template-columns: 1fr 1fr; gap: 14px;}
    @media (max-width: 820px){ .grid2{grid-template-columns:1fr;} }

    .callout{
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(0,0,0,.10);
      padding: 12px 12px;
      margin: 12px 0;
    }
    @media (prefers-color-scheme: light){
      .callout{background: rgba(16,24,39,.04);}
    }
    .callout strong.tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size: 12px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color: var(--muted);
    }
    .dot{width:9px; height:9px; border-radius:999px; display:inline-block; background: var(--accent);}
    .dot.ok{background:var(--ok)}
    .dot.warn{background:var(--warn)}
    .dot.bad{background:var(--bad)}
    .eq{
      font-family: var(--mono);
      background: rgba(0,0,0,.22);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px 12px;
      overflow:auto;
      white-space: pre;
      margin: 10px 0;
    }
    @media (prefers-color-scheme: light){
      .eq{background: rgba(16,24,39,.04);}
    }
    .eqRow{
      display:flex; align-items:stretch; gap:10px; flex-wrap:wrap;
    }
    .btn{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: var(--text);
      border-radius: 14px;
      padding: 10px 12px;
      cursor:pointer;
      font-size: 13px;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      display:inline-flex; gap:10px; align-items:center;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(110,231,255,.10);
      border-color: rgba(110,231,255,.25);
    }
    .btn:active{transform: translateY(0px) scale(0.99)}
    .btn .icon{
      width: 10px; height: 10px; border-radius: 3px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      opacity:.9;
      box-shadow: 0 8px 16px rgba(0,0,0,.16);
    }

    details{
      border:1px dashed var(--line);
      border-radius: var(--radius);
      padding: 10px 12px;
      margin: 12px 0;
      background: rgba(255,255,255,.03);
    }
    details summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 600;
    }

    figure{
      margin: 12px 0 6px;
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(0,0,0,.15);
      overflow:hidden;
    }
    @media (prefers-color-scheme: light){
      figure{background: rgba(16,24,39,.03);}
    }
    figcaption{
      padding: 10px 12px;
      color: var(--muted);
      font-size: 13px;
      border-top:1px solid var(--line);
    }
    canvas{display:block; width:100%; height:320px;}

    .backTop{
      display:inline-flex; align-items:center; gap:10px;
      text-decoration:none;
      color: var(--text);
      border:1px solid var(--line);
      border-radius: 999px;
      padding: 8px 12px;
      background: rgba(255,255,255,.04);
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .backTop:hover{
      transform: translateY(-1px);
      background: rgba(167,139,250,.10);
      border-color: rgba(167,139,250,.25);
    }

    footer{
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 12px 18px 28px;
      color: var(--muted);
      font-size: 13px;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      nav.toc{display:none}
      .wrap{grid-template-columns:1fr; padding:0}
      section, article{box-shadow:none; border:1px solid #ccc; background:#fff; page-break-inside:avoid}
      header{border-bottom:1px solid #ccc; background:#fff}
      .btn{display:none}
      .eq{background:#f6f6f6}
      a{color:#000; text-decoration:none}
      .pagebreak{break-before:page;}
    }
  </style>
</head>

<body>
  <a id="top"></a>
  <header>
    <div class="title">
      <h1>Chemical Potential of a 2D Fermi Gas: Exact Closed Form</h1>
      <p class="subtitle">
        We derive the chemical potential <span class="muted">μ(T)</span> for a two-dimensional ideal Fermi gas with constant density of states,
        emphasizing both physical intuition and mathematically rigorous steps.
      </p>
      <div class="badgeRow">
        <span class="badge">Statistical Mechanics</span>
        <span class="badge">2D Electron Gas</span>
        <span class="badge">Mathematical Physics</span>
        <span class="badge">Applied / Industry Lens</span>
      </div>
    </div>
  </header>

  <div class="wrap">
    <nav class="toc" aria-label="Table of contents">
      <h2>Contents</h2>
      <a href="#qs">Quick Summary</a>
      <a href="#p0">PART 0 — Concept Primer</a>
      <a href="#p0b">PART 0B — Industry & Applied Physics</a>
      <a href="#p1">PART 1 — Problem Analysis</a>
      <a href="#p2">PART 2 — Strategy & Tips</a>
      <a href="#p3">PART 3 — Full Solution</a>
      <a href="#p4">PART 4 — Deeper Understanding</a>
      <a href="#p5">PART 5 — Optional Plot Guide</a>
      <div style="height:8px"></div>
      <a class="backTop" href="#top" title="Back to top"><span class="icon" aria-hidden="true"></span>Back to top</a>
    </nav>

    <main>
      <section id="qs">
        <h2>Quick Summary</h2>
        <ul>
          <li>Goal: show the chemical potential <span class="muted">μ(T)</span> of a <b>2D ideal Fermi gas</b> in terms of particle areal density <span class="muted">n</span>.</li>
          <li>Key physics idea: in 2D the <b>density of states is constant</b> (energy-independent) for a free parabolic band.</li>
          <li>Governing relation: number equation from grand canonical ensemble,
            <span class="muted">n = ∫ D(ε) f(ε; μ,T) dε</span>, with Fermi–Dirac <span class="muted">f</span>.
          </li>
          <li>Given: <span class="muted">D(ε)=m/(πħ²)</span> per unit area (constant DOS).</li>
          <li>Main mathematical move: evaluate an integral exactly by a substitution and a logarithm identity (no approximations needed).</li>
          <li>Result (symbolic): <b>μ(T) = k<sub>B</sub>T ln( exp(πħ² n/(m k<sub>B</sub>T)) − 1 )</b>.</li>
          <li>Physical meaning: as <span class="muted">T→0</span>, μ approaches the 2D Fermi energy; as <span class="muted">T≫T<sub>F</sub></span>, μ becomes negative (classical regime).</li>
          <li>We also present a dimensionless form using <span class="muted">T<sub>F</sub> = πħ² n/(m k<sub>B</sub>)</span>, and a single static plot of <span class="muted">μ/(k<sub>B</sub>T<sub>F</sub>)</span> vs <span class="muted">T/T<sub>F</sub></span>.</li>
        </ul>

        <div class="callout">
          <strong class="tag"><span class="dot ok"></span>Key equations (copy-ready)</strong>
          <div class="eqRow">
            <div class="eq" id="eqKey1">n = ∫_0^∞ D(ε) f(ε; μ,T) dε,   f(ε; μ,T)=1/(exp((ε-μ)/(k_B T))+1)</div>
            <button class="btn" data-copy="#eqKey1"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>
          <div class="eqRow">
            <div class="eq" id="eqKey2">D(ε)=m/(π ħ^2)  (2D free electron DOS per unit area; constant in ε)</div>
            <button class="btn" data-copy="#eqKey2"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>
        </div>
      </section>

      <section id="p0">
        <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

        <div class="grid2">
          <div>
            <h3>Core definitions (symbols + SI units)</h3>
            <ul>
              <li><b>n</b>: electron number density per area (areal density), units <span class="muted">m⁻²</span>.</li>
              <li><b>T</b>: temperature, units <span class="muted">K</span>.</li>
              <li><b>μ(T)</b>: chemical potential, units <span class="muted">J</span> (often expressed as eV).</li>
              <li><b>k<sub>B</sub></b>: Boltzmann constant, units <span class="muted">J·K⁻¹</span>.</li>
              <li><b>ħ</b>: reduced Planck constant, units <span class="muted">J·s</span>.</li>
              <li><b>m</b>: (effective) electron mass in the band, units <span class="muted">kg</span>.</li>
              <li><b>ε</b>: single-particle energy, units <span class="muted">J</span>.</li>
              <li><b>D(ε)</b>: density of one-particle states per energy per area, units <span class="muted">(J·m²)⁻¹</span>.</li>
            </ul>
          </div>

          <div>
            <h3>Physical meaning (intuition)</h3>
            <ul>
              <li><b>μ</b> sets the “energy level” around which fermions fill states at finite temperature.</li>
              <li>At <b>T=0</b>, all states up to the Fermi energy are filled: μ(0)=ε<sub>F</sub>.</li>
              <li>At <b>finite T</b>, occupation is smeared over an energy window ~<span class="muted">k<sub>B</sub>T</span>.</li>
              <li>In 2D with a parabolic band, <b>D(ε) is constant</b>, making the number equation integrable in closed form.</li>
            </ul>
          </div>
        </div>

        <div class="callout">
          <strong class="tag"><span class="dot"></span>Validity conditions / assumptions</strong>
          <ul>
            <li>Non-interacting (ideal) Fermi gas; particles obey Pauli exclusion.</li>
            <li>2D motion (confinement in one direction): energies are <b>ε = ħ²k²/(2m)</b> in the plane.</li>
            <li>Grand canonical equilibrium at temperature <span class="muted">T</span>.</li>
            <li>Continuum of states (thermodynamic limit): large area <span class="muted">A→∞</span>.</li>
            <li>No external potential in-plane (free electron model); uniform system.</li>
          </ul>
        </div>

        <h3>Why the 2D density of states is constant</h3>
        <p>
          For a 2D parabolic dispersion <span class="muted">ε(k)=ħ²k²/(2m)</span>, the number of states with wavevector magnitude less than <span class="muted">k</span>
          is proportional to the area of a disk in <span class="muted">k</span>-space (<span class="muted">∝ k²</span>). Since <span class="muted">ε ∝ k²</span>, it follows
          that the cumulative number of states <span class="muted">N(≤ε)</span> is proportional to <span class="muted">ε</span>, and therefore <span class="muted">D(ε)=dN/dε</span>
          is constant.
        </p>

        <details>
          <summary>Optional deeper note: mathematical model for states in a 2D box</summary>
          <p>
            Consider a square of side <span class="muted">L</span>, area <span class="muted">A=L²</span>, with periodic boundary conditions:
            <span class="muted">ψ(x+L,y)=ψ(x,y)</span>, <span class="muted">ψ(x,y+L)=ψ(x,y)</span>. The free-particle Hamiltonian is the Laplacian eigenproblem
            <span class="muted">Hψ = (-(ħ²/2m)∇²)ψ = εψ</span> with <span class="muted">∇² = ∂²/∂x² + ∂²/∂y²</span>.
            Eigenfunctions are plane waves <span class="muted">ψ_k(r)=A^{-1/2} e^{i k·r}</span> with quantized
            <span class="muted">k = (2π/L)(n_x, n_y)</span>, <span class="muted">n_x,n_y∈ℤ</span>.
            In the thermodynamic limit, sums over <span class="muted">k</span> become integrals using state density <span class="muted">A/(2π)²</span> in <span class="muted">k</span>-space.
          </p>
        </details>

        <h3>Mini intuition examples (conceptual)</h3>
        <ul>
          <li><b>3D vs 2D:</b> In 3D, <span class="muted">D(ε)∝√ε</span>; in 2D, <span class="muted">D(ε)=const</span>; in 1D, <span class="muted">D(ε)∝1/√ε</span>.</li>
          <li><b>T→0:</b> the Fermi function becomes a step function; μ equals the Fermi energy set by density.</li>
          <li><b>High T:</b> the system approaches classical behavior; μ becomes negative to keep density fixed.</li>
        </ul>

        <div class="callout">
          <strong class="tag"><span class="dot warn"></span>What to watch for (pitfalls)</strong>
          <ul>
            <li>Be consistent with the DOS definition: per area and including any degeneracy factors.</li>
            <li>Lower limit of energy: for a free electron band, take <span class="muted">ε≥0</span> measured from the band edge.</li>
            <li>Do not assume “μ≈ε<sub>F</sub>” at finite T in 2D; the exact expression differs and can become negative.</li>
            <li>Check units: the argument inside a logarithm must be dimensionless.</li>
          </ul>
        </div>
      </section>

      <section id="p0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <h3>Where this appears in industry (concrete areas)</h3>
        <ul>
          <li><b>Semiconductor heterostructures (2DEGs):</b> GaAs/AlGaAs, InGaAs, etc. used in HEMTs and RF front-ends.</li>
          <li><b>2D materials:</b> graphene (with different dispersion), MoS₂ and related TMDs (often approximately parabolic near band edges).</li>
          <li><b>Quantum wells & infrared devices:</b> subband engineering in quantum cascade lasers and IR detectors.</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><b>Thresholds & capacitance:</b> μ relates carrier density to electrostatic potential (quantum capacitance).</li>
          <li><b>Mobility and transport:</b> scattering rates depend on occupied states near μ; temperature dependence impacts performance.</li>
          <li><b>Reliability & heat:</b> thermal shifts in μ affect leakage currents and power dissipation envelopes.</li>
          <li><b>Manufacturability:</b> density control via doping/gating needs accurate n↔μ conversion for process windows.</li>
        </ul>

        <h3>Typical measurement / validation methods</h3>
        <ul>
          <li>Hall measurements to obtain <span class="muted">n(T)</span> and mobility; compare to model-based μ(T).</li>
          <li>Capacitance–voltage (C–V) profiling in quantum wells to infer DOS and quantum capacitance.</li>
          <li>Shubnikov–de Haas oscillations (low T) to extract effective mass and 2D density.</li>
        </ul>

        <h3>Design trade-offs & non-idealities</h3>
        <ul>
          <li>Real DOS may deviate due to non-parabolicity, disorder broadening, subband quantization, or interactions.</li>
          <li>Effective mass <span class="muted">m</span> can be anisotropic or density-dependent.</li>
          <li>Finite thickness and multiple subbands: the “2D” formula becomes a sum over subbands.</li>
        </ul>

        <div class="callout">
          <strong class="tag"><span class="dot"></span>From lab to product</strong>
          <p class="muted">
            Engineers often keep the same mathematical backbone (grand canonical number equation) but replace the ideal constant DOS
            with a measured or computed DOS, add degeneracy factors, include subband energies, and sometimes incorporate exchange–correlation
            corrections (density-functional-inspired) when designing ultra-scaled devices.
          </p>
        </div>
      </section>

      <section id="p1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>Restate the problem</h3>
        <p>
          For an ideal (non-interacting) 2D Fermi gas of electrons, show that the chemical potential satisfies
          a closed-form expression in terms of temperature <span class="muted">T</span> and areal density <span class="muted">n</span>.
          You are told that for a free electron in 2D, the density of one-particle states per area is energy-independent:
          <span class="muted">D(ε)=m/(πħ²)</span>.
        </p>

        <h3>Given</h3>
        <ul>
          <li><span class="muted">n</span>: electrons per unit area.</li>
          <li><span class="muted">T</span>, <span class="muted">k<sub>B</sub></span>, <span class="muted">ħ</span>, <span class="muted">m</span>.</li>
          <li><span class="muted">D(ε)=m/(πħ²)</span> (per unit area).</li>
        </ul>

        <h3>Unknown</h3>
        <ul>
          <li><span class="muted">μ(T)</span> as a function of <span class="muted">n</span> and <span class="muted">T</span>.</li>
        </ul>

        <h3>Relevant principles and why they apply</h3>
        <ul>
          <li><b>Grand canonical ensemble:</b> particle number fixed on average, controlled by μ; appropriate for deriving μ(n,T).</li>
          <li><b>Fermi–Dirac statistics:</b> electrons are fermions.</li>
          <li><b>Thermodynamic limit:</b> convert sums over states to integrals using DOS.</li>
        </ul>

        <div class="callout">
          <strong class="tag"><span class="dot ok"></span>Mathematical model (explicit)</strong>
          <ul>
            <li><b>Domain:</b> 2D spatial region of large area <span class="muted">A</span> (eventually <span class="muted">A→∞</span>).</li>
            <li><b>Coordinates:</b> <span class="muted">r=(x,y)</span> in plane; <span class="muted">k=(k_x,k_y)</span> reciprocal space.</li>
            <li><b>Hamiltonian operator:</b> <span class="muted">H = -(ħ²/2m)∇²</span> with <span class="muted">∇²=∂²/∂x²+∂²/∂y²</span>.</li>
            <li><b>Boundary conditions:</b> typically periodic (or hard-wall); choice does not affect DOS in thermodynamic limit.</li>
            <li><b>Spectrum:</b> <span class="muted">ε=ħ²k²/(2m)</span>, continuous as <span class="muted">A→∞</span>.</li>
            <li><b>Stat mech constraint:</b> fixed areal density <span class="muted">n = N/A</span> at temperature <span class="muted">T</span>.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <ol>
          <li><b>Direct number integral (best here):</b> Use <span class="muted">n=∫D f dε</span> with constant DOS; integral is exactly solvable. <span class="muted">(Fast, exact.)</span></li>
          <li><b>Grand potential method:</b> Compute <span class="muted">Ω(μ,T)</span> then <span class="muted">n=-(1/A)(∂Ω/∂μ)_T</span>. <span class="muted">(Elegant, more machinery.)</span></li>
          <li><b>Sommerfeld expansion:</b> Approximate at low T; but problem asks for an exact expression, so it’s not ideal.</li>
        </ol>

        <p><b>Chosen approach:</b> the direct number integral, because constant DOS makes the integral elementary and yields the desired closed form without approximations.</p>
      </section>

      <section id="p2">
        <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

        <ol>
          <li><b>Write the number equation</b>: <span class="muted">n=∫_0^∞ D(ε) f(ε;μ,T)dε</span>. (Connects density and μ.)</li>
          <li><b>Insert constant DOS</b>: factor out <span class="muted">D</span>. (Simplifies integral.)</li>
          <li><b>Non-dimensionalize</b>: set <span class="muted">x=(ε-μ)/(k_BT)</span>. (Makes integral standard.)</li>
          <li><b>Evaluate the integral exactly</b> using an antiderivative of <span class="muted">1/(e^x+1)</span>. (No “magic jumps”.)</li>
          <li><b>Solve algebraically for μ</b>. (Isolate μ in terms of n and T.)</li>
          <li><b>Sanity checks</b>: units, <span class="muted">T→0</span> limit, high-T limit, sign behavior.</li>
          <li><b>Optional dimensionless form</b> via <span class="muted">T_F</span> to interpret scaling cleanly.</li>
        </ol>

        <div class="callout">
          <strong class="tag"><span class="dot warn"></span>Common mistakes</strong>
          <ul>
            <li>Forgetting the lower energy limit <span class="muted">ε=0</span> (band edge) when changing variables.</li>
            <li>Dropping the logarithm constant: the integral yields a <span class="muted">ln(1+e^{βμ})</span> structure.</li>
            <li>Mixing DOS conventions (with/without spin). Here we follow the problem’s stated <span class="muted">D(ε)=m/(πħ²)</span>.</li>
            <li>Putting dimensioned quantities inside <span class="muted">ln()</span>. Always ensure the argument is dimensionless.</li>
          </ul>
        </div>
      </section>

      <article id="p3">
        <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

        <h3>Qualitative expectation (before calculating)</h3>
        <ul>
          <li>At <span class="muted">T=0</span>, μ should equal the 2D Fermi energy <span class="muted">ε_F</span> set by density.</li>
          <li>At higher <span class="muted">T</span>, thermal smearing allows some occupation above μ, so μ must adjust downward to keep <span class="muted">n</span> fixed.</li>
          <li>In the classical limit, μ becomes negative (relative to band edge) because occupancy is dilute.</li>
        </ul>

        <div class="callout">
          <strong class="tag"><span class="dot ok"></span>Step 1: Number equation (grand canonical)</strong>
          <p>
            In equilibrium, the mean occupation of a one-particle state of energy <span class="muted">ε</span> is
          </p>
          <div class="eq" id="eqFD">f(ε; μ,T) = 1 / ( exp((ε - μ)/(k_B T)) + 1 )</div>
          <div class="eqRow">
            <button class="btn" data-copy="#eqFD"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>
          <p>
            The areal density is obtained by integrating the DOS against this occupation:
          </p>
          <div class="eq" id="eqN">n = ∫_0^∞ D(ε) f(ε; μ,T) dε</div>
          <div class="eqRow">
            <button class="btn" data-copy="#eqN"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>
          <p class="muted">
            Why this is valid: in the thermodynamic limit, the discrete sum over eigenstates becomes an integral over energy with weight D(ε).
            Linearity of expectation allows summing occupations; uniformity makes n = N/A.
          </p>
        </div>

        <div class="callout">
          <strong class="tag"><span class="dot ok"></span>Step 2: Insert constant 2D DOS</strong>
          <p>
            The problem states (per unit area):
          </p>
          <div class="eq" id="eqDOS">D(ε) = m / (π ħ^2)  ≡ D0  (constant in ε)</div>
          <div class="eqRow">
            <button class="btn" data-copy="#eqDOS"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>
          <p>
            Therefore
          </p>
          <div class="eq" id="eqN2">n = D0 ∫_0^∞ 1 / ( exp((ε - μ)/(k_B T)) + 1 ) dε</div>
          <div class="eqRow">
            <button class="btn" data-copy="#eqN2"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>
        </div>

        <div class="callout">
          <strong class="tag"><span class="dot"></span>Step 3: Nondimensionalization / change of variables</strong>
          <p>
            Define the dimensionless variable
            <span class="muted">x = (ε - μ)/(k_B T)</span>. Then
          </p>
          <ul>
            <li><span class="muted">ε = μ + k_B T x</span></li>
            <li><span class="muted">dε = k_B T dx</span></li>
            <li>When <span class="muted">ε = 0</span>, the lower limit becomes <span class="muted">x_0 = (0 - μ)/(k_B T) = -μ/(k_B T)</span></li>
            <li>When <span class="muted">ε → ∞</span>, <span class="muted">x → ∞</span></li>
          </ul>
          <p>
            Substitute into the integral:
          </p>
          <div class="eq" id="eqSub">n = D0 ∫_{x0}^{∞} [1/(e^x + 1)] (k_B T) dx
  = D0 k_B T ∫_{-μ/(k_B T)}^{∞} dx /(e^x + 1)</div>
          <div class="eqRow">
            <button class="btn" data-copy="#eqSub"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>
          <p class="muted">
            Why this step is valid: the substitution is a smooth bijection between ε∈[0,∞) and x∈[x0,∞) for fixed μ,T (with T&gt;0),
            preserving integral value by standard change-of-variables theorem.
          </p>
        </div>

        <div class="callout">
          <strong class="tag"><span class="dot ok"></span>Step 4: Evaluate the integral exactly (no approximations)</strong>
          <p>
            We need an antiderivative of
            <span class="muted">1/(e^x+1)</span>. Observe:
          </p>
          <div class="eq" id="eqAnti">d/dx [ x - ln(1 + e^x) ] = 1 - (e^x/(1+e^x)) = 1/(1+e^x)</div>
          <div class="eqRow">
            <button class="btn" data-copy="#eqAnti"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>
          <p>
            Therefore
          </p>
          <div class="eq" id="eqInt">∫ dx /(1+e^x) = x - ln(1+e^x) + C</div>
          <div class="eqRow">
            <button class="btn" data-copy="#eqInt"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>

          <p>Apply the bounds from <span class="muted">x_0 = -μ/(k_B T)</span> to <span class="muted">∞</span>:</p>
          <div class="eq" id="eqBound">I ≡ ∫_{x0}^{∞} dx /(1+e^x)
= [x - ln(1+e^x)]_{x0}^{∞}</div>
          <p>
            Evaluate the upper limit carefully. As <span class="muted">x→∞</span>, we have
            <span class="muted">ln(1+e^x)=x + ln(1+e^{-x}) → x</span>, so
            <span class="muted">x - ln(1+e^x) → 0</span>.
          </p>
          <div class="eq" id="eqUpper">lim_{x→∞} (x - ln(1+e^x)) = 0</div>

          <p>
            Thus
          </p>
          <div class="eq" id="eqI">I = 0 - [x0 - ln(1+e^{x0})]
  = -x0 + ln(1+e^{x0})</div>

          <p>
            Now insert <span class="muted">x0 = -μ/(k_B T)</span>:
          </p>
          <div class="eq" id="eqILog">I = μ/(k_B T) + ln(1 + e^{-μ/(k_B T)})</div>

          <p>
            This can be simplified into a single logarithm using the identity:
          </p>
          <div class="eq" id="eqId">a + ln(1+e^{-a}) = ln(e^a) + ln(1+e^{-a}) = ln(e^a(1+e^{-a})) = ln(1+e^a)</div>

          <p>
            With <span class="muted">a = μ/(k_B T)</span> we get
          </p>
          <div class="eq" id="eqI2">I = ln(1 + e^{μ/(k_B T)})</div>

          <p>
            Therefore the density becomes
          </p>
          <div class="eq" id="eqnlog">n = D0 k_B T ln(1 + e^{μ/(k_B T)})</div>
          <div class="eqRow">
            <button class="btn" data-copy="#eqnlog"><span class="icon" aria-hidden="true"></span>Copy equation</button>
          </div>
        </div>

        <div class="callout">
          <strong class="tag"><span class="dot ok"></span>Step 5: Solve algebraically for μ(T)</strong>
          <p>
            Start from
            <span class="muted">n = D0 k_B T ln(1 + e^{μ/(k_B T)})</span>.
            Divide by <span class="muted">D0 k_B T</span>:
          </p>
          <div class="eq" id="eqSolve1">n/(D0 k_B T) = ln(1 + e^{μ/(k_B T)})</div>

          <p>Exponentiate both sides (valid because exp is monotone):</p>
          <div class="eq" id="eqSolve2">exp( n/(D0 k_B T) ) = 1 + e^{μ/(k_B T)}</div>

          <p>Rearrange:</p>
          <div class="eq" id="eqSolve3">e^{μ/(k_B T)} = exp( n/(D0 k_B T) ) - 1</div>

          <p>Take the natural log (valid because RHS&gt;0 for n&gt;0):</p>
          <div class="eq" id="eqSolve4">μ/(k_B T) = ln( exp( n/(D0 k_B T) ) - 1 )</div>

          <p>Multiply by <span class="muted">k_B T</span> and insert <span class="muted">D0 = m/(πħ²)</span>:</p>
          <div class="eq" id="eqFinal">μ(T) = k_B T ln( exp( (π ħ^2 n)/(m k_B T) ) - 1 )</div>
          <div class="eqRow">
            <button class="btn" data-copy="#eqFinal"><span class="icon" aria-hidden="true"></span>Copy final equation</button>
            <button class="btn" data-copy="#finalAnswerPlain"><span class="icon" aria-hidden="true"></span>Copy final answer (plain text)</button>
          </div>

          <div class="eq" id="finalAnswerPlain">FINAL RESULT:
μ(T) = k_B T * ln( exp( (π ħ^2 n)/(m k_B T) ) - 1 )
(with D(ε)=m/(π ħ^2) per unit area and ε measured from the band edge ε=0).</div>
        </div>

        <h3>Sanity checks (units, limits, interpretation)</h3>

        <div class="grid2">
          <div class="callout">
            <strong class="tag"><span class="dot ok"></span>Dimensional analysis</strong>
            <p>
              The exponent argument must be dimensionless:
            </p>
            <div class="eq">π ħ^2 n /(m k_B T)</div>
            <p class="muted">
              Check: ħ² has units (J·s)² = J²·s². Divide by m (kg) gives J²·s²/kg.
              Multiply by n (m⁻²). Using J = kg·m²·s⁻², we get:
              ħ²/m ~ (kg²·m⁴·s⁻⁴ · s²)/kg = kg·m⁴·s⁻² = J·m².
              Then (ħ²/m)·n ~ (J·m²)·m⁻² = J.
              Divide by k_B T (J) → dimensionless. ✅
            </p>
            <p>
              Then μ has units <span class="muted">k_B T × (dimensionless) = J</span>. ✅
            </p>
          </div>

          <div class="callout">
            <strong class="tag"><span class="dot"></span>Low-temperature limit (T → 0)</strong>
            <p>
              Define the 2D Fermi temperature:
            </p>
            <div class="eq">T_F ≡ (π ħ^2 n)/(m k_B)</div>
            <p>
              Then
            </p>
            <div class="eq">μ(T) = k_B T ln( exp(T_F/T) - 1 )</div>
            <p>
              As <span class="muted">T→0</span>, <span class="muted">T_F/T → ∞</span>, so
              <span class="muted">exp(T_F/T) - 1 ≈ exp(T_F/T)</span>, hence
            </p>
            <div class="eq">μ(T) ≈ k_B T · (T_F/T) = k_B T_F = π ħ^2 n / m</div>
            <p>
              So <span class="muted">μ(0)=ε_F=πħ²n/m</span> (consistent with 2D free Fermi gas). ✅
            </p>
          </div>
        </div>

        <div class="grid2">
          <div class="callout">
            <strong class="tag"><span class="dot warn"></span>High-temperature (classical) limit</strong>
            <p>
              For <span class="muted">T ≫ T_F</span>, the exponent is small:
              <span class="muted">x = T_F/T ≪ 1</span>. Use
              <span class="muted">exp(x)-1 ≈ x</span>.
            </p>
            <div class="eq">μ(T) ≈ k_B T ln(T_F/T)</div>
            <p>
              Since <span class="muted">T_F/T &lt; 1</span>, the log is negative, so μ becomes negative. ✅
            </p>
          </div>

          <div class="callout">
            <strong class="tag"><span class="dot ok"></span>Sign / physical interpretation</strong>
            <p>
              μ is measured relative to the band edge (ε=0). At high T, electrons are thermally spread over many states; to keep the
              <span class="muted">total density n</span> fixed, the system lowers μ below the band edge so the Fermi function stays small overall.
            </p>
          </div>
        </div>

        <div class="callout">
          <strong class="tag"><span class="dot"></span>Math Insight (interpretation as a mathematical object)</strong>
          <p>
            The core equation
            <span class="muted">n = D0 k_B T ln(1 + e^{μ/(k_B T)})</span>
            is an <b>invertible monotone map</b> from μ to n at fixed T:
          </p>
          <ul>
            <li><b>Monotonicity:</b> differentiate with respect to μ:
              <span class="muted">∂n/∂μ = D0 /(1 + e^{-μ/(k_B T)}) &gt; 0</span>, so a unique μ exists for each n.</li>
            <li><b>Conservation form:</b> it enforces the constraint “fixed average number” in the grand canonical ensemble.</li>
            <li><b>Special 2D simplification:</b> constant DOS converts the Fermi integral into an elementary logarithm (no polylogarithms needed).</li>
          </ul>
        </div>

        <h3>Optional: one static plot (dimensionless scaling)</h3>
        <p class="muted">
          This problem is symbolic, but one plot helps build intuition: how μ decreases with T at fixed density, in a fully nondimensional way.
        </p>

        <figure>
          <canvas id="plot" width="900" height="420" aria-label="Plot of dimensionless chemical potential vs dimensionless temperature"></canvas>
          <figcaption>
            Dimensionless plot (no material numbers needed): y = μ/(k<sub>B</sub>T<sub>F</sub>) vs x = T/T<sub>F</sub>, where
            T<sub>F</sub> = πħ²n/(m k<sub>B</sub>). Curve shows μ → k<sub>B</sub>T<sub>F</sub> as T→0 and μ becomes negative for sufficiently large T.
          </figcaption>
        </figure>

      </article>

      <section id="p4">
        <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

        <h3>Re-interpret the final formula</h3>
        <p>
          Write the result using <span class="muted">T_F = πħ²n/(m k_B)</span>:
        </p>
        <div class="eq" id="eqTF">μ(T) = k_B T ln( exp(T_F/T) - 1 )</div>
        <div class="eqRow">
          <button class="btn" data-copy="#eqTF"><span class="icon" aria-hidden="true"></span>Copy equation</button>
        </div>
        <p>
          This shows the dependence cleanly:
        </p>
        <ul>
          <li><b>Density n:</b> enters only through <span class="muted">T_F ∝ n/m</span>.</li>
          <li><b>Effective mass m:</b> larger m lowers <span class="muted">T_F</span> and thus lowers μ at a given T and n.</li>
          <li><b>Temperature T:</b> appears both as a prefactor and inside the exponent ratio <span class="muted">T_F/T</span>, producing strong nonlinear behavior.</li>
        </ul>

        <h3>Parameter dependence (qualitative + quick quantitative cues)</h3>
        <ul>
          <li>Increasing <span class="muted">n</span> increases <span class="muted">T_F</span> linearly, pushing μ upward at all T.</li>
          <li>Increasing <span class="muted">m</span> decreases <span class="muted">T_F</span>, pushing μ downward.</li>
          <li>For fixed <span class="muted">T_F</span>, increasing <span class="muted">T</span> decreases μ, eventually making it negative.</li>
        </ul>

        <details>
          <summary>Alternative derivation idea (brief but meaningful): grand potential Ω</summary>
          <p>
            The grand potential per area for ideal fermions can be written as
            <span class="muted">Ω/A = -k_B T ∫_0^∞ D(ε) ln(1 + e^{(μ-ε)/(k_B T)}) dε</span>.
            Then <span class="muted">n = - (1/A) (∂Ω/∂μ)_T</span>.
            Differentiating under the integral sign (justified by dominated convergence since the integrand decays exponentially at large ε)
            returns exactly <span class="muted">n=∫D f dε</span>, and with constant DOS the same logarithm emerges.
          </p>
        </details>

        <div class="callout">
          <strong class="tag"><span class="dot ok"></span>Concept check (self-test with answers)</strong>
          <ul>
            <li><b>Q:</b> Why is D(ε) constant in 2D for ε=ħ²k²/(2m)? <b>A:</b> Because the k-space area scales as k² and ε∝k², so N(≤ε)∝ε ⇒ D=dN/dε=const.</li>
            <li><b>Q:</b> What happens to μ as T→0? <b>A:</b> μ→ε_F=πħ²n/m.</li>
            <li><b>Q:</b> Why can μ become negative at high T? <b>A:</b> To keep n fixed when many high-energy states become thermally accessible; lowering μ reduces occupation overall.</li>
            <li><b>Q:</b> Is the solution approximate? <b>A:</b> No—given constant DOS and ε≥0, the integral is exact.</li>
          </ul>
        </div>
      </section>

      <section id="p5">
        <h2>PART 5 — Optional Plot Guide (ONLY IF A PLOT EXISTS)</h2>

        <h3>What the plot shows and why it helps</h3>
        <ul>
          <li>The plot visualizes the temperature dependence of μ at fixed density without choosing any specific material.</li>
          <li>Using dimensionless variables reveals universal behavior for the 2D ideal Fermi gas with constant DOS.</li>
        </ul>

        <h3>Axes and units</h3>
        <ul>
          <li>x-axis: <span class="muted">T/T_F</span> (dimensionless).</li>
          <li>y-axis: <span class="muted">μ/(k_B T_F)</span> (dimensionless).</li>
        </ul>

        <h3>Example values?</h3>
        <p>
          None were needed: the curve is universal in terms of <span class="muted">T/T_F</span>.
        </p>

        <h3>Features to notice</h3>
        <ul>
          <li><b>Low-T plateau:</b> as <span class="muted">T/T_F → 0</span>, the curve approaches 1 (i.e., μ→k<sub>B</sub>T<sub>F</sub>).</li>
          <li><b>Crossover:</b> as T increases, μ decreases smoothly.</li>
          <li><b>Classical trend:</b> at large <span class="muted">T/T_F</span>, μ becomes negative and roughly follows <span class="muted">μ ≈ k_B T ln(T_F/T)</span>.</li>
        </ul>

        <a class="backTop" href="#top"><span class="icon" aria-hidden="true"></span>Back to top</a>
      </section>
    </main>
  </div>

  <footer>
    <p>
      Notes: This derivation follows the problem’s stated 2D DOS <span class="muted">D(ε)=m/(πħ²)</span> per unit area (including whatever degeneracy convention the problem assumes).
      If your course uses an explicit spin degeneracy factor <span class="muted">g_s=2</span>, it would appear as <span class="muted">D→g_s D</span> and modify the formula by replacing
      <span class="muted">n</span> with <span class="muted">n/g_s</span> inside the exponent.
    </p>
  </footer>

  <script>
    // Copy buttons (plain text)
    (function(){
      function copyTextFromSelector(sel){
        const el = document.querySelector(sel);
        if(!el) return false;
        const text = el.textContent.replace(/\n{3,}/g,"\n\n").trim();
        navigator.clipboard.writeText(text);
        return true;
      }
      document.addEventListener('click', (e) => {
        const btn = e.target.closest('[data-copy]');
        if(!btn) return;
        const sel = btn.getAttribute('data-copy');
        const ok = copyTextFromSelector(sel);
        if(ok){
          const prev = btn.textContent;
          btn.textContent = "Copied ✓";
          setTimeout(()=>{ btn.textContent = prev; }, 900);
        }
      });
    })();

    // Canvas plot: y = μ/(kB TF) vs x = T/TF
    (function(){
      const canvas = document.getElementById('plot');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      function f_mu_over_kBTF(x){
        // x = T/TF, y = μ/(kB TF)
        // μ = kB T ln( exp(TF/T) - 1 ) = kB (x TF) ln( exp(1/x) - 1 )
        // y = (μ)/(kB TF) = x * ln( exp(1/x) - 1 )
        // Handle small x carefully: exp(1/x) can overflow.
        if(x <= 0) return 1;
        const inv = 1/x;
        if(inv > 40){ // extremely low T: exp(inv) huge => y ~ 1 (since x*inv=1)
          return 1;
        }
        const ex = Math.exp(inv);
        const inside = ex - 1;
        return x * Math.log(inside);
      }

      function draw(){
        // Responsive + crisp using devicePixelRatio
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const cssW = canvas.clientWidth;
        const cssH = canvas.clientHeight;
        canvas.width = Math.round(cssW * dpr);
        canvas.height = Math.round(cssH * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        // Layout
        const W = cssW, H = cssH;
        const padL = 60, padR = 16, padT = 34, padB = 54;
        const x0 = padL, y0 = H - padB;
        const x1 = W - padR, y1 = padT;
        const plotW = x1 - x0, plotH = y0 - y1;

        // Domain for x
        const xmin = 0.05;
        const xmax = 3.0;

        // Range for y (compute)
        let ymin = Infinity, ymax = -Infinity;
        for(let i=0;i<=600;i++){
          const x = xmin + (xmax-xmin)*i/600;
          const y = f_mu_over_kBTF(x);
          ymin = Math.min(ymin, y);
          ymax = Math.max(ymax, y);
        }
        // Expand a bit
        ymin = Math.min(ymin, -1.2);
        ymax = Math.max(ymax, 1.05);

        // Helpers
        function X(x){ return x0 + (x - xmin) * plotW / (xmax - xmin); }
        function Y(y){ return y0 - (y - ymin) * plotH / (ymax - ymin); }

        // Background
        ctx.clearRect(0,0,W,H);
        ctx.save();
        ctx.globalAlpha = 1;
        // grid
        ctx.lineWidth = 1;
        ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--line').trim() || 'rgba(255,255,255,.10)';

        const xTicks = [0.0,0.5,1.0,1.5,2.0,2.5,3.0];
        const yTicks = [-1.0,-0.5,0.0,0.5,1.0];

        // Gridlines
        ctx.beginPath();
        xTicks.forEach(t=>{
          if(t < xmin || t > xmax) return;
          const xx = X(t);
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y1);
        });
        yTicks.forEach(t=>{
          if(t < ymin || t > ymax) return;
          const yy = Y(t);
          ctx.moveTo(x0, yy);
          ctx.lineTo(x1, yy);
        });
        ctx.stroke();

        // Axes
        ctx.strokeStyle = getComputedStyle(document.body).color;
        ctx.lineWidth = 1.4;
        ctx.beginPath();
        ctx.moveTo(x0, y0); ctx.lineTo(x1, y0);
        ctx.moveTo(x0, y0); ctx.lineTo(x0, y1);
        ctx.stroke();

        // Tick marks + labels
        ctx.fillStyle = getComputedStyle(document.body).color;
        ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;

        xTicks.forEach(t=>{
          if(t < xmin || t > xmax) return;
          const xx = X(t);
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y0+6);
          ctx.stroke();
          const label = t.toFixed(1);
          ctx.fillText(label, xx-10, y0+22);
        });

        yTicks.forEach(t=>{
          if(t < ymin || t > ymax) return;
          const yy = Y(t);
          ctx.beginPath();
          ctx.moveTo(x0-6, yy);
          ctx.lineTo(x0, yy);
          ctx.stroke();
          const label = t.toFixed(1);
          ctx.fillText(label, 10, yy+4);
        });

        // Title
        ctx.font = 'bold 14px ' + getComputedStyle(document.body).fontFamily;
        ctx.fillText('Universal 2D Fermi Gas: μ/(kB TF) vs T/TF', x0, 20);

        // Axis labels
        ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;
        ctx.fillText('T / TF (dimensionless)', x0 + plotW/2 - 60, H - 18);

        ctx.save();
        ctx.translate(18, y1 + plotH/2 + 40);
        ctx.rotate(-Math.PI/2);
        ctx.fillText('μ / (kB TF) (dimensionless)', 0, 0);
        ctx.restore();

        // Curve
        // Use a readable stroke (no explicit color selection requested; still we must draw it).
        // We'll use current text color with slightly higher alpha.
        ctx.strokeStyle = getComputedStyle(document.body).color;
        ctx.globalAlpha = 0.9;
        ctx.lineWidth = 2;

        ctx.beginPath();
        let started = false;
        for(let i=0;i<=900;i++){
          const x = xmin + (xmax-xmin)*i/900;
          const y = f_mu_over_kBTF(x);
          const xx = X(x), yy = Y(y);
          if(!started){
            ctx.moveTo(xx,yy); started = true;
          }else{
            ctx.lineTo(xx,yy);
          }
        }
        ctx.stroke();
        ctx.globalAlpha = 1;

        // Legend (simple)
        const legX = x1 - 160, legY = y1 + 10;
        ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--line').trim() || 'rgba(255,255,255,.10)';
        ctx.lineWidth = 1;
        ctx.strokeRect(legX, legY, 150, 44);
        ctx.fillStyle = getComputedStyle(document.body).color;
        ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;
        // line sample
        ctx.globalAlpha = 0.9;
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(legX+10, legY+20);
        ctx.lineTo(legX+48, legY+20);
        ctx.stroke();
        ctx.globalAlpha = 1;
        ctx.fillText('y = x ln(e^{1/x}-1)', legX+56, legY+24);

        ctx.restore();
      }

      const ro = new ResizeObserver(()=>draw());
      ro.observe(canvas);
      window.addEventListener('resize', draw, {passive:true});
      draw();
    })();
  </script>
</body>
</html>
