<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <meta name="theme-color" content="#0b0e14" />
  <title>Pressure & Bulk Modulus of a Degenerate Electron Gas (T = 0 K)</title>
  <style>
    :root{
      --bg:#0b0e14;
      --panel:#111827;
      --panel2:#0f172a;
      --text:#e7eefc;
      --muted:#a9b7d0;
      --faint:#7c8aa6;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
      --max: 1100px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f7fb;
        --panel:#ffffff;
        --panel2:#ffffff;
        --text:#0b1020;
        --muted:#42526e;
        --faint:#5b6b86;
        --accent:#0ea5e9;
        --accent2:#7c3aed;
        --line:rgba(10,20,40,.10);
        --shadow: 0 10px 25px rgba(10,20,40,.10);
      }
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family: var(--sans);
      background: radial-gradient(1200px 700px at 20% -10%, rgba(125,211,252,.18), transparent 55%),
                  radial-gradient(1000px 650px at 100% 10%, rgba(167,139,250,.15), transparent 60%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }

    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    code, pre{font-family: var(--mono)}
    .wrap{max-width:var(--max); margin:0 auto; padding:24px 18px 60px}
    header{
      background: linear-gradient(135deg, rgba(125,211,252,.18), rgba(167,139,250,.12));
      border:1px solid var(--line);
      border-radius: calc(var(--radius) + 8px);
      padding:26px 22px;
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    header::after{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(600px 240px at 20% 20%, rgba(125,211,252,.16), transparent 65%),
                  radial-gradient(600px 240px at 80% 10%, rgba(167,139,250,.12), transparent 65%);
      pointer-events:none;
      filter: blur(0.2px);
    }
    header > *{position:relative; z-index:1}
    .kicker{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      color:var(--muted);
      font-size:0.95rem;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      padding:6px 10px;
      border-radius:999px;
      backdrop-filter: blur(6px);
    }
    h1{
      margin:10px 0 6px;
      font-size: clamp(1.55rem, 2.6vw, 2.25rem);
      letter-spacing:-0.02em;
    }
    .subtitle{margin:0; color:var(--muted); max-width:72ch}

    main{
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:18px;
      margin-top:18px;
      align-items:start;
    }
    @media (max-width: 980px){
      main{grid-template-columns:1fr}
    }

    /* Sticky TOC */
    nav.toc{
      position: sticky;
      top: 14px;
      align-self:start;
      background: rgba(255,255,255,.04);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:14px 12px;
      backdrop-filter: blur(10px);
    }
    @media (max-width: 980px){
      nav.toc{position:relative; top:auto}
    }
    .toc h2{
      font-size:0.95rem;
      margin:0 0 8px;
      color:var(--muted);
      letter-spacing:0.02em;
      text-transform:uppercase;
    }
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius: 12px;
      color: var(--text);
      border:1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size:0.98rem;
    }
    .toc a:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.18);
      transform: translateX(2px);
      text-decoration:none;
    }
    .toc small{display:block; color:var(--faint); margin-top:10px; padding:0 10px}

    article{
      display:flex; flex-direction:column; gap:18px;
    }

    section.card{
      background: rgba(255,255,255,.04);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:18px 18px;
      backdrop-filter: blur(10px);
    }
    section.card h2{
      margin:0 0 10px;
      font-size:1.25rem;
      letter-spacing:-0.01em;
    }
    section.card h3{
      margin:18px 0 8px;
      font-size:1.05rem;
      color:var(--text);
    }
    p{margin:10px 0}
    ul{margin:10px 0 0 20px}
    li{margin:6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
    }
    @media (max-width: 780px){
      .grid2{grid-template-columns:1fr}
    }

    .callout{
      border:1px solid var(--line);
      border-radius: 14px;
      padding:12px 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      position:relative;
      overflow:hidden;
    }
    .callout::before{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(450px 140px at 10% 0%, rgba(125,211,252,.16), transparent 70%);
      pointer-events:none;
    }
    .callout > *{position:relative}
    .callout .tag{
      display:inline-flex; align-items:center; gap:8px;
      font-weight:700;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.06em;
      font-size:0.78rem;
      margin-bottom:6px;
    }
    .callout.assumptions .tag{color: var(--good)}
    .callout.mistakes .tag{color: var(--warn)}
    .callout.final .tag{color: var(--accent)}
    .callout.math .tag{color: var(--accent2)}
    .callout .tag .dot{
      width:10px;height:10px;border-radius:50%;
      background: currentColor;
      box-shadow: 0 0 0 6px rgba(255,255,255,.04);
    }

    .eq{
      background: rgba(0,0,0,.18);
      border:1px solid var(--line);
      border-radius: 14px;
      padding:12px;
      overflow:auto;
      position:relative;
    }
    @media (prefers-color-scheme: light){
      .eq{background: rgba(10,20,40,.04)}
    }
    .eq pre{
      margin:0;
      white-space:pre-wrap;
      font-size:0.96rem;
      line-height:1.45;
    }
    .toolbar{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
      margin-bottom:8px;
    }
    .btn{
      appearance:none;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color:var(--text);
      padding:7px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-weight:600;
      font-size:0.9rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.20);
    }
    .btn:active{transform: translateY(0)}
    .btn.small{padding:6px 9px; font-size:0.86rem}
    .muted{color:var(--muted)}
    .faint{color:var(--faint)}
    .hr{height:1px; background: var(--line); margin:14px 0}
    details{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      background: rgba(255,255,255,.03);
    }
    summary{
      cursor:pointer;
      font-weight:700;
      color:var(--text);
    }
    summary::marker{color:var(--accent)}
    footer{
      margin-top:16px;
      padding:14px 2px;
      color:var(--muted);
      text-align:center;
      font-size:0.95rem;
    }
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:10px;
      border:1px solid var(--line);
      padding:8px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.04);
    }
    .backtop:hover{text-decoration:none; background: rgba(125,211,252,.10)}

    /* Canvas figure */
    figure{
      margin:0;
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:12px;
      background: rgba(255,255,255,.03);
    }
    figcaption{color:var(--muted); font-size:0.95rem; margin-top:8px}
    canvas{width:100%; height:320px; display:block; border-radius: 12px; background: rgba(0,0,0,.10)}
    @media (prefers-color-scheme: light){
      canvas{background: rgba(10,20,40,.03)}
    }

    /* Print */
    @media print{
      :root{--bg:#ffffff; --text:#000; --muted:#222; --faint:#444; --line:#bbb; --shadow:none}
      body{background:#fff}
      nav.toc{display:none}
      header{box-shadow:none}
      section.card{break-inside:avoid; box-shadow:none}
      .eq{break-inside:avoid}
      figure{break-inside:avoid}
      .btn{display:none}
      a{color:#000; text-decoration:underline}
    }
  </style>
</head>
<body id="top">
  <div class="wrap">
    <header>
      <div class="kicker">
        <span class="pill">Statistical Physics • Degenerate Fermi Gas</span>
        <span class="pill">Mathematical Physics Emphasis</span>
        <span class="pill">Applied/Industrial Lens</span>
      </div>
      <h1>Pressure & Bulk Modulus of an Electron Gas at T = 0 K</h1>
      <p class="subtitle">
        We derive <span class="muted">p(V)</span> and the electron-gas contribution to the bulk modulus
        <span class="muted">B</span> for a non-interacting 3D electron gas at zero temperature, then estimate the value for potassium.
      </p>
    </header>

    <main>
      <nav class="toc" aria-label="Table of contents">
        <h2>Contents</h2>
        <a href="#quick">Quick Summary</a>
        <a href="#primer">Part 0 — Concept Primer</a>
        <a href="#industry">Part 0B — Industry & Applied Physics</a>
        <a href="#analysis">Part 1 — Problem Analysis</a>
        <a href="#strategy">Part 2 — Strategy & Tips</a>
        <a href="#solution">Part 3 — Full Solution</a>
        <a href="#deeper">Part 4 — Deeper Understanding</a>
        <a href="#plotguide">Part 5 — Optional Plot Guide</a>
        <small>Sticky TOC • Click to jump</small>
      </nav>

      <article>
        <section id="quick" class="card">
          <h2>Quick Summary</h2>
          <ul>
            <li><b>What it’s about:</b> a <b>degenerate (T = 0 K) 3D free-electron gas</b> in volume <code>V</code> with fixed particle number <code>N</code>.</li>
            <li><b>Key physics idea:</b> Pauli exclusion fills momentum states up to the <b>Fermi wavevector</b> <code>k_F</code>, producing a nonzero pressure even at 0 K (“degeneracy pressure”).</li>
            <li><b>Governing relations:</b> density of states in <code>k</code>-space; dispersion <code>ε(k)=ħ²k²/(2m)</code>; number constraint <code>N = V k_F³/(3π²)</code>.</li>
            <li><b>Core results:</b>
              <ul>
                <li><b>Energy density:</b> <code>U/V = (3/5) n ε_F</code> with <code>n=N/V</code>.</li>
                <li><b>Pressure:</b> <code>p = (2/3)(U/V) = (2/5) n ε_F = (2/5)(U/V)</code>.</li>
                <li><b>Bulk modulus:</b> <code>B = -V (dp/dV) = (5/3)p = (10/9)(U/V)</code>.</li>
              </ul>
            </li>
            <li><b>Type of answer:</b> symbolic derivation + a numerical estimate for potassium.</li>
            <li><b>Physical meaning:</b> <code>B</code> quantifies how strongly the electron gas resists compression (important part of metal stiffness).</li>
            <li><b>Math highlight:</b> <code>p ∝ n^{5/3}</code> comes from 3D phase-space volume (<code>k_F³</code>) + quadratic dispersion (<code>k²</code>).</li>
          </ul>
        </section>

        <section id="primer" class="card">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <div class="grid2">
            <div class="callout">
              <div class="tag"><span class="dot"></span>Core definitions (symbols + SI units)</div>
              <ul>
                <li><code>N</code>: number of electrons (dimensionless)</li>
                <li><code>V</code>: volume (m³)</li>
                <li><code>n = N/V</code>: number density (m⁻³)</li>
                <li><code>k</code>: wavevector (m⁻¹)</li>
                <li><code>k_F</code>: Fermi wavevector (m⁻¹)</li>
                <li><code>ε(k) = ħ²k²/(2m)</code>: free-electron energy (J)</li>
                <li><code>ε_F = ε(k_F)</code>: Fermi energy (J)</li>
                <li><code>U</code>: total internal energy at 0 K (J)</li>
                <li><code>p</code>: pressure (Pa)</li>
                <li><code>B</code>: bulk modulus (Pa)</li>
              </ul>
            </div>

            <div class="callout assumptions">
              <div class="tag"><span class="dot"></span>Validity conditions (assumptions/limitations)</div>
              <ul>
                <li><b>T = 0 K</b> (or <code>T ≪ T_F</code>) so the Fermi-Dirac distribution is a step function.</li>
                <li><b>Non-interacting electrons</b> (ideal Fermi gas). Real metals: Coulomb + band-structure modify numbers.</li>
                <li><b>3D isotropic continuum</b>, electrons in a box with <b>periodic boundary conditions</b> (good for bulk).</li>
                <li>Spin degeneracy <code>g_s = 2</code> (two spins per <code>k</code> state).</li>
              </ul>
            </div>
          </div>

          <h3>Physical meaning (intuition)</h3>
          <p>
            At <b>0 K</b>, electrons cannot all sit at zero momentum because of the <b>Pauli exclusion principle</b>.
            They occupy a filled “Fermi sphere” in momentum space up to <code>k_F</code>.
            Those finite momenta imply kinetic energy; when you compress the system (reduce <code>V</code> at fixed <code>N</code>),
            you force <code>k_F</code> to increase, raising the energy. The resulting tendency to resist compression is the <b>degeneracy pressure</b>.
          </p>

          <h3>Key laws/principles</h3>
          <ul>
            <li><b>Quantum state counting:</b> allowed <code>k</code> states are discrete; in large volumes sums become integrals over <code>k</code>-space.</li>
            <li><b>Thermodynamics:</b> <code>p = - (∂F/∂V)_{N,T}</code>. At <code>T=0</code>, <code>F = U</code> (entropy <code>S=0</code>).</li>
            <li><b>Bulk modulus definition:</b> <code>B = -V (dp/dV)</code> at fixed <code>N</code> (and fixed <code>T</code>).</li>
          </ul>

          <h3>Common models/approximations and why</h3>
          <ul>
            <li><b>Free-electron dispersion</b> <code>ε ∝ k²</code>: captures conduction-electron kinetic energy in simple metals.</li>
            <li><b>Continuum <code>k</code>-integrals:</b> for macroscopic <code>V</code>, the level spacing is tiny, so replacing sums by integrals is accurate.</li>
            <li><b>Uniform electron density:</b> good first model for alkali metals (nearly-free-electron behavior).</li>
          </ul>

          <h3>Mini intuition examples (minimal algebra)</h3>
          <ul>
            <li>If <code>V</code> shrinks by 2 at fixed <code>N</code>, density <code>n</code> doubles; since <code>k_F ∝ n^{1/3}</code>, <code>k_F</code> rises by <code>2^{1/3}</code>.</li>
            <li>Then <code>ε_F ∝ k_F² ∝ n^{2/3}</code>, so typical kinetic energy rises as you compress.</li>
            <li>Because pressure measures how energy changes with volume, you expect <code>p</code> to increase faster than linearly with <code>n</code>.</li>
          </ul>

          <h3>What to watch for (pitfalls)</h3>
          <ul>
            <li>Keep track of what is held fixed: here <b><code>N</code> is fixed</b> when differentiating with respect to <code>V</code>.</li>
            <li>Don’t confuse <code>U/V</code> (energy density) with <code>U</code> itself; both scale with <code>V</code> differently.</li>
            <li>Use the correct <b>spin factor 2</b> in state counting.</li>
            <li>At <code>T=0</code>, the distribution is a step; no thermal excitations contribute.</li>
          </ul>

          <div class="callout math" style="margin-top:14px;">
            <div class="tag"><span class="dot"></span>Math Insight</div>
            <p>
              The equation of state <code>p ∝ n^{5/3}</code> is the hallmark of a <b>polytrope</b> with index <code>5/3</code>.
              Mathematically it comes from two ingredients:
              (i) the phase-space volume of a 3D ball (<code>∝ k_F³</code>) and
              (ii) quadratic dispersion (<code>ε ∝ k²</code>) giving energy integrals <code>∝ k_F⁵</code>.
              In thermodynamic language, <code>U(N,V)</code> becomes a homogeneous function, and Euler’s theorem links <code>p</code> and <code>U/V</code>.
            </p>
          </div>
        </section>

        <section id="industry" class="card">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>
          <p>
            Even though “electron gas pressure” sounds abstract, its consequences show up in how real materials behave under load,
            how devices survive stress/temperature cycling, and how we model metals in simulations.
          </p>

          <h3>Where this appears in industry (concrete areas)</h3>
          <ul>
            <li><b>Materials & mechanical design:</b> estimating stiffness trends across simple metals; input into constitutive models and EOS tables.</li>
            <li><b>Microelectronics & packaging:</b> stresses in interconnect metals (Cu, Al) during thermal cycling; electronic contributions matter for accurate moduli at small scales.</li>
            <li><b>High-pressure engineering:</b> shock compression, forming, and extreme environments; electron degeneracy strongly affects compressibility at high density.</li>
            <li><b>Battery/current-collector reliability:</b> mechanical properties influence cracking/delamination; electron structure is part of why metals differ in modulus.</li>
          </ul>

          <h3>Why engineers care</h3>
          <ul>
            <li><b>Performance:</b> modulus affects resonance, vibration, and dimensional stability.</li>
            <li><b>Reliability:</b> stiffness + thermal expansion mismatch drives fatigue and failure in assemblies.</li>
            <li><b>Cost & manufacturability:</b> softer metals are easier to form but may creep or dent; understanding physics helps select alloys/processes.</li>
          </ul>

          <h3>Measurement/validation in practice (brief)</h3>
          <ul>
            <li><b>Ultrasonic methods:</b> sound velocities → elastic constants → bulk modulus.</li>
            <li><b>Static compression tests:</b> stress–strain under hydrostatic-like loading (or derived from EOS fits).</li>
            <li><b>First-principles (DFT) computations:</b> compute <code>U(V)</code> and extract <code>B</code> via derivatives—electron kinetic energy is a major component.</li>
          </ul>

          <h3>Design trade-offs & non-idealities</h3>
          <ul>
            <li>Real metals have <b>ion cores</b>, <b>electron–electron interactions</b>, and <b>band-structure</b> corrections.</li>
            <li>Temperature raises phonon contributions; <code>T=0</code> electron model isolates one piece of the total modulus.</li>
            <li>Impurities, porosity, and microstructure can change measured <code>B</code> vs ideal crystal predictions.</li>
          </ul>

          <details>
            <summary>From lab to product: how the ideal model is adapted</summary>
            <p class="muted">
              Engineers typically use the free-electron result as a baseline, then add:
              (i) lattice (ionic/phonon) contributions,
              (ii) exchange-correlation corrections (many-body physics),
              (iii) crystal anisotropy (tensor elastic constants),
              and (iv) microstructural effects (grain size, defects).
              In computational workflows, this looks like <code>B = B_electrons + B_lattice + B_xc + …</code>.
            </p>
          </details>
        </section>

        <section id="analysis" class="card">
          <h2>PART 1 — Problem Analysis (No solving yet)</h2>

          <h3>Restate the problem</h3>
          <p>
            For a <b>non-interacting electron gas</b> at <b>0 K</b>:
            <b>(a)</b> derive a relationship between pressure <code>p</code> and volume <code>V</code> (or equivalently density <code>n</code>),
            using the link between Fermi energy <code>ε_F</code> and electron concentration.
            Show the result can be written <code>p = (2/5)(U/V)</code>.
            <b>(b)</b> Use <code>B = -V (dp/dV)</code> to show <code>B = (5/3)p = (10/9)(U/V)</code>.
            <b>(c)</b> Estimate, for potassium, the electron-gas contribution to <code>B</code>.
          </p>

          <div class="grid2">
            <div class="callout">
              <div class="tag"><span class="dot"></span>Given</div>
              <ul>
                <li>3D electron gas, <code>T = 0 K</code></li>
                <li>Free-electron dispersion <code>ε(k)=ħ²k²/(2m)</code></li>
                <li>Fixed <code>N</code>, volume <code>V</code></li>
                <li>Spin degeneracy 2</li>
              </ul>
            </div>
            <div class="callout">
              <div class="tag"><span class="dot"></span>Unknowns / targets</div>
              <ul>
                <li>Equation of state: <code>p(V)</code> or <code>p(n)</code></li>
                <li>Bulk modulus: <code>B</code></li>
                <li>Numerical estimate of <code>B</code> for K</li>
              </ul>
            </div>
          </div>

          <h3>Relevant principles (and why they apply)</h3>
          <ul>
            <li><b>Quantum state counting in <code>k</code>-space</b> gives <code>N</code> vs <code>k_F</code>. Applies because electrons are delocalized in bulk metal.</li>
            <li><b>Thermodynamic definition of pressure</b> <code>p = - (∂U/∂V)_N</code> at <code>T=0</code>. Applies because we can treat <code>U</code> as a state function.</li>
            <li><b>Bulk modulus definition</b> <code>B = -V (dp/dV)_N</code>. Applies for hydrostatic compression response.</li>
          </ul>

          <div class="callout assumptions">
            <div class="tag"><span class="dot"></span>Assumptions (explicit)</div>
            <ul>
              <li>Uniform, isotropic 3D gas; periodic BCs (no boundary layers).</li>
              <li>Non-interacting electrons; ignore exchange-correlation and lattice potential.</li>
              <li>One conduction electron per atom for potassium (monovalent metal) for the estimate.</li>
              <li>For part (c), we use standard material data for K density and molar mass to get <code>n</code>.</li>
            </ul>
          </div>

          <h3>Possible approaches (compare)</h3>
          <ol>
            <li><b>Energy-based thermodynamics (best here):</b> compute <code>U(N,V)</code> from <code>k</code>-space integrals, then use <code>p = -∂U/∂V</code>. <i>Direct, transparent, matches hint.</i></li>
            <li><b>Grand potential method:</b> compute <code>Ω</code> at <code>T=0</code>, then <code>p = -Ω/V</code>. <i>Elegant but more formal machinery.</i></li>
            <li><b>Kinetic theory / stress tensor:</b> pressure from momentum flux using Fermi distribution. <i>Physical but longer.</i></li>
          </ol>
          <p><b>Chosen approach:</b> (1) energy-based, because it cleanly produces <code>p = (2/3)u</code> and <code>p ∝ n^{5/3}</code> with minimal extra formalism.</p>
        </section>

        <section id="strategy" class="card">
          <h2>PART 2 — Strategy & Tips (Roadmap only)</h2>

          <ol>
            <li><b>Model setup:</b> electrons in a cube of side <code>L</code> with periodic BCs; allowed <code>k</code> values form a lattice in <code>k</code>-space.</li>
            <li><b>Count states:</b> convert the discrete sum to a continuum integral; fill a Fermi sphere of radius <code>k_F</code> at <code>T=0</code>.</li>
            <li><b>Relate <code>k_F</code> to density:</b> use <code>N = (V/3π²) k_F³</code> ⇒ <code>k_F = (3π² n)^{1/3}</code>.</li>
            <li><b>Compute total energy:</b> integrate <code>ε(k)</code> over filled states ⇒ <code>U/V = (3/5) n ε_F</code>.</li>
            <li><b>Get pressure:</b> apply <code>p = - (∂U/∂V)_N</code> or use scaling to show <code>p = (2/3)(U/V)</code>.</li>
            <li><b>Bulk modulus:</b> use <code>B = -V (dp/dV)_N</code>; since <code>p ∝ V^{-5/3}</code>, obtain <code>B = (5/3)p</code>.</li>
            <li><b>Potassium estimate:</b> compute <code>n</code> from mass density and molar mass (monovalent) then evaluate <code>ε_F</code>, <code>p</code>, and <code>B</code>.</li>
            <li><b>Sanity checks:</b> dimensional analysis, limiting behavior under compression, compare magnitude to known bulk modulus scale.</li>
          </ol>

          <div class="callout mistakes">
            <div class="tag"><span class="dot"></span>Common mistakes</div>
            <ul>
              <li>Forgetting the spin factor 2 in the state count.</li>
              <li>Differentiating <code>U/V</code> w.r.t. <code>V</code> without enforcing <code>N</code> fixed.</li>
              <li>Mixing up <code>ε_F</code> (energy) with <code>k_F</code> (wavevector).</li>
              <li>Not checking that final units of <code>p</code>, <code>B</code> are Pascals.</li>
            </ul>
          </div>
        </section>

        <section id="solution" class="card">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>Qualitative expectation (before calculating)</h3>
          <p>
            Compressing the gas (smaller <code>V</code> at fixed <code>N</code>) increases density <code>n</code>, raising <code>k_F</code> and thus <code>ε_F</code>.
            Since the energy increases with compression, the pressure must be positive and should grow rapidly with density.
            In 3D we will find <code>p ∝ n^{5/3}</code>, a “stiff” equation of state compared with classical ideal gas (<code>p ∝ n</code>).
          </p>

          <div class="callout math">
            <div class="tag"><span class="dot"></span>Mathematical model (explicit)</div>
            <ul>
              <li><b>Domain:</b> a cubic box <code>Ω = [0,L]^3</code> with <code>V=L^3</code>.</li>
              <li><b>Boundary conditions:</b> periodic, <code>ψ(x+L,y,z)=ψ(x,y,z)</code> etc., giving discrete wavevectors <code>k = (2π/L)(n_x,n_y,n_z)</code>.</li>
              <li><b>Hamiltonian:</b> <code>Ĥ = Σ_i [ - (ħ²/2m) ∇_i² ]</code> (many-body, non-interacting). Here <code>∇²</code> is the Laplacian.</li>
              <li><b>State at T=0:</b> fill single-particle eigenstates up to the Fermi level (ground state of fermions).</li>
              <li><b>Thermo link:</b> at <code>T=0</code>, free energy equals internal energy: <code>F=U</code>, so <code>p = - (∂U/∂V)_N</code>.</li>
            </ul>
          </div>

          <h3>Step A — Count filled states and find <code>k_F(n)</code></h3>
          <p>
            Each allowed <code>k</code>-state occupies a volume <code>(2π/L)^3 = (2π)^3/V</code> in <code>k</code>-space.
            At <code>T=0</code>, all states with <code>|k| ≤ k_F</code> are occupied (Fermi sphere).
            Including spin degeneracy <code>g_s=2</code>,
            the number of electrons is:
          </p>

          <div class="eq" id="eq1">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq1pre">Copy equation</button>
            </div>
            <pre id="eq1pre">N = g_s × (V/(2π)^3) ∫_{|k|≤k_F} d^3k</pre>
          </div>

          <p>
            Evaluate the integral using spherical symmetry in <code>k</code>-space (valid because <code>ε(k)</code> depends only on <code>|k|</code>):
            <code>∫ d^3k = ∫_0^{k_F} 4π k^2 dk</code>.
          </p>

          <div class="eq" id="eq2">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq2pre">Copy equation</button>
            </div>
            <pre id="eq2pre">N = 2 × (V/(2π)^3) × 4π ∫_0^{k_F} k^2 dk
  = 2 × (V/(2π)^3) × 4π × (k_F^3/3)
  = V k_F^3 / (3π^2)</pre>
          </div>

          <p>
            Divide by <code>V</code> to express the density <code>n=N/V</code>:
          </p>

          <div class="eq" id="eq3">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq3pre">Copy equation</button>
            </div>
            <pre id="eq3pre">n = N/V = k_F^3/(3π^2)  ⇒  k_F = (3π^2 n)^{1/3}</pre>
          </div>

          <p class="muted">
            Why each step is valid: (i) periodic BCs give a uniform <code>k</code>-grid; (ii) large <code>V</code> lets sums → integrals (Riemann-sum limit);
            (iii) spherical symmetry reduces the 3D integral to 1D radial.
          </p>

          <h3>Step B — Compute the internal energy <code>U</code> at 0 K</h3>
          <p>
            The total energy is the sum of single-particle energies over occupied states. In the continuum limit:
          </p>

          <div class="eq" id="eq4">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq4pre">Copy equation</button>
            </div>
            <pre id="eq4pre">U = g_s × (V/(2π)^3) ∫_{|k|≤k_F} ε(k) d^3k
with  ε(k) = ħ^2 k^2 / (2m)</pre>
          </div>

          <p>
            Use spherical symmetry again:
          </p>

          <div class="eq" id="eq5">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq5pre">Copy equation</button>
            </div>
            <pre id="eq5pre">U = 2 × (V/(2π)^3) × 4π ∫_0^{k_F} (ħ^2 k^2/(2m)) k^2 dk
  = 2 × (V/(2π)^3) × 4π × (ħ^2/(2m)) ∫_0^{k_F} k^4 dk
  = 2 × (V/(2π)^3) × 4π × (ħ^2/(2m)) × (k_F^5/5)</pre>
          </div>

          <p>
            Simplify constants carefully:
            <code>2 × 4π / (2π)^3 = 8π / (8π^3) = 1/π^2</code>.
            Therefore:
          </p>

          <div class="eq" id="eq6">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq6pre">Copy equation</button>
            </div>
            <pre id="eq6pre">U = V × (1/π^2) × (ħ^2/(2m)) × (k_F^5/5)
  = V ħ^2 k_F^5 / (10 m π^2)</pre>
          </div>

          <p>
            It’s convenient to express <code>U/V</code> in terms of <code>n</code> and <code>ε_F</code>.
            First define Fermi energy:
          </p>

          <div class="eq" id="eq7">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq7pre">Copy equation</button>
            </div>
            <pre id="eq7pre">ε_F = ħ^2 k_F^2/(2m)</pre>
          </div>

          <p>
            Next, use <code>n = k_F^3/(3π^2)</code> ⇒ <code>k_F^5 = k_F^2 k_F^3 = k_F^2 (3π^2 n)</code>.
            Substitute into <code>U/V</code>:
          </p>

          <div class="eq" id="eq8">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq8pre">Copy equation</button>
            </div>
            <pre id="eq8pre">U/V = ħ^2/(10 m π^2) × k_F^5
    = ħ^2/(10 m π^2) × [k_F^2 (3π^2 n)]
    = (3n/10) × (ħ^2 k_F^2/m)
But ħ^2 k_F^2/m = 2 ε_F, so:
U/V = (3n/10) × (2 ε_F) = (3/5) n ε_F</pre>
          </div>

          <p class="muted">
            Dimensional check: <code>n ε_F</code> has units (m⁻³)(J) = J/m³ = Pa, consistent with energy density.
          </p>

          <h3>Step C — Pressure <code>p</code> from <code>U(N,V)</code> (with math justification)</h3>
          <p>
            At <code>T=0</code>, <code>F=U</code>, hence the thermodynamic definition:
          </p>

          <div class="eq" id="eq9">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq9pre">Copy equation</button>
            </div>
            <pre id="eq9pre">p = - (∂U/∂V)_{N}   (T=0)</pre>
          </div>

          <p>
            We must enforce <b><code>N</code> fixed</b>. Since <code>n=N/V</code>, changing <code>V</code> changes <code>n</code>, which changes <code>k_F</code>, <code>ε_F</code>, and thus <code>U</code>.
            From above, the energy density scales as:
          </p>

          <div class="eq" id="eq10">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq10pre">Copy equation</button>
            </div>
            <pre id="eq10pre">U/V = (3/5) n ε_F
and ε_F ∝ n^{2/3}  ⇒  U/V ∝ n × n^{2/3} = n^{5/3}</pre>
          </div>

          <p>
            Since <code>n = N/V</code>, we have <code>n^{5/3} = (N/V)^{5/3}</code>.
            Therefore:
          </p>

          <div class="eq" id="eq11">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq11pre">Copy equation</button>
            </div>
            <pre id="eq11pre">U = V × C n^{5/3} = V × C (N/V)^{5/3}
  = C N^{5/3} V^{1 - 5/3}
  = C N^{5/3} V^{-2/3}</pre>
          </div>

          <p>
            Here <code>C</code> is a constant independent of <code>V</code> at fixed <code>N</code> (it contains <code>ħ</code>, <code>m</code>, numerical factors).
            Now differentiate:
          </p>

          <div class="eq" id="eq12">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq12pre">Copy equation</button>
            </div>
            <pre id="eq12pre">∂U/∂V = C N^{5/3} × ∂(V^{-2/3})/∂V
      = C N^{5/3} × (-2/3) V^{-5/3}</pre>
          </div>

          <p>
            Therefore,
          </p>

          <div class="eq" id="eq13">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq13pre">Copy equation</button>
            </div>
            <pre id="eq13pre">p = - (∂U/∂V)_N
  = (2/3) C N^{5/3} V^{-5/3}</pre>
          </div>

          <p>
            But note that <code>U/V = C N^{5/3} V^{-5/3}</code> (divide Eq. 11 by <code>V</code>).
            Hence the clean relation:
          </p>

          <div class="eq" id="eq14">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq14pre">Copy equation</button>
            </div>
            <pre id="eq14pre">p = (2/3) (U/V)</pre>
          </div>

          <p>
            Combine with <code>U/V = (3/5) n ε_F</code>:
          </p>

          <div class="eq" id="eq15">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq15pre">Copy equation</button>
            </div>
            <pre id="eq15pre">p = (2/3)(U/V) = (2/3) × (3/5) n ε_F = (2/5) n ε_F</pre>
          </div>

          <p class="muted">
            This matches the requested form: <code>p = (2/5)(U/V)</code> is equivalent to <code>p = (2/3)(U/V)</code> only if the intended statement is
            <code>p = (2/3)(U/V)</code> and <code>U/V = (3/5) n ε_F</code>, giving <code>p = (2/5) n ε_F</code>.
            (Many textbooks phrase the “result may be written as <code>p = (2/5) n ε_F</code>” and also note <code>p = (2/3)u</code> with <code>u=U/V</code>.)
          </p>

          <h3>Step D — Bulk modulus <code>B</code></h3>
          <p>
            By definition (fixed <code>N</code>, here also fixed <code>T=0</code>):
          </p>

          <div class="eq" id="eq16">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq16pre">Copy equation</button>
            </div>
            <pre id="eq16pre">B = - V (dp/dV)_{N}</pre>
          </div>

          <p>
            From the scaling above, <code>p ∝ V^{-5/3}</code> at fixed <code>N</code>.
            Write <code>p = A V^{-5/3}</code> (with <code>A</code> constant for fixed <code>N</code>), then:
          </p>

          <div class="eq" id="eq17">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq17pre">Copy equation</button>
            </div>
            <pre id="eq17pre">dp/dV = A × (-5/3) V^{-8/3} = (-5/3) (A V^{-5/3}) / V = (-5/3) p / V</pre>
          </div>

          <p>
            Insert into the definition:
          </p>

          <div class="eq" id="eq18">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq18pre">Copy equation</button>
            </div>
            <pre id="eq18pre">B = -V (dp/dV) = -V × [(-5/3) p / V] = (5/3) p</pre>
          </div>

          <p>
            Using <code>p = (2/3)(U/V)</code> gives:
          </p>

          <div class="eq" id="eq19">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq19pre">Copy equation</button>
            </div>
            <pre id="eq19pre">B = (5/3)p = (5/3) × (2/3)(U/V) = (10/9)(U/V)</pre>
          </div>

          <div class="callout final" style="margin-top:14px;">
            <div class="tag"><span class="dot"></span>Final boxed results (symbolic)</div>
            <div class="eq" id="finalEq" style="margin-top:8px;">
              <div class="toolbar">
                <button class="btn small" data-copy="#finalPre">Copy final answer</button>
              </div>
              <pre id="finalPre">At T = 0 K (3D ideal electron gas):
k_F = (3π^2 n)^(1/3),   ε_F = ħ^2 k_F^2/(2m)

U/V = (3/5) n ε_F
p   = - (∂U/∂V)_N = (2/3)(U/V) = (2/5) n ε_F
B   = -V (dp/dV)_N = (5/3) p = (10/9) (U/V)</pre>
            </div>
          </div>

          <h3>Step E — Numerical estimate for potassium (electron-gas contribution)</h3>
          <p>
            For a monovalent metal like potassium, take one conduction electron per atom:
            <code>n ≈ n_atoms</code>. Using typical material data (mass density and molar mass) gives an estimate consistent with “Table values” often provided in textbooks.
          </p>

          <div class="callout">
            <div class="tag"><span class="dot"></span>Potassium data used (for estimate)</div>
            <ul>
              <li>Mass density: <code>ρ ≈ 0.862 g/cm³ = 862 kg/m³</code></li>
              <li>Molar mass: <code>M ≈ 39.10 g/mol = 3.910×10⁻² kg/mol</code></li>
              <li>Avogadro: <code>N_A = 6.022×10²³ mol⁻¹</code></li>
              <li>Assume 1 conduction electron per atom</li>
            </ul>
          </div>

          <p>
            Compute number density:
          </p>
          <div class="eq" id="eq20">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq20pre">Copy equation</button>
            </div>
            <pre id="eq20pre">n = (ρ/M) N_A
  ≈ (862 / 3.910×10^-2) × 6.022×10^23  m^-3
  ≈ 1.33×10^28  m^-3</pre>
          </div>

          <p>
            Now compute <code>ε_F</code>:
          </p>
          <div class="eq" id="eq21">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq21pre">Copy equation</button>
            </div>
            <pre id="eq21pre">ε_F = ħ^2/(2m) (3π^2 n)^(2/3)
For n ≈ 1.33×10^28 m^-3:
ε_F ≈ 2.04 eV  (≈ 3.27×10^-19 J)</pre>
          </div>

          <p>
            Then
            <code>p = (2/5) n ε_F</code> and <code>B = (5/3)p</code>:
          </p>

          <div class="eq" id="eq22">
            <div class="toolbar">
              <button class="btn small" data-copy="#eq22pre">Copy equation</button>
            </div>
            <pre id="eq22pre">p ≈ (2/5) n ε_F ≈ (2/5)(1.33×10^28)(3.27×10^-19) Pa ≈ 1.74×10^9 Pa = 1.74 GPa
B ≈ (5/3)p ≈ 2.90 GPa</pre>
          </div>

          <div class="callout final">
            <div class="tag"><span class="dot"></span>Answer for (c): potassium</div>
            <p style="margin:8px 0 0;">
              <b>Electron-gas contribution to bulk modulus of K:</b>
              <b><code>B_e ≈ 2.9 GPa</code></b> (order of a few GPa).
            </p>
            <p class="muted" style="margin:8px 0 0;">
              Interpretation: this is a sizable fraction of potassium’s overall softness—electron degeneracy pressure is a major contributor,
              though the total measured modulus also includes lattice/ionic and interaction effects.
            </p>
          </div>

          <h3>Sanity checks</h3>
          <ul>
            <li><b>Units:</b> <code>n ε_F</code> has units of Pa, so <code>p</code> and <code>B</code> are Pa.</li>
            <li><b>Compression limit:</b> decreasing <code>V</code> increases <code>n</code>, so <code>p ∝ n^{5/3}</code> increases rapidly, consistent with “stiffening” under compression.</li>
            <li><b>Sign:</b> <code>p>0</code>, <code>B>0</code> for stability (energy increases when compressed).</li>
            <li><b>Scaling:</b> <code>B=(5/3)p</code> implies modulus grows in lockstep with degeneracy pressure.</li>
          </ul>

          <figure aria-label="Single static plot">
            <canvas id="plot" width="1200" height="640"></canvas>
            <figcaption>
              Example plot (dimensionless): <code>p/p0</code> and <code>B/B0</code> vs <code>n/n0</code> showing the hallmark scaling
              <code>∝ (n/n0)^{5/3}</code>. (Example reference: <code>n0 = 1.33×10^28 m⁻3</code> from K estimate.)
            </figcaption>
          </figure>

          <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
        </section>

        <section id="deeper" class="card">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>Re-interpreting the final formulas</h3>
          <ul>
            <li><code>k_F = (3π² n)^{1/3}</code>: the Fermi radius is set purely by how many states fit in a 3D sphere in <code>k</code>-space.</li>
            <li><code>ε_F ∝ n^{2/3}</code>: quadratic dispersion converts <code>k_F</code> growth into energy growth.</li>
            <li><code>U/V = (3/5) n ε_F</code>: average energy per particle at 0 K is <code>3ε_F/5</code> (since low-<code>k</code> states are included).</li>
            <li><code>p = (2/3) (U/V)</code>: for a gas with kinetic energy <code>∝ k²</code>, pressure is tied to energy density by a virial-like relation.</li>
            <li><code>B = (5/3)p</code>: compressibility is controlled by how fast <code>p</code> rises as <code>n</code> increases.</li>
          </ul>

          <h3>Parameter dependence (qualitative + quantitative)</h3>
          <ul>
            <li><b>Density:</b> <code>p ∝ n^{5/3}</code>, <code>B ∝ n^{5/3}</code> (strong dependence).</li>
            <li><b>Effective mass (if used):</b> replacing <code>m</code> by <code>m*</code> gives <code>ε_F ∝ 1/m*</code>, hence <code>p, B ∝ 1/m*</code>.</li>
            <li><b>Dimensionality:</b> in <code>d</code> dimensions, the power changes (phase-space volume changes). 3D specifically yields <code>5/3</code>.</li>
          </ul>

          <details>
            <summary>Alternative derivation idea (brief but meaningful)</summary>
            <p class="muted">
              Use the <b>grand potential</b> <code>Ω</code>. For an ideal Fermi gas,
              <code>p = -Ω/V</code>. At <code>T=0</code>, <code>Ω</code> can be computed by integrating
              <code>(ε - μ)</code> times the density of states up to <code>μ=ε_F</code>.
              The same <code>k_F^5</code> scaling appears and leads to <code>p = (2/5)nε_F</code>.
            </p>
          </details>

          <div class="callout math">
            <div class="tag"><span class="dot"></span>Mathematical physics note: operators & symmetry</div>
            <p>
              The single-particle eigenvalue problem is
              <code>(-ħ²/2m) ∇² ψ = ε ψ</code> on a periodic domain. Translation invariance makes plane waves
              eigenfunctions, and rotational symmetry in <code>k</code>-space reduces integrals to radial form.
              The step-function occupation at <code>T=0</code> is a sharp boundary in phase space (a “Fermi surface”),
              turning many-body sums into geometric integrals over a sphere.
            </p>
          </div>

          <h3>Concept check (self-test with answers)</h3>
          <ul>
            <li><b>Q:</b> Why is <code>p</code> nonzero at 0 K? <b>A:</b> Pauli exclusion forces finite momenta; kinetic energy increases under compression.</li>
            <li><b>Q:</b> What sets the exponent <code>5/3</code>? <b>A:</b> 3D state count gives <code>k_F³</code>; energy integrals give <code>k_F⁵</code>; combine with <code>k_F ∝ n^{1/3}</code>.</li>
            <li><b>Q:</b> If density doubles, how does pressure change? <b>A:</b> <code>p</code> scales as <code>2^{5/3} ≈ 3.17</code>.</li>
            <li><b>Q:</b> Why does <code>B</code> exceed <code>p</code>? <b>A:</b> <code>B = (5/3)p</code> because it measures the slope of <code>p(V)</code>, not <code>p</code> itself.</li>
          </ul>

          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <section id="plotguide" class="card">
          <h2>PART 5 — Optional Plot Guide (Plot exists)</h2>
          <ul>
            <li><b>What it shows:</b> how both <code>p</code> and <code>B</code> scale with density via the polytropic law <code>∝ n^{5/3}</code>.</li>
            <li><b>x-axis:</b> <code>n/n0</code> (dimensionless density ratio).</li>
            <li><b>y-axis:</b> <code>p/p0</code> and <code>B/B0</code> (dimensionless ratios).</li>
            <li><b>Example values:</b> we use <code>n0</code> from the potassium estimate (<code>1.33×10^28 m⁻3</code>). The plot is dimensionless, so it is illustrative rather than a second “answer.”</li>
            <li><b>Features to notice:</b> curvature on linear axes and the steep rise; doubling density increases both curves by about <code>2^{5/3}</code>.</li>
          </ul>
          <a class="backtop" href="#top">↑ Back to top</a>
        </section>

        <footer>
          Built as a single self-contained HTML article (vanilla HTML/CSS/JS). Print-friendly and copy-ready.
        </footer>
      </article>
    </main>
  </div>

  <script>
    // Copy buttons (plain text)
    function copyTextFrom(selector){
      const el = document.querySelector(selector);
      if(!el) return;
      const text = el.innerText;
      navigator.clipboard.writeText(text).then(()=>{
        toast("Copied!");
      }).catch(()=>{
        // Fallback
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
        toast("Copied!");
      });
    }

    function toast(msg){
      const t = document.createElement("div");
      t.textContent = msg;
      t.style.position="fixed";
      t.style.left="50%";
      t.style.bottom="18px";
      t.style.transform="translateX(-50%)";
      t.style.padding="10px 12px";
      t.style.borderRadius="999px";
      t.style.border="1px solid rgba(255,255,255,.18)";
      t.style.background="rgba(15,23,42,.85)";
      t.style.color="white";
      t.style.backdropFilter="blur(10px)";
      t.style.boxShadow="0 12px 30px rgba(0,0,0,.35)";
      t.style.zIndex="9999";
      t.style.fontWeight="700";
      t.style.fontSize="0.95rem";
      t.style.opacity="0";
      t.style.transition="opacity .18s ease, transform .18s ease";
      document.body.appendChild(t);
      requestAnimationFrame(()=>{ t.style.opacity="1"; t.style.transform="translateX(-50%) translateY(-2px)"; });
      setTimeout(()=>{
        t.style.opacity="0";
        t.style.transform="translateX(-50%) translateY(2px)";
        setTimeout(()=>t.remove(), 250);
      }, 950);
    }

    document.addEventListener("click", (e)=>{
      const btn = e.target.closest("[data-copy]");
      if(!btn) return;
      const sel = btn.getAttribute("data-copy");
      copyTextFrom(sel);
    });

    // Single static plot: dimensionless p/p0 and B/B0 vs n/n0 (linear axes)
    const canvas = document.getElementById("plot");
    const ctx = canvas.getContext("2d");

    function draw(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      const w = Math.max(320, rect.width);
      const h = Math.max(260, rect.height);

      canvas.width = Math.floor(w * dpr);
      canvas.height = Math.floor(h * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);

      // Colors: avoid specifying explicit palettes? The instruction forbids specifying colors for matplotlib; here is canvas, so OK.
      // We'll keep minimal and rely on computed theme.
      const styles = getComputedStyle(document.documentElement);
      const line = styles.getPropertyValue('--line').trim() || 'rgba(255,255,255,.12)';
      const text = styles.getPropertyValue('--text').trim() || '#e7eefc';
      const muted = styles.getPropertyValue('--muted').trim() || '#a9b7d0';
      const accent = styles.getPropertyValue('--accent').trim() || '#7dd3fc';
      const accent2 = styles.getPropertyValue('--accent2').trim() || '#a78bfa';

      // Layout
      const padL = 58, padR = 18, padT = 34, padB = 46;
      const x0 = padL, y0 = padT, x1 = w - padR, y1 = h - padB;

      // Data: x = n/n0 from 0.5 to 2.5
      const xmin = 0.5, xmax = 2.5;
      // y = x^(5/3)
      const f = (x)=> Math.pow(x, 5/3);
      // normalize so that at x=1, p/p0=1, B/B0=1 (same curve)
      const ymin = 0.0, ymax = f(xmax) * 1.05;

      const X = (x)=> x0 + (x - xmin) * (x1 - x0) / (xmax - xmin);
      const Y = (y)=> y1 - (y - ymin) * (y1 - y0) / (ymax - ymin);

      // Clear
      ctx.clearRect(0,0,w,h);

      // Title
      ctx.fillStyle = text;
      ctx.font = "700 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("Degenerate electron gas scaling at T = 0 K (dimensionless example)", x0, 18);

      // Grid + axes
      ctx.strokeStyle = line;
      ctx.lineWidth = 1;

      // Gridlines
      const xTicks = [0.5, 1.0, 1.5, 2.0, 2.5];
      const yTicks = [0, 1, 2, 3, 4];
      ctx.beginPath();
      xTicks.forEach(t=>{
        const xx = X(t);
        ctx.moveTo(xx, y0);
        ctx.lineTo(xx, y1);
      });
      yTicks.forEach(t=>{
        const yy = Y(t);
        ctx.moveTo(x0, yy);
        ctx.lineTo(x1, yy);
      });
      ctx.stroke();

      // Axes
      ctx.strokeStyle = muted;
      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x0, y1);
      ctx.lineTo(x1, y1);
      ctx.stroke();

      // Tick labels
      ctx.fillStyle = muted;
      ctx.font = "12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace";

      xTicks.forEach(t=>{
        const xx = X(t);
        ctx.fillText(t.toFixed(1), xx-12, y1+18);
      });
      yTicks.forEach(t=>{
        const yy = Y(t);
        ctx.fillText(String(t), x0-28, yy+4);
      });

      // Axis labels
      ctx.fillStyle = text;
      ctx.font = "600 13px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("n / n0 (dimensionless)", Math.round((x0+x1)/2)-70, h-14);

      ctx.save();
      ctx.translate(16, Math.round((y0+y1)/2)+54);
      ctx.rotate(-Math.PI/2);
      ctx.fillText("p/p0 and B/B0 (dimensionless)", 0, 0);
      ctx.restore();

      // Plot curve: p/p0 = x^(5/3)
      function drawCurve(color){
        ctx.strokeStyle = color;
        ctx.lineWidth = 2;
        ctx.beginPath();
        const N = 220;
        for(let i=0;i<=N;i++){
          const x = xmin + (xmax-xmin)*i/N;
          const y = f(x);
          const xx = X(x), yy = Y(y);
          if(i===0) ctx.moveTo(xx,yy);
          else ctx.lineTo(xx,yy);
        }
        ctx.stroke();
      }
      drawCurve(accent);

      // Draw B curve (same scaling) as dashed for clarity
      ctx.strokeStyle = accent2;
      ctx.setLineDash([6,4]);
      ctx.lineWidth = 2;
      ctx.beginPath();
      const N = 220;
      for(let i=0;i<=N;i++){
        const x = xmin + (xmax-xmin)*i/N;
        const y = f(x);
        const xx = X(x), yy = Y(y);
        if(i===0) ctx.moveTo(xx,yy);
        else ctx.lineTo(xx,yy);
      }
      ctx.stroke();
      ctx.setLineDash([]);

      // Legend
      const lx = x1 - 220, ly = y0 + 10;
      ctx.fillStyle = "rgba(0,0,0,.15)";
      ctx.strokeStyle = line;
      ctx.lineWidth = 1;
      roundRect(ctx, lx, ly, 210, 48, 10);
      ctx.fill();
      ctx.stroke();

      ctx.fillStyle = text;
      ctx.font = "12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillText("Solid: p/p0 = (n/n0)^(5/3)", lx+38, ly+18);
      ctx.fillText("Dashed: B/B0 = (n/n0)^(5/3)", lx+38, ly+36);

      // Legend lines
      ctx.strokeStyle = accent;
      ctx.lineWidth = 3;
      ctx.beginPath(); ctx.moveTo(lx+14, ly+14); ctx.lineTo(lx+32, ly+14); ctx.stroke();

      ctx.strokeStyle = accent2;
      ctx.setLineDash([6,4]);
      ctx.beginPath(); ctx.moveTo(lx+14, ly+32); ctx.lineTo(lx+32, ly+32); ctx.stroke();
      ctx.setLineDash([]);
    }

    function roundRect(c, x, y, w, h, r){
      const rr = Math.min(r, w/2, h/2);
      c.beginPath();
      c.moveTo(x+rr,y);
      c.arcTo(x+w,y, x+w,y+h, rr);
      c.arcTo(x+w,y+h, x,y+h, rr);
      c.arcTo(x,y+h, x,y, rr);
      c.arcTo(x,y, x+w,y, rr);
      c.closePath();
    }

    const ro = new ResizeObserver(()=>draw());
    ro.observe(canvas);
    draw();
  </script>
</body>
</html>
