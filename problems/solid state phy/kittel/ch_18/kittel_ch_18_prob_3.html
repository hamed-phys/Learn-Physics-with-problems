<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Breit–Wigner Form of a Transmission Resonance (Derivation)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --card:#111824;
      --text:#e8eef6;
      --muted:#a9b7c8;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 800px at 20% 0%, rgba(125,211,252,.10), transparent 55%),
                  radial-gradient(1000px 600px at 80% 10%, rgba(167,139,250,.10), transparent 50%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    header{
      padding:28px 18px 18px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    header .wrap{
      max-width:1100px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
    }
    h1{
      margin:0;
      font-size:clamp(1.35rem, 2.6vw, 2.1rem);
      letter-spacing:.2px;
    }
    .subtitle{color:var(--muted); max-width:80ch;}
    main{
      max-width:1100px;
      margin:0 auto;
      padding:18px;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:18px;
      align-items:start;
    }
    nav.toc{
      position:sticky;
      top:14px;
      padding:14px;
      background: rgba(17,24,36,.72);
      border:1px solid var(--border);
      border-radius:14px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    nav.toc .toc-title{
      font-weight:700;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .pill{
      font-size:.78rem;
      padding:3px 9px;
      border:1px solid var(--border);
      border-radius:999px;
      color:var(--muted);
      background: rgba(255,255,255,.03);
    }
    nav.toc a{
      display:block;
      padding:8px 10px;
      margin:6px 0;
      color:var(--muted);
      text-decoration:none;
      border-radius:10px;
      border:1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }
    nav.toc a:hover{
      background: rgba(125,211,252,.08);
      border-color: rgba(125,211,252,.25);
      transform: translateY(-1px);
      color:var(--text);
    }
    article{min-width:0; display:flex; flex-direction:column; gap:14px;}
    section{
      background: rgba(17,24,36,.62);
      border:1px solid var(--border);
      border-radius:16px;
      padding:16px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    section h2{margin:0 0 10px; font-size:1.22rem;}
    section h3{margin:14px 0 8px; font-size:1.02rem;}
    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
    @media (max-width: 920px){main{grid-template-columns:1fr} nav.toc{position:relative; top:auto}}
    @media (max-width: 740px){.grid2{grid-template-columns:1fr}}
    .callout{
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    }
    .callout strong{color:var(--accent)}
    .callout.assumptions strong{color:var(--warn)}
    .callout.mistakes strong{color:var(--bad)}
    .callout.final strong{color:var(--ok)}
    .callout .meta{color:var(--muted); font-size:.92rem}
    ul{margin:8px 0 0 18px}
    li{margin:6px 0}
    .muted{color:var(--muted)}
    .eq{
      background: rgba(15,22,32,.8);
      border:1px solid rgba(125,211,252,.22);
      border-radius:14px;
      padding:12px;
      margin:10px 0;
      overflow:auto;
    }
    pre{margin:0; font-family:var(--mono); font-size:.93rem; line-height:1.45; white-space:pre;}
    .copybar{display:flex; justify-content:flex-end; margin-top:8px;}
    button.copy{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color:var(--text);
      padding:6px 10px;
      border-radius:10px;
      cursor:pointer;
      font-size:.86rem;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      border-color: rgba(125,211,252,.35);
      background: rgba(125,211,252,.08);
    }
    details{
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.02);
      border-radius:14px;
      padding:10px 12px;
      margin-top:10px;
    }
    summary{cursor:pointer; font-weight:650; color:var(--accent);}
    figure{
      margin:12px 0 0;
      padding:12px;
      border-radius:16px;
      border:1px solid var(--border);
      background: rgba(15,22,32,.65);
    }
    figcaption{color:var(--muted); font-size:.92rem; margin-top:8px}
    canvas{
      width:100%;
      height:320px;
      display:block;
      border-radius:12px;
      background: rgba(255,255,255,.02);
      border:1px solid rgba(255,255,255,.08);
    }
    .backtop{
      margin-top:10px;
      display:inline-block;
      color:var(--accent);
      text-decoration:none;
      border:1px solid rgba(125,211,252,.22);
      padding:7px 10px;
      border-radius:999px;
      background: rgba(125,211,252,.06);
      transition: transform .12s ease, background .12s ease;
    }
    .backtop:hover{transform: translateY(-1px); background: rgba(125,211,252,.10)}
    footer{max-width:1100px; margin:0 auto; padding:18px; color:var(--muted); font-size:.92rem;}
    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform: translateX(-50%);
      padding:10px 12px;
      border-radius:12px;
      background: rgba(17,24,36,.88);
      border:1px solid var(--border);
      color:var(--text);
      box-shadow: var(--shadow);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      backdrop-filter: blur(10px);
      z-index:9999;
    }
    .toast.show{opacity:1; transform: translateX(-50%) translateY(-4px)}
    @media print{
      body{background:#fff; color:#000}
      header, nav.toc, .toast, button.copy, .backtop{display:none !important}
      main{grid-template-columns:1fr; padding:0}
      section{box-shadow:none; border:1px solid #bbb; background:#fff}
      .eq{background:#f6f6f6; border-color:#bbb}
      a{color:#000; text-decoration:underline}
      section{break-inside: avoid}
      h2{break-after: avoid}
    }
  </style>
</head>

<body>
<header id="top">
  <div class="wrap">
    <h1>Breit–Wigner Form of a Transmission Resonance (from a Fabry–Pérot / double-barrier model)</h1>
    <div class="subtitle">
      Step-by-step physics + mathematical-physics derivation of the Lorentzian (Breit–Wigner) transmission peak near resonance, including the phase–energy link δε/Δε = δφ/(2π), with an applied engineering lens.
    </div>
  </div>
</header>

<main>
  <nav class="toc" aria-label="Table of contents">
    <div class="toc-title">
      <span>On this page</span>
      <span class="pill">sticky TOC</span>
    </div>
    <a href="#quick-summary">Quick Summary</a>
    <a href="#part0">PART 0 — Concept Primer</a>
    <a href="#part0b">PART 0B — Industry &amp; Applied Physics Perspective</a>
    <a href="#part1">PART 1 — Problem Analysis</a>
    <a href="#part2">PART 2 — Strategy &amp; Tips</a>
    <a href="#part3">PART 3 — Full Solution</a>
    <a href="#part4">PART 4 — Deeper Understanding</a>
    <a href="#part5">PART 5 — Optional Plot Guide</a>
  </nav>

  <article>
    <section id="quick-summary">
      <h2>Quick Summary</h2>
      <ul>
        <li><strong>Goal:</strong> derive the Breit–Wigner (Lorentzian) transmission resonance from a phase-dependent two-barrier formula.</li>
        <li><strong>Key physics:</strong> multiple reflections in a “cavity” interfere; at φ = 2πm they add constructively.</li>
        <li><strong>Key equation:</strong> T(φ) = (T₁T₂)/(1+R₁R₂−2√(R₁R₂)cosφ), with Tᵢ=|tᵢ|², Rᵢ=|rᵢ|².</li>
        <li><strong>Near resonance:</strong> set φ = 2πm + δφ, expand cosφ ≈ 1 − δφ²/2, giving a quadratic denominator in δφ.</li>
        <li><strong>Phase–energy link (1D box):</strong> δε/Δε = δφ/(2π).</li>
        <li><strong>Final (symbolic):</strong> T(ε) = (Γ₁Γ₂)/[(ε−ε₀)² + (Γ₁+Γ₂)²/4], with Γᵢ = (Δε/2π)|tᵢ|².</li>
      </ul>
      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part0">
      <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

      <div class="grid2">
        <div class="callout">
          <strong>Core definitions (symbols + SI units)</strong>
          <ul>
            <li>t₁,t₂: complex transmission amplitudes (dimensionless); Tᵢ = |tᵢ|².</li>
            <li>r₁,r₂: complex reflection amplitudes (dimensionless); Rᵢ = |rᵢ|²; lossless ⇒ Tᵢ+Rᵢ=1.</li>
            <li>φ: total round-trip phase (radians).</li>
            <li>ε: energy (J or eV); Δε: level spacing (J or eV).</li>
            <li>Γᵢ: partial width (energy), sets linewidth of the resonance.</li>
          </ul>
        </div>
        <div class="callout">
          <strong>Physical meaning (intuition)</strong>
          <ul>
            <li>The region between barriers acts like a cavity; waves make multiple round trips.</li>
            <li>At resonance φ=2πm, all paths add in phase ⇒ strong transmission.</li>
            <li>Small detuning δφ causes destructive interference; the peak becomes Lorentzian in energy.</li>
          </ul>
        </div>
      </div>

      <h3>Key principles &amp; validity</h3>
      <ul>
        <li><strong>Linearity:</strong> coherent sums of amplitudes; multiple reflections form a geometric series.</li>
        <li><strong>Unitarity:</strong> lossless scattering ⇒ probabilities satisfy Tᵢ+Rᵢ=1.</li>
        <li><strong>Near-resonance expansion:</strong> for |δφ|≪1, Taylor expand cos; keep δφ² term (leading correction).</li>
      </ul>

      <div class="callout">
        <strong>Math Insight</strong>
        <div class="meta">
          The resonance is a rational function with a quadratic denominator in detuning: mathematically a Lorentzian (Cauchy) profile.
          In spectral terms, it corresponds to a quasi-bound state with complex energy ε₀ − iΓ/2 (pole of the S-matrix/Green’s function).
        </div>
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part0b">
      <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>
      <ul>
        <li><strong>Applications:</strong> resonant tunneling diodes, quantum dots/SETs, photonic and RF cavity filters.</li>
        <li><strong>Why engineers care:</strong> linewidth controls selectivity; peak height impacts throughput and efficiency; asymmetry affects performance.</li>
        <li><strong>Measurement:</strong> conductance vs gate voltage, I–V curves, optical transmission spectra, S-parameters.</li>
        <li><strong>Trade-offs:</strong> stronger coupling (larger Tᵢ) ⇒ broader resonance; weaker coupling ⇒ sharper but smaller signal and more sensitivity to disorder/dephasing.</li>
      </ul>
      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part1">
      <h2>PART 1 — Problem Analysis (no solving yet)</h2>
      <p class="muted">
        (a) Expand cosφ near resonance φ=2πm and simplify T(φ) in terms of |t₁|², |t₂|², δφ.
        (b) In a 1D box relate small phase and energy changes: δε/Δε = δφ/(2π).
        (c) Combine to get the Breit–Wigner resonance T(ε).
      </p>

      <div class="callout assumptions">
        <strong>Assumptions</strong>
        <ul>
          <li>Phase-coherent, elastic scattering; lossless barriers (unitary).</li>
          <li>Near resonance: φ = 2πm + δφ with |δφ|≪1.</li>
          <li>Sharp resonance regime to express everything via |tᵢ|²: |t₁|²,|t₂|² ≪ 1 (so Rᵢ≈1).</li>
        </ul>
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part2">
      <h2>PART 2 — Strategy &amp; Tips</h2>
      <ol>
        <li>Start from two-barrier transmission T(φ).</li>
        <li>Write φ = 2πm + δφ; expand cos to second order.</li>
        <li>Simplify denominator: constant term + δφ² term.</li>
        <li>Use Rᵢ=1−Tᵢ and small-T expansions to express constant term via T₁,T₂.</li>
        <li>Derive δε/Δε = δφ/(2π) using 1D quantization and dε/dn.</li>
        <li>Substitute δφ = 2π(ε−ε₀)/Δε into T(δφ).</li>
        <li>Define Γᵢ = (Δε/2π)Tᵢ to match Breit–Wigner form.</li>
      </ol>

      <div class="callout mistakes">
        <strong>Common mistakes</strong>
        <ul>
          <li>Dropping δφ² (it is the first nonzero detuning correction).</li>
          <li>Using one-way phase kL instead of round-trip phase 2kL (or missing reflection phases).</li>
          <li>Mixing units: ε, Δε, Γ must be consistent.</li>
        </ul>
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part3">
      <h2>PART 3 — Full Solution (Detailed)</h2>

      <h3>Mathematical model</h3>
      <div class="eq" id="eq-model">
        <pre>1D stationary wave/quantum model in the cavity (0&lt;x&lt;L):
[-(ħ²/2m) d²/dx²] ψ(x) = ε ψ(x),  k = sqrt(2mε)/ħ
ψ(x) = A e^{ikx} + B e^{-ikx}

Barriers are encoded by complex scattering amplitudes (t₁,r₁) and (t₂,r₂),
with probabilities Tᵢ=|tᵢ|² and Rᵢ=|rᵢ|² (lossless ⇒ Tᵢ+Rᵢ=1).</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-model pre">Copy equation</button>
        </div>
      </div>

      <h3>(a) Near-resonance expansion in δφ</h3>
      <div class="eq" id="eq-fp">
        <pre>Two-barrier transmission probability:
T(φ) = (T₁ T₂) / (1 + R₁ R₂ − 2 √(R₁ R₂) cos φ).</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-fp pre">Copy equation</button>
        </div>
      </div>

      <div class="eq" id="eq-detune">
        <pre>Resonance detuning:
φ = 2πm + δφ,  |δφ| ≪ 1,  m ∈ ℤ
cos(2πm + δφ) = cos δφ ≈ 1 − δφ²/2.</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-detune pre">Copy equation</button>
        </div>
      </div>

      <div class="eq" id="eq-den">
        <pre>Let α = √(R₁R₂). Then the denominator D becomes:
D = 1 + R₁R₂ − 2α cos(2πm+δφ)
  ≈ 1 + α² − 2α(1 − δφ²/2)
  = (1 − α)² + α δφ².</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-den pre">Copy derivation</button>
        </div>
      </div>

      <details>
        <summary>Optional: express (1−α)² in terms of T₁,T₂ (sharp resonance)</summary>
        <div class="eq" id="eq-alpha">
          <pre>Assume T₁,T₂ ≪ 1 so Rᵢ = 1 − Tᵢ ≈ 1.
Then:
α = √[(1−T₁)(1−T₂)] = √[1 − (T₁+T₂) + T₁T₂]
≈ 1 − (T₁+T₂)/2  (keeping leading order)

So:
(1 − α)² ≈ ((T₁+T₂)/2)²
and α δφ² ≈ δφ².</pre>
          <div class="copybar">
            <button class="copy" data-copytarget="#eq-alpha pre">Copy detail</button>
          </div>
        </div>
      </details>

      <div class="eq" id="eq-aresult">
        <pre>Therefore near resonance (to leading order in small Tᵢ and δφ):
T(δφ) ≈ (T₁ T₂) / [ ((T₁ + T₂)/2)² + (δφ)² ].

Peak height:
T_max = T(0) ≈ 4T₁T₂/(T₁+T₂)² ≤ 1.</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-aresult pre">Copy result</button>
        </div>
      </div>

      <h3>(b) Phase–energy relation δε/Δε = δφ/(2π)</h3>
      <div class="eq" id="eq-b1">
        <pre>In a 1D box/cavity of length L, the round-trip phase is approximately:
φ(ε) ≈ 2k(ε)L   (energy dependence dominated by propagation)

So small changes give:
δφ = 2L δk.</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-b1 pre">Copy equation</button>
        </div>
      </div>

      <div class="eq" id="eq-b2">
        <pre>Dispersion for a free particle:
ε(k) = ħ²k²/(2m)  ⇒  dε/dk = ħ²k/m = ħv,  v = ħk/m.

Thus:
δε = (dε/dk) δk = ħv δk  ⇒  δk = δε/(ħv).

Insert into δφ = 2L δk:
δφ = 2L [δε/(ħv)] = (2L/(ħv)) δε.</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-b2 pre">Copy derivation</button>
        </div>
      </div>

      <div class="eq" id="eq-b3">
        <pre>Level spacing in a 1D box:
k_n ≈ nπ/L  ⇒  dk/dn = π/L

Δε ≡ dε/dn = (dε/dk)(dk/dn) = (ħv)(π/L) = (πħv)/L.

Now compare δε/Δε with δφ/(2π):

δε/Δε = δε / [(πħv)/L] = (L/(πħv)) δε
δφ/(2π) = [(2L/(ħv))δε]/(2π) = (L/(πħv)) δε

Hence:
δε/Δε = δφ/(2π).</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-b3 pre">Copy result</button>
        </div>
      </div>

      <h3>(c) Convert T(δφ) to T(ε): Breit–Wigner form</h3>
      <div class="eq" id="eq-c1">
        <pre>Let ε₀ be the resonance energy where φ(ε₀)=2πm.
Then δε = ε − ε₀, and from (b):
δφ = 2π (ε − ε₀)/Δε.</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-c1 pre">Copy equation</button>
        </div>
      </div>

      <div class="eq" id="eq-c2">
        <pre>Substitute into (a):
T(ε) ≈ (T₁T₂) / [ ((T₁+T₂)/2)² + (2π(ε−ε₀)/Δε)² ].

Multiply numerator and denominator by (Δε/2π)²:
T(ε) ≈ (T₁T₂)(Δε/2π)² / [ (ε−ε₀)² + (Δε/4π)² (T₁+T₂)² ].</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-c2 pre">Copy derivation</button>
        </div>
      </div>

      <div class="eq" id="eq-c3">
        <pre>Define partial widths (energies):
Γ₁ ≡ (Δε/2π) T₁ = (Δε/2π)|t₁|²,
Γ₂ ≡ (Δε/2π) T₂ = (Δε/2π)|t₂|²,
Γ = Γ₁ + Γ₂.

Then:
(Δε/4π)² (T₁+T₂)² = ( (Γ₁+Γ₂)/2 )² = (Γ/2)²
and (T₁T₂)(Δε/2π)² = Γ₁Γ₂.

So the transmission becomes the Breit–Wigner (Lorentzian) form:
T(ε) = (Γ₁Γ₂) / [ (ε−ε₀)² + (Γ/2)² ]
     = (Γ₁Γ₂) / [ (ε−ε₀)² + (Γ₁+Γ₂)²/4 ].</pre>
        <div class="copybar">
          <button class="copy" data-copytarget="#eq-c3 pre">Copy equation</button>
        </div>
      </div>

      <div class="callout final">
        <strong>Final Answer</strong>
        <div class="eq" id="eq-final">
          <pre>T(ε) = (Γ₁Γ₂)/[(ε−ε₀)² + (Γ₁+Γ₂)²/4],
with Γᵢ = (Δε/2π)|tᵢ|² (i=1,2) and φ(ε₀)=2πm.</pre>
          <div class="copybar">
            <button class="copy" data-copytarget="#eq-final pre">Copy final answer</button>
          </div>
        </div>
      </div>

      <h3>Sanity checks</h3>
      <div class="grid2">
        <div class="callout">
          <strong>Units</strong>
          <ul>
            <li>Γᵢ has units of energy because Γᵢ=(Δε/2π)Tᵢ.</li>
            <li>T is dimensionless.</li>
          </ul>
        </div>
        <div class="callout">
          <strong>Limits</strong>
          <ul>
            <li>At ε=ε₀: T_max = 4Γ₁Γ₂/(Γ₁+Γ₂)² ≤ 1 (equals 1 if Γ₁=Γ₂).</li>
            <li>|ε−ε₀|≫Γ: T ~ Γ₁Γ₂/(ε−ε₀)².</li>
          </ul>
        </div>
      </div>

      <figure>
        <canvas id="plot" aria-label="Breit–Wigner transmission plot"></canvas>
        <figcaption>Example Lorentzian peak (example values only): Γ₁=0.6, Γ₂=0.4 (arbitrary units). Symbolic results above remain general.</figcaption>
      </figure>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part4">
      <h2>PART 4 — Deeper Understanding</h2>
      <ul>
        <li><strong>ε₀:</strong> resonance location set by constructive interference / quasi-bound state condition.</li>
        <li><strong>Γ₁,Γ₂:</strong> coupling strengths to left/right; larger → broader resonance.</li>
        <li><strong>Peak height:</strong> limited by asymmetry; perfect transmission requires Γ₁=Γ₂.</li>
      </ul>

      <p class="muted">
        Alternative idea: in Green’s-function/S-matrix language, the resonance corresponds to a pole at ε = ε₀ − iΓ/2,
        giving |t(ε)|² ∝ 1/[(ε−ε₀)²+(Γ/2)²] directly.
      </p>

      <div class="callout">
        <strong>Concept checks</strong>
        <ul>
          <li><strong>Why no linear δφ term?</strong> cos has zero slope at φ=2πm.</li>
          <li><strong>When is T_max=1?</strong> symmetric coupling: Γ₁=Γ₂.</li>
          <li><strong>What sets Γ?</strong> leakage through the barriers (escape rate).</li>
        </ul>
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part5">
      <h2>PART 5 — Optional Plot Guide</h2>
      <ul>
        <li><strong>Axes:</strong> x is detuning ε−ε₀ (example units), y is transmission T (0 to 1).</li>
        <li><strong>Example values:</strong> Γ₁=0.6, Γ₂=0.4 (arbitrary).</li>
        <li><strong>Notice:</strong> width grows with Γ=Γ₁+Γ₂; peak height depends on asymmetry.</li>
      </ul>
      <a class="backtop" href="#top">Back to top ↑</a>
    </section>
  </article>
</main>

<footer>
  <div><strong class="muted">Note:</strong> Real devices may show thermal broadening, dephasing, and disorder that modify the ideal Lorentzian.</div>
</footer>

<div class="toast" id="toast" aria-live="polite" aria-atomic="true">Copied.</div>

<script>
  // Copy buttons
  (function(){
    const toast = document.getElementById('toast');
    function showToast(msg){
      toast.textContent = msg || 'Copied.';
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 1200);
    }
    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        showToast('Copied to clipboard.');
      }catch(e){
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        showToast('Copied (fallback).');
      }
    }
    document.addEventListener('click', (ev)=>{
      const btn = ev.target.closest('button.copy');
      if(!btn) return;
      const sel = btn.getAttribute('data-copytarget');
      const el = document.querySelector(sel);
      if(el) copyText(el.textContent.replace(/\n+$/,''));
    });
  })();

  // Static plot (example values) with devicePixelRatio handling
  (function(){
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    if(!CanvasRenderingContext2D.prototype.roundRect){
      CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
        r = Math.min(r, w/2, h/2);
        this.beginPath();
        this.moveTo(x+r, y);
        this.arcTo(x+w, y, x+w, y+h, r);
        this.arcTo(x+w, y+h, x, y+h, r);
        this.arcTo(x, y+h, x, y, r);
        this.arcTo(x, y, x+w, y, r);
        this.closePath();
        return this;
      }
    }

    function resize(){
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      const rect = canvas.getBoundingClientRect();
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
      draw(rect.width, rect.height);
    }

    function draw(w,h){
      // Example values only
      const Gamma1 = 0.6, Gamma2 = 0.4;
      const Gamma = Gamma1 + Gamma2;
      const eps0 = 0.0;

      const m = {l:56, r:18, t:28, b:44};
      const pw = w - m.l - m.r;
      const ph = h - m.t - m.b;

      const xmin = -3*Gamma, xmax = 3*Gamma;
      const ymin = 0, ymax = 1;

      const x2px = x => m.l + (x - xmin) * pw / (xmax - xmin);
      const y2px = y => m.t + (ymax - y) * ph / (ymax - ymin);

      ctx.clearRect(0,0,w,h);

      // Grid
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.lineWidth = 1;
      const nx = 6, ny = 5;

      function line(x1,y1,x2,y2){
        ctx.beginPath();
        ctx.moveTo(x1,y1);
        ctx.lineTo(x2,y2);
        ctx.stroke();
      }

      for(let i=0;i<=nx;i++){
        const x = xmin + (xmax-xmin)*i/nx;
        line(x2px(x), m.t, x2px(x), m.t+ph);
      }
      for(let j=0;j<=ny;j++){
        const y = ymin + (ymax-ymin)*j/ny;
        line(m.l, y2px(y), m.l+pw, y2px(y));
      }

      // Axes
      ctx.strokeStyle = "rgba(255,255,255,0.22)";
      line(m.l, m.t+ph, m.l+pw, m.t+ph);
      line(m.l, m.t, m.l, m.t+ph);

      // Ticks/labels
      ctx.fillStyle = "rgba(232,238,246,0.90)";
      ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "top";
      for(let i=0;i<=nx;i++){
        const x = xmin + (xmax-xmin)*i/nx;
        const px = x2px(x);
        line(px, m.t+ph, px, m.t+ph+6);
        ctx.fillText(x.toFixed(2), px, m.t+ph+8);
      }
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      for(let j=0;j<=ny;j++){
        const y = ymin + (ymax-ymin)*j/ny;
        const py = y2px(y);
        line(m.l-6, py, m.l, py);
        ctx.fillText(y.toFixed(1), m.l-10, py);
      }

      // Title
      ctx.textAlign = "left";
      ctx.textBaseline = "top";
      ctx.font = "14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText("Example Breit–Wigner transmission peak", m.l, 8);

      // Axis labels
      ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "bottom";
      ctx.fillText("Energy detuning (ε − ε₀) [example units]", m.l + pw/2, h-8);

      ctx.save();
      ctx.translate(14, m.t + ph/2);
      ctx.rotate(-Math.PI/2);
      ctx.textAlign = "center";
      ctx.textBaseline = "top";
      ctx.fillText("Transmission T (dimensionless)", 0, 0);
      ctx.restore();

      // Curve
      function Tof(eps){
        const num = Gamma1*Gamma2;
        const den = (eps-eps0)*(eps-eps0) + (Gamma*Gamma)/4;
        return num/den;
      }

      ctx.strokeStyle = "rgba(232,238,246,0.92)";
      ctx.lineWidth = 2;
      ctx.beginPath();
      const N = 700;
      for(let i=0;i<N;i++){
        const x = xmin + (xmax-xmin)*i/(N-1);
        const y = Math.max(0, Math.min(1, Tof(x)));
        const px = x2px(x), py = y2px(y);
        if(i===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);
      }
      ctx.stroke();

      // Legend
      const lx = m.l + 10, ly = m.t + 10;
      ctx.fillStyle = "rgba(255,255,255,0.08)";
      ctx.strokeStyle = "rgba(255,255,255,0.14)";
      ctx.lineWidth = 1;
      ctx.roundRect(lx, ly, 260, 54, 10);
      ctx.fill();
      ctx.stroke();

      ctx.fillStyle = "rgba(232,238,246,0.90)";
      ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.textAlign = "left";
      ctx.textBaseline = "top";
      ctx.fillText("Example: Γ₁ = 0.6, Γ₂ = 0.4, Γ = 1.0", lx+12, ly+10);
      ctx.fillText("T(ε) = Γ₁Γ₂ / [ (ε−ε₀)² + (Γ/2)² ]", lx+12, ly+28);
    }

    window.addEventListener('resize', resize, {passive:true});
    resize();
  })();
</script>
</body>
</html>