<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Thermal Properties in 1D: Debye Heat Capacity & Landauer Thermal Conductance (Single Phonon Mode)</title>
  <style>
    :root{
      --bg:#0b0f14;
      --card:#101826;
      --card2:#0f1623;
      --text:#e8eef7;
      --muted:#a8b3c7;
      --line:rgba(255,255,255,.12);
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --ok:#7CFFB2;
      --warn:#ffd38a;
      --bad:#ff8aa5;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 10% 10%, rgba(110,231,255,.10), transparent 55%),
        radial-gradient(1000px 700px at 90% 15%, rgba(167,139,250,.10), transparent 55%),
        radial-gradient(900px 600px at 60% 90%, rgba(124,255,178,.06), transparent 55%),
        var(--bg);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      padding:28px 18px 14px;
      border-bottom:1px solid var(--line);
      position:relative;
      overflow:hidden;
    }
    header .wrap{
      max-width:1180px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.5fr 1fr;
      gap:18px;
      align-items:end;
    }
    h1{
      margin:0;
      font-size: clamp(1.55rem, 2.6vw, 2.35rem);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:.4rem 0 0;
      color:var(--muted);
      font-size:1rem;
    }
    .meta{
      justify-self:end;
      text-align:right;
      color:var(--muted);
      font-size:.92rem;
    }
    .pillrow{margin-top:10px; display:flex; gap:10px; flex-wrap:wrap}
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:7px 11px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border-radius:999px;
      box-shadow: 0 6px 18px rgba(0,0,0,.18);
      color:var(--muted);
      font-size:.88rem;
      white-space:nowrap;
    }
    .dot{width:8px;height:8px;border-radius:50%}
    .dot.c1{background:var(--accent)}
    .dot.c2{background:var(--accent2)}
    .dot.c3{background:var(--ok)}
    main{
      max-width:1180px;
      margin:0 auto;
      padding:18px;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:18px;
      align-items:start;
    }
    nav#toc{
      position:sticky;
      top:14px;
      align-self:start;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:14px 14px 10px;
      overflow:hidden;
    }
    nav#toc .toc-title{
      font-weight:650;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .toc-mini{
      color:var(--muted);
      font-size:.86rem;
    }
    nav#toc a{
      display:block;
      padding:8px 10px;
      margin:4px 0;
      border-radius:12px;
      border:1px solid transparent;
      color:var(--text);
      font-size:.93rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    nav#toc a:hover{
      background: rgba(110,231,255,.10);
      border-color: rgba(110,231,255,.22);
      transform: translateX(2px);
      text-decoration:none;
    }
    .content{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:16px;
    }
    section, article{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:18px;
    }
    h2{
      margin:0 0 10px;
      font-size: clamp(1.2rem, 2vw, 1.55rem);
    }
    h3{
      margin:16px 0 8px;
      font-size:1.08rem;
      color: #dbe7ff;
    }
    p{margin: 8px 0}
    ul{margin:8px 0 8px 18px}
    li{margin:6px 0}
    .grid2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    .card{
      border:1px solid var(--line);
      border-radius:16px;
      background: rgba(16,24,38,.55);
      padding:14px;
    }
    .callout{
      border-left: 4px solid var(--accent);
      background: rgba(110,231,255,.08);
      padding:12px 12px 12px 14px;
      border-radius:14px;
      margin:12px 0;
    }
    .callout.warn{border-left-color:var(--warn); background: rgba(255,211,138,.08)}
    .callout.bad{border-left-color:var(--bad); background: rgba(255,138,165,.08)}
    .callout.ok{border-left-color:var(--ok); background: rgba(124,255,178,.08)}
    .eqbox{
      margin:12px 0;
      border:1px solid rgba(167,139,250,.28);
      background: rgba(167,139,250,.08);
      border-radius:16px;
      overflow:hidden;
    }
    .eqhdr{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border-bottom:1px solid rgba(167,139,250,.22);
    }
    .eqhdr b{font-weight:650}
    .btn{
      cursor:pointer;
      user-select:none;
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color:var(--text);
      padding:7px 10px;
      border-radius:12px;
      font-size:.88rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      display:inline-flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .btn:hover{transform: translateY(-1px); background: rgba(255,255,255,.08)}
    .btn:active{transform: translateY(0px)}
    pre.eq{
      margin:0;
      padding:12px;
      font-family:var(--mono);
      font-size:.95rem;
      overflow:auto;
      color:#f2f4ff;
      line-height:1.45;
      background: rgba(10,14,20,.35);
    }
    .mathinsight{
      border:1px dashed rgba(110,231,255,.35);
      background: rgba(110,231,255,.06);
      border-radius:16px;
      padding:12px;
      margin:12px 0;
    }
    details{
      border:1px solid var(--line);
      background: rgba(15,22,35,.55);
      border-radius:16px;
      padding:10px 12px;
      margin:10px 0;
    }
    details summary{
      cursor:pointer;
      font-weight:650;
      color:#dbe7ff;
      list-style:none;
    }
    details summary::-webkit-details-marker{display:none}
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:10px;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color:var(--muted);
    }
    figure{
      margin:12px 0 0;
      border:1px solid var(--line);
      border-radius:16px;
      overflow:hidden;
      background: rgba(10,14,20,.25);
    }
    figcaption{
      padding:10px 12px;
      color:var(--muted);
      border-top:1px solid var(--line);
      font-size:.9rem;
    }
    canvas{display:block; width:100%; height:auto; aspect-ratio: 16/9;}
    footer{
      max-width:1180px;
      margin:0 auto;
      padding:18px;
      color:var(--muted);
      font-size:.92rem;
    }
    .kbd{
      font-family:var(--mono);
      font-size:.85rem;
      border:1px solid var(--line);
      padding:2px 6px;
      border-radius:8px;
      background: rgba(255,255,255,.04);
      color:var(--text);
    }
    .divider{height:1px;background:var(--line);margin:14px 0}
    .small{color:var(--muted); font-size:.92rem}
    .tight p{margin:6px 0}
    .hl{
      background: linear-gradient(90deg, rgba(110,231,255,.18), rgba(167,139,250,.18));
      padding:1px 6px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.10);
    }
    @media (max-width: 980px){
      header .wrap{grid-template-columns:1fr; align-items:start}
      .meta{justify-self:start; text-align:left}
      main{grid-template-columns:1fr}
      nav#toc{position:relative; top:auto}
    }
    @media print{
      body{background:#fff;color:#000}
      header, nav#toc, .btn, .pillrow, .backtop{display:none !important}
      section, article{box-shadow:none; border:1px solid #bbb; background:#fff}
      pre.eq{background:#fff;color:#000;border-top:1px solid #ddd}
      .eqbox{background:#fff}
      a{color:#000;text-decoration:underline}
      h2, h3{break-after:avoid}
      section, article{break-inside:avoid-page}
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap">
      <div>
        <h1>Thermal Properties in 1D: Low-T Heat Capacity & Thermal Conductance of a Single Phonon Mode</h1>
        <p class="subtitle">
          Debye (linear-dispersion) approximation + Landauer-style energy-flow derivation between reservoirs —
          with an applied/industrial engineering lens.
        </p>
        <div class="pillrow" aria-label="topic tags">
          <span class="pill"><span class="dot c1"></span>1D phonons</span>
          <span class="pill"><span class="dot c2"></span>Debye approximation</span>
          <span class="pill"><span class="dot c3"></span>Ballistic thermal conductance</span>
        </div>
      </div>
      <div class="meta">
        <div><span class="hl">Symbolic results</span> (low-T asymptotics)</div>
        <div class="small">Key outputs: <span class="kbd">C ∝ T</span> and <span class="kbd">κ ∝ T</span> (quantized per mode)</div>
      </div>
    </div>
  </header>

  <main>
    <nav id="toc" aria-label="Table of contents">
      <div class="toc-title">
        <span>Table of Contents</span>
        <span class="toc-mini">sticky</span>
      </div>
      <a href="#quick-summary">Quick Summary</a>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry & Applied Physics Perspective</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy & Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Optional Plot Guide</a>
      <a href="#final">Final Answer (copy-ready)</a>
    </nav>

    <div class="content">

      <section id="quick-summary">
        <h2>Quick Summary</h2>
        <ul>
          <li><b>What this is about:</b> thermal properties of a <b>single 1D phonon mode</b> (one polarization branch) in the <b>Debye / linear-dispersion</b> approximation.</li>
          <li><b>Key physics idea:</b> in 1D with linear dispersion, the phonon <b>density of states is constant</b>, so low-T energy scales as <b>U ∝ T²</b> and heat capacity as <b>C ∝ T</b>.</li>
          <li><b>Governing ingredients:</b> Bose–Einstein occupation <span class="kbd">n(ω,T)=1/(e^{ħω/kBT}-1)</span> and linear dispersion <span class="kbd">ω=v|k|</span>.</li>
          <li><b>Result type:</b> <b>symbolic</b> closed forms (low-T asymptotics), plus one illustrative plot with example values.</li>
          <li><b>Part (a) result:</b> per mode (length <i>L</i>), <b>C = (π L / (3ħv)) k<sub>B</sub><sup>2</sup> T</b>.</li>
          <li><b>Part (b) result:</b> ballistic thermal conductance per mode, <b>κ = (π² k<sub>B</sub><sup>2</sup> T)/(3h)</b> (the “quantum of thermal conductance”).</li>
          <li><b>Physical meaning:</b> at low temperatures, each 1D channel carries heat with a universal slope in <i>T</i>, independent of material details (aside from how many modes are available and transmission).</li>
        </ul>

        <div class="callout ok">
          <b>Takeaway:</b> In 1D, linear dispersion + Bose statistics → <b>C ∝ T</b>. With two reservoirs and ballistic transport → <b>κ ∝ T</b>, universal per transmitted mode.
        </div>
        <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
      </section>

      <article id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="card tight">
            <h3>Core definitions (symbols + SI units)</h3>
            <p><b>k</b> — 1D wavevector (m<sup>−1</sup>)</p>
            <p><b>ω</b> — angular frequency (rad·s<sup>−1</sup>)</p>
            <p><b>v</b> — phonon group velocity (m·s<sup>−1</sup>), for linear branch <span class="kbd">v = dω/dk</span></p>
            <p><b>ħ</b> — reduced Planck constant (J·s)</p>
            <p><b>k<sub>B</sub></b> — Boltzmann constant (J·K<sup>−1</sup>)</p>
            <p><b>T</b> — temperature (K)</p>
            <p><b>L</b> — system length (m)</p>
            <p><b>U</b> — internal energy (J); <b>C</b> — heat capacity (J·K<sup>−1</sup>)</p>
            <p><b>κ</b> — thermal conductance (W·K<sup>−1</sup>)</p>
          </div>

          <div class="card tight">
            <h3>Key physical meanings</h3>
            <p><b>Phonons</b> are quantized lattice vibrations carrying energy and heat.</p>
            <p><b>Heat capacity</b> measures how much energy the mode stores per Kelvin.</p>
            <p><b>Thermal conductance</b> measures how much heat current flows for a small temperature difference between reservoirs.</p>
            <p>In <b>1D ballistic</b> transport, scattering is negligible inside the channel; the reservoirs set the occupations.</p>
          </div>
        </div>

        <h3>Key laws/principles + validity conditions</h3>
        <ul>
          <li><b>Bose–Einstein statistics:</b> mean occupation for phonons
            <span class="kbd">n(ω,T)=1/(e^{ħω/kBT}-1)</span>.
            Valid for harmonic (non-interacting) phonons in equilibrium.</li>
          <li><b>Debye / acoustic approximation:</b> low-frequency phonons have approximately <b>linear dispersion</b>,
            <span class="kbd">ω=v|k|</span>. Valid for wavelengths ≫ lattice spacing.</li>
          <li><b>Low-T regime:</b> <span class="kbd">T ≪ Θ<sub>D</sub></span> (Debye temperature), so only small-ω phonons contribute and integrals can be extended to ∞ safely.</li>
          <li><b>Linear response (transport):</b> small temperature difference <span class="kbd">ΔT = T₁−T₂</span>, expand to first order.</li>
        </ul>

        <h3>Common models/approximations (and why)</h3>
        <ul>
          <li><b>Mode counting via periodic boundary conditions:</b> simplifies density of states in 1D.</li>
          <li><b>Debye cutoff ω<sub>D</sub>:</b> enforces correct total number of modes; at low T, the exact cutoff barely matters.</li>
          <li><b>Ballistic (Landauer) picture:</b> treat heat flow as difference of fluxes from two reservoirs, analogous to electrical conductance derivations.</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li>If <b>density of states is constant</b> (1D, linear dispersion), then “available modes per energy” doesn’t grow with energy, and Bose factors dominate → typically <b>U ∝ T²</b>.</li>
          <li>If a single channel transmits perfectly, the heat current is set by universal integrals over Bose functions → <b>κ per mode becomes universal</b> (depends only on constants and T).</li>
        </ul>

        <div class="callout warn">
          <b>What to watch for (pitfalls)</b>
          <ul>
            <li>Mixing up <b>thermal conductivity</b> (W·m<sup>−1</sup>·K<sup>−1</sup>) vs <b>thermal conductance</b> (W·K<sup>−1</sup>). Here we derive <b>conductance</b> of a 1D mode between reservoirs.</li>
            <li>For 1D counting, keep track of <b>left vs right movers</b>. Energy storage counts both; transport uses only movers heading toward the other reservoir.</li>
            <li>Low-T extension of integrals to ∞ is valid only when <span class="kbd">kBT ≪ ħω<sub>D</sub></span>.</li>
          </ul>
        </div>

        <div class="mathinsight">
          <b>Math Insight:</b> The core integrals are <b>universal Bose integrals</b>, e.g.
          <span class="kbd">∫₀^∞ x/(e^x−1) dx</span> and <span class="kbd">∫₀^∞ x² e^x/(e^x−1)² dx</span>.
          Mathematically, these are special-function moments (related to ζ(2) = π²/6) that set the universal low-T slopes.
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

      <article id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <h3>Where this shows up in industry (concrete applications)</h3>
        <ul>
          <li><b>Nanoscale interconnects & packaging:</b> heat flow along nanowires, carbon nanotubes, and ultra-thin bridges can approach the <b>ballistic 1D limit</b> at low T or over short lengths.</li>
          <li><b>MEMS/NEMS sensors:</b> thermal noise and temperature stabilization depend on small heat capacities and conductances of slender beams and tethers.</li>
          <li><b>Quantum hardware cryogenics:</b> dilution-fridge wiring, phononic waveguides, and suspended structures can exhibit <b>quantized thermal conductance</b> relevant to thermal budgeting.</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><b>Performance:</b> limits on heat removal can bottleneck device speed and stability.</li>
          <li><b>Reliability:</b> thermal gradients drive stress, fatigue, and drift in precision components.</li>
          <li><b>Efficiency & cost:</b> at cryogenic temperatures, every microwatt matters; universal conductance per mode helps estimate minimum heat leaks.</li>
        </ul>

        <h3>How it’s measured/validated (brief)</h3>
        <ul>
          <li>Suspended micro-bridges with integrated thermometers/heaters (steady-state heat flow).</li>
          <li>Noise thermometry and Johnson-noise style techniques adapted for phonon systems.</li>
          <li>Time-domain calorimetry: infer <b>C</b> from thermal relaxation time <span class="kbd">τ = C/κ</span> (when lumped-element modeling is appropriate).</li>
        </ul>

        <h3>Design trade-offs & real constraints</h3>
        <ul>
          <li><b>Non-idealities:</b> imperfect transmission (τ(ω)&lt;1), scattering, surface roughness, and mode conversion reduce κ below the ballistic limit.</li>
          <li><b>Multiple modes:</b> real structures have many phonon branches; the single-mode result is a building block.</li>
          <li><b>Manufacturability:</b> tolerances change cross-section → changes the number of propagating modes at a given T.</li>
        </ul>

        <details>
          <summary>From lab to product: adapting the idealized model</summary>
          <p>
            In products, engineers typically use the ballistic single-mode result as a <b>lower bound on thermal resistance</b> (upper bound on κ)
            and then incorporate: (i) frequency-dependent transmission τ(ω), (ii) additional branches (sum over modes), and
            (iii) contact resistances at interfaces. The Landauer form remains useful because it separates
            <b>geometry/material physics</b> (in τ and mode count) from <b>universal thermal statistics</b> (in the Bose integrals).
          </p>
        </details>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

      <article id="part1">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <h3>Restatement (in plain words)</h3>
        <p>
          We consider a <b>single 1D phonon mode</b> (one branch, linear dispersion in Debye approximation).
          (a) Derive the low-temperature heat capacity formula (labeled “(77)” in your source).
          (b) Derive the thermal conductance formula (labeled “(78)”) by computing the net energy flow between two reservoirs at
          temperatures <span class="kbd">T₁</span> and <span class="kbd">T₂</span>, using an approach analogous to Landauer electrical conductance derivations.
        </p>

        <div class="grid2">
          <div class="card">
            <h3>Given</h3>
            <ul>
              <li>1D phonon mode with Debye (acoustic) dispersion: <span class="kbd">ω=v|k|</span>.</li>
              <li>Low temperature regime: <span class="kbd">kBT ≪ ħωD</span> (Debye cutoff).</li>
              <li>Two reservoirs for transport: temperatures <span class="kbd">T₁</span>, <span class="kbd">T₂</span>.</li>
            </ul>
          </div>
          <div class="card">
            <h3>Unknowns (what to derive)</h3>
            <ul>
              <li><b>(a)</b> low-T heat capacity <span class="kbd">C(T)</span> of a single 1D phonon mode (length L).</li>
              <li><b>(b)</b> thermal conductance <span class="kbd">κ(T)</span> of that mode between reservoirs (linear response in ΔT).</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles & why they apply</h3>
        <ul>
          <li><b>Statistical mechanics of bosons:</b> gives mode energy via Bose occupation.</li>
          <li><b>Mode counting / density of states in 1D:</b> converts sums over k into integrals over ω.</li>
          <li><b>Conservation / flux picture for transport:</b> net heat current equals incoming energy flux from left reservoir minus from right reservoir (ballistic Landauer idea).</li>
        </ul>

        <div class="callout">
          <b>Assumptions (explicit)</b>
          <ul>
            <li><b>Harmonic phonons</b> (non-interacting), so occupations follow Bose–Einstein distributions set by reservoirs.</li>
            <li><b>Debye linear dispersion</b> for low ω: <span class="kbd">ω=v|k|</span>.</li>
            <li><b>1D channel</b> of length L with negligible internal scattering (ballistic), perfect transmission for the single mode: <span class="kbd">τ(ω)=1</span>.</li>
            <li><b>Low T</b> so we may extend integrals to ∞ with exponentially small error.</li>
            <li><b>Linear response</b> for conductance: small <span class="kbd">ΔT=T₁−T₂</span>.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <ol>
          <li><b>Density-of-states integral (best for part a):</b> compute U(T) from D(ω) and n(ω,T), then C=dU/dT. <i>Pros:</i> clean, transparent asymptotics. <i>Cons:</i> must do Bose integrals carefully.</li>
          <li><b>Partition function / free energy method:</b> compute F and then C from derivatives. <i>Pros:</i> elegant. <i>Cons:</i> more formal, easy to drop constants; less aligned with transport part.</li>
          <li><b>Landauer flux derivation (best for part b):</b> compute energy current as difference of right-moving fluxes from each reservoir. <i>Pros:</i> matches “analogous to electrical conductance.” <i>Cons:</i> requires careful factor-of-two bookkeeping.</li>
        </ol>

        <p><b>Chosen approach:</b> (a) density-of-states energy integral; (b) Landauer-type energy-flux difference and linearize in ΔT. This matches the problem request and exposes the universal integrals clearly.</p>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

      <article id="part2">
        <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

        <ol>
          <li><b>Set the mathematical model:</b> define 1D domain, dispersion, and thermodynamic state variables.</li>
          <li><b>Convert sum to integral:</b> use periodic boundary conditions to replace <span class="kbd">Σ_k</span> by <span class="kbd">∫ dk</span>.</li>
          <li><b>Compute density of states D(ω):</b> from <span class="kbd">ω=v|k|</span> to get constant D(ω).</li>
          <li><b>Compute internal energy U(T):</b> integrate <span class="kbd">ħω n(ω,T)</span> against D(ω).</li>
          <li><b>Low-T asymptotic:</b> extend ω integral to ∞ and evaluate the universal Bose integral.</li>
          <li><b>Differentiate:</b> obtain <span class="kbd">C=dU/dT</span> and sanity-check units and limits.</li>
          <li><b>Transport flux setup:</b> define energy current as “right-moving flux from left reservoir minus left-moving flux from right reservoir.”</li>
          <li><b>Linearize in ΔT:</b> expand <span class="kbd">n(ω,T₁)−n(ω,T₂) ≈ (∂n/∂T)ΔT</span>.</li>
          <li><b>Evaluate conductance κ:</b> compute <span class="kbd">κ = dQ̇/dΔT</span> and express in terms of h.</li>
          <li><b>Interpretation:</b> connect to quantized thermal conductance and engineering implications.</li>
        </ol>

        <div class="callout warn">
          <b>Common mistakes</b>
          <ul>
            <li>Dropping the factor that distinguishes <b>both directions (storage)</b> vs <b>one direction (transport)</b>.</li>
            <li>Confusing <span class="kbd">h</span> and <span class="kbd">ħ</span>: remember <span class="kbd">h = 2πħ</span>.</li>
            <li>Using Debye cutoff incorrectly at low T; for <span class="kbd">T≪ΘD</span>, extending to ∞ is the correct simplification.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

      <article id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectations (before calculating)</h3>
        <ul>
          <li>In 1D with linear dispersion, the density of states does not grow with ω. Low-T excitations have ω ~ kBT/ħ, so the energy should scale like <b>U ∝ (kBT)²</b> → <b>C ∝ T</b>.</li>
          <li>Ballistic transport in 1D is channel-like: a single mode should contribute a universal thermal conductance proportional to T, analogous to the universal electrical conductance quantum.</li>
        </ul>

        <div class="divider"></div>

        <h3>Mathematical model (explicit)</h3>
        <div class="callout">
          <ul>
            <li><b>Geometry/domain:</b> 1D ring or segment of length <span class="kbd">L</span> with periodic boundary conditions for mode counting.</li>
            <li><b>Field picture:</b> displacement field u(x,t) obeys a wave equation (acoustic branch approximation):
              <span class="kbd">∂²u/∂t² = v² ∂²u/∂x²</span>.
              Plane-wave eigenmodes u ∝ e^{i(kx−ωt)} give dispersion <span class="kbd">ω=v|k|</span>.</li>
            <li><b>Quantum/stat mech:</b> each k-mode is a harmonic oscillator with energy quanta ħω and mean occupation n(ω,T).</li>
            <li><b>Transport setup:</b> two reservoirs (left/right) impose Bose distributions at temperatures T₁ and T₂ for incoming phonons; inside the channel transmission is unity (ballistic).</li>
          </ul>
        </div>

        <div class="mathinsight">
          <b>Math Insight:</b> The wave equation <span class="kbd">∂²u/∂t² − v² ∂²u/∂x² = 0</span> is a linear hyperbolic PDE.
          Its eigenmodes form a Fourier basis (a Sturm–Liouville structure under periodic BCs). Linear dispersion follows from the eigenvalue relation,
          and that linearity is precisely what makes the 1D density of states constant.
        </div>

        <div class="divider"></div>

        <h3>(a) Low-temperature heat capacity of a single 1D phonon mode (Debye approximation)</h3>

        <h4 style="margin:10px 0 6px;">Step 1 — Mode counting and density of states</h4>
        <p>
          With periodic boundary conditions on a length L, allowed wavevectors are
          <span class="kbd">k = 2πn/L</span> with integer n. Thus the spacing is <span class="kbd">Δk = 2π/L</span>.
          Replacing sums by integrals:
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Sum-to-integral rule (1D)</b>
            <button class="btn" data-copy="Σ_k → (L/2π) ∫_{-∞}^{∞} dk">Copy</button>
          </div>
          <pre class="eq">Σ_k  f(k)  →  (L/2π) ∫_{-∞}^{∞} f(k) dk</pre>
        </div>

        <p>
          For a single acoustic branch with <span class="kbd">ω=v|k|</span>, the number of states between k and k+dk is
          <span class="kbd">(L/2π) dk</span> for each sign of k. Converting to ω:
          for k&gt;0, <span class="kbd">k=ω/v</span> so <span class="kbd">dk = dω/v</span>. Accounting for both +k and −k gives a factor 2:
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>1D phonon density of states (per mode)</b>
            <button class="btn" data-copy="D(ω) = L/(π v)   (for ω>0, linear dispersion ω=v|k|)">Copy</button>
          </div>
          <pre class="eq">D(ω) = dN/dω = (L/π) (dk/dω) = (L/π) (1/v) = L/(π v)   (ω>0)</pre>
        </div>

        <div class="callout ok">
          <b>Why this step is valid:</b> linear dispersion makes <span class="kbd">dk/dω</span> constant; periodic BCs make k-states uniformly spaced;
          and symmetry <span class="kbd">ω(v|k|)</span> gives equal contributions from ±k.
        </div>

        <h4 style="margin:10px 0 6px;">Step 2 — Internal energy as an ω-integral</h4>
        <p>
          Ignoring the T-independent zero-point energy (½ħω per oscillator), the thermal internal energy is
          the integral over mode energies ħω weighted by the Bose occupation:
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Internal energy of one 1D phonon branch</b>
            <button class="btn" data-copy="U(T) = ∫_0^{ωD} dω D(ω) (ħω) n(ω,T),   n(ω,T)=1/(e^{ħω/kBT}-1)">Copy</button>
          </div>
          <pre class="eq">U(T) = ∫₀^{ωD} dω  D(ω) (ħω) n(ω,T)
n(ω,T) = 1/(e^{ħω/(kB T)} - 1)</pre>
        </div>

        <p>
          Insert <span class="kbd">D(ω)=L/(πv)</span>:
        </p>
        <div class="eqbox">
          <div class="eqhdr">
            <b>Plug in constant DOS</b>
            <button class="btn" data-copy="U(T) = (L/(π v)) ∫_0^{ωD} dω (ħω)/(e^{ħω/(kBT)}-1)">Copy</button>
          </div>
          <pre class="eq">U(T) = (L/(π v)) ∫₀^{ωD} dω  (ħω)/(e^{ħω/(kB T)} - 1)</pre>
        </div>

        <h4 style="margin:10px 0 6px;">Step 3 — Low-T approximation and nondimensionalization</h4>
        <p>
          In the low-temperature (Debye) limit, <span class="kbd">kBT ≪ ħωD</span>, the integrand is exponentially small for ω ≳ kBT/ħ,
          so extending the upper limit to ∞ changes U by a negligible amount:
          mathematically, the discarded tail is <span class="kbd">O(e^{-ħωD/kBT})</span>.
        </p>

        <p>
          Now nondimensionalize with
          <span class="kbd">x = ħω/(kB T)</span> so <span class="kbd">ω = (kB T/ħ) x</span> and <span class="kbd">dω = (kB T/ħ) dx</span>.
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Low-T energy integral (dimensionless form)</b>
            <button class="btn" data-copy="U(T) ≈ (L/(π v)) (kB T)^2/ħ ∫_0^∞ x/(e^x-1) dx">Copy</button>
          </div>
          <pre class="eq">U(T) ≈ (L/(π v)) ∫₀^∞ dω (ħω)/(e^{ħω/(kB T)}-1)
     = (L/(π v)) (kB T)²/ħ  ∫₀^∞ [ x/(e^x - 1) ] dx</pre>
        </div>

        <div class="callout">
          <b>Dimensional check:</b> <span class="kbd">(kB T)²/ħ</span> has units (J²)/(J·s)=J/s; multiplying by (L/v) gives seconds → J. Good.
        </div>

        <h4 style="margin:10px 0 6px;">Step 4 — Evaluate the universal Bose integral</h4>
        <p>
          The standard result is:
          <span class="kbd">∫₀^∞ x/(e^x−1) dx = π²/6</span>.
          (It follows from the series <span class="kbd">1/(e^x−1)=Σ_{m≥1} e^{-mx}</span> and term-by-term integration.)
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Internal energy at low T</b>
            <button class="btn" data-copy="U(T) ≈ (π L/(6 v ħ)) kB^2 T^2">Copy</button>
          </div>
          <pre class="eq">U(T) ≈ (L/(π v)) (kB T)²/ħ · (π²/6)
     = (π L/(6 v ħ)) kB² T²</pre>
        </div>

        <h4 style="margin:10px 0 6px;">Step 5 — Differentiate to get heat capacity</h4>
        <p>
          Heat capacity at constant volume/length (for this 1D mode) is
          <span class="kbd">C = dU/dT</span>:
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Heat capacity (single 1D phonon mode, Debye low-T)</b>
            <button class="btn" data-copy="C(T) = dU/dT ≈ (π L/(3 v ħ)) kB^2 T">Copy</button>
          </div>
          <pre class="eq">C(T) = dU/dT ≈ d/dT [ (π L/(6 v ħ)) kB² T² ]
     = (π L/(3 v ħ)) kB² T</pre>
        </div>

        <div class="callout ok">
          <b>Sanity checks:</b>
          <ul>
            <li><b>Units:</b> (L/(vħ))kB²T → (m/(m/s·J·s))·(J²/K²)·K = J/K. Good.</li>
            <li><b>Limiting behavior:</b> C→0 as T→0 (third law consistent).</li>
            <li><b>Scaling:</b> linear in L (more length = more states) and inversely with v (slower waves = higher DOS = larger C).</li>
          </ul>
        </div>

        <div class="divider"></div>

        <h3>(b) Thermal conductance of a 1D phonon mode between two reservoirs (Landauer-style)</h3>

        <h4 style="margin:10px 0 6px;">Step 1 — Energy flux (one direction) for a ballistic 1D mode</h4>
        <p>
          For transport we care about <b>right-moving</b> phonons coming from the left reservoir and <b>left-moving</b> phonons coming from the right reservoir.
          The key Landauer insight is that in 1D the product “density of states per length” times “group velocity” becomes a constant, yielding a universal
          prefactor for the flux.
        </p>

        <p>
          Right-movers have k&gt;0. The number of right-moving states in [k, k+dk] is
          <span class="kbd">(L/2π) dk</span>, so per unit length it is <span class="kbd">(1/2π) dk</span>.
          The group velocity is <span class="kbd">v_g = dω/dk = v</span> (constant).
          The energy carried per phonon is ħω.
          Therefore the right-moving energy current density (power per area; in 1D just power) from a reservoir at temperature T is:
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Energy current from one reservoir (right-movers only)</b>
            <button class="btn" data-copy="Qdot_→(T) = ∫_0^∞ (dk/2π) v (ħω) n(ω,T) = ∫_0^∞ (dω/2π) (ħω) n(ω,T)">Copy</button>
          </div>
          <pre class="eq">Q̇→(T) = ∫₀^∞ (dk/2π) v · (ħω) · n(ω,T)

Using ω = v k (k>0) ⇒ dω = v dk:
Q̇→(T) = ∫₀^∞ (dω/2π) (ħω) n(ω,T)</pre>
        </div>

        <div class="callout">
          <b>Why this step is valid:</b> It is a conservation/flux statement: “(states per length) × (speed) × (energy per state) × (occupation)”.
          The cancellation producing the simple <span class="kbd">dω/2π</span> measure is the same mathematical mechanism behind Landauer conductance quantization.
        </div>

        <h4 style="margin:10px 0 6px;">Step 2 — Net heat current between two reservoirs</h4>
        <p>
          If the left reservoir is at T₁ and the right at T₂, and transmission is perfect (τ=1), the net heat current is
          outgoing right-movers from left minus outgoing left-movers from right:
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Landauer form for phonon heat current (single mode)</b>
            <button class="btn" data-copy="Qdot = (1/2π) ∫_0^∞ dω (ħω) [ n(ω,T1) - n(ω,T2) ]">Copy</button>
          </div>
          <pre class="eq">Q̇ = Q̇→(T₁) - Q̇←(T₂)
   = (1/2π) ∫₀^∞ dω (ħω) [ n(ω,T₁) - n(ω,T₂) ]</pre>
        </div>

        <h4 style="margin:10px 0 6px;">Step 3 — Linear response in ΔT and definition of thermal conductance</h4>
        <p>
          For small <span class="kbd">ΔT = T₁ − T₂</span>, expand:
          <span class="kbd">n(ω,T₁) − n(ω,T₂) ≈ (∂n/∂T) ΔT</span>,
          evaluated at the common temperature T (e.g., average temperature).
          Then define thermal conductance:
          <span class="kbd">κ ≡ Q̇/ΔT</span>.
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Thermal conductance as a Bose integral</b>
            <button class="btn" data-copy="κ(T) = (1/2π) ∫_0^∞ dω (ħω) (∂n/∂T)">Copy</button>
          </div>
          <pre class="eq">κ(T) = Q̇/ΔT ≈ (1/2π) ∫₀^∞ dω (ħω) (∂n/∂T)</pre>
        </div>

        <h4 style="margin:10px 0 6px;">Step 4 — Compute ∂n/∂T explicitly (no “magic jumps”)</h4>
        <p>
          Let <span class="kbd">x = ħω/(kB T)</span>, and <span class="kbd">n = 1/(e^x−1)</span>.
          Then
          <span class="kbd">dn/dx = − e^x/(e^x−1)²</span>
          and
          <span class="kbd">dx/dT = −(ħω)/(kB T²) = −x/T</span>.
          By chain rule:
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Derivative of Bose function</b>
            <button class="btn" data-copy="∂n/∂T = (x/T) * e^x/(e^x-1)^2,  x=ħω/(kBT)">Copy</button>
          </div>
          <pre class="eq">∂n/∂T = (dn/dx)(dx/dT)
      = [ - e^x/(e^x-1)² ] · [ -x/T ]
      = (x/T) · e^x/(e^x-1)²</pre>
        </div>

        <h4 style="margin:10px 0 6px;">Step 5 — Nondimensionalize κ and evaluate the universal integral</h4>
        <p>
          Substitute x and convert dω to dx:
          <span class="kbd">dω = (kB T/ħ) dx</span>,
          <span class="kbd">ħω = kB T x</span>.
          Then:
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>κ integral in dimensionless form</b>
            <button class="btn" data-copy="κ(T) = (kB^2 T)/(2πħ) ∫_0^∞ x^2 e^x/(e^x-1)^2 dx">Copy</button>
          </div>
          <pre class="eq">κ(T) = (1/2π) ∫₀^∞ dω (ħω) (∂n/∂T)

Let x = ħω/(kB T) ⇒ dω = (kB T/ħ) dx,  ħω = kB T x

κ(T) = (1/2π) ∫₀^∞ (kB T/ħ) dx · (kB T x) · (x/T) e^x/(e^x-1)²
     = (kB² T)/(2π ħ) ∫₀^∞ x² e^x/(e^x-1)² dx</pre>
        </div>

        <p>
          The universal integral is:
          <span class="kbd">∫₀^∞ x² e^x/(e^x−1)² dx = π²/3</span>.
          Therefore:
        </p>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Thermal conductance (single ballistic phonon mode)</b>
            <button class="btn" data-copy="κ(T) = (kB^2 T)/(2πħ) * (π^2/3) = (π^2 kB^2 T)/(3h)">Copy</button>
          </div>
          <pre class="eq">κ(T) = (kB² T)/(2π ħ) · (π²/3)
     = (π kB² T)/(6 ħ)

Using h = 2πħ:
κ(T) = (π² kB² T)/(3 h)</pre>
        </div>

        <div class="callout ok">
          <b>Sanity checks:</b>
          <ul>
            <li><b>Units:</b> kB²T/h → (J²/K²)·K / (J·s) = J/(K·s) = W/K. Good.</li>
            <li><b>Limit T→0:</b> κ→0 (no thermal carriers).</li>
            <li><b>Universality:</b> independent of v and L for a perfectly transmitted mode — a hallmark of the Landauer channel picture.</li>
          </ul>
        </div>

        <h3>One simple static plot (example values)</h3>
        <figure>
          <canvas id="plot" width="1200" height="675" aria-label="Plot of quantum thermal conductance vs temperature"></canvas>
          <figcaption>
            Example plot: single-mode ballistic thermal conductance <span class="kbd">κ = (π² kB² / (3h)) T</span> (linear in T).
            (Values shown are computed from physical constants; this is an illustration, not needed for the symbolic derivation.)
          </figcaption>
        </figure>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

      <article id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpret the final formulas</h3>
        <div class="grid2">
          <div class="card">
            <h3>Heat capacity (storage)</h3>
            <p>
              <b>C(T) ≈ (π L/(3ħv)) kB² T</b>
            </p>
            <ul>
              <li><b>L</b> increases the number of available k-states → more energy storage.</li>
              <li><b>1/v</b> increases DOS (slower waves pack more states per frequency) → larger C.</li>
              <li><b>Linear in T</b> is the 1D Debye signature for a single linear branch.</li>
            </ul>
          </div>
          <div class="card">
            <h3>Thermal conductance (transport)</h3>
            <p>
              <b>κ(T) = (π² kB² / (3h)) T</b> (per transmitted mode)
            </p>
            <ul>
              <li>No explicit v or L: the 1D channel flux is set by universal phase-space + statistics.</li>
              <li>In real devices, multiply by <b>number of modes</b> and include <b>transmission τ(ω)</b>.</li>
              <li>Often called the <b>quantum of thermal conductance</b> per mode in the ballistic limit.</li>
            </ul>
          </div>
        </div>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li><b>Increase T:</b> both C and κ increase linearly (in this low-T, single-mode regime).</li>
          <li><b>Change material (v):</b> C changes (∝1/v), but κ does not (if ballistic and single-mode).</li>
          <li><b>Add modes:</b> C adds across branches; κ adds across transmitted channels in parallel (Landauer sum).</li>
          <li><b>Add scattering:</b> reduces κ by making τ(ω)&lt;1, often making κ length-dependent (diffusive regime), unlike the ballistic result.</li>
        </ul>

        <details>
          <summary>Alternative derivation idea (brief but meaningful)</summary>
          <p>
            Instead of using density of states for part (a), one can compute the free energy
            <span class="kbd">F = kB T Σ_k ln(1 − e^{−βħω_k})</span>, convert the sum to an integral, and obtain
            <span class="kbd">U = F − T(∂F/∂T)</span> and <span class="kbd">C = ∂U/∂T</span>.
            This route highlights the role of the logarithm of the Bose partition function and connects naturally to field-theory treatments of 1D bosons.
          </p>
        </details>

        <h3>Concept check (self-test with answers)</h3>
        <ul>
          <li><b>Q:</b> Why is the 1D DOS constant for ω=v|k|? <b>A:</b> Because <span class="kbd">D(ω) ∝ dk/dω = 1/v</span>, and v is constant in the linear approximation.</li>
          <li><b>Q:</b> Why can we extend ωD→∞ at low T? <b>A:</b> Because the Bose factor suppresses ω ≫ kBT/ħ exponentially, so the missing tail is exponentially small.</li>
          <li><b>Q:</b> Why does κ not depend on v for ballistic transport? <b>A:</b> In 1D, DOS ∝ 1/v while flux includes a factor v; they cancel, leaving a universal result.</li>
          <li><b>Q:</b> What changes if transmission is imperfect? <b>A:</b> Replace the integrand by τ(ω)[n(T₁)−n(T₂)], and κ drops below the universal value.</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

      <article id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p>
          The plot shows the linear law
          <span class="kbd">κ(T) = (π² kB² / (3h)) T</span> for a single perfectly transmitting 1D phonon mode.
        </p>
        <ul>
          <li><b>x-axis:</b> Temperature T (K)</li>
          <li><b>y-axis:</b> Thermal conductance κ (W/K)</li>
          <li><b>Example values:</b> computed using physical constants (kB, h), so the slope is universal.</li>
          <li><b>What to notice:</b> straight line through the origin; at low T the channel “turns off” as κ→0.</li>
        </ul>
        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

      <article id="final">
        <h2>Final Answer (copy-ready)</h2>

        <div class="eqbox">
          <div class="eqhdr">
            <b>Final results</b>
            <button class="btn" id="copyFinal">Copy final answer</button>
          </div>
          <pre class="eq" id="finalText">Part (a) — Low-T heat capacity of a single 1D phonon mode (Debye/linear dispersion ω=v|k|):
D(ω)=L/(πv)  (ω>0)
U(T) ≈ (L/(πv)) ∫₀^∞ dω (ħω)/(e^{ħω/(kBT)}−1) = (πL/(6vħ)) kB² T²
C(T)=dU/dT ≈ (πL/(3vħ)) kB² T

Part (b) — Thermal conductance between reservoirs at T₁ and T₂ (ballistic, τ=1):
Q̇ = (1/2π) ∫₀^∞ dω (ħω)[n(ω,T₁)−n(ω,T₂)]
For small ΔT=T₁−T₂:
κ(T)=Q̇/ΔT ≈ (1/2π) ∫₀^∞ dω (ħω)(∂n/∂T)
with n=1/(e^{ħω/(kBT)}−1) ⇒ ∂n/∂T = (x/T) e^x/(e^x−1)², x=ħω/(kBT)
⇒ κ(T) = (kB²T)/(2πħ) ∫₀^∞ x² e^x/(e^x−1)² dx = (kB²T)/(2πħ)·(π²/3)
Therefore:
κ(T) = (πkB²T)/(6ħ) = (π² kB² T)/(3h)   (quantum of thermal conductance per mode)</pre>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </article>

    </div>
  </main>

  <footer>
    <div class="divider"></div>
    <p>
      Notes: Results assume a single perfectly transmitted 1D acoustic phonon branch in the Debye (linear) regime and low temperatures
      <span class="kbd">kBT ≪ ħωD</span>. In practice, sum over modes and include transmission τ(ω) and contact resistances.
    </p>
  </footer>

  <script>
    // Copy buttons
    function copyText(txt){
      navigator.clipboard.writeText(txt).then(()=> {
        // subtle feedback without intrusive UI
      }).catch(()=>{});
    }
    document.querySelectorAll('[data-copy]').forEach(btn=>{
      btn.addEventListener('click', ()=>copyText(btn.getAttribute('data-copy')));
    });
    document.getElementById('copyFinal').addEventListener('click', ()=>{
      copyText(document.getElementById('finalText').innerText);
    });

    // Canvas plot: κ(T) vs T using physical constants (example)
    (function(){
      const canvas = document.getElementById('plot');
      const ctx = canvas.getContext('2d');

      function resizeAndDraw(){
        const dpr = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();
        const w = Math.max(600, Math.floor(rect.width * dpr));
        const h = Math.floor((rect.width * 9/16) * dpr);
        canvas.width = w;
        canvas.height = h;

        // constants (SI)
        const kB = 1.380649e-23;      // J/K
        const hPlanck = 6.62607015e-34; // J*s
        const slope = (Math.PI*Math.PI * kB*kB) / (3*hPlanck); // W/K^2

        // example range
        const Tmin = 0.0, Tmax = 1.2; // K (example, cryogenic-ish)
        function kappa(T){ return slope * T; }

        // margins
        const m = {l: 78*dpr, r: 18*dpr, t: 42*dpr, b: 64*dpr};
        const plotW = w - m.l - m.r;
        const plotH = h - m.t - m.b;

        const Kmin = kappa(Tmin);
        const Kmax = kappa(Tmax);

        function xMap(T){ return m.l + (T - Tmin) / (Tmax - Tmin) * plotW; }
        function yMap(K){ return m.t + (1 - (K - Kmin) / (Kmax - Kmin)) * plotH; }

        // background
        ctx.clearRect(0,0,w,h);
        ctx.fillStyle = "rgba(10,14,20,0.35)";
        ctx.fillRect(0,0,w,h);

        // title
        ctx.fillStyle = "rgba(232,238,247,0.95)";
        ctx.font = `${18*dpr}px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial`;
        ctx.fillText("Single-mode ballistic thermal conductance: κ(T) = (π² kB² / 3h) T", m.l, 24*dpr);

        // axes and grid
        ctx.strokeStyle = "rgba(255,255,255,0.18)";
        ctx.lineWidth = 1*dpr;

        // grid lines
        const xTicks = 6;
        const yTicks = 5;

        // grid vertical
        for(let i=0;i<=xTicks;i++){
          const T = Tmin + (Tmax-Tmin)*i/xTicks;
          const x = xMap(T);
          ctx.beginPath();
          ctx.moveTo(x, m.t);
          ctx.lineTo(x, m.t+plotH);
          ctx.strokeStyle = "rgba(255,255,255,0.08)";
          ctx.stroke();
        }
        // grid horizontal
        for(let j=0;j<=yTicks;j++){
          const K = Kmin + (Kmax-Kmin)*j/yTicks;
          const y = yMap(K);
          ctx.beginPath();
          ctx.moveTo(m.l, y);
          ctx.lineTo(m.l+plotW, y);
          ctx.strokeStyle = "rgba(255,255,255,0.08)";
          ctx.stroke();
        }

        // axes
        ctx.strokeStyle = "rgba(255,255,255,0.22)";
        ctx.beginPath();
        ctx.moveTo(m.l, m.t);
        ctx.lineTo(m.l, m.t+plotH);
        ctx.lineTo(m.l+plotW, m.t+plotH);
        ctx.stroke();

        // tick labels
        ctx.fillStyle = "rgba(168,179,199,0.95)";
        ctx.font = `${12*dpr}px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace`;

        // x ticks
        for(let i=0;i<=xTicks;i++){
          const T = Tmin + (Tmax-Tmin)*i/xTicks;
          const x = xMap(T);
          const y0 = m.t+plotH;
          ctx.strokeStyle = "rgba(255,255,255,0.22)";
          ctx.beginPath();
          ctx.moveTo(x, y0);
          ctx.lineTo(x, y0+6*dpr);
          ctx.stroke();
          const label = T.toFixed(2);
          ctx.fillText(label, x-10*dpr, y0+22*dpr);
        }

        // y ticks (use scientific notation)
        for(let j=0;j<=yTicks;j++){
          const K = Kmin + (Kmax-Kmin)*j/yTicks;
          const y = yMap(K);
          ctx.strokeStyle = "rgba(255,255,255,0.22)";
          ctx.beginPath();
          ctx.moveTo(m.l-6*dpr, y);
          ctx.lineTo(m.l, y);
          ctx.stroke();

          // label at left
          const exp = K === 0 ? 0 : Math.floor(Math.log10(Math.abs(K)));
          const mant = K === 0 ? 0 : K / Math.pow(10, exp);
          const label = (K === 0) ? "0" : `${mant.toFixed(2)}e${exp}`;
          ctx.fillText(label, 6*dpr, y+4*dpr);
        }

        // axis labels
        ctx.fillStyle = "rgba(232,238,247,0.90)";
        ctx.font = `${13*dpr}px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial`;
        ctx.fillText("Temperature T (K)", m.l + plotW*0.35, h - 22*dpr);

        // y label (rotated)
        ctx.save();
        ctx.translate(18*dpr, m.t + plotH*0.62);
        ctx.rotate(-Math.PI/2);
        ctx.fillText("Thermal conductance κ (W/K)", 0, 0);
        ctx.restore();

        // plot line
        ctx.strokeStyle = "rgba(110,231,255,0.92)";
        ctx.lineWidth = 2*dpr;
        ctx.beginPath();
        for(let i=0;i<=200;i++){
          const T = Tmin + (Tmax-Tmin)*i/200;
          const K = kappa(T);
          const x = xMap(T);
          const y = yMap(K);
          if(i===0) ctx.moveTo(x,y);
          else ctx.lineTo(x,y);
        }
        ctx.stroke();

        // legend
        const lx = m.l + plotW - 220*dpr;
        const ly = m.t + 10*dpr;
        ctx.fillStyle = "rgba(16,24,38,0.65)";
        ctx.strokeStyle = "rgba(255,255,255,0.14)";
        ctx.lineWidth = 1*dpr;
        ctx.beginPath();
        ctx.roundRect(lx, ly, 200*dpr, 44*dpr, 12*dpr);
        ctx.fill();
        ctx.stroke();

        ctx.strokeStyle = "rgba(110,231,255,0.92)";
        ctx.lineWidth = 2*dpr;
        ctx.beginPath();
        ctx.moveTo(lx+14*dpr, ly+22*dpr);
        ctx.lineTo(lx+54*dpr, ly+22*dpr);
        ctx.stroke();

        ctx.fillStyle = "rgba(232,238,247,0.92)";
        ctx.font = `${12*dpr}px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial`;
        ctx.fillText("κ(T) per mode (ballistic)", lx+64*dpr, ly+26*dpr);
      }

      // Polyfill for roundRect if needed
      if(!CanvasRenderingContext2D.prototype.roundRect){
        CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
          const rr = Math.min(r, w/2, h/2);
          this.beginPath();
          this.moveTo(x+rr, y);
          this.arcTo(x+w, y, x+w, y+h, rr);
          this.arcTo(x+w, y+h, x, y+h, rr);
          this.arcTo(x, y+h, x, y, rr);
          this.arcTo(x, y, x+w, y, rr);
          this.closePath();
          return this;
        };
      }

      window.addEventListener('resize', resizeAndDraw, {passive:true});
      resizeAndDraw();
    })();
  </script>
</body>
</html>