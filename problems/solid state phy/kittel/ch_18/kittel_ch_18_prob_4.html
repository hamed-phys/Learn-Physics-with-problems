<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Barriers in Series, Ohm’s Law, and the 1D Drude–Landauer Connection</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1621;
      --card:#121b27;
      --ink:#e8eef7;
      --muted:#b7c3d6;
      --faint:#7f8da3;
      --accent:#7dd3fc;
      --accent2:#a7f3d0;
      --warn:#fbbf24;
      --ok:#34d399;
      --bad:#fb7185;
      --line:rgba(255,255,255,0.10);
      --shadow: 0 10px 30px rgba(0,0,0,0.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 20% -10%, rgba(125,211,252,0.18), transparent 55%),
                  radial-gradient(1100px 650px at 90% 0%, rgba(167,243,208,0.12), transparent 55%),
                  var(--bg);
      color:var(--ink);
      line-height:1.55;
    }

    header{
      padding: clamp(18px, 2.6vw, 34px) clamp(16px, 4vw, 46px);
      border-bottom:1px solid var(--line);
      background: linear-gradient(to bottom, rgba(255,255,255,0.04), transparent);
    }

    .title{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    h1{
      font-size: clamp(1.35rem, 2.6vw, 2.05rem);
      margin:0;
      letter-spacing:0.2px;
    }
    .subtitle{
      margin-top:6px;
      color:var(--muted);
      max-width: 72ch;
      font-size: 0.98rem;
    }

    main{
      display:grid;
      grid-template-columns: 280px 1fr;
      gap: 22px;
      padding: 20px clamp(14px, 4vw, 46px) 40px;
      max-width: 1220px;
      margin: 0 auto;
    }

    nav#toc{
      position: sticky;
      top: 14px;
      align-self:start;
      background: rgba(18,27,39,0.72);
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding: 14px 14px 12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    nav#toc h2{
      margin:0 0 10px 0;
      font-size:0.95rem;
      color: var(--muted);
      letter-spacing:0.2px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .toc-links{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin:0;
      padding:0;
      list-style:none;
      max-height: calc(100vh - 140px);
      overflow:auto;
    }
    .toc-links a{
      text-decoration:none;
      color: var(--ink);
      padding:8px 10px;
      border-radius:12px;
      border:1px solid transparent;
      background: rgba(255,255,255,0.03);
      transition: transform 120ms ease, border-color 120ms ease, background 120ms ease;
      font-size:0.93rem;
    }
    .toc-links a:hover{
      border-color: rgba(125,211,252,0.35);
      background: rgba(125,211,252,0.08);
      transform: translateY(-1px);
    }

    article{
      min-width:0;
    }

    section{
      background: rgba(18,27,39,0.62);
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding: clamp(14px, 2.2vw, 22px);
      margin-bottom: 18px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    section h2{
      margin:0 0 10px 0;
      font-size: 1.15rem;
      letter-spacing:0.2px;
    }
    section h3{
      margin: 16px 0 8px 0;
      font-size: 1.02rem;
      color: var(--muted);
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 980px){
      main{grid-template-columns: 1fr}
      nav#toc{position:relative; top:0}
      .grid2{grid-template-columns: 1fr}
    }

    .callout{
      border:1px solid var(--line);
      background: rgba(255,255,255,0.03);
      border-radius: 16px;
      padding: 12px 12px;
    }
    .callout strong{color:var(--accent)}
    .callout.warn strong{color:var(--warn)}
    .callout.ok strong{color:var(--ok)}
    .callout.bad strong{color:var(--bad)}
    .small{color:var(--muted); font-size:0.95rem}
    .muted{color:var(--muted)}
    .faint{color:var(--faint)}
    ul{margin:10px 0 0 18px}
    li{margin: 6px 0}

    .eqbox{
      margin-top: 10px;
      border:1px solid rgba(125,211,252,0.25);
      background: linear-gradient(180deg, rgba(125,211,252,0.10), rgba(255,255,255,0.02));
      border-radius: 16px;
      padding: 12px;
      position:relative;
      overflow:hidden;
    }
    .eqbox::before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(700px 170px at 20% 0%, rgba(125,211,252,0.18), transparent 55%);
      pointer-events:none;
    }
    pre{
      margin:0;
      padding: 10px 10px;
      background: rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      overflow:auto;
      font-family: var(--mono);
      font-size: 0.95rem;
      line-height:1.45;
      position:relative;
      z-index:1;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .btnrow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
      align-items:center;
    }
    button.copy{
      appearance:none;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.04);
      color: var(--ink);
      padding: 8px 10px;
      border-radius: 12px;
      cursor:pointer;
      transition: transform 120ms ease, border-color 120ms ease, background 120ms ease;
      font-size: 0.92rem;
    }
    button.copy:hover{
      border-color: rgba(125,211,252,0.35);
      background: rgba(125,211,252,0.08);
      transform: translateY(-1px);
    }
    .pill{
      font-family: var(--mono);
      font-size:0.88rem;
      color: var(--muted);
      border:1px solid var(--line);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,0.18);
    }

    details{
      border:1px solid rgba(255,255,255,0.10);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(0,0,0,0.16);
      margin-top: 12px;
    }
    details summary{
      cursor:pointer;
      color: var(--accent2);
      font-weight: 600;
      letter-spacing:0.2px;
    }

    figure{
      margin: 12px 0 0 0;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.18);
      border-radius: 16px;
      padding: 12px;
    }
    figcaption{
      color: var(--muted);
      font-size: 0.92rem;
      margin-top: 8px;
    }
    canvas{width:100%; height:auto; display:block}

    .backtop{
      display:inline-block;
      margin-top: 12px;
      color: var(--accent);
      text-decoration:none;
      font-weight:600;
    }
    .backtop:hover{text-decoration:underline}

    footer{
      padding: 20px clamp(14px, 4vw, 46px) 34px;
      color: var(--muted);
      border-top:1px solid var(--line);
      background: linear-gradient(to top, rgba(255,255,255,0.04), transparent);
    }

    @media print{
      body{background:#fff; color:#000}
      header, footer, nav#toc{display:none !important}
      main{display:block; padding:0}
      section{box-shadow:none; backdrop-filter:none; background:#fff; border:1px solid #ddd; page-break-inside:avoid}
      a{color:#000}
      pre{background:#f7f7f7; color:#000}
    }
  </style>
</head>

<body>
<header id="top">
  <div class="title">
    <div>
      <h1>Barriers in Series and Ohm’s Law (Landauer ↔ Drude in 1D)</h1>
      <p class="subtitle">
        We connect two “languages” for conduction: (i) <span class="muted">Landauer</span> transmission through barriers and
        series addition of “barrier resistances”, and (ii) <span class="muted">Drude</span> conductivity with a momentum-relaxation time.
        The payoff is an explicit 1D identity: <span class="pill">σ<sub>1D</sub> = (2e²/h) ℓ<sub>e</sub></span>.
      </p>
    </div>
    <div class="pill">Applied physics + industrial engineering lens</div>
  </div>
</header>

<main>
  <nav id="toc" aria-label="Table of contents">
    <h2>Contents <span class="pill">sticky</span></h2>
    <ul class="toc-links">
      <li><a href="#qs">Quick Summary</a></li>
      <li><a href="#part0">PART 0 — Concept Primer</a></li>
      <li><a href="#part0b">PART 0B — Industry & Applied Physics</a></li>
      <li><a href="#part1">PART 1 — Problem Analysis</a></li>
      <li><a href="#part2">PART 2 — Strategy & Tips</a></li>
      <li><a href="#part3">PART 3 — Full Solution</a></li>
      <li><a href="#part4">PART 4 — Deeper Understanding</a></li>
      <li><a href="#part5">PART 5 — Optional Plot Guide</a></li>
    </ul>
  </nav>

  <article>
    <section id="qs">
      <h2>Quick Summary</h2>
      <ul>
        <li><strong>What this is about:</strong> how multiple scattering barriers in series produce <em>Ohm’s law</em> (resistance ∝ length) and how this matches the 1D Drude model.</li>
        <li><strong>Key physics idea:</strong> in 1D, elastic scattering mainly matters through <em>backscattering</em> (p → −p). Series barriers add in an “incoherent” (phase-randomized) way.</li>
        <li><strong>Governing relations:</strong> Landauer two-terminal conductance <span class="pill">G = (2e²/h) T</span> and Drude <span class="pill">σ<sub>1D</sub> = n<sub>1D</sub> e² τ / m</span>.</li>
        <li><strong>Series barriers result:</strong> define <span class="pill">r ≡ (1−T)/T</span>; then for incoherent barriers in series <span class="pill">r<sub>tot</sub> = Σ r<sub>i</sub></span> and <span class="pill">T<sub>tot</sub> = 1/(1+r<sub>tot</sub>)</span>.</li>
        <li><strong>Ohmic (diffusive) limit:</strong> for a long wire, <span class="pill">G ≈ (2e²/h)(ℓ<sub>e</sub>/L)</span>, hence resistance grows linearly with L.</li>
        <li><strong>Main identity (part b):</strong> using 1D kinematics and τ vs backscattering time τ<sub>b</sub>, <span class="pill">σ<sub>1D</sub> = (2e²/h) ℓ<sub>e</sub></span> with ℓ<sub>e</sub> = v<sub>F</sub> τ<sub>b</sub>.</li>
        <li><strong>Result type:</strong> fully symbolic; one plot (example values) illustrates crossover from ballistic to ohmic.</li>
      </ul>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part0">
      <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

      <div class="grid2">
        <div class="callout">
          <strong>Core definitions (symbols + SI units)</strong>
          <ul>
            <li>e: elementary charge (C)</li>
            <li>h, ħ: Planck constants (J·s), with h = 2πħ</li>
            <li>T: transmission probability of a barrier (dimensionless, 0…1)</li>
            <li>G: two-terminal conductance (S)</li>
            <li>R: two-terminal resistance (Ω), R = 1/G</li>
            <li>n<sub>1D</sub>: 1D carrier density per length (m⁻¹)</li>
            <li>τ: momentum-relaxation time (s)</li>
            <li>τ<sub>b</sub>: backscattering time (s) (rate of p → −p)</li>
            <li>v<sub>F</sub>: Fermi velocity (m/s)</li>
            <li>ℓ<sub>e</sub>: elastic mean free path (m)</li>
            <li>σ<sub>1D</sub>: “1D conductivity” (S·m), i.e. conductance times length</li>
          </ul>
        </div>

        <div class="callout">
          <strong>Physical meaning (intuition)</strong>
          <ul>
            <li><em>Landauer:</em> conduction is limited by how well waves/particles transmit through scatterers: higher T → larger G.</li>
            <li><em>Drude:</em> carriers accelerate between scattering events; scattering relaxes momentum, producing a steady drift velocity.</li>
            <li>In 1D, “momentum relaxation” is essentially “how fast you get reversed,” because there are only two directions.</li>
            <li>Series barriers become “Ohmic” when phases are randomized and many weak backscattering events accumulate.</li>
          </ul>
        </div>
      </div>

      <h3>Key laws/principles and validity conditions</h3>
      <ul>
        <li><strong>Landauer (two-terminal, single 1D channel with spin):</strong> G = (2e²/h) T. Valid in linear response, phase-coherent within each scattering region; T is the total transmission of the device between reservoirs.</li>
        <li><strong>Incoherent series addition:</strong> requires phase randomization between barriers (e.g., due to inelastic processes or many modes / disorder averaging), so interference averages out.</li>
        <li><strong>Drude:</strong> assumes semiclassical carriers with an effective mass m, weak electric fields (linear response), and a well-defined relaxation time τ.</li>
      </ul>

      <h3>Common models/approximations used here</h3>
      <ul>
        <li><strong>1D Fermi gas</strong> with two spin states (degeneracy g<sub>s</sub>=2) and parabolic band ε(p)=p²/(2m).</li>
        <li><strong>Elastic scattering:</strong> energy conserved; only momentum direction changes.</li>
        <li><strong>Phase randomization</strong> between barriers so we can add “barrier resistances” rather than amplitudes.</li>
      </ul>

      <h3>Mini intuition examples (minimal algebra)</h3>
      <ul>
        <li>If a single barrier has T=1 (perfect), then G=(2e²/h): the quantum of conductance for one spin-degenerate channel.</li>
        <li>If you add a weak second barrier far away with dephasing in between, the total resistance increases roughly by the sum of individual “excess resistances.”</li>
        <li>In a long disordered wire, many small backscattering events produce G ∝ 1/L → Ohm’s law.</li>
      </ul>

      <div class="callout warn">
        <strong>What to watch for (pitfalls)</strong>
        <ul>
          <li>Two-terminal Landauer resistance includes <em>contact resistance</em> even when T=1.</li>
          <li>Don’t confuse mean free path ℓ with device length L; “Ohmic” refers to L ≫ ℓ.</li>
          <li>In 1D, τ (momentum relaxation) differs from τ<sub>b</sub> (backscattering) by a factor 2: 1/τ = 2/τ<sub>b</sub>.</li>
          <li>Series addition depends on coherence: coherent barriers can interfere and violate simple resistance additivity.</li>
        </ul>
      </div>

      <div class="callout">
        <strong>Math Insight</strong>
        <p class="small">
          The “series barrier” rule can be viewed as a <em>conservation-law</em> statement for right/left mover fluxes:
          a linear system mapping incoming fluxes to outgoing fluxes. Under dephasing, only intensities (probabilities)
          remain, turning wave composition into an algebra of <em>Markov-like</em> scattering of two states (→, ←).
        </p>
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part0b">
      <h2>PART 0B — Industry & Applied Physics Perspective</h2>
      <ul>
        <li><strong>Where it appears (3+ concrete areas):</strong>
          <ul>
            <li><em>Semiconductor nanowires / FinFET channels / gate-all-around devices:</em> short-channel transport crosses from ballistic to diffusive; barrier-like scattering from roughness and impurities.</li>
            <li><em>Interconnects and narrow metals:</em> grain boundaries act like series barriers; resistivity increases as dimensions shrink (size effects).</li>
            <li><em>2D-material ribbons (graphene nanoribbons, MoS₂ edges):</em> edge disorder introduces backscattering in quasi-1D modes.</li>
            <li><em>Quantum point contacts & metrology:</em> conductance quantization uses Landauer; series imperfections degrade T and hence G.</li>
          </ul>
        </li>
        <li><strong>Why engineers care:</strong> determines <em>performance</em> (RC delay, drive current), <em>energy</em> (I²R losses), <em>reliability</em> (self-heating, electromigration), and <em>yield</em> (sensitivity to defects acting as barriers).</li>
        <li><strong>Typical measurement/validation:</strong> low-bias I–V for linear response; temperature dependence to separate elastic vs inelastic scattering; four-probe vs two-probe to handle contact resistance; mobility extraction and mean free path estimation.</li>
        <li><strong>Design trade-offs:</strong> reducing scattering (larger ℓ<sub>e</sub>) may demand cleaner materials/processing (cost); increasing cross-section reduces boundary scattering but conflicts with scaling; contacts can dominate measured resistance in short devices.</li>
        <li><strong>From lab to product:</strong> ideal Landauer channels become multi-mode, nonuniform, and temperature-dependent. Engineers model scatterers statistically and include contact/interface resistances, self-heating, and variability.</li>
      </ul>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part1">
      <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

      <h3>Problem restatement (in plain words)</h3>
      <p class="small">
        <strong>(a)</strong> Using a result labeled (35), derive the next result labeled (36) for barriers in series and Ohm’s law.
        <strong>(b)</strong> Show that the 1D Drude conductivity σ<sub>1D</sub> = n<sub>1D</sub> e² τ / m can be rewritten as
        σ<sub>1D</sub> = (2e²/h) ℓ<sub>e</sub>, using the relation between momentum relaxation and backscattering rates
        1/τ = 2/τ<sub>b</sub>.
      </p>

      <h3>Given quantities</h3>
      <ul>
        <li>Landauer conductance formula for a 1D channel (implicitly equation (35)): G = (2e²/h) T (spin-degenerate).</li>
        <li>Drude 1D conductivity: σ<sub>1D</sub> = n<sub>1D</sub> e² τ / m.</li>
        <li>Rate relation: 1/τ = 2/τ<sub>b</sub> (given in the note).</li>
      </ul>

      <h3>Unknowns / what must be shown</h3>
      <ul>
        <li><strong>(a)</strong> Derive the “series barriers → Ohm’s law” statement (equation (36)) from (35). (We will derive the standard incoherent-series rule and its ohmic limit.)</li>
        <li><strong>(b)</strong> Prove σ<sub>1D</sub> = (2e²/h) ℓ<sub>e</sub> and clearly define ℓ<sub>e</sub>.</li>
      </ul>

      <h3>Relevant principles and why they apply</h3>
      <ul>
        <li><strong>Linearity (linear response):</strong> small bias ⇒ current is linear in voltage; superposition holds.</li>
        <li><strong>Flux conservation:</strong> for each barrier, T + R = 1 (elastic scattering, no absorption).</li>
        <li><strong>Dephasing / incoherent transport between barriers:</strong> allows us to add probabilities (intensities), not amplitudes, so “resistances” add.</li>
        <li><strong>1D kinematics:</strong> only two momentum directions at the Fermi level; backscattering is the essential momentum-randomizing process.</li>
      </ul>

      <div class="callout ok">
        <strong>Assumptions (made explicit)</strong>
        <ul>
          <li>Single effective 1D channel with spin degeneracy 2.</li>
          <li>Elastic scattering at each barrier: energy conserved, T<sub>i</sub> + R<sub>i</sub> = 1.</li>
          <li>Incoherent spacing: phase randomization between barriers (or ensemble averaging) so interference terms average out.</li>
          <li>Near-zero temperature (or T small compared to Fermi energy) so transport occurs near the Fermi level.</li>
        </ul>
      </div>

      <h3>Possible approaches (compare 2–3)</h3>
      <ul>
        <li><strong>Approach A: “Right/left mover flux balance” (probabilistic scattering)</strong><br/>
          Pros: transparent, shows why r = (1−T)/T adds; Cons: must be careful with algebra of multiple reflections.</li>
        <li><strong>Approach B: Transfer matrices then dephase (average over phases)</strong><br/>
          Pros: closest to wave physics; Cons: heavier math; dephasing step can feel abstract without context.</li>
        <li><strong>Approach C: Boltzmann equation / drift-diffusion limit</strong><br/>
          Pros: directly yields Ohm’s law; Cons: less direct connection to (35) and the “barrier series” picture.</li>
      </ul>
      <p class="small"><strong>Chosen approach:</strong> A (flux balance) for (a) because it most directly derives a series rule from Landauer probabilities, then we connect to the Ohmic limit. For (b), use 1D Fermi-gas identities and the given rate relation.</p>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part2">
      <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

      <ol>
        <li><strong>Goal:</strong> restate Landauer for one barrier.<br/>
          <span class="muted">Tool:</span> G = (2e²/h)T.<br/>
          <span class="muted">Meaning:</span> transmission controls conductance.</li>

        <li><strong>Goal:</strong> set up two-barrier series with dephasing and write flux equations for right/left movers between barriers.<br/>
          <span class="muted">Tool:</span> probability conservation T+R=1; linear equations.<br/>
          <span class="muted">Meaning:</span> multiple reflections are accounted for in steady-state intensities.</li>

        <li><strong>Goal:</strong> solve those linear equations to obtain T<sub>tot</sub> in terms of T<sub>1</sub>, T<sub>2</sub>.<br/>
          <span class="muted">Tool:</span> algebra; elimination.<br/>
          <span class="muted">Meaning:</span> yields the “resistances add” law.</li>

        <li><strong>Goal:</strong> generalize to N barriers by induction/additivity of r = (1−T)/T.<br/>
          <span class="muted">Tool:</span> define r; show r<sub>tot</sub>=Σr<sub>i</sub>.<br/>
          <span class="muted">Meaning:</span> this is the microscopic origin of Ohm’s law in 1D with dephasing.</li>

        <li><strong>Goal:</strong> define a mean free path ℓ<sub>e</sub> so that Σr scales like L/ℓ<sub>e</sub> for a long wire.<br/>
          <span class="muted">Tool:</span> coarse-graining; continuum limit.<br/>
          <span class="muted">Meaning:</span> conductance becomes inversely proportional to L (Ohmic).</li>

        <li><strong>Goal:</strong> for part (b), express n<sub>1D</sub> and v<sub>F</sub> in terms of k<sub>F</sub>, then rewrite σ<sub>1D</sub>.<br/>
          <span class="muted">Tool:</span> 1D density of states/filled states; v<sub>F</sub>=ħk<sub>F</sub>/m.<br/>
          <span class="muted">Meaning:</span> connects Drude to quantum conductance unit.</li>

        <li><strong>Goal:</strong> use 1/τ = 2/τ<sub>b</sub> to identify ℓ<sub>e</sub>=v<sub>F</sub>τ<sub>b</sub> and finish σ<sub>1D</sub>=(2e²/h)ℓ<sub>e</sub>.<br/>
          <span class="muted">Tool:</span> given rate relation; substitution.<br/>
          <span class="muted">Meaning:</span> backscattering length sets 1D conductivity.</li>
      </ol>

      <div class="callout warn">
        <strong>Common mistakes</strong>
        <ul>
          <li>Forgetting spin degeneracy (factor 2 in n<sub>1D</sub> and Landauer G).</li>
          <li>Using ℓ<sub>e</sub> = v<sub>F</sub>τ instead of v<sub>F</sub>τ<sub>b</sub> (in 1D they differ by factor 2).</li>
          <li>Adding transmissions directly (T<sub>tot</sub> ≠ T<sub>1</sub>T<sub>2</sub> in incoherent steady state with reflections).</li>
          <li>Confusing two-terminal resistance with four-terminal “material” resistance (contact resistance exists even at T=1).</li>
        </ul>
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part3">
      <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

      <h3>Qualitative expectation (before calculating)</h3>
      <ul>
        <li>Two imperfect barriers should reduce transmission more than either alone.</li>
        <li>In a long chain of many weak barriers, the “difficulty of transmitting” should grow roughly proportional to how many barriers you traverse → resistance ∝ length.</li>
        <li>In 1D Drude, stronger backscattering (shorter τ<sub>b</sub>) should reduce conductivity; mean free path should appear as the key length scale.</li>
      </ul>

      <h3>(a) Derive the series-barrier / Ohm’s-law form from Landauer</h3>

      <div class="callout">
        <strong>Mathematical model</strong>
        <p class="small">
          Consider a 1D channel connecting two reservoirs (left and right) in linear response. Inside the channel are N barriers
          labeled i=1…N. Between barriers, assume phase randomization (or ensemble averaging over random phases), so only
          <em>intensities</em> (probabilities / fluxes) matter.
        </p>
        <p class="small">
          We treat the internal region between barriers as supporting two steady fluxes: right-moving flux J<sup>+</sup> and left-moving flux J<sup>−</sup>.
          Each barrier i is described by transmission T<sub>i</sub> and reflection R<sub>i</sub>=1−T<sub>i</sub>.
          The “operator” viewpoint is a linear map on the two-component flux vector: J_out = S J_in, where S uses T and R.
        </p>
      </div>

      <h4>Step 1: Start from Landauer for one barrier (equation (35) idea)</h4>
      <div class="eqbox">
        <pre id="eq35">Single spin-degenerate 1D channel:
G = (2 e^2 / h) T</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="eq35">Copy equation</button>
          <span class="pill">Two-terminal Landauer</span>
        </div>
      </div>
      <p class="small">
        This is valid in linear response. All device complexity is packaged into the total transmission probability T at the Fermi energy.
      </p>

      <h4>Step 2: Two barriers in series with dephasing — set up flux-balance equations</h4>
      <p class="small">
        Put barrier 1 on the left, barrier 2 on the right, with a dephasing region between them.
        Let J be the incident right-moving flux from the left reservoir onto barrier 1 (proportional to the small bias).
        Let J<sub>+</sub> be the right-moving flux in the middle region (toward barrier 2), and J<sub>−</sub> the left-moving flux in the middle region (toward barrier 1).
      </p>

      <div class="eqbox">
        <pre id="fluxEq">Barrier 1 (left):
J_+ = T1 * J + R1 * J_-

Barrier 2 (right):
J_- = R2 * J_+
Transmitted flux to the right reservoir:
J_trans = T2 * J_+</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="fluxEq">Copy equations</button>
          <span class="pill">Steady-state intensities</span>
        </div>
      </div>

      <p class="small">
        Why these equations are valid:
        <br/>• <strong>Linearity:</strong> scattering is linear in intensities under our incoherent assumption.
        <br/>• <strong>Conservation:</strong> for each barrier, the outgoing right-moving flux equals transmitted incoming right flux plus reflected incoming left flux, etc.
        <br/>• <strong>Dephasing:</strong> removes interference terms; only probabilities (T, R) compose.
      </p>

      <h4>Step 3: Solve for the total transmission T<sub>tot</sub></h4>
      <p class="small">
        Substitute the second equation into the first:
      </p>
      <div class="eqbox">
        <pre id="twoSolve">J_+ = T1 * J + R1 * (R2 * J_+)
=> J_+ * (1 - R1 R2) = T1 * J
=> J_+ = (T1 / (1 - R1 R2)) * J</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="twoSolve">Copy derivation</button>
          <span class="pill">No “magic jumps”</span>
        </div>
      </div>

      <p class="small">
        Then the transmitted flux is J_trans = T2 J_+, so the total transmission probability is:
      </p>
      <div class="eqbox">
        <pre id="Ttot2">T_tot = J_trans / J
     = T2 * (T1 / (1 - R1 R2))
     = (T1 T2) / (1 - (1 - T1)(1 - T2))</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="Ttot2">Copy equation</button>
        </div>
      </div>

      <p class="small">
        Simplify the denominator:
        <br/>
        1 − (1−T1)(1−T2) = 1 − (1 − T1 − T2 + T1T2) = T1 + T2 − T1T2.
        Hence:
      </p>
      <div class="eqbox">
        <pre id="Ttot2simp">T_tot = (T1 T2) / (T1 + T2 - T1 T2)</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="Ttot2simp">Copy equation</button>
        </div>
      </div>

      <h4>Step 4: Reveal the “resistances add” structure</h4>
      <p class="small">
        Define the dimensionless Landauer “excess resistance parameter”
      </p>
      <div class="eqbox">
        <pre id="defr">r ≡ (1 - T)/T = R/T</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="defr">Copy definition</button>
        </div>
      </div>

      <p class="small">
        Rewrite T as T = 1/(1+r). For two barriers, show additivity:
      </p>
      <div class="eqbox">
        <pre id="radd2">From T_tot = (T1 T2) / (T1 + T2 - T1 T2):

Compute 1/T_tot - 1:
1/T_tot = (T1 + T2 - T1 T2)/(T1 T2) = 1/T1 + 1/T2 - 1
So:
(1/T_tot - 1) = (1/T1 - 1) + (1/T2 - 1)

But (1/T - 1) = (1 - T)/T = r
=> r_tot = r1 + r2</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="radd2">Copy derivation</button>
          <span class="pill">Series additivity</span>
        </div>
      </div>

      <p class="small">
        Therefore for N incoherent barriers in series:
      </p>
      <div class="eqbox">
        <pre id="raddN">r_tot = Σ_{i=1..N} r_i
T_tot = 1 / (1 + r_tot) = 1 / (1 + Σ r_i)</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="raddN">Copy result</button>
        </div>
      </div>

      <p class="small">
        Plug into Landauer:
      </p>
      <div class="eqbox">
        <pre id="Gseries">G = (2 e^2 / h) T_tot
  = (2 e^2 / h) * 1/(1 + Σ r_i)</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="Gseries">Copy equation</button>
        </div>
      </div>

      <div class="callout">
        <strong>Interpreting “equation (36)” in standard form</strong>
        <p class="small">
          A very common way (used in many mesoscopic-transport texts) to state the derived result is:
          <br/>
          (h/2e²) * (1/T_tot) = (h/2e²) + Σ (h/2e²) * (R_i/T_i).
          <br/>
          i.e. the total two-terminal resistance equals the contact resistance (h/2e²) plus a sum of barrier contributions.
          This is exactly the content of r_tot = Σ r_i and T_tot = 1/(1+r_tot).
        </p>
      </div>

      <h4>Step 5: Ohm’s law from the continuum (many weak scatterers)</h4>
      <p class="small">
        For a long disordered wire of length L, imagine slicing it into many small segments δx, each acting like a weak “barrier”
        with small r(δx). Additivity gives:
      </p>
      <div class="eqbox">
        <pre id="ohmLimit">Σ r_i  →  ∫_0^L (dr/dx) dx

Define elastic mean free path ℓ_e by:  Σ r_i ≈ L / ℓ_e  (diffusive scaling)

Then:
T(L) = 1 / (1 + L/ℓ_e)
G(L) = (2 e^2 / h) * 1 / (1 + L/ℓ_e)

For L >> ℓ_e (ohmic/diffusive):
G(L) ≈ (2 e^2 / h) * (ℓ_e / L)</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="ohmLimit">Copy derivation</button>
        </div>
      </div>

      <p class="small">
        The last line is Ohm’s law in 1D form: conductance scales as 1/L, so resistance scales as L.
      </p>

      <h3>(b) Show σ<sub>1D</sub> = (2e²/h) ℓ<sub>e</sub> starting from Drude</h3>

      <h4>Step 1: Start from the 1D Drude expression</h4>
      <div class="eqbox">
        <pre id="drude1D">σ_1D = n_1D e^2 τ / m</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="drude1D">Copy equation</button>
        </div>
      </div>

      <h4>Step 2: Express n<sub>1D</sub> in terms of k<sub>F</sub> (including spin)</h4>
      <p class="small">
        In 1D, allowed k-states have density (per length) (1/2π) per spin. Filling from −k<sub>F</sub> to +k<sub>F</sub> gives:
      </p>
      <div class="eqbox">
        <pre id="n1D">Per spin:  n_1D(spin) = ∫_{-kF}^{kF} (dk / 2π) = kF/π
With spin degeneracy g_s=2:
n_1D = 2 kF / π</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="n1D">Copy derivation</button>
        </div>
      </div>

      <h4>Step 3: Use v<sub>F</sub> = ħk<sub>F</sub>/m to rewrite σ<sub>1D</sub></h4>
      <p class="small">
        Substitute n<sub>1D</sub> into Drude:
      </p>
      <div class="eqbox">
        <pre id="sigmaRewrite">σ_1D = (2 kF/π) * (e^2 τ / m)

Use kF/m = vF/ħ:
σ_1D = (2/π) * (e^2 τ vF / ħ)

Since 1/ħ = 2π/h:
σ_1D = (2/π) * (e^2 τ vF) * (2π/h)
     = (4 e^2 vF τ) / h</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="sigmaRewrite">Copy steps</button>
        </div>
      </div>

      <h4>Step 4: Use the given rate relation 1/τ = 2/τ<sub>b</sub></h4>
      <p class="small">
        The problem note states:
        <br/><span class="pill">1/τ = 2/τ<sub>b</sub></span>
        <br/>
        Reason: momentum relaxation (p → 0 on average) counts both directions, while backscattering is specifically p → −p.
        In 1D, a single backscattering event reverses momentum from +p to −p, changing momentum by Δp = (−p) − (+p) = −2p,
        i.e. twice the “typical” magnitude p that appears in momentum-relaxation bookkeeping, producing the factor 2 in rates.
      </p>

      <div class="eqbox">
        <pre id="tauRel">1/τ = 2/τ_b  =>  τ = τ_b / 2</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="tauRel">Copy equation</button>
        </div>
      </div>

      <p class="small">
        Substitute into σ<sub>1D</sub>:
      </p>
      <div class="eqbox">
        <pre id="finalSigma">σ_1D = (4 e^2 vF τ)/h
     = (4 e^2 vF (τ_b/2))/h
     = (2 e^2 / h) * (vF τ_b)</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="finalSigma">Copy derivation</button>
        </div>
      </div>

      <p class="small">
        Identify the elastic mean free path associated with backscattering:
      </p>
      <div class="eqbox">
        <pre id="leDef">ℓ_e ≡ vF τ_b</pre>
        <div class="btnrow">
          <button class="copy" data-copy-target="leDef">Copy definition</button>
        </div>
      </div>

      <div class="callout ok">
        <strong>Final result (boxed)</strong>
        <div class="eqbox">
          <pre id="finalAnswer">σ_1D = (2 e^2 / h) ℓ_e

with ℓ_e = v_F τ_b  and  1/τ = 2/τ_b.</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="finalAnswer">Copy final answer</button>
            <span class="pill">Symbolic</span>
          </div>
        </div>
      </div>

      <h3>Sanity checks</h3>
      <div class="grid2">
        <div class="callout">
          <strong>Units / dimensional analysis</strong>
          <p class="small">
            (2e²/h) has units of conductance (S). Multiplying by ℓ<sub>e</sub> (m) gives S·m, which matches σ<sub>1D</sub>
            (conductance times length). ✔
          </p>
        </div>
        <div class="callout">
          <strong>Limiting cases</strong>
          <ul class="small">
            <li>ℓ<sub>e</sub> → ∞ (no backscattering): σ<sub>1D</sub> → ∞ (ballistic), while two-terminal G saturates at 2e²/h due to contacts. ✔</li>
            <li>ℓ<sub>e</sub> small (strong backscattering): σ<sub>1D</sub> small, and for long L, G ≈ (2e²/h)(ℓ<sub>e</sub>/L). ✔</li>
          </ul>
        </div>
      </div>

      <h3>One static plot (example values) to visualize ballistic → ohmic crossover</h3>
      <figure>
        <canvas id="plot" width="900" height="520" aria-label="Conductance vs length plot"></canvas>
        <figcaption>
          Example plot of <span class="pill">G(L) = (2e²/h) / (1 + L/ℓ<sub>e</sub>)</span> (Landauer with incoherent series scaling).
          <span class="muted">Example values:</span> ℓ<sub>e</sub>=100 nm; we plot normalized conductance G/(2e²/h) vs L (nm).
          The long-length slope demonstrates Ohm’s law: G ∝ 1/L.
        </figcaption>
      </figure>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part4">
      <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

      <h3>Re-interpreting the final formulas</h3>
      <ul>
        <li><strong>σ<sub>1D</sub> = (2e²/h) ℓ<sub>e</sub>:</strong> the quantum conductance scale (2e²/h) times a microscopic length ℓ<sub>e</sub>. In 1D, “conductivity” is literally “quantum conductance × how far you typically go before reversing.”</li>
        <li><strong>G(L) = (2e²/h)/(1 + L/ℓ<sub>e</sub>):</strong> combines contact-limited transport (small L) and diffusive transport (large L). The 1 in the denominator represents the contact contribution; L/ℓ<sub>e</sub> is the accumulated backscattering difficulty.</li>
      </ul>

      <h3>Parameter dependence (qualitative)</h3>
      <ul>
        <li>Increase disorder / roughness → decrease τ<sub>b</sub> → decrease ℓ<sub>e</sub> → lower σ<sub>1D</sub> and lower G for a fixed L.</li>
        <li>Higher v<sub>F</sub> (lighter effective mass or higher carrier density) increases ℓ<sub>e</sub> = v<sub>F</sub>τ<sub>b</sub>, improving σ<sub>1D</sub> if τ<sub>b</sub> is unchanged.</li>
        <li>Series barriers: if any T<sub>i</sub> is very small, its r<sub>i</sub>=(1−T<sub>i</sub>)/T<sub>i</sub> becomes huge and dominates (a “bottleneck”).</li>
      </ul>

      <h3>Alternative derivation idea (brief but meaningful)</h3>
      <details>
        <summary>Transfer-matrix + dephasing viewpoint</summary>
        <p class="small">
          For coherent waves, barrier amplitudes multiply via transfer matrices, and interference produces oscillatory transmission.
          If you average over a random relative phase between barriers (a uniform phase distribution), the cross terms in |t|² vanish,
          and the averaged quantity that becomes additive is (1/T − 1), equivalent to r = (1−T)/T. This reproduces r<sub>tot</sub>=Σr<sub>i</sub>.
        </p>
      </details>

      <h3>Concept check (self-test with answers)</h3>
      <ul>
        <li><strong>Q:</strong> Why does backscattering matter more than small-angle scattering in 1D?<br/>
          <strong>A:</strong> There is no “small angle” in 1D; the only change of direction is reversal, which directly flips momentum.</li>
        <li><strong>Q:</strong> If T=1, why isn’t R=0 in a two-terminal measurement?<br/>
          <strong>A:</strong> Two-terminal Landauer includes contact resistance from mode mismatch between reservoirs and the 1D channel, giving R = h/(2e²) even for T=1.</li>
        <li><strong>Q:</strong> What quantity adds in incoherent series: T or r?<br/>
          <strong>A:</strong> r=(1−T)/T adds: r<sub>tot</sub>=Σr<sub>i</sub>. Transmissions do not add linearly.</li>
        <li><strong>Q:</strong> In 1D, is ℓ<sub>e</sub> = v<sub>F</sub>τ or v<sub>F</sub>τ<sub>b</sub>?<br/>
          <strong>A:</strong> For the identity here, ℓ<sub>e</sub> = v<sub>F</sub>τ<sub>b</sub>, while τ = τ<sub>b</sub>/2 for momentum relaxation.</li>
      </ul>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>

    <section id="part5">
      <h2>PART 5 — Optional Plot Guide</h2>
      <p class="small">
        <strong>What the plot shows:</strong> the normalized conductance G/(2e²/h) as a function of device length L for
        the crossover formula G(L) = (2e²/h)/(1 + L/ℓ<sub>e</sub>).
      </p>
      <ul class="small">
        <li><strong>x-axis:</strong> length L (nm)</li>
        <li><strong>y-axis:</strong> normalized conductance G/(2e²/h) (dimensionless)</li>
        <li><strong>Example values:</strong> ℓ<sub>e</sub>=100 nm (chosen only to visualize scale; the final solution is symbolic)</li>
        <li><strong>Features to notice:</strong>
          <ul>
            <li>At L ≪ ℓ<sub>e</sub>, the curve is near 1 (ballistic/contact-limited).</li>
            <li>At L ≫ ℓ<sub>e</sub>, the curve falls ~ ℓ<sub>e</sub>/L (straight line on a log-log plot; here you see the 1/L trend), demonstrating Ohm’s law.</li>
          </ul>
        </li>
      </ul>

      <div class="callout">
        <strong>Copy-friendly “final answer” block</strong>
        <div class="eqbox">
          <pre id="finalPlain">Part (a) (incoherent series barriers):
Define r_i = (1 - T_i)/T_i.
Then r_tot = Σ_i r_i and T_tot = 1/(1 + r_tot).
So G = (2e^2/h) T_tot = (2e^2/h) / (1 + Σ_i (1 - T_i)/T_i).
For a long wire, Σ r_i ≈ L/ℓ_e ⇒ G(L) = (2e^2/h)/(1 + L/ℓ_e) ≈ (2e^2/h)(ℓ_e/L) for L >> ℓ_e (Ohm’s law).

Part (b) (Drude → Landauer form in 1D):
n_1D = 2 k_F/π, v_F = ħ k_F/m, and 1/τ = 2/τ_b.
Hence σ_1D = n_1D e^2 τ/m = (2e^2/h) ℓ_e with ℓ_e = v_F τ_b.</pre>
          <div class="btnrow">
            <button class="copy" data-copy-target="finalPlain">Copy full final answer</button>
          </div>
        </div>
      </div>

      <a class="backtop" href="#top">Back to top ↑</a>
    </section>
  </article>
</main>

<footer>
  <p class="small">
    Notes: This article used the standard Landauer single-channel formula and the incoherent (dephased) series composition rule.
    If coherence is maintained, interference can modify T strongly and simple resistance additivity can fail.
  </p>
</footer>

<script>
  // Smooth scroll for TOC links
  document.querySelectorAll('#toc a').forEach(a=>{
    a.addEventListener('click', (e)=>{
      const href = a.getAttribute('href');
      if(href && href.startsWith('#')){
        e.preventDefault();
        const target = document.querySelector(href);
        if(target) target.scrollIntoView({behavior:'smooth', block:'start'});
        history.replaceState(null, '', href);
      }
    });
  });

  // Copy buttons (plain text)
  function copyTextFromElement(id){
    const el = document.getElementById(id);
    if(!el) return;
    const text = el.innerText;
    navigator.clipboard.writeText(text).then(()=>{
      // Tiny UX feedback
      const btn = document.querySelector(`button.copy[data-copy-target="${id}"]`);
      if(btn){
        const old = btn.textContent;
        btn.textContent = 'Copied!';
        setTimeout(()=>btn.textContent = old, 900);
      }
    }).catch(()=>{ /* no-op */ });
  }
  document.querySelectorAll('button.copy').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const id = btn.getAttribute('data-copy-target');
      if(id) copyTextFromElement(id);
    });
  });

  // Plot: normalized conductance vs length using canvas (static)
  const canvas = document.getElementById('plot');
  const ctx = canvas.getContext('2d');

  function drawPlot(){
    const dpr = Math.max(1, window.devicePixelRatio || 1);
    const cssWidth = canvas.clientWidth;
    const cssHeight = Math.round(cssWidth * (520/900));
    canvas.style.height = cssHeight + 'px';
    canvas.width = Math.floor(cssWidth * dpr);
    canvas.height = Math.floor(cssHeight * dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);

    const W = cssWidth, H = cssHeight;

    // Layout
    const padL = 64, padR = 18, padT = 38, padB = 54;
    const x0 = padL, y0 = H - padB;
    const x1 = W - padR, y1 = padT;
    const plotW = x1 - x0, plotH = y0 - y1;

    // Example parameters
    const le = 100; // nm (example)
    const Lmin = 0;
    const Lmax = 600; // nm
    const yMin = 0.0;
    const yMax = 1.02;

    function xMap(L){ return x0 + (L - Lmin) / (Lmax - Lmin) * plotW; }
    function yMap(y){ return y0 - (y - yMin) / (yMax - yMin) * plotH; }

    // Background
    ctx.clearRect(0,0,W,H);
    ctx.fillStyle = 'rgba(0,0,0,0.10)';
    ctx.fillRect(0,0,W,H);

    // Gridlines
    ctx.strokeStyle = 'rgba(255,255,255,0.10)';
    ctx.lineWidth = 1;
    const xTicks = 6;
    const yTicks = 6;
    for(let i=0;i<=xTicks;i++){
      const L = Lmin + i*(Lmax-Lmin)/xTicks;
      const x = xMap(L);
      ctx.beginPath();
      ctx.moveTo(x,y0);
      ctx.lineTo(x,y1);
      ctx.stroke();
    }
    for(let j=0;j<=yTicks;j++){
      const y = yMin + j*(yMax-yMin)/yTicks;
      const yy = yMap(y);
      ctx.beginPath();
      ctx.moveTo(x0,yy);
      ctx.lineTo(x1,yy);
      ctx.stroke();
    }

    // Axes
    ctx.strokeStyle = 'rgba(255,255,255,0.55)';
    ctx.lineWidth = 1.2;
    ctx.beginPath();
    ctx.moveTo(x0,y0); ctx.lineTo(x1,y0);
    ctx.moveTo(x0,y0); ctx.lineTo(x0,y1);
    ctx.stroke();

    // Tick labels
    ctx.fillStyle = 'rgba(232,238,247,0.88)';
    ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';
    for(let i=0;i<=xTicks;i++){
      const L = Math.round(Lmin + i*(Lmax-Lmin)/xTicks);
      const x = xMap(L);
      ctx.fillText(String(L), x, y0 + 8);
      // tick
      ctx.beginPath();
      ctx.moveTo(x,y0); ctx.lineTo(x,y0+5);
      ctx.stroke();
    }
    ctx.textAlign = 'right';
    ctx.textBaseline = 'middle';
    for(let j=0;j<=yTicks;j++){
      const y = (yMin + j*(yMax-yMin)/yTicks);
      const yy = yMap(y);
      ctx.fillText(y.toFixed(2), x0 - 8, yy);
      ctx.beginPath();
      ctx.moveTo(x0-5,yy); ctx.lineTo(x0,yy);
      ctx.stroke();
    }

    // Title
    ctx.textAlign = 'left';
    ctx.textBaseline = 'top';
    ctx.font = '14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
    ctx.fillText('Normalized conductance vs length (example)', x0, 10);

    // Axis labels
    ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
    ctx.fillText('Length L (nm)', x0 + plotW/2 - 40, H - 26);
    // y-label rotated
    ctx.save();
    ctx.translate(18, y1 + plotH/2 + 40);
    ctx.rotate(-Math.PI/2);
    ctx.fillText('G / (2e²/h)', 0, 0);
    ctx.restore();

    // Curve: y = 1/(1+L/le)
    ctx.strokeStyle = 'rgba(125,211,252,0.95)';
    ctx.lineWidth = 2.2;
    ctx.beginPath();
    const N = 400;
    for(let k=0;k<=N;k++){
      const L = Lmin + (Lmax-Lmin)*k/N;
      const y = 1/(1 + L/le);
      const x = xMap(L);
      const yy = yMap(y);
      if(k===0) ctx.moveTo(x,yy);
      else ctx.lineTo(x,yy);
    }
    ctx.stroke();

    // Legend
    const lx = x1 - 210, ly = y1 + 10;
    ctx.fillStyle = 'rgba(0,0,0,0.30)';
    ctx.strokeStyle = 'rgba(255,255,255,0.12)';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.roundRect(lx, ly, 200, 46, 10);
    ctx.fill();
    ctx.stroke();

    ctx.strokeStyle = 'rgba(125,211,252,0.95)';
    ctx.lineWidth = 2.2;
    ctx.beginPath();
    ctx.moveTo(lx + 12, ly + 18);
    ctx.lineTo(lx + 46, ly + 18);
    ctx.stroke();
    ctx.fillStyle = 'rgba(232,238,247,0.88)';
    ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
    ctx.textAlign = 'left';
    ctx.textBaseline = 'middle';
    ctx.fillText('G/(2e²/h) = 1/(1+L/ℓe)', lx + 54, ly + 18);
    ctx.fillText('Example: ℓe = 100 nm', lx + 54, ly + 34);
  }

  // Polyfill for roundRect if needed
  if(!CanvasRenderingContext2D.prototype.roundRect){
    CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
      const rr = Math.min(r, w/2, h/2);
      this.beginPath();
      this.moveTo(x+rr, y);
      this.arcTo(x+w, y, x+w, y+h, rr);
      this.arcTo(x+w, y+h, x, y+h, rr);
      this.arcTo(x, y+h, x, y, rr);
      this.arcTo(x, y, x+w, y, rr);
      this.closePath();
      return this;
    }
  }

  window.addEventListener('resize', drawPlot);
  drawPlot();
</script>
</body>
</html>