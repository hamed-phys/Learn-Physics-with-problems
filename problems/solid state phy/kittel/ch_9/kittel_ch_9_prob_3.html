<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hexagonal Close-Packed Structure: Vanishing Fourier Components, Zone-Boundary Gaps, and Insulating vs Metallic Behavior</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#0f1624;
      --card:#121b2b;
      --text:#e8eefc;
      --muted:#b7c3e6;
      --faint:#7f8bb2;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:26px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 15% 10%, rgba(125,211,252,.10), transparent 55%),
        radial-gradient(1000px 700px at 85% 20%, rgba(167,139,250,.12), transparent 55%),
        radial-gradient(900px 650px at 55% 90%, rgba(52,211,153,.08), transparent 55%),
        linear-gradient(180deg, var(--bg), #070a10 70%);
      line-height:1.55;
    }

    header{
      position:relative;
      padding: 34px 18px 18px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.03), transparent);
    }
    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      display:grid;
      grid-template-columns: 290px 1fr;
      gap: 18px;
      padding: 18px;
    }
    .hero{
      max-width:1180px;
      margin:0 auto;
      padding: 0 18px 16px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }
    .title{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      flex-wrap:wrap;
    }
    h1{
      margin:0;
      font-size: clamp(1.35rem, 2.2vw, 2.05rem);
      letter-spacing:.2px;
      line-height:1.18;
    }
    .subtitle{
      margin: 6px 0 0;
      color:var(--muted);
      max-width: 78ch;
      font-size: 1.01rem;
    }
    .badgeRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 10px;
    }
    .badge{
      padding:6px 10px;
      border-radius:999px;
      font-size:.86rem;
      color:var(--muted);
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      backdrop-filter: blur(8px);
      box-shadow: 0 6px 18px rgba(0,0,0,.18);
    }
    .badge strong{color:var(--text); font-weight:650}
    .badge .dot{
      display:inline-block;
      width:8px; height:8px;
      border-radius:50%;
      margin-right:8px;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(125,211,252,.14);
      vertical-align:middle;
      transform: translateY(-1px);
    }

    aside{
      position:sticky;
      top: 14px;
      align-self:start;
      border-radius: var(--radius2);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--line);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .tocHead{
      padding: 14px 14px 10px;
      border-bottom:1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .tocHead .label{
      font-weight:700;
      letter-spacing:.2px;
    }
    .toc{
      padding: 10px 10px 14px;
    }
    .toc a{
      display:block;
      padding: 8px 10px;
      border-radius: 12px;
      text-decoration:none;
      color: var(--muted);
      border:1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size:.95rem;
    }
    .toc a:hover{
      background: rgba(125,211,252,.08);
      border-color: rgba(125,211,252,.18);
      color: var(--text);
      transform: translateX(2px);
    }
    .toc small{
      display:block;
      color: var(--faint);
      font-size:.82rem;
      padding: 0 10px 10px;
    }

    main{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap: 14px;
    }
    section, article{
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      border: 1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .secHead{
      padding: 14px 16px 12px;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .secHead h2{
      margin:0;
      font-size: 1.18rem;
      letter-spacing:.2px;
    }
    .secBody{
      padding: 14px 16px 16px;
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns:1fr; }
      aside{position:relative; top:auto}
    }
    @media (max-width: 720px){
      .grid2{grid-template-columns:1fr}
      .subtitle{font-size:.98rem}
    }

    .card{
      background: rgba(255,255,255,.02);
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 12px 12px;
    }
    .card h3{
      margin: 0 0 6px;
      font-size: 1.02rem;
    }
    .muted{color:var(--muted)}
    .faint{color:var(--faint)}
    ul{margin:8px 0 0 20px}
    li{margin:6px 0}
    code, pre{
      font-family: var(--mono);
      font-size: .94rem;
    }
    pre{
      margin: 10px 0 0;
      padding: 12px 12px;
      background: #0a1020;
      border: 1px solid rgba(125,211,252,.18);
      border-radius: 16px;
      overflow:auto;
      position:relative;
    }
    .eqBlock{
      border-color: rgba(167,139,250,.22);
      background: linear-gradient(180deg, rgba(167,139,250,.08), rgba(10,16,32,1));
    }
    .btnRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }
    .btn{
      appearance:none;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-size:.9rem;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: rgba(125,211,252,.25);
      background: rgba(125,211,252,.07);
    }
    .btn:active{transform: translateY(0px)}
    .btn .pill{
      display:inline-block;
      width:10px; height:10px;
      border-radius:50%;
      background: var(--accent2);
      box-shadow: 0 0 0 3px rgba(167,139,250,.14);
    }

    .callout{
      border-left: 4px solid var(--accent);
      background: linear-gradient(90deg, rgba(125,211,252,.10), rgba(255,255,255,.02));
      padding: 12px 12px;
      border-radius: 16px;
      border: 1px solid rgba(125,211,252,.16);
      box-shadow: 0 10px 24px rgba(0,0,0,.25);
      margin: 10px 0;
    }
    .callout.warn{
      border-left-color: var(--warn);
      border-color: rgba(251,191,36,.22);
      background: linear-gradient(90deg, rgba(251,191,36,.10), rgba(255,255,255,.02));
    }
    .callout.good{
      border-left-color: var(--good);
      border-color: rgba(52,211,153,.18);
      background: linear-gradient(90deg, rgba(52,211,153,.10), rgba(255,255,255,.02));
    }
    .callout.bad{
      border-left-color: var(--bad);
      border-color: rgba(251,113,133,.18);
      background: linear-gradient(90deg, rgba(251,113,133,.10), rgba(255,255,255,.02));
    }
    .callout h3{
      margin:0 0 6px;
      font-size: 1.02rem;
    }
    .kpi{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
    .kpi .item{
      padding: 10px 10px;
      border-radius: 16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
    }
    .kpi .item .top{font-size:.82rem; color:var(--faint)}
    .kpi .item .val{font-size:1.02rem; margin-top:4px}
    @media (max-width: 720px){
      .kpi{grid-template-columns:1fr}
    }

    details{
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
      border-radius: 16px;
      padding: 10px 12px;
      margin: 10px 0 0;
    }
    details > summary{
      cursor:pointer;
      font-weight:650;
      color: var(--text);
      outline:none;
    }
    details[open]{
      background: rgba(125,211,252,.05);
      border-color: rgba(125,211,252,.18);
    }

    .backTop{
      display:inline-block;
      margin-top: 10px;
      text-decoration:none;
      color: var(--muted);
      border:1px solid var(--line);
      padding: 8px 10px;
      border-radius: 12px;
      transition: background .15s ease, border-color .15s ease, transform .15s ease;
    }
    .backTop:hover{
      background: rgba(255,255,255,.04);
      border-color: rgba(125,211,252,.22);
      transform: translateY(-1px);
      color: var(--text);
    }

    footer{
      max-width:1180px;
      margin: 0 auto;
      padding: 18px;
      color: var(--faint);
      font-size: .92rem;
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, aside, .btnRow, .backTop{display:none !important}
      .wrap{max-width:none; grid-template-columns:1fr; padding:0}
      section, article{box-shadow:none; border:1px solid #ddd}
      pre{background:#f7f7f7; border-color:#ddd}
      .callout{box-shadow:none}
      a{color:#000; text-decoration:none}
      h1,h2,h3{page-break-after:avoid}
      section, article{page-break-inside:avoid}
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="hero">
      <div class="title">
        <div>
          <h1>Hexagonal Close-Packed (HCP) Structure: Why a Key Fourier Component Vanishes and What That Means for Band Gaps</h1>
          <p class="subtitle">
            We use Bloch theory + Fourier analysis of the crystal potential to show that, for the HCP basis, the structure factor forces
            <code>U(Gc)=0</code> for the shortest reciprocal vector along the <em>c</em>-axis. Then we connect that symmetry result to zone-boundary gaps
            and why “filling a band” does not automatically guarantee an insulator in HCP for monovalent atoms.
          </p>
          <div class="badgeRow">
            <span class="badge"><span class="dot"></span><strong>Model:</strong> nearly-free electron + structure factor</span>
            <span class="badge"><span class="dot" style="background:var(--accent2); box-shadow:0 0 0 3px rgba(167,139,250,.14)"></span><strong>Result:</strong> symbolic proofs + physical interpretation</span>
            <span class="badge"><span class="dot" style="background:var(--good); box-shadow:0 0 0 3px rgba(52,211,153,.14)"></span><strong>Engineering lens:</strong> symmetry → allowed gaps → materials behavior</span>
          </div>
        </div>
        <div class="kpi" aria-label="Quick KPIs">
          <div class="item">
            <div class="top">Key object</div>
            <div class="val"><code>U(G) = Fourier coefficient</code></div>
          </div>
          <div class="item">
            <div class="top">HCP basis phase</div>
            <div class="val"><code>e^{i G·(c/2)}</code></div>
          </div>
          <div class="item">
            <div class="top">Zone-boundary gap</div>
            <div class="val"><code>ΔE ≈ 2|U(G)|</code></div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <aside>
      <div class="tocHead">
        <div class="label">Table of Contents</div>
        <button class="btn" type="button" id="collapseTocBtn" aria-label="Collapse table of contents">
          <span class="pill"></span> Toggle
        </button>
      </div>
      <nav class="toc" id="tocNav">
        <a href="#quick-summary">Quick Summary</a>
        <a href="#part0">PART 0 — Concept Primer</a>
        <a href="#part0b">PART 0B — Industry & Applied Physics Perspective</a>
        <a href="#part1">PART 1 — Problem Analysis</a>
        <a href="#part2">PART 2 — Strategy & Tips</a>
        <a href="#part3">PART 3 — Full Solution</a>
        <a href="#part4">PART 4 — Deeper Understanding</a>
        <a href="#part5">PART 5 — Optional Plot Guide</a>
        <small class="faint">Tip: use the copy buttons on equation blocks and the final answer.</small>
      </nav>
    </aside>

    <main>
      <section id="quick-summary">
        <div class="secHead">
          <h2>Quick Summary</h2>
          <div class="btnRow">
            <button class="btn" type="button" data-copy-target="#finalAnswerText" aria-label="Copy final answer (plain text)">
              <span class="pill"></span> Copy Final Answer
            </button>
          </div>
        </div>
        <div class="secBody">
          <ul>
            <li><strong>What this problem is about:</strong> Fourier components of a periodic crystal potential for HCP and how symmetry affects band gaps at Brillouin-zone boundaries.</li>
            <li><strong>Key physics idea:</strong> The <em>basis</em> of atoms in HCP produces a <em>structure factor</em> that can cancel certain reciprocal-lattice Fourier components.</li>
            <li><strong>Governing eigenproblem:</strong> single-electron Schrödinger equation with a periodic potential:
              <code>(-ħ²/2m)∇²ψ + U(r)ψ = Eψ</code>, with <code>U(r+R)=U(r)</code> (Bloch theorem).</li>
            <li><strong>Fourier expansion:</strong> <code>U(r) = Σ_G U(G) e^{iG·r}</code>; gaps at zone planes associated with <code>G</code> scale like <code>ΔE ≈ 2|U(G)|</code> in the nearly-free-electron limit.</li>
            <li><strong>Main symmetry result (HCP):</strong> for the shortest reciprocal vector along <em>c</em>, <code>G = Gc ẑ</code>, the structure factor gives <code>U(Gc)=0</code>.</li>
            <li><strong>Follow-up:</strong> <code>U(2Gc)</code> is <em>not</em> forced to vanish; for identical atoms it is generally nonzero (structure factor doubles instead of cancels).</li>
            <li><strong>Insulator logic:</strong> A band insulator needs an integer number of electrons per primitive cell <em>and</em> a global gap at the Fermi energy (no band touching/overlap).</li>
            <li><strong>Why divalent + simple hex can be insulating:</strong> one atom per cell → 2 electrons per cell fill the first band; nonzero key Fourier components can open zone-boundary gaps that separate bands.</li>
            <li><strong>Why monovalent + HCP cannot (in this model):</strong> HCP has 2 atoms per cell → 2 electrons per cell could fill one band, but <code>U(Gc)=0</code> eliminates a crucial zone-boundary gap, enabling band touching/overlap so the Fermi level cannot sit in a full gap.</li>
          </ul>

          <pre id="finalAnswerText" class="eqBlock" aria-label="Final answer (plain text)">
(a) For HCP with basis r1=0, r2=(2/3)a1+(1/3)a2+(1/2)c ẑ, the structure factor for G=nGc ẑ is S(G)=1+exp(i G·r2)=1+exp(i nπ)=1+(-1)^n. Hence for n=1, S(Gc)=0 so U(Gc)=0.

(b) For n=2, S(2Gc)=1+exp(i2π)=2, so U(2Gc) is generally nonzero (not symmetry-forced to vanish).

(c) Simple hexagonal (one atom/cell): divalent atoms give 2 electrons per primitive cell, so the lowest band can be completely filled. Because the Fourier components U(G) at relevant zone-boundary vectors are generically nonzero, band gaps open and a global gap between band 1 and band 2 is possible ⇒ an insulator in principle.

(d) HCP (two atoms/cell): monovalent atoms still give 2 electrons per primitive cell, but U(Gc)=0 removes the first-order gap at the kz=±π/c zone boundary (ΔE≈2|U(Gc)|=0). This allows band touching/overlap at that boundary, so there is no full gap at the Fermi energy ⇒ cannot obtain a band insulator in this nearly-free-electron/structure-factor picture.</pre>

          <a class="backTop" href="#top">Back to top ↑</a>
        </div>
      </section>

      <article id="part0">
        <div class="secHead">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>
          <div class="btnRow">
            <button class="btn" type="button" data-copy-target="#eqKey1" aria-label="Copy key equations (plain text)">
              <span class="pill"></span> Copy Key Equations
            </button>
          </div>
        </div>
        <div class="secBody">
          <div class="grid2">
            <div class="card">
              <h3>Core definitions (symbols + SI units)</h3>
              <ul>
                <li><code>r</code> position (m), <code>∇</code> gradient (1/m), <code>∇²</code> Laplacian (1/m²).</li>
                <li><code>U(r)</code> crystal potential energy (J) with periodicity <code>U(r+R)=U(r)</code>, <code>R</code> a direct lattice vector (m).</li>
                <li><code>G</code> reciprocal lattice vector (1/m), satisfying <code>e^{iG·R}=1</code> for all <code>R</code>.</li>
                <li><code>U(G)</code> Fourier coefficient of <code>U(r)</code> (J).</li>
                <li><code>ψ_{n,k}(r)</code> Bloch eigenstate, <code>E_n(k)</code> band energy (J).</li>
                <li><code>a, c</code> hexagonal lattice constants (m): in-plane spacing <code>a</code>, out-of-plane period <code>c</code>.</li>
                <li><code>Gc</code> shortest reciprocal vector parallel to <em>c</em>-axis (1/m), typically <code>Gc = 2π/c</code>.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Physical meaning (intuition)</h3>
              <ul>
                <li><strong>Fourier components</strong> <code>U(G)</code> measure how strongly the lattice can Bragg-scatter an electron wave by momentum transfer <code>ħG</code>.</li>
                <li><strong>Zone-boundary gaps:</strong> at a Brillouin-zone plane where free-electron states <code>k</code> and <code>k−G</code> are degenerate, the coupling amplitude is ≈ <code>U(G)</code>, opening a gap ≈ <code>2|U(G)|</code>.</li>
                <li><strong>Basis interference:</strong> if the primitive cell contains multiple atoms, scattering contributions add with phases <code>e^{iG·r_j}</code>. Certain <code>G</code> can cancel (systematic absences), forcing <code>U(G)=0</code>.</li>
              </ul>
            </div>
          </div>

          <div class="callout good">
            <h3>Math Insight (core equation as a mathematical object)</h3>
            <p class="muted" style="margin:0">
              The Schrödinger operator <code>H = -(ħ²/2m)∇² + U(r)</code> with periodic <code>U</code> is an <strong>elliptic, self-adjoint operator</strong> on a periodic domain.
              Bloch’s theorem reduces the PDE to a <strong>family of eigenvalue problems</strong> on one unit cell with quasi-periodic boundary conditions
              <code>ψ(r+R)=e^{ik·R}ψ(r)</code>. In Fourier space, <code>U(G)</code> enters as convolution coefficients coupling plane-wave modes.
            </p>
          </div>

          <pre id="eqKey1" class="eqBlock" aria-label="Key equations (plain text)">
Schrödinger + periodic potential:
  [-(ħ²/2m)∇² + U(r)] ψ(r) = E ψ(r),   with U(r+R)=U(r)

Fourier series of crystal potential:
  U(r) = Σ_G U(G) e^{i G·r}
  U(G) = (1/Ω) ∫_cell U(r) e^{-i G·r} d^3r

Nearly-free-electron zone-boundary gap (two-wave approximation):
  ΔE(G) ≈ 2 |U(G)|  at degeneracy between |k⟩ and |k−G⟩</pre>

          <div class="grid2">
            <div class="card">
              <h3>Common models/approximations (why used)</h3>
              <ul>
                <li><strong>Nearly-free-electron (NFE):</strong> assumes <code>U(r)</code> is a weak perturbation; works well for simple metals where valence electrons are delocalized.</li>
                <li><strong>Independent-electron picture:</strong> treat electrons in an effective periodic potential (mean field); ignores strong correlations.</li>
                <li><strong>Identical-atom basis:</strong> potential is sum of identical atomic potentials; then <code>U(G)</code> factorizes into an atomic form factor and a structure factor.</li>
              </ul>
              <div class="callout warn" style="margin:10px 0 0">
                <h3 style="margin:0 0 6px">Validity conditions</h3>
                <ul style="margin:0 0 0 18px">
                  <li>NFE is most reliable when band gaps are small compared to free-electron energies.</li>
                  <li>Claims about “insulator vs metal” here are about <em>band structure possibility</em> in this framework (not strong-Mott physics).</li>
                </ul>
              </div>
            </div>
            <div class="card">
              <h3>Mini intuition examples (minimal algebra)</h3>
              <ul>
                <li><strong>Simple cubic, one atom:</strong> most low-|G| Fourier components are nonzero → gaps open at zone faces.</li>
                <li><strong>Two-atom basis with half-translation:</strong> if second atom sits at half a lattice vector, then for certain <code>G</code> the phase is <code>e^{iπ}=-1</code>, canceling scattering → “missing reflections.”</li>
                <li><strong>Engineering analog:</strong> like two equal noise sources 180° out of phase at a particular frequency → destructive interference at that harmonic.</li>
              </ul>
              <div class="callout" style="margin:10px 0 0">
                <h3 style="margin:0 0 6px">What to watch for (pitfalls)</h3>
                <ul style="margin:0 0 0 18px">
                  <li>Mixing up <em>Bravais lattice</em> vs <em>crystal structure</em> (basis matters for <code>U(G)</code>).</li>
                  <li>Forcing an insulator just from “integer electrons/cell” without checking <em>band touching/overlap</em>.</li>
                  <li>Confusing <code>Gc</code> (shortest along c) with the full set of shortest reciprocal vectors (which also include in-plane ones).</li>
                </ul>
              </div>
            </div>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </div>
      </article>

      <article id="part0b">
        <div class="secHead">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>
        </div>
        <div class="secBody">
          <div class="grid2">
            <div class="card">
              <h3>Where this shows up in industry (concrete areas)</h3>
              <ul>
                <li><strong>Structural metals (Ti, Zr, Mg):</strong> many are HCP at ambient conditions; electronic structure influences conductivity, corrosion behavior, and alloy design.</li>
                <li><strong>Thin films & texture engineering:</strong> HCP texture (c-axis alignment) affects anisotropic transport in coatings and interconnect materials.</li>
                <li><strong>Battery/energy materials:</strong> layered hexagonal structures (including HCP-like stacking motifs) impact electron/ion transport and stability.</li>
                <li><strong>Semiconductor/metal screening:</strong> symmetry and allowed Bragg scattering help predict whether a phase is likely metallic or insulating (band-like) before expensive fabrication.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Why engineers care</h3>
              <ul>
                <li><strong>Performance:</strong> conductivity/anisotropy affects Joule heating, signal integrity, and power losses.</li>
                <li><strong>Reliability:</strong> metallic vs semiconducting behavior changes electrochemical stability and failure mechanisms (e.g., galvanic corrosion).</li>
                <li><strong>Cost & manufacturability:</strong> phase selection (HCP vs other) can be driven by processing routes; electronic properties constrain viable compositions.</li>
                <li><strong>Design levers:</strong> symmetry (basis) and chemistry (valence) are “knobs” that tune band gaps and carrier densities.</li>
              </ul>
            </div>
          </div>

          <div class="grid2">
            <div class="card">
              <h3>Typical measurement/validation methods</h3>
              <ul>
                <li><strong>X-ray/neutron diffraction:</strong> systematic absences (missing reflections) directly reveal structure factors—the same mathematics behind <code>U(G)=0</code>.</li>
                <li><strong>ARPES / quantum oscillations:</strong> map Fermi surfaces and band crossings; detect whether gaps exist at zone boundaries.</li>
                <li><strong>Transport (ρ(T), Hall):</strong> distinguishes metals vs insulators via temperature dependence and carrier sign/density.</li>
                <li><strong>DFT calculations:</strong> industrial workflows use DFT to check whether symmetry allows/forbids certain gap openings before prototyping.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Design trade-offs & constraints</h3>
              <ul>
                <li><strong>Non-idealities:</strong> defects, disorder, and phonons smear gaps and broaden bands; small gaps may not yield practical insulation.</li>
                <li><strong>Alloying:</strong> can break ideal symmetry or change the basis (different atoms) → previously forbidden Fourier components may appear.</li>
                <li><strong>Processing tolerances:</strong> strain alters <code>a</code>, <code>c</code> and therefore <code>Gc=2π/c</code>, shifting zone planes and coupling conditions.</li>
              </ul>
              <div class="callout good" style="margin:10px 0 0">
                <h3 style="margin:0 0 6px">From lab to product</h3>
                <p class="muted" style="margin:0">
                  Real systems rarely match the “identical-atom, perfect HCP” ideal. Engineers exploit deviations—multi-species bases, stacking faults, epitaxial strain—to
                  reintroduce otherwise forbidden scattering channels and tailor transport. The symmetry-based calculation here is the baseline that tells you which knobs
                  can matter most.
                </p>
              </div>
            </div>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </div>
      </article>

      <article id="part1">
        <div class="secHead">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>
        </div>
        <div class="secBody">
          <div class="card">
            <h3>Problem rewritten clearly</h3>
            <p class="muted" style="margin:0">
              Consider a crystal with hexagonal symmetry. Start from a simple hexagonal Bravais lattice (lattice constants <code>a</code> in-plane and <code>c</code> along the axis).
              For the <strong>hexagonal close-packed (HCP)</strong> crystal structure (same Bravais lattice but with a two-atom basis), let <code>Gc</code> be the shortest reciprocal-lattice vector parallel to the <em>c</em>-axis.
              <br><br>
              (a) Prove the Fourier coefficient <code>U(Gc)</code> of the periodic crystal potential <code>U(r)</code> is zero.
              <br>
              (b) Decide whether <code>U(2Gc)</code> must also be zero.
              <br>
              (c) Explain why a band insulator is possible in principle for <strong>divalent</strong> atoms on a <strong>simple hexagonal</strong> lattice.
              <br>
              (d) Explain why a band insulator is not possible for <strong>monovalent</strong> atoms in an <strong>HCP</strong> structure (within this band/Bragg-gap picture).
            </p>
          </div>

          <div class="grid2" style="margin-top:12px">
            <div class="card">
              <h3>Given</h3>
              <ul>
                <li>Hexagonal lattice constants <code>a</code>, <code>c</code>.</li>
                <li>Periodic potential <code>U(r)</code>.</li>
                <li><code>Gc</code>: shortest reciprocal vector parallel to c-axis (so <code>Gc = 2π/c</code> in magnitude).</li>
                <li>HCP structure: two identical atoms per primitive cell (basis).</li>
              </ul>
            </div>
            <div class="card">
              <h3>Unknowns / tasks</h3>
              <ul>
                <li>Show <code>U(Gc)=0</code> (symmetry/structure-factor cancellation).</li>
                <li>Determine whether <code>U(2Gc)=0</code> or not.</li>
                <li>Explain insulating possibility vs impossibility using band filling + gap opening arguments.</li>
              </ul>
            </div>
          </div>

          <div class="callout warn">
            <h3>Assumptions (explicit)</h3>
            <ul style="margin:0 0 0 18px">
              <li><strong>Identical-atom basis</strong> for HCP (same atomic potential at each basis site).</li>
              <li><strong>Independent-electron band picture</strong> with Bloch theorem; insulating = Fermi energy lies in a global band gap.</li>
              <li><strong>Nearly-free-electron intuition</strong> for relating Fourier components to zone-boundary gaps (gap size ∝ <code>|U(G)|</code>).</li>
            </ul>
          </div>

          <div class="grid2">
            <div class="card">
              <h3>Relevant principles & why they apply</h3>
              <ul>
                <li><strong>Fourier analysis on periodic domains:</strong> any lattice-periodic <code>U(r)</code> expands over reciprocal vectors.</li>
                <li><strong>Basis → structure factor:</strong> multi-atom basis contributes phases <code>e^{iG·r_j}</code>.</li>
                <li><strong>Bragg plane coupling:</strong> at zone planes, degenerate perturbation theory shows a gap proportional to the coupling Fourier component.</li>
              </ul>
            </div>
            <div class="card">
              <h3>2–3 approaches (compare)</h3>
              <ul>
                <li><strong>(A) Structure-factor method (best):</strong> write <code>U(G)</code> as atomic form factor × structure factor and evaluate for <code>G=Gc</code>.
                  <span class="faint">Pros: clean, symmetry-driven. Cons: assumes identical atoms.</span></li>
                <li><strong>(B) Direct unit-cell integral:</strong> compute <code>U(G)=(1/Ω)∫_cell U(r)e^{-iG·r}d^3r</code> using explicit <code>U(r)</code> model (hard without a given model).</li>
                <li><strong>(C) Diffraction analogy:</strong> use systematic absences in HCP for reflections with odd <code>l</code> along <code>c</code>.
                  <span class="faint">Pros: strong intuition. Cons: must translate to electronic <code>U(G)</code>.</span></li>
              </ul>
              <p class="muted" style="margin:10px 0 0">
                We choose <strong>(A)</strong> because it is model-independent and exposes the exact cancellation.
              </p>
            </div>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </div>
      </article>

      <article id="part2">
        <div class="secHead">
          <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>
        </div>
        <div class="secBody">
          <div class="card">
            <h3>Minimal plan (8 steps)</h3>
            <ol style="margin:8px 0 0 20px">
              <li><strong>Model the periodic potential:</strong> assume identical atomic potentials repeated at lattice sites and basis sites; justify linear superposition in Fourier space.</li>
              <li><strong>Write Fourier coefficient:</strong> <code>U(G)=(1/Ω)∫_cell U(r)e^{-iG·r}d^3r</code>.</li>
              <li><strong>Factorize:</strong> show <code>U(G)=U_at(G)·S(G)</code>, where <code>S(G)=Σ_j e^{-iG·d_j}</code> (structure factor).</li>
              <li><strong>Insert HCP basis:</strong> use two basis positions <code>r1</code>, <code>r2</code> with <code>z</code>-separation <code>c/2</code>.</li>
              <li><strong>Specialize to <code>G = nGc ẑ</code>:</strong> compute <code>G·r2 = nπ</code> (because <code>Gc c = 2π</code>).</li>
              <li><strong>Conclude cancellations:</strong> odd <code>n</code> → <code>S(G)=0</code> → <code>U(G)=0</code>; even <code>n</code> → <code>S(G)=2</code>.</li>
              <li><strong>Connect to gaps:</strong> use two-wave (degenerate) perturbation to relate zone-boundary gap to <code>|U(G)|</code>.</li>
              <li><strong>Band filling logic:</strong> compare electrons per primitive cell for (simple hex, divalent) vs (HCP, monovalent) and explain why missing gaps prevent an insulator in HCP.</li>
            </ol>
          </div>

          <div class="callout bad">
            <h3>Common mistakes</h3>
            <ul style="margin:0 0 0 18px">
              <li>Using the <em>Bravais lattice</em> of HCP incorrectly: HCP is not a Bravais lattice; it is hexagonal Bravais + 2-atom basis.</li>
              <li>Forgetting that <code>U(G)</code> depends on the <em>basis</em> (structure factor), not just lattice constants.</li>
              <li>Claiming “2 electrons/cell ⇒ insulator” without checking if a global gap exists (bands can touch if key <code>U(G)</code> vanish).</li>
              <li>Mixing up <code>G</code> and <code>k</code>: gaps depend on reciprocal vectors that connect degenerate plane waves.</li>
            </ul>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </div>
      </article>

      <article id="part3">
        <div class="secHead">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>
          <div class="btnRow">
            <button class="btn" type="button" data-copy-target="#eqDerivation" aria-label="Copy derivation equations (plain text)">
              <span class="pill"></span> Copy Derivation Snippet
            </button>
          </div>
        </div>
        <div class="secBody">
          <div class="callout">
            <h3>Qualitative expectation (before calculating)</h3>
            <p class="muted" style="margin:0">
              HCP has two identical atoms per primitive cell, separated by half a period along <em>c</em>. For scattering purely along <em>c</em> (reciprocal vector parallel to <em>c</em>),
              the second atom contributes the same amplitude but with a phase <code>e^{iGz(c/2)}</code>. If that phase equals <code>-1</code>, the two contributions cancel and the Fourier component vanishes.
              Since <code>Gc</code corresponds to one full <code>2π</code> phase over a translation <code>c</code>, half-translation gives a <code>π</code> phase: cancellation is expected.
            </p>
          </div>

          <section class="card" aria-label="Mathematical model setup">
            <h3>Mathematical model (variables, domain, boundary conditions)</h3>
            <ul>
              <li><strong>Domain:</strong> infinite crystal in <code>R^3</code>, analyzed via one primitive cell (volume <code>Ω</code>).</li>
              <li><strong>Coordinates:</strong> choose <code>z</code> along the hexagonal <em>c</em>-axis; in-plane coordinates <code>(x,y)</code>.</li>
              <li><strong>Periodicity:</strong> <code>U(r+R)=U(r)</code> for all direct lattice vectors <code>R</code>.</li>
              <li><strong>Quantum eigenproblem (PDE):</strong>
                <code>Hψ = Eψ</code>, with <code>H = -(ħ²/2m)∇² + U(r)</code>, and Bloch boundary condition on the cell:
                <code>ψ(r+R)=e^{ik·R}ψ(r)</code>.
              </li>
              <li><strong>Fourier series:</strong> because <code>U</code> is cell-periodic and sufficiently regular, it admits
                <code>U(r)=Σ_G U(G)e^{iG·r}</code>, where <code>G</code> runs over the reciprocal lattice.</li>
            </ul>
            <div class="callout warn">
              <h3>Dimensional check</h3>
              <p class="muted" style="margin:0">
                <code>U(G) = (1/Ω)∫ U(r)e^{-iG·r} d^3r</code> has units (J/m³)·m³ = J, consistent with a potential-energy coefficient.
                Reciprocal vectors <code>G</code> have units 1/m, so <code>G·r</code> is dimensionless as required by the exponential.
              </p>
            </div>
          </section>

          <section class="card" aria-label="Step-by-step derivation">
            <h3>(a) Show that <code>U(Gc)=0</code> for HCP</h3>

            <p class="muted">
              <strong>Step 1 — Write the potential as a sum over identical atoms (linearity):</strong><br>
              A standard (and physically motivated) model for the periodic crystal potential is a superposition of identical atomic potentials:
              <code>U(r) = Σ_{R} Σ_{j=1}^{N_b} u(r - R - d_j)</code>,
              where:
            </p>
            <ul>
              <li><code>R</code> runs over Bravais lattice vectors (simple hexagonal Bravais lattice).</li>
              <li><code>d_j</code> are basis vectors inside the primitive cell (for HCP, <code>N_b=2</code>).</li>
              <li><code>u(r)</code> is the potential from one atom (screened ionic potential); identical for both basis atoms.</li>
            </ul>

            <p class="muted">
              <strong>Step 2 — Compute the Fourier coefficient on one cell (definition):</strong>
            </p>
            <pre class="eqBlock" aria-label="Fourier coefficient definition">
U(G) = (1/Ω) ∫_cell U(r) e^{-iG·r} d^3r</pre>

            <p class="muted">
              <strong>Step 3 — Factorize into atomic form factor × structure factor:</strong><br>
              Substitute the lattice sum into the integral. Using periodicity and a change of variables
              (shift by <code>R + d_j</code> inside the integral), one obtains:
            </p>
            <pre id="eqDerivation" class="eqBlock" aria-label="Factorization derivation (plain text)">
U(G) = U_at(G) · S(G)

where
  U_at(G) = ∫ u(r) e^{-iG·r} d^3r          (atomic form factor, depends on chemistry)
  S(G)    = Σ_{j=1}^{N_b} e^{-iG·d_j}     (structure factor, depends on basis geometry)</pre>

            <p class="muted">
              <em>Why is this step valid?</em> Because the Fourier transform is linear, and translating a function multiplies its Fourier transform by a phase factor:
              <code>F{u(r-d)} = e^{-iG·d} F{u(r)}</code>. Summing over basis sites sums these phases, giving <code>S(G)</code>.
            </p>

            <p class="muted">
              <strong>Step 4 — Specify the HCP basis:</strong><br>
              The HCP structure can be viewed as a hexagonal Bravais lattice with a two-atom basis. A conventional choice of basis vectors is:
            </p>
            <ul>
              <li><code>d1 = 0</code></li>
              <li><code>d2 = (2/3)a1 + (1/3)a2 + (1/2)c ẑ</code> (fractional coordinates <code>(2/3, 1/3, 1/2)</code> in the hexagonal cell)</li>
            </ul>
            <p class="muted">
              The key fact we will use is the <strong>z-separation</strong>: the second atom is displaced by <code>c/2</code> along the <em>c</em>-axis.
            </p>

            <p class="muted">
              <strong>Step 5 — Choose <code>G</code> parallel to <em>c</em>:</strong><br>
              Let <code>G = n Gc ẑ</code>, where <code>Gc</code> is the shortest reciprocal-lattice vector along <em>c</em>. For a period <code>c</code> along z,
              the shortest reciprocal magnitude is:
              <code>Gc = 2π/c</code>.
            </p>

            <p class="muted">
              <strong>Step 6 — Evaluate the structure factor <code>S(G)</code>:</strong><br>
              Because <code>G</code> is purely along z, <code>G·(in-plane part of d2)=0</code>. Therefore
            </p>
            <pre class="eqBlock" aria-label="Structure factor evaluation">
S(nGc ẑ) = e^{-i (nGc ẑ)·d1} + e^{-i (nGc ẑ)·d2}
         = 1 + e^{-i nGc (c/2)}
         = 1 + e^{-i n (2π/c)(c/2)}
         = 1 + e^{-i nπ}
         = 1 + (-1)^n.</pre>

            <p class="muted">
              <strong>Step 7 — Conclude for <code>Gc</code> (n=1):</strong><br>
              For <code>n=1</code>, <code>S(Gc)=1+(-1)=0</code>. Hence
              <code>U(Gc)=U_at(Gc)·S(Gc)=0</code>.
            </p>

            <div class="callout good">
              <h3>Result (a) — Boxed</h3>
              <pre class="eqBlock" style="margin:0" aria-label="Final result (a)">
For HCP and G = Gc ẑ (shortest along c):
  S(Gc) = 1 + e^{-iπ} = 0  ⇒  U(Gc) = 0.</pre>
            </div>
          </section>

          <section class="card" aria-label="Part b solution">
            <h3>(b) Is <code>U(2Gc)</code> also zero?</h3>
            <p class="muted">
              Repeat the structure factor evaluation with <code>n=2</code>:
            </p>
            <pre class="eqBlock" aria-label="U(2Gc) evaluation">
S(2Gc ẑ) = 1 + (-1)^2 = 2  ⇒  U(2Gc) = 2 U_at(2Gc)  (generally nonzero).</pre>
            <p class="muted">
              So <code>U(2Gc)</code> is <strong>not symmetry-forced</strong> to vanish; it would be zero only if the atomic form factor <code>U_at(2Gc)</code> happened to be zero for some special potential, which is not generic.
            </p>

            <div class="callout good">
              <h3>Result (b) — Boxed</h3>
              <pre class="eqBlock" style="margin:0" aria-label="Final result (b)">
No. For HCP:
  S(2Gc)=2  ⇒  U(2Gc) is generally nonzero.</pre>
            </div>
          </section>

          <section class="card" aria-label="Band-gap connection and parts c-d">
            <h3>Connecting <code>U(G)</code> to insulating behavior (parts c & d)</h3>

            <p class="muted">
              The central band-theory link is the <strong>degenerate perturbation</strong> (two-wave) result in the nearly-free-electron model.
              Near a Brillouin-zone plane where free-electron energies satisfy
              <code>E0(k)=E0(k−G)</code>, the Hamiltonian restricted to the subspace spanned by plane waves
              <code>|k⟩</code> and <code>|k−G⟩</code> is approximately:
            </p>
            <pre class="eqBlock" aria-label="Two-wave Hamiltonian">
H ≈ [ E0(k)      U(G)   ]
    [ U*(G)   E0(k−G)   ].

At exact degeneracy E0(k)=E0(k−G), eigenvalues are:
  E± = E0 ± |U(G)|  ⇒  gap ΔE = E+ − E− = 2|U(G)|.</pre>

            <p class="muted">
              <em>Why is this step valid?</em> It uses:
              (i) linearity of the Schrödinger operator,
              (ii) the Fourier expansion of <code>U</code> which couples plane waves by reciprocal vectors,
              and (iii) truncation to the two most relevant nearly-degenerate modes (a controlled approximation when the potential is weak and you are near the degeneracy plane).
            </p>

            <div class="callout warn">
              <h3>Key implication</h3>
              <p class="muted" style="margin:0">
                If <code>U(G)=0</code> for the reciprocal vector that defines a zone boundary, then the <strong>first-order Bragg gap at that boundary vanishes</strong>.
                Bands can then <strong>touch</strong> (or overlap) at that boundary—bad news if you hoped for a full insulating gap at the Fermi energy.
              </p>
            </div>

            <h4 style="margin:14px 0 6px"> (c) Why an insulator is possible for divalent atoms on a simple hexagonal lattice</h4>
            <p class="muted">
              A <strong>simple hexagonal lattice</strong> (one atom per primitive cell) has <code>N_b=1</code>, so the structure factor is trivially
              <code>S(G)=1</code>, and therefore <code>U(G)=U_at(G)</code> is generically nonzero for low-order reciprocal vectors.
            </p>
            <ul>
              <li><strong>Electron count:</strong> divalent atoms contribute 2 valence electrons per atom ⇒ <strong>2 electrons per primitive cell</strong>.</li>
              <li><strong>Band filling:</strong> each band accommodates 2 electrons per primitive cell (spin up/down) ⇒ the <strong>lowest band can be completely filled</strong>.</li>
              <li><strong>Gap possibility:</strong> with nonzero <code>U(G)</code> at zone boundaries, Bragg gaps can open and separate band 1 from band 2.
                If the gap is global (no touching elsewhere), the Fermi energy lies in it ⇒ <strong>band insulator is possible in principle</strong>.</li>
            </ul>

            <div class="callout good">
              <h3>Result (c) — Boxed idea</h3>
              <pre class="eqBlock" style="margin:0" aria-label="Part (c) boxed conclusion">
Simple hex (1 atom/cell): divalent ⇒ 2 e−/cell fills band 1.
Because U(G) is generically nonzero, zone-boundary gaps can separate band 1 and band 2 ⇒ insulating state possible in principle.</pre>
            </div>

            <h4 style="margin:14px 0 6px"> (d) Why an insulator is not possible for monovalent atoms in HCP (within this picture)</h4>
            <p class="muted">
              In HCP, the primitive cell contains <code>N_b=2</code> atoms. If each atom is monovalent, the total is again <strong>2 electrons per primitive cell</strong>,
              which <em>might</em> suggest “fill the first band ⇒ insulator.” The catch is that a band insulator needs a <strong>global energy gap</strong>, and HCP symmetry removes a crucial one:
              <code>U(Gc)=0</code>.
            </p>

            <ul>
              <li><strong>Zone boundary along c:</strong> the plane <code>kz = ±Gc/2 = ±π/c</code> is a Brillouin-zone boundary (because <code>G=Gc ẑ</code> connects equivalent k-points).</li>
              <li><strong>Gap magnitude there:</strong> <code>ΔE ≈ 2|U(Gc)| = 0</code>. So the first and second bands are <strong>not separated</strong> by a Bragg gap on that boundary in first order.</li>
              <li><strong>Consequence:</strong> band 1 and band 2 can <strong>touch</strong> (or overlap) at that zone boundary, preventing the Fermi energy from lying in a full gap after filling 2 electrons/cell.</li>
            </ul>

            <div class="callout bad">
              <h3>Result (d) — Boxed idea</h3>
              <pre class="eqBlock" style="margin:0" aria-label="Part (d) boxed conclusion">
HCP (2 atoms/cell): monovalent ⇒ 2 e−/cell, but U(Gc)=0 ⇒ no gap at kz=±π/c (ΔE≈0).
Thus bands can touch/overlap; the Fermi energy cannot sit in a global gap ⇒ no band insulator in this NFE/structure-factor picture.</pre>
            </div>

            <details>
              <summary>Optional deeper note: what if the two basis atoms are not identical?</summary>
              <p class="muted">
                If the two basis sites have different atomic potentials (e.g., an ordered alloy), then the factorization becomes
                <code>U(G)=Σ_j U_at,j(G)e^{-iG·d_j}</code>. The two terms no longer have equal magnitude, so the cancellation for odd <code>n</code> can be incomplete:
                <code>U(Gc)</code> may become nonzero, allowing a gap to open. This is one route (in real materials engineering) to “break” the systematic absence.
              </p>
            </details>

            <details>
              <summary>Optional deeper note: limiting-case asymptotic</summary>
              <p class="muted">
                In the weak-potential limit (nearly-free electrons), the band splitting near a zone boundary scales linearly with <code>|U(G)|</code>:
                <code>ΔE ~ O(|U(G)|)</code>. If symmetry enforces <code>U(G)=0</code>, the leading gap is absent; any remaining splitting must come from
                higher-order couplings (e.g., via <code>2Gc</code> or other <code>G</code> vectors), typically much smaller:
                <code>ΔE_eff ~ O(|U|^2 / E0)</code>. That is often too small to produce a robust insulating gap.
              </p>
            </details>

          </section>

          <div class="callout">
            <h3>Sanity checks</h3>
            <ul style="margin:0 0 0 18px">
              <li><strong>Units:</strong> <code>Gc=2π/c</code> has 1/m; <code>G·(c/2)</code> is dimensionless; <code>U(G)</code> is energy.</li>
              <li><strong>Limiting cases:</strong> if the basis collapse to one atom (<code>d2→0</code>), then <code>S(G)→2</code> and cancellation disappears—consistent.</li>
              <li><strong>Sign/phase reasoning:</strong> the cancellation for <code>Gc</code> is purely from the phase <code>e^{-iπ}=-1</code> due to half-translation along <em>c</em>.</li>
              <li><strong>Physical interpretation:</strong> the lattice cannot Bragg-scatter electrons by momentum <code>ħGc</code> because the two sublattices interfere destructively for that harmonic.</li>
            </ul>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </div>
      </article>

      <article id="part4">
        <div class="secHead">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>
        </div>
        <div class="secBody">
          <div class="grid2">
            <div class="card">
              <h3>Re-interpret the final formula</h3>
              <p class="muted" style="margin:0">
                The key object is the structure factor
                <code>S(G)=Σ_j e^{-iG·d_j}</code>.
                For HCP with a half-translation along <em>c</em>, <code>S(nGc)=1+(-1)^n</code>:
              </p>
              <ul>
                <li><strong>Odd harmonics (n odd):</strong> <code>S=0</code> ⇒ the crystal potential has no Fourier content at that reciprocal vector.</li>
                <li><strong>Even harmonics (n even):</strong> <code>S=2</code> ⇒ contributions add constructively, doubling that Fourier component relative to one atom.</li>
              </ul>
              <p class="muted" style="margin:0">
                Mathematically, this is a discrete Fourier transform of the basis positions: a finite “array factor” producing zeros at certain spatial frequencies.
              </p>
            </div>
            <div class="card">
              <h3>Parameter dependence (qualitative)</h3>
              <ul>
                <li><strong>Changing <code>c</code>:</strong> changes <code>Gc=2π/c</code>, moving the zone boundary and the scattering wavevector where cancellation occurs.</li>
                <li><strong>Changing chemistry:</strong> changes <code>U_at(G)</code> (screening, ionic potential strength), scaling possible gap sizes where not symmetry-forbidden.</li>
                <li><strong>Breaking symmetry:</strong> unequal atoms or distortions modify phases/amplitudes ⇒ can “turn on” previously forbidden <code>U(Gc)</code>.</li>
              </ul>
              <div class="callout warn" style="margin:10px 0 0">
                <h3 style="margin:0 0 6px">Engineering takeaway</h3>
                <p class="muted" style="margin:0">
                  If a gap is symmetry-forbidden at first order, you usually need a <em>symmetry-breaking design lever</em> (alloying, ordering, strain, superlattices)
                  to reliably open it.
                </p>
              </div>
            </div>
          </div>

          <div class="card" style="margin-top:12px">
            <h3>Alternative derivation idea (brief but meaningful)</h3>
            <p class="muted" style="margin:0">
              Use the diffraction analogy: the electron-lattice coupling coefficient <code>U(G)</code> shares the same basis-dependent selection rules as
              the crystal’s scattering amplitude. For HCP, reflections with reciprocal vector purely along <em>c</em> and odd index (odd <code>l</code>)
              are systematically absent because the two basis layers are separated by <code>c/2</code>. Translating that selection rule into Fourier space gives
              <code>U(Gc)=0</code> immediately.
            </p>
          </div>

          <div class="callout good" style="margin-top:12px">
            <h3>Concept check (self-test with answers)</h3>
            <ul style="margin:0 0 0 18px">
              <li><strong>Q:</strong> Why does the in-plane part of <code>d2</code> not matter for <code>G = nGc ẑ</code>?<br>
                  <strong>A:</strong> Because <code>G</code> has no in-plane component, so <code>G·(in-plane displacement)=0</code>.</li>
              <li><strong>Q:</strong> What mathematical feature creates <code>S(Gc)=0</code>?<br>
                  <strong>A:</strong> Destructive interference from the discrete sum of phases: <code>1 + e^{-iπ}=0</code>.</li>
              <li><strong>Q:</strong> If <code>U(G)=0</code>, does that mean the crystal has no periodicity?<br>
                  <strong>A:</strong> No—only that the periodic function has a missing Fourier harmonic at that specific reciprocal vector.</li>
              <li><strong>Q:</strong> Why isn’t “integer electrons per cell” sufficient for insulation?<br>
                  <strong>A:</strong> Because bands can still touch or overlap; you need a global gap at the Fermi energy.</li>
              <li><strong>Q:</strong> How could you make <code>U(Gc)</code> nonzero in practice?<br>
                  <strong>A:</strong> Break the equality of the two basis contributions (different atoms, ordering, distortion), so cancellation is incomplete.</li>
            </ul>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </div>
      </article>

      <article id="part5">
        <div class="secHead">
          <h2>PART 5 — Optional Plot Guide</h2>
        </div>
        <div class="secBody">
          <div class="card">
            <p class="muted" style="margin:0">
              A plot isn’t necessary here because the core results are <strong>selection-rule (symmetry) statements</strong>:
              <code>U(Gc)=0</code> and <code>U(2Gc)≠0</code> (generically), plus qualitative band-gap logic.
              Any meaningful band-structure plot would require material-dependent parameters (<code>U_at(G)</code>, effective masses, additional <code>G</code> couplings),
              which the problem does not specify.
            </p>
          </div>
          <a class="backTop" href="#top">Back to top ↑</a>
        </div>
      </article>
    </main>
  </div>

  <footer>
    <div>
      <strong>Note:</strong> This solution uses a standard independent-electron, nearly-free-electron / structure-factor framework.
      In real materials, strong correlations, disorder, and multi-orbital effects can alter metal/insulator behavior, but the symmetry-based
      cancellation of Fourier components remains a foundational design insight.
    </div>
  </footer>

  <script>
    (function(){
      // TOC collapse
      const btn = document.getElementById('collapseTocBtn');
      const nav = document.getElementById('tocNav');
      let collapsed = false;
      btn.addEventListener('click', () => {
        collapsed = !collapsed;
        nav.style.display = collapsed ? 'none' : 'block';
        btn.textContent = collapsed ? ' Toggle (hidden)' : ' Toggle';
      });

      // Copy buttons
      async function copyTextFromSelector(sel){
        const el = document.querySelector(sel);
        if(!el) return false;
        const text = el.innerText.trim();
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.setAttribute('readonly','');
          ta.style.position='fixed';
          ta.style.left='-9999px';
          document.body.appendChild(ta);
          ta.select();
          let ok = false;
          try{ ok = document.execCommand('copy'); }catch(_){ ok=false; }
          document.body.removeChild(ta);
          return ok;
        }
      }

      function flashButton(button, ok){
        const original = button.innerHTML;
        button.style.borderColor = ok ? 'rgba(52,211,153,.45)' : 'rgba(251,113,133,.45)';
        button.style.background = ok ? 'rgba(52,211,153,.10)' : 'rgba(251,113,133,.10)';
        button.innerHTML = ok ? '<span class="pill" style="background: var(--good); box-shadow: 0 0 0 3px rgba(52,211,153,.14)"></span> Copied!' :
                               '<span class="pill" style="background: var(--bad); box-shadow: 0 0 0 3px rgba(251,113,133,.14)"></span> Copy failed';
        setTimeout(() => {
          button.style.borderColor = '';
          button.style.background = '';
          button.innerHTML = original;
        }, 1100);
      }

      document.querySelectorAll('[data-copy-target]').forEach(btn => {
        btn.addEventListener('click', async () => {
          const sel = btn.getAttribute('data-copy-target');
          const ok = await copyTextFromSelector(sel);
          flashButton(btn, ok);
        });
      });
    })();
  </script>
</body>
</html>
