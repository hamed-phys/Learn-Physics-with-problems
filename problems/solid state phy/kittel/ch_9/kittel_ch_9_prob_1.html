<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Brillouin Zones of a Rectangular 2D Lattice (b = 3a): First & Second Zones</title>
  <style>
    :root{
      --bg:#0b0f16;
      --panel:#101826;
      --card:#0f1724;
      --text:#e8eefc;
      --muted:#b8c4e6;
      --faint:#7f8bb0;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --line2:rgba(255,255,255,.16);
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 20% -10%, rgba(125,211,252,.18), transparent 55%),
                  radial-gradient(900px 600px at 90% 10%, rgba(167,139,250,.16), transparent 50%),
                  linear-gradient(180deg, #070a10, var(--bg) 32%, #070a10);
      color:var(--text);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{opacity:.9; text-decoration:underline}
    header{
      padding:28px 18px 10px;
      position:relative;
    }
    .wrap{
      width:min(1180px, 92vw);
      margin:0 auto;
      display:grid;
      grid-template-columns: 300px 1fr;
      gap:18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns: 1fr}
    }
    .hero{
      grid-column: 1 / -1;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 18px 14px;
      overflow:hidden;
      position:relative;
    }
    .hero:before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(800px 240px at 20% 0%, rgba(125,211,252,.12), transparent 62%),
                  radial-gradient(700px 240px at 80% 10%, rgba(167,139,250,.12), transparent 62%);
      pointer-events:none;
      filter: blur(0px);
    }
    .hero > *{position:relative}
    h1{
      margin: 2px 0 8px;
      font-weight:800;
      letter-spacing:.2px;
      line-height:1.15;
      font-size: clamp(1.35rem, 1.2rem + 1.2vw, 2.15rem);
    }
    .subtitle{
      color:var(--muted);
      margin:0 0 10px;
      max-width: 85ch;
    }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
    }
    .pill{
      font-size:.86rem;
      color:var(--muted);
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius:999px;
      padding:6px 10px;
      backdrop-filter: blur(6px);
    }

    /* Sticky TOC */
    nav.toc{
      position: sticky;
      top: 14px;
      border:1px solid var(--line);
      background: rgba(16,24,38,.72);
      border-radius: var(--radius);
      box-shadow: 0 10px 35px rgba(0,0,0,.35);
      padding: 14px 14px 10px;
      backdrop-filter: blur(10px);
      max-height: calc(100vh - 28px);
      overflow:auto;
    }
    nav.toc h2{
      margin:0 0 8px;
      font-size: .98rem;
      letter-spacing:.2px;
      color: var(--text);
    }
    nav.toc a{
      display:block;
      padding:7px 8px;
      border-radius:10px;
      color: var(--muted);
      border: 1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size: .93rem;
    }
    nav.toc a:hover{
      background: rgba(255,255,255,.04);
      border-color: rgba(255,255,255,.08);
      transform: translateX(2px);
      text-decoration:none;
    }

    main{
      padding: 0 18px 40px;
    }
    article{
      border:1px solid var(--line);
      background: rgba(16,24,38,.45);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    section{
      padding: 18px 18px;
      border-top:1px solid var(--line);
    }
    section:first-of-type{border-top:none}
    h2{
      margin:0 0 10px;
      font-size: 1.22rem;
      letter-spacing:.2px;
    }
    h3{
      margin:16px 0 8px;
      font-size: 1.05rem;
      color: var(--text);
    }
    p{margin: 8px 0; color: var(--muted)}
    ul,ol{margin: 10px 0 10px 22px; color: var(--muted)}
    li{margin: 6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
    }
    @media (max-width: 860px){
      .grid2{grid-template-columns: 1fr}
    }
    .card{
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius: 16px;
      padding: 14px 14px;
    }
    .callout{
      border:1px solid rgba(125,211,252,.22);
      background: linear-gradient(180deg, rgba(125,211,252,.10), rgba(255,255,255,.02));
      border-radius: 16px;
      padding: 12px 14px;
      margin: 12px 0;
    }
    .callout.warn{
      border-color: rgba(251,191,36,.25);
      background: linear-gradient(180deg, rgba(251,191,36,.12), rgba(255,255,255,.02));
    }
    .callout.ok{
      border-color: rgba(52,211,153,.22);
      background: linear-gradient(180deg, rgba(52,211,153,.10), rgba(255,255,255,.02));
    }
    .callout.bad{
      border-color: rgba(251,113,133,.22);
      background: linear-gradient(180deg, rgba(251,113,133,.10), rgba(255,255,255,.02));
    }
    .label{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-weight:700;
      color: var(--text);
      margin-bottom: 6px;
    }
    .dot{
      width:9px;height:9px;border-radius:99px;background:var(--accent);
      box-shadow: 0 0 0 3px rgba(125,211,252,.15);
      display:inline-block;
    }
    .dot.purple{background:var(--accent2); box-shadow: 0 0 0 3px rgba(167,139,250,.16)}
    .dot.ok{background:var(--ok); box-shadow: 0 0 0 3px rgba(52,211,153,.16)}
    .dot.warn{background:var(--warn); box-shadow: 0 0 0 3px rgba(251,191,36,.16)}

    pre{
      margin:10px 0;
      padding:12px 12px;
      border-radius: 14px;
      border:1px solid var(--line2);
      background: rgba(0,0,0,.25);
      overflow:auto;
      color: #eaf2ff;
      font-family: var(--mono);
      font-size: .93rem;
      line-height:1.5;
    }
    .eqbox{
      position:relative;
      margin: 10px 0 12px;
    }
    .copyRow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:8px;
    }
    button.copy{
      appearance:none;
      border:1px solid var(--line2);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-weight:700;
      font-size:.88rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    button.copy:hover{transform: translateY(-1px); background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.22)}
    button.copy:active{transform: translateY(0px)}
    .toast{
      display:inline-block;
      color: var(--muted);
      font-size:.88rem;
      opacity:0;
      transform: translateY(4px);
      transition: opacity .18s ease, transform .18s ease;
    }
    .toast.show{opacity:1; transform: translateY(0)}
    details{
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
      border-radius: 14px;
      padding: 10px 12px;
      margin: 10px 0;
    }
    details summary{
      cursor:pointer;
      color: var(--text);
      font-weight:800;
    }
    .backTop{
      display:inline-flex;
      gap:10px;
      align-items:center;
      margin-top: 10px;
      padding: 8px 10px;
      border-radius: 12px;
      border:1px solid var(--line2);
      background: rgba(255,255,255,.03);
      color: var(--muted);
      width: fit-content;
      transition: transform .12s ease, background .12s ease;
    }
    .backTop:hover{transform: translateY(-1px); background: rgba(255,255,255,.05); text-decoration:none}
    figure{
      margin: 12px 0 0;
      border:1px solid var(--line);
      background: rgba(255,255,255,.02);
      border-radius: var(--radius);
      padding: 12px;
      overflow:hidden;
    }
    figcaption{
      margin-top:10px;
      color: var(--muted);
      font-size:.92rem;
    }
    canvas{
      width:100%;
      height: 360px;
      display:block;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    footer{
      padding: 18px;
      color: var(--faint);
      font-size: .92rem;
      text-align:center;
    }
    /* Print friendly */
    @media print{
      body{background:#fff; color:#000}
      nav.toc{display:none}
      .hero, article, section, pre, .card, .callout, figure, canvas {box-shadow:none !important}
      article{border: none; background:#fff}
      section{border-color:#ddd}
      pre{background:#f7f7f7; color:#000}
      a{color:#000; text-decoration:underline}
      .pill{border-color:#ddd; color:#000}
      button.copy, .toast, .backTop{display:none !important}
      h2, h3{break-after: avoid}
      section{break-inside: avoid-page}
    }
  </style>
</head>

<body>
<header id="top">
  <div class="wrap">
    <div class="hero">
      <h1>Brillouin Zones of a 2D Rectangular Lattice (b = 3a): Plot the 1st and 2nd Zones</h1>
      <p class="subtitle">
        We build the reciprocal lattice, write the Bragg-plane (perpendicular-bisector) equations, and draw (static, non-interactive)
        the first Brillouin zone exactly and the standard “next Bragg planes” that delineate the second-zone boundaries for a primitive rectangular lattice with <span style="color:var(--text);font-weight:800">b = 3a</span>.
      </p>
      <div class="meta">
        <span class="pill">Topic: Reciprocal space &amp; Wigner–Seitz cells</span>
        <span class="pill">Key tool: Bragg planes k·G = |G|²/2</span>
        <span class="pill">Geometry: Rectangular anisotropy (b = 3a)</span>
        <span class="pill">Output: Symbolic + one static canvas plot</span>
      </div>
    </div>

    <nav class="toc" aria-label="Table of contents">
      <h2>Table of Contents</h2>
      <a href="#quick">Quick Summary</a>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry &amp; Applied Physics Perspective</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy &amp; Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Optional Plot Guide</a>
    </nav>

    <main>
      <article>

        <section id="quick">
          <h2>Quick Summary</h2>
          <ul>
            <li><b>What this is:</b> Construct the <b>first two Brillouin zones</b> of a <b>2D primitive rectangular lattice</b> with real-space periods <b>a</b> (x-axis) and <b>b = 3a</b> (y-axis).</li>
            <li><b>Key physics idea:</b> Brillouin zones are <b>Wigner–Seitz regions in reciprocal space</b>—they are determined by <b>Bragg planes</b> (perpendicular bisectors) between reciprocal lattice points.</li>
            <li><b>Governing geometric equation:</b> A Bragg plane for a reciprocal lattice vector <b>G</b> is
              <span style="white-space:nowrap"><b>k · G = |G|²/2</b></span>, derived from “equal distance” in k-space.</li>
            <li><b>Reciprocal lattice:</b> For a rectangular lattice, the primitive reciprocal vectors are
              <b>b₁ = (2π/a) x̂</b>, <b>b₂ = (2π/b) ŷ</b> with <b>b = 3a</b>.</li>
            <li><b>1st Brillouin zone (exact):</b> A rectangle:
              <b>|kₓ| ≤ π/a</b>, <b>|kᵧ| ≤ π/b = π/(3a)</b>.</li>
            <li><b>2nd-zone boundaries (standard construction):</b> The next Bragg planes come from the next-nearest reciprocal points:
              <b>G = ±2b₁</b>, <b>±2b₂</b>, and <b>±(b₁±b₂)</b>, giving vertical/horizontal lines and diagonal bisectors.</li>
            <li><b>Result type:</b> Symbolic equations + a single static plot showing the 1st zone and the usual 2nd-zone delimiting Bragg planes.</li>
            <li><b>Physical meaning:</b> These zones partition wavevectors k into regions with distinct diffraction/Bragg-scattering connectivity—critical for band-structure folding and transport anisotropy.</li>
          </ul>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <section id="part0">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <div class="grid2">
            <div class="card">
              <h3>Core definitions (symbols + SI units)</h3>
              <ul>
                <li><b>a, b</b> — real-space lattice constants (meters, m). Here <b>b = 3a</b>.</li>
                <li><b>r</b> — real-space position vector (m).</li>
                <li><b>k</b> — wavevector in reciprocal space (rad/m).</li>
                <li><b>G</b> — reciprocal lattice vector (rad/m), integer combinations of primitive reciprocal vectors.</li>
                <li><b>Brillouin zone</b> — region in k-space defined by Bragg planes; the <b>1st BZ</b> is the Wigner–Seitz cell around k = 0 in the reciprocal lattice.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Physical meaning (intuition)</h3>
              <ul>
                <li>The reciprocal lattice encodes <b>periodicity</b>: plane waves e^{i k·r} are equivalent under <b>k → k + G</b>.</li>
                <li>Zone boundaries occur where Bragg scattering is possible: states at k and k − G become <b>degenerate in free-electron energy</b> and couple strongly in a periodic potential.</li>
                <li>For anisotropic lattices (like b = 3a), zones become <b>stretched/compressed</b> along different k directions.</li>
              </ul>
            </div>
          </div>

          <h3>Key laws/principles and validity conditions</h3>
          <div class="callout">
            <div class="label"><span class="dot"></span>Key principle: Wigner–Seitz construction in reciprocal space</div>
            <p>
              The first Brillouin zone is the set of points k closer to the origin than to any other reciprocal lattice point.
              Boundaries are <b>perpendicular bisectors</b> between the origin and each reciprocal lattice point G.
            </p>
          </div>

          <h3>Common models/approximations and why they’re used</h3>
          <ul>
            <li><b>Geometric (kinematic) definition</b> of BZs: purely from lattice symmetry in reciprocal space—no material parameters required.</li>
            <li><b>Nearly-free electron picture</b> (context): Bragg planes indicate where band gaps open; this motivates why BZ boundaries matter for band structures.</li>
          </ul>

          <h3>Mini intuition examples (minimal algebra)</h3>
          <ul>
            <li><b>Square lattice</b> (a = b): first BZ is a square with boundaries kₓ = ±π/a, kᵧ = ±π/a.</li>
            <li><b>Rectangular lattice</b> (b &gt; a): first BZ is a rectangle <b>narrower in kᵧ</b> because reciprocal spacing is <b>2π/b</b>.</li>
            <li><b>Why “second zone” is not arbitrary:</b> it is defined by which reciprocal points are “closest next” once you leave the first cell—i.e., how many Bragg planes you have crossed.</li>
          </ul>

          <h3>What to watch for (pitfalls)</h3>
          <div class="callout warn">
            <div class="label"><span class="dot warn"></span>What to watch for</div>
            <ul>
              <li><b>Mixing real-space and reciprocal-space axes:</b> b = 3a in real space means <b>b₂ = 2π/b = 2π/(3a)</b> in reciprocal space.</li>
              <li><b>Forgetting “2π” factors:</b> Bragg planes depend on half of |G|, so missing 2π shifts boundaries.</li>
              <li><b>Assuming second BZ is always a simple “ring”:</b> its shape depends strongly on anisotropy and which Bragg planes come next.</li>
            </ul>
          </div>

          <div class="callout ok">
            <div class="label"><span class="dot ok"></span>Math Insight</div>
            <p>
              The Brillouin-zone construction is a <b>Voronoi (Dirichlet) tessellation</b> problem in ℝ²:
              given a lattice of points {G}, partition k-space into cells of points closer to one lattice point than any other.
              The “core equation” <b>k·G = |G|²/2</b> is the analytic form of a perpendicular bisector (a hyperplane) in Euclidean space.
            </p>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <section id="part0b">
          <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>

          <h3>Where this appears in industry (at least 3 areas)</h3>
          <ul>
            <li><b>Semiconductor &amp; photonics design:</b> band-structure engineering (effective masses, anisotropic transport) and photonic/phononic crystals rely on BZ geometry for dispersion folding.</li>
            <li><b>Thin films &amp; epitaxy manufacturing:</b> RHEED/LEED/XRD patterns map reciprocal space; rectangular surface reconstructions produce distinctive zone shapes.</li>
            <li><b>Materials for energy &amp; electronics:</b> thermoelectrics, anisotropic conductors, layered crystals—transport properties depend on Fermi surface relative to BZ boundaries.</li>
            <li><b>MEMS/ultrasonics:</b> phonon dispersion in engineered lattices (metamaterials) is organized by the BZ; stop-bands form near zone edges.</li>
          </ul>

          <h3>Why engineers care (performance, reliability, cost)</h3>
          <ul>
            <li><b>Performance:</b> Zone-edge band gaps control carrier mobility, optical transitions, and wave propagation stop-bands.</li>
            <li><b>Reliability:</b> Anisotropic dispersion can concentrate energy/heat flow along certain axes, impacting hot spots and failure risk.</li>
            <li><b>Cost &amp; manufacturability:</b> Lattice constants vary with strain, temperature, and tolerances—reciprocal-space features shift, affecting yield of devices that depend on precise dispersion.</li>
          </ul>

          <h3>Typical measurement/validation methods</h3>
          <ul>
            <li><b>X-ray diffraction (XRD)</b> and reciprocal-space mapping to extract lattice constants and strain.</li>
            <li><b>Electron diffraction</b> (LEED/RHEED) for surfaces and thin films (direct view of reciprocal lattice periodicity).</li>
            <li><b>ARPES</b> (angle-resolved photoemission) to map band dispersion within the BZ.</li>
          </ul>

          <h3>Design trade-offs &amp; constraints</h3>
          <ul>
            <li><b>Non-idealities:</b> finite domain size → reciprocal-space broadening; defects/disorder → diffuse scattering.</li>
            <li><b>Tolerances:</b> small shifts in a or b change BZ dimensions (since they scale as 1/a and 1/b).</li>
            <li><b>Multi-physics coupling:</b> thermal expansion changes lattice constants; process stress modifies anisotropy.</li>
          </ul>

          <details>
            <summary>From lab to product: adapting the ideal model</summary>
            <p>
              In products, the “perfect lattice” assumption is replaced by spatially varying a(r), b(r) due to strain gradients,
              composition, and temperature. Engineers still use BZ geometry as the baseline, then add corrections:
              broadened peaks, shifted reciprocal vectors, and sometimes superlattice zones from patterning or reconstruction.
            </p>
          </details>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <section id="part1">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <h3>Restate the problem</h3>
          <p>
            We have a primitive 2D rectangular lattice with real-space basis vectors aligned with axes:
            one of length <b>a</b> along x, and one of length <b>b = 3a</b> along y.
            The task is to <b>make a plot of the first two Brillouin zones</b>.
          </p>

          <div class="grid2">
            <div class="card">
              <h3>Given</h3>
              <ul>
                <li>2D rectangular lattice</li>
                <li>Real-space constants: a (x-direction), b = 3a (y-direction)</li>
              </ul>
            </div>
            <div class="card">
              <h3>Unknowns / outputs</h3>
              <ul>
                <li>Equations/geometry of the <b>1st Brillouin zone</b></li>
                <li>Equations/geometry used to draw the <b>2nd Brillouin zone</b> (next Bragg planes)</li>
                <li>A static plot showing both</li>
              </ul>
            </div>
          </div>

          <h3>Relevant principles &amp; why they apply</h3>
          <ul>
            <li><b>Reciprocal lattice definition</b> applies because Brillouin zones are defined in reciprocal space.</li>
            <li><b>Wigner–Seitz / Voronoi construction</b> applies: the 1st BZ is the WS cell around the origin.</li>
            <li><b>Bragg-plane condition</b> (perpendicular bisector) applies to compute zone boundaries analytically.</li>
          </ul>
          <p>
            No dynamics (so no time-dependent PDE/ICs) and no material-specific Hamiltonian are needed—the construction is geometric.
          </p>

          <div class="callout">
            <div class="label"><span class="dot purple"></span>Assumptions (explicit)</div>
            <ul>
              <li>Perfect infinite periodic lattice (no defects, no finite-size broadening).</li>
              <li>Primitive rectangular lattice (no additional basis atoms affecting reciprocal lattice positions).</li>
              <li>Euclidean metric in k-space (standard dot product).</li>
            </ul>
          </div>

          <h3>2–3 approaches (pros/cons)</h3>
          <ol>
            <li><b>Direct WS construction:</b> Draw reciprocal lattice points and their perpendicular bisectors to k = 0.
              <br><span style="color:var(--faint)">Pros:</span> most fundamental; <span style="color:var(--faint)">Cons:</span> can be messy without equations.</li>
            <li><b>Analytic Bragg-plane equations:</b> Use k·G = |G|²/2 for the relevant G vectors.
              <br><span style="color:var(--faint)">Pros:</span> clean, symbolic; <span style="color:var(--faint)">Cons:</span> must decide which G are “relevant” for the 2nd zone drawing.</li>
            <li><b>Computational Voronoi classification:</b> Numerically determine nearest reciprocal points.
              <br><span style="color:var(--faint)">Pros:</span> robust; <span style="color:var(--faint)">Cons:</span> feels like a simulation (we avoid that here).</li>
          </ol>

          <h3>Chosen approach</h3>
          <p>
            We use <b>analytic Bragg-plane equations</b>. It yields the <b>exact first BZ</b>, and a standard, textbook-style
            depiction of the <b>second-zone boundaries</b> via the <b>next set of Bragg planes</b> from the next-nearest reciprocal lattice points.
          </p>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <section id="part2">
          <h2>PART 2 — Strategy &amp; Tips (Roadmap Only)</h2>

          <ol>
            <li><b>Define the real-space lattice vectors</b> and coordinate system (x, y). <br>Tool: geometry in ℝ².</li>
            <li><b>Compute reciprocal primitive vectors</b> b₁, b₂ from the condition aᵢ·bⱼ = 2π δᵢⱼ. <br>Tool: dot product / linear algebra.</li>
            <li><b>List key reciprocal lattice points</b> near the origin: ±b₁, ±b₂, ±(b₁±b₂), ±2b₁, ±2b₂. <br>Meaning: nearest and next shells.</li>
            <li><b>Write Bragg-plane equations</b> for each G: k·G = |G|²/2. <br>Meaning: boundaries where k is equally distant from 0 and G.</li>
            <li><b>Identify the 1st BZ</b> as the intersection of half-planes defined by the nearest points (±b₁, ±b₂). <br>Meaning: exact WS cell.</li>
            <li><b>Depict 2nd-zone boundaries</b> using the next Bragg planes (from next-nearest points). <br>Meaning: next “shell” of diffraction boundaries after leaving the first zone.</li>
            <li><b>Nondimensionalize for plotting</b> so the plot is clean and scale-free. <br>Meaning: show shape independent of absolute a.</li>
            <li><b>Draw a single static plot</b> with axes, gridlines, and labeled first/second-zone boundaries.</li>
          </ol>

          <div class="callout bad">
            <div class="label"><span class="dot"></span>Common mistakes</div>
            <ul>
              <li>Using b = 3a in reciprocal space without inversion: remember <b>reciprocal spacing ∝ 1/b</b>.</li>
              <li>Putting the first zone boundary at 2π/a instead of π/a (it’s half of the nearest reciprocal vector).</li>
              <li>Forgetting that diagonal Bragg planes from (b₁±b₂) pass through the rectangle corners (important for the 2nd-zone picture).</li>
            </ul>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <section id="part3">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>Qualitative expectation (before calculating)</h3>
          <p>
            Because the lattice is stretched in real space along y (b = 3a), the reciprocal lattice is compressed along kᵧ.
            So the first Brillouin zone should be a rectangle that is <b>3× shorter in kᵧ extent</b> than in kₓ extent.
            The second-zone boundaries should appear as the next set of perpendicular bisectors, including additional
            horizontal/vertical lines and diagonal lines corresponding to reciprocal points like (±b₁ ± b₂).
          </p>

          <h3>Step 1 — Mathematical model (variables, domain, coordinate system)</h3>
          <div class="card">
            <p>
              We work in 2D Euclidean space. Let real-space coordinates be (x, y) and reciprocal-space coordinates be (kₓ, kᵧ).
              The reciprocal lattice is the set:
            </p>
            <pre>G = m b1 + n b2,   where m, n ∈ ℤ.</pre>
            <p>
              The first Brillouin zone is the Wigner–Seitz cell around k = 0 in this lattice:
              <b>all k closer to 0 than to any other G</b>.
              No boundary/initial conditions are needed (this is a static geometric partition of ℝ²).
            </p>
          </div>

          <h3>Step 2 — Real-space lattice vectors</h3>
          <div class="eqbox">
            <pre id="eq1">a1 = a x̂
a2 = b ŷ   with b = 3a</pre>
            <div class="copyRow">
              <button class="copy" data-copytarget="eq1">Copy equation</button>
              <span class="toast" id="toast-eq1">Copied.</span>
            </div>
          </div>

          <h3>Step 3 — Reciprocal lattice vectors (derive b₁, b₂)</h3>
          <p>
            The reciprocal basis {b₁, b₂} is defined by the orthogonality/normalization conditions
            (this is linear algebra; it guarantees e^{i(k+G)·r} has the same lattice periodicity):
          </p>
          <div class="eqbox">
            <pre id="eq2">a_i · b_j = 2π δ_ij  (i,j = 1,2)</pre>
            <div class="copyRow">
              <button class="copy" data-copytarget="eq2">Copy equation</button>
              <span class="toast" id="toast-eq2">Copied.</span>
            </div>
          </div>
          <p>
            Since a₁ is along x and a₂ is along y (orthogonal rectangular lattice), the solution is immediate:
          </p>
          <div class="eqbox">
            <pre id="eq3">b1 = (2π/a) x̂
b2 = (2π/b) ŷ = (2π/(3a)) ŷ</pre>
            <div class="copyRow">
              <button class="copy" data-copytarget="eq3">Copy equation</button>
              <span class="toast" id="toast-eq3">Copied.</span>
            </div>
          </div>
          <p>
            <b>Dimensional check:</b> a and b are meters, so 2π/a and 2π/b are rad/m, as required for wavevectors.
          </p>

          <h3>Step 4 — Bragg planes: why k·G = |G|²/2</h3>
          <p>
            A Bragg plane is the set of points k that are equidistant from the origin and a reciprocal lattice point G:
          </p>
          <pre id="eq4">|k| = |k - G|</pre>
          <p>
            Square both sides (valid because norms are nonnegative):
          </p>
          <pre id="eq5">k·k = (k - G)·(k - G) = k·k - 2 k·G + G·G</pre>
          <p>
            Cancel k·k from both sides (linearity of dot product), yielding the plane equation:
          </p>
          <div class="eqbox">
            <pre id="eq6">2 k·G = |G|^2
⇒ k·G = |G|^2 / 2</pre>
            <div class="copyRow">
              <button class="copy" data-copytarget="eq6">Copy equation</button>
              <span class="toast" id="toast-eq6">Copied.</span>
            </div>
          </div>

          <h3>Step 5 — First Brillouin zone (exact)</h3>
          <p>
            The <b>nearest reciprocal lattice points</b> to the origin are ±b₁ and ±b₂.
            Their Bragg planes define the first-zone boundary.
          </p>

          <h4 style="margin:10px 0 6px; color:var(--text)">Planes from G = ±b₁</h4>
          <p>
            Take G = b₁ = (2π/a) x̂. Then k·G = kₓ(2π/a) and |G|² = (2π/a)².
          </p>
          <pre id="eq7">k·b1 = |b1|^2 / 2
(2π/a) kx = (1/2) (2π/a)^2
⇒ kx = π/a</pre>
          <p>
            Similarly, for G = −b₁ you get kₓ = −π/a. So the vertical boundaries are:
          </p>
          <pre id="eq8">kx = ± π/a</pre>

          <h4 style="margin:10px 0 6px; color:var(--text)">Planes from G = ±b₂</h4>
          <p>
            For G = b₂ = (2π/b) ŷ, the same reasoning gives:
          </p>
          <pre id="eq9">ky = ± π/b = ± π/(3a)</pre>

          <div class="callout ok">
            <div class="label"><span class="dot ok"></span>First Brillouin zone (boxed final form)</div>
            <pre id="final1">1st BZ (rectangular lattice):
|kx| ≤ π/a
|ky| ≤ π/b = π/(3a)

So the 1st BZ is a rectangle of width 2π/a and height 2π/(3a).</pre>
            <div class="copyRow">
              <button class="copy" data-copytarget="final1">Copy final answer (1st BZ)</button>
              <span class="toast" id="toast-final1">Copied.</span>
            </div>
          </div>

          <h3>Step 6 — Second Brillouin zone: the “next Bragg planes” used for the plot</h3>
          <p>
            The second zone is the region you reach after crossing one Bragg plane from the first zone.
            In a standard textbook plot, you draw the <b>next set of Bragg planes</b> produced by the next-nearest reciprocal points:
          </p>
          <ul>
            <li><b>G = ±2b₁</b> → farther vertical bisectors</li>
            <li><b>G = ±2b₂</b> → farther horizontal bisectors</li>
            <li><b>G = ±(b₁ + b₂), ±(b₁ − b₂)</b> → diagonal bisectors that shape the corner structure</li>
          </ul>

          <h4 style="margin:10px 0 6px; color:var(--text)">Planes from G = ±2b₁ and ±2b₂</h4>
          <p>
            Using the same rule k·G = |G|²/2:
          </p>
          <pre id="eq10">For G = 2b1 = (4π/a) x̂:
(4π/a) kx = (1/2)(4π/a)^2  ⇒  kx = 2π/a

For G = 2b2 = (4π/b) ŷ:
(4π/b) ky = (1/2)(4π/b)^2  ⇒  ky = 2π/b = 2π/(3a)</pre>

          <h4 style="margin:10px 0 6px; color:var(--text)">Diagonal planes from G = b₁ ± b₂</h4>
          <p>
            Let G = b₁ + b₂ = (2π/a) x̂ + (2π/b) ŷ. Then:
          </p>
          <pre id="eq11">k·G = (2π/a)kx + (2π/b)ky
|G|^2 = (2π/a)^2 + (2π/b)^2

Bragg plane: (2π/a)kx + (2π/b)ky = 1/2[(2π/a)^2 + (2π/b)^2]</pre>
          <p>
            Substitute b = 3a and simplify carefully:
          </p>
          <pre id="eq12">(2π/a)kx + (2π/(3a))ky = 1/2[ (2π/a)^2 + (2π/(3a))^2 ]
Left factor (2π/a): (2π/a)[ kx + (1/3)ky ]
Right: 1/2[ (4π^2/a^2)(1 + 1/9) ] = 1/2[ (4π^2/a^2)(10/9) ] = (20π^2)/(9a^2)

Divide both sides by (2π/a):
kx + (1/3)ky = (10π)/(9a)</pre>
          <p>
            Repeating for other sign combinations gives the set:
          </p>
          <div class="eqbox">
            <pre id="final2">Second-zone Bragg-plane set commonly drawn (b = 3a):

(1) Vertical/horizontal "next" planes:
kx = ± 2π/a
ky = ± 2π/b = ± 2π/(3a)

(2) Diagonal planes from ±(b1 ± b2):
kx + (1/3)ky = ± (10π)/(9a)
kx - (1/3)ky = ± (10π)/(9a)</pre>
            <div class="copyRow">
              <button class="copy" data-copytarget="final2">Copy equations (2nd-zone planes)</button>
              <span class="toast" id="toast-final2">Copied.</span>
            </div>
          </div>

          <h3>Step 7 — Nondimensionalization for a clean plot</h3>
          <p>
            A plot is easiest if we scale k by π/a. Define dimensionless coordinates:
          </p>
          <pre id="eq13">κx = (a/π) kx
κy = (a/π) ky</pre>
          <p>
            Then:
          </p>
          <pre id="eq14">1st BZ: |κx| ≤ 1,   |κy| ≤ 1/3
Next planes: κx = ±2,   κy = ±2/3
Diagonal planes: κx ± (1/3)κy = ±10/9</pre>

          <figure>
            <canvas id="bzPlot" aria-label="Plot of first and second Brillouin zone boundaries"></canvas>
            <figcaption>
              <b>Static plot (dimensionless):</b> axes are κx = (a/π)kx and κy = (a/π)ky.
              The <span style="color:var(--text);font-weight:800">1st BZ</span> is the exact rectangle |κx|≤1, |κy|≤1/3.
              The <span style="color:var(--text);font-weight:800">2nd-zone boundary cues</span> are shown by the next Bragg planes:
              κx=±2, κy=±2/3, and the diagonals κx±(1/3)κy=±10/9.
            </figcaption>
          </figure>

          <h3>Sanity checks</h3>
          <div class="grid2">
            <div class="callout">
              <div class="label"><span class="dot"></span>Units / dimensions</div>
              <p>
                All k, G have units rad/m. The boundary coordinates π/a, π/b have correct units (1/m).
                The nondimensional κ variables are unitless by construction.
              </p>
            </div>
            <div class="callout">
              <div class="label"><span class="dot purple"></span>Limiting cases</div>
              <p>
                If b → a (square lattice), then π/b → π/a and the 1st BZ becomes a square. If b → ∞,
                then π/b → 0 and the 1st BZ collapses in kᵧ, consistent with a 1D periodicity limit.
              </p>
            </div>
          </div>

          <div class="callout ok">
            <div class="label"><span class="dot ok"></span>Final Answer (plain text)</div>
            <pre id="finalAnswer">For a 2D primitive rectangular lattice with real-space periods a (x) and b = 3a (y):

Reciprocal primitives:
b1 = (2π/a) x̂
b2 = (2π/b) ŷ = (2π/(3a)) ŷ

1st Brillouin zone (exact, Wigner–Seitz about k=0):
|kx| ≤ π/a
|ky| ≤ π/b = π/(3a)

To plot the 2nd-zone boundaries (standard “next Bragg planes” depiction), draw Bragg planes
k·G = |G|^2/2 for the next-nearest reciprocal vectors:
G = ±2b1  →  kx = ±2π/a
G = ±2b2  →  ky = ±2π/b = ±2π/(3a)
G = ±(b1 ± b2) →  kx ± (1/3)ky = ±(10π)/(9a)

A single static plot in κx=(a/π)kx, κy=(a/π)ky shows:
1st BZ: |κx|≤1, |κy|≤1/3
Next planes: κx=±2, κy=±2/3, diagonals κx±(1/3)κy=±10/9.</pre>
            <div class="copyRow">
              <button class="copy" data-copytarget="finalAnswer">Copy final answer</button>
              <span class="toast" id="toast-finalAnswer">Copied.</span>
            </div>
          </div>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <section id="part4">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>Re-interpret the final formulas</h3>
          <ul>
            <li><b>π/a and π/b are half-spacings</b> to the nearest reciprocal lattice points along each axis: the 1st BZ is bounded halfway to ±b₁ and ±b₂.</li>
            <li><b>Anisotropy:</b> Because b = 3a, the reciprocal spacing in y is smaller by 3, so the first-zone height is smaller by 3.</li>
            <li><b>Diagonal planes</b> arise from reciprocal points at (±b₁ ± b₂): they become relevant right at the rectangle corners, shaping how the next zones connect.</li>
          </ul>

          <h3>Parameter dependence (qualitative)</h3>
          <div class="card">
            <ul>
              <li>Increasing <b>a</b> shrinks the BZ width in kₓ (since boundaries scale as 1/a).</li>
              <li>Increasing <b>b</b> shrinks the BZ height in kᵧ (since boundaries scale as 1/b).</li>
              <li>The aspect ratio of the 1st BZ is <b>(π/a) : (π/b) = b : a</b> in half-extent, so it mirrors real-space anisotropy inversely.</li>
            </ul>
          </div>

          <h3>Alternative derivation idea (brief but meaningful)</h3>
          <p>
            Instead of using equidistance, you can derive the same planes from the <b>free-electron dispersion</b>:
            E(k) = (ħ²/2m)|k|². Degeneracy between k and k − G occurs when E(k) = E(k − G), which yields
            |k|² = |k − G|² ⇒ k·G = |G|²/2. This connects zone boundaries directly to <b>band-gap opening locations</b>
            in the nearly-free electron model (an eigenvalue problem in a periodic potential).
          </p>

          <details>
            <summary>Formal structure note (waves/quantum context)</summary>
            <p>
              In a periodic medium, Bloch waves solve an eigenvalue problem (Schrödinger or Maxwell):
              a linear operator L with periodic coefficients satisfies L u = λ u. Bloch’s theorem decomposes solutions into
              u(r)=e^{i k·r} p(r) with p periodic. The Brillouin zone is the fundamental domain for k because
              k and k+G label equivalent Bloch phases. Zone boundaries are where Fourier components couple strongly.
            </p>
          </details>

          <h3>Concept check (self-test with answers)</h3>
          <ul>
            <li><b>Q:</b> If b doubles, what happens to the first-zone height? <b>A:</b> It halves, since |kᵧ|≤π/b.</li>
            <li><b>Q:</b> Why is the boundary π/a and not 2π/a? <b>A:</b> It’s the perpendicular bisector between 0 and the nearest reciprocal point at 2π/a.</li>
            <li><b>Q:</b> What is the geometric meaning of k·G = |G|²/2? <b>A:</b> A straight line (in 2D) perpendicular to G passing through G/2—i.e., the bisector plane.</li>
            <li><b>Q:</b> Why do diagonal planes appear for the second-zone depiction? <b>A:</b> Because the next-nearest reciprocal points are at b₁±b₂, whose bisectors cut across corners.</li>
          </ul>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <section id="part5">
          <h2>PART 5 — Optional Plot Guide</h2>

          <h3>What the plot shows and why it’s useful</h3>
          <p>
            The plot visualizes the <b>k-space geometry</b> that underlies Bragg scattering and band folding:
            the exact first Brillouin zone (rectangle) and the next Bragg planes that delineate the second-zone structure.
            For anisotropic lattices (b = 3a), the zones are <b>compressed in kᵧ</b>, which directly connects to anisotropic
            dispersions and transport in real materials and engineered periodic media.
          </p>

          <h3>Axes and units</h3>
          <ul>
            <li>Horizontal axis: <b>κx = (a/π) kx</b> (dimensionless)</li>
            <li>Vertical axis: <b>κy = (a/π) ky</b> (dimensionless)</li>
          </ul>

          <h3>Features to notice</h3>
          <ul>
            <li><b>1st BZ:</b> exact rectangle with corners at (±1, ±1/3).</li>
            <li><b>Next planes:</b> vertical κx=±2 and horizontal κy=±2/3 are the next bisectors to ±2b₁ and ±2b₂.</li>
            <li><b>Diagonals:</b> κx±(1/3)κy=±10/9 pass through the 1st-zone corners, showing how the next-nearest points influence the next zones.</li>
          </ul>

          <a class="backTop" href="#top">↑ Back to top</a>
        </section>

        <footer>
          Built as a self-contained learning article (vanilla HTML/CSS/JS). One static canvas plot only.
        </footer>
      </article>
    </main>
  </div>
</header>

<script>
(function(){
  function copyTextFromPre(preId){
    const el = document.getElementById(preId);
    if(!el) return;
    const text = el.textContent;
    navigator.clipboard.writeText(text).catch(()=>{ /* ignore */ });
    const toast = document.getElementById("toast-" + preId);
    if(toast){
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"), 900);
    }
  }

  document.querySelectorAll("button.copy").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const id = btn.getAttribute("data-copytarget");
      copyTextFromPre(id);
    });
  });

  // ---- Static canvas plot (non-interactive) ----
  const canvas = document.getElementById("bzPlot");
  const ctx = canvas.getContext("2d");

  // Coordinate window in dimensionless kappa-space
  const view = {
    xmin: -2.4, xmax: 2.4,
    ymin: -0.95, ymax: 0.95
  };

  function resizeAndDraw(){
    const dpr = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
    const rect = canvas.getBoundingClientRect();
    canvas.width  = Math.round(rect.width * dpr);
    canvas.height = Math.round(rect.height * dpr);
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0); // draw in CSS pixels

    draw(rect.width, rect.height);
  }

  function mapX(x, W){
    return (x - view.xmin) / (view.xmax - view.xmin) * W;
  }
  function mapY(y, H){
    return H - (y - view.ymin) / (view.ymax - view.ymin) * H;
  }

  function drawGrid(W, H){
    ctx.clearRect(0,0,W,H);

    // background
    ctx.fillStyle = "rgba(0,0,0,0.18)";
    ctx.fillRect(0,0,W,H);

    // gridlines
    const gx = 0.5; // spacing in kappa-x
    const gy = 0.1666667; // ~1/6 in kappa-y

    ctx.lineWidth = 1;
    for(let x = Math.ceil(view.xmin/gx)*gx; x <= view.xmax + 1e-9; x += gx){
      const X = mapX(x,W);
      ctx.strokeStyle = (Math.abs(x) < 1e-9) ? "rgba(255,255,255,0.22)" : "rgba(255,255,255,0.08)";
      ctx.beginPath();
      ctx.moveTo(X,0);
      ctx.lineTo(X,H);
      ctx.stroke();
    }
    for(let y = Math.ceil(view.ymin/gy)*gy; y <= view.ymax + 1e-9; y += gy){
      const Y = mapY(y,H);
      ctx.strokeStyle = (Math.abs(y) < 1e-9) ? "rgba(255,255,255,0.22)" : "rgba(255,255,255,0.08)";
      ctx.beginPath();
      ctx.moveTo(0,Y);
      ctx.lineTo(W,Y);
      ctx.stroke();
    }

    // axes labels and ticks
    ctx.fillStyle = "rgba(232,238,252,0.92)";
    ctx.font = "600 13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.fillText("κx = (a/π) kx", 12, 18);
    ctx.fillText("κy = (a/π) ky", 12, 36);

    // ticks on axes
    ctx.strokeStyle = "rgba(255,255,255,0.28)";
    ctx.lineWidth = 1.5;
    const X0 = mapX(0,W), Y0 = mapY(0,H);

    // x-axis ticks
    for(let x=-2; x<=2; x+=1){
      const X = mapX(x,W);
      ctx.beginPath();
      ctx.moveTo(X, Y0-5);
      ctx.lineTo(X, Y0+5);
      ctx.stroke();
      ctx.fillStyle = "rgba(184,196,230,0.9)";
      ctx.font = "12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace";
      ctx.fillText(String(x), X-3, Y0+18);
    }

    // y-axis ticks at multiples of 1/3
    const ys = [-2/3, -1/3, 0, 1/3, 2/3];
    ys.forEach(y=>{
      const Y = mapY(y,H);
      ctx.beginPath();
      ctx.moveTo(X0-6, Y);
      ctx.lineTo(X0+6, Y);
      ctx.stroke();
      ctx.fillStyle = "rgba(184,196,230,0.9)";
      ctx.font = "12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace";
      const label = (Math.abs(y) < 1e-9) ? "0" : (Math.abs(y-1/3)<1e-6 ? "1/3" :
                    (Math.abs(y+1/3)<1e-6 ? "-1/3" :
                    (Math.abs(y-2/3)<1e-6 ? "2/3" : "-2/3")));
      ctx.fillText(label, X0+10, Y+4);
    });
  }

  function drawLineInView(lineFn, W, H){
    // lineFn returns y given x; draw segment where y is within view.
    const N = 400;
    let started = false;
    ctx.beginPath();
    for(let i=0;i<=N;i++){
      const x = view.xmin + (view.xmax-view.xmin)*i/N;
      const y = lineFn(x);
      if(y < view.ymin || y > view.ymax || !isFinite(y)){
        started = false;
        continue;
      }
      const X = mapX(x,W), Y = mapY(y,H);
      if(!started){
        ctx.moveTo(X,Y);
        started = true;
      }else{
        ctx.lineTo(X,Y);
      }
    }
    ctx.stroke();
  }

  function draw(W,H){
    drawGrid(W,H);

    // Draw 1st BZ rectangle: |kx|<=1, |ky|<=1/3 in kappa coords
    const x1 = -1, x2 = 1, y1 = -1/3, y2 = 1/3;
    ctx.lineWidth = 2.6;
    ctx.strokeStyle = "rgba(125,211,252,0.95)";
    ctx.beginPath();
    ctx.rect(mapX(x1,W), mapY(y2,H), mapX(x2,W)-mapX(x1,W), mapY(y1,H)-mapY(y2,H));
    ctx.stroke();

    // Draw "next planes" for 2nd zone depiction: kx=±2, ky=±2/3
    ctx.setLineDash([6,5]);
    ctx.lineWidth = 2.0;
    ctx.strokeStyle = "rgba(167,139,250,0.85)";

    // vertical x = ±2
    [-2,2].forEach(x=>{
      const X = mapX(x,W);
      ctx.beginPath();
      ctx.moveTo(X, 0);
      ctx.lineTo(X, H);
      ctx.stroke();
    });

    // horizontal y = ±2/3
    [-2/3, 2/3].forEach(y=>{
      const Y = mapY(y,H);
      ctx.beginPath();
      ctx.moveTo(0, Y);
      ctx.lineTo(W, Y);
      ctx.stroke();
    });

    // Diagonal planes: kx ± (1/3)ky = ±10/9
    // In κ coords: κx ± (1/3)κy = ±10/9 ⇒ κy = 3(±10/9 - κx) or κy = 3(κx ∓ 10/9)
    ctx.setLineDash([4,4]);
    ctx.lineWidth = 1.8;
    ctx.strokeStyle = "rgba(251,191,36,0.85)";

    const c = 10/9;

    // κx + (1/3)κy = +c => κy = 3(c - κx)
    drawLineInView(x => 3*(c - x), W, H);

    // κx + (1/3)κy = -c => κy = 3*(-c - x)
    drawLineInView(x => 3*(-c - x), W, H);

    // κx - (1/3)κy = +c => κy = 3*(x - c)
    drawLineInView(x => 3*(x - c), W, H);

    // κx - (1/3)κy = -c => κy = 3*(x + c)
    drawLineInView(x => 3*(x + c), W, H);

    ctx.setLineDash([]);

    // Legend
    const lx = 14, ly = 52;
    ctx.font = "600 12.5px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.fillStyle = "rgba(232,238,252,0.92)";
    ctx.fillText("Legend:", lx, ly);

    // 1st BZ
    ctx.strokeStyle = "rgba(125,211,252,0.95)";
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.moveTo(lx, ly+14);
    ctx.lineTo(lx+26, ly+14);
    ctx.stroke();
    ctx.fillStyle = "rgba(184,196,230,0.95)";
    ctx.fillText("1st BZ (exact)", lx+34, ly+18);

    // next planes
    ctx.strokeStyle = "rgba(167,139,250,0.85)";
    ctx.setLineDash([6,5]);
    ctx.lineWidth = 2.2;
    ctx.beginPath();
    ctx.moveTo(lx, ly+34);
    ctx.lineTo(lx+26, ly+34);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillStyle = "rgba(184,196,230,0.95)";
    ctx.fillText("Next Bragg planes (±2, ±2/3)", lx+34, ly+38);

    // diagonals
    ctx.strokeStyle = "rgba(251,191,36,0.85)";
    ctx.setLineDash([4,4]);
    ctx.lineWidth = 2.0;
    ctx.beginPath();
    ctx.moveTo(lx, ly+54);
    ctx.lineTo(lx+26, ly+54);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillStyle = "rgba(184,196,230,0.95)";
    ctx.fillText("Diagonal planes κx±(1/3)κy=±10/9", lx+34, ly+58);

    // Title inside plot
    ctx.fillStyle = "rgba(232,238,252,0.92)";
    ctx.font = "800 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
    ctx.fillText("First & Second Brillouin-Zone Boundary Planes (b = 3a)", 12, H-14);
  }

  window.addEventListener("resize", resizeAndDraw);
  resizeAndDraw();
})();
</script>
</body>
</html>
