<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Brillouin Zones of a 2D Divalent Metal (Square Lattice): Electron & Hole Energy Surfaces in the Nearly-Free-Electron Model</title>
  <style>
    :root{
      --bg:#0b0d12;
      --panel:#111523;
      --panel2:#0f1320;
      --text:#e9eefc;
      --muted:#aab6da;
      --faint:#7f8bb3;
      --accent:#76a8ff;
      --accent2:#7dffcc;
      --warn:#ffcc66;
      --danger:#ff6b7a;
      --ok:#7dff8c;
      --border:rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
      --serif: ui-serif, Georgia, "Times New Roman", Times, serif;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 15% 0%, rgba(118,168,255,.20), transparent 55%),
                  radial-gradient(900px 600px at 100% 20%, rgba(125,255,204,.12), transparent 55%),
                  linear-gradient(180deg, var(--bg), #070910);
      color:var(--text);
      line-height:1.6;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      position:relative;
      padding:28px 18px 10px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(17,21,35,.92), rgba(11,13,18,.35));
      backdrop-filter: blur(10px);
    }
    .wrap{max-width:1150px; margin:0 auto; padding:0 14px}
    .hero{
      display:grid;
      grid-template-columns: 1.45fr .85fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width: 940px){
      .hero{grid-template-columns:1fr}
    }
    h1{
      margin:0 0 8px;
      font-size: clamp(1.35rem, 1.8vw + 1rem, 2.2rem);
      letter-spacing:.2px;
    }
    .subtitle{color:var(--muted); margin:0 0 14px; font-size:1.02rem}
    .meta{
      display:flex; flex-wrap:wrap; gap:10px;
      color:var(--faint);
      font-size:.92rem;
    }
    .chip{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      padding:6px 10px;
      border-radius:999px;
    }

    main{padding:18px 18px 80px}
    .layout{
      display:grid;
      grid-template-columns: 300px 1fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width: 980px){
      .layout{grid-template-columns:1fr}
    }

    /* Sticky TOC */
    nav.toc{
      position:sticky;
      top:12px;
      align-self:start;
      background: linear-gradient(180deg, rgba(17,21,35,.78), rgba(17,21,35,.50));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:12px 12px 10px;
      overflow:hidden;
    }
    nav.toc .toc-title{
      display:flex; justify-content:space-between; align-items:center;
      gap:8px;
      margin:2px 2px 8px;
    }
    nav.toc h2{
      font-size:1rem;
      margin:0;
      letter-spacing:.2px;
    }
    .toc small{color:var(--faint)}
    .toc ul{list-style:none; padding:0; margin:0}
    .toc li{margin:0}
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      color:var(--muted);
      border:1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }
    .toc a:hover{
      background: rgba(118,168,255,.10);
      border-color: rgba(118,168,255,.25);
      transform: translateX(2px);
      color: var(--text);
      text-decoration:none;
    }

    section, article{
      background: linear-gradient(180deg, rgba(17,21,35,.70), rgba(15,19,32,.52));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:16px 16px 14px;
      margin:0 0 16px;
      overflow:hidden;
    }
    section h2, article h2{
      margin:0 0 10px;
      font-size:1.25rem;
      letter-spacing:.2px;
    }
    h3{
      margin:14px 0 8px;
      font-size:1.05rem;
      letter-spacing:.2px;
    }
    p{margin:8px 0}
    ul{margin:8px 0 8px 22px}
    li{margin:5px 0}

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 820px){
      .grid2{grid-template-columns:1fr}
    }

    .callout{
      border:1px solid var(--border);
      background: rgba(255,255,255,.035);
      border-radius:16px;
      padding:12px 12px 10px;
      margin:10px 0;
    }
    .callout strong{color:var(--text)}
    .callout.assumptions{border-color: rgba(255,204,102,.35); background: rgba(255,204,102,.07)}
    .callout.keyeq{border-color: rgba(118,168,255,.38); background: rgba(118,168,255,.07)}
    .callout.mistakes{border-color: rgba(255,107,122,.35); background: rgba(255,107,122,.06)}
    .callout.final{border-color: rgba(125,255,140,.35); background: rgba(125,255,140,.06)}
    .callout.mathinsight{border-color: rgba(125,255,204,.35); background: rgba(125,255,204,.06)}

    .kbox{
      position:relative;
      border:1px solid var(--border);
      background: rgba(0,0,0,.22);
      border-radius:16px;
      overflow:hidden;
      margin:10px 0;
    }
    pre{
      margin:0;
      padding:12px 12px 14px;
      font-family: var(--mono);
      font-size:.92rem;
      color: #eaf0ff;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .btnrow{
      display:flex; flex-wrap:wrap; gap:8px;
      padding:10px 10px 0;
    }
    button.copy{
      cursor:pointer;
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      color: var(--text);
      padding:8px 10px;
      border-radius:999px;
      font-size:.88rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    button.copy:hover{
      background: rgba(118,168,255,.10);
      border-color: rgba(118,168,255,.30);
      transform: translateY(-1px);
    }
    .toast{
      position: fixed;
      right: 14px;
      bottom: 14px;
      padding: 10px 12px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: rgba(17,21,35,.92);
      box-shadow: var(--shadow);
      color: var(--muted);
      font-size:.92rem;
      opacity:0;
      transform: translateY(10px);
      pointer-events:none;
      transition: opacity .2s ease, transform .2s ease;
      z-index: 999;
    }
    .toast.show{opacity:1; transform: translateY(0)}
    details{
      border:1px solid var(--border);
      background: rgba(255,255,255,.03);
      border-radius:16px;
      padding:10px 12px;
      margin:10px 0;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight:600;
    }
    summary::marker{color: var(--accent)}
    .backtop{
      display:inline-block;
      margin-top:10px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
    }
    .backtop:hover{color:var(--text); text-decoration:none; border-color: rgba(118,168,255,.30); background: rgba(118,168,255,.10)}
    figure{
      margin:10px 0;
      padding:12px;
      border:1px solid var(--border);
      border-radius:16px;
      background: rgba(0,0,0,.18);
    }
    figcaption{color:var(--muted); font-size:.92rem; margin-top:10px}
    canvas{
      width:100%;
      height:auto;
      display:block;
      border-radius:14px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.08);
    }

    /* Print-friendly */
    @media print{
      body{background:#fff; color:#000}
      header, nav.toc, .toast, button.copy, .btnrow, .backtop{display:none !important}
      section, article{box-shadow:none; border:1px solid #ccc; background:#fff}
      a{color:#000; text-decoration:underline}
      pre{color:#000}
      figure, canvas{break-inside:avoid}
      section, article{break-inside:avoid}
      h2, h3{break-after:avoid}
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap">
      <div class="hero">
        <div>
          <h1>Brillouin Zones of a 2D Divalent Square-Lattice Metal: Electron &amp; Hole Energy Surfaces (Nearly-Free Electrons)</h1>
          <p class="subtitle">
            We connect electron counting, Fermi-surface area in 2D, and zone folding to explain why a divalent system naturally produces
            <em>electron pockets</em> and <em>hole pockets</em> near Brillouin-zone boundaries in the almost free electron picture.
          </p>
          <div class="meta">
            <span class="chip">Model: Nearly-free electron (NFE)</span>
            <span class="chip">Lattice: 2D square, lattice constant <span style="font-family:var(--mono)">a</span></span>
            <span class="chip">Valence: 2 conduction e⁻ / atom</span>
            <span class="chip">Goal: Sketch electron &amp; hole energy surfaces</span>
          </div>
        </div>
        <div class="callout keyeq">
          <strong>Quick Summary</strong>
          <ul>
            <li><strong>What:</strong> Determine the Fermi surface placement relative to Brillouin zones for a 2D square lattice with 2 electrons/cell.</li>
            <li><strong>Key idea:</strong> In 2D, electron count fixes the <em>k-space area</em> enclosed by the Fermi contour: occupied area ∝ electron density.</li>
            <li><strong>Governing relation:</strong> <span style="font-family:var(--mono)">n = k_F²/(2π)</span> (including spin) for a free-electron circle.</li>
            <li><strong>Counting result:</strong> With 2 e⁻/cell, the free-electron Fermi-circle area equals the first BZ area: <span style="font-family:var(--mono)">A_F = A_BZ</span>.</li>
            <li><strong>Consequence:</strong> The free-electron circle slightly exceeds the zone boundary along axes, so it intersects Bragg planes at <span style="font-family:var(--mono)">k_x = ±π/a</span> or <span style="font-family:var(--mono)">k_y = ±π/a</span>.</li>
            <li><strong>NFE physics:</strong> Zone-boundary degeneracies split into two bands with a small gap <span style="font-family:var(--mono)">2|U_G|</span>, creating <em>hole pockets</em> in the lower band and <em>electron pockets</em> in the upper band near X points.</li>
            <li><strong>Sketch instruction:</strong> Use a zone scheme centered at an X point (a repeated-zone choice) so each electron pocket is shown as a <em>closed</em> contour.</li>
            <li><strong>Result type:</strong> Symbolic + qualitative sketch guidance (no numeric material constants needed).</li>
          </ul>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap">
      <div class="layout">
        <nav class="toc" aria-label="Table of contents">
          <div class="toc-title">
            <h2>Contents</h2>
            <small>Sticky</small>
          </div>
          <ul>
            <li><a href="#qs">Quick Summary</a></li>
            <li><a href="#part0">PART 0 — Concept Primer</a></li>
            <li><a href="#part0b">PART 0B — Industry &amp; Applied Physics</a></li>
            <li><a href="#part1">PART 1 — Problem Analysis</a></li>
            <li><a href="#part2">PART 2 — Strategy &amp; Tips</a></li>
            <li><a href="#part3">PART 3 — Full Solution</a></li>
            <li><a href="#part4">PART 4 — Deeper Understanding</a></li>
            <li><a href="#part5">PART 5 — Optional Plot Guide</a></li>
          </ul>
        </nav>

        <div>
          <section id="qs">
            <h2>Quick Summary (repeat)</h2>
            <ul>
              <li>We use 2D k-space counting to determine <span style="font-family:var(--mono)">k_F</span> and where the Fermi contour sits relative to the square first Brillouin zone.</li>
              <li>For a square lattice with one atom per primitive cell, 2 conduction electrons/atom means <span style="font-family:var(--mono)">2</span> electrons per cell.</li>
              <li>With spin degeneracy 2, a filled band corresponds to occupying an area equal to the BZ area in the reduced-zone picture.</li>
              <li>Free-electron Fermi circle: <span style="font-family:var(--mono)">n = k_F²/(2π)</span>, with <span style="font-family:var(--mono)">n = 2/a²</span>, giving <span style="font-family:var(--mono)">k_F = 2√π / a</span>.</li>
              <li>The first BZ is a square of area <span style="font-family:var(--mono)">A_BZ = (2π/a)²</span>; the circle area <span style="font-family:var(--mono)">A_F = π k_F²</span> equals <span style="font-family:var(--mono)">A_BZ</span>, so the circle must cross the BZ edges.</li>
              <li>In the nearly-free-electron model, the periodic potential couples <span style="font-family:var(--mono)">k</span> and <span style="font-family:var(--mono)">k−G</span>, opening gaps at Bragg planes, producing electron (upper band) and hole (lower band) pockets near zone-edge centers (X points).</li>
            </ul>
          </section>

          <article id="part0">
            <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

            <div class="grid2">
              <div>
                <h3>Core definitions (symbols + SI units)</h3>
                <ul>
                  <li><strong>Lattice constant</strong> <span style="font-family:var(--mono)">a</span> (m): real-space primitive translation length.</li>
                  <li><strong>Reciprocal lattice vectors</strong> <span style="font-family:var(--mono)">G</span> (m⁻¹): for square lattice, <span style="font-family:var(--mono)">G = (2π/a)(h, k)</span> with integers <span style="font-family:var(--mono)">h,k</span>.</li>
                  <li><strong>Crystal wavevector</strong> <span style="font-family:var(--mono)">k</span> (m⁻¹): labels Bloch states.</li>
                  <li><strong>First Brillouin zone (BZ)</strong>: Wigner–Seitz cell in reciprocal space.</li>
                  <li><strong>Fermi wavevector</strong> <span style="font-family:var(--mono)">k_F</span> (m⁻¹): boundary of occupied states at <span style="font-family:var(--mono)">T=0</span> in a free-electron-like band.</li>
                  <li><strong>Electron density (2D)</strong> <span style="font-family:var(--mono)">n</span> (m⁻²): electrons per area.</li>
                  <li><strong>Energy</strong> <span style="font-family:var(--mono)">E</span> (J): for free electrons <span style="font-family:var(--mono)">E = ħ²k²/(2m)</span>.</li>
                  <li><strong>Periodic potential Fourier component</strong> <span style="font-family:var(--mono)">U_G</span> (J): sets gap size at Bragg planes in NFE.</li>
                </ul>
              </div>
              <div>
                <h3>Physical meaning (intuition)</h3>
                <ul>
                  <li><strong>Brillouin zones</strong> classify where Bragg reflection occurs in k-space; zone boundaries are where plane waves become degenerate and mix strongly.</li>
                  <li><strong>Fermi surface in 2D</strong> is a <em>contour</em> in k-space; its enclosed area is directly tied to electron count (Luttinger-style counting for free-like bands).</li>
                  <li><strong>Electron pockets</strong>: closed Fermi contours in an upper band near a band minimum.</li>
                  <li><strong>Hole pockets</strong>: closed Fermi contours in a lower band near a band maximum (missing electrons behave like positive carriers).</li>
                </ul>

                <div class="callout assumptions">
                  <strong>Validity conditions of the Nearly-Free-Electron model</strong>
                  <ul>
                    <li>Periodic potential is weak compared to kinetic energy near the Fermi level: <span style="font-family:var(--mono)">|U_G| ≪ E_F</span>.</li>
                    <li>Band gaps are small and localized near Bragg planes.</li>
                    <li>Electron–electron interactions are neglected at the level of single-particle band formation.</li>
                  </ul>
                </div>
              </div>
            </div>

            <h3>Key laws/principles &amp; why they apply</h3>
            <ul>
              <li><strong>Bloch theorem:</strong> eigenstates of a periodic Hamiltonian <span style="font-family:var(--mono)">H = −(ħ²/2m)∇² + U(r)</span> are labeled by <span style="font-family:var(--mono)">k</span>. Here ∇² (Laplacian) acts on real-space wavefunctions.</li>
              <li><strong>State counting in k-space (2D):</strong> each allowed k-state occupies area <span style="font-family:var(--mono)">(2π)²/A</span> in k-space for a sample of area <span style="font-family:var(--mono)">A</span>, and spin gives a factor 2.</li>
              <li><strong>Bragg plane mixing:</strong> when <span style="font-family:var(--mono)">E_0(k) = E_0(k−G)</span>, plane waves are degenerate and a weak periodic potential opens a gap.</li>
            </ul>

            <h3>Common approximations &amp; why used</h3>
            <ul>
              <li><strong>Free-electron dispersion</strong> away from boundaries: <span style="font-family:var(--mono)">E≈ħ²k²/(2m)</span>.</li>
              <li><strong>Two-wave (2×2) approximation</strong> near a single Bragg plane: only <span style="font-family:var(--mono)">|k⟩</span> and <span style="font-family:var(--mono)">|k−G⟩</span> are retained because other couplings are off-resonant (energy denominators large).</li>
            </ul>

            <h3>Mini intuition examples (quick)</h3>
            <ul>
              <li>If <span style="font-family:var(--mono)">A_F</span> is much smaller than <span style="font-family:var(--mono)">A_BZ</span>, the Fermi contour is fully inside the first BZ and looks like a nearly circular electron surface around Γ.</li>
              <li>If <span style="font-family:var(--mono)">A_F</span> is comparable to <span style="font-family:var(--mono)">A_BZ</span>, the contour hits zone boundaries → band gaps matter → pockets form.</li>
            </ul>

            <div class="callout mistakes">
              <strong>What to watch for (pitfalls)</strong>
              <ul>
                <li>Confusing <em>extended-zone</em> vs <em>reduced-zone</em> schemes: the same physical states can look “open” in one scheme and “closed” in another due to folding.</li>
                <li>Forgetting the spin factor 2 in state counting (changes <span style="font-family:var(--mono)">k_F</span> by √2).</li>
                <li>Assuming “2 electrons/cell ⇒ insulator” automatically: in NFE, whether it’s insulating depends on whether the zone-boundary gap actually separates filled/empty states (band overlap can keep it metallic).</li>
              </ul>
            </div>

            <div class="callout mathinsight">
              <strong>Math Insight:</strong>
              The band formation near a zone boundary is a <em>finite-dimensional eigenvalue problem</em>: the Schrödinger PDE
              <span style="font-family:var(--mono)">[−(ħ²/2m)∇² + U(r)]ψ = Eψ</span>
              becomes, near a Bragg plane, a <span style="font-family:var(--mono)">2×2</span> matrix eigenproblem due to near-degeneracy of two plane-wave basis states.
              The “gap” is the eigenvalue splitting of this matrix.
            </div>

            <a class="backtop" href="#top">Back to top ↑</a>
          </article>

          <article id="part0b">
            <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>
            <p>
              Even though this problem is “textbook,” the ideas show up constantly in real engineered systems where electrons are confined
              to quasi-2D layers and their transport depends on whether carriers are electron-like, hole-like, or both.
            </p>

            <h3>Where this appears in industry (examples)</h3>
            <ul>
              <li><strong>Semiconductor heterostructures &amp; MOSFET inversion layers:</strong> electrons form a 2D gas; zone folding and valley structure influence mobility and anisotropy.</li>
              <li><strong>2D materials &amp; thin films (graphene-like, TMDs, oxide interfaces):</strong> small Fermi pockets and multi-carrier transport (electrons + holes) can occur.</li>
              <li><strong>Metallization &amp; interconnect reliability:</strong> carrier type, density of states near <span style="font-family:var(--mono)">E_F</span>, and scattering near zone boundaries affect resistivity and heating.</li>
            </ul>

            <h3>Why engineers care</h3>
            <ul>
              <li><strong>Performance:</strong> electron vs hole pockets can change conductivity tensor, Hall coefficient sign, and magnetoresistance.</li>
              <li><strong>Reliability:</strong> scattering near Bragg planes (and resulting effective mass changes) impacts Joule heating and electromigration stress.</li>
              <li><strong>Cost/efficiency:</strong> knowing when a system is compensated (electrons and holes both present) matters for sensor calibration and device yield.</li>
            </ul>

            <h3>Typical measurement/validation methods</h3>
            <ul>
              <li><strong>Hall effect and magnetotransport:</strong> separate electron and hole contributions via multi-carrier fitting.</li>
              <li><strong>ARPES (angle-resolved photoemission):</strong> direct mapping of band dispersions and Fermi contours in k-space (especially for quasi-2D materials).</li>
              <li><strong>Quantum oscillations (SdH/dHvA):</strong> pocket areas from oscillation frequencies (directly related to k-space areas).</li>
            </ul>

            <h3>Design trade-offs &amp; constraints</h3>
            <ul>
              <li><strong>Non-ideal lattices:</strong> strain, defects, and finite thickness smear the “clean” BZ picture and modify pocket shapes.</li>
              <li><strong>Temperature:</strong> smearing of the Fermi edge can blur small pockets; device behavior can change sign (Hall) as pockets populate differently.</li>
              <li><strong>Manufacturability:</strong> small changes in lattice constant <span style="font-family:var(--mono)">a</span> (strain, thermal expansion) shift BZ size and can push a system toward/away from compensation.</li>
            </ul>

            <details>
              <summary>From lab to product: adapting the ideal model</summary>
              <p>
                Engineers often replace the full nearly-free-electron band picture by a small set of <em>effective masses</em> and pocket areas
                extracted from measurements/simulations. The “pockets near X” become parameters in compact models (mobility, density-of-states,
                multi-carrier transport), while disorder adds phenomenological scattering times.
              </p>
            </details>

            <a class="backtop" href="#top">Back to top ↑</a>
          </article>

          <article id="part1">
            <h2>PART 1 — Problem Analysis (no solving yet)</h2>

            <h3>Problem restatement</h3>
            <p>
              We have a two-dimensional metal on a square lattice (lattice constant <span style="font-family:var(--mono)">a</span>) with
              two conduction electrons per atom (and one atom per primitive cell). In the almost free electron approximation, we must
              <strong>sketch the electron and hole energy surfaces</strong> (i.e., Fermi contours/pockets in k-space for the relevant bands).
              For the electrons we should choose a Brillouin-zone scheme in which the electron Fermi surface appears <strong>closed</strong>.
            </p>

            <div class="grid2">
              <div>
                <h3>Given</h3>
                <ul>
                  <li>2D square lattice, lattice constant <span style="font-family:var(--mono)">a</span>.</li>
                  <li>Conduction electrons per atom: <span style="font-family:var(--mono)">z = 2</span>.</li>
                  <li>Model: almost free electron (weak periodic potential).</li>
                </ul>
              </div>
              <div>
                <h3>Unknowns / must determine</h3>
                <ul>
                  <li>Where the free-electron Fermi contour lies relative to the first BZ.</li>
                  <li>How zone-boundary gaps reshape the contour into electron/hole pockets.</li>
                  <li>Which zone scheme makes the electron pocket(s) closed in the sketch.</li>
                </ul>
              </div>
            </div>

            <h3>Relevant principles (and why)</h3>
            <ul>
              <li><strong>k-space counting in 2D</strong> determines <span style="font-family:var(--mono)">k_F</span> from electron density.</li>
              <li><strong>Reciprocal lattice geometry</strong> gives the BZ boundaries: Bragg planes at <span style="font-family:var(--mono)">k_x=±π/a</span>, <span style="font-family:var(--mono)">k_y=±π/a</span>.</li>
              <li><strong>NFE band splitting</strong> at Bragg planes explains the presence of electron and hole pockets (upper vs lower band near X points).</li>
            </ul>

            <div class="callout assumptions">
              <strong>Assumptions (explicit)</strong>
              <ul>
                <li>One atom per primitive cell (square Bravais lattice), so “2 electrons per atom” means 2 electrons per cell.</li>
                <li><span style="font-family:var(--mono)">T=0</span> for sharp Fermi surface.</li>
                <li>Weak periodic potential: treat gaps perturbatively near zone boundaries (two-wave approximation).</li>
                <li>Ignore spin–orbit and many-body renormalizations; focus on band-structure geometry.</li>
              </ul>
            </div>

            <h3>Possible approaches (compare)</h3>
            <ol>
              <li><strong>Pure electron counting + geometry (best for sketch):</strong> compute <span style="font-family:var(--mono)">k_F</span> from density and compare to BZ size; then infer where crossings occur and where pockets form.</li>
              <li><strong>Nearly-free electron 2×2 diagonalization:</strong> write the coupled-plane-wave Hamiltonian near X and show explicitly the gap and band extrema locations (best for rigor).</li>
              <li><strong>Tight-binding alternative (not requested):</strong> would produce different shapes (cosines) and is not aligned with “almost free electron” instruction.</li>
            </ol>
            <p>
              <strong>Chosen approach:</strong> (1) + (2): use counting to locate the free-electron Fermi circle and (briefly) use the NFE
              eigenproblem to justify electron/hole pockets near the Bragg planes.
            </p>

            <a class="backtop" href="#top">Back to top ↑</a>
          </article>

          <article id="part2">
            <h2>PART 2 — Strategy &amp; Tips (roadmap only)</h2>

            <ol>
              <li><strong>Define geometry:</strong> write real/reciprocal lattice vectors; identify first BZ and its area <span style="font-family:var(--mono)">A_BZ</span>.</li>
              <li><strong>Compute 2D electron density:</strong> <span style="font-family:var(--mono)">n = z/a²</span> with <span style="font-family:var(--mono)">z=2</span>.</li>
              <li><strong>Count k-states:</strong> relate <span style="font-family:var(--mono)">n</span> to the occupied k-space area for a free-electron circle to get <span style="font-family:var(--mono)">k_F</span>.</li>
              <li><strong>Compare to BZ boundary:</strong> check whether <span style="font-family:var(--mono)">k_F</span> is smaller or larger than <span style="font-family:var(--mono)">π/a</span>, and find intersection points with zone edges.</li>
              <li><strong>Introduce NFE mixing near Bragg planes:</strong> set up the 2×2 Hamiltonian coupling <span style="font-family:var(--mono)">k</span> and <span style="font-family:var(--mono)">k−G</span>; infer band splitting and existence of maxima/minima.</li>
              <li><strong>Identify pockets:</strong> lower band near X has a local maximum (→ holes if Fermi level slightly below it); upper band near X has a local minimum (→ electrons if Fermi level slightly above it).</li>
              <li><strong>Choose zone scheme:</strong> show electron pockets as closed by drawing in a repeated-zone centered at X (instead of cutting them at the first BZ boundary).</li>
              <li><strong>Sketch:</strong> draw BZ square, free circle, then replace boundary-crossing regions by electron/hole pockets near X.</li>
            </ol>

            <div class="callout mistakes">
              <strong>Common mistakes (quick tips)</strong>
              <ul>
                <li>Using <span style="font-family:var(--mono)">n = k_F²/π</span> (missing spin factor) instead of <span style="font-family:var(--mono)">n = k_F²/(2π)</span>.</li>
                <li>Mixing “closed in extended zone” with “closed in reduced zone.” The problem explicitly allows choosing a zone scheme.</li>
                <li>Forgetting that the free-electron circle does <em>not</em> reach the BZ corners here; it crosses near the midpoints of edges.</li>
              </ul>
            </div>

            <a class="backtop" href="#top">Back to top ↑</a>
          </article>

          <article id="part3">
            <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

            <h3>Qualitative expectation before calculating</h3>
            <p>
              With 2 electrons per unit cell in 2D, we expect a comparatively large occupied k-space area.
              Since the first BZ has finite area, it is plausible that the free-electron Fermi circle will
              reach (or cross) the first BZ boundary. In a periodic potential, crossings at zone boundaries
              cannot remain “simple crossings”: they become avoided crossings (band gaps), so we expect the
              Fermi contour to break into pieces that belong to different bands—naturally producing both
              electron-like and hole-like pockets near the Bragg planes.
            </p>

            <h3>Step 1: Mathematical model (Hamiltonian, variables, domain)</h3>
            <p>
              We model conduction electrons by a single-particle Schrödinger operator in 2D:
            </p>
            <div class="kbox" id="eq-model">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-model pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>Hψ(r) = Eψ(r),
H = −(ħ²/2m)∇² + U(r)

r = (x,y) in R²,  ∇² = ∂²/∂x² + ∂²/∂y²
U(r + R) = U(r) for any lattice vector R</code></pre>
            </div>
            <p>
              Bloch’s theorem applies because <span style="font-family:var(--mono)">U(r)</span> is periodic:
              solutions can be labeled by wavevector <span style="font-family:var(--mono)">k</span> in reciprocal space.
            </p>

            <h3>Step 2: Reciprocal lattice and first Brillouin zone</h3>
            <p>
              For a square lattice with primitive vectors <span style="font-family:var(--mono)">a₁ = a x̂</span>,
              <span style="font-family:var(--mono)">a₂ = a ŷ</span>, the reciprocal primitive vectors are
              <span style="font-family:var(--mono)">b₁ = (2π/a) x̂</span>, <span style="font-family:var(--mono)">b₂ = (2π/a) ŷ</span>.
              Thus any reciprocal lattice vector is:
            </p>
            <div class="kbox" id="eq-G">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-G pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>G = h b₁ + k b₂ = (2π/a)(h, k),  with integers h,k</code></pre>
            </div>
            <p>
              The first BZ is the Wigner–Seitz cell: a square bounded by Bragg planes at
              <span style="font-family:var(--mono)">k_x = ±π/a</span> and <span style="font-family:var(--mono)">k_y = ±π/a</span>.
              Its area is:
            </p>
            <div class="kbox" id="eq-bzarea">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-bzarea pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>A_BZ = (2π/a)² = 4π²/a²</code></pre>
            </div>

            <h3>Step 3: Electron density in 2D from “2 electrons per atom”</h3>
            <p>
              For one atom per primitive cell, the area per cell is <span style="font-family:var(--mono)">a²</span>.
              With <span style="font-family:var(--mono)">z=2</span> conduction electrons per cell, the 2D electron density is:
            </p>
            <div class="kbox" id="eq-density">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-density pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>n = z / a² = 2 / a²   (units: m⁻²)</code></pre>
            </div>
            <p>
              (Dimensional check: <span style="font-family:var(--mono)">a²</span> has units m², so <span style="font-family:var(--mono)">n</span> is m⁻².)
            </p>

            <h3>Step 4: k-space counting in 2D → compute k<sub>F</sub></h3>
            <p>
              For free electrons in 2D at <span style="font-family:var(--mono)">T=0</span>, the occupied k-states fill a disk of radius
              <span style="font-family:var(--mono)">k_F</span>. Each k-state occupies area <span style="font-family:var(--mono)">(2π)²/A</span> in k-space
              (A = sample area), and spin gives degeneracy <span style="font-family:var(--mono)">g_s = 2</span>.
              Therefore the number of electrons is:
            </p>
            <div class="kbox" id="eq-counting">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-counting pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>N = g_s * (A_k / (2π)²) * A
where A_k = π k_F² (area of occupied disk in k-space)</code></pre>
            </div>
            <p>
              Divide by <span style="font-family:var(--mono)">A</span> to get density:
            </p>
            <div class="kbox" id="eq-nkf">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-nkf pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>n = N/A = 2 * (π k_F²)/(2π)²
  = 2 * (π k_F²)/(4π²)
  = k_F²/(2π)</code></pre>
            </div>
            <p>
              Solve for <span style="font-family:var(--mono)">k_F</span> using <span style="font-family:var(--mono)">n = 2/a²</span>:
            </p>
            <div class="kbox" id="eq-kf">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-kf pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>k_F² = 2π n = 2π(2/a²) = 4π/a²
k_F = (2√π)/a</code></pre>
            </div>

            <h3>Step 5: Compare the free-electron Fermi circle with the first BZ</h3>
            <p>
              The zone boundary along axes is at <span style="font-family:var(--mono)">|k_x| = π/a</span> (similarly for <span style="font-family:var(--mono)">k_y</span>).
              Compare <span style="font-family:var(--mono)">k_F</span> to <span style="font-family:var(--mono)">π/a</span>:
              <span style="font-family:var(--mono)">k_F a = 2√π ≈ 3.544</span> while <span style="font-family:var(--mono)">π ≈ 3.142</span>.
              So the circle slightly <em>exceeds</em> the zone boundary along the axes, meaning it intersects the Bragg planes
              <span style="font-family:var(--mono)">k_x=±π/a</span> and <span style="font-family:var(--mono)">k_y=±π/a</span>.
            </p>
            <p>
              The circle does <strong>not</strong> reach the zone corners because the corner distance is
              <span style="font-family:var(--mono)">|k| = √2 (π/a) ≈ 4.44/a</span> which is larger than <span style="font-family:var(--mono)">k_F ≈ 3.54/a</span>.
              So crossings happen near the midpoints of zone edges (the X points), not near corners (M).
            </p>

            <details>
              <summary>Intersection point (optional algebra)</summary>
              <p>
                At <span style="font-family:var(--mono)">k_x = π/a</span>, the circle condition <span style="font-family:var(--mono)">k_x² + k_y² = k_F²</span> gives:
              </p>
              <div class="kbox">
                <pre><code>k_y = ±√(k_F² − (π/a)²)
    = ±(1/a)√(4π − π²)
    = ±(π/a)√(4/π − 1)</code></pre>
              </div>
              <p>
                This confirms the crossing is near the edge center because <span style="font-family:var(--mono)">|k_y|</span> is modest compared to <span style="font-family:var(--mono)">π/a</span>.
              </p>
            </details>

            <h3>Step 6: Key geometric counting result — A<sub>F</sub> equals A<sub>BZ</sub></h3>
            <p>
              The free-electron Fermi disk area is:
            </p>
            <div class="kbox" id="eq-af">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-af pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>A_F = π k_F² = π (4π/a²) = 4π²/a²</code></pre>
            </div>
            <p>
              Compare to <span style="font-family:var(--mono)">A_BZ = 4π²/a²</span>. Therefore:
            </p>
            <div class="kbox" id="eq-areaequal">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-areaequal pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>A_F = A_BZ</code></pre>
            </div>
            <p>
              Interpretation: with spin included, 2 electrons per cell corresponds to <em>one full band</em> worth of k-space area.
              But because the free-electron contour is a circle while the BZ is a square, the circle must cross the zone boundary even if areas match.
              This is exactly where NFE band splitting becomes decisive for the actual electron/hole surfaces.
            </p>

            <h3>Step 7: Nearly-free electron band splitting near a Bragg plane (mathematical physics)</h3>
            <p>
              Near a zone boundary associated with reciprocal vector <span style="font-family:var(--mono)">G</span>,
              the plane waves <span style="font-family:var(--mono)">e^{i k·r}</span> and <span style="font-family:var(--mono)">e^{i (k−G)·r}</span>
              are nearly degenerate because their free-electron energies are close:
              <span style="font-family:var(--mono)">E₀(k) = ħ²|k|²/(2m)</span>.
            </p>
            <p>
              Keeping only these two coupled components (two-wave approximation), the Schrödinger eigenproblem reduces to:
            </p>
            <div class="kbox" id="eq-2x2">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-2x2 pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>Matrix eigenproblem in basis {|k⟩, |k−G⟩}:

| E₀(k)     U_G     | |c_k     | = E |c_k     |
| U_G*    E₀(k−G)   | |c_{k−G} |     |c_{k−G} |</code></pre>
            </div>
            <p>
              Solving the characteristic equation (a 2nd-degree polynomial) gives the band energies:
            </p>
            <div class="kbox" id="eq-Epm">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-Epm pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>E±(k) = (E₀(k) + E₀(k−G))/2
        ± √( ((E₀(k) − E₀(k−G))/2)² + |U_G|² )</code></pre>
            </div>
            <p>
              On the Bragg plane, by definition <span style="font-family:var(--mono)">E₀(k)=E₀(k−G)</span>, so the square-root term reduces to <span style="font-family:var(--mono)">|U_G|</span> and:
            </p>
            <div class="kbox" id="eq-gap">
              <div class="btnrow">
                <button class="copy" data-copy-target="#eq-gap pre">Copy key equation (plain text)</button>
              </div>
              <pre><code>On the zone boundary:  E± = E₀ ± |U_G|
Energy gap at the boundary:  Δ = E+ − E− = 2|U_G|</code></pre>
            </div>
            <p>
              <strong>Why this step is valid:</strong> the reduction from a PDE to a 2×2 eigenproblem uses linearity of the Schrödinger operator
              and a near-degeneracy (small energy denominator) argument: only the resonant coupling between <span style="font-family:var(--mono)">k</span> and <span style="font-family:var(--mono)">k−G</span>
              significantly modifies eigenvalues near the Bragg plane.
            </p>

            <h3>Step 8: Identify where electron and hole pockets occur</h3>
            <p>
              The relevant Bragg planes for the first BZ are associated with the smallest reciprocal vectors:
              <span style="font-family:var(--mono)">G = (±2π/a, 0)</span> and <span style="font-family:var(--mono)">G = (0, ±2π/a)</span>.
              These produce boundaries at <span style="font-family:var(--mono)">k_x = ±π/a</span> and <span style="font-family:var(--mono)">k_y = ±π/a</span>.
            </p>
            <p>
              The free-electron Fermi circle crosses those boundaries near the X points:
              <span style="font-family:var(--mono)">X = (±π/a, 0)</span>, <span style="font-family:var(--mono)">(0, ±π/a)</span>.
              At each such crossing, NFE mixing produces:
            </p>
            <ul>
              <li><strong>Lower band</strong> <span style="font-family:var(--mono)">E−(k)</span> that bends downward at the boundary, creating a <em>local maximum</em> near X along the direction normal to the boundary.</li>
              <li><strong>Upper band</strong> <span style="font-family:var(--mono)">E+(k)</span> that bends upward, creating a <em>local minimum</em> near X.</li>
            </ul>
            <p>
              Therefore, if the Fermi level lies in a regime where both bands are sampled (the typical “divalent metal” scenario in NFE
              language—i.e., the band edges near X straddle <span style="font-family:var(--mono)">E_F</span> due to small gaps/overlap), we get:
            </p>
            <div class="callout keyeq">
              <strong>Carrier-type identification near X</strong>
              <ul>
                <li><strong>Hole pockets</strong>: closed contours in the <em>lower</em> band near its maximum around X (unfilled states near the top behave as holes).</li>
                <li><strong>Electron pockets</strong>: closed contours in the <em>upper</em> band near its minimum around X (filled states near the bottom behave as electrons).</li>
              </ul>
            </div>

            <h3>Step 9: Choose a zone scheme so electron Fermi surfaces are closed</h3>
            <p>
              In the <strong>reduced-zone scheme</strong> (all k folded into the first BZ), an electron pocket centered on X can be “cut” by the BZ boundary,
              making it look open or split across opposite edges.
              To satisfy the instruction (“choose a zone scheme such that the Fermi surface is shown as closed”), use a
              <strong>repeated-zone (extended) scheme centered at X</strong>:
              translate the BZ so that an X point becomes the zone center. Then the electron pocket around that band minimum appears as a single closed loop.
            </p>

            <figure aria-label="Single static plot: Brillouin zone and Fermi-surface geometry">
              <canvas id="plot" width="980" height="520"></canvas>
              <figcaption>
                <strong>One static sketch (two panels inside one figure):</strong>
                Left: first BZ (square) with the free-electron Fermi circle (dashed) showing crossings near X.
                Right: a repeated-zone choice centered at X, showing the electron pocket as a closed contour around X.
                (Pocket shapes are schematic; the key point is location and closedness.)
              </figcaption>
            </figure>

            <div class="callout final" id="final-answer">
              <strong>Final Answer (what to sketch, clearly)</strong>
              <div class="kbox" style="margin-top:10px;">
                <div class="btnrow">
                  <button class="copy" data-copy-target="#final-answer pre">Copy final answer (plain text)</button>
                </div>
                <pre><code>1) Electron counting (2D):
   n = 2/a², and for a free-electron-like 2D metal:
   n = k_F²/(2π)  ⇒  k_F = (2√π)/a.

2) First Brillouin zone (square):
   |k_x| ≤ π/a, |k_y| ≤ π/a, with area A_BZ = (2π/a)² = 4π²/a².

3) Fermi-circle area:
   A_F = π k_F² = 4π²/a² = A_BZ.
   Since the contour is circular but the BZ is square, the circle crosses the BZ edges (not the corners), near X points.

4) Nearly-free-electron effect at the zone edges (Bragg planes):
   A weak periodic potential opens a gap Δ = 2|U_G| at k_x = ±π/a and k_y = ±π/a.
   The lower band has a local maximum near each X (→ hole pockets if E_F is slightly below that maximum),
   and the upper band has a local minimum near each X (→ electron pockets if E_F is slightly above that minimum).

5) Sketch instruction:
   • Show hole energy surfaces (Fermi contours) as closed hole pockets in the lower band near the midpoints of each BZ side (X points).
   • Show electron energy surfaces as closed electron pockets in the upper band also centered near those X points.
   • Choose a repeated-zone (extended-zone) scheme centered on an X point so each electron pocket is drawn as a single closed loop (not cut by the first-BZ boundary).</code></pre>
              </div>
            </div>

            <h3>Sanity checks</h3>
            <ul>
              <li><strong>Units:</strong> <span style="font-family:var(--mono)">k_F = (2√π)/a</span> has units m⁻¹.</li>
              <li><strong>Limiting case:</strong> if <span style="font-family:var(--mono)">z</span> were much smaller, <span style="font-family:var(--mono)">k_F</span> would shrink and the circle would lie fully inside the first BZ → no electron/hole pockets near edges.</li>
              <li><strong>Geometry check:</strong> <span style="font-family:var(--mono)">k_F &gt; π/a</span> but <span style="font-family:var(--mono)">k_F &lt; √2 π/a</span>, so crossings occur at edges (X) but not corners (M).</li>
              <li><strong>Physical meaning:</strong> “holes” live where the lower band is nearly full but missing states near its maximum; “electrons” live where the upper band begins to fill near its minimum.</li>
            </ul>

            <a class="backtop" href="#top">Back to top ↑</a>
          </article>

          <article id="part4">
            <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

            <h3>Re-interpret the result: what controls what?</h3>
            <ul>
              <li><strong>Electron count (2 per cell)</strong> fixes the <em>total occupied k-space area</em>. In 2D, this is especially direct.</li>
              <li><strong>Lattice constant <span style="font-family:var(--mono)">a</span></strong> sets the BZ size (<span style="font-family:var(--mono)">∝ 1/a</span>). Larger <span style="font-family:var(--mono)">a</span> shrinks the BZ and also reduces density <span style="font-family:var(--mono)">n=2/a²</span>, affecting <span style="font-family:var(--mono)">k_F</span>.</li>
              <li><strong>Potential Fourier component <span style="font-family:var(--mono)">U_G</span></strong> sets the gap size (<span style="font-family:var(--mono)">Δ=2|U_G|</span>) and thus how strongly the contour reconstructs into pockets.</li>
            </ul>

            <h3>Parameter dependence (qualitative)</h3>
            <ul>
              <li>If <span style="font-family:var(--mono)">|U_G| → 0</span>, the pockets “merge back” into the original free-electron circle crossing the zone boundary (no avoided crossings).</li>
              <li>As <span style="font-family:var(--mono)">|U_G|</span> increases, the splitting at the boundary increases, making electron and hole pockets more clearly separated by band character.</li>
              <li>Small changes in filling (e.g., doping away from exactly 2/cell) change pocket areas: electron pockets grow while hole pockets shrink, or vice versa, depending on whether <span style="font-family:var(--mono)">E_F</span> moves up or down.</li>
            </ul>

            <details>
              <summary>Alternative derivation idea (brief but meaningful)</summary>
              <p>
                Instead of diagonalizing the 2×2 Hamiltonian, you can view the zone boundary as a Bragg reflection condition:
                states with wavevectors differing by <span style="font-family:var(--mono)">G</span> interfere to form standing waves.
                These standing waves have different charge density relative to the ion cores; one lowers energy (bonding-like),
                the other raises energy (antibonding-like), producing the gap. The “pockets” then arise from whether the Fermi level cuts
                the bonding or antibonding branch near X.
              </p>
            </details>

            <div class="callout mathinsight">
              <strong>Math Insight (core equation as an object)</strong>
              <p>
                The expression
                <span style="font-family:var(--mono)">E±(k) = (E₀(k)+E₀(k−G))/2 ± √(((E₀(k)−E₀(k−G))/2)² + |U_G|²)</span>
                is the eigenvalue formula for a <em>Hermitian 2×2 matrix</em>. Mathematically, the square root produces an “avoided crossing”:
                when the diagonal terms become equal, the eigenvalues repel by <span style="font-family:var(--mono)">2|U_G|</span>.
                This is the same structure as coupled oscillators and two-level systems—here parameterized by k.
              </p>
            </div>

            <h3>Concept check (self-test with answers)</h3>
            <ul>
              <li><strong>Q:</strong> Why does 2 electrons per cell imply <span style="font-family:var(--mono)">A_F = A_BZ</span> for a free-electron-like 2D system?
                <br><strong>A:</strong> Because each band provides 2 electrons per cell (spin up/down), corresponding to occupying one full BZ worth of k-states.</li>
              <li><strong>Q:</strong> Why are pockets near X and not near M?
                <br><strong>A:</strong> The free-electron circle crosses <span style="font-family:var(--mono)">|k_x|=π/a</span> and <span style="font-family:var(--mono)">|k_y|=π/a</span> but does not reach <span style="font-family:var(--mono)">|k|=√2 π/a</span> at corners.</li>
              <li><strong>Q:</strong> What turns a boundary crossing into a gap?
                <br><strong>A:</strong> Coupling between degenerate plane waves <span style="font-family:var(--mono)">k</span> and <span style="font-family:var(--mono)">k−G</span> via the periodic potential Fourier component <span style="font-family:var(--mono)">U_G</span>.</li>
              <li><strong>Q:</strong> How do you decide “electron” vs “hole” pocket?
                <br><strong>A:</strong> If the Fermi contour encloses a band minimum (upper band near X), it’s electron-like; if it encloses a band maximum (lower band near X), it’s hole-like.</li>
            </ul>

            <a class="backtop" href="#top">Back to top ↑</a>
          </article>

          <article id="part5">
            <h2>PART 5 — Optional Plot Guide</h2>
            <p>
              A sketch is central to this problem, so the single canvas figure above is included to visualize:
              (i) the mismatch between the circular free-electron Fermi contour and the square first BZ, and
              (ii) why choosing a repeated-zone centered at X makes the electron pocket appear as a closed contour.
            </p>

            <ul>
              <li><strong>Left panel axes:</strong> schematic k-space with BZ boundary at <span style="font-family:var(--mono)">|k_x|,|k_y| = π/a</span>.</li>
              <li><strong>Dashed circle:</strong> free-electron Fermi contour with <span style="font-family:var(--mono)">k_F = 2√π/a</span>.</li>
              <li><strong>Highlighted regions near edges:</strong> where NFE gap opens and pockets form (schematic).</li>
              <li><strong>Right panel:</strong> zone translated so an X point is the “center,” making the electron pocket a single closed loop.</li>
            </ul>

            <a class="backtop" href="#top">Back to top ↑</a>
          </article>

          <footer class="callout" style="text-align:center; color:var(--muted);">
            <p style="margin:6px 0;">
              End of article. If you want, I can also provide a clean hand-drawn-style (still static) schematic version of the Fermi-surface sketches within the same single canvas constraint.
            </p>
          </footer>
        </div>
      </div>
    </div>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite">Copied.</div>

  <script>
    (function(){
      function toast(msg){
        const t = document.getElementById('toast');
        t.textContent = msg || 'Copied.';
        t.classList.add('show');
        clearTimeout(window.__toastTimer);
        window.__toastTimer = setTimeout(()=>t.classList.remove('show'), 1100);
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          toast('Copied to clipboard.');
        }catch(e){
          // fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          document.body.appendChild(ta);
          ta.select();
          document.execCommand('copy');
          document.body.removeChild(ta);
          toast('Copied (fallback).');
        }
      }

      document.querySelectorAll('button.copy').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const sel = btn.getAttribute('data-copy-target');
          const el = document.querySelector(sel);
          if(!el){ toast('Nothing to copy.'); return; }
          const text = el.innerText.replace(/\u00a0/g,' ');
          copyText(text.trim());
        });
      });

      // ---- Single canvas figure (static) ----
      const canvas = document.getElementById('plot');
      const ctx = canvas.getContext('2d');

      function draw(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const cssW = canvas.clientWidth;
        const cssH = Math.max(340, Math.round(cssW * 0.53));
        canvas.style.height = cssH + 'px';
        canvas.width = Math.floor(cssW * dpr);
        canvas.height = Math.floor(cssH * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        // background
        ctx.clearRect(0,0,cssW,cssH);
        ctx.fillStyle = 'rgba(0,0,0,0.18)';
        ctx.fillRect(0,0,cssW,cssH);

        const pad = 18;
        const gap = 16;
        const panelW = (cssW - pad*2 - gap) / 2;
        const panelH = cssH - pad*2;

        // helper draw panel frame
        function panel(x,y,w,h,title){
          ctx.save();
          ctx.fillStyle = 'rgba(255,255,255,0.03)';
          ctx.strokeStyle = 'rgba(255,255,255,0.10)';
          ctx.lineWidth = 1;
          roundRect(x,y,w,h,14,true,true);
          ctx.fillStyle = 'rgba(255,255,255,0.80)';
          ctx.font = '600 14px system-ui, -apple-system, Segoe UI, Roboto, Arial';
          ctx.fillText(title, x+12, y+20);
          ctx.restore();
        }

        function roundRect(x,y,w,h,r,fill,stroke){
          const rr = Math.min(r, w/2, h/2);
          ctx.beginPath();
          ctx.moveTo(x+rr, y);
          ctx.arcTo(x+w, y, x+w, y+h, rr);
          ctx.arcTo(x+w, y+h, x, y+h, rr);
          ctx.arcTo(x, y+h, x, y, rr);
          ctx.arcTo(x, y, x+w, y, rr);
          ctx.closePath();
          if(fill) ctx.fill();
          if(stroke) ctx.stroke();
        }

        // mapping from k-space to panel coords: use dimensionless q = (k a)/π
        // Then first BZ is square [-1,1]x[-1,1]. Free circle radius r = k_F a/π = 2/√π ≈ 1.128.
        const r = 2/Math.sqrt(Math.PI);

        function drawAxes(x,y,w,h){
          ctx.save();
          // grid
          ctx.strokeStyle = 'rgba(255,255,255,0.08)';
          ctx.lineWidth = 1;
          const nx = 8, ny = 8;
          for(let i=0;i<=nx;i++){
            const xx = x + (w*i/nx);
            ctx.beginPath(); ctx.moveTo(xx,y); ctx.lineTo(xx,y+h); ctx.stroke();
          }
          for(let j=0;j<=ny;j++){
            const yy = y + (h*j/ny);
            ctx.beginPath(); ctx.moveTo(x,yy); ctx.lineTo(x+w,yy); ctx.stroke();
          }
          // axes midlines
          ctx.strokeStyle = 'rgba(118,168,255,0.22)';
          ctx.beginPath(); ctx.moveTo(x+w/2,y); ctx.lineTo(x+w/2,y+h); ctx.stroke();
          ctx.beginPath(); ctx.moveTo(x,y+h/2); ctx.lineTo(x+w,y+h/2); ctx.stroke();

          // labels
          ctx.fillStyle = 'rgba(255,255,255,0.78)';
          ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace';
          ctx.fillText('q_x = k_x a / π', x+10, y+h-10);
          ctx.save();
          ctx.translate(x+10, y+22);
          ctx.rotate(-Math.PI/2);
          ctx.fillText('q_y = k_y a / π', 0, 0);
          ctx.restore();

          // tick labels at -1,0,1
          ctx.fillStyle = 'rgba(255,255,255,0.65)';
          ctx.font = '11px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace';
          const ticks = [-1,0,1];
          ticks.forEach(tv=>{
            const xx = x + (tv+2)/4 * w; // map [-2,2]?? We'll label only within panel; use tv in [-1,1] around center
          });
          ctx.restore();
        }

        function kToXY(qx,qy,x0,y0,w,h){
          // map q in [-1.6,1.6] roughly to panel
          const qmax = 1.6;
          const px = x0 + (qx + qmax)/(2*qmax) * w;
          const py = y0 + (qmax - qy)/(2*qmax) * h;
          return [px,py];
        }

        function drawBZ(x0,y0,w,h){
          // square for first BZ: q in [-1,1]
          const a = kToXY(-1,-1,x0,y0,w,h);
          const b = kToXY( 1,-1,x0,y0,w,h);
          const c = kToXY( 1, 1,x0,y0,w,h);
          const d = kToXY(-1, 1,x0,y0,w,h);
          ctx.save();
          ctx.strokeStyle = 'rgba(125,255,204,0.55)';
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.moveTo(a[0],a[1]); ctx.lineTo(b[0],b[1]); ctx.lineTo(c[0],c[1]); ctx.lineTo(d[0],d[1]); ctx.closePath();
          ctx.stroke();

          // label BZ edges
          ctx.fillStyle = 'rgba(125,255,204,0.85)';
          ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace';
          const topMid = kToXY(0,1,x0,y0,w,h);
          ctx.fillText('1st BZ (|q_x|,|q_y|≤1)', topMid[0]-88, topMid[1]-8);
          ctx.restore();
        }

        function drawFermiCircle(x0,y0,w,h){
          const qmax = 1.6;
          const scale = w/(2*qmax); // pixels per q in x
          const cx = x0 + w/2;
          const cy = y0 + h/2;

          ctx.save();
          ctx.strokeStyle = 'rgba(255,204,102,0.75)';
          ctx.setLineDash([6,6]);
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.arc(cx, cy, r*scale, 0, Math.PI*2);
          ctx.stroke();

          ctx.setLineDash([]);
          ctx.fillStyle = 'rgba(255,204,102,0.90)';
          ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace';
          ctx.fillText('free-e⁻ Fermi circle: r = 2/√π ≈ 1.128', x0+12, y0+h-12);
          ctx.restore();
        }

        function drawPocketsNearX(x0,y0,w,h){
          // schematic pockets centered near (±1,0) and (0,±1) in q-units
          const centers = [[1,0],[-1,0],[0,1],[0,-1]];
          ctx.save();
          // hole pockets (lower band): outline near X inside the BZ
          ctx.strokeStyle = 'rgba(118,168,255,0.75)';
          ctx.lineWidth = 2;
          centers.forEach(([qx,qy])=>{
            // small ellipse just inside the BZ
            const c = kToXY(qx*0.92, qy*0.92, x0,y0,w,h);
            const ex = 0.22, ey = 0.14;
            drawEllipse(c[0], c[1], ex, ey, x0,y0,w,h, 'stroke');
          });

          // electron pockets (upper band): schematic lens that would be "outside" BZ, but shown split
          ctx.strokeStyle = 'rgba(125,255,140,0.75)';
          ctx.lineWidth = 2;
          centers.forEach(([qx,qy])=>{
            const c = kToXY(qx*1.08, qy*1.08, x0,y0,w,h);
            const ex = 0.22, ey = 0.14;
            drawEllipse(c[0], c[1], ex, ey, x0,y0,w,h, 'stroke');
          });

          // labels
          ctx.fillStyle = 'rgba(118,168,255,0.92)';
          ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Arial';
          const lh = kToXY(-0.10, 0.55, x0,y0,w,h);
          ctx.fillText('holes (lower band) near X', lh[0]-60, lh[1]);

          ctx.fillStyle = 'rgba(125,255,140,0.92)';
          const le = kToXY(-0.10, -0.55, x0,y0,w,h);
          ctx.fillText('electrons (upper band) near X', le[0]-70, le[1]);

          ctx.restore();

          function drawEllipse(px,py,ex,ey,x0,y0,w,h,mode){
            // ex,ey given in q-units; convert to pixels with local scale
            const qmax = 1.6;
            const sx = w/(2*qmax);
            const sy = h/(2*qmax);
            ctx.beginPath();
            ctx.ellipse(px, py, ex*sx, ey*sy, 0, 0, Math.PI*2);
            if(mode==='stroke') ctx.stroke();
            else ctx.fill();
          }
        }

        function drawXCenteredPocket(x0,y0,w,h){
          // Consider zone centered at X = (1,0) in q-units: define new coordinates q' = q - (1,0)
          // Show a closed electron pocket around q'=(0,0) (schematic ellipse), and hole pocket around boundary (schematic)
          ctx.save();
          // axes & grid
          ctx.strokeStyle = 'rgba(255,255,255,0.08)';
          ctx.lineWidth = 1;
          const nx = 8, ny = 8;
          for(let i=0;i<=nx;i++){
            const xx = x0 + (w*i/nx);
            ctx.beginPath(); ctx.moveTo(xx,y0); ctx.lineTo(xx,y0+h); ctx.stroke();
          }
          for(let j=0;j<=ny;j++){
            const yy = y0 + (h*j/ny);
            ctx.beginPath(); ctx.moveTo(x0,yy); ctx.lineTo(x0+w,yy); ctx.stroke();
          }
          ctx.strokeStyle = 'rgba(125,255,204,0.20)';
          ctx.beginPath(); ctx.moveTo(x0+w/2,y0); ctx.lineTo(x0+w/2,y0+h); ctx.stroke();
          ctx.beginPath(); ctx.moveTo(x0,y0+h/2); ctx.lineTo(x0+w,y0+h/2); ctx.stroke();

          // electron pocket centered
          ctx.strokeStyle = 'rgba(125,255,140,0.85)';
          ctx.lineWidth = 2.5;
          const cx = x0 + w/2, cy = y0 + h/2;
          ctx.beginPath();
          ctx.ellipse(cx, cy, w*0.12, h*0.08, 0, 0, Math.PI*2);
          ctx.stroke();

          // hole pocket nearby (schematic)
          ctx.strokeStyle = 'rgba(118,168,255,0.85)';
          ctx.lineWidth = 2.5;
          ctx.beginPath();
          ctx.ellipse(cx + w*0.18, cy, w*0.11, h*0.07, 0, 0, Math.PI*2);
          ctx.stroke();

          // labels
          ctx.fillStyle = 'rgba(255,255,255,0.82)';
          ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace';
          ctx.fillText("X-centered zone (repeated-zone choice)", x0+12, y0+38);
          ctx.fillStyle = 'rgba(125,255,140,0.95)';
          ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Arial';
          ctx.fillText("closed electron pocket around X", x0+12, y0+h-34);
          ctx.fillStyle = 'rgba(118,168,255,0.95)';
          ctx.fillText("hole pocket in lower band (nearby)", x0+12, y0+h-16);

          ctx.restore();
        }

        // Panel 1: Reduced-zone view
        const x1 = pad, y1 = pad, w1 = panelW, h1 = panelH;
        panel(x1,y1,w1,h1,'Reduced-zone sketch (1st BZ + free circle)');
        drawAxes(x1+10,y1+34,w1-20,h1-46);
        const px1 = x1+10, py1 = y1+34, pw1 = w1-20, ph1 = h1-46;
        drawBZ(px1,py1,pw1,ph1);
        drawFermiCircle(px1,py1,pw1,ph1);
        drawPocketsNearX(px1,py1,pw1,ph1);

        // Panel 2: X-centered repeated-zone pocket closure
        const x2 = pad + panelW + gap, y2 = pad, w2 = panelW, h2 = panelH;
        panel(x2,y2,w2,h2,'Zone scheme chosen so electron surface is closed');
        const px2 = x2+10, py2 = y2+34, pw2 = w2-20, ph2 = h2-46;
        drawXCenteredPocket(px2,py2,pw2,ph2);

        // Small legend note
        ctx.save();
        ctx.fillStyle = 'rgba(255,255,255,0.65)';
        ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Arial';
        ctx.fillText('Note: pocket shapes are schematic; locations (near X) and closedness are the key.', pad+12, cssH-10);
        ctx.restore();
      }

      window.addEventListener('resize', draw, {passive:true});
      draw();
    })();
  </script>
</body>
</html>
