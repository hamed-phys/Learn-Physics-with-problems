<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Brillouin Zone & Fermi Circle for a 2D Rectangular Lattice (a=2Ã…, b=4Ã…)</title>
  <style>
    :root{
      --bg:#0b1020;
      --card:#111a33;
      --muted:#a9b5e6;
      --text:#eef1ff;
      --accent:#7cf0c7;
      --accent2:#8ab4ff;
      --warn:#ffd37a;
      --danger:#ff7aa2;
      --ink:#0b1020;
      --border: rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 15% 10%, rgba(122,240,199,.12), transparent 55%),
                  radial-gradient(900px 600px at 80% 15%, rgba(138,180,255,.12), transparent 55%),
                  linear-gradient(180deg, #070a14, var(--bg));
      color:var(--text);
      line-height:1.55;
    }
    header{
      padding: 28px 18px 10px;
      max-width: 1180px;
      margin: 0 auto;
    }
    .title{
      display:grid;
      gap:10px;
    }
    .title h1{
      margin:0;
      font-size: clamp(1.35rem, 2.4vw, 2.2rem);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      max-width: 78ch;
      font-size: 1.02rem;
    }

    main{
      max-width: 1180px;
      margin: 0 auto;
      padding: 12px 18px 80px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 16px;
      align-items:start;
    }
    @media (max-width: 980px){
      main{grid-template-columns: 1fr}
    }

    nav.toc{
      position: sticky;
      top: 12px;
      align-self:start;
      background: rgba(17,26,51,.75);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 10px;
      backdrop-filter: blur(8px);
    }
    nav.toc h2{
      font-size: .95rem;
      margin: 0 0 8px;
      color: var(--text);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .toc a{
      display:block;
      padding: 8px 10px;
      border-radius: 12px;
      text-decoration:none;
      color: var(--muted);
      font-size:.95rem;
      border: 1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .toc a:hover{
      background: rgba(124,240,199,.08);
      border-color: rgba(124,240,199,.25);
      color: var(--text);
      transform: translateY(-1px);
    }
    .toc .mini{
      margin-top: 10px;
      font-size: .88rem;
      color: rgba(238,241,255,.72);
    }
    .toc .toplink{
      margin-top: 8px;
      display:inline-block;
      color: var(--accent);
      text-decoration:none;
      font-weight:600;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(124,240,199,.25);
      background: rgba(124,240,199,.06);
      transition: transform .12s ease, background .12s ease;
    }
    .toc .toplink:hover{transform: translateY(-1px); background: rgba(124,240,199,.10);}

    article{
      background: rgba(17,26,51,.72);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      backdrop-filter: blur(8px);
    }

    section{padding: 6px 0 18px; border-bottom: 1px solid rgba(255,255,255,.08);}
    section:last-child{border-bottom:none; padding-bottom:0;}
    h2{
      margin: 18px 0 8px;
      font-size: 1.25rem;
      letter-spacing:.2px;
    }
    h3{
      margin: 14px 0 6px;
      font-size: 1.05rem;
      color: rgba(238,241,255,.92);
    }
    p{margin: 8px 0; color: rgba(238,241,255,.90);}
    ul{margin: 8px 0 8px 20px; color: rgba(238,241,255,.90);}
    li{margin: 6px 0;}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 860px){.grid2{grid-template-columns:1fr}}

    .card{
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      padding: 12px 12px 10px;
      background: rgba(11,16,32,.55);
    }
    .callout{
      border-left: 4px solid var(--accent2);
      background: rgba(138,180,255,.08);
      padding: 12px 12px 10px;
      border-radius: 14px;
      margin: 10px 0;
      border-top: 1px solid rgba(255,255,255,.08);
      border-right: 1px solid rgba(255,255,255,.08);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .callout.warn{border-left-color: var(--warn); background: rgba(255,211,122,.09);}
    .callout.danger{border-left-color: var(--danger); background: rgba(255,122,162,.09);}
    .callout strong{color: var(--text);}
    .kq{
      border-left: 4px solid var(--accent);
      background: rgba(124,240,199,.07);
      padding: 12px 12px 10px;
      border-radius: 14px;
      margin: 10px 0;
      border: 1px solid rgba(124,240,199,.18);
    }

    pre{
      margin: 10px 0;
      background: rgba(5,8,18,.75);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 12px;
      overflow:auto;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
    }
    code, pre{font-family: var(--mono); font-size: .93rem; color: rgba(238,241,255,.92);}
    .eqrow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .btn{
      appearance:none;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(238,241,255,.06);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 650;
      font-size: .88rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(238,241,255,.10);
      border-color: rgba(124,240,199,.35);
    }
    .btn:active{transform: translateY(0px) scale(.99);}
    .btn.small{padding: 6px 9px; font-size: .84rem; border-radius: 10px;}
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(124,240,199,.25);
      background: rgba(124,240,199,.06);
      color: rgba(238,241,255,.92);
      font-size: .88rem;
      font-weight: 650;
    }

    figure{
      margin: 12px 0 6px;
      padding: 12px;
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      background: rgba(11,16,32,.55);
    }
    figcaption{
      margin-top: 8px;
      color: rgba(238,241,255,.72);
      font-size: .92rem;
    }
    canvas{width:100%; height:auto; display:block; border-radius: 12px; border:1px solid rgba(255,255,255,.10); background: rgba(5,8,18,.55);}

    details{
      border: 1px dashed rgba(255,255,255,.18);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(238,241,255,.04);
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      font-weight: 750;
      color: rgba(238,241,255,.92);
    }
    .backtop{
      display:flex;
      justify-content:flex-end;
      margin-top: 10px;
    }
    .backtop a{
      color: var(--accent);
      text-decoration:none;
      font-weight: 700;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(124,240,199,.25);
      background: rgba(124,240,199,.06);
    }
    footer{
      max-width:1180px;
      margin: 0 auto;
      padding: 18px 18px 40px;
      color: rgba(238,241,255,.65);
      font-size:.92rem;
    }

    /* subtle micro-animation */
    @keyframes fadeUp{
      from{opacity:0; transform: translateY(6px);}
      to{opacity:1; transform: translateY(0);}
    }
    article{animation: fadeUp .35s ease both;}

    /* print friendly */
    @media print{
      body{background:#fff; color:#000;}
      nav.toc{display:none;}
      main{grid-template-columns: 1fr; padding:0;}
      article{box-shadow:none; border: none; background:#fff;}
      pre{background:#f4f6fb; color:#000; border:1px solid #ccc;}
      code{color:#000;}
      .btn{display:none;}
      figure{break-inside: avoid;}
      section{break-inside: avoid;}
      a{color:#000; text-decoration: underline;}
    }
  </style>
</head>
<body>
  <a id="top"></a>
  <header>
    <div class="title">
      <h1>Brillouin Zone, Fermi Circle, and Nearly-Free-Electron Bands for a 2D Rectangular Lattice</h1>
      <p class="subtitle">
        We analyze a 2D metal with one valence electron per primitive rectangular cell (a = 2 Ã…, b = 4 Ã…):
        (a) first Brillouin zone dimensions, (b) free-electron Fermi radius, (c) scale sketch of Fermi circle vs BZ,
        and (d) periodic-zone band sketch for the first two bands with a small zone-boundary gap.
      </p>
    </div>
  </header>

  <main>
    <nav class="toc" aria-label="Table of contents">
      <h2>ğŸ“Œ Contents</h2>
      <a href="#quick">Quick Summary</a>
      <a href="#part0">PART 0 â€” Concept Primer</a>
      <a href="#part0b">PART 0B â€” Industry & Applied Physics Perspective</a>
      <a href="#part1">PART 1 â€” Problem Analysis</a>
      <a href="#part2">PART 2 â€” Strategy & Tips</a>
      <a href="#part3">PART 3 â€” Full Solution</a>
      <a href="#part4">PART 4 â€” Deeper Understanding</a>
      <a href="#part5">PART 5 â€” Optional Plot Guide</a>
      <div class="mini">
        <div class="pill" title="Units used heavily in this problem">k in cmâ»Â¹, a,b in cm</div>
        <div style="height:8px"></div>
        <a class="toplink" href="#top">Back to top â†‘</a>
      </div>
    </nav>

    <article>
      <section id="quick">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What itâ€™s about:</strong> Reciprocal space geometry (first Brillouin zone) and electron filling for a 2D rectangular lattice.</li>
          <li><strong>Key physics idea:</strong> Bloch periodicity folds free-electron parabolas into energy bands; zone boundaries open small gaps (nearly-free-electron model).</li>
          <li><strong>Governing equation(s):</strong> Free electron SchrÃ¶dinger eigenproblem
            <span class="pill" style="margin-left:8px;">âˆ’(Ä§Â²/2m)âˆ‡Â²Ïˆ = EÏˆ</span>
            and 2D densityâ€“Fermi-radius relation <span class="pill">n = k<sub>F</sub>Â²/(2Ï€)</span> (spin included).</li>
          <li><strong>First BZ (rectangle):</strong> boundaries at k<sub>x</sub> = Â±Ï€/a and k<sub>y</sub> = Â±Ï€/b.</li>
          <li><strong>Numeric BZ half-widths:</strong> Ï€/a = 1.571Ã—10<sup>8</sup> cmâ»Â¹, Ï€/b = 7.854Ã—10<sup>7</sup> cmâ»Â¹.</li>
          <li><strong>Fermi radius (free electron, 1 eâ» per cell):</strong> k<sub>F</sub> = âˆš(2Ï€/(ab)) = 8.86Ã—10<sup>7</sup> cmâ»Â¹.</li>
          <li><strong>Physical meaning:</strong> The Fermi circle crosses the zone boundary in the Â±k<sub>y</sub> direction (since k<sub>F</sub> &gt; Ï€/b), so band folding and a small gap appear near those boundaries.</li>
          <li><strong>Result type:</strong> Mostly analytic with a few clean numeric values; interpreted as Fermi-surface topology vs zone geometry.</li>
        </ul>
        <div class="backtop"><a href="#top">Back to top â†‘</a></div>
      </section>

      <section id="part0">
        <h2>PART 0 â€” Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="card">
            <h3>Core definitions (symbols & units)</h3>
            <ul>
              <li><strong>a, b</strong>: real-space primitive lattice constants (length). Here: a = 2 Ã…, b = 4 Ã…. (1 Ã… = 10<sup>âˆ’8</sup> cm.)</li>
              <li><strong>r = (x,y)</strong>: 2D real-space coordinate (cm or m).</li>
              <li><strong>k = (k<sub>x</sub>, k<sub>y</sub>)</strong>: crystal wavevector in reciprocal space (cmâ»Â¹ or mâ»Â¹).</li>
              <li><strong>G</strong>: reciprocal lattice vector (cmâ»Â¹).</li>
              <li><strong>E(k)</strong>: electron energy dispersion (J or eV).</li>
              <li><strong>n</strong>: 2D electron number density (cmâ»Â²).</li>
              <li><strong>k<sub>F</sub></strong>: Fermi wavevector (radius of 2D Fermi circle for free electrons) (cmâ»Â¹).</li>
            </ul>
          </div>

          <div class="card">
            <h3>Physical meaning (intuition)</h3>
            <ul>
              <li><strong>Brillouin zone:</strong> the â€œfundamental tileâ€ of reciprocal space for Bloch states; determines where Bragg reflection occurs.</li>
              <li><strong>Fermi circle:</strong> boundary between occupied and unoccupied k-states at Tâ‰ˆ0 for a free 2D electron gas.</li>
              <li><strong>Band gaps at zone boundaries:</strong> arise when plane waves with k and kâˆ’G become degenerate; the periodic potential couples them and splits energies.</li>
            </ul>
          </div>
        </div>

        <h3>Key laws/principles & validity</h3>
        <div class="callout">
          <strong>Bloch theorem (periodic potentials):</strong> For a periodic lattice potential V(r+R)=V(r),
          eigenstates can be written Ïˆ<sub>k</sub>(r)=u<sub>k</sub>(r)e<sup>i kÂ·r</sup>, where u<sub>k</sub>(r) has the lattice periodicity.
          The wavevector k is defined modulo reciprocal lattice vectors G.
        </div>

        <div class="kq">
          <div class="eqrow">
            <div>
              <strong>Free-electron eigenproblem (mathematical model core):</strong>
              <pre><code id="eq_free">
-(Ä§^2/2m) âˆ‡^2 Ïˆ(r) = E Ïˆ(r)   in 2D (x,y) âˆˆ â„^2
Ïˆ_k(r) = (1/âˆšA) exp(i kÂ·r)  â‡’  E(k) = Ä§^2 |k|^2 / (2m)
</code></pre>
            </div>
            <button class="btn small" data-copy="#eq_free">Copy equation</button>
          </div>
          <p style="margin-top:6px;">
            <strong>Validity:</strong> This is the leading-order model when the periodic potential is weak (nearly-free-electron),
            electron-electron interactions are neglected (or absorbed into an effective mass), and T is low compared to E<sub>F</sub>.
          </p>
        </div>

        <h3>Common models/approximations used here</h3>
        <ul>
          <li><strong>Nearly-free electron (NFE):</strong> treat V(r) as a small periodic perturbation; band gaps open at zone boundaries where degeneracies occur.</li>
          <li><strong>Tâ‰ˆ0 filling:</strong> states fill up to E<sub>F</sub>; in 2D the occupied region is a disk in k-space for isotropic free electrons.</li>
          <li><strong>Spin degeneracy:</strong> each k-state holds 2 electrons (spin up/down), unless spin splitting is considered (not here).</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li>If the real-space lattice spacing decreases, reciprocal spacing increases (zone gets bigger): k-boundaries scale like 1/a and 1/b.</li>
          <li>In 2D, doubling electron density n increases k<sub>F</sub> by âˆš2 (since k<sub>F</sub> âˆ âˆšn).</li>
          <li>If k<sub>F</sub> exceeds a zone boundary in some direction, the â€œfreeâ€ Fermi contour must fold into higher bands in the reduced-zone picture.</li>
        </ul>

        <div class="callout warn">
          <strong>What to watch for (pitfalls):</strong>
          <ul>
            <li><strong>2D vs 3D formulas:</strong> In 2D, n = k<sub>F</sub>Â²/(2Ï€) (with spin). In 3D itâ€™s n = k<sub>F</sub>Â³/(3Ï€Â²).</li>
            <li><strong>Zone boundaries:</strong> First BZ edges are at Â±Ï€/a (not Â±2Ï€/a). The reciprocal lattice vector is 2Ï€/a, but the zone edge is half of that.</li>
            <li><strong>Units:</strong> Ã… â†’ cm carefully: 1 Ã… = 10â»â¸ cm; k in cmâ»Â¹ can be huge (~10â¸ cmâ»Â¹).</li>
          </ul>
        </div>

        <div class="callout">
          <strong>Math Insight:</strong>
          The free-electron dispersion comes from the <em>Laplacian eigenvalue problem</em>:
          plane waves are eigenfunctions of the operator âˆ‡Â² on â„Â² (or on a periodic domain with Bloch boundary conditions),
          giving an eigenvalue proportional to |k|Â². In band theory, the periodic potential turns this into a coupled-mode/eigenvalue
          problem in Fourier (reciprocal) space, where degeneracies at the BZ boundary are split (a classic perturbation/eigenvalue-splitting phenomenon).
        </div>

        <div class="backtop"><a href="#top">Back to top â†‘</a></div>
      </section>

      <section id="part0b">
        <h2>PART 0B â€” Industry & Applied Physics Perspective</h2>
        <p>
          Reciprocal-space thinking is not â€œjust theoryâ€ â€” it directly shapes how engineers predict conductivity, optical response,
          and manufacturability limits in 2D and thin-film technologies.
        </p>

        <div class="grid2">
          <div class="card">
            <h3>Where it appears in industry (concrete areas)</h3>
            <ul>
              <li><strong>Semiconductor & 2D materials:</strong> graphene-like layers, TMDCs, oxide interfaces â€” band folding and zone-boundary gaps affect mobility and device thresholds.</li>
              <li><strong>Thin-film metallurgy:</strong> grain-textured metal films in interconnects; Fermi-surface geometry influences resistivity, electromigration, and size effects.</li>
              <li><strong>Photonics/optics:</strong> plasmonic and photonic crystals rely on Bragg conditions (reciprocal lattice) to open band gaps for electrons or photons.</li>
            </ul>
          </div>
          <div class="card">
            <h3>Why engineers care</h3>
            <ul>
              <li><strong>Performance:</strong> effective mass and band curvature set carrier mobility and speed.</li>
              <li><strong>Reliability:</strong> scattering near zone boundaries and anisotropic Fermi contours can raise resistive heating and failure risk.</li>
              <li><strong>Cost/efficiency:</strong> design choices (lattice strain, alloying, pattern pitch) tune gaps and transport â€” often cheaper than changing the whole material stack.</li>
            </ul>
          </div>
        </div>

        <h3>Measurement / validation in practice</h3>
        <ul>
          <li><strong>ARPES (angle-resolved photoemission):</strong> maps E(k) and Fermi surface directly (gold standard for band structures).</li>
          <li><strong>Quantum oscillations (SdH/dHvA):</strong> infer Fermi surface areas from oscillation frequencies.</li>
          <li><strong>Transport anisotropy:</strong> directional resistivity and Hall measurements reflect band/FS anisotropy and scattering.</li>
        </ul>

        <h3>Design trade-offs & constraints (real materials)</h3>
        <ul>
          <li><strong>Non-ideal periodicity:</strong> disorder and finite grain size smear k-space sharpness, reducing clean band gaps.</li>
          <li><strong>Strain/tolerances:</strong> small changes in a or b (thermal expansion, process variation) shift zone boundaries (âˆ1/a, 1/b) and can move the Fermi level relative to a gap.</li>
          <li><strong>Interactions:</strong> electron-phonon and electron-electron effects renormalize masses and lifetimes; â€œfree electronâ€ becomes â€œquasi-freeâ€ in products.</li>
        </ul>

        <details>
          <summary>From lab to product: how the idealized model gets adapted</summary>
          <p>
            In real devices, engineers often replace m by an <strong>effective mass m*</strong> (capturing band curvature), include
            <strong>scattering times</strong> (Ï„) in transport models (Drude/Boltzmann), and model disorder via
            <strong>broadened bands</strong> or mean free paths. Still, the same reciprocal-space geometry (BZ edges, G vectors)
            sets the â€œwhereâ€ of band folding and gap opening â€” the ideal picture remains the roadmap.
          </p>
        </details>

        <div class="backtop"><a href="#top">Back to top â†‘</a></div>
      </section>

      <section id="part1">
        <h2>PART 1 â€” Problem Analysis (No Solving Yet)</h2>

        <h3>Problem restatement (clear wording)</h3>
        <p>
          A 2D metal forms a simple rectangular Bravais lattice with primitive cell sides a = 2 Ã… and b = 4 Ã….
          There is one atom per primitive cell and the atom has valency one, so there is one conduction electron per cell.
          We must:
          (a) draw/describe the first Brillouin zone (BZ) and give its dimensions in cmâ»Â¹;
          (b) compute the radius k<sub>F</sub> of the free-electron Fermi circle in cmâ»Â¹;
          (c) draw the Fermi circle to scale on the BZ drawing;
          (d) sketch the first few repeated free-electron bands in the periodic-zone scheme for the first and second bands, assuming a small gap at the zone boundary.
        </p>

        <div class="grid2">
          <div class="card">
            <h3>Given</h3>
            <ul>
              <li>a = 2 Ã…, b = 4 Ã…</li>
              <li>2D rectangular primitive cell, 1 atom/cell</li>
              <li>valency = 1 â‡’ 1 electron per cell</li>
              <li>Free-electron (nearly-free) picture; small gap at BZ boundary</li>
            </ul>
          </div>
          <div class="card">
            <h3>Unknowns / tasks</h3>
            <ul>
              <li>(a) BZ boundaries and numeric dimensions (cmâ»Â¹)</li>
              <li>(b) k<sub>F</sub> (cmâ»Â¹)</li>
              <li>(c) scaled BZ + Fermi circle overlay</li>
              <li>(d) qualitative periodic-zone band sketch for bands 1 & 2 with small gaps at boundaries</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>Reciprocal lattice construction:</strong> rectangular real lattice â‡’ rectangular reciprocal lattice with magnitudes 2Ï€/a and 2Ï€/b.</li>
          <li><strong>First BZ definition:</strong> Wignerâ€“Seitz cell in reciprocal space â‡’ edges halfway to nearest reciprocal lattice points â‡’ Â±Ï€/a, Â±Ï€/b.</li>
          <li><strong>2D Fermi filling:</strong> At T=0, fill k-states up to k<sub>F</sub>; count states using k-space area per state and spin degeneracy.</li>
          <li><strong>Nearly-free-electron band gaps:</strong> at zone boundaries where k and kâˆ’G plane waves are degenerate, weak periodic potential couples them and opens a small gap.</li>
        </ul>

        <div class="callout">
          <strong>Assumptions (explicit):</strong>
          <ul>
            <li>Electrons form a 2D free (or nearly-free) gas: isotropic E = Ä§Â²|k|Â²/(2m) away from boundaries.</li>
            <li>Spin degeneracy = 2 and no spin splitting.</li>
            <li>T â‰ˆ 0 for the Fermi surface counting.</li>
            <li>Single band filling from one electron per primitive cell; small periodic-potential gap at the BZ boundary (NFE model).</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <ul>
          <li><strong>Geometric reciprocal-lattice + k-state counting (best here):</strong> Fast, transparent, minimal machinery; ideal for (a)â€“(c).</li>
          <li><strong>Bloch/plane-wave expansion:</strong> More formal eigenvalue approach for (d); shows how gaps arise via coupled Fourier components.</li>
          <li><strong>Tight-binding:</strong> Not ideal here because the problem explicitly points to free-electron / nearly-free-electron periodic-zone sketches.</li>
        </ul>

        <p>
          <strong>Chosen approach:</strong> Use reciprocal-lattice geometry and 2D k-state counting for (a)â€“(c), then use the nearly-free-electron degeneracy-splitting picture for (d).
          This matches the problemâ€™s intent and yields clean analytic results.
        </p>

        <div class="backtop"><a href="#top">Back to top â†‘</a></div>
      </section>

      <section id="part2">
        <h2>PART 2 â€” Strategy & Tips (Roadmap Only)</h2>

        <ol>
          <li><strong>Convert units:</strong> Ã… â†’ cm so k results come out in cmâ»Â¹.</li>
          <li><strong>Build reciprocal lattice:</strong> b<sub>1</sub> = (2Ï€/a) xÌ‚, b<sub>2</sub> = (2Ï€/b) Å·; identify nearest reciprocal points.</li>
          <li><strong>First BZ edges:</strong> Wignerâ€“Seitz gives boundaries at k<sub>x</sub>=Â±Ï€/a and k<sub>y</sub>=Â±Ï€/b; compute numeric sizes.</li>
          <li><strong>2D electron density:</strong> n = (electrons per cell)/(cell area) = 1/(ab).</li>
          <li><strong>Count k-states:</strong> Use area of occupied disk Ï€k<sub>F</sub>Â² and density of states in k-space to get n = k<sub>F</sub>Â²/(2Ï€).</li>
          <li><strong>Compute k<sub>F</sub>:</strong> k<sub>F</sub>=âˆš(2Ï€/(ab)) numerically and compare to Ï€/a and Ï€/b.</li>
          <li><strong>Scaled sketch:</strong> Draw BZ rectangle and Fermi circle; note if it crosses boundaries (it will in Â±k<sub>y</sub>).</li>
          <li><strong>Periodic-zone bands:</strong> Start from free-electron parabolas repeated by kâ†’k+G; then introduce small avoided crossings (gaps) at zone boundaries.</li>
        </ol>

        <div class="callout danger">
          <strong>Common mistakes</strong>
          <ul>
            <li>Using 3D Fermi formula instead of 2D: k<sub>F</sub> âˆ n<sup>1/2</sup>, not n<sup>1/3</sup>.</li>
            <li>Putting BZ edges at Â±2Ï€/a instead of Â±Ï€/a.</li>
            <li>Forgetting the spin factor 2 in state counting.</li>
            <li>Mixing Ã…â»Â¹ and cmâ»Â¹ without conversion (1 Ã…â»Â¹ = 10â¸ cmâ»Â¹).</li>
          </ul>
        </div>

        <div class="backtop"><a href="#top">Back to top â†‘</a></div>
      </section>

      <section id="part3">
        <h2>PART 3 â€” Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation (before calculating)</h3>
        <p>
          Because b is twice a (b = 4 Ã…, a = 2 Ã…), the reciprocal spacing in y is <em>smaller</em> than in x:
          Ï€/b will be half of Ï€/a. So the BZ is a rectangle that is narrower in y (in k-space).
          With one electron per cell, we expect a moderate k<sub>F</sub>; it may cross the smaller boundary Ï€/b first â€” meaning the Fermi circle likely intersects the top/bottom BZ edges before it reaches the left/right edges.
        </p>

        <h3>(a) First Brillouin zone for a rectangular lattice</h3>
        <p>
          Choose coordinates so the real-space primitive vectors are:
        </p>
        <div class="kq">
          <div class="eqrow">
            <div>
              <pre><code id="eq_real">
a1 = a xÌ‚
a2 = b Å·
</code></pre>
            </div>
            <button class="btn small" data-copy="#eq_real">Copy</button>
          </div>
        </div>

        <p>
          The reciprocal lattice vectors satisfy a<sub>i</sub>Â·b<sub>j</sub> = 2Ï€ Î´<sub>ij</sub>. For orthogonal axes this gives:
        </p>
        <div class="kq">
          <div class="eqrow">
            <div>
              <pre><code id="eq_recip">
b1 = (2Ï€/a) xÌ‚
b2 = (2Ï€/b) Å·
Reciprocal lattice points: G = h b1 + k b2,  h,k âˆˆ â„¤
</code></pre>
            </div>
            <button class="btn small" data-copy="#eq_recip">Copy</button>
          </div>
        </div>

        <p>
          The <strong>first Brillouin zone</strong> is the Wignerâ€“Seitz cell of the reciprocal lattice: all k closer to G=0 than to any other reciprocal point.
          The nearest reciprocal lattice points are at Â±b<sub>1</sub> and Â±b<sub>2</sub>, so the perpendicular bisectors are:
        </p>
        <div class="kq">
          <div class="eqrow">
            <div>
              <pre><code id="eq_bz">
BZ edges: kx = Â±|b1|/2 = Â±Ï€/a
          ky = Â±|b2|/2 = Â±Ï€/b
So the first BZ is a rectangle:  kx âˆˆ [âˆ’Ï€/a, +Ï€/a],  ky âˆˆ [âˆ’Ï€/b, +Ï€/b]
</code></pre>
            </div>
            <button class="btn small" data-copy="#eq_bz">Copy</button>
          </div>
        </div>

        <p><strong>Convert a,b to cm</strong> (requested units cmâ»Â¹):</p>
        <ul>
          <li>1 Ã… = 10<sup>âˆ’8</sup> cm</li>
          <li>a = 2 Ã… = 2Ã—10<sup>âˆ’8</sup> cm</li>
          <li>b = 4 Ã… = 4Ã—10<sup>âˆ’8</sup> cm</li>
        </ul>

        <p><strong>Compute numerical BZ half-widths and full widths:</strong></p>
        <div class="kq">
          <pre><code id="eq_nums_a">
Ï€/a = Ï€ / (2Ã—10^âˆ’8 cm) = (Ï€/2)Ã—10^8 cm^âˆ’1 = 1.571Ã—10^8 cm^âˆ’1
Ï€/b = Ï€ / (4Ã—10^âˆ’8 cm) = (Ï€/4)Ã—10^8 cm^âˆ’1 = 7.854Ã—10^7 cm^âˆ’1

Full BZ widths:
Î”kx = 2Ï€/a = 3.142Ã—10^8 cm^âˆ’1
Î”ky = 2Ï€/b = 1.571Ã—10^8 cm^âˆ’1
</code></pre>
          <button class="btn small" data-copy="#eq_nums_a">Copy numbers</button>
        </div>

        <h3>(b) Free-electron Fermi radius k<sub>F</sub> in 2D</h3>
        <p>
          With one valence electron per primitive cell, the <strong>2D electron density</strong> is:
        </p>
        <div class="kq">
          <div class="eqrow">
            <div>
              <pre><code id="eq_density">
Cell area (2D): A_cell = a b
Electrons per cell: 1
So 2D density: n = 1/(ab)
</code></pre>
            </div>
            <button class="btn small" data-copy="#eq_density">Copy</button>
          </div>
        </div>

        <p>
          Now count states in k-space at Tâ‰ˆ0. On a large 2D sample of area A, periodic boundary conditions quantize k,
          and the density of k-states is one state per area (2Ï€)Â²/A in k-space per spin. Including spin degeneracy 2:
        </p>

        <details>
          <summary>State-counting derivation (no magic jumps)</summary>
          <p>
            Allowed k points form a grid with spacing Î”k<sub>x</sub>=2Ï€/L<sub>x</sub>, Î”k<sub>y</sub>=2Ï€/L<sub>y</sub>.
            One k-point occupies area (2Ï€/L<sub>x</sub>)(2Ï€/L<sub>y</sub>)=(2Ï€)Â²/A in k-space.
          </p>
          <p>
            Number of occupied k-states (per spin) inside a disk of radius k<sub>F</sub> is:
            N<sub>per spin</sub> = (Area of disk)/(Area per k-point) = (Ï€k<sub>F</sub>Â²)/((2Ï€)Â²/A) = A k<sub>F</sub>Â²/(4Ï€).
          </p>
          <p>
            Including 2 spins: N = 2Â·A k<sub>F</sub>Â²/(4Ï€) = A k<sub>F</sub>Â²/(2Ï€).
            Divide by A: n = N/A = k<sub>F</sub>Â²/(2Ï€).
          </p>
        </details>

        <div class="kq">
          <div class="eqrow">
            <div>
              <pre><code id="eq_kf">
2D filling (with spin 2):
n = kF^2 / (2Ï€)
â‡’ kF = âˆš(2Ï€ n) = âˆš( 2Ï€ / (ab) )
</code></pre>
            </div>
            <button class="btn small" data-copy="#eq_kf">Copy equation</button>
          </div>
        </div>

        <p><strong>Compute n and k<sub>F</sub> numerically (in cm-based units):</strong></p>
        <ul>
          <li>ab = (2Ã—10<sup>âˆ’8</sup> cm)(4Ã—10<sup>âˆ’8</sup> cm) = 8Ã—10<sup>âˆ’16</sup> cmÂ²</li>
          <li>n = 1/(ab) = 1/(8Ã—10<sup>âˆ’16</sup>) = 1.25Ã—10<sup>15</sup> cmâ»Â²</li>
        </ul>

        <div class="kq">
          <pre><code id="eq_nums_b">
kF = âˆš(2Ï€ n) = âˆš( 2Ï€ Ã— 1.25Ã—10^15 cm^âˆ’2 )
   = âˆš( 7.85398Ã—10^15 ) cm^âˆ’1
   = 8.86Ã—10^7 cm^âˆ’1
</code></pre>
          <button class="btn small" data-copy="#eq_nums_b">Copy numbers</button>
        </div>

        <p>
          <strong>Compare to zone edges:</strong>
          Ï€/b = 7.854Ã—10<sup>7</sup> cmâ»Â¹ and Ï€/a = 1.571Ã—10<sup>8</sup> cmâ»Â¹.
          Since k<sub>F</sub> = 8.86Ã—10<sup>7</sup> cmâ»Â¹:
        </p>
        <ul>
          <li>k<sub>F</sub> &gt; Ï€/b â‡’ Fermi circle crosses the BZ boundary in Â±k<sub>y</sub>.</li>
          <li>k<sub>F</sub> &lt; Ï€/a â‡’ Fermi circle stays inside the BZ in Â±k<sub>x</sub>.</li>
        </ul>

        <h3>(c) Draw to scale: Fermi circle on the first BZ</h3>
        <figure>
          <canvas id="bzCanvas" width="900" height="560" aria-label="Brillouin zone and Fermi circle plot"></canvas>
          <figcaption>
            Static scale sketch: first Brillouin zone (rectangle) with edges at kx=Â±Ï€/a and ky=Â±Ï€/b, and free-electron Fermi circle radius kF.
            Units shown in 10<sup>8</sup> cmâ»Â¹ for readability. (Here kF slightly exceeds Ï€/b, so it intersects the top/bottom edges.)
          </figcaption>
        </figure>

        <h3>(d) Periodic-zone scheme: first & second free-electron bands with a small zone-boundary gap</h3>
        <p>
          The <strong>free-electron dispersion</strong> is
          E(k) = Ä§Â²|k|Â²/(2m). In a crystal, k is equivalent to k+G (G a reciprocal lattice vector), so the same paraboloid repeats
          around each reciprocal lattice point.
        </p>

        <div class="kq">
          <div class="eqrow">
            <div>
              <pre><code id="eq_periodic">
Extended-zone (free):   E_free(k) = Ä§^2 |k|^2 /(2m)

Periodic repetition:    E_free(k) and E_free(k+G) represent plane waves differing by G
Zone boundaries:        Bragg planes where k and kâˆ’G become degenerate (e.g., k = G/2 along that direction)
Nearly-free electron:   small periodic potential couples them â‡’ avoided crossing (gap)
</code></pre>
            </div>
            <button class="btn small" data-copy="#eq_periodic">Copy</button>
          </div>
        </div>

        <p>
          <strong>Mathematical physics statement (gap opening):</strong>
          Write the Hamiltonian H = âˆ’(Ä§Â²/2m)âˆ‡Â² + V(r), with V(r) periodic.
          Expanding u<sub>k</sub>(r) in plane waves gives a Fourier-space eigenvalue problem that couples coefficients at k and kâˆ’G with strength V<sub>G</sub>.
          At a zone boundary where E<sub>free</sub>(k) = E<sub>free</sub>(kâˆ’G), a 2Ã—2 degenerate-perturbation problem yields a splitting:
        </p>

        <div class="kq">
          <div class="eqrow">
            <div>
              <pre><code id="eq_gap">
At a Bragg plane (degeneracy between |kâŸ© and |kâˆ’GâŸ©):
EÂ± â‰ˆ E0 Â± |V_G|
So the band gap at that boundary is:  Î” â‰ˆ 2|V_G|   (small, by assumption)
</code></pre>
            </div>
            <button class="btn small" data-copy="#eq_gap">Copy</button>
          </div>
        </div>

        <p>
          <strong>Sketch description (what to draw):</strong> In the periodic-zone scheme you show each Brillouin zone as a repeated rectangle in k-space.
          The <em>first band</em> is the lowest-energy branch after folding into each zone; the <em>second band</em> is the next branch.
          At each zone boundary line (kx = Â±Ï€/a, ky = Â±Ï€/b, and their repeats), the free parabolas would cross, but the small gap turns each crossing into an avoided crossing.
        </p>

        <details>
          <summary>Concrete 1D-style cross-section (helpful for the sketch)</summary>
          <p>
            If you take a cut along k<sub>y</sub> with k<sub>x</sub>=0, the zone boundaries occur at k<sub>y</sub>=Â±Ï€/b, Â±3Ï€/b, ...
            The free-electron energy E=Ä§Â²k<sub>y</sub>Â²/(2m) repeats when you fold by G<sub>y</sub>=2Ï€/b.
            In the periodic-zone picture, you draw parabolas in each repeated zone and show a small gap at each boundary where neighboring parabolas would meet.
            The lowest branch is band 1, the next is band 2.
          </p>
        </details>

        <div class="callout warn">
          <strong>Important physical takeaway:</strong>
          Because k<sub>F</sub> crosses ky = Â±Ï€/b, the Fermi level lies near a zone boundary in the y-direction.
          Even a small gap there can noticeably influence transport anisotropy (effective mass, scattering) compared with the x-direction where k<sub>F</sub> stays inside the zone.
        </div>

        <h3>Sanity checks</h3>
        <ul>
          <li><strong>Dimensions:</strong> Ï€/a has units 1/length â‡’ cmâ»Â¹. k<sub>F</sub> = âˆš(2Ï€/(ab)) also â‡’ âˆš(1/cmÂ²)=cmâ»Â¹.</li>
          <li><strong>Limiting case:</strong> If you doubled both a and b, ab increases by 4 â‡’ k<sub>F</sub> decreases by 1/2; BZ edges Ï€/a and Ï€/b also halve. Geometry scales consistently.</li>
          <li><strong>Physical interpretation:</strong> Fermi circle intersects the smaller BZ half-height first (Ï€/b), exactly as expected because b is larger than a.</li>
        </ul>

        <div class="callout">
          <strong>FINAL ANSWER (boxed)</strong>
          <div class="eqrow">
            <div>
              <pre><code id="final_answer">
Given: a = 2 Ã… = 2Ã—10^âˆ’8 cm,  b = 4 Ã… = 4Ã—10^âˆ’8 cm, 1 electron per cell.

(a) First Brillouin zone (rectangle):
    kx âˆˆ [âˆ’Ï€/a, +Ï€/a],  ky âˆˆ [âˆ’Ï€/b, +Ï€/b]
    Ï€/a = 1.571Ã—10^8 cm^âˆ’1   (full width 2Ï€/a = 3.142Ã—10^8 cm^âˆ’1)
    Ï€/b = 7.854Ã—10^7 cm^âˆ’1   (full width 2Ï€/b = 1.571Ã—10^8 cm^âˆ’1)

(b) Free-electron Fermi radius in 2D (spin included):
    n = 1/(ab) = 1.25Ã—10^15 cm^âˆ’2
    n = kF^2/(2Ï€)  â‡’  kF = âˆš(2Ï€/(ab)) = 8.86Ã—10^7 cm^âˆ’1

(c) To-scale relation:
    kF > Ï€/b (crosses top/bottom BZ edges), but kF < Ï€/a (does not reach left/right edges).

(d) Periodic-zone scheme:
    Start from E_free(k)=Ä§^2|k|^2/(2m) repeated by kâ†’k+G, with BZ boundaries at kx=Â±Ï€/a, ky=Â±Ï€/b and repeats.
    Introduce small avoided crossings (gaps) at each zone boundary; near a boundary the split is Î” â‰ˆ 2|V_G|.
    The lowest folded branch is band 1; the next is band 2.
</code></pre>
            </div>
            <button class="btn" data-copy="#final_answer">Copy final answer</button>
          </div>
        </div>

        <div class="backtop"><a href="#top">Back to top â†‘</a></div>
      </section>

      <section id="part4">
        <h2>PART 4 â€” Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpret the formulas (what controls what)</h3>
        <ul>
          <li><strong>BZ size:</strong> set purely by lattice constants: edges scale as 1/a and 1/b. Smaller real-space spacing â‡’ larger reciprocal-space zone.</li>
          <li><strong>k<sub>F</sub>:</strong> set by density: k<sub>F</sub> = âˆš(2Ï€n). In this problem, n is fixed by â€œone electron per cellâ€ â‡’ n=1/(ab).</li>
          <li><strong>Crossing a boundary:</strong> comparing k<sub>F</sub> with Ï€/a and Ï€/b tells you where folding/gaps matter most.</li>
        </ul>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li>Increase <strong>a</strong> (holding b fixed): BZ half-width Ï€/a decreases; density n=1/(ab) decreases; k<sub>F</sub> decreases too. Both effects tend to keep the ratio k<sub>F</sub>/(Ï€/a) from changing wildly, but not identically.</li>
          <li>Increase <strong>b</strong>: Ï€/b decreases faster (since itâ€™s directly 1/b), and k<sub>F</sub> decreases only as 1/âˆšb. So increasing b makes it <em>more likely</em> that k<sub>F</sub> exceeds Ï€/b (zone-boundary effects in y become more important).</li>
          <li>Increase <strong>valency z</strong> (electrons per cell): n=z/(ab) â‡’ k<sub>F</sub> âˆ âˆšz, making boundary crossings more likely.</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Instead of counting k-states geometrically, you can derive the same relation using the 2D density of states in energy,
          integrate up to E<sub>F</sub>, then convert E<sub>F</sub> to k<sub>F</sub> using E = Ä§Â²kÂ²/(2m). This is equivalent because the 2D DOS is constant
          and the k-space disk area grows as kÂ².
        </p>

        <h3>Concept check (self-test with answers)</h3>
        <ul>
          <li><strong>Q:</strong> Why are the first BZ edges at Â±Ï€/a, not Â±2Ï€/a? <br><strong>A:</strong> The zone boundary is the perpendicular bisector to the nearest reciprocal point at Â±(2Ï€/a); half of that distance is Ï€/a.</li>
          <li><strong>Q:</strong> In 2D, why does k<sub>F</sub> scale as âˆšn? <br><strong>A:</strong> Because the number of occupied states is proportional to the k-space area Ï€k<sub>F</sub>Â².</li>
          <li><strong>Q:</strong> What physically creates the â€œgapâ€ at the zone boundary? <br><strong>A:</strong> Bragg reflection: a periodic potential couples degenerate plane waves (k and kâˆ’G), splitting the eigenvalues (avoided crossing).</li>
          <li><strong>Q:</strong> Here the Fermi circle crosses ky=Â±Ï€/b. What does that imply about bands? <br><strong>A:</strong> Some states at E<sub>F</sub> lie near a zone boundary and are strongly affected by folding and the small gap, contributing to band-2 character in the reduced-zone view.</li>
        </ul>

        <div class="backtop"><a href="#top">Back to top â†‘</a></div>
      </section>

      <section id="part5">
        <h2>PART 5 â€” Optional Plot Guide</h2>
        <p>
          A plot is useful here because the key learning outcome is <strong>geometric</strong>: whether the Fermi circle fits inside the first BZ or intersects its boundaries.
          The single canvas figure shows exactly that relationship to scale.
        </p>
        <ul>
          <li><strong>x-axis:</strong> k<sub>x</sub> in units of 10<sup>8</sup> cmâ»Â¹.</li>
          <li><strong>y-axis:</strong> k<sub>y</sub> in units of 10<sup>8</sup> cmâ»Â¹.</li>
          <li><strong>Rectangle:</strong> first BZ with edges at Â±Ï€/a and Â±Ï€/b.</li>
          <li><strong>Circle:</strong> free-electron Fermi contour radius k<sub>F</sub>.</li>
          <li><strong>Feature to notice:</strong> circle crosses the top/bottom edges (Â±Ï€/b) but not the left/right edges (Â±Ï€/a).</li>
        </ul>
        <div class="backtop"><a href="#top">Back to top â†‘</a></div>
      </section>
    </article>
  </main>

  <footer>
    <p>
      Notes: This solution uses the standard 2D free-electron state counting with spin degeneracy and the geometric definition of the first Brillouin zone.
      The band-gap discussion follows the nearly-free-electron (weak periodic potential) picture where degeneracies at zone boundaries split by Î”â‰ˆ2|V<sub>G</sub>|.
    </p>
  </footer>

  <script>
    // Copy buttons
    (function(){
      function copyTextFromSelector(sel){
        const el = document.querySelector(sel);
        if(!el) return;
        const text = el.innerText.replace(/\u00A0/g, " ");
        navigator.clipboard.writeText(text).then(()=>toast("Copied âœ“")).catch(()=>toast("Copy failed"));
      }
      function toast(msg){
        let t = document.getElementById("toast");
        if(!t){
          t = document.createElement("div");
          t.id = "toast";
          t.style.position = "fixed";
          t.style.left = "50%";
          t.style.bottom = "18px";
          t.style.transform = "translateX(-50%)";
          t.style.padding = "10px 12px";
          t.style.borderRadius = "999px";
          t.style.background = "rgba(0,0,0,.75)";
          t.style.color = "white";
          t.style.fontWeight = "700";
          t.style.border = "1px solid rgba(255,255,255,.18)";
          t.style.boxShadow = "0 10px 25px rgba(0,0,0,.35)";
          t.style.zIndex = "9999";
          t.style.opacity = "0";
          t.style.transition = "opacity .15s ease";
          document.body.appendChild(t);
        }
        t.textContent = msg;
        t.style.opacity = "1";
        clearTimeout(window.__toastTimer);
        window.__toastTimer = setTimeout(()=>{ t.style.opacity="0"; }, 1100);
      }
      document.querySelectorAll("[data-copy]").forEach(btn=>{
        btn.addEventListener("click", ()=>copyTextFromSelector(btn.getAttribute("data-copy")));
      });
    })();

    // Single static plot on <canvas>: First BZ rectangle and Fermi circle to scale
    (function(){
      const canvas = document.getElementById("bzCanvas");
      const ctx = canvas.getContext("2d");

      // Values in cm^-1
      const pi_over_a = 1.57079632679e8;  // Ï€/a with a=2e-8 cm
      const pi_over_b = 7.85398163397e7;  // Ï€/b with b=4e-8 cm
      const kF = 8.86e7;                  // computed kF

      // We'll display axes in units of 1e8 cm^-1
      const unit = 1e8;
      const xMax = 2.2;   // in (1e8 cm^-1)
      const yMax = 1.5;

      function resizeAndDraw(){
        const dpr = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();
        const w = Math.max(520, Math.floor(rect.width));
        const h = Math.floor(w * 0.62);

        canvas.width = Math.floor(w * dpr);
        canvas.height = Math.floor(h * dpr);
        canvas.style.height = h + "px";

        ctx.setTransform(dpr,0,0,dpr,0,0);
        draw(w,h);
      }

      function draw(w,h){
        ctx.clearRect(0,0,w,h);

        // Plot area
        const padL = 58, padR = 20, padT = 22, padB = 46;
        const plotW = w - padL - padR;
        const plotH = h - padT - padB;

        function xPix(x){ // x in units of 1e8 cm^-1
          return padL + (x + xMax) / (2*xMax) * plotW;
        }
        function yPix(y){ // y in units of 1e8 cm^-1
          return padT + (yMax - y) / (2*yMax) * plotH;
        }

        // Background grid
        ctx.save();
        ctx.strokeStyle = "rgba(255,255,255,.10)";
        ctx.lineWidth = 1;

        const xTicks = 9;
        for(let i=0;i<=xTicks;i++){
          const x = -xMax + (2*xMax)*i/xTicks;
          ctx.beginPath();
          ctx.moveTo(xPix(x), yPix(yMax));
          ctx.lineTo(xPix(x), yPix(-yMax));
          ctx.stroke();
        }
        const yTicks = 6;
        for(let j=0;j<=yTicks;j++){
          const y = -yMax + (2*yMax)*j/yTicks;
          ctx.beginPath();
          ctx.moveTo(xPix(-xMax), yPix(y));
          ctx.lineTo(xPix(xMax), yPix(y));
          ctx.stroke();
        }
        ctx.restore();

        // Axes
        ctx.save();
        ctx.strokeStyle = "rgba(238,241,255,.55)";
        ctx.lineWidth = 1.6;

        // x-axis y=0
        ctx.beginPath();
        ctx.moveTo(xPix(-xMax), yPix(0));
        ctx.lineTo(xPix(xMax), yPix(0));
        ctx.stroke();

        // y-axis x=0
        ctx.beginPath();
        ctx.moveTo(xPix(0), yPix(yMax));
        ctx.lineTo(xPix(0), yPix(-yMax));
        ctx.stroke();
        ctx.restore();

        // Tick labels
        ctx.save();
        ctx.fillStyle = "rgba(238,241,255,.80)";
        ctx.font = "12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "top";

        for(let i=0;i<=xTicks;i++){
          const x = -xMax + (2*xMax)*i/xTicks;
          const xp = xPix(x);
          const yp = yPix(0);
          ctx.fillText(x.toFixed(1), xp, yp + 8);
        }
        ctx.textAlign = "right";
        ctx.textBaseline = "middle";
        for(let j=0;j<=yTicks;j++){
          const y = -yMax + (2*yMax)*j/yTicks;
          const xp = xPix(0);
          const yp = yPix(y);
          ctx.fillText(y.toFixed(1), xp - 8, yp);
        }

        // Axis labels and title
        ctx.textAlign = "center";
        ctx.textBaseline = "top";
        ctx.font = "13px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillText("kx (Ã—10â¸ cmâ»Â¹)", padL + plotW/2, h - 28);

        ctx.save();
        ctx.translate(18, padT + plotH/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = "center";
        ctx.textBaseline = "top";
        ctx.fillText("ky (Ã—10â¸ cmâ»Â¹)", 0, 0);
        ctx.restore();

        ctx.font = "14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
        ctx.fillStyle = "rgba(238,241,255,.92)";
        ctx.textAlign = "left";
        ctx.textBaseline = "top";
        ctx.fillText("First Brillouin Zone & Fermi Circle (to scale)", padL, 6);
        ctx.restore();

        // Draw first BZ rectangle
        const bx = pi_over_a / unit; // half-width in x (units)
        const by = pi_over_b / unit; // half-width in y (units)

        ctx.save();
        ctx.strokeStyle = "rgba(138,180,255,.95)";
        ctx.lineWidth = 2.3;
        ctx.beginPath();
        ctx.rect(xPix(-bx), yPix(by), xPix(bx)-xPix(-bx), yPix(-by)-yPix(by));
        ctx.stroke();
        ctx.restore();

        // Draw Fermi circle
        const r = kF / unit;
        const cx = xPix(0), cy = yPix(0);
        const rx = xPix(r) - xPix(0);          // scale in x
        const ry = yPix(0) - yPix(r);          // scale in y (positive)
        // Use average radius for isotropic scaling; axes scales are uniform in value units by construction,
        // so rx â‰ˆ ry; take mean to reduce any rounding.
        const rad = 0.5*(Math.abs(rx)+Math.abs(ry));

        ctx.save();
        ctx.strokeStyle = "rgba(124,240,199,.95)";
        ctx.lineWidth = 2.3;
        ctx.beginPath();
        ctx.arc(cx, cy, rad, 0, Math.PI*2);
        ctx.stroke();
        ctx.restore();

        // Legend
        ctx.save();
        const lx = padL + 10, ly = padT + 10;
        ctx.fillStyle = "rgba(5,8,18,.72)";
        ctx.strokeStyle = "rgba(255,255,255,.10)";
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.roundRect(lx, ly, 250, 64, 12);
        ctx.fill();
        ctx.stroke();

        // BZ sample
        ctx.strokeStyle = "rgba(138,180,255,.95)";
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(lx+14, ly+20);
        ctx.lineTo(lx+54, ly+20);
        ctx.stroke();
        ctx.fillStyle = "rgba(238,241,255,.85)";
        ctx.font = "12px ui-sans-serif, system-ui";
        ctx.textAlign = "left";
        ctx.textBaseline = "middle";
        ctx.fillText("1st BZ: kx=Â±Ï€/a, ky=Â±Ï€/b", lx+64, ly+20);

        // Fermi sample
        ctx.strokeStyle = "rgba(124,240,199,.95)";
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(lx+14, ly+44);
        ctx.lineTo(lx+54, ly+44);
        ctx.stroke();
        ctx.fillStyle = "rgba(238,241,255,.85)";
        ctx.fillText("Fermi circle: radius kF", lx+64, ly+44);
        ctx.restore();

        // Numeric annotations
        ctx.save();
        ctx.fillStyle = "rgba(238,241,255,.82)";
        ctx.font = "12px ui-sans-serif, system-ui";
        ctx.textAlign = "left";
        ctx.textBaseline = "top";
        ctx.fillText("Ï€/a = 1.571Ã—10â¸ cmâ»Â¹", padL, h - 72);
        ctx.fillText("Ï€/b = 0.785Ã—10â¸ cmâ»Â¹", padL, h - 56);
        ctx.fillText("kF  = 0.886Ã—10â¸ cmâ»Â¹", padL, h - 40);
        ctx.restore();
      }

      // Polyfill for roundRect if needed
      if(!CanvasRenderingContext2D.prototype.roundRect){
        CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
          r = Math.min(r, w/2, h/2);
          this.beginPath();
          this.moveTo(x+r, y);
          this.arcTo(x+w, y, x+w, y+h, r);
          this.arcTo(x+w, y+h, x, y+h, r);
          this.arcTo(x, y+h, x, y, r);
          this.arcTo(x, y, x+w, y, r);
          this.closePath();
          return this;
        };
      }

      window.addEventListener("resize", resizeAndDraw, {passive:true});
      resizeAndDraw();
    })();
  </script>
</body>
</html>
