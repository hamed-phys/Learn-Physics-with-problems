<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>RMS Thermal Dilation of a Crystal Cell (Sodium) — Physics + Mathematical Physics</title>
  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1621;
      --panel2:#111b29;
      --text:#e9eef6;
      --muted:#b7c2d4;
      --faint:#7f8aa3;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --border:rgba(255,255,255,0.10);
      --shadow: 0 18px 60px rgba(0,0,0,0.45);
      --radius:18px;
      --radius2:22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Noto Sans", Arial, "Helvetica Neue", sans-serif;
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg:#f7fafc;
        --panel:#ffffff;
        --panel2:#f2f6fb;
        --text:#0b1220;
        --muted:#334155;
        --faint:#64748b;
        --border:rgba(2,6,23,0.10);
        --shadow: 0 18px 60px rgba(2,6,23,0.10);
      }
    }

    *{ box-sizing:border-box; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 700px at 18% 10%, rgba(125,211,252,0.10), transparent 55%),
                  radial-gradient(1000px 650px at 75% 30%, rgba(167,139,250,0.10), transparent 60%),
                  var(--bg);
      color:var(--text);
      line-height:1.62;
    }

    a{ color:var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    header{
      padding:28px 18px 8px;
    }
    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding:0 12px 48px;
    }

    .hero{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border:1px solid var(--border);
      box-shadow:var(--shadow);
      border-radius:var(--radius2);
      padding:22px 18px;
      overflow:hidden;
      position:relative;
    }
    .hero::before{
      content:"";
      position:absolute;
      inset:-2px;
      background: linear-gradient(90deg, rgba(125,211,252,0.18), rgba(167,139,250,0.18));
      filter:blur(22px);
      opacity:0.30;
      z-index:0;
      pointer-events:none;
    }
    .hero > *{ position:relative; z-index:1; }

    .kicker{
      display:inline-flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      font-size:13px;
      color:var(--muted);
      margin-bottom:10px;
    }
    .pill{
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
      padding:4px 10px;
      border-radius:999px;
      font-size:12px;
    }
    h1{
      font-size: clamp(24px, 3vw, 38px);
      line-height:1.15;
      margin:6px 0 8px;
      letter-spacing:-0.02em;
    }
    .subtitle{
      color:var(--muted);
      font-size:15.5px;
      margin:0 0 12px;
      max-width: 85ch;
    }

    main{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:16px;
      align-items:start;
      margin-top:14px;
    }

    nav.toc{
      position:sticky;
      top:14px;
      align-self:start;
      background: var(--panel);
      border:1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding:14px 14px 12px;
      max-height: calc(100vh - 28px);
      overflow:auto;
    }
    nav.toc h2{
      font-size:14px;
      margin:0 0 10px;
      color:var(--muted);
      letter-spacing:0.02em;
      text-transform:uppercase;
    }
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid transparent;
      color:var(--text);
      font-size:14px;
      line-height:1.25;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }
    .toc a:hover{
      background: rgba(255,255,255,0.05);
      border-color: var(--border);
      transform: translateX(2px);
      text-decoration:none;
    }
    .toc .small{
      color:var(--faint);
      font-size:12px;
      margin-top:10px;
      padding:0 6px;
    }

    article{
      background: var(--panel);
      border:1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius2);
      padding:18px 18px 22px;
      overflow:hidden;
      position:relative;
    }

    section{
      padding:12px 0;
      border-top:1px dashed rgba(255,255,255,0.14);
    }
    section:first-of-type{ border-top:none; padding-top:0; }

    h2{
      font-size: clamp(18px, 2.1vw, 26px);
      margin:0 0 10px;
      letter-spacing:-0.01em;
    }
    h3{
      font-size: clamp(16px, 1.6vw, 20px);
      margin:16px 0 8px;
      color:var(--text);
    }
    p{ margin: 8px 0; color: var(--text); }
    ul{ margin: 8px 0 8px 18px; color: var(--text); }
    li{ margin: 6px 0; }
    .muted{ color: var(--muted); }
    .faint{ color: var(--faint); }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 980px){
      main{ grid-template-columns: 1fr; }
      nav.toc{ position:relative; top:auto; max-height:none; }
      .grid2{ grid-template-columns: 1fr; }
    }

    .callout{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border-radius: var(--radius);
      padding:12px 12px;
      margin:12px 0;
      position:relative;
      overflow:hidden;
    }
    .callout::after{
      content:"";
      position:absolute;
      width:220px; height:220px;
      right:-120px; top:-140px;
      background: radial-gradient(circle at 30% 30%, rgba(125,211,252,0.22), transparent 60%);
      filter: blur(1px);
      opacity:0.9;
      pointer-events:none;
    }
    .callout h4{
      margin:0 0 6px;
      font-size:14px;
      letter-spacing:0.02em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .callout.assumptions{ border-left:4px solid var(--warn); }
    .callout.keyeq{ border-left:4px solid var(--accent); }
    .callout.mistakes{ border-left:4px solid var(--bad); }
    .callout.final{ border-left:4px solid var(--ok); }

    pre{
      margin:10px 0;
      background: var(--panel2);
      border:1px solid var(--border);
      border-radius: 14px;
      padding:12px 12px;
      overflow:auto;
      font-family: var(--mono);
      font-size: 13px;
      line-height:1.5;
      color: var(--text);
      position:relative;
    }

    .eq{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:10px;
      align-items:start;
    }
    .copybtn{
      appearance:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      border-radius: 12px;
      padding:9px 10px;
      font-size: 12px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      white-space:nowrap;
    }
    .copybtn:hover{
      background: rgba(255,255,255,0.07);
      border-color: rgba(255,255,255,0.18);
      transform: translateY(-1px);
    }
    .copybtn:active{ transform: translateY(0px) scale(0.99); }
    .copynote{
      font-size:12px;
      color: var(--faint);
      margin-top:6px;
    }

    details{
      margin: 10px 0;
      border:1px solid var(--border);
      border-radius: var(--radius);
      background: rgba(255,255,255,0.03);
      padding:10px 12px;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 600;
    }
    details[open]{ background: rgba(255,255,255,0.05); }

    figure{
      margin: 14px 0 8px;
      border:1px solid var(--border);
      border-radius: var(--radius2);
      background: rgba(255,255,255,0.02);
      padding:12px;
      overflow:hidden;
    }
    figcaption{
      color: var(--muted);
      font-size: 13px;
      margin-top:8px;
    }
    canvas{
      width:100%;
      height:320px;
      display:block;
      border-radius: 14px;
      background: rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.10);
    }

    .backtop{
      display:inline-flex;
      gap:10px;
      align-items:center;
      margin-top:10px;
      padding:8px 10px;
      border-radius: 12px;
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      font-size: 13px;
    }
    .backtop:hover{
      text-decoration:none;
      background: rgba(255,255,255,0.07);
    }

    footer{
      margin-top:14px;
      color: var(--faint);
      font-size: 12.5px;
      padding: 10px 2px 0;
    }

    @media print{
      body{ background:#fff; }
      nav.toc{ display:none; }
      header{ padding:0; }
      .hero, article{ box-shadow:none; }
      article, .hero{ border:1px solid #bbb; }
      .copybtn{ display:none; }
      .callout::after{ display:none; }
      section{ break-inside: avoid-page; }
      h2, h3{ break-after: avoid-page; }
      figure{ break-inside: avoid-page; }
      a{ color:#000; text-decoration:underline; }
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="wrap">
      <div class="hero">
        <div class="kicker">
          <span class="pill">Statistical Physics</span>
          <span class="pill">Elasticity</span>
          <span class="pill">Industrial Materials</span>
          <span class="pill">Mathematical Physics lens</span>
        </div>
        <h1>RMS Thermal Dilation of a Crystal Cell (Sodium)</h1>
        <p class="subtitle">
          Estimate the <b>root-mean-square</b> (rms) fractional volume fluctuation ΔV/V of a <b>primitive cell</b> of sodium at 300 K using the bulk modulus,
          then convert it to the rms fractional lattice-parameter fluctuation Δa/a. We treat thermal motion as exciting a <b>harmonic elastic mode</b>
          (uniform dilation) and use <b>equipartition</b> / Gaussian fluctuation theory.
        </p>
      </div>

      <main>
        <nav class="toc" aria-label="Table of contents">
          <h2>Table of Contents</h2>
          <a href="#quick">Quick Summary</a>
          <a href="#part0">PART 0 — Concept Primer</a>
          <a href="#part0b">PART 0B — Industry & Applied Physics Perspective</a>
          <a href="#part1">PART 1 — Problem Analysis</a>
          <a href="#part2">PART 2 — Strategy & Tips</a>
          <a href="#part3">PART 3 — Full Solution</a>
          <a href="#part4">PART 4 — Deeper Understanding</a>
          <a href="#part5">PART 5 — Optional Plot Guide</a>
          <div class="small">
            Tip: Use the copy buttons next to equations and the final answer.
          </div>
        </nav>

        <article>
          <section id="quick">
            <h2>Quick Summary</h2>
            <ul>
              <li><b>What this is:</b> Thermal agitation causes a crystal cell’s volume (and lattice parameter) to fluctuate around equilibrium.</li>
              <li><b>Key physics idea:</b> Treat uniform dilation as a <b>harmonic elastic degree of freedom</b> with energy cost set by the <b>bulk modulus</b> B.</li>
              <li><b>Governing relation (elastic energy):</b> For small strain, <span class="muted">U = (1/2) B V (ΔV/V)²</span>.</li>
              <li><b>Stat mech link:</b> A quadratic energy implies Gaussian fluctuations; equipartition gives <span class="muted">⟨U⟩ = (1/2)k<sub>B</sub>T</span> for that mode.</li>
              <li><b>Main result type:</b> Numeric estimate (with a clearly stated lattice constant assumption) plus a symbolic formula showing scaling.</li>
              <li><b>Result:</b> For Na at 300 K, using B = 7×10<sup>10</sup> erg·cm<sup>−3</sup> ≈ 7 GPa and a ≈ 4.23 Å,
                <b>rms</b> ΔV/V ≈ 0.125 (≈ 12.5%).</li>
              <li><b>Lattice parameter:</b> For cubic crystals, ΔV/V ≈ 3Δa/a ⇒ rms Δa/a ≈ 0.0417 (≈ 4.2%).</li>
              <li><b>Physical meaning:</b> These are <i>microscopic</i> cell-scale fluctuations; averaging over many cells reduces fluctuations as 1/√N.</li>
            </ul>
          </section>

          <section id="part0">
            <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

            <h3>Core definitions (symbols and SI units)</h3>
            <ul>
              <li><b>T</b> — absolute temperature (K)</li>
              <li><b>k<sub>B</sub></b> — Boltzmann constant (J/K)</li>
              <li><b>V</b> — volume of the region considered (m<sup>3</sup>)</li>
              <li><b>ΔV</b> — volume fluctuation about equilibrium (m<sup>3</sup>)</li>
              <li><b>B</b> — bulk modulus (Pa = J/m<sup>3</sup>)</li>
              <li><b>a</b> — lattice parameter (m), and <b>Δa</b> its fluctuation (m)</li>
              <li><b>u(x)</b> — displacement field (m), a vector field over the crystal</li>
            </ul>

            <h3>Physical meaning (intuition)</h3>
            <p>
              Bulk modulus <b>B</b> measures resistance to <b>uniform compression/expansion</b>. A small fractional volume change
              <b>ε<sub>V</sub> = ΔV/V</b> costs energy proportional to <b>B</b>. Thermal energy excites this “spring-like” mode,
              producing random volume fluctuations.
            </p>

            <h3>Key laws/principles and validity conditions</h3>
            <ul>
              <li><b>Linear elasticity:</b> small strain so energy is quadratic in strain (harmonic approximation).</li>
              <li><b>Equipartition (high-T classical limit):</b> each quadratic degree of freedom contributes (1/2)k<sub>B</sub>T to mean energy.</li>
              <li><b>Debye temperature clue:</b> since Θ<sub>D</sub> = 158 K &lt; 300 K, many phonon modes are classically populated, supporting equipartition-scale estimates.</li>
              <li><b>Local vs macroscopic:</b> A single primitive cell is tiny; fluctuations can be large. Over many cells, fluctuations self-average.</li>
            </ul>

            <div class="callout assumptions">
              <h4>Assumptions (what we idealize)</h4>
              <ul>
                <li>Isotropic response for <b>uniform dilation</b> captured by bulk modulus <b>B</b>.</li>
                <li>Harmonic (quadratic) elastic energy; neglect anharmonicity.</li>
                <li>Classical thermal energy scale ~ k<sub>B</sub>T (consistent with Θ<sub>D</sub> &lt; T).</li>
                <li>Primitive cell volume computed from a cubic lattice constant (Na is bcc).</li>
              </ul>
            </div>

            <h3>Mathematical physics framing: from fields to one collective mode</h3>
            <p>
              In continuum elasticity, the crystal is modeled by a displacement field <b>u(x)</b> on a domain Ω (here, a primitive cell with periodic boundary conditions).
              The <b>infinitesimal strain tensor</b> is
            </p>

            <div class="eq">
              <pre data-copy="epsilon_ij = (1/2)(∂_i u_j + ∂_j u_i).">epsilon_ij = (1/2)(∂_i u_j + ∂_j u_i)</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <p>
              The <b>volumetric strain</b> (trace of strain) is the divergence of displacement:
              <b>θ = ∇·u = ∂<sub>i</sub>u<sub>i</sub></b>.
              For a <b>uniform dilation mode</b>, θ is spatially constant, and the volume change obeys:
              <b>ΔV/V = θ</b> (to first order in small strain).
            </p>

            <p>
              The elastic energy functional includes a bulk term (schematically, ignoring shear since we excite a pure dilation mode):
            </p>

            <div class="eq">
              <pre data-copy="U[u] = ∫_Ω (1/2) B (∇·u)^2 d^3x  (pure dilation contribution).">U[u] = ∫_Ω (1/2) B (∇·u)^2 d^3x  (pure dilation contribution)</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <p>
              If θ is uniform, then (∇·u) = θ and the integral reduces exactly to a single quadratic “spring” energy:
              <b>U = (1/2) B V θ² = (1/2) B V (ΔV/V)²</b>.
              This reduction is valid because the functional is <b>linear in volume</b> and θ is constant by symmetry for a uniform mode.
            </p>

            <div class="callout keyeq">
              <h4>Key equation (uniform dilation energy)</h4>
              <div class="eq">
                <pre data-copy="U(ε_V) = (1/2) B V ε_V^2,  where ε_V ≡ ΔV/V.">U(ε_V) = (1/2) B V ε_V^2,  where ε_V ≡ ΔV/V</pre>
                <button class="copybtn" data-copy-target="prev">Copy equation</button>
              </div>
              <div class="copynote">This is the central bridge between elasticity and statistical mechanics.</div>
            </div>

            <h3>Mini intuition examples (quick)</h3>
            <ul>
              <li><b>Softer material (smaller B):</b> the “spring” is weaker ⇒ larger thermal volume fluctuations.</li>
              <li><b>Bigger averaging volume V:</b> more atoms share the fluctuation ⇒ rms ΔV/V decreases like 1/√V.</li>
              <li><b>Higher T:</b> more thermal energy ⇒ rms ΔV/V grows like √T.</li>
            </ul>

            <h3>What to watch for (pitfalls)</h3>
            <ul>
              <li>Confusing <b>thermal expansion</b> (mean shift with T due to anharmonicity) with <b>thermal fluctuation</b> (random rms about equilibrium).</li>
              <li>For a <b>primitive cell</b>, V is tiny ⇒ ΔV/V can look “large” without implying the macroscopic sample changes that much.</li>
              <li>Unit conversion: given B in cgs (erg/cm<sup>3</sup>) must be converted carefully to SI if you compute in SI.</li>
              <li>Relating ΔV/V to Δa/a: for cubic symmetry, use first-order differential <b>dV/V = 3 da/a</b>.</li>
            </ul>
          </section>

          <section id="part0b">
            <h2>PART 0B — Industry & Applied Physics Perspective</h2>

            <h3>Where this phenomenon appears (concrete application areas)</h3>
            <ul>
              <li><b>Precision metrology & interferometry:</b> unit-cell and lattice-spacing fluctuations contribute to noise floors in high-precision length standards and diffraction-based measurements.</li>
              <li><b>Semiconductor & thin-film manufacturing:</b> thermal stress, wafer bow, and defect formation relate to elastic moduli and thermal agitation; microscopic fluctuations are the starting point for understanding variability.</li>
              <li><b>Structural reliability & fatigue:</b> local fluctuations seed microcrack nucleation especially when combined with cyclic loads, thermal gradients, and anisotropic constraints.</li>
              <li><b>Cryogenic and aerospace hardware:</b> modulus + temperature determine dimensional stability; small-scale fluctuations matter for resonators and sensors.</li>
            </ul>

            <h3>Why engineers care</h3>
            <ul>
              <li><b>Performance:</b> dimensional stability controls resonance frequencies, alignment, and optical path lengths.</li>
              <li><b>Reliability:</b> thermo-mechanical noise and stress fluctuations can accelerate defect migration and damage initiation.</li>
              <li><b>Cost & manufacturability:</b> tolerance budgets depend on how materials respond to temperature and stress at multiple scales.</li>
            </ul>

            <h3>Typical measurement/validation methods</h3>
            <ul>
              <li><b>X-ray/neutron diffraction:</b> measures lattice spacing and Debye-Waller factors (vibrational amplitudes).</li>
              <li><b>Ultrasonic testing:</b> infers elastic constants (including bulk modulus) from sound velocities.</li>
              <li><b>Thermo-mechanical analysis (TMA):</b> tracks macroscopic expansion, while scattering probes microscopic fluctuations.</li>
            </ul>

            <h3>Design trade-offs and constraints</h3>
            <ul>
              <li><b>Real materials are anisotropic:</b> bulk modulus is an isotropic simplification; single crystals require tensor elasticity.</li>
              <li><b>Anharmonicity matters for averages:</b> thermal expansion (mean) needs anharmonic terms; fluctuations can often start with harmonic theory.</li>
              <li><b>Interfaces & constraints:</b> films on substrates convert volume/strain fluctuations into stress noise (important in MEMS/NEMS).</li>
            </ul>

            <details>
              <summary>From lab to product: how the idealized model gets adapted</summary>
              <p class="muted">
                In product design, you rarely use a single-cell V. You choose a relevant <b>effective volume</b> (e.g., a device mode volume, grain volume, or averaging volume from the measurement bandwidth).
                Then you combine elastic fluctuation estimates with geometry, boundary constraints, and frequency-dependent response (mechanical impedance / damping) to predict actual dimensional noise.
              </p>
            </details>
          </section>

          <section id="part1">
            <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

            <h3>Problem restatement (in plain words)</h3>
            <p>
              At T = 300 K, estimate how much the volume of a <b>primitive cell</b> of sodium fluctuates thermally, quantified by the rms fractional dilation <b>(ΔV/V)<sub>rms</sub></b>.
              Use the bulk modulus B = 7×10<sup>10</sup> erg·cm<sup>−3</sup> and the note that Θ<sub>D</sub> = 158 K &lt; 300 K so thermal energy scale is ~k<sub>B</sub>T.
              Then use that to estimate rms fractional fluctuation of the lattice parameter <b>(Δa/a)<sub>rms</sub></b>.
            </p>

            <div class="grid2">
              <div class="callout">
                <h4>Given</h4>
                <ul>
                  <li>T = 300 K</li>
                  <li>B = 7×10<sup>10</sup> erg·cm<sup>−3</sup> (≈ 7 GPa)</li>
                  <li>Θ<sub>D</sub> = 158 K (so T is in classical-ish regime)</li>
                  <li>Crystal: sodium (bcc), primitive cell volume V<sub>p</sub> = a<sup>3</sup>/2</li>
                </ul>
              </div>
              <div class="callout">
                <h4>Unknowns</h4>
                <ul>
                  <li>(ΔV/V)<sub>rms</sub> for one primitive cell</li>
                  <li>(Δa/a)<sub>rms</sub> for the lattice parameter</li>
                </ul>
              </div>
            </div>

            <h3>Relevant principles and why they apply</h3>
            <ul>
              <li><b>Elastic energy of uniform dilation:</b> bulk modulus directly relates pressure to volumetric strain; small fluctuations cost quadratic energy.</li>
              <li><b>Statistical mechanics of quadratic modes:</b> harmonic (quadratic) energies yield Gaussian distributions and equipartition relations.</li>
              <li><b>Debye temperature note:</b> supports using classical energy scale k<sub>B</sub>T (not strongly quantum-suppressed at 300 K).</li>
            </ul>

            <h3>Mathematical model (explicit)</h3>
            <div class="callout keyeq">
              <h4>Model specification</h4>
              <ul>
                <li><b>Domain:</b> Ω is one primitive cell volume, treated with <b>periodic boundary conditions</b> (crystal repeats).</li>
                <li><b>Field:</b> displacement u(x) defined for x ∈ Ω; small strain ε<sub>ij</sub> = (1/2)(∂<sub>i</sub>u<sub>j</sub> + ∂<sub>j</sub>u<sub>i</sub>).</li>
                <li><b>Collective coordinate (uniform dilation):</b> θ ≡ ∇·u is spatially constant; identify θ = ΔV/V.</li>
                <li><b>Energy functional (reduced mode):</b> U(θ) = (1/2) B V θ².</li>
                <li><b>Statistical ensemble:</b> canonical distribution P(θ) ∝ exp(−U(θ)/(k<sub>B</sub>T)).</li>
                <li><b>Boundary/initial conditions:</b> No time evolution required (equilibrium). Periodicity ensures uniform mode is admissible; shear is ignored by symmetry choice.</li>
              </ul>
            </div>

            <h3>Approaches (compare)</h3>
            <ul>
              <li><b>Equipartition shortcut:</b> set ⟨U⟩ = (1/2)k<sub>B</sub>T for the quadratic mode ⇒ immediate rms estimate. <span class="muted">(Fast, standard for estimates.)</span></li>
              <li><b>Full Gaussian integral:</b> compute ⟨θ²⟩ from P(θ) ∝ exp(−(B V θ²)/(2k<sub>B</sub>T)). <span class="muted">(More “mathematical physics”, same result.)</span></li>
              <li><b>Phonon-mode summation:</b> treat long-wavelength compressional phonons and project onto k=0 mode. <span class="muted">(More complete but overkill for this prompt.)</span></li>
            </ul>
            <p>
              <b>Best choice:</b> Use the Gaussian/equipartition method: it is rigorous for a quadratic energy and matches the “estimate” nature of the problem.
            </p>
          </section>

          <section id="part2">
            <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

            <ol>
              <li><b>Convert units:</b> express B in SI (Pa = J/m³) and choose consistent units throughout.</li>
              <li><b>Find primitive cell volume V:</b> for bcc Na, V = a³/2; use a reasonable room-temperature lattice constant for Na (needed for a numeric estimate).</li>
              <li><b>Write the energy:</b> U = (1/2) B V (ΔV/V)² for uniform dilation.</li>
              <li><b>Connect to thermal physics:</b> treat ε<sub>V</sub> = ΔV/V as a quadratic mode with canonical distribution or equipartition.</li>
              <li><b>Compute rms:</b> (ΔV/V)<sub>rms</sub> = sqrt(⟨(ΔV/V)²⟩) = sqrt(k<sub>B</sub>T/(B V)).</li>
              <li><b>Convert to lattice parameter:</b> for cubic V ∝ a³ ⇒ ΔV/V ≈ 3Δa/a ⇒ (Δa/a)<sub>rms</sub> = (1/3)(ΔV/V)<sub>rms</sub>.</li>
              <li><b>Sanity checks:</b> dimensions, scaling with V and B, and discuss why single-cell fluctuations can be “large”.</li>
            </ol>

            <div class="callout mistakes">
              <h4>Common mistakes</h4>
              <ul>
                <li>Using <b>thermal expansion coefficient</b> (mean change with T) instead of <b>thermal fluctuations</b> (rms about equilibrium).</li>
                <li>Forgetting that 1 erg/cm³ = 0.1 J/m³ (unit conversion error by ×10).</li>
                <li>Using conventional cubic cell volume a³ instead of primitive cell volume a³/2 for bcc.</li>
                <li>Missing the factor 3 relating ΔV/V and Δa/a for cubic crystals.</li>
              </ul>
            </div>
          </section>

          <section id="part3">
            <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

            <h3>Qualitative expectation (before calculating)</h3>
            <ul>
              <li>Higher B ⇒ stiffer against compression ⇒ smaller fluctuations.</li>
              <li>Smaller V ⇒ fewer atoms averaging ⇒ larger relative fluctuations.</li>
              <li>At 300 K (above Θ<sub>D</sub>), we expect classical-scale fluctuations ~ √(k<sub>B</sub>T / (B V)).</li>
            </ul>

            <h3>Step 1 — Convert the bulk modulus to SI</h3>
            <p>
              You are given
              <b>B = 7×10<sup>10</sup> erg·cm<sup>−3</sup></b>.
              Use:
              <b>1 erg = 10<sup>−7</sup> J</b> and <b>1 cm<sup>3</sup> = 10<sup>−6</sup> m<sup>3</sup></b>.
              Therefore
            </p>
            <div class="eq">
              <pre data-copy="1 (erg/cm^3) = (10^-7 J)/(10^-6 m^3) = 0.1 J/m^3 = 0.1 Pa.">1 (erg/cm^3) = (10^-7 J)/(10^-6 m^3) = 0.1 J/m^3 = 0.1 Pa</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>
            <p>So</p>
            <div class="eq">
              <pre data-copy="B = 7×10^10 erg/cm^3 = 7×10^9 Pa = 7 GPa.">B = 7×10^10 erg/cm^3 = 7×10^9 Pa = 7 GPa</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <h3>Step 2 — Primitive cell volume of sodium (bcc)</h3>
            <p>
              Sodium is <b>body-centered cubic (bcc)</b>. The conventional cubic cell has volume a³ and contains 2 atoms, so the
              primitive cell volume is
            </p>
            <div class="eq">
              <pre data-copy="V_p = a^3 / 2  (bcc primitive cell).">V_p = a^3 / 2  (bcc primitive cell)</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>
            <p class="muted">
              The problem statement does not supply a, so for a numeric estimate we must use a reasonable room-temperature value.
              A commonly used approximate value is <b>a ≈ 4.23 Å</b> at ~300 K (order-of-magnitude correct for Na).
              Keep in mind the final scaling: rms ∝ a<sup>−3/2</sup>.
            </p>

            <div class="eq">
              <pre data-copy="a ≈ 4.23 Å = 4.23×10^-10 m ⇒ V_p = a^3/2 ≈ 3.78×10^-29 m^3.">a ≈ 4.23 Å = 4.23×10^-10 m ⇒ V_p = a^3/2 ≈ 3.78×10^-29 m^3</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <h3>Step 3 — Elastic energy of uniform dilation (derivation with operators)</h3>
            <p>
              Start from the continuum expression for volumetric strain:
              <b>θ = ∇·u</b>.
              For a uniform dilation mode, θ is constant in space (symmetry: no preferred direction or location inside the periodic cell).
              The bulk elastic energy density is
              <b>w = (1/2)B θ²</b>.
              Integrating over the primitive cell domain Ω gives:
            </p>

            <div class="eq">
              <pre data-copy="U = ∫_Ω (1/2)B(∇·u)^2 d^3x = (1/2)B θ^2 ∫_Ω d^3x = (1/2)B V_p θ^2.">U = ∫_Ω (1/2)B(∇·u)^2 d^3x = (1/2)B θ^2 ∫_Ω d^3x = (1/2)B V_p θ^2</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <p>
              To first order in small strain, θ equals the fractional volume change:
              <b>θ = ΔV/V</b>.
              Hence
            </p>
            <div class="eq">
              <pre data-copy="U(ε_V) = (1/2) B V_p ε_V^2,  where ε_V ≡ ΔV/V.">U(ε_V) = (1/2) B V_p ε_V^2,  where ε_V ≡ ΔV/V</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <p class="muted">
              <b>Why this step is valid:</b> The energy is quadratic because we assumed linear elasticity (Taylor expand the free energy around equilibrium; the first derivative vanishes at equilibrium, leaving a leading quadratic term).
              Uniform dilation isolates the “bulk” part; shear contributions vanish for this symmetry choice.
            </p>

            <h3>Step 4 — Statistical mechanics: compute ⟨(ΔV/V)²⟩</h3>
            <p>
              Treat ε<sub>V</sub> as a single scalar coordinate of a quadratic Hamiltonian:
              <b>U(ε<sub>V</sub>) = (1/2) (B V<sub>p</sub>) ε<sub>V</sub><sup>2</sup></b>.
              In the canonical ensemble, the probability density is
            </p>

            <div class="eq">
              <pre data-copy="P(ε_V) = Z^{-1} exp[-U(ε_V)/(k_B T)] = Z^{-1} exp[-(B V_p ε_V^2)/(2 k_B T)].">P(ε_V) = Z^{-1} exp[-U(ε_V)/(k_B T)] = Z^{-1} exp[-(B V_p ε_V^2)/(2 k_B T)]</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <p>
              This is a Gaussian. Compute the variance explicitly (no “magic jump”):
              for a Gaussian of the form exp(−α ε²), we have ⟨ε²⟩ = 1/(2α).
              Here α = (B V<sub>p</sub>)/(2 k<sub>B</sub>T). Therefore
            </p>

            <div class="eq">
              <pre data-copy="⟨ε_V^2⟩ = 1/(2α) = 1 / [2 * (B V_p)/(2 k_B T)] = k_B T / (B V_p).">⟨ε_V^2⟩ = 1/(2α) = 1 / [2 * (B V_p)/(2 k_B T)] = k_B T / (B V_p)</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <p>
              Hence the rms fractional volume fluctuation is:
            </p>

            <div class="callout keyeq">
              <h4>Result (symbolic)</h4>
              <div class="eq">
                <pre data-copy="(ΔV/V)_rms = sqrt(⟨ε_V^2⟩) = sqrt( k_B T / (B V_p) ).">(ΔV/V)_rms = sqrt(⟨ε_V^2⟩) = sqrt( k_B T / (B V_p) )</pre>
                <button class="copybtn" data-copy-target="prev">Copy equation</button>
              </div>
            </div>

            <p class="muted">
              <b>Connection to equipartition (quick check):</b>
              Since U = (1/2) (B V<sub>p</sub>) ε<sub>V</sub>² is quadratic, equipartition gives
              ⟨U⟩ = (1/2)k<sub>B</sub>T ⇒ (1/2)(B V<sub>p</sub>)⟨ε<sub>V</sub>²⟩ = (1/2)k<sub>B</sub>T ⇒ the same ⟨ε<sub>V</sub>²⟩.
            </p>

            <h3>Step 5 — Plug in numbers (part a)</h3>
            <p>
              Compute k<sub>B</sub>T at 300 K:
            </p>
            <div class="eq">
              <pre data-copy="k_B T = (1.380649×10^-23 J/K)(300 K) = 4.14×10^-21 J.">k_B T = (1.380649×10^-23 J/K)(300 K) = 4.14×10^-21 J</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <p>Now insert B = 7×10<sup>9</sup> Pa = 7×10<sup>9</sup> J/m³ and V<sub>p</sub> ≈ 3.78×10<sup>−29</sup> m³:</p>

            <div class="eq">
              <pre data-copy="(ΔV/V)_rms = sqrt[ (4.14×10^-21 J) / ( (7×10^9 J/m^3)(3.78×10^-29 m^3) ) ] ≈ 0.125.">(ΔV/V)_rms = sqrt[ (4.14×10^-21 J) / ( (7×10^9 J/m^3)(3.78×10^-29 m^3) ) ] ≈ 0.125</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <h3>Step 6 — Convert to lattice-parameter fluctuation (part b)</h3>
            <p>
              For cubic crystals, the primitive-cell volume is proportional to a³ (for bcc, V<sub>p</sub> = a³/2, the factor 1/2 does not affect differentials).
              Taking a differential:
            </p>

            <div class="eq">
              <pre data-copy="V_p ∝ a^3  ⇒  dV_p/V_p = 3 da/a  ⇒  ΔV/V ≈ 3 Δa/a (to first order).">V_p ∝ a^3  ⇒  dV_p/V_p = 3 da/a  ⇒  ΔV/V ≈ 3 Δa/a (to first order)</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <p>
              Therefore the rms lattice-parameter fluctuation is
            </p>
            <div class="eq">
              <pre data-copy="(Δa/a)_rms = (1/3)(ΔV/V)_rms ≈ 0.125/3 ≈ 0.0417.">(Δa/a)_rms = (1/3)(ΔV/V)_rms ≈ 0.125/3 ≈ 0.0417</pre>
              <button class="copybtn" data-copy-target="prev">Copy equation</button>
            </div>

            <div class="callout final">
              <h4>Final Answer (boxed)</h4>
              <div class="eq">
                <pre id="finalAnswer" data-copy="Given B = 7×10^10 erg·cm^-3 (≈7 GPa), T = 300 K, and using a ≈ 4.23 Å for Na (bcc):
V_p = a^3/2 ≈ 3.78×10^-29 m^3

(a) (ΔV/V)_rms = sqrt(k_B T/(B V_p)) ≈ 0.125  ≈ 12.5%

(b) For cubic symmetry ΔV/V ≈ 3Δa/a ⇒ (Δa/a)_rms ≈ 0.0417 ≈ 4.2%

Scaling: (ΔV/V)_rms ∝ sqrt(T) / sqrt(B a^3).">Given B = 7×10^10 erg·cm^-3 (≈7 GPa), T = 300 K, and using a ≈ 4.23 Å for Na (bcc):
V_p = a^3/2 ≈ 3.78×10^-29 m^3

(a) (ΔV/V)_rms = sqrt(k_B T/(B V_p)) ≈ 0.125  ≈ 12.5%

(b) For cubic symmetry ΔV/V ≈ 3Δa/a ⇒ (Δa/a)_rms ≈ 0.0417 ≈ 4.2%

Scaling: (ΔV/V)_rms ∝ sqrt(T) / sqrt(B a^3).</pre>
                <button class="copybtn" data-copy-target="#finalAnswer">Copy final answer</button>
              </div>
            </div>

            <h3>Sanity checks</h3>
            <ul>
              <li><b>Units:</b> k<sub>B</sub>T has J; B V has (J/m³)(m³)=J; ratio is dimensionless; square root dimensionless ✔</li>
              <li><b>Limiting cases:</b> If B→∞, fluctuations →0; if V→∞ (macroscopic), fluctuations →0 ✔</li>
              <li><b>Why “large” for one cell:</b> The cell is tiny; rms fluctuations represent microscopic thermal agitation. Over N cells, rms scales as 1/√N.</li>
            </ul>

            <div class="callout">
              <h4>Math Insight (equation as a mathematical object)</h4>
              <p class="muted">
                The core model is a <b>Gaussian field reduction</b> to a single harmonic coordinate ε<sub>V</sub>. Mathematically, it is the same structure as a
                <b>1D quadratic Hamiltonian</b>. The canonical distribution is a Gaussian, and the variance is the inverse curvature of the energy:
                <b>Var(ε<sub>V</sub>) = (k<sub>B</sub>T)/(B V)</b>.
                This is a clean example of “<b>fluctuation = temperature / stiffness</b>”.
              </p>
            </div>

            <details>
              <summary>Nondimensionalization / scaling check (optional)</summary>
              <p class="muted">
                Define a dimensionless strain variable ε = ΔV/V. The only energy scale in the harmonic model is
                E<sub>0</sub> = B V. Then U/(k<sub>B</sub>T) = (E<sub>0</sub>/(2k<sub>B</sub>T)) ε².
                The distribution depends only on the dimensionless group
                <b>η = E<sub>0</sub>/(k<sub>B</sub>T) = (B V)/(k<sub>B</sub>T)</b>.
                Large η ⇒ narrow Gaussian (small fluctuations). Small η ⇒ broad Gaussian (large fluctuations).
              </p>
            </details>
          </section>

          <section id="part4">
            <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

            <h3>Re-interpret the final formula</h3>
            <p>
              The symbolic result
              <b>(ΔV/V)<sub>rms</sub> = √(k<sub>B</sub>T/(B V))</b>
              says:
            </p>
            <ul>
              <li><b>k<sub>B</sub>T</b> supplies thermal energy (noise strength).</li>
              <li><b>B</b> supplies “spring constant per unit volume” (stiffness against dilation).</li>
              <li><b>V</b> is the averaging volume; bigger V means many atoms share the fluctuation ⇒ smaller relative noise.</li>
            </ul>

            <h3>Parameter dependence (qualitative + quick quantitative)</h3>
            <ul>
              <li>Doubling <b>T</b> increases rms by √2.</li>
              <li>Doubling <b>B</b> decreases rms by 1/√2.</li>
              <li>Using N primitive cells as an averaging region (V → N V<sub>p</sub>) decreases rms by 1/√N.</li>
              <li>For bcc with V<sub>p</sub> = a³/2, rms scales as a<sup>−3/2</sup>: larger lattice constant ⇒ smaller relative fluctuations.</li>
            </ul>

            <h3>Alternative derivation idea (brief but meaningful)</h3>
            <p class="muted">
              Instead of treating ε<sub>V</sub> as a single variable, you can start from the full elastic displacement field u(x) and expand in Fourier modes (periodic boundary conditions).
              The uniform dilation corresponds to the k=0 longitudinal component (a collective coordinate). Projecting the energy functional onto that mode yields the same
              effective quadratic energy with stiffness B V, and thus the same variance.
            </p>

            <h3>Concept check (self-test with answers)</h3>
            <ul>
              <li><b>Q:</b> If you consider a region containing 10<sup>6</sup> cells, how does (ΔV/V)<sub>rms</sub> change?
                <br><b>A:</b> It drops by 1/√(10<sup>6</sup>) = 10<sup>−3</sup>.</li>
              <li><b>Q:</b> Why isn’t this the same as thermal expansion?
                <br><b>A:</b> Expansion is a <i>mean shift</i> ⟨V⟩ with T due to anharmonicity; this problem is about <i>variance</i> around equilibrium in (nearly) harmonic theory.</li>
              <li><b>Q:</b> What mathematical property ensures a Gaussian distribution for ε<sub>V</sub>?
                <br><b>A:</b> The energy is quadratic: U ∝ ε², so P ∝ exp(−const·ε²), which is Gaussian.</li>
              <li><b>Q:</b> What happens in the quantum limit T ≪ Θ<sub>D</sub>?
                <br><b>A:</b> Equipartition fails; fluctuations are set by zero-point motion and quantum statistics, generally smaller than the classical k<sub>B</sub>T estimate.</li>
            </ul>

            <a class="backtop" href="#top" aria-label="Back to top">↑ Back to top</a>
          </section>

          <section id="part5">
            <h2>PART 5 — Optional Plot Guide</h2>
            <p>
              A plot is useful here because it visually reinforces a key learning takeaway: <b>relative fluctuations self-average</b>.
              Below we plot the scaling
              <b>(ΔV/V)<sub>rms</sub>(N) = (ΔV/V)<sub>rms</sub>(1)/√N</b> versus N, the number of primitive cells in the averaging region.
              This does <i>not</i> change the single-cell result; it shows why macroscopic samples appear stable.
            </p>

            <figure>
              <canvas id="plot" aria-label="Plot of rms volume fluctuation vs number of cells"></canvas>
              <figcaption>
                Example scaling plot (using the computed single-cell value for Na at 300 K): (ΔV/V)<sub>rms</sub> decreases as 1/√N with the number of cells N.
              </figcaption>
            </figure>

            <div class="callout">
              <h4>Plot details</h4>
              <ul>
                <li><b>x-axis:</b> N (number of primitive cells in averaging region), shown on a log-like spacing (1 to 10<sup>6</sup>).</li>
                <li><b>y-axis:</b> (ΔV/V)<sub>rms</sub> (dimensionless), using the <b>example</b> single-cell value 0.125.</li>
                <li><b>What to notice:</b> Straight-line trend on the chosen scaling emphasizes the 1/√N decay: huge stability gain from averaging.</li>
              </ul>
            </div>

            <footer>
              <p>
                Note: The numeric values depend mildly on the assumed lattice constant a at 300 K; the key physics and scaling are robust.
              </p>
            </footer>
          </section>
        </article>
      </main>
    </div>
  </header>

  <script>
    (function(){
      // Copy buttons
      function copyText(txt){
        return navigator.clipboard.writeText(txt);
      }

      function resolveTarget(btn){
        const t = btn.getAttribute('data-copy-target');
        if(!t) return null;
        if(t === 'prev'){
          const pre = btn.parentElement.querySelector('pre');
          return pre || null;
        }
        if(t.startsWith('#')){
          return document.querySelector(t);
        }
        return document.querySelector(t);
      }

      document.querySelectorAll('.copybtn').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          try{
            let text = "";
            const explicit = btn.closest('.eq')?.querySelector('pre')?.getAttribute('data-copy');
            const target = resolveTarget(btn);
            if(target && target.tagName === 'PRE'){
              text = target.getAttribute('data-copy') || target.textContent;
            }else if(explicit){
              text = explicit;
            }else{
              const pre = btn.closest('.eq')?.querySelector('pre');
              text = pre ? (pre.getAttribute('data-copy') || pre.textContent) : "";
            }
            await copyText(text.trim());
            const old = btn.textContent;
            btn.textContent = "Copied ✓";
            btn.style.borderColor = "rgba(52,211,153,0.55)";
            setTimeout(()=>{ btn.textContent = old; btn.style.borderColor=""; }, 900);
          }catch(e){
            const old = btn.textContent;
            btn.textContent = "Copy failed";
            setTimeout(()=>btn.textContent=old, 900);
          }
        });
      });

      // Canvas plot: rms vs N with 1/sqrt(N) scaling
      const canvas = document.getElementById('plot');
      if(!canvas) return;

      function draw(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const rect = canvas.getBoundingClientRect();
        const W = Math.max(320, Math.floor(rect.width));
        const H = Math.max(260, Math.floor(rect.height));
        canvas.width = Math.floor(W * dpr);
        canvas.height = Math.floor(H * dpr);
        const ctx = canvas.getContext('2d');
        ctx.setTransform(dpr,0,0,dpr,0,0);

        ctx.clearRect(0,0,W,H);

        const padL = 64, padR = 18, padT = 34, padB = 52;
        const x0 = padL, y0 = H - padB;
        const x1 = W - padR, y1 = padT;

        // Example single-cell value from solution
        const y1cell = 0.125;
        const Nmax = 1e6;

        // x in log10(N)
        const xmin = 0, xmax = Math.log10(Nmax);

        const ymax = y1cell;
        const ylo = 0;
        const yhi = ymax * 1.08;

        function X(N){
          const lx = Math.log10(N);
          return x0 + ( (lx - xmin) / (xmax - xmin) ) * (x1 - x0);
        }
        function Y(y){
          return y0 - ( (y - ylo) / (yhi - ylo) ) * (y0 - y1);
        }

        // Gridlines and axes
        ctx.lineWidth = 1;
        ctx.strokeStyle = 'rgba(255,255,255,0.10)';
        ctx.fillStyle = 'rgba(255,255,255,0.75)';
        ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, sans-serif';

        // Vertical grid at decades
        for(let k=0;k<=6;k++){
          const N = Math.pow(10,k);
          const xx = X(N);
          ctx.beginPath();
          ctx.moveTo(xx, y1);
          ctx.lineTo(xx, y0);
          ctx.stroke();

          ctx.strokeStyle = 'rgba(255,255,255,0.16)';
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y0+6);
          ctx.stroke();
          ctx.strokeStyle = 'rgba(255,255,255,0.10)';

          const label = (k===0) ? "1" : "10^" + k;
          ctx.fillStyle = 'rgba(255,255,255,0.70)';
          ctx.textAlign = 'center';
          ctx.fillText(label, xx, y0+22);
        }

        // Horizontal grid
        const yTicks = [0.0, 0.02, 0.04, 0.06, 0.08, 0.10, 0.12];
        for(const yt of yTicks){
          const yy = Y(yt);
          ctx.strokeStyle = 'rgba(255,255,255,0.10)';
          ctx.beginPath();
          ctx.moveTo(x0, yy);
          ctx.lineTo(x1, yy);
          ctx.stroke();

          ctx.strokeStyle = 'rgba(255,255,255,0.16)';
          ctx.beginPath();
          ctx.moveTo(x0-6, yy);
          ctx.lineTo(x0, yy);
          ctx.stroke();

          ctx.fillStyle = 'rgba(255,255,255,0.70)';
          ctx.textAlign = 'right';
          ctx.fillText(yt.toFixed(2), x0-10, yy+4);
        }

        // Axes
        ctx.strokeStyle = 'rgba(255,255,255,0.30)';
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(x0, y1);
        ctx.lineTo(x0, y0);
        ctx.lineTo(x1, y0);
        ctx.stroke();

        // Titles
        ctx.fillStyle = 'rgba(255,255,255,0.88)';
        ctx.textAlign = 'left';
        ctx.font = '600 14px system-ui, -apple-system, Segoe UI, Roboto, sans-serif';
        ctx.fillText('RMS volume fluctuation vs averaging size (example)', x0, 20);

        // Axis labels
        ctx.fillStyle = 'rgba(255,255,255,0.78)';
        ctx.font = '12.5px system-ui, -apple-system, Segoe UI, Roboto, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('N = number of primitive cells (log scale)', (x0+x1)/2, H-16);

        ctx.save();
        ctx.translate(18, (y0+y1)/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.fillText('(ΔV/V)_rms (dimensionless)', 0, 0);
        ctx.restore();

        // Curve
        ctx.lineWidth = 2.2;
        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.beginPath();
        const steps = 220;
        for(let i=0;i<=steps;i++){
          const t = i/steps;
          const lx = xmin + t*(xmax-xmin);
          const N = Math.pow(10,lx);
          const y = y1cell/Math.sqrt(N);
          const xx = X(N);
          const yy = Y(y);
          if(i===0) ctx.moveTo(xx,yy);
          else ctx.lineTo(xx,yy);
        }
        ctx.stroke();

        // Legend
        const lx = x1 - 210, ly = y1 + 8;
        ctx.fillStyle = 'rgba(0,0,0,0.25)';
        ctx.strokeStyle = 'rgba(255,255,255,0.14)';
        ctx.lineWidth = 1;
        roundRect(ctx, lx, ly, 200, 44, 12);
        ctx.fill();
        ctx.stroke();

        ctx.strokeStyle = 'rgba(125,211,252,0.95)';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(lx+14, ly+18);
        ctx.lineTo(lx+46, ly+18);
        ctx.stroke();

        ctx.fillStyle = 'rgba(255,255,255,0.86)';
        ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, sans-serif';
        ctx.textAlign = 'left';
        ctx.fillText('Example: (ΔV/V)_rms(N) = 0.125 / √N', lx+54, ly+22);
        ctx.fillStyle = 'rgba(255,255,255,0.70)';
        ctx.fillText('using Na @300 K single-cell rms ≈ 0.125', lx+54, ly+38);

        function roundRect(c,x,y,w,h,r){
          const rr = Math.min(r, w/2, h/2);
          c.beginPath();
          c.moveTo(x+rr, y);
          c.arcTo(x+w, y, x+w, y+h, rr);
          c.arcTo(x+w, y+h, x, y+h, rr);
          c.arcTo(x, y+h, x, y, rr);
          c.arcTo(x, y, x+w, y, rr);
          c.closePath();
        }
      }

      let resizeTimer = null;
      function onResize(){
        if(resizeTimer) cancelAnimationFrame(resizeTimer);
        resizeTimer = requestAnimationFrame(draw);
      }
      window.addEventListener('resize', onResize, {passive:true});
      draw();
    })();
  </script>
</body>
</html>
