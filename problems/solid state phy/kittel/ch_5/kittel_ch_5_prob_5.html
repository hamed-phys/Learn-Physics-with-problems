<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#0b1020" />
  <title>Grüneisen Constant: Phonon Free Energy, Thermal Expansion, and Debye Relation</title>
  <style>
    :root{
      --bg: #070a12;
      --panel: rgba(255,255,255,0.06);
      --panel2: rgba(255,255,255,0.085);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --faint: rgba(255,255,255,0.55);
      --line: rgba(255,255,255,0.14);
      --accent: #7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 12px 30px rgba(0,0,0,0.35);
      --radius: 18px;
      --radius2: 14px;
      --maxw: 1180px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{ box-sizing:border-box; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1200px 800px at 15% 10%, rgba(125,211,252,0.10), transparent 55%),
        radial-gradient(900px 700px at 90% 20%, rgba(167,139,250,0.10), transparent 50%),
        radial-gradient(1000px 900px at 50% 90%, rgba(52,211,153,0.06), transparent 55%),
        var(--bg);
      line-height: 1.55;
    }
    a{ color: var(--accent); text-decoration: none; }
    a:hover{ text-decoration: underline; }
    header{
      padding: 28px 18px 12px;
      border-bottom: 1px solid var(--line);
      position: relative;
      overflow:hidden;
    }
    .wrap{
      max-width: var(--maxw);
      margin: 0 auto;
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 18px;
      padding: 18px;
    }
    @media (max-width: 980px){
      .wrap{ grid-template-columns: 1fr; }
    }
    .hero{
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 0 18px 12px;
    }
    .title{
      display:flex;
      align-items:flex-start;
      gap:14px;
      flex-wrap:wrap;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(125,211,252,0.10);
      border: 1px solid rgba(125,211,252,0.22);
      color: var(--text);
      font-size: 12.5px;
      letter-spacing: 0.2px;
      margin-top: 4px;
    }
    h1{
      margin: 0;
      font-size: clamp(22px, 3.2vw, 36px);
      letter-spacing: 0.2px;
      line-height: 1.15;
    }
    .subtitle{
      margin: 10px 0 0;
      color: var(--muted);
      max-width: 80ch;
    }

    nav.toc{
      position: sticky;
      top: 14px;
      align-self: start;
      background: linear-gradient(180deg, rgba(255,255,255,0.07), rgba(255,255,255,0.05));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 10px;
      overflow:hidden;
    }
    nav.toc h2{
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 1.0px;
      color: var(--faint);
      margin: 4px 0 10px;
    }
    nav.toc a{
      display:block;
      padding: 7px 10px;
      border-radius: 12px;
      color: var(--text);
      border: 1px solid transparent;
      font-size: 14px;
    }
    nav.toc a:hover{
      background: rgba(255,255,255,0.06);
      border-color: rgba(255,255,255,0.10);
      text-decoration:none;
    }
    nav.toc .mini{
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed rgba(255,255,255,0.18);
      color: var(--muted);
      font-size: 12.5px;
    }
    @media print{
      nav.toc{ display:none; }
      .wrap{ grid-template-columns: 1fr; }
      header{ border-bottom:none; }
    }

    main{
      display:flex;
      flex-direction: column;
      gap: 14px;
      min-width: 0;
    }

    section{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.04));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      position: relative;
      overflow:hidden;
    }
    section::before{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      background: radial-gradient(900px 250px at 10% 0%, rgba(125,211,252,0.08), transparent 60%);
      opacity: 0.55;
    }
    section > *{ position: relative; }
    h2{
      margin: 0 0 10px;
      font-size: clamp(18px, 2.1vw, 24px);
      letter-spacing: 0.2px;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 16.5px;
      letter-spacing: 0.2px;
    }
    p{ margin: 8px 0; color: var(--text); }
    ul{ margin: 10px 0 0 18px; color: var(--text); }
    li{ margin: 6px 0; }
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      align-items: start;
    }
    @media (max-width: 820px){
      .grid2{ grid-template-columns: 1fr; }
    }
    .callout{
      border-radius: var(--radius2);
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.12);
      padding: 12px 12px;
    }
    .callout .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size: 12px;
      letter-spacing: 0.9px;
      text-transform: uppercase;
      color: var(--faint);
      margin-bottom: 6px;
    }
    .callout.good{ border-color: rgba(52,211,153,0.28); background: rgba(52,211,153,0.06); }
    .callout.warn{ border-color: rgba(251,191,36,0.28); background: rgba(251,191,36,0.06); }
    .callout.bad{ border-color: rgba(251,113,133,0.28); background: rgba(251,113,133,0.06); }
    .callout.math{ border-color: rgba(167,139,250,0.30); background: rgba(167,139,250,0.06); }
    .eq{
      margin: 10px 0;
      border-radius: var(--radius2);
      background: rgba(0,0,0,0.35);
      border: 1px solid rgba(255,255,255,0.14);
      padding: 12px 12px 10px;
      overflow-x:auto;
      position: relative;
    }
    .eq pre{
      margin:0;
      font-family: var(--mono);
      font-size: 13.5px;
      line-height: 1.5;
      color: rgba(255,255,255,0.92);
      white-space: pre;
    }
    .btnrow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top: 8px;
    }
    button.copy{
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.07);
      color: var(--text);
      padding: 7px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-size: 13px;
      transition: transform 0.12s ease, background 0.12s ease;
    }
    button.copy:hover{ background: rgba(255,255,255,0.10); transform: translateY(-1px); }
    button.copy:active{ transform: translateY(0px); }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 12.5px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.06);
      color: var(--muted);
    }
    details{
      border-radius: var(--radius2);
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.12);
      padding: 10px 12px;
      margin-top: 10px;
    }
    details summary{
      cursor:pointer;
      font-weight: 650;
      color: rgba(255,255,255,0.88);
      list-style:none;
    }
    details summary::-webkit-details-marker{ display:none; }
    details[open]{
      background: rgba(255,255,255,0.06);
    }
    .backtop{
      display:inline-block;
      margin-top: 10px;
      font-size: 13.5px;
      color: var(--muted);
    }
    footer{
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 10px 18px 28px;
      color: var(--muted);
      font-size: 13px;
    }
    .kbox{
      border-radius: var(--radius);
      padding: 14px;
      background: linear-gradient(180deg, rgba(125,211,252,0.08), rgba(255,255,255,0.04));
      border: 1px solid rgba(125,211,252,0.22);
    }

    /* Print-friendly */
    @media print{
      body{ background:white; color:black; }
      section, nav.toc{ box-shadow:none; }
      section{ border: 1px solid #bbb; page-break-inside: avoid; }
      .eq{ background: #f4f4f4; border: 1px solid #ccc; }
      button.copy{ display:none; }
      a{ color: black; text-decoration: underline; }
    }
  </style>
</head>

<body>
  <a id="top"></a>
  <header>
    <div class="hero">
      <div class="title">
        <div class="badge" aria-label="Topic badge">
          <span>Solid-state physics</span>
          <span style="opacity:.55;">•</span>
          <span>Thermodynamics</span>
          <span style="opacity:.55;">•</span>
          <span>Mathematical physics</span>
        </div>
      </div>
      <h1>Grüneisen Constant: From Phonon Free Energy to Thermal Expansion (and the Debye Relation)</h1>
      <p class="subtitle">
        We derive the free energy of a single phonon mode (quantum harmonic oscillator), then minimize the crystal free
        energy with respect to fractional volume change to obtain a compact relation between thermal energy density and
        thermal expansion. Finally, we connect the Grüneisen constant to Debye temperature via a log-derivative with
        respect to volume.
      </p>
    </div>
  </header>

  <div class="wrap">
    <nav class="toc" aria-label="Table of contents">
      <h2>Contents</h2>
      <a href="#quick">Quick Summary</a>
      <a href="#part0">PART 0 — Concept Primer</a>
      <a href="#part0b">PART 0B — Industry & Applied Physics</a>
      <a href="#part1">PART 1 — Problem Analysis</a>
      <a href="#part2">PART 2 — Strategy & Tips</a>
      <a href="#part3">PART 3 — Full Solution</a>
      <a href="#part4">PART 4 — Deeper Understanding</a>
      <a href="#part5">PART 5 — Plot Guide</a>
      <div class="mini">
        <div class="pill">No external libs • Copy buttons • Print-friendly</div>
      </div>
    </nav>

    <main>
      <section id="quick">
        <h2>Quick Summary</h2>
        <ul>
          <li><b>What this is about:</b> connecting <b>phonon thermodynamics</b> to <b>thermal expansion</b> through the <b>Grüneisen constant</b> γ.</li>
          <li><b>Key physics idea:</b> phonons are quantum harmonic oscillators; their <b>frequencies depend on volume</b>, creating a thermoelastic coupling.</li>
          <li><b>Governing object:</b> the <b>Helmholtz free energy</b> F(T, V) (or F(T, Δ) with Δ = δV/V).</li>
          <li><b>Single-mode free energy:</b> for a phonon mode of frequency ω,
            <span style="white-space:nowrap;"><b>F</b> = k<sub>B</sub>T ln[2 sinh(ħω / (2k<sub>B</sub>T))].</span>
          </li>
          <li><b>Crystal free energy model:</b>
            <span style="white-space:nowrap;">F(Δ, T) = (1/2)BΔ² + k<sub>B</sub>T Σ<sub>K</sub> ln[2 sinh(ħω<sub>K</sub>(Δ)/(2k<sub>B</sub>T))].</span>
          </li>
          <li><b>Grüneisen definition:</b> δω/ω = −γ Δ (mode-independent γ assumed in the problem).</li>
          <li><b>Result type:</b> <b>symbolic</b>. Minimizing F gives
            <span style="white-space:nowrap;">BΔ = γ Σ<sub>K</sub> (ħω<sub>K</sub>/2)coth(ħω<sub>K</sub>/(2k<sub>B</sub>T)).</span>
          </li>
          <li><b>Physical meaning:</b> thermal expansion is driven by the <b>vibrational energy density</b> (including zero-point if retained) scaled by γ/B.</li>
          <li><b>Debye model link:</b> γ = − d ln Θ / d ln V, where Θ is the Debye temperature (or any characteristic phonon scale).</li>
        </ul>
        <div class="btnrow" style="margin-top:12px;">
          <button class="copy" data-copy="F_mode(T,ω) = k_B T ln[ 2 sinh( ħ ω / (2 k_B T) ) ]">Copy key equation (a)</button>
          <button class="copy" data-copy="Minimization gives:  B Δ = γ Σ_K (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) )">Copy key equation (b)</button>
          <button class="copy" data-copy="Debye relation:  γ = - d ln Θ / d ln V">Copy key equation (c)</button>
        </div>
      </section>

      <section id="part0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="callout">
            <div class="tag">Core definitions • symbols • SI</div>
            <ul>
              <li><b>ω</b> [rad/s]: phonon angular frequency (mode-dependent ω<sub>K</sub>).</li>
              <li><b>ħ</b> [J·s]: reduced Planck constant.</li>
              <li><b>T</b> [K]: absolute temperature; <b>β</b> = 1/(k<sub>B</sub>T).</li>
              <li><b>F</b> [J]: Helmholtz free energy, F = U − TS = −k<sub>B</sub>T ln Z.</li>
              <li><b>Z</b>: canonical partition function.</li>
              <li><b>Δ</b> [dimensionless]: fractional volume change, Δ = δV/V.</li>
              <li><b>B</b> [Pa = J/m³]: bulk modulus, elastic energy density ≈ (1/2)BΔ².</li>
              <li><b>γ</b> [dimensionless]: Grüneisen constant (here assumed mode-independent).</li>
              <li><b>coth(x)</b> = cosh(x)/sinh(x).</li>
            </ul>
          </div>

          <div class="callout math">
            <div class="tag">Mathematical model framing</div>
            <p>
              <b>State variables:</b> (T, V) or (T, Δ), with Δ ∈ ℝ small (linear thermoelastic regime).<br/>
              <b>Microscopic model:</b> lattice vibrations → a set of independent quantum harmonic oscillators labeled by mode index K
              (wavevector + branch). Each mode has eigenfrequency ω<sub>K</sub>(V).<br/>
              <b>Thermodynamic potential:</b> F(T,Δ) minimized at equilibrium <i>for fixed T</i> (canonical ensemble) and no external pressure
              beyond the reference state.<br/>
              <b>Domain/assumptions:</b> quasi-harmonic approximation (frequencies depend on volume, but phonons remain non-interacting).
            </p>
          </div>
        </div>

        <h3>Physical meaning (intuition)</h3>
        <p>
          In a perfectly harmonic crystal with volume-independent phonon frequencies, phonons contribute to heat capacity but
          do <b>not</b> cause thermal expansion. Thermal expansion appears when the vibrational spectrum shifts with volume:
          heating changes phonon occupation → changes vibrational free energy → shifts equilibrium volume.
          The Grüneisen constant γ quantifies that coupling.
        </p>

        <h3>Key laws / principles and validity conditions</h3>
        <ul>
          <li><b>Canonical ensemble:</b> equilibrium at fixed T minimizes F(T, V).</li>
          <li><b>Quantum harmonic oscillator spectrum:</b> E<sub>n</sub> = (n + 1/2)ħω, n = 0,1,2,…</li>
          <li><b>Quasi-harmonic approximation:</b> frequencies depend on V (or Δ), but each mode still has harmonic levels.</li>
          <li><b>Small-strain elasticity:</b> elastic energy density ≈ (1/2)BΔ² (quadratic in Δ).</li>
        </ul>

        <div class="callout warn" style="margin-top:12px;">
          <div class="tag">What to watch for (pitfalls)</div>
          <ul>
            <li><b>Zero-point energy matters:</b> keeping (1/2)ħω inside Z is required to get the compact ln[2sinh(…)] form.</li>
            <li><b>Sign conventions:</b> Δ = δV/V and δω/ω = −γΔ → for γ &gt; 0, increasing volume typically lowers ω.</li>
            <li><b>Mode dependence:</b> in reality γ can vary strongly with K; the problem asks to treat γ as K-independent.</li>
            <li><b>Validity:</b> part (a) assumes ω is T-independent; if ω(T) varies, extra terms appear in thermodynamic derivatives.</li>
          </ul>
        </div>

        <details>
          <summary>Mini intuition examples (quick)</summary>
          <ul>
            <li><b>If ω decreases with expansion (γ&gt;0):</b> expanding lowers phonon energy levels, which can be entropically favorable at finite T → positive thermal expansion.</li>
            <li><b>If ω increases with expansion (γ&lt;0):</b> some materials can show negative thermal expansion over ranges of T.</li>
            <li><b>High-T limit:</b> phonon energy → k<sub>B</sub>T per mode (classical), and the equilibrium Δ scales roughly with T (through energy density).</li>
          </ul>
        </details>

        <div class="callout math" style="margin-top:12px;">
          <div class="tag">Math Insight</div>
          <p>
            The equilibrium condition <b>∂F/∂Δ = 0</b> is a <b>variational principle</b>: the stable state is a minimizer of a convex functional in Δ
            (quadratic elastic term + convex phonon contribution via ln sinh). Mathematically, it resembles a small-parameter coupling
            between an elastic quadratic form and a sum of mode free energies.
          </p>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>
        <div class="grid2">
          <div class="callout">
            <div class="tag">Where this appears (industry)</div>
            <ul>
              <li><b>Microelectronics & packaging:</b> thermal expansion mismatch (CTE) causes stress, warpage, and fatigue in solder joints and TSV/3D stacks.</li>
              <li><b>Precision optics & metrology:</b> low-expansion materials (e.g., Zerodur-like behavior) rely on phonon/anharmonicity control; temperature drift affects alignment.</li>
              <li><b>Energy systems:</b> turbines, heat exchangers, and battery materials see thermoelastic strain; phonon physics influences thermal expansion and thermal conductivity.</li>
              <li><b>Cryogenics:</b> at low T, zero-point and quantum statistics matter for dimensional stability (satellites, detectors).</li>
            </ul>
          </div>
          <div class="callout">
            <div class="tag">Why engineers care</div>
            <ul>
              <li><b>Reliability:</b> thermomechanical cycling drives crack growth; knowing γ and B helps predict strain from heating.</li>
              <li><b>Performance & tolerances:</b> expansion changes resonance frequencies, gap spacing, and contact pressure.</li>
              <li><b>Cost & manufacturability:</b> material choice and heat-treatment strategies often target controlled CTE and stress.</li>
              <li><b>Efficiency:</b> phonon spectrum ties to thermal conductivity; volume dependence influences both CTE and heat transport.</li>
            </ul>
          </div>
        </div>

        <h3>Typical measurement / validation methods</h3>
        <ul>
          <li><b>Dilatometry</b> (CTE vs T), <b>X-ray/neutron diffraction</b> (lattice parameter vs T).</li>
          <li><b>Brillouin/ultrasonic</b> methods for elastic constants and bulk modulus B.</li>
          <li><b>Raman/IR spectroscopy</b> and <b>inelastic neutron scattering</b> for phonon frequencies and their pressure/volume dependence → γ.</li>
        </ul>

        <h3>Design trade-offs & real-world constraints</h3>
        <ul>
          <li>Real solids have <b>anisotropy</b>: thermal expansion is tensorial; γ can be direction-dependent.</li>
          <li><b>Defects, grain structure, residual stress</b> shift effective moduli and alter measured expansion.</li>
          <li><b>Beyond quasi-harmonic:</b> strong anharmonicity, phase transitions, and soft modes can dominate expansion.</li>
        </ul>

        <details>
          <summary>From lab to product: adapting the idealized model</summary>
          <p>
            In product design, the quasi-harmonic model provides a physics-based baseline: CTE ≈ (γ/B) × (vibrational energy density).
            Engineers then add corrections: anisotropic elasticity, temperature-dependent B(T), mode-dependent γ<sub>K</sub>, and microstructure-driven
            effective properties. This gives a calibrated model that can be embedded into thermo-mechanical FEA workflows for reliability prediction.
          </p>
        </details>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part1">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <h3>Problem restatement (in plain words)</h3>
        <p>
          (a) Treat a single phonon mode of frequency ω as a quantum harmonic oscillator and show its free energy is
          F = k<sub>B</sub>T ln[2 sinh(ħω / (2k<sub>B</sub>T))], keeping the zero-point energy.
          <br/>
          (b) For a crystal whose fractional volume change is Δ, take the free energy
          F(Δ,T) = (1/2)BΔ² + k<sub>B</sub>T Σ<sub>K</sub> ln[2 sinh(ħω<sub>K</sub>(Δ) / (2k<sub>B</sub>T))].
          With the mode-frequency volume dependence δω/ω = −γΔ (γ independent of K), minimize F with respect to Δ and show
          BΔ = γ Σ<sub>K</sub> (ħω<sub>K</sub>/2)coth(ħω<sub>K</sub>/(2k<sub>B</sub>T)). Then rewrite in terms of thermal energy density.
          <br/>
          (c) In the Debye model, show γ = − d ln Θ / d ln V.
        </p>

        <div class="grid2">
          <div class="callout">
            <div class="tag">Given</div>
            <ul>
              <li>Single-mode frequency ω, harmonic oscillator spectrum.</li>
              <li>Crystal model: elastic term (1/2)BΔ² and phonon free-energy sum over modes K.</li>
              <li>Volume dependence: δω/ω = −γΔ, with γ constant across modes (assumption for this problem).</li>
              <li>Debye model: phonon spectrum characterized by Debye temperature Θ (or Θ<sub>D</sub>).</li>
            </ul>
          </div>
          <div class="callout">
            <div class="tag">Unknowns / targets</div>
            <ul>
              <li>(a) Derive closed-form F(ω,T) for one mode.</li>
              <li>(b) Equilibrium Δ(T) from ∂F/∂Δ = 0 and connect to energy density.</li>
              <li>(c) Express γ as a log-derivative of Θ with respect to volume V.</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><b>Statistical mechanics:</b> F = −k<sub>B</sub>T ln Z in the canonical ensemble; Z computable for harmonic oscillator exactly.</li>
          <li><b>Calculus of variations (single variable):</b> equilibrium at fixed T is minimizing F in Δ; thus set ∂F/∂Δ = 0 and check stability with ∂²F/∂Δ² &gt; 0.</li>
          <li><b>Chain rule:</b> ω depends on Δ, so ∂/∂Δ acts through x = ħω/(2k<sub>B</sub>T).</li>
          <li><b>Debye scaling:</b> if all frequencies scale with a single cutoff ω<sub>D</sub> (equivalently Θ), then log-derivatives match.</li>
        </ul>

        <div class="callout warn">
          <div class="tag">Assumptions (explicit)</div>
          <ul>
            <li>Quasi-harmonic approximation: phonon energies are harmonic but ω<sub>K</sub> depends on volume (Δ).</li>
            <li>Small strain: elastic energy density ≈ (1/2)BΔ² (higher powers neglected).</li>
            <li>γ is treated as <b>mode-independent</b> and <b>temperature-independent</b> (as the note warns, this is an approximation).</li>
            <li>No external pressure term added (or we are expanding around the zero-pressure equilibrium reference).</li>
          </ul>
        </div>

        <h3>Possible approaches (2–3) and comparison</h3>
        <ul>
          <li><b>Approach A (direct partition function):</b> compute Z for oscillator → F. Pros: exact and clean. Cons: must handle zero-point carefully.</li>
          <li><b>Approach B (thermodynamic identities):</b> derive U and S first, then F = U − TS. Pros: physical intuition. Cons: more algebra and still needs quantum statistics.</li>
          <li><b>Approach C (variational minimization):</b> start from given F(Δ,T) and minimize by differentiation + chain rule. Pros: shortest for (b), highlights coupling. Cons: requires careful derivative of ln sinh.</li>
        </ul>
        <p><b>Best choice:</b> Use A for (a) and C for (b), then a scaling/log-derivative argument for (c).</p>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part2">
        <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

        <ol style="margin:10px 0 0 18px;">
          <li><b>Model a phonon mode</b> as a quantum harmonic oscillator with E<sub>n</sub> = (n+1/2)ħω.</li>
          <li><b>Compute the partition function</b> Z = Σ exp(−βE<sub>n</sub>) using a geometric series.</li>
          <li><b>Get free energy</b> F = −k<sub>B</sub>T ln Z and rewrite it using sinh.</li>
          <li><b>Write crystal free energy</b> F(Δ,T) with the elastic term + sum over modes of single-mode F.</li>
          <li><b>Encode volume dependence</b> via δω/ω = −γΔ ⇒ ∂ω/∂Δ = −γω (linearized).</li>
          <li><b>Differentiate F with respect to Δ</b> using chain rule: ∂/∂Δ ln[2sinh(x)] = coth(x) ∂x/∂Δ.</li>
          <li><b>Set ∂F/∂Δ = 0</b> to get the equilibrium relation for Δ(T).</li>
          <li><b>Recognize the sum</b> Σ (ħω/2)coth(ħω/2k<sub>B</sub>T) as the vibrational internal energy (including zero-point), then express Δ in terms of energy density.</li>
          <li><b>Debye link</b>: if ω scales with Θ, then γ = −d ln ω / d ln V = −d ln Θ / d ln V.</li>
        </ol>

        <div class="callout bad" style="margin-top:12px;">
          <div class="tag">Common mistakes</div>
          <ul>
            <li>Dropping the <b>1/2</b>ħω zero-point term and then failing to recover the <b>2sinh</b> form.</li>
            <li>Forgetting the chain rule factor ∂ω/∂Δ = −γω (from δω/ω = −γΔ).</li>
            <li>Mixing energy <b>U</b> (total) with <b>u</b> (energy density). Keep track of whether you divide by volume V.</li>
            <li>Confusing coth(x) with tanh(x). Here: d/dx ln[sinh(x)] = coth(x).</li>
          </ul>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation (before calculating)</h3>
        <p>
          If most phonon frequencies decrease when the crystal expands (γ &gt; 0), then heating increases phonon occupation and
          makes it thermodynamically favorable to expand: we expect Δ(T) to increase with T. The magnitude should be reduced
          by a large bulk modulus B (stiffer materials expand less).
        </p>

        <article>
          <h3>(a) Free energy of one phonon mode</h3>
          <div class="callout math">
            <div class="tag">Mathematical physics setup</div>
            <p>
              We consider a single quantum harmonic oscillator (one normal mode).
              The Hamiltonian operator is
              <span style="font-family:var(--mono);">H = ħω (a†a + 1/2)</span>,
              with eigenstates |n⟩ satisfying <span style="font-family:var(--mono);">a†a |n⟩ = n |n⟩</span> and energies
              <span style="font-family:var(--mono);">E_n = (n + 1/2)ħω</span>.
              No spatial PDE is needed here because the normal-mode reduction already solved the lattice wave eigenvalue problem;
              thermodynamics now uses the discrete spectrum {E<sub>n</sub>}.
            </p>
          </div>

          <p><b>Step 1: Write the partition function.</b></p>
          <p>
            In the canonical ensemble, the partition function is
            <span style="font-family:var(--mono);">Z = Tr(e^{-βH}) = Σ_{n=0}^∞ e^{-β E_n}</span>,
            where β = 1/(k<sub>B</sub>T).
          </p>

          <div class="eq">
<pre data-eq="a1">E_n = (n + 1/2) ħ ω
Z = Σ_{n=0}^{∞} exp[ -β (n + 1/2) ħ ω ]</pre>
            <div class="btnrow">
              <button class="copy" data-copy="E_n = (n + 1/2) ħ ω&#10;Z = Σ_{n=0}^{∞} exp[ -β (n + 1/2) ħ ω ]">Copy</button>
            </div>
          </div>

          <p><b>Step 2: Evaluate the geometric series (showing intermediate steps).</b></p>
          <p>
            Factor out the n-independent term:
          </p>
          <div class="eq">
<pre data-eq="a2">Z = exp(-β ħ ω / 2) * Σ_{n=0}^{∞} [exp(-β ħ ω)]^n</pre>
            <div class="btnrow">
              <button class="copy" data-copy="Z = exp(-β ħ ω / 2) * Σ_{n=0}^{∞} [exp(-β ħ ω)]^n">Copy</button>
            </div>
          </div>
          <p>
            The series converges because exp(−βħω) ∈ (0,1) for T&gt;0 and ω&gt;0. Using
            <span style="font-family:var(--mono);">Σ_{n=0}^{∞} r^n = 1/(1-r)</span> for |r|&lt;1:
          </p>
          <div class="eq">
<pre data-eq="a3">Z = exp(-β ħ ω / 2) / (1 - exp(-β ħ ω))</pre>
            <div class="btnrow">
              <button class="copy" data-copy="Z = exp(-β ħ ω / 2) / (1 - exp(-β ħ ω))">Copy</button>
            </div>
          </div>

          <p><b>Step 3: Rewrite Z using sinh.</b></p>
          <p>
            Multiply numerator and denominator by exp(+βħω/2):
          </p>
          <div class="eq">
<pre data-eq="a4">Z = 1 / ( exp(+βħω/2) - exp(-βħω/2) )
  = 1 / ( 2 sinh(βħω/2) )</pre>
            <div class="btnrow">
              <button class="copy" data-copy="Z = 1 / ( exp(+βħω/2) - exp(-βħω/2) )&#10;  = 1 / ( 2 sinh(βħω/2) )">Copy</button>
            </div>
          </div>

          <p><b>Step 4: Compute the free energy.</b></p>
          <p>
            By definition,
            <span style="font-family:var(--mono);">F = -k_B T ln Z</span>. Therefore:
          </p>
          <div class="eq">
<pre data-eq="a5">F_mode(ω,T) = -k_B T ln Z
            =  k_B T ln[ 2 sinh(β ħ ω / 2) ]
            =  k_B T ln[ 2 sinh( ħ ω / (2 k_B T) ) ]</pre>
            <div class="btnrow">
              <button class="copy" data-copy="F_mode(ω,T) = -k_B T ln Z&#10;            =  k_B T ln[ 2 sinh(β ħ ω / 2) ]&#10;            =  k_B T ln[ 2 sinh( ħ ω / (2 k_B T) ) ]">Copy</button>
            </div>
          </div>

          <div class="callout good">
            <div class="tag">Result (a)</div>
            <div class="eq">
<pre data-eq="a_final">F_mode(ω,T) = k_B T ln[ 2 sinh( ħ ω / (2 k_B T) ) ]</pre>
            </div>
          </div>

          <details>
            <summary>Dimensional check + limiting cases</summary>
            <ul>
              <li><b>Dimensions:</b> argument of sinh is ħω/(k<sub>B</sub>T), dimensionless. ln is dimensionless; multiplied by k<sub>B</sub>T gives energy (J).</li>
              <li><b>T → 0:</b> x = ħω/(2k<sub>B</sub>T) → ∞, sinh(x) ~ (1/2)e^x ⇒ F ~ k<sub>B</sub>T·x = ħω/2 (zero-point energy).</li>
              <li><b>High T:</b> x → 0, sinh(x) ~ x ⇒ F ~ k<sub>B</sub>T ln(2x) = k<sub>B</sub>T ln(ħω/k<sub>B</sub>T) (classical-like free energy up to constants).</li>
            </ul>
          </details>
        </article>

        <article>
          <h3>(b) Minimize the crystal free energy with respect to Δ</h3>

          <div class="callout math">
            <div class="tag">Mathematical model (variables, domain, stability)</div>
            <p>
              We are given a scalar order parameter Δ = δV/V (small). The free energy is a function
              <span style="font-family:var(--mono);">F : (Δ,T) ↦ ℝ</span>, with Δ in a neighborhood of 0.
              At fixed temperature T, equilibrium requires
              <span style="font-family:var(--mono);">∂F/∂Δ = 0</span>.
              Stability requires
              <span style="font-family:var(--mono);">∂²F/∂Δ² &gt; 0</span>.
            </p>
          </div>

          <p><b>Given crystal free energy:</b></p>
          <div class="eq">
<pre data-eq="b0">F(Δ,T) = (1/2) B Δ^2 + k_B T Σ_K ln[ 2 sinh( ħ ω_K(Δ) / (2 k_B T) ) ]</pre>
            <div class="btnrow">
              <button class="copy" data-copy="F(Δ,T) = (1/2) B Δ^2 + k_B T Σ_K ln[ 2 sinh( ħ ω_K(Δ) / (2 k_B T) ) ]">Copy</button>
            </div>
          </div>

          <p><b>Volume dependence (Grüneisen assumption):</b></p>
          <div class="eq">
<pre data-eq="b1">δω/ω = -γ Δ   ⇒   (to linear order)  ∂ω_K/∂Δ = -γ ω_K</pre>
            <div class="btnrow">
              <button class="copy" data-copy="δω/ω = -γ Δ   ⇒   (to linear order)  ∂ω_K/∂Δ = -γ ω_K">Copy</button>
            </div>
          </div>

          <p>
            Here we used the linearization: for small Δ, the fractional change in frequency is proportional to Δ, so the derivative
            exists and equals −γω<sub>K</sub> (mode-independent γ per problem statement).
          </p>

          <h3>Differentiate F with respect to Δ (no “magic jumps”)</h3>
          <p><b>Step 1: Differentiate the elastic part.</b></p>
          <div class="eq">
<pre data-eq="b2">∂/∂Δ [ (1/2) B Δ^2 ] = B Δ</pre>
            <div class="btnrow">
              <button class="copy" data-copy="∂/∂Δ [ (1/2) B Δ^2 ] = B Δ">Copy</button>
            </div>
          </div>

          <p><b>Step 2: Differentiate the phonon sum using the chain rule.</b></p>
          <p>
            Define a dimensionless variable for each mode:
            <span style="font-family:var(--mono);">x_K(Δ,T) = ħ ω_K(Δ) / (2 k_B T)</span>.
            Then each term is ln[2 sinh(x<sub>K</sub>)].
          </p>

          <div class="eq">
<pre data-eq="b3">Let  x_K = ħ ω_K(Δ) / (2 k_B T)

Then:
∂/∂Δ ln[2 sinh(x_K)] = (1 / (2 sinh(x_K))) * 2 cosh(x_K) * (∂x_K/∂Δ)
                     = coth(x_K) * (∂x_K/∂Δ)</pre>
            <div class="btnrow">
              <button class="copy" data-copy="Let  x_K = ħ ω_K(Δ) / (2 k_B T)&#10;&#10;Then:&#10;∂/∂Δ ln[2 sinh(x_K)] = (1 / (2 sinh(x_K))) * 2 cosh(x_K) * (∂x_K/∂Δ)&#10;                     = coth(x_K) * (∂x_K/∂Δ)">Copy</button>
            </div>
          </div>

          <p><b>Step 3: Compute ∂x<sub>K</sub>/∂Δ explicitly.</b></p>
          <p>
            Since T is held fixed when minimizing with respect to Δ, the only Δ-dependence is through ω<sub>K</sub>(Δ):
          </p>
          <div class="eq">
<pre data-eq="b4">x_K = (ħ / (2 k_B T)) ω_K(Δ)

∂x_K/∂Δ = (ħ / (2 k_B T)) (∂ω_K/∂Δ)
        = (ħ / (2 k_B T)) (-γ ω_K)
        = -γ x_K</pre>
            <div class="btnrow">
              <button class="copy" data-copy="x_K = (ħ / (2 k_B T)) ω_K(Δ)&#10;&#10;∂x_K/∂Δ = (ħ / (2 k_B T)) (∂ω_K/∂Δ)&#10;        = (ħ / (2 k_B T)) (-γ ω_K)&#10;        = -γ x_K">Copy</button>
            </div>
          </div>

          <p><b>Step 4: Put it together for the phonon contribution.</b></p>
          <div class="eq">
<pre data-eq="b5">∂/∂Δ [ k_B T Σ_K ln(2 sinh x_K) ]
= k_B T Σ_K [ coth(x_K) (∂x_K/∂Δ) ]
= k_B T Σ_K [ coth(x_K) (-γ x_K) ]
= -γ k_B T Σ_K [ x_K coth(x_K) ]</pre>
            <div class="btnrow">
              <button class="copy" data-copy="∂/∂Δ [ k_B T Σ_K ln(2 sinh x_K) ]&#10;= k_B T Σ_K [ coth(x_K) (∂x_K/∂Δ) ]&#10;= k_B T Σ_K [ coth(x_K) (-γ x_K) ]&#10;= -γ k_B T Σ_K [ x_K coth(x_K) ]">Copy</button>
            </div>
          </div>

          <p>
            Now use x<sub>K</sub> = ħω<sub>K</sub>/(2k<sub>B</sub>T) to simplify:
            <span style="font-family:var(--mono);">k_B T x_K = ħ ω_K / 2</span>.
          </p>
          <div class="eq">
<pre data-eq="b6">-γ k_B T Σ_K [ x_K coth(x_K) ]
= -γ Σ_K [ (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) ) ]</pre>
            <div class="btnrow">
              <button class="copy" data-copy="-γ k_B T Σ_K [ x_K coth(x_K) ]&#10;= -γ Σ_K [ (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) ) ]">Copy</button>
            </div>
          </div>

          <h3>Equilibrium condition</h3>
          <p>
            Differentiate total F and set to zero:
          </p>
          <div class="eq">
<pre data-eq="b7">∂F/∂Δ = BΔ  - γ Σ_K [ (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) ) ] = 0</pre>
            <div class="btnrow">
              <button class="copy" data-copy="∂F/∂Δ = BΔ  - γ Σ_K [ (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) ) ] = 0">Copy</button>
            </div>
          </div>

          <div class="callout good">
            <div class="tag">Result (b): minimizer condition</div>
            <div class="eq">
<pre data-eq="b_final">B Δ = γ Σ_K (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) )</pre>
            </div>
            <div class="btnrow">
              <button class="copy" data-copy="B Δ = γ Σ_K (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) )">Copy</button>
            </div>
          </div>

          <h3>Interpret the sum as vibrational internal energy (and rewrite as energy density)</h3>
          <p>
            A key identity for the quantum oscillator is the average energy:
          </p>
          <div class="eq">
<pre data-eq="bU1">⟨E⟩_K = (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) )
      = (ħ ω_K / 2) + (ħ ω_K) / (exp(ħ ω_K / (k_B T)) - 1)</pre>
            <div class="btnrow">
              <button class="copy" data-copy="⟨E⟩_K = (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) )&#10;      = (ħ ω_K / 2) + (ħ ω_K) / (exp(ħ ω_K / (k_B T)) - 1)">Copy</button>
            </div>
          </div>

          <p>
            Therefore the sum in the minimization condition is precisely the <b>total vibrational energy</b> (including zero-point):
            <span style="font-family:var(--mono);">U_vib(T,Δ) = Σ_K ⟨E⟩_K</span>.
          </p>
          <div class="eq">
<pre data-eq="bU2">U_vib(T,Δ) := Σ_K (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) )

Thus:  B Δ = γ U_vib(T,Δ)</pre>
            <div class="btnrow">
              <button class="copy" data-copy="U_vib(T,Δ) := Σ_K (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) )&#10;&#10;Thus:  B Δ = γ U_vib(T,Δ)">Copy</button>
            </div>
          </div>

          <p>
            To express Δ in terms of an <b>energy density</b>, divide by the crystal volume V. Since B has units J/m³, the natural quantity is
            <span style="font-family:var(--mono);">u_vib(T,Δ) = U_vib(T,Δ)/V</span> [J/m³].
          </p>
          <div class="eq">
<pre data-eq="bU3">u_vib := U_vib / V

Then:  Δ = (γ / B) u_vib</pre>
            <div class="btnrow">
              <button class="copy" data-copy="u_vib := U_vib / V&#10;&#10;Then:  Δ = (γ / B) u_vib">Copy</button>
            </div>
          </div>

          <div class="callout warn">
            <div class="tag">Sanity checks for (b)</div>
            <ul>
              <li><b>Units:</b> BΔ has units of pressure (Pa). γ is dimensionless; U/V is energy density = Pa. Good.</li>
              <li><b>Sign:</b> if γ&gt;0 and u_vib&gt;0, then Δ&gt;0 ⇒ expansion (typical positive thermal expansion materials).</li>
              <li><b>T→0:</b> u_vib includes zero-point energy; depending on reference state, this can be absorbed into the definition of “zero-pressure equilibrium volume.” The problem note emphasizes keeping it to obtain the compact form.</li>
            </ul>
          </div>

          <details>
            <summary>Stability (why it is a minimum)</summary>
            <p>
              The elastic part contributes ∂²/∂Δ² (1/2 BΔ²) = B &gt; 0.
              The phonon term adds additional curvature that is typically positive in the quasi-harmonic regime for small Δ.
              So near equilibrium the total second derivative remains positive, confirming a minimum.
            </p>
          </details>
        </article>

        <article>
          <h3>(c) Debye model relation: γ = − d ln Θ / d ln V</h3>

          <div class="callout math">
            <div class="tag">Scaling / nondimensionalization viewpoint</div>
            <p>
              In the Debye model, the phonon spectrum is characterized by a single cutoff frequency ω<sub>D</sub>,
              or equivalently the Debye temperature Θ defined by
              <span style="font-family:var(--mono);">k_B Θ = ħ ω_D</span>.
              If all mode frequencies scale with ω<sub>D</sub>, then taking a log-derivative of any representative ω yields the same scaling.
            </p>
          </div>

          <p>
            Start from the Grüneisen definition for a mode:
          </p>
          <div class="eq">
<pre data-eq="c1">γ := - d(ln ω) / d(ln V)</pre>
            <div class="btnrow">
              <button class="copy" data-copy="γ := - d(ln ω) / d(ln V)">Copy</button>
            </div>
          </div>

          <p>
            (This is the differential version of δω/ω = −γ δV/V. Note Δ = δV/V, so δ ln V = δV/V = Δ.)
            In the Debye model, ω scales with ω<sub>D</sub>, and Θ is proportional to ω<sub>D</sub>:
          </p>
          <div class="eq">
<pre data-eq="c2">Θ ∝ ω_D  and  typical ω ∝ ω_D  ⇒  ln ω = ln Θ + constant</pre>
            <div class="btnrow">
              <button class="copy" data-copy="Θ ∝ ω_D  and  typical ω ∝ ω_D  ⇒  ln ω = ln Θ + constant">Copy</button>
            </div>
          </div>

          <p>
            Taking derivatives with respect to ln V, the constant drops out:
          </p>
          <div class="eq">
<pre data-eq="c3">d(ln ω)/d(ln V) = d(ln Θ)/d(ln V)</pre>
            <div class="btnrow">
              <button class="copy" data-copy="d(ln ω)/d(ln V) = d(ln Θ)/d(ln V)">Copy</button>
            </div>
          </div>

          <div class="callout good">
            <div class="tag">Result (c)</div>
            <div class="eq">
<pre data-eq="c_final">γ = - d(ln Θ)/d(ln V)</pre>
            </div>
            <div class="btnrow">
              <button class="copy" data-copy="γ = - d(ln Θ)/d(ln V)">Copy</button>
            </div>
          </div>
        </article>

        <div class="kbox" style="margin-top:12px;">
          <h3 style="margin:0 0 8px;">Final Answer (All parts)</h3>
          <div class="eq">
<pre id="finalAnswerText">(
a) For one phonon mode (quantum harmonic oscillator),
    F_mode(ω,T) = k_B T ln[ 2 sinh( ħ ω / (2 k_B T) ) ].

(b) With F(Δ,T) = (1/2)BΔ^2 + k_B T Σ_K ln[2 sinh( ħ ω_K(Δ) / (2 k_B T) )]
    and δω/ω = -γΔ (γ mode-independent), the equilibrium Δ minimizes F and satisfies
    B Δ = γ Σ_K (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) ).
    Recognizing U_vib = Σ_K (ħ ω_K / 2) coth( ħ ω_K / (2 k_B T) ),
    we get BΔ = γ U_vib. In terms of vibrational energy density u_vib = U_vib/V:
    Δ = (γ/B) u_vib.

(c) In the Debye model (single frequency scale Θ), γ = - d ln Θ / d ln V.
)</pre>
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-target="#finalAnswerText">Copy final answer (plain text)</button>
          </div>
        </div>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpret the final formula</h3>
        <p>
          The equilibrium condition can be read as a balance of “pressures”:
          the elastic restoring “pressure” scale BΔ is balanced by a phonon-induced thermoelastic drive γ(u<sub>vib</sub>).
          In many texts this is a stepping stone toward the classic Grüneisen relation for thermal expansion coefficient α:
          <span style="font-family:var(--mono);">α ∝ γ C_V / (B V)</span> (up to geometric factors), showing why γ and B are core material parameters.
        </p>

        <div class="grid2">
          <div class="callout">
            <div class="tag">Parameter dependence (qualitative)</div>
            <ul>
              <li><b>Larger γ</b> → stronger coupling → larger expansion |Δ| for a given energy density.</li>
              <li><b>Larger B</b> (stiffer solid) → smaller Δ.</li>
              <li><b>Higher T</b> → higher phonon energy density u → larger Δ (typically).</li>
              <li><b>Mode dependence γ<sub>K</sub></b> (real materials) → some modes dominate expansion (e.g., soft modes).</li>
            </ul>
          </div>

          <div class="callout math">
            <div class="tag">Alternative derivation idea (brief)</div>
            <p>
              Instead of minimizing F, you can compute the phonon pressure from
              <span style="font-family:var(--mono);">P_ph = - (∂F_ph/∂V)_T</span>,
              then solve mechanical equilibrium
              <span style="font-family:var(--mono);">P_el + P_ph = 0</span>
              with <span style="font-family:var(--mono);">P_el ≈ -BΔ</span>.
              Using ω(V) and the chain rule reproduces the same coth expression.
            </p>
          </div>
        </div>

        <details>
          <summary>Limiting-case asymptotics (useful expansions)</summary>
          <p><b>Low T (x = ħω/(2kBT) ≫ 1):</b> coth(x) ≈ 1 + 2e<sup>−2x</sup>. Then ⟨E⟩ ≈ ħω/2 (plus exponentially small thermal correction).</p>
          <p><b>High T (x ≪ 1):</b> coth(x) ≈ 1/x + x/3 + …, so ⟨E⟩ = (ħω/2)coth(x) ≈ k_BT + (ħω)^2/(12 k_BT) + …</p>
          <p>
            In the classical limit, energy per mode tends to k<sub>B</sub>T, making u<sub>vib</sub> scale ∝ T, hence Δ ∝ T (roughly), consistent with many solids over moderate ranges.
          </p>
        </details>

        <div class="callout math" style="margin-top:12px;">
          <div class="tag">Math Insight</div>
          <p>
            The function <span style="font-family:var(--mono);">f(x)=ln[2sinh(x)]</span> is convex for x&gt;0 because
            <span style="font-family:var(--mono);">f''(x)=1/sinh^2(x) &gt; 0</span>.
            This convexity supports the existence of a unique minimizer in Δ when combined with the strictly convex quadratic elastic term.
          </p>
        </div>

        <h3>Concept check (self-test with answers)</h3>
        <ul>
          <li><b>Q:</b> Why must the zero-point energy be retained in (a)? <b>A:</b> Because it changes Z by a prefactor exp(−βħω/2), leading to the compact 1/(2sinh(βħω/2)) form; without it, the algebra yields a different-looking expression.</li>
          <li><b>Q:</b> What mathematical step turns ln[sinh(x)] into coth(x)? <b>A:</b> Differentiate: d/dx ln(sinh x) = cosh x / sinh x = coth x.</li>
          <li><b>Q:</b> What does γ&gt;0 mean physically? <b>A:</b> Increasing volume lowers phonon frequencies on average.</li>
          <li><b>Q:</b> Why does B appear in the denominator of Δ? <b>A:</b> B measures stiffness; larger B penalizes strain more strongly in F.</li>
          <li><b>Q:</b> In the Debye model, why can ω and Θ be interchanged in the log derivative? <b>A:</b> They differ only by a constant factor (k<sub>B</sub>/ħ), whose log-derivative is zero.</li>
        </ul>

        <a class="backtop" href="#top">Back to top ↑</a>
      </section>

      <section id="part5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <div class="callout">
          <div class="tag">No plot included</div>
          <p>
            This problem is primarily <b>symbolic</b>: the key outcomes are closed-form formulas involving sinh/coth and a minimization condition.
            A plot would require choosing specific phonon spectra or material parameters; that can be useful in applications, but it’s not necessary
            to understand or verify the derivations requested here.
          </p>
        </div>
        <a class="backtop" href="#top">Back to top ↑</a>
      </section>
    </main>
  </div>

  <footer>
    <p>
      Notes on scope: This derivation uses the quasi-harmonic approximation and assumes ω is temperature-independent in part (a), and γ is mode-independent in part (b).
      Real materials can have strong mode dependence γ<sub>K</sub>, and ω(T) may vary due to anharmonicity.
    </p>
  </footer>

  <script>
    (function(){
      function copyText(text){
        if(!text) return;
        navigator.clipboard.writeText(text).then(()=>toast("Copied!")).catch(()=>toast("Copy failed"));
      }

      function toast(msg){
        let t = document.getElementById("toast");
        if(!t){
          t = document.createElement("div");
          t.id = "toast";
          t.style.position = "fixed";
          t.style.left = "50%";
          t.style.bottom = "18px";
          t.style.transform = "translateX(-50%)";
          t.style.padding = "10px 12px";
          t.style.borderRadius = "999px";
          t.style.background = "rgba(0,0,0,0.65)";
          t.style.border = "1px solid rgba(255,255,255,0.16)";
          t.style.color = "rgba(255,255,255,0.92)";
          t.style.fontSize = "13px";
          t.style.boxShadow = "0 10px 22px rgba(0,0,0,0.35)";
          t.style.zIndex = "9999";
          t.style.opacity = "0";
          t.style.transition = "opacity 160ms ease, transform 160ms ease";
          document.body.appendChild(t);
        }
        t.textContent = msg;
        t.style.opacity = "1";
        t.style.transform = "translateX(-50%) translateY(-2px)";
        clearTimeout(window.__toastTimer);
        window.__toastTimer = setTimeout(()=>{
          t.style.opacity = "0";
          t.style.transform = "translateX(-50%) translateY(0px)";
        }, 1100);
      }

      document.addEventListener("click", function(e){
        const btn = e.target.closest("button.copy");
        if(!btn) return;

        const targetSel = btn.getAttribute("data-copy-target");
        if(targetSel){
          const el = document.querySelector(targetSel);
          if(el){
            copyText(el.innerText.replace(/\n+$/,""));
          }
          return;
        }

        const txt = btn.getAttribute("data-copy");
        if(txt){
          // decode minimal HTML entities if any were inserted
          const ta = document.createElement("textarea");
          ta.innerHTML = txt;
          copyText(ta.value);
        }
      });
    })();
  </script>
</body>
</html>
