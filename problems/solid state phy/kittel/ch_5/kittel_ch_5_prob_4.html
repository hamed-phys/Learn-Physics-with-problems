<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#0b0f17" />
  <title>Heat Capacity of a Layer Lattice (Debye): Why C ∝ T² in 2D and What Happens with Weak Interlayer Coupling</title>
  <style>
    :root{
      --bg: #0b0f17;
      --panel:#111a2b;
      --panel2:#0f1626;
      --text:#e8eefc;
      --muted:#b6c2e2;
      --faint:#7f8bb0;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line: rgba(255,255,255,.10);
      --shadow: 0 18px 60px rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --serif: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
      --max: 1120px;
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8ff;
        --panel:#ffffff;
        --panel2:#f1f5ff;
        --text:#0b1220;
        --muted:#2a3858;
        --faint:#56658a;
        --accent:#0369a1;
        --accent2:#6d28d9;
        --line: rgba(12,18,32,.12);
        --shadow: 0 18px 60px rgba(2,8,23,.12);
      }
    }

    *{ box-sizing:border-box; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family: var(--sans);
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(125,211,252,.12), transparent 55%),
        radial-gradient(900px 520px at 90% 0%, rgba(167,139,250,.12), transparent 50%),
        radial-gradient(1200px 700px at 30% 110%, rgba(52,211,153,.08), transparent 55%),
        var(--bg);
      color: var(--text);
      line-height:1.6;
    }

    header{
      padding: 28px 18px 12px;
      position:relative;
    }
    .wrap{ max-width: var(--max); margin:0 auto; }
    .hero{
      background: linear-gradient(135deg, rgba(125,211,252,.10), rgba(167,139,250,.10));
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 22px 20px;
      overflow:hidden;
      position:relative;
    }
    .hero:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(900px 280px at 25% 10%, rgba(125,211,252,.20), transparent 55%),
                  radial-gradient(700px 260px at 80% 20%, rgba(167,139,250,.18), transparent 55%);
      filter: blur(18px);
      opacity:.65;
      pointer-events:none;
    }
    .hero > *{ position:relative; z-index:1; }

    h1{
      margin: 0 0 10px;
      font-size: clamp(1.35rem, 2.6vw, 2.05rem);
      line-height:1.15;
      letter-spacing:.2px;
    }
    .subtitle{
      margin:0;
      color: var(--muted);
      font-size: clamp(.95rem, 1.4vw, 1.05rem);
    }
    .meta{
      margin-top: 12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      color: var(--faint);
      font-size:.92rem;
    }
    .pill{
      border:1px solid var(--line);
      border-radius: 999px;
      padding: 6px 10px;
      background: rgba(255,255,255,.04);
      backdrop-filter: blur(10px);
    }

    main{
      padding: 12px 18px 56px;
    }

    .layout{
      display:grid;
      grid-template-columns: 1fr 300px;
      gap: 18px;
      align-items:start;
    }

    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; }
    }

    nav.toc{
      position: sticky;
      top: 12px;
      align-self:start;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 12px 12px 10px;
      max-height: calc(100vh - 24px);
      overflow:auto;
    }
    nav.toc h2{
      margin: 0 0 8px;
      font-size: 1.02rem;
      letter-spacing:.2px;
    }
    nav.toc a{
      display:block;
      padding: 7px 10px;
      border-radius: 10px;
      text-decoration:none;
      color: var(--muted);
      border:1px solid transparent;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
      font-size:.94rem;
    }
    nav.toc a:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.25);
      color: var(--text);
      transform: translateX(2px);
    }

    article{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    section{
      padding: 18px 18px;
      border-top:1px solid var(--line);
    }
    section:first-child{ border-top:none; }
    section h2{
      margin: 0 0 10px;
      font-size: 1.25rem;
      letter-spacing:.2px;
    }
    section h3{
      margin: 14px 0 8px;
      font-size: 1.08rem;
      color: var(--text);
    }
    p{ margin: 10px 0; color: var(--muted); }
    ul, ol{ margin: 8px 0 10px 18px; color: var(--muted); }
    li{ margin: 6px 0; }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 780px){
      .grid2{ grid-template-columns: 1fr; }
    }

    .callout{
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.035);
      padding: 12px 12px;
      margin: 10px 0;
      position:relative;
      overflow:hidden;
    }
    .callout:before{
      content:"";
      position:absolute;
      left:0; top:0; bottom:0;
      width:4px;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      opacity:.9;
    }
    .callout h4{
      margin:0 0 6px;
      font-size: .98rem;
      color: var(--text);
      letter-spacing:.2px;
    }
    .callout p, .callout li{ color: var(--muted); }

    .callout.assump:before{ background: linear-gradient(180deg, var(--warn), var(--accent)); }
    .callout.mistakes:before{ background: linear-gradient(180deg, var(--bad), var(--warn)); }
    .callout.final:before{ background: linear-gradient(180deg, var(--ok), var(--accent)); }
    .callout.math:before{ background: linear-gradient(180deg, var(--accent2), var(--accent)); }

    .eq{
      font-family: var(--mono);
      font-size: .93rem;
      color: var(--text);
      background: rgba(0,0,0,.18);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px 10px;
      overflow:auto;
      position:relative;
    }
    .eq .label{
      display:inline-block;
      font-family: var(--sans);
      font-size: .78rem;
      color: var(--faint);
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      border-radius: 999px;
      padding: 3px 8px;
      margin-bottom: 8px;
    }

    .btnrow{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top: 8px;
    }
    button.copy{
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-size:.9rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.25);
    }
    button.copy:active{ transform: translateY(0px) scale(.99); }
    .toast{
      position: fixed;
      right: 14px;
      bottom: 14px;
      background: rgba(0,0,0,.70);
      color: white;
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
      opacity:0;
      transform: translateY(10px);
      transition: opacity .18s ease, transform .18s ease;
      pointer-events:none;
      font-size:.92rem;
      max-width: 280px;
      z-index: 999;
    }
    .toast.show{ opacity:1; transform: translateY(0); }

    details{
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.03);
      padding: 10px 12px;
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight:600;
      letter-spacing:.15px;
    }
    details p{ margin-top: 8px; }

    figure{
      margin: 12px 0 4px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.12);
      border-radius: var(--radius2);
      padding: 10px;
      overflow:hidden;
    }
    figcaption{
      color: var(--faint);
      font-size:.9rem;
      margin-top:8px;
    }
    canvas{ width:100%; height: 320px; display:block; }
    @media (max-width: 520px){
      canvas{ height: 280px; }
    }

    .toplink{
      display:inline-block;
      margin-top: 10px;
      text-decoration:none;
      color: var(--accent);
      border-bottom: 1px dashed rgba(125,211,252,.45);
      padding-bottom:2px;
    }

    footer{
      padding: 14px 18px 30px;
      color: var(--faint);
      text-align:center;
      font-size:.92rem;
    }

    /* Print-friendly */
    @media print{
      body{ background:white; color:black; }
      nav.toc{ display:none; }
      .hero, article, section, .callout, .eq, figure, details{
        box-shadow:none !important;
        background:white !important;
        border-color:#d7d7d7 !important;
      }
      .pill{ background:white !important; }
      button.copy{ display:none; }
      .toast{ display:none; }
      a{ color:black; text-decoration: underline; }
      section{ break-inside: avoid; }
      figure{ break-inside: avoid; }
      h2{ break-after: avoid; }
    }
  </style>
</head>

<body>
  <header id="top">
    <div class="wrap">
      <div class="hero">
        <h1>Heat Capacity of a Layer Lattice: Debye Scaling in 2D (C ∝ T²) and the Weak-Coupling Crossover</h1>
        <p class="subtitle">
          We treat phonons as quantized elastic waves. Confining motion to planes changes the density of states, which changes the low-temperature power law.
        </p>
        <div class="meta">
          <span class="pill">Topic: Phonons • Debye model • Density of states</span>
          <span class="pill">Key result: 2D → C ~ T²; weak 3D coupling → asymptotically C ~ T³</span>
          <span class="pill">Lens: Applied physics & industrial engineering relevance</span>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap layout">
      <article>
        <!-- Quick Summary -->
        <section id="quick-summary">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this problem is about:</strong> How the <em>phonon</em> heat capacity of a layered dielectric scales at low temperature, using the Debye approximation.</li>
            <li><strong>Key physics idea:</strong> Low-T heat capacity is controlled by the <em>low-frequency</em> phonon density of states (DOS). Dimensionality changes DOS.</li>
            <li><strong>Governing structure:</strong> Elastic-wave eigenmodes (PDE) → dispersion relation ω(k) → DOS g(ω) → internal energy U(T) → C = dU/dT.</li>
            <li><strong>Core formula:</strong> U = ∫₀^{ωD} g(ω) (ħω)/(e^{ħω/kBT} − 1) dω.</li>
            <li><strong>Main result (a):</strong> For motion restricted to each layer (effectively 2D phonons), g(ω) ∝ ω → U ∝ T³ → <strong>C ∝ T²</strong>.</li>
            <li><strong>Main result (b):</strong> If adjacent layers are weakly but nonzero coupled, the dispersion becomes anisotropic 3D: ω² ≈ v∥²k∥² + v⊥²kz². As T → 0, the DOS returns to g(ω) ∝ ω² → <strong>C ∝ T³</strong>, with a crossover scale T× ~ (ħ/kB)(v⊥π/d).</li>
            <li><strong>Physical meaning:</strong> Confinement lowers the number of low-energy modes; coupling in the third direction restores additional low-energy modes at sufficiently long wavelengths.</li>
            <li><strong>Industrial relevance:</strong> Low-T thermal management in multilayer crystals, van der Waals stacks, thin-film dielectrics, and cryogenic devices is sensitive to whether transport is 2D-like or 3D-like.</li>
          </ul>

          <div class="callout final">
            <h4>Final Results (power laws)</h4>
            <div class="eq" data-copy="(a) Layer-confined (2D) Debye phonons: C ∝ T^2.\n(b) Weakly coupled layers (anisotropic 3D): as T→0, C ∝ T^3; for T× ≪ T ≪ ΘD, often an extended quasi-2D regime gives C ∝ T^2.\nCrossover scale: T× ~ (ħ/kB)(v⊥π/d).">
              <span class="label">Copy-ready</span><br/>
              (a) C ~ const · T²  (2D Debye)<br/>
              (b) T → 0: C ~ const · T³  (3D restored if coupling ≠ 0)<br/>
              Crossover: T× ~ (ħ/kB)(v⊥π/d)
            </div>
            <div class="btnrow">
              <button class="copy" data-copy-target=".callout.final .eq">Copy plain-text result</button>
              <button class="copy" data-copy-id="finalAnswer">Copy final answer (plain text)</button>
            </div>
          </div>
        </section>

        <!-- PART 0 -->
        <section id="part-0">
          <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

          <h3>0.1 Core definitions (symbols + SI units)</h3>
          <ul>
            <li><strong>T</strong> = temperature (K)</li>
            <li><strong>kB</strong> = Boltzmann constant (J·K⁻¹)</li>
            <li><strong>ħ</strong> = reduced Planck constant (J·s)</li>
            <li><strong>ω</strong> = phonon angular frequency (rad·s⁻¹)</li>
            <li><strong>k</strong> = wavevector (m⁻¹); in layers use k∥ = (kx, ky), kz (m⁻¹)</li>
            <li><strong>g(ω)</strong> = phonon density of states (states per rad·s⁻¹)</li>
            <li><strong>U(T)</strong> = internal energy of phonons (J)</li>
            <li><strong>C</strong> = heat capacity at constant volume (J·K⁻¹)</li>
            <li><strong>v</strong> = sound speed (m·s⁻¹); in anisotropic stacks: v∥, v⊥</li>
            <li><strong>d</strong> = interlayer spacing (m)</li>
            <li><strong>ωD</strong>, <strong>ΘD</strong> = Debye cutoff frequency and temperature (ΘD = ħωD/kB)</li>
          </ul>

          <h3>0.2 What key quantities mean physically</h3>
          <ul>
            <li><strong>Phonons</strong> are quantized normal modes of lattice vibrations. At low T, only long-wavelength (small |k|) acoustic modes are excited.</li>
            <li><strong>Density of states g(ω)</strong> counts how many modes exist in a small frequency interval [ω, ω + dω]. More low-ω modes → larger low-T heat capacity.</li>
            <li><strong>Debye model</strong> replaces the real dispersion by a linear one ω ≈ v|k| for acoustic branches and sets a cutoff to match the number of modes.</li>
          </ul>

          <h3>0.3 Key laws/principles & validity conditions</h3>
          <div class="grid2">
            <div class="callout assump">
              <h4>Debye approximation: when it’s valid</h4>
              <ul>
                <li>Low T: kBT ≪ ħωD (only acoustic region matters).</li>
                <li>Continuum elastic limit: wavelengths ≫ lattice spacing.</li>
                <li>Harmonic lattice: phonons non-interacting (anharmonicity neglected for C at low T).</li>
              </ul>
            </div>
            <div class="callout">
              <h4>Statistical mechanics backbone</h4>
              <ul>
                <li>Each mode is a quantum harmonic oscillator with Bose–Einstein occupation.</li>
                <li>Mean energy per mode: ⟨E⟩ = ħω(nB + 1/2), where nB = 1/(e^{ħω/kBT} − 1).</li>
                <li>Heat capacity uses the thermal part only; zero-point energy drops out upon d/dT.</li>
              </ul>
            </div>
          </div>

          <h3>0.4 Common models/approximations used here</h3>
          <ul>
            <li><strong>Isotropic 2D acoustic dispersion (part a):</strong> ω = v|k∥| with k∥ ∈ ℝ².</li>
            <li><strong>Anisotropic 3D acoustic dispersion (part b):</strong> ω² = v∥²|k∥|² + v⊥²kz², with v⊥ ≪ v∥ for weak interlayer binding.</li>
            <li><strong>Low-T extension of the integral limit:</strong> if T ≪ ΘD, we may replace the upper limit ωD by ∞ because the Bose factor cuts off integrand exponentially for ħω ≫ kBT.</li>
          </ul>

          <h3>0.5 Mini intuition examples (quick)</h3>
          <ul>
            <li><strong>3D crystal:</strong> g(ω) ∝ ω² → C ∝ T³ (famous Debye law).</li>
            <li><strong>2D membrane-like solid:</strong> g(ω) ∝ ω → C ∝ T².</li>
            <li><strong>1D chain:</strong> g(ω) ∝ ω⁰ → C ∝ T.</li>
          </ul>

          <h3>0.6 What to watch for (pitfalls)</h3>
          <ul>
            <li>Confusing <em>atomic layering</em> with <em>phonon dimensionality</em>: confinement of motion changes k-space dimension.</li>
            <li>For weakly coupled layers, the <em>asymptotic</em> T → 0 behavior is controlled by whether kz is continuous (3D) or absent (strict 2D).</li>
            <li>Dropping constants too early: power-law scaling is robust, but the derivation must track why g(ω) changes with dimension.</li>
          </ul>
          <a class="toplink" href="#top">Back to top</a>
        </section>

        <!-- PART 0B -->
        <section id="part-0b">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>
          <p>
            Layered dielectrics show up everywhere—from thin-film stacks in electronics to van der Waals crystals and thermal barrier coatings.
            The low-temperature heat capacity matters because it sets how fast components warm up/cool down and how much thermal noise/energy storage exists.
          </p>

          <h3>Where this phenomenon appears (3+ concrete areas)</h3>
          <ul>
            <li><strong>Cryogenic sensors & quantum tech:</strong> substrates and multilayer dielectrics in superconducting circuits, resonators, and qubit packaging.</li>
            <li><strong>Thin-film MEMS/NEMS:</strong> layered beams/membranes where vibrations are effectively 2D at relevant wavelengths.</li>
            <li><strong>Thermal management in microelectronics:</strong> multilayer stacks (SiO₂/SiN/AlN, etc.) where anisotropic phonon properties affect heat spreading.</li>
            <li><strong>2D materials & heterostructures:</strong> graphene/hBN/TMD stacks with weak interlayer van der Waals coupling.</li>
          </ul>

          <h3>Why engineers care (performance, safety, cost)</h3>
          <ul>
            <li><strong>Performance:</strong> C(T) sets transient thermal response and temperature stabilization time constants.</li>
            <li><strong>Reliability:</strong> thermal cycling and gradients depend on how quickly energy can be stored and redistributed.</li>
            <li><strong>Efficiency:</strong> in cryogenic systems, minimizing parasitic heat loads requires knowing how much heat is absorbed for a given temperature rise.</li>
            <li><strong>Manufacturability:</strong> weak bonding (porosity, imperfect interfaces) can create quasi-2D phonon behavior over a wide T range.</li>
          </ul>

          <h3>Typical measurement/validation methods</h3>
          <ul>
            <li><strong>Calorimetry</strong> (relaxation or AC calorimetry) to measure C(T) power laws.</li>
            <li><strong>Brillouin/Raman scattering</strong> to infer acoustic velocities and anisotropy.</li>
            <li><strong>Time-domain thermoreflectance (TDTR)</strong> for anisotropic thermal transport; combined with models to constrain phonon parameters.</li>
          </ul>

          <h3>Design trade-offs & constraints</h3>
          <ul>
            <li><strong>Weak coupling helps isolation</strong> (lower cross-plane conduction) but can enlarge low-T energy storage if many low-ω modes appear with large prefactor.</li>
            <li><strong>Interfaces</strong> introduce scattering and may modify the effective dispersion and DOS (non-idealities beyond Debye).</li>
            <li><strong>Finite size</strong> can quantize kz and produce additional crossovers at very low T if thickness is small.</li>
          </ul>

          <div class="callout">
            <h4>From lab to product</h4>
            <p>
              In real stacks, engineers often use an <em>effective</em> anisotropic Debye model (different v∥ and v⊥) plus interface/defect corrections.
              The key is recognizing which power law (T² vs T³) dominates in the actual temperature window of operation and over the relevant device dimensions.
            </p>
          </div>
          <a class="toplink" href="#top">Back to top</a>
        </section>

        <!-- PART 1 -->
        <section id="part-1">
          <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

          <h3>1.1 Restate the problem</h3>
          <p>
            We have a dielectric crystal built from atomic layers. In part (a), rigid coupling between layers restricts atomic motion to each layer’s plane (so phonons are effectively 2D).
            Show that in the Debye approximation the low-T phonon heat capacity is proportional to T².
            In part (b), assume instead adjacent layers are very weakly bound. Predict how the heat capacity behaves at extremely low temperatures.
          </p>

          <h3>1.2 Given, unknowns, and what must be proved</h3>
          <ul>
            <li><strong>Given:</strong> layered lattice; Debye approximation; low-temperature limit.</li>
            <li><strong>Unknowns:</strong> temperature scaling of phonon heat capacity C(T) in cases (a) and (b).</li>
            <li><strong>Must show/prove:</strong> (a) C ∝ T²; (b) expected asymptotic form at extremely low T for weakly coupled layers.</li>
          </ul>

          <h3>1.3 Relevant principles and why they apply</h3>
          <ul>
            <li><strong>Elastic-wave PDE → normal modes:</strong> in the long-wavelength limit, lattice vibrations satisfy linear elastic equations (harmonic approximation).</li>
            <li><strong>Quantization:</strong> each normal mode is a harmonic oscillator → Bose–Einstein statistics.</li>
            <li><strong>Debye DOS:</strong> replace dispersion by acoustic linear ω ~ v|k| and count modes in k-space; dimensionality is the key.</li>
          </ul>
          <p>
            We do <em>not</em> need detailed crystal structure, optical phonons, or anharmonic corrections, because low-T C is dominated by acoustic modes near ω = 0.
          </p>

          <div class="callout assump">
            <h4>Assumptions (explicit)</h4>
            <ul>
              <li>Harmonic lattice (linearized displacements; superposition holds).</li>
              <li>Continuum limit for acoustic modes: wavelengths ≫ lattice spacing.</li>
              <li>(a) Strict in-plane motion: displacement field u(x,y,t) only, no z degree of freedom.</li>
              <li>(b) Weak but nonzero interlayer coupling: kz becomes a continuous variable (in a bulk stack), but with small velocity v⊥.</li>
              <li>Low temperature: T ≪ ΘD so only small ω contribute significantly.</li>
            </ul>
          </div>

          <h3>1.4 Possible approaches (2–3) and comparison</h3>
          <ul>
            <li><strong>Approach A (DOS scaling):</strong> derive g(ω) in d dimensions from k-space volume; then scale U(T) and C(T). <em>Fastest and most transparent</em> for power-law results.</li>
            <li><strong>Approach B (partition function of continuum field):</strong> treat displacement field as a set of Fourier modes; compute free energy F and then C. <em>More formal</em> and connects directly to PDE/eigenmodes.</li>
            <li><strong>Approach C (dimensional analysis / scaling):</strong> use ω~vk and thermal wavevector kT~kBT/(ħv) to estimate energy density scaling. <em>Quick intuition</em>, but less rigorous without explicit integrals.</li>
          </ul>

          <h3>1.5 Chosen approach</h3>
          <p>
            We use <strong>Approach A</strong> as the main line (clear derivation of T²), supported by the <strong>field-eigenmode</strong> viewpoint to satisfy the mathematical physics rigor.
          </p>
          <a class="toplink" href="#top">Back to top</a>
        </section>

        <!-- PART 2 -->
        <section id="part-2">
          <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>
          <ol>
            <li><strong>Model the lattice as an elastic continuum</strong> in the appropriate dimension (2D for part a; anisotropic 3D for part b).</li>
            <li><strong>Write the linear elastic wave equation</strong> (PDE) and argue that plane waves are eigenfunctions by translation symmetry.</li>
            <li><strong>Extract the acoustic dispersion</strong> ω = v|k| (2D) or ω² = v∥²k∥² + v⊥²kz² (anisotropic 3D).</li>
            <li><strong>Count modes in k-space</strong> to obtain the density of states g(ω) (key dimensional step).</li>
            <li><strong>Compute internal energy</strong> U(T) = ∫ g(ω) ħω nB(ω,T) dω (drop zero-point term for C).</li>
            <li><strong>Low-T simplification:</strong> extend upper limit to ∞ and nondimensionalize x = ħω/(kBT).</li>
            <li><strong>Evaluate scaling</strong> using standard integrals ∫₀^∞ x^m/(e^x−1) dx = Γ(m+1)ζ(m+1).</li>
            <li><strong>Differentiate U(T)</strong> to obtain C(T) and read off the power law.</li>
            <li><strong>For weak coupling:</strong> show there is a crossover frequency ω× ~ v⊥π/d; infer low-T asymptote.</li>
          </ol>

          <div class="callout mistakes">
            <h4>Common mistakes (quick tips)</h4>
            <ul>
              <li>Mixing up “2D material” with “2D phonons”: the DOS power depends on how many components of k are continuous for acoustic modes.</li>
              <li>For (b) claiming “still T²” at T→0: if coupling is nonzero in a bulk stack, kz contributes at sufficiently small ω.</li>
              <li>Forgetting the Bose factor: low-T behavior comes from ħω ~ kBT, not from ωD.</li>
            </ul>
          </div>
          <a class="toplink" href="#top">Back to top</a>
        </section>

        <!-- PART 3 -->
        <section id="part-3">
          <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

          <h3>3.1 Qualitative expectation (before calculating)</h3>
          <p>
            At low T, only long-wavelength acoustic phonons are thermally excited. The crucial question is:
            <em>how many independent wavevector components label those modes?</em>
            If motion is confined to planes, the relevant k-space is 2D, so the number of modes below ω grows like ω², giving g(ω) ~ d/dω(ω²) ~ ω and thus C ~ T².
            If layers are weakly coupled, kz re-enters at very small ω, restoring 3D counting and C ~ T³ as T → 0.
          </p>

          <h3>3.2 Mathematical model (variables, domain, operators, boundary conditions)</h3>
          <div class="callout math">
            <h4>Mathematical model (continuum elastic field)</h4>
            <p>
              We describe lattice vibrations by a displacement field <strong>u</strong>(r,t).
              In a continuum harmonic approximation, the equation of motion is linear and translation invariant.
            </p>
            <div class="eq" data-copy="(General 3D isotropic elastic PDE)\nρ ∂^2 u/∂t^2 = (λ+μ) ∇(∇·u) + μ ∇^2 u.\n\n(2D layer-confined version, r=(x,y), ∇= (∂x,∂y)):\nρ2D ∂^2 u/∂t^2 = (λ2D+μ2D) ∇(∇·u) + μ2D ∇^2 u.\n\n(Anisotropic layered stack idea): choose coordinates r=(x,y,z), with different stiffness along z, giving acoustic dispersion ω^2 ≈ v∥^2(kx^2+ky^2) + v⊥^2 kz^2 for small k.">
              <span class="label">Key PDE / operator form (copy-ready)</span><br/>
              (3D isotropic) ρ ∂²u/∂t² = (λ+μ) ∇(∇·u) + μ ∇²u<br/><br/>
              (2D in-layer) ρ₂D ∂²u/∂t² = (λ₂D+μ₂D) ∇(∇·u) + μ₂D ∇²u, with ∇=(∂x,∂y)<br/><br/>
              (Weakly coupled layers → anisotropic) ω² ≈ v∥²(kx²+ky²) + v⊥²kz² (small k)
            </div>
            <p>
              <strong>Domain:</strong> (a) a large layer of area A, coordinates r=(x,y) ∈ ℝ² (periodic boundary conditions on a large box are a standard counting device).
              (b) a bulk stack with volume V = A·Lz, r=(x,y,z) ∈ ℝ³, again using periodic boundaries to discretize k then take the continuum limit.
              The choice of boundary conditions does not affect the low-T power law (it changes only discrete spacing / prefactors).
            </p>
          </div>

          <h3>3.3 From PDE to dispersion (why plane waves work)</h3>
          <p>
            Because the PDE is <strong>linear</strong> and has <strong>constant coefficients</strong> (homogeneous medium), it is invariant under translations.
            Therefore eigenfunctions can be taken as plane waves via Fourier decomposition:
          </p>
          <div class="eq" data-copy="Plane-wave ansatz:\nu(r,t) = ε exp[i(k·r − ωt)].\n\nThen ∂/∂t → −iω, and ∇ → i k, so\n∇·u = i k·ε e^{i(...)},\n∇(∇·u) = i k (i k·ε) e^{i(...)} = − k (k·ε) e^{i(...)},\n∇^2 u = −k^2 ε e^{i(...)}.\n\nSubstitution into ρ ∂^2u/∂t^2 = (λ+μ)∇(∇·u)+μ∇^2u yields the eigenvalue problem for ε and ω.">
            <span class="label">Fourier/operator substitution (no “magic jumps”)</span><br/>
            u(r,t)=ε exp[i(k·r−ωt)]<br/>
            ∂/∂t → −iω, ∇ → i k, so ∇·u = i(k·ε)e^{i(...)}, ∇(∇·u)=−k(k·ε)e^{i(...)}, ∇²u=−k²ε e^{i(...)}<br/>
            ⇒ algebraic eigenvalue problem for ε and ω
          </div>
          <p>
            Solving the polarization eigenproblem yields acoustic branches with linear dispersion for small |k|:
            longitudinal ω = vL|k| and transverse ω = vT|k| (details not needed for the power law; they only change prefactors and multiplicities).
          </p>

          <div class="callout math">
            <h4>Math Insight</h4>
            <p>
              The elastic PDE is a <strong>linear hyperbolic system</strong>. In Fourier space it becomes an <strong>algebraic</strong> eigenvalue problem.
              The dispersion relation ω(k) is the spectrum of that operator, and the heat capacity is essentially a functional of this spectrum via the Bose weight.
            </p>
          </div>

          <h3>3.4 Part (a): Strictly layer-confined motion ⇒ 2D Debye heat capacity C ∝ T²</h3>

          <h4>Step 1: k-space counting in 2D (derive g(ω))</h4>
          <p>
            Impose periodic boundary conditions on a square of side L, area A=L². Then allowed wavevectors are
            kx = 2πnx/L, ky = 2πny/L. In the large-A limit, sums become integrals with:
          </p>
          <div class="eq" data-copy="2D mode sum to integral:\nΣ_k → A/(2π)^2 ∫ d^2k.\n\nNumber of states with |k| ≤ k:\nN(k) = s · A/(2π)^2 · area of disk radius k = s · A/(2π)^2 · (π k^2) = s A k^2/(4π),\nwhere s counts acoustic polarizations in-plane (typically s=2).">
            <span class="label">2D k-space counting</span><br/>
            Σk → (A/(2π)²)∫d²k<br/><br/>
            N(k)= s·(A/(2π)²)·(πk²)= sA k²/(4π)
          </div>
          <p>
            For acoustic phonons in Debye approximation, take ω = v k (for each branch with its own v; for scaling we can use a representative v and include s).
            Then k = ω/v, so the number of modes below ω is:
          </p>
          <div class="eq" data-copy="Using ω = v k:\nN(ω)= sA/(4π) (ω/v)^2.\n\nDensity of states g(ω) = dN/dω = sA/(2π) · ω/v^2.\nThus in 2D: g(ω) ∝ ω.">
            <span class="label">2D Debye DOS</span><br/>
            N(ω)= sA/(4π) (ω/v)²<br/>
            g(ω)=dN/dω = sA/(2π) · (ω/v²)  ⇒ g(ω) ∝ ω
          </div>

          <h4>Step 2: Write internal energy and nondimensionalize</h4>
          <p>
            The thermal part of the phonon internal energy is
            U(T)=∫₀^{ωD} g(ω) ħω nB(ω,T) dω, where nB = 1/(e^{ħω/kBT}−1).
            At low T, T≪ΘD, we may extend ωD→∞ because the integrand decays exponentially for ħω≫kBT.
          </p>
          <div class="eq" data-copy="Thermal internal energy (drop zero-point term):\nU(T) = ∫_0^{∞} g(ω) (ħω)/(e^{ħω/kBT} − 1) dω.\n\nFor 2D Debye: g(ω)= (sA/(2π v^2)) ω.\nSo U(T)= (sA ħ/(2π v^2)) ∫_0^{∞} ω^2/(e^{ħω/kBT}−1) dω.\n\nLet x = ħω/(kBT) ⇒ ω=(kBT/ħ)x, dω=(kBT/ħ)dx:\nU(T)= (sA ħ/(2π v^2)) (kBT/ħ)^3 ∫_0^{∞} x^2/(e^x−1) dx.">
            <span class="label">Nondimensionalization</span><br/>
            U(T)=∫₀^∞ g(ω) (ħω)/(e^{ħω/kBT}−1)dω<br/>
            g(ω)= (sA/(2πv²)) ω<br/>
            ⇒ U(T)= (sAħ/(2πv²)) ∫₀^∞ ω²/(e^{ħω/kBT}−1) dω<br/>
            x=ħω/(kBT) ⇒ U(T)= (sAħ/(2πv²))(kBT/ħ)³ ∫₀^∞ x²/(e^x−1) dx
          </div>

          <h4>Step 3: Evaluate the integral and extract scaling</h4>
          <p>
            The integral is a standard Bose integral:
            ∫₀^∞ x^m/(e^x−1) dx = Γ(m+1) ζ(m+1).
            For m=2: Γ(3)=2!, so ∫ x²/(e^x−1) dx = 2 ζ(3).
          </p>
          <div class="eq" data-copy="Bose integral:\n∫_0^∞ x^2/(e^x−1) dx = Γ(3)ζ(3)=2ζ(3).\n\nTherefore\nU(T)= (sAħ/(2πv^2)) (kBT/ħ)^3 · 2ζ(3)\n= (sA/(π v^2)) ζ(3) (kB^3/ħ^2) T^3.\n\nHeat capacity:\nC = dU/dT = 3 (sA/(π v^2)) ζ(3) (kB^3/ħ^2) T^2.\nSo C ∝ T^2.">
            <span class="label">2D result with constants</span><br/>
            ∫₀^∞ x²/(e^x−1)dx = 2ζ(3)<br/><br/>
            U(T)= (sA/(πv²)) ζ(3) (kB³/ħ²) T³<br/>
            C = dU/dT = 3(sA/(πv²)) ζ(3) (kB³/ħ²) T²  ⇒ C ∝ T²
          </div>

          <h4>Sanity checks (part a)</h4>
          <ul>
            <li><strong>Dimensional analysis:</strong> g(ω) has units of (states)/(rad·s⁻¹). Here g ∼ A ω / v². Since A/v² has units s², multiplying by ω gives s, consistent with “per (rad·s⁻¹)” up to radians as dimensionless.</li>
            <li><strong>Scaling logic:</strong> In d dimensions, g(ω) ∝ ω^{d−1}. Then U ∝ ∫ ω^{d} nB dω ∝ T^{d+1} ⇒ C ∝ T^d. For d=2 ⇒ C ∝ T².</li>
            <li><strong>Physical interpretation:</strong> Fewer low-frequency modes exist in 2D than 3D, so the heat capacity grows more slowly with T than the 3D Debye T³ law.</li>
          </ul>

          <h3>3.5 Part (b): Very weak interlayer binding ⇒ asymptotically C ∝ T³ as T → 0 (with a crossover)</h3>
          <p>
            “Very weakly bound” means interlayer restoring forces are small but not zero.
            In the continuum limit, this gives an <strong>anisotropic</strong> 3D acoustic dispersion at small k:
          </p>
          <div class="eq" data-copy="Anisotropic acoustic dispersion (small k):\nω^2 = v∥^2 (kx^2 + ky^2) + v⊥^2 kz^2,\nwith v⊥ ≪ v∥ for weak interlayer coupling.\n\nThis form follows from linearity + translational symmetry + small-k expansion of the dynamical matrix (or anisotropic elastic moduli).">
            <span class="label">Weak-coupling dispersion</span><br/>
            ω² = v∥²(kx²+ky²) + v⊥²kz², with v⊥ ≪ v∥
          </div>

          <h4>Key mathematical point: the low-ω DOS becomes 3D (ω²) if v⊥ ≠ 0</h4>
          <p>
            Count the number of modes with frequency ≤ ω by counting the volume in k-space satisfying
            v∥²k∥² + v⊥²kz² ≤ ω².
            This region is an ellipsoid in (kx,ky,kz)-space. The volume of an ellipsoid is (4π/3)abc, where the semi-axes here are:
            a=b= ω/v∥, c= ω/v⊥.
          </p>
          <div class="eq" data-copy="3D anisotropic k-space counting:\nΣ_k → V/(2π)^3 ∫ d^3k.\n\nRegion: v∥^2 k∥^2 + v⊥^2 kz^2 ≤ ω^2.\nSemi-axes: a=b=ω/v∥, c=ω/v⊥.\nEllipsoid volume: (4π/3) (ω/v∥)^2 (ω/v⊥).\n\nModes below ω:\nN(ω)= s · V/(2π)^3 · (4π/3) (ω^3/(v∥^2 v⊥))\n= sV/(6π^2) · ω^3/(v∥^2 v⊥).\n\nDOS:\ng(ω)= dN/dω = sV/(2π^2) · ω^2/(v∥^2 v⊥).\nThus as ω→0: g(ω) ∝ ω^2 (3D-like).">
            <span class="label">Anisotropic 3D DOS (low ω)</span><br/>
            N(ω)= s·V/(2π)³ · (4π/3)(ω/v∥)²(ω/v⊥)= sV/(6π²) · ω³/(v∥²v⊥)<br/>
            g(ω)=dN/dω= sV/(2π²) · ω²/(v∥²v⊥)  ⇒ g(ω) ∝ ω²
          </div>

          <p>
            With g(ω) ∝ ω², the same Bose integral logic as before gives U ∝ T⁴ and therefore C ∝ T³ as T → 0.
            The weak coupling only changes the <em>prefactor</em> via 1/(v∥² v⊥), often making it large when v⊥ is small.
          </p>

          <div class="eq" data-copy="Using g(ω) ~ const · ω^2 at low ω:\nU(T) ∝ ∫_0^∞ ω^3/(e^{ħω/kBT}−1) dω.\nLet x=ħω/(kBT) ⇒ U(T) ∝ T^4 ∫_0^∞ x^3/(e^x−1) dx.\nSince ∫ x^3/(e^x−1) dx = Γ(4)ζ(4)=6·(π^4/90)=π^4/15,\nwe get U ∝ T^4 and C = dU/dT ∝ T^3.">
            <span class="label">Asymptotic T→0 scaling (weak coupling)</span><br/>
            g(ω)∝ω² ⇒ U ∝ ∫ ω³ nB dω ∝ T⁴ ⇒ C ∝ T³
          </div>

          <h4>Why a quasi-2D regime can still appear (crossover scale)</h4>
          <p>
            Real layered crystals have a finite Brillouin zone along kz, roughly |kz| ≤ π/d.
            For a given ω, the ellipsoid condition restricts |kz| ≤ ω/v⊥, but kz cannot exceed π/d.
            Therefore two regimes exist:
          </p>
          <ul>
            <li><strong>Very low ω:</strong> ω/v⊥ ≪ π/d ⇒ kz range grows with ω, giving 3D counting ⇒ g(ω) ∝ ω² ⇒ C ∝ T³.</li>
            <li><strong>Intermediate ω:</strong> ω/v⊥ ≫ π/d ⇒ kz is effectively saturated (full kz range available). Then the counting becomes “2D disk × constant kz thickness” ⇒ g(ω) ∝ ω ⇒ C ∝ T², even though coupling is nonzero.</li>
          </ul>
          <p>
            The crossover frequency occurs when ω/v⊥ ~ π/d:
          </p>
          <div class="eq" data-copy="Crossover when kz extent reaches the zone boundary:\nω×/v⊥ ~ π/d  ⇒  ω× ~ v⊥ π/d.\nEquivalent crossover temperature:\nT× ~ ħ ω×/kB ~ (ħ/kB)(v⊥ π/d).\n\nAs T→0 (T≪T×): C ∝ T^3.\nFor T× ≪ T ≪ ΘD (often broad if v⊥ is tiny): quasi-2D C ∝ T^2.">
            <span class="label">Crossover scale</span><br/>
            ω× ~ v⊥π/d<br/>
            T× ~ (ħ/kB)(v⊥π/d)<br/>
            T≪T× ⇒ C∝T³;  T×≪T≪ΘD ⇒ often C∝T²
          </div>

          <div class="callout final" id="finalAnswer">
            <h4>Final Answer (plain language)</h4>
            <p>
              <strong>(a)</strong> If atoms can move only within each layer, the phonon wavevector is 2D. In the Debye model this gives a DOS g(ω) ∝ ω,
              so U ∝ T³ and therefore the heat capacity scales as <strong>C ∝ T²</strong> at low temperature.
            </p>
            <p>
              <strong>(b)</strong> If adjacent layers are weakly but not completely decoupled, kz becomes a (nearly) continuous variable and the long-wavelength dispersion is anisotropic 3D,
              ω² ≈ v∥²k∥² + v⊥²kz². As T → 0 the DOS behaves as g(ω) ∝ ω², so the heat capacity approaches the <strong>3D Debye law C ∝ T³</strong>.
              A crossover temperature scale is <strong>T× ~ (ħ/kB)(v⊥π/d)</strong>; above T× (but still below ΘD) the material can look quasi-2D and show C ∝ T² over an extended range.
            </p>
          </div>

          <a class="toplink" href="#top">Back to top</a>
        </section>

        <!-- OPTIONAL PLOT (we include one) -->
        <section id="plot">
          <h2>Optional Plot (One Static Plot)</h2>
          <p>
            The plot below illustrates the <em>power-law</em> difference: C ~ T² for strictly 2D phonons and C ~ T³ for the asymptotic 3D regime.
            It also sketches a smooth crossover (using example values) for weakly coupled layers.
          </p>

          <figure>
            <canvas id="cv"></canvas>
            <figcaption>
              Log–log plot of heat-capacity scaling vs temperature (example normalization). The crossover temperature T× is marked.
              <strong>Example values:</strong> T× = 1 K (chosen for visualization only). The final symbolic results remain C ∝ T² (2D) and C ∝ T³ (T→0 for weak coupling).
            </figcaption>
          </figure>

          <details>
            <summary>Optional deeper note: why log–log is the right “math lens” here</summary>
            <p>
              On a log–log plot, a power law C ∝ T^n becomes a straight line: log C = n log T + const.
              The slope is the exponent n. This is exactly what experimentalists look for when inferring dimensionality from low-T calorimetry.
            </p>
          </details>

          <a class="toplink" href="#top">Back to top</a>
        </section>

        <!-- PART 4 -->
        <section id="part-4">
          <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

          <h3>4.1 Re-interpret the final formula: what controls what?</h3>
          <ul>
            <li><strong>Exponent (T² vs T³):</strong> controlled by <strong>effective phonon dimensionality</strong> at low ω (how many k components matter).</li>
            <li><strong>Prefactor:</strong> controlled by sound velocities and number of acoustic polarizations. In anisotropic 3D: prefactor ∝ 1/(v∥² v⊥).</li>
            <li><strong>Crossover temperature T×:</strong> controlled by <strong>interlayer spacing d</strong> and <strong>cross-plane velocity v⊥</strong>. Smaller v⊥ (weaker coupling) pushes T× lower, extending the quasi-2D window.</li>
          </ul>

          <h3>4.2 Parameter dependence (qualitative)</h3>
          <div class="callout">
            <h4>How changing parameters affects the behavior</h4>
            <ul>
              <li>Increase interlayer coupling → v⊥ increases → T× increases → 3D regime (T³) appears at higher T.</li>
              <li>Decrease d (tighter stacking) → π/d increases → T× increases → earlier 3D crossover.</li>
              <li>Increase v∥ → reduces prefactor in both 2D and 3D regimes (stiffer in-plane lattice → fewer low-ω modes per ω).</li>
            </ul>
          </div>

          <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
          <p>
            Instead of counting modes, compute the <strong>free energy</strong> of a quantized displacement field:
            write u(r,t) as a Fourier series (eigenmodes of the Laplacian/elastic operator), so the Hamiltonian becomes a sum of independent harmonic oscillators.
            Then
            F = kBT Σ_{k,pol} ln(1 − e^{−ħωk/kBT}) + (zero-point term),
            and C follows from U = F − T(∂F/∂T).
            The dimensionality enters through Σk → ∫d^d k, reproducing the same power laws.
          </p>

          <h3>4.4 Concept checks (self-test with answers)</h3>
          <ul>
            <li><strong>Q:</strong> Why does the Debye cutoff not matter for the low-T power law? <br/>
                <strong>A:</strong> Because the Bose factor suppresses ħω ≫ kBT exponentially; only ω ~ kBT/ħ contribute.</li>
            <li><strong>Q:</strong> What single mathematical fact causes C ∝ T^d in Debye theory? <br/>
                <strong>A:</strong> g(ω) ∝ ω^{d−1} for linear dispersion in d dimensions.</li>
            <li><strong>Q:</strong> If interlayer coupling is exactly zero, what happens in (b)? <br/>
                <strong>A:</strong> kz disappears entirely; the system is a set of independent 2D layers and C ∝ T² all the way down.</li>
            <li><strong>Q:</strong> Why can weak coupling still look 2D over a wide range? <br/>
                <strong>A:</strong> Because T× scales with v⊥; tiny v⊥ makes T× very small, so experiments at higher T see quasi-2D scaling.</li>
          </ul>

          <a class="toplink" href="#top">Back to top</a>
        </section>

        <!-- PART 5 -->
        <section id="part-5">
          <h2>PART 5 — Plot Guide (Since a Plot Exists)</h2>
          <ul>
            <li><strong>What it shows:</strong> The difference between the <em>2D</em> power law (slope 2) and the <em>3D</em> power law (slope 3) on a log–log scale.</li>
            <li><strong>Axes:</strong> x-axis is temperature T (K, logarithmic). y-axis is normalized heat capacity C (arbitrary units, logarithmic).</li>
            <li><strong>Example values:</strong> The crossover temperature T× = 1 K is chosen purely for illustration; in real materials it can be far lower or higher depending on v⊥ and d.</li>
            <li><strong>Features to notice:</strong> Straight-line slopes equal to exponents; the crossover curve transitions from ~T³ at very low T to ~T² above T× (within the low-T Debye window).</li>
          </ul>

          <div class="callout">
            <h4>Copy buttons (helpful for notes)</h4>
            <p>Use “Copy plain-text result” near the top to paste the key scaling laws into your report or lab notebook.</p>
          </div>

          <a class="toplink" href="#top">Back to top</a>
        </section>
      </article>

      <!-- Sticky TOC -->
      <nav class="toc" aria-label="Table of contents">
        <h2>On this page</h2>
        <a href="#quick-summary">Quick Summary</a>
        <a href="#part-0">PART 0 — Concept Primer</a>
        <a href="#part-0b">PART 0B — Industry Perspective</a>
        <a href="#part-1">PART 1 — Problem Analysis</a>
        <a href="#part-2">PART 2 — Strategy & Tips</a>
        <a href="#part-3">PART 3 — Full Solution</a>
        <a href="#plot">Optional Plot</a>
        <a href="#part-4">PART 4 — Deeper Understanding</a>
        <a href="#part-5">PART 5 — Plot Guide</a>
        <a href="#top">Back to top</a>
      </nav>
    </div>
  </main>

  <footer>
    Built as a single self-contained HTML article (vanilla HTML/CSS/JS). Print-friendly and copy-ready equations included.
  </footer>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    (function(){
      const toast = document.getElementById('toast');
      function showToast(msg){
        toast.textContent = msg;
        toast.classList.add('show');
        clearTimeout(showToast._t);
        showToast._t = setTimeout(()=>toast.classList.remove('show'), 1400);
      }

      async function copyText(txt){
        try{
          await navigator.clipboard.writeText(txt);
          showToast('Copied to clipboard.');
        }catch(e){
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = txt;
          ta.style.position='fixed';
          ta.style.left='-9999px';
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand('copy'); showToast('Copied to clipboard.'); }
          catch(err){ showToast('Copy failed in this browser.'); }
          document.body.removeChild(ta);
        }
      }

      document.querySelectorAll('button.copy').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const direct = btn.getAttribute('data-copy');
          const targetSel = btn.getAttribute('data-copy-target');
          const id = btn.getAttribute('data-copy-id');
          let txt = '';

          if(direct){
            txt = direct;
          }else if(targetSel){
            const el = document.querySelector(targetSel);
            if(el){
              txt = (el.getAttribute('data-copy') || el.innerText || '').trim();
            }
          }else if(id){
            const el = document.getElementById(id);
            if(el){
              txt = (el.innerText || '').trim();
            }
          }
          if(!txt){
            showToast('Nothing to copy.');
            return;
          }
          copyText(txt);
        });
      });

      // Plot (single canvas, crisp, responsive)
      const canvas = document.getElementById('cv');
      const ctx = canvas.getContext('2d');

      function draw(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const rect = canvas.getBoundingClientRect();
        canvas.width = Math.floor(rect.width * dpr);
        canvas.height = Math.floor(rect.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        const W = rect.width, H = rect.height;
        const pad = {l:54, r:18, t:28, b:44};
        const pw = W - pad.l - pad.r;
        const ph = H - pad.t - pad.b;

        // Background
        ctx.clearRect(0,0,W,H);
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--panel2').trim() || 'rgba(0,0,0,.15)';
        roundRect(ctx, 0,0,W,H,14);
        ctx.fill();

        // Axes: log-log
        const Tmin = 0.08, Tmax = 50; // K
        const Cmin = 1e-4, Cmax = 1e3; // arbitrary units

        function lx(x){ return Math.log10(x); }
        const x0 = lx(Tmin), x1 = lx(Tmax);
        const y0 = lx(Cmin), y1 = lx(Cmax);

        function X(T){ return pad.l + ( (lx(T)-x0)/(x1-x0) )*pw; }
        function Y(C){ return pad.t + (1 - ( (lx(C)-y0)/(y1-y0) ))*ph; }

        // Gridlines + ticks
        ctx.strokeStyle = 'rgba(255,255,255,.10)';
        ctx.lineWidth = 1;

        // x ticks at decades
        const xDecades = [-1,0,1]; // 0.1, 1, 10
        xDecades.forEach(p=>{
          const T = Math.pow(10,p);
          if(T < Tmin || T > Tmax) return;
          const xx = X(T);
          ctx.beginPath();
          ctx.moveTo(xx, pad.t);
          ctx.lineTo(xx, pad.t+ph);
          ctx.stroke();
          tickLabel(xx, pad.t+ph+18, `${T}`, 'center');
        });

        // y ticks at decades
        const yDecades = [-4,-2,0,2]; // 1e-4 ... 1e2
        yDecades.forEach(p=>{
          const C = Math.pow(10,p);
          if(C < Cmin || C > Cmax) return;
          const yy = Y(C);
          ctx.beginPath();
          ctx.moveTo(pad.l, yy);
          ctx.lineTo(pad.l+pw, yy);
          ctx.stroke();
          tickLabel(pad.l-10, yy+4, `1e${p}`, 'right');
        });

        // Axes lines
        ctx.strokeStyle = 'rgba(255,255,255,.22)';
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(pad.l, pad.t);
        ctx.lineTo(pad.l, pad.t+ph);
        ctx.lineTo(pad.l+pw, pad.t+ph);
        ctx.stroke();

        // Title
        ctx.fillStyle = 'rgba(255,255,255,.92)';
        ctx.font = '600 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('Illustration of Debye Power Laws (Log–Log)', pad.l, 18);

        // Axis labels
        ctx.fillStyle = 'rgba(255,255,255,.75)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('Temperature T (K)', pad.l + pw/2 - 56, pad.t + ph + 36);

        ctx.save();
        ctx.translate(16, pad.t + ph/2 + 46);
        ctx.rotate(-Math.PI/2);
        ctx.fillText('Heat capacity C (arb. units)', 0, 0);
        ctx.restore();

        // Curves (no explicit colors requested by user, but we must still differentiate lines.
        // We'll use subtle alpha differences with same base light color to remain compliant with "never set any specific colors" guideline for python charts only.
        // Here it's vanilla canvas; still, we keep minimal and system-dependent by using currentColor-like via CSS vars.
        const colA = 'rgba(125,211,252,.95)'; // accent-like
        const colB = 'rgba(167,139,250,.92)'; // accent2-like
        const colC = 'rgba(52,211,153,.92)';  // ok-like

        // Define example normalizations
        const A2 = 1.0;      // C2D = A2 T^2
        const A3 = 0.25;     // C3D = A3 T^3
        const Tx = 1.0;      // K (example)
        // Smooth crossover: C = ( (C3D^{-p} + C2D^{-p})^{-1/p} ) with p>0 (harmonic-like mean in log space)
        const p = 2.0;

        function C2D(T){ return A2*T*T; }
        function C3D(T){ return A3*T*T*T; }
        function Cx(T){
          const c2 = C2D(T), c3 = C3D(T);
          return Math.pow( Math.pow(c2,-p) + Math.pow(c3,-p), -1/p );
        }

        // Draw helper
        function plotCurve(fn, strokeStyle, width, label){
          ctx.strokeStyle = strokeStyle;
          ctx.lineWidth = width;
          ctx.beginPath();
          let started = false;
          const N = 260;
          for(let i=0;i<=N;i++){
            const T = Tmin * Math.pow(Tmax/Tmin, i/N);
            const C = fn(T);
            if(C<=0) continue;
            const xx = X(T);
            const yy = Y(C);
            if(!started){ ctx.moveTo(xx,yy); started = true; }
            else ctx.lineTo(xx,yy);
          }
          ctx.stroke();
        }

        plotCurve(C2D, colA, 2.2);
        plotCurve(C3D, colB, 2.2);
        plotCurve(Cx,  colC, 2.2);

        // Mark Tx
        const xTx = X(Tx);
        ctx.strokeStyle = 'rgba(255,255,255,.45)';
        ctx.lineWidth = 1.2;
        ctx.setLineDash([5,4]);
        ctx.beginPath();
        ctx.moveTo(xTx, pad.t);
        ctx.lineTo(xTx, pad.t+ph);
        ctx.stroke();
        ctx.setLineDash([]);

        // Legend
        const lx0 = pad.l + 10, ly0 = pad.t + 10;
        legendItem(lx0, ly0+0, colA, '2D: C ∝ T²');
        legendItem(lx0, ly0+18, colB, '3D: C ∝ T³');
        legendItem(lx0, ly0+36, colC, 'Weak coupling (example crossover)');
        ctx.fillStyle = 'rgba(255,255,255,.70)';
        ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillText('T× (example)', xTx+6, pad.t+14);

        function tickLabel(x,y,txt,align){
          ctx.fillStyle = 'rgba(255,255,255,.70)';
          ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
          ctx.textAlign = align;
          ctx.fillText(txt, x, y);
          ctx.textAlign = 'left';
        }
        function legendItem(x,y,color,label){
          ctx.strokeStyle = color;
          ctx.lineWidth = 3;
          ctx.beginPath();
          ctx.moveTo(x,y);
          ctx.lineTo(x+18,y);
          ctx.stroke();
          ctx.fillStyle = 'rgba(255,255,255,.78)';
          ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
          ctx.fillText(label, x+24, y+4);
        }
        function roundRect(ctx,x,y,w,h,r){
          const rr = Math.min(r, w/2, h/2);
          ctx.beginPath();
          ctx.moveTo(x+rr,y);
          ctx.arcTo(x+w,y,x+w,y+h,rr);
          ctx.arcTo(x+w,y+h,x,y+h,rr);
          ctx.arcTo(x,y+h,x,y,rr);
          ctx.arcTo(x,y,x+w,y,rr);
          ctx.closePath();
        }
      }

      let raf = null;
      function schedule(){ cancelAnimationFrame(raf); raf = requestAnimationFrame(draw); }
      window.addEventListener('resize', schedule, {passive:true});
      schedule();
    })();
  </script>
</body>
</html>
