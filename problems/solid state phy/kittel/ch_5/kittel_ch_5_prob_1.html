<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="color-scheme" content="light dark"/>
  <meta name="theme-color" content="#0b1020"/>
  <title>Singularity in Density of States (Phonons): 1D Monatomic Chain & 3D Optical Branch</title>
  <style>
    :root{
      --bg:#070a12; --panel:#0c1222; --card:#0f1830; --text:#e9eefc; --muted:#b6c1e6;
      --accent:#7aa2ff; --accent2:#70e1c8; --warn:#ffcf6e; --danger:#ff6b6b;
      --border:rgba(255,255,255,.10); --shadow:0 10px 30px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8ff; --panel:#ffffff; --card:#ffffff; --text:#0b1020; --muted:#3b4a77;
        --accent:#2b63ff; --accent2:#0aa889; --warn:#ad6a00; --danger:#d11a2a;
        --border:rgba(11,16,32,.12); --shadow:0 12px 26px rgba(11,16,32,.10);
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background: radial-gradient(1200px 700px at 20% 10%, rgba(122,162,255,.18), transparent 60%),
                         radial-gradient(900px 500px at 85% 20%, rgba(112,225,200,.14), transparent 55%),
                         var(--bg);
      color:var(--text);
      font-family:var(--sans);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      position:relative;
      padding: 2.2rem 1rem 1.2rem;
      max-width: 1180px;
      margin: 0 auto;
    }
    .hero{
      display:grid;
      grid-template-columns: 1.4fr .9fr;
      gap: 1rem;
      align-items: start;
    }
    @media (max-width: 960px){
      .hero{grid-template-columns: 1fr; }
    }
    .titleCard{
      background: linear-gradient(180deg, rgba(122,162,255,.14), rgba(112,225,200,.10));
      border:1px solid var(--border);
      border-radius: 18px;
      padding: 1.2rem 1.2rem 1rem;
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .titleCard::after{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(700px 260px at 20% 10%, rgba(122,162,255,.25), transparent 55%),
                  radial-gradient(600px 240px at 90% 30%, rgba(112,225,200,.18), transparent 55%);
      pointer-events:none;
      opacity:.55;
      transform: translateZ(0);
    }
    h1{
      position:relative;
      margin:.2rem 0 .4rem;
      font-size: clamp(1.3rem, 2.2vw, 2.1rem);
      letter-spacing:.2px;
    }
    .subtitle{
      position:relative;
      margin:0;
      color:var(--muted);
      font-size: 1rem;
      max-width: 70ch;
    }
    .metaPills{
      position:relative;
      margin-top:.9rem;
      display:flex; flex-wrap:wrap; gap:.45rem;
    }
    .pill{
      border:1px solid var(--border);
      background: rgba(255,255,255,.06);
      padding:.25rem .55rem;
      border-radius: 999px;
      font-size:.85rem;
      color: var(--muted);
      backdrop-filter: blur(6px);
    }
    main{
      max-width: 1180px;
      margin: 0 auto;
      padding: 0 1rem 4rem;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap: 1rem;
      align-items:start;
    }
    @media (max-width: 980px){
      main{grid-template-columns: 1fr;}
    }
    nav.toc{
      position: sticky;
      top: .85rem;
      align-self:start;
      background: rgba(255,255,255,.04);
      border:1px solid var(--border);
      border-radius: 16px;
      padding: .9rem;
      box-shadow: var(--shadow);
    }
    @media (max-width: 980px){
      nav.toc{position:relative; top:0}
    }
    .toc h2{
      margin:.1rem 0 .55rem;
      font-size: 1rem;
      color: var(--text);
    }
    .toc a{
      display:block;
      padding:.35rem .45rem;
      border-radius: 10px;
      color: var(--muted);
      font-size:.93rem;
      border: 1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }
    .toc a:hover{
      background: rgba(122,162,255,.10);
      border-color: rgba(122,162,255,.22);
      transform: translateX(2px);
      text-decoration:none;
      color: var(--text);
    }
    .content{
      display:flex;
      flex-direction:column;
      gap: 1rem;
      min-width: 0;
    }
    section, article{
      background: rgba(255,255,255,.03);
      border:1px solid var(--border);
      border-radius: 18px;
      padding: 1rem 1.1rem;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    h2{
      margin:.2rem 0 .6rem;
      font-size: clamp(1.05rem, 1.7vw, 1.4rem);
    }
    h3{
      margin: 1rem 0 .45rem;
      font-size: 1.05rem;
    }
    p{margin:.45rem 0}
    ul{margin:.4rem 0 .4rem 1.1rem}
    li{margin:.25rem 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: .9rem;
    }
    @media (max-width: 860px){ .grid2{grid-template-columns:1fr;} }
    .callout{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius: 16px;
      padding: .85rem;
    }
    .callout strong{color: var(--text)}
    .callout.assumptions{border-color: rgba(255,207,110,.35)}
    .callout.keyeq{border-color: rgba(122,162,255,.35)}
    .callout.mistakes{border-color: rgba(255,107,107,.32)}
    .callout.mathinsight{border-color: rgba(112,225,200,.35)}
    .labelRow{
      display:flex; gap:.5rem; flex-wrap:wrap; align-items:center;
      margin:.35rem 0 .2rem;
    }
    .tag{
      font-size:.8rem;
      color: var(--muted);
      padding:.18rem .5rem;
      border-radius: 999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
    }
    .eqBox{
      position:relative;
      background: rgba(0,0,0,.18);
      border:1px solid var(--border);
      border-radius: 14px;
      padding: .8rem .8rem .75rem;
      overflow:auto;
    }
    @media (prefers-color-scheme: light){
      .eqBox{background: rgba(11,16,32,.04);}
    }
    .eq{
      font-family: var(--mono);
      font-size: .95rem;
      white-space: pre;
      margin:0;
    }
    .btnRow{
      display:flex;
      gap:.45rem;
      flex-wrap:wrap;
      margin-top:.55rem;
    }
    button.copyBtn{
      border: 1px solid var(--border);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 12px;
      padding: .42rem .62rem;
      font-size: .88rem;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    button.copyBtn:hover{
      background: rgba(122,162,255,.12);
      border-color: rgba(122,162,255,.25);
      transform: translateY(-1px);
    }
    button.copyBtn:active{transform: translateY(0px) scale(.99);}
    details{
      border:1px solid var(--border);
      border-radius: 14px;
      padding:.6rem .75rem;
      background: rgba(255,255,255,.03);
    }
    summary{
      cursor:pointer;
      color: var(--text);
      font-weight: 650;
      letter-spacing:.1px;
    }
    .backTop{
      display:inline-flex;
      align-items:center;
      gap:.4rem;
      margin-top:.8rem;
      padding:.35rem .55rem;
      border-radius: 999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      font-size: .9rem;
      transition: background .15s ease, transform .15s ease;
    }
    .backTop:hover{background: rgba(112,225,200,.10); transform: translateY(-1px); text-decoration:none; color: var(--text);}
    figure{
      margin: .6rem 0 0;
      padding: .85rem;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.02);
    }
    figcaption{color: var(--muted); font-size:.9rem; margin-top:.55rem}
    canvas{width:100%; height:320px; display:block; border-radius: 12px; background: rgba(0,0,0,.18); border:1px solid var(--border);}
    @media (prefers-color-scheme: light){
      canvas{background: rgba(11,16,32,.04);}
    }

    /* print */
    @media print{
      body{background:#fff; color:#000}
      nav.toc{display:none}
      header, main{max-width: 100%; padding:0}
      section, article{box-shadow:none; border:1px solid #bbb; break-inside: avoid; page-break-inside: avoid;}
      a{color:#000; text-decoration:underline}
      .pill,.tag,button.copyBtn,.backTop{display:none}
      canvas{border:1px solid #777}
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="hero">
      <div class="titleCard">
        <h1>Singularity in Phonon Density of States: 1D Van Hove Divergence & 3D Optical-Branch Edge</h1>
        <p class="subtitle">
          We derive (a) the exact density of normal modes for a monatomic 1D lattice with nearest-neighbor springs,
          and (b) the density of states near the upper edge of a 3D optical branch with quadratic dispersion near <span style="font-family:var(--mono)">k = 0</span>.
          Along the way we emphasize the mathematical-physics structure: eigenvalue problems, delta-function counting, and change-of-variables rigor.
        </p>
        <div class="metaPills">
          <span class="pill">Topic: phonons & DOS</span>
          <span class="pill">Key tool: δ-function in k-space</span>
          <span class="pill">Result: singular / discontinuous DOS</span>
          <span class="pill">Industry lens: thermal & vibrational design</span>
        </div>
      </div>
      <div class="callout keyeq">
        <div class="labelRow">
          <span class="tag">Goal</span><span class="tag">What you prove</span>
        </div>
        <p style="margin:.25rem 0 .5rem;">
          (a) For a 1D monatomic chain of <b>N atoms</b> (periodic), show:
        </p>
        <div class="eqBox" data-copy="eq-a">
<pre class="eq">D(ω) = (2N/π) · 1 / √(ω_m² − ω²),   0 &lt; ω &lt; ω_m</pre>
        </div>
        <p style="margin:.55rem 0 .5rem;">
          (b) For a 3D optical branch near <b>k = 0</b>:
        </p>
        <div class="eqBox" data-copy="eq-b">
<pre class="eq">ω(k) = ω₀ − A k²  (A &gt; 0),   k = |k|</pre>
        </div>
        <p style="margin:.5rem 0 0;">
          Show <b>edge behavior</b> (for ω &lt; ω₀):
        </p>
        <div class="eqBox" data-copy="eq-b2">
<pre class="eq">D(ω) = (L/2π)³ · (2π/A)^{3/2} · (ω₀ − ω)^{1/2},   and   D(ω)=0 for ω&gt;ω₀</pre>
        </div>
      </div>
    </div>
  </header>

  <main>
    <nav class="toc" aria-label="Table of contents">
      <h2>Table of Contents</h2>
      <a href="#quick">Quick Summary</a>
      <a href="#primer">PART 0 — Concept Primer</a>
      <a href="#industry">PART 0B — Industry & Applied Physics</a>
      <a href="#analysis">PART 1 — Problem Analysis</a>
      <a href="#strategy">PART 2 — Strategy & Tips</a>
      <a href="#solution">PART 3 — Full Solution</a>
      <a href="#deeper">PART 4 — Deeper Understanding</a>
      <a href="#plotguide">PART 5 — Optional Plot Guide</a>
    </nav>

    <div class="content">

      <section id="quick">
        <h2>Quick Summary</h2>
        <ul>
          <li><b>What this is about:</b> counting vibrational normal modes and turning that count into a <b>density of states</b> (DOS) as a function of frequency <span style="font-family:var(--mono)">ω</span>.</li>
          <li><b>Key physics idea:</b> phonons are eigenmodes of a linear lattice; the DOS depends on how <span style="font-family:var(--mono)">ω</span> varies with wavevector <span style="font-family:var(--mono)">k</span>.</li>
          <li><b>Governing relation:</b> DOS can be written using a <b>Dirac delta</b>: <span style="font-family:var(--mono)">D(ω)=∑_k δ(ω−ω(k))</span> (or its continuum version).</li>
          <li><b>Part (a) result type:</b> <b>symbolic</b>; a 1D monatomic chain gives <b>Van Hove divergence</b> <span style="font-family:var(--mono)">~(ω_m−ω)^{-1/2}</span> at the band edge.</li>
          <li><b>Part (b) result type:</b> <b>symbolic</b>; a 3D optical branch with <span style="font-family:var(--mono)">ω=ω₀−Ak²</span> yields an <b>edge DOS</b> <span style="font-family:var(--mono)">D(ω)∝(ω₀−ω)^{1/2}</span> (and <span style="font-family:var(--mono)">D=0</span> above <span style="font-family:var(--mono)">ω₀</span>).</li>
          <li><b>Mathematical physics lens:</b> linear difference equations → Fourier modes; DOS is a pushforward measure under the map <span style="font-family:var(--mono)">k↦ω(k)</span>, with singularities where the Jacobian vanishes.</li>
          <li><b>Physical meaning:</b> singular/edge features strongly affect heat capacity, thermal conductivity, Raman/IR spectra, and vibration response near resonance bands.</li>
        </ul>
        <div class="btnRow">
          <button class="copyBtn" data-copy-target="final-answer">Copy Final Answer (plain text)</button>
          <button class="copyBtn" data-copy-target="eq-a">Copy Key Eq. (a)</button>
          <button class="copyBtn" data-copy-target="eq-b2">Copy Key Eq. (b)</button>
        </div>
      </section>

      <article id="primer">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="callout">
            <div class="labelRow"><span class="tag">Core definitions</span><span class="tag">Symbols & units</span></div>
            <ul>
              <li><b>Wavevector</b> <span style="font-family:var(--mono)">k</span> (SI: m⁻¹): labels lattice Fourier modes under periodic boundary conditions.</li>
              <li><b>Angular frequency</b> <span style="font-family:var(--mono)">ω</span> (SI: s⁻¹): eigenfrequency of a normal mode.</li>
              <li><b>Dispersion relation</b> <span style="font-family:var(--mono)">ω=ω(k)</span>: map from <span style="font-family:var(--mono)">k</span>-space to frequency.</li>
              <li><b>Density of states</b> <span style="font-family:var(--mono)">D(ω)</span> (units: states per (rad/s)): number of modes in <span style="font-family:var(--mono)">[ω, ω+dω]</span> is <span style="font-family:var(--mono)">D(ω)dω</span>.</li>
              <li><b>System size</b> <span style="font-family:var(--mono)">L</span> (m) in 3D; in 1D with lattice spacing <span style="font-family:var(--mono)">a</span>, total length <span style="font-family:var(--mono)">L=Na</span>.</li>
            </ul>
          </div>

          <div class="callout">
            <div class="labelRow"><span class="tag">Physical meaning</span><span class="tag">Intuition</span></div>
            <p>
              The DOS tells you <i>how many ways</i> a crystal can vibrate at frequency <span style="font-family:var(--mono)">ω</span>.
              If the dispersion <span style="font-family:var(--mono)">ω(k)</span> flattens (small group velocity),
              many distinct <span style="font-family:var(--mono)">k</span> values map to nearly the same <span style="font-family:var(--mono)">ω</span>:
              the DOS increases, and can even diverge (a Van Hove singularity).
            </p>
            <p style="margin-top:.55rem;">
              <b>Group velocity</b> is <span style="font-family:var(--mono)">v_g = dω/dk</span> (1D) or <span style="font-family:var(--mono)">∇_k ω</span> (multi-D).
              Where <span style="font-family:var(--mono)">v_g → 0</span>, mode “crowding” occurs in frequency space.
            </p>
          </div>
        </div>

        <h3>Mathematical model (explicit)</h3>
        <div class="callout mathinsight">
          <div class="labelRow"><span class="tag">Mathematical physics</span><span class="tag">Model statement</span></div>
          <p><b>1D monatomic chain:</b> masses <span style="font-family:var(--mono)">m</span> at sites <span style="font-family:var(--mono)">n∈{0,…,N−1}</span> with spacing <span style="font-family:var(--mono)">a</span>.
            Displacement field is a discrete function <span style="font-family:var(--mono)">u_n(t)</span> (m).
            With nearest-neighbor spring constant <span style="font-family:var(--mono)">K</span> (N/m), Newton’s law gives the linear ODE system</p>
          <div class="eqBox" data-copy="eq-model-1d">
<pre class="eq">m d²u_n/dt² = K[(u_{n+1} − u_n) + (u_{n−1} − u_n)]  for all n</pre>
          </div>
          <p>
            <b>Domain & boundary conditions:</b> periodic boundary conditions (PBC)
            <span style="font-family:var(--mono)">u_{n+N}(t)=u_n(t)</span>, so the discrete Laplacian is circulant and diagonalized by discrete Fourier modes.
          </p>
          <p>
            <b>3D optical branch (continuum in k-space):</b> we consider a branch <span style="font-family:var(--mono)">ω(k)</span>
            near <span style="font-family:var(--mono)">k=0</span> with isotropic quadratic form:
            <span style="font-family:var(--mono)">ω(k)=ω₀−A|k|²</span>.
            The reciprocal-space domain is a neighborhood of <span style="font-family:var(--mono)">k=0</span> inside the first Brillouin zone.
            With PBC in a cubic box of side <span style="font-family:var(--mono)">L</span>, allowed wavevectors are
            <span style="font-family:var(--mono)">k = (2π/L)(n_x,n_y,n_z)</span>.
          </p>
          <p>
            <b>Operator notation insight:</b> In 1D, the right-hand side is <span style="font-family:var(--mono)">K(Δ_d u)_n</span> where
            <span style="font-family:var(--mono)">Δ_d u_n = u_{n+1} − 2u_n + u_{n−1}</span> is the discrete Laplacian (a discrete analog of <span style="font-family:var(--mono)">∂²/∂x²</span>).
            In 3D k-space, the DOS integral uses the <span style="font-family:var(--mono)">∇_k</span> geometry via spherical shells.
          </p>
        </div>

        <h3>Key laws/principles and validity conditions</h3>
        <ul>
          <li><b>Linearity:</b> small displacements ⇒ Hooke’s law springs; superposition holds; normal modes exist.</li>
          <li><b>Translational symmetry + PBC:</b> makes the eigenvectors plane waves, enabling analytic dispersion and DOS.</li>
          <li><b>Continuum approximation in k-space:</b> for large systems, sums over k become integrals using density <span style="font-family:var(--mono)">(L/2π)^d</span>.</li>
          <li><b>Local quadratic approximation (part b):</b> only valid near <span style="font-family:var(--mono)">k=0</span>, so the derived DOS is an edge/asymptotic form near <span style="font-family:var(--mono)">ω≈ω₀</span>.</li>
        </ul>

        <h3>Mini intuition examples (quick)</h3>
        <ul>
          <li>If <span style="font-family:var(--mono)">ω(k)</span> is steep, a small frequency interval corresponds to a small k-interval ⇒ <span style="font-family:var(--mono)">D(ω)</span> is small.</li>
          <li>If <span style="font-family:var(--mono)">ω(k)</span> flattens (near a band edge), many k’s share similar ω ⇒ <span style="font-family:var(--mono)">D(ω)</span> spikes/diverges.</li>
          <li>In 3D, spherical shells bring a factor <span style="font-family:var(--mono)">4πk²</span>; even if slope is small, geometry can soften the singularity.</li>
        </ul>

        <h3>What to watch for (pitfalls)</h3>
        <ul>
          <li><b>Factor-of-2 issues:</b> counting both <span style="font-family:var(--mono)">±k</span> or restricting to the first Brillouin zone; handle monotonic branches carefully.</li>
          <li><b>Units:</b> <span style="font-family:var(--mono)">D(ω)</span> must have units of <span style="font-family:var(--mono)">1/(rad/s)</span>.</li>
          <li><b>Edge vs global DOS:</b> part (b) is a <i>local</i> approximation near <span style="font-family:var(--mono)">ω₀</span>, not necessarily the full-band DOS.</li>
          <li><b>δ-function calculus:</b> use <span style="font-family:var(--mono)">δ(f(x)) = Σ δ(x−x_i)/|f'(x_i)|</span> where <span style="font-family:var(--mono)">f(x_i)=0</span>.</li>
        </ul>

        <a class="backTop" href="#top">↑ Back to top</a>
      </article>

      <article id="industry">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>
        <div class="grid2">
          <div class="callout">
            <div class="labelRow"><span class="tag">Where it shows up</span><span class="tag">Applications</span></div>
            <ul>
              <li><b>Thermal management</b> (electronics, power devices): phonon DOS shapes heat capacity and phonon scattering phase space.</li>
              <li><b>Raman/IR spectroscopy</b> (materials ID, process control): spectral peaks track DOS features near band edges and optical modes.</li>
              <li><b>Vibration & acoustics</b> (precision machines, MEMS, aerospace panels): band-edge crowding can amplify resonant responses and noise.</li>
              <li><b>Thermoelectrics</b> (efficiency engineering): tailoring phonon transport often leverages DOS and group-velocity control.</li>
            </ul>
          </div>
          <div class="callout">
            <div class="labelRow"><span class="tag">Why engineers care</span><span class="tag">Design levers</span></div>
            <ul>
              <li><b>Reliability:</b> high DOS near certain ω can increase vibrational energy storage, affecting fatigue and damping needs.</li>
              <li><b>Performance:</b> phonon DOS impacts thermal conductivity via available states and scattering.</li>
              <li><b>Cost & manufacturability:</b> microstructure tuning (alloying, nanostructures) alters dispersion near edges without redesigning the whole component.</li>
            </ul>
          </div>
        </div>

        <h3>Measurement/validation in practice (brief)</h3>
        <ul>
          <li><b>Inelastic neutron/X-ray scattering:</b> directly probes <span style="font-family:var(--mono)">ω(k)</span> (dispersion) and can infer DOS.</li>
          <li><b>Raman/IR:</b> sensitive to optical phonons and van Hove-like features (selection rules apply).</li>
          <li><b>Thermal measurements:</b> low-T heat capacity and thermal conductivity indirectly constrain DOS and group velocities.</li>
        </ul>

        <h3>Design trade-offs & non-idealities</h3>
        <ul>
          <li><b>Finite size:</b> discrete k-grid smears singularities into large-but-finite peaks.</li>
          <li><b>Disorder/anharmonicity:</b> broadens modes (finite lifetimes) ⇒ DOS features broaden.</li>
          <li><b>Real lattices:</b> multiple branches, anisotropy, and non-parabolic dispersion modify edge exponents.</li>
        </ul>

        <p><b>From lab to product:</b> engineers often use the same DOS formulas but replace sharp δ-peaks by broadened lines (Lorentz/Gauss),
          incorporate measured dispersion, and run uncertainty studies (tolerances in <span style="font-family:var(--mono)">A</span>, <span style="font-family:var(--mono)">ω₀</span>, microstructure).
        </p>

        <a class="backTop" href="#top">↑ Back to top</a>
      </article>

      <section id="analysis">
        <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

        <h3>Restating the problem</h3>
        <p>
          (a) Using the known dispersion relation of a <b>1D monatomic linear lattice</b> with nearest-neighbor interactions,
          derive an explicit expression for the <b>density of modes</b> <span style="font-family:var(--mono)">D(ω)</span> and show it has a square-root singularity at the maximum frequency <span style="font-family:var(--mono)">ω_m</span>.
        </p>
        <p>
          (b) In 3D, an <b>optical phonon branch</b> near <span style="font-family:var(--mono)">k=0</span> is approximated by
          <span style="font-family:var(--mono)">ω(k)=ω₀−Ak²</span>. Show the corresponding DOS near the top edge <span style="font-family:var(--mono)">ω₀</span> behaves like
          <span style="font-family:var(--mono)">D(ω)∝(ω₀−ω)^{1/2}</span> for <span style="font-family:var(--mono)">ω&lt;ω₀</span>, and is zero for <span style="font-family:var(--mono)">ω&gt;ω₀</span>.
        </p>

        <div class="grid2">
          <div class="callout assumptions">
            <div class="labelRow"><span class="tag">Given</span></div>
            <ul>
              <li>(a) 1D monatomic chain, <span style="font-family:var(--mono)">N</span> atoms, nearest-neighbor coupling; maximum phonon frequency <span style="font-family:var(--mono)">ω_m</span>.</li>
              <li>(b) 3D optical branch: <span style="font-family:var(--mono)">ω(k)=ω₀−Ak²</span> near <span style="font-family:var(--mono)">k=0</span>; cubic box size <span style="font-family:var(--mono)">L</span>.</li>
            </ul>
          </div>
          <div class="callout">
            <div class="labelRow"><span class="tag">Unknowns</span></div>
            <ul>
              <li>Explicit formula for <span style="font-family:var(--mono)">D(ω)</span> in (a) and proof of the stated expression.</li>
              <li>Explicit formula for <span style="font-family:var(--mono)">D(ω)</span> near <span style="font-family:var(--mono)">ω₀</span> in (b) and proof of discontinuity at <span style="font-family:var(--mono)">ω=ω₀</span>.</li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><b>Normal-mode decomposition:</b> linear equations ⇒ eigenmodes exist; frequencies are eigenvalues of a Hermitian (real symmetric) dynamical matrix.</li>
          <li><b>k-space counting:</b> with PBC, allowed k values form a uniform grid; sums over k become integrals with density <span style="font-family:var(--mono)">(L/2π)^d</span>.</li>
          <li><b>Change of variables / δ-function identity:</b> transforms a k-sum into a DOS in ω.</li>
        </ul>

        <div class="callout assumptions">
          <div class="labelRow"><span class="tag">Assumptions (explicit)</span></div>
          <ul>
            <li>Harmonic approximation (small displacements; linear springs).</li>
            <li>Perfect periodicity (no disorder) and PBC (to make k discrete and uniform).</li>
            <li>In (b), isotropy near k=0 and validity of quadratic expansion; ignore anisotropic corrections.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <ul>
          <li><b>Approach 1 (direct Jacobian in 1D):</b> compute <span style="font-family:var(--mono)">D(ω)= (number of k states per dk)·|dk/dω|</span> (fast, intuitive). <b>Best for (a).</b></li>
          <li><b>Approach 2 (δ-function definition):</b> start from <span style="font-family:var(--mono)">D(ω)=∑_k δ(ω−ω(k))</span>, convert sum→integral, evaluate via δ identities (most rigorous, general). <b>Best for (b).</b></li>
          <li><b>Approach 3 (geometric “constant-ω surfaces”):</b> in dD, <span style="font-family:var(--mono)">D(ω)</span> relates to the area of the surface <span style="font-family:var(--mono)">ω(k)=ω</span> divided by <span style="font-family:var(--mono)">|∇_k ω|</span>. Elegant but requires comfort with differential geometry.</li>
        </ul>
        <p>
          <b>Chosen plan:</b> use Jacobian method for (a) and δ-function + spherical coordinates for (b), while cross-checking with the geometric surface formula.
        </p>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="strategy">
        <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

        <ol style="margin:.4rem 0 .2rem 1.1rem;">
          <li><b>Write the dispersion</b> <span style="font-family:var(--mono)">ω(k)</span> (1D chain and 3D optical) and identify the allowed k-grid (PBC).</li>
          <li><b>Define DOS mathematically</b> as modes per frequency interval: <span style="font-family:var(--mono)">D(ω)dω</span> = number of modes with frequencies in <span style="font-family:var(--mono)">[ω,ω+dω]</span>.</li>
          <li><b>Convert k-counting to an integral</b> using state density: in 1D, <span style="font-family:var(--mono)">L/2π</span>; in 3D, <span style="font-family:var(--mono)">(L/2π)^3</span>.</li>
          <li><b>For (a):</b> use monotonic branch and <span style="font-family:var(--mono)">D(ω)= (dk-state density)×(number of k solutions)×|dk/dω|</span>.</li>
          <li><b>For (b):</b> start from <span style="font-family:var(--mono)">D(ω)=(L/2π)^3 ∫ d^3k δ(ω−ω(k))</span>.</li>
          <li><b>Evaluate δ-integral</b> in spherical coordinates; reduce to a 1D δ in k with Jacobian <span style="font-family:var(--mono)">|dω/dk|</span>.</li>
          <li><b>Enforce support</b> (where solutions exist): for optical edge, only <span style="font-family:var(--mono)">ω≤ω₀</span> gives real k.</li>
          <li><b>Sanity checks:</b> units, limiting behavior near edges, and total mode count scaling with N or volume.</li>
        </ol>

        <div class="callout mistakes">
          <div class="labelRow"><span class="tag">Common mistakes</span></div>
          <ul>
            <li>Dropping the <b>two solutions</b> (<span style="font-family:var(--mono)">±k</span>) in 1D when mapping ω to k.</li>
            <li>Forgetting the <b>k-space density factor</b> <span style="font-family:var(--mono)">(L/2π)^d</span>.</li>
            <li>Mishandling δ-functions: missing the <span style="font-family:var(--mono)">1/|f'|</span> Jacobian factor.</li>
            <li>Not checking the <b>domain</b>: in (b) real solutions require <span style="font-family:var(--mono)">ω≤ω₀</span>.</li>
          </ul>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <article id="solution">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Qualitative expectation (before calculating)</h3>
        <ul>
          <li><b>1D monatomic chain:</b> dispersion flattens at the Brillouin-zone boundary, so <span style="font-family:var(--mono)">dω/dk→0</span> there ⇒ DOS should <b>diverge</b> at <span style="font-family:var(--mono)">ω→ω_m</span>.</li>
          <li><b>3D optical edge:</b> near <span style="font-family:var(--mono)">k=0</span>, frequencies decrease quadratically away from the maximum. Geometry adds <span style="font-family:var(--mono)">k²</span> phase-space, so DOS should vanish as a <b>square root</b> when approaching <span style="font-family:var(--mono)">ω₀</span> from below, and be strictly zero above.</li>
        </ul>

        <div class="callout mathinsight">
          <div class="labelRow"><span class="tag">Math Insight</span><span class="tag">What is DOS, mathematically?</span></div>
          <p>
            Think of <span style="font-family:var(--mono)">ω(k)</span> as a map from k-space to the real line. The DOS is the <b>pushforward measure</b>:
            it counts how much k-volume maps into a given ω-interval. Singularities occur where the Jacobian of this map degenerates,
            e.g., <span style="font-family:var(--mono)">|dω/dk|=0</span> in 1D or <span style="font-family:var(--mono)">|∇_k ω|=0</span> in higher dimensions.
          </p>
        </div>

        <h3>(a) 1D monatomic lattice: derive <span style="font-family:var(--mono)">D(ω)</span></h3>

        <h4>Step A1 — Dispersion relation from the eigenvalue problem</h4>
        <p>
          Start from the discrete equation of motion (harmonic, nearest-neighbor):
        </p>
        <div class="eqBox" data-copy="eq-a1">
<pre class="eq">m d²u_n/dt² = K(u_{n+1} − 2u_n + u_{n−1}) = K(Δ_d u)_n</pre>
        </div>
        <p>
          Because the system is linear and translation-invariant under PBC, we try separable normal-mode solutions
          (Fourier eigenvectors of the circulant discrete Laplacian):
        </p>
        <div class="eqBox" data-copy="eq-a2">
<pre class="eq">u_n(t) = U · e^{i(k n a − ω t)}</pre>
        </div>
        <p>
          This step is valid because the discrete Laplacian is linear and commutes with lattice translations; its eigenvectors are plane waves.
          Substitute into the equation:
        </p>
        <div class="eqBox" data-copy="eq-a3">
<pre class="eq">Left:  m(−ω²)U e^{i(kna−ωt)}
Right: K[U e^{i(k(n+1)a−ωt)} − 2U e^{i(kna−ωt)} + U e^{i(k(n−1)a−ωt)}]</pre>
        </div>
        <p>Factor out the common term <span style="font-family:var(--mono)">U e^{i(kna−ωt)}</span>:</p>
        <div class="eqBox" data-copy="eq-a4">
<pre class="eq">−mω² = K(e^{ika} − 2 + e^{−ika}) = K(2cos(ka) − 2) = −4K sin²(ka/2)</pre>
        </div>
        <p>Hence</p>
        <div class="eqBox" data-copy="eq-a5">
<pre class="eq">ω²(k) = (4K/m) sin²(ka/2)</pre>
        </div>
        <p>
          Define the maximum frequency (at the zone boundary <span style="font-family:var(--mono)">|k|=π/a</span>):
        </p>
        <div class="eqBox" data-copy="eq-a6">
<pre class="eq">ω_m = 2√(K/m)</pre>
        </div>
        <p>So we can write compactly:</p>
        <div class="eqBox" data-copy="eq-a7">
<pre class="eq">ω(k) = ω_m |sin(ka/2)|,   k ∈ [−π/a, π/a]</pre>
        </div>

        <h4>Step A2 — Allowed k values and state density</h4>
        <p>
          Under PBC on length <span style="font-family:var(--mono)">L=Na</span>, the wave must satisfy
          <span style="font-family:var(--mono)">e^{ik(n+N)a}=e^{ikna}</span> ⇒ <span style="font-family:var(--mono)">e^{ikNa}=1</span>.
          Thus
        </p>
        <div class="eqBox" data-copy="eq-a8">
<pre class="eq">k = (2π/L)·ℓ = (2π/(Na))·ℓ,  where ℓ is an integer</pre>
        </div>
        <p>
          The spacing is <span style="font-family:var(--mono)">Δk = 2π/L</span>, so the number of k-states in <span style="font-family:var(--mono)">[k,k+dk]</span> is
          <span style="font-family:var(--mono)">(L/2π)dk</span>.
        </p>

        <h4>Step A3 — DOS via change of variables (carefully, no magic jumps)</h4>
        <p>
          For frequencies in the interior <span style="font-family:var(--mono)">0&lt;ω&lt;ω_m</span>, each ω corresponds to <b>two</b> k-values in the first Brillouin zone:
          <span style="font-family:var(--mono)">k</span> and <span style="font-family:var(--mono)">−k</span> (same ω because <span style="font-family:var(--mono)">ω(k)</span> is even).
          Therefore,
        </p>
        <div class="eqBox" data-copy="eq-a9">
<pre class="eq">D(ω) dω = 2 · (L/2π) · |dk|   (for ω in (0, ω_m))</pre>
        </div>
        <p>Divide by <span style="font-family:var(--mono)">dω</span>:</p>
        <div class="eqBox" data-copy="eq-a10">
<pre class="eq">D(ω) = 2·(L/2π) · |dk/dω| = (L/π) · |dk/dω|</pre>
        </div>
        <p>
          Now compute <span style="font-family:var(--mono)">dk/dω</span> from the dispersion on the monotonic half-interval
          <span style="font-family:var(--mono)">k∈[0,π/a]</span>, where <span style="font-family:var(--mono)">ω(k)=ω_m sin(ka/2)</span> (drop absolute value).
          Differentiate:
        </p>
        <div class="eqBox" data-copy="eq-a11">
<pre class="eq">dω/dk = ω_m · cos(ka/2) · (a/2)</pre>
        </div>
        <p>
          Therefore
        </p>
        <div class="eqBox" data-copy="eq-a12">
<pre class="eq">|dk/dω| = 1 / |dω/dk| = 2 / (a ω_m |cos(ka/2)|)</pre>
        </div>
        <p>
          Express <span style="font-family:var(--mono)">cos(ka/2)</span> in terms of ω using <span style="font-family:var(--mono)">sin(ka/2)=ω/ω_m</span>.
          Since <span style="font-family:var(--mono)">cos² = 1 − sin²</span>,
        </p>
        <div class="eqBox" data-copy="eq-a13">
<pre class="eq">|cos(ka/2)| = √(1 − (ω/ω_m)²) = √(ω_m² − ω²)/ω_m</pre>
        </div>
        <p>
          Substitute into <span style="font-family:var(--mono)">|dk/dω|</span>:
        </p>
        <div class="eqBox" data-copy="eq-a14">
<pre class="eq">|dk/dω| = 2 / (a ω_m · (√(ω_m² − ω²)/ω_m)) = 2 / (a √(ω_m² − ω²))</pre>
        </div>
        <p>
          Plug into <span style="font-family:var(--mono)">D(ω) = (L/π)|dk/dω|</span> and use <span style="font-family:var(--mono)">L=Na</span>:
        </p>
        <div class="eqBox" data-copy="eq-a15">
<pre class="eq">D(ω) = (Na/π) · [2/(a √(ω_m² − ω²))] = (2N/π) · 1/√(ω_m² − ω²)</pre>
        </div>

        <div class="callout keyeq">
          <div class="labelRow"><span class="tag">Final result (a)</span><span class="tag">Van Hove singularity</span></div>
          <div class="eqBox" data-copy="eq-a-final">
<pre class="eq">D(ω) = (2N/π) · 1/√(ω_m² − ω²),   0 &lt; ω &lt; ω_m</pre>
          </div>
          <p style="margin:.55rem 0 0;">
            The divergence as <span style="font-family:var(--mono)">ω→ω_m</span> comes from <span style="font-family:var(--mono)">dω/dk→0</span> at the zone boundary.
          </p>
        </div>

        <h4>Sanity checks for (a)</h4>
        <ul>
          <li><b>Units:</b> RHS has <span style="font-family:var(--mono)">1/√(ω²)</span> ⇒ <span style="font-family:var(--mono)">1/ω</span>, correct for DOS per angular frequency.</li>
          <li><b>Limiting behavior:</b> as <span style="font-family:var(--mono)">ω→ω_m</span>, <span style="font-family:var(--mono)">D(ω) ~ (2N/π)/√(2ω_m(ω_m−ω))</span> diverges like <span style="font-family:var(--mono)}">(ω_m−ω)^{-1/2}</span>.</li>
          <li><b>Total mode count (shape check):</b> This is a single acoustic branch for N atoms (excluding the ω=0 translation nuance). The continuum DOS reproduces the correct N scaling; the divergence is integrable, so total number of modes is finite.</li>
        </ul>

        <details>
          <summary>Optional deeper note: δ-function derivation in 1D (same result, more formal)</summary>
          <p>
            Start from <span style="font-family:var(--mono)">D(ω)=∑_k δ(ω−ω(k))</span>, replace sum by integral:
            <span style="font-family:var(--mono)">D(ω)≈(L/2π)∫_{−π/a}^{π/a} dk δ(ω−ω(k))</span>.
            Use <span style="font-family:var(--mono)">δ(g(k))=Σ_i δ(k−k_i)/|g'(k_i)|</span> with
            <span style="font-family:var(--mono)">g(k)=ω−ω(k)</span>. Two roots ±k give the same Jacobian, yielding the factor 2 and the same formula.
          </p>
        </details>

        <hr style="border:none; border-top:1px solid var(--border); margin:1.1rem 0;"/>

        <h3>(b) 3D optical branch near <span style="font-family:var(--mono)">k=0</span>: discontinuous DOS</h3>

        <h4>Step B1 — Set up the DOS integral (mathematical definition)</h4>
        <p>
          With PBC in a cubic box of side <span style="font-family:var(--mono)">L</span>, allowed k-points form a lattice with spacing <span style="font-family:var(--mono)">2π/L</span> in each direction.
          In the large-<span style="font-family:var(--mono)">L</span> limit, the sum becomes
        </p>
        <div class="eqBox" data-copy="eq-b1">
<pre class="eq">∑_k  →  (L/2π)³ ∫ d³k</pre>
        </div>
        <p>
          For one phonon branch, the DOS is
        </p>
        <div class="eqBox" data-copy="eq-b2a">
<pre class="eq">D(ω) = (L/2π)³ ∫ d³k  δ(ω − ω(k))</pre>
        </div>
        <p>
          This is the cleanest “mathematical physics” statement: you are pushing forward uniform k-space counting through the function <span style="font-family:var(--mono)">ω(k)</span>.
        </p>

        <h4>Step B2 — Insert the quadratic dispersion and identify the support</h4>
        <p>Given near <span style="font-family:var(--mono)">k=0</span>:</p>
        <div class="eqBox" data-copy="eq-b3">
<pre class="eq">ω(k) = ω₀ − A k²,    k = |k|,   A &gt; 0</pre>
        </div>
        <p>
          Solve <span style="font-family:var(--mono)">ω = ω₀ − A k²</span> for k:
        </p>
        <div class="eqBox" data-copy="eq-b4">
<pre class="eq">k² = (ω₀ − ω)/A</pre>
        </div>
        <p>
          A real k exists only if <span style="font-family:var(--mono)">ω≤ω₀</span>. Therefore,
          <span style="font-family:var(--mono)">D(ω)=0</span> for <span style="font-family:var(--mono)">ω&gt;ω₀</span> (within this local model).
        </p>

        <h4>Step B3 — Evaluate the δ-integral in spherical coordinates (intermediate steps shown)</h4>
        <p>
          Because the dispersion is isotropic in k (depends only on <span style="font-family:var(--mono)">k=|k|</span>), switch to spherical coordinates:
          <span style="font-family:var(--mono)">d³k = k² sinθ dθ dφ dk</span>, and the angular integral gives <span style="font-family:var(--mono)">∫ dΩ = 4π</span>.
        </p>
        <div class="eqBox" data-copy="eq-b5">
<pre class="eq">D(ω) = (L/2π)³ ∫_0^∞ (4π k² dk) δ(ω − (ω₀ − A k²))</pre>
        </div>
        <p>
          Define the 1D function inside the δ:
        </p>
        <div class="eqBox" data-copy="eq-b6">
<pre class="eq">f(k) = ω − ω₀ + A k²</pre>
        </div>
        <p>
          Then <span style="font-family:var(--mono)">δ(ω − (ω₀ − A k²)) = δ(f(k))</span>.
          The root (for <span style="font-family:var(--mono)">ω&lt;ω₀</span>) is
          <span style="font-family:var(--mono)">k_0 = √((ω₀ − ω)/A)</span>.
          The δ-function identity for a simple root is:
        </p>
        <div class="eqBox" data-copy="eq-b7">
<pre class="eq">δ(f(k)) = δ(k − k₀)/|f'(k₀)|   (since k≥0 keeps only the positive root)</pre>
        </div>
        <p>
          Differentiate:
        </p>
        <div class="eqBox" data-copy="eq-b8">
<pre class="eq">f'(k) = d/dk (ω − ω₀ + A k²) = 2A k</pre>
        </div>
        <p>So <span style="font-family:var(--mono)">|f'(k₀)| = 2A k₀</span>. Substitute into the integral:</p>
        <div class="eqBox" data-copy="eq-b9">
<pre class="eq">D(ω) = (L/2π)³ ∫_0^∞ 4π k² dk · [δ(k − k₀)/(2A k₀)]</pre>
        </div>
        <p>Use the sifting property <span style="font-family:var(--mono)">∫ g(k) δ(k−k₀) dk = g(k₀)</span>:</p>
        <div class="eqBox" data-copy="eq-b10">
<pre class="eq">D(ω) = (L/2π)³ · 4π · (k₀²)/(2A k₀) = (L/2π)³ · (2π/A) · k₀</pre>
        </div>
        <p>Now insert <span style="font-family:var(--mono)">k₀ = √((ω₀ − ω)/A)</span>:</p>
        <div class="eqBox" data-copy="eq-b11">
<pre class="eq">D(ω) = (L/2π)³ · (2π/A) · √((ω₀ − ω)/A)
     = (L/2π)³ · (2π/A)^{3/2} · (ω₀ − ω)^{1/2}</pre>
        </div>

        <div class="callout keyeq">
          <div class="labelRow"><span class="tag">Final result (b)</span><span class="tag">Edge DOS</span></div>
          <div class="eqBox" data-copy="eq-b-final">
<pre class="eq">D(ω) = (L/2π)³ · (2π/A)^{3/2} · (ω₀ − ω)^{1/2}   for ω &lt; ω₀
D(ω) = 0                                         for ω &gt; ω₀</pre>
          </div>
          <p style="margin:.55rem 0 0;">
            The DOS is <b>discontinuous</b> at <span style="font-family:var(--mono)">ω=ω₀</span>: it drops to zero above the maximum frequency.
          </p>
        </div>

        <h4>Sanity checks for (b)</h4>
        <ul>
          <li><b>Units:</b> <span style="font-family:var(--mono)">(L/2π)³</span> has units m³; <span style="font-family:var(--mono)">A</span> must have units (rad/s)·m² because <span style="font-family:var(--mono)">Ak²</span> has units rad/s. Then <span style="font-family:var(--mono)">(2π/A)^{3/2}(ω₀−ω)^{1/2}</span> has units <span style="font-family:var(--mono)">(m^{-3})·(s)</span>, so multiplying by m³ yields <span style="font-family:var(--mono)">s</span> = <span style="font-family:var(--mono)">1/(rad/s)</span>. Correct.</li>
          <li><b>Limiting case:</b> as <span style="font-family:var(--mono)">ω→ω₀^−</span>, <span style="font-family:var(--mono)">D(ω)→0</span> like <span style="font-family:var(--mono)}">(ω₀−ω)^{1/2}</span> (no divergence in 3D for this edge form).</li>
          <li><b>Physical meaning:</b> near the maximum, only very small k modes exist; the number of states shrinks with the radius of the k-sphere: <span style="font-family:var(--mono)">k₀ ∝ √(ω₀−ω)</span>.</li>
        </ul>

        <details>
          <summary>Optional deeper note: geometric surface formula in 3D</summary>
          <p>
            A general identity (for smooth dispersions) is
            <span style="font-family:var(--mono)">D(ω) = (L/2π)³ ∫_{S(ω)} dS / |∇_k ω|</span>,
            where <span style="font-family:var(--mono)">S(ω)</span> is the constant-frequency surface in k-space.
            Here <span style="font-family:var(--mono)">S(ω)</span> is a sphere of radius <span style="font-family:var(--mono)">k₀</span>, so <span style="font-family:var(--mono)">dS=4πk₀²</span>,
            and <span style="font-family:var(--mono)">|∇_k ω|=|dω/dk|=2Ak₀</span>. Hence
            <span style="font-family:var(--mono)">D(ω)=(L/2π)³(4πk₀²)/(2Ak₀)=(L/2π)³(2π/A)k₀</span>, matching the δ-method.
          </p>
        </details>

        <div class="callout" id="final-answer" style="margin-top:1rem;">
          <div class="labelRow"><span class="tag">Final Answer (plain)</span><span class="tag">Both parts</span></div>
          <div class="eqBox" data-copy="final-answer">
<pre class="eq">(a) 1D monatomic chain (nearest neighbors, N atoms, ωm = max frequency):
    D(ω) = (2N/π) · 1/√(ωm² − ω²),   0 &lt; ω &lt; ωm.

(b) 3D optical branch near k=0 with ω(k)=ω0−Ak² (A&gt;0), cubic size L:
    D(ω) = (L/2π)³ · (2π/A)^{3/2} · (ω0 − ω)^{1/2}  for ω &lt; ω0,
    D(ω) = 0                                       for ω &gt; ω0.</pre>
          </div>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </article>

      <article id="deeper">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpreting the formulas</h3>
        <div class="grid2">
          <div class="callout">
            <div class="labelRow"><span class="tag">1D result meaning</span></div>
            <p>
              <span style="font-family:var(--mono)">D(ω) ∝ 1/|dω/dk|</span> (up to constants and ±k counting).
              The divergence occurs where the dispersion has a stationary point (band edge), i.e.,
              <span style="font-family:var(--mono)">dω/dk = 0</span>. This is the simplest Van Hove singularity.
            </p>
          </div>
          <div class="callout">
            <div class="labelRow"><span class="tag">3D edge meaning</span></div>
            <p>
              In 3D, the number of states at radius k scales like the surface area <span style="font-family:var(--mono)">4πk²</span>.
              At an optical maximum, small k implies small area, which <b>suppresses</b> the DOS:
              <span style="font-family:var(--mono)">D(ω) ∝ k₀ ∝ √(ω₀−ω)</span>.
            </p>
          </div>
        </div>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li><b>(a) N:</b> DOS scales linearly with <span style="font-family:var(--mono)">N</span> (more atoms ⇒ more modes).</li>
          <li><b>(a) ωm:</b> sets the band-edge location; changing stiffness/mass shifts where the singularity occurs (<span style="font-family:var(--mono)">ωm=2√(K/m)</span>).</li>
          <li><b>(b) L:</b> DOS scales with volume <span style="font-family:var(--mono)">L³</span>, as expected for bulk modes.</li>
          <li><b>(b) A:</b> larger <span style="font-family:var(--mono)">A</span> makes ω drop faster with k, reducing states per ω: the prefactor scales as <span style="font-family:var(--mono)">A^{-3/2}</span>.</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Instead of δ-functions, you can compute the <b>integrated DOS</b>
          <span style="font-family:var(--mono)">N(ω)=# {modes with frequency ≤ ω}</span> and then differentiate:
          <span style="font-family:var(--mono)">D(ω)=dN/dω</span>.
          In (b), the set <span style="font-family:var(--mono)">ω(k)≥ω</span> is the ball <span style="font-family:var(--mono)">k≤k₀</span>;
          its k-volume is <span style="font-family:var(--mono)">(4π/3)k₀³</span>, giving
          <span style="font-family:var(--mono)">N(ω)∝k₀³∝(ω₀−ω)^{3/2}</span> and thus <span style="font-family:var(--mono)">D(ω)∝(ω₀−ω)^{1/2}</span>.
        </p>

        <h3>Concept check (self-test)</h3>
        <ul>
          <li><b>Q:</b> Why does 1D show a divergence but 3D optical edge goes to zero? <br/>
              <b>A:</b> 1D has only the Jacobian <span style="font-family:var(--mono)">1/|dω/dk|</span>; at a stationary point it blows up. In 3D, phase-space has <span style="font-family:var(--mono)">k²</span> which shrinks to zero at the edge and can dominate.</li>
          <li><b>Q:</b> What mathematical identity is essential for δ-function DOS? <br/>
              <b>A:</b> <span style="font-family:var(--mono)">δ(f(x)) = Σ_i δ(x−x_i)/|f'(x_i)|</span> for simple zeros <span style="font-family:var(--mono)">f(x_i)=0</span>.</li>
          <li><b>Q:</b> What does “discontinuous DOS” mean in (b)? <br/>
              <b>A:</b> For <span style="font-family:var(--mono)">ω&gt;ω₀</span> there are no real k solutions, so DOS is exactly zero; just below <span style="font-family:var(--mono)">ω₀</span> it is small but nonzero, hence an abrupt drop at the edge.</li>
          <li><b>Q:</b> If the optical dispersion were <span style="font-family:var(--mono)">ω=ω₀−A(k_x²+k_y²+η k_z²)</span>, what changes? <br/>
              <b>A:</b> The exponent <span style="font-family:var(--mono)">1/2</span> stays, but the prefactor changes due to anisotropic ellipsoidal shells (a determinant/metric factor).</li>
        </ul>

        <a class="backTop" href="#top">↑ Back to top</a>
      </article>

      <article id="plotguide">
        <h2>PART 5 — Optional Plot Guide</h2>

        <figure>
          <canvas id="dosPlot" aria-label="Plot of example DOS shapes"></canvas>
          <figcaption>
            <b>One plot (example values):</b> 1D DOS shape <span style="font-family:var(--mono)">D(ω)∝1/√(ω_m²−ω²)</span> (diverges at <span style="font-family:var(--mono)">ω_m</span>)
            and 3D optical-edge DOS <span style="font-family:var(--mono)">D(ω)∝√(ω₀−ω)</span> for <span style="font-family:var(--mono)">ω&lt;ω₀</span> (goes to 0 at <span style="font-family:var(--mono)">ω₀</span>).
            Curves are normalized to compare shapes, using <span style="font-family:var(--mono)">ω_m=ω₀=1</span> (dimensionless) and a small cutoff to avoid infinite plotting.
          </figcaption>
        </figure>

        <div class="callout">
          <div class="labelRow"><span class="tag">What it shows</span><span class="tag">Why useful</span></div>
          <ul>
            <li><b>Axes:</b> horizontal is normalized frequency <span style="font-family:var(--mono)">ω/ω*</span>; vertical is normalized DOS (shape only).</li>
            <li><b>Example values:</b> <span style="font-family:var(--mono)">ω_m=ω₀=1</span> (dimensionless scaling), and the 3D curve is plotted on <span style="font-family:var(--mono)">ω≤ω₀</span> only.</li>
            <li><b>Features to notice:</b> 1D curve shoots upward near the band edge (Van Hove divergence); 3D optical curve smoothly goes to zero at the edge and is zero above it (discontinuity in support).</li>
          </ul>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </article>

      <footer style="opacity:.9; padding: .2rem 0 2rem; color: var(--muted);">
        <p style="margin:.3rem 0;">
          Built as a self-contained learning article: no external libraries, print-friendly, and focused on rigorous steps.
        </p>
      </footer>

    </div>
  </main>

  <script>
    // ---------- Copy buttons ----------
    const copyMap = new Map();
    document.querySelectorAll('.eqBox[data-copy]').forEach(box=>{
      const key = box.getAttribute('data-copy');
      const text = box.innerText.replace(/\u00A0/g,' ').trim();
      copyMap.set(key, text);
    });

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        document.body.appendChild(ta);
        ta.select();
        let ok = false;
        try{ ok = document.execCommand('copy'); }catch(err){}
        document.body.removeChild(ta);
        return ok;
      }
    }

    document.querySelectorAll('button.copyBtn').forEach(btn=>{
      btn.addEventListener('click', async ()=>{
        const key = btn.getAttribute('data-copy-target');
        const text = copyMap.get(key) || '';
        const ok = await copyText(text);
        const old = btn.textContent;
        btn.textContent = ok ? 'Copied ✓' : 'Copy failed';
        setTimeout(()=>btn.textContent = old, 900);
      });
    });

    // ---------- One static plot on canvas (high-DPI, responsive) ----------
    const canvas = document.getElementById('dosPlot');
    const ctx = canvas.getContext('2d');

    function dpr(){
      return window.devicePixelRatio || 1;
    }

    function resizeCanvas(){
      const rect = canvas.getBoundingClientRect();
      const scale = dpr();
      canvas.width = Math.max(1, Math.floor(rect.width * scale));
      canvas.height = Math.max(1, Math.floor(rect.height * scale));
      ctx.setTransform(scale,0,0,scale,0,0); // draw in CSS pixels
      drawPlot(rect.width, rect.height);
    }

    function drawPlot(W, H){
      // Layout
      const padL = 58, padR = 16, padT = 38, padB = 46;
      const x0 = padL, y0 = H - padB, x1 = W - padR, y1 = padT;
      const plotW = x1 - x0, plotH = y0 - y1;

      // Clear
      ctx.clearRect(0,0,W,H);

      // Helpers
      function line(xa,ya,xb,yb){
        ctx.beginPath(); ctx.moveTo(xa,ya); ctx.lineTo(xb,yb); ctx.stroke();
      }
      function text(str,x,y,align='left',baseline='alphabetic'){
        ctx.textAlign = align; ctx.textBaseline = baseline; ctx.fillText(str,x,y);
      }

      // Colors (auto from computed styles, but canvas needs explicit)
      const style = getComputedStyle(document.body);
      const textCol = style.getPropertyValue('--text').trim() || '#e9eefc';
      const mutedCol = style.getPropertyValue('--muted').trim() || '#b6c1e6';
      const borderCol = style.getPropertyValue('--border').trim() || 'rgba(255,255,255,.10)';

      // Draw frame
      ctx.lineWidth = 1;
      ctx.strokeStyle = borderCol;
      ctx.fillStyle = 'transparent';
      ctx.strokeRect(x0, y1, plotW, plotH);

      // Axes scales (dimensionless for example plot)
      const xmin = 0, xmax = 1.05;      // allow slight above 1 to show "zero beyond edge"
      const ymin = 0, ymax = 3.2;       // normalized arbitrary

      function X(x){ return x0 + (x - xmin) / (xmax - xmin) * plotW; }
      function Y(y){ return y0 - (y - ymin) / (ymax - ymin) * plotH; }

      // Gridlines + ticks
      ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      ctx.strokeStyle = borderCol;
      ctx.fillStyle = mutedCol;

      const xTicks = 6;
      for(let i=0;i<=xTicks;i++){
        const x = xmin + (xmax-xmin)*i/xTicks;
        const xp = X(x);
        ctx.globalAlpha = 0.65;
        line(xp, y0, xp, y1);
        ctx.globalAlpha = 1;
        text(x.toFixed(2), xp, y0+18, 'center', 'alphabetic');
      }

      const yTicks = 5;
      for(let j=0;j<=yTicks;j++){
        const y = ymin + (ymax-ymin)*j/yTicks;
        const yp = Y(y);
        ctx.globalAlpha = 0.65;
        line(x0, yp, x1, yp);
        ctx.globalAlpha = 1;
        text(y.toFixed(1), x0-8, yp, 'right', 'middle');
      }

      // Titles/labels
      ctx.fillStyle = textCol;
      ctx.font = '14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      text('Example DOS Shapes: 1D Van Hove vs 3D Optical Edge', (x0+x1)/2, 16, 'center', 'alphabetic');

      ctx.fillStyle = mutedCol;
      ctx.font = '13px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      text('Normalized frequency ω/ω* (dimensionless)', (x0+x1)/2, H-10, 'center', 'alphabetic');

      // y-axis label (rotated)
      ctx.save();
      ctx.translate(16, (y0+y1)/2);
      ctx.rotate(-Math.PI/2);
      ctx.fillStyle = mutedCol;
      ctx.font = '13px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      text('Normalized DOS (shape only)', 0, 0, 'center', 'alphabetic');
      ctx.restore();

      // Curves (normalized)
      // 1D: f1(x)=1/sqrt(1-x^2), avoid x near 1
      // 3D edge: f3(x)=sqrt(1-x) for x<=1 else 0
      const eps = 0.02;

      // compute normalization constants to fit view
      function f1(x){
        if(x >= 1-eps) return 1/Math.sqrt(1-(1-eps)*(1-eps));
        return 1/Math.sqrt(Math.max(1e-12, 1 - x*x));
      }
      function f3(x){
        if(x>1) return 0;
        return Math.sqrt(Math.max(0, 1-x));
      }
      // scale both to comparable heights
      // map f1 at x=0.98 to ~3, f3 at x=0 to ~2
      const s1 = 3.0 / f1(0.98);
      const s3 = 2.0 / f3(0.0);

      // draw curve helper
      function drawCurve(f, scale, strokeStyle, dash=false){
        ctx.strokeStyle = strokeStyle;
        ctx.lineWidth = 2;
        ctx.setLineDash(dash ? [6,4] : []);
        ctx.beginPath();
        let started = false;
        const n = 360;
        for(let i=0;i<=n;i++){
          const x = xmin + (xmax-xmin)*i/n;
          let y = scale * f(x);
          if(!isFinite(y)) y = ymax;
          y = Math.min(y, ymax);
          const xp = X(x);
          const yp = Y(y);
          if(!started){
            ctx.moveTo(xp, yp);
            started = true;
          }else{
            ctx.lineTo(xp, yp);
          }
        }
        ctx.stroke();
        ctx.setLineDash([]);
      }

      // Choose readable colors based on theme using simple RGBA
      const col1 = (style.getPropertyValue('--accent').trim() || '#7aa2ff');
      const col2 = (style.getPropertyValue('--accent2').trim() || '#70e1c8');

      drawCurve(f1, s1, col1, false);
      drawCurve(f3, s3, col2, true);

      // Legend
      const lx = x0 + 12, ly = y1 + 10;
      ctx.font = '13px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
      ctx.fillStyle = textCol;

      // legend items
      ctx.strokeStyle = col1; ctx.lineWidth = 2;
      line(lx, ly, lx+28, ly);
      ctx.fillStyle = mutedCol;
      text('1D: D(ω) ∝ 1/√(1−(ω/ωm)²)', lx+36, ly+4, 'left', 'middle');

      ctx.strokeStyle = col2; ctx.lineWidth = 2;
      ctx.setLineDash([6,4]);
      line(lx, ly+18, lx+28, ly+18);
      ctx.setLineDash([]);
      ctx.fillStyle = mutedCol;
      text('3D edge: D(ω) ∝ √(1−ω/ω0) (ω≤ω0)', lx+36, ly+22, 'left', 'middle');
    }

    window.addEventListener('resize', resizeCanvas, {passive:true});
    // Initial
    resizeCanvas();
  </script>
</body>
</html>
