<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title>Soft Phonon Modes in a 1D Alternating-Charge Ionic Chain (Short-Range + Coulomb)</title>
  <style>
    :root{
      --bg: #0b0c10;
      --panel:#11131a;
      --panel2:#0f1117;
      --text:#e9eef7;
      --muted:#b7c0d4;
      --faint:#8b94a9;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line: rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f7f8fb;
        --panel:#ffffff;
        --panel2:#fbfcff;
        --text:#0b1020;
        --muted:#36405a;
        --faint:#5b667f;
        --accent:#0284c7;
        --accent2:#6d28d9;
        --line: rgba(0,0,0,.10);
        --shadow: 0 10px 30px rgba(10,20,50,.12);
      }
    }

    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 800px at 15% 10%, rgba(125,211,252,.10), transparent 55%),
                  radial-gradient(1200px 800px at 85% 20%, rgba(167,139,250,.12), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }

    header{
      padding: 38px 18px 18px;
      max-width: 1180px;
      margin: 0 auto;
    }
    .hero{
      display:grid;
      grid-template-columns: 1.3fr .7fr;
      gap: 16px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .hero{grid-template-columns:1fr}
    }
    .titleCard{
      background: linear-gradient(180deg, rgba(125,211,252,.10), rgba(167,139,250,.08));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 18px 14px;
      position:relative;
      overflow:hidden;
    }
    .titleCard:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(500px 220px at 15% 0%, rgba(125,211,252,.22), transparent 55%),
                  radial-gradient(500px 220px at 80% 10%, rgba(167,139,250,.22), transparent 60%);
      pointer-events:none;
      filter: blur(0px);
      opacity:.8;
    }
    .titleCard > *{position:relative}
    h1{
      margin:0 0 8px;
      font-size: clamp(1.4rem, 2.2vw, 2.1rem);
      letter-spacing:.2px;
    }
    .subtitle{
      margin:0;
      color: var(--muted);
      font-size: 0.98rem;
      max-width: 70ch;
    }

    .metaCard{
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px 14px 14px;
    }
    .pillRow{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:8px;
    }
    .pill{
      border: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 0.86rem;
      color: var(--muted);
      white-space: nowrap;
    }
    .pill b{color:var(--text); font-weight:650}

    main{
      max-width: 1180px;
      margin: 0 auto;
      padding: 0 18px 54px;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap: 16px;
      align-items:start;
    }
    @media (max-width: 980px){
      main{grid-template-columns:1fr}
    }

    nav#toc{
      position: sticky;
      top: 14px;
      align-self:start;
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 12px 12px 10px;
    }
    @media (max-width: 980px){
      nav#toc{position:relative; top:auto}
    }
    .tocTitle{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      margin-bottom: 8px;
    }
    .tocTitle span{
      font-weight: 750;
      letter-spacing:.2px;
    }
    .tocLinks{
      display:flex; flex-direction:column; gap:6px;
      margin:0; padding:0;
      list-style:none;
      max-height: 60vh;
      overflow:auto;
      scrollbar-width: thin;
    }
    .tocLinks a{
      text-decoration:none;
      color: var(--muted);
      border: 1px solid transparent;
      padding: 7px 9px;
      border-radius: 12px;
      display:block;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }
    .tocLinks a:hover{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.20);
      transform: translateY(-1px);
      color: var(--text);
    }

    article{
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    section{
      padding: 18px 18px;
      border-top: 1px solid var(--line);
    }
    section:first-child{border-top:none}
    h2{
      margin: 0 0 10px;
      font-size: 1.25rem;
      letter-spacing:.2px;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 1.05rem;
      color: var(--text);
    }
    p{margin: 8px 0; color: var(--text)}
    ul{margin: 8px 0 8px 20px; color: var(--text)}
    li{margin: 6px 0}
    .muted{color:var(--muted)}
    .faint{color:var(--faint)}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 900px){ .grid2{grid-template-columns:1fr} }

    .callout{
      border: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border-radius: 16px;
      padding: 12px 12px;
      margin: 10px 0;
    }
    .callout .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size: .85rem;
      color: var(--muted);
      border: 1px solid var(--line);
      padding: 5px 9px;
      border-radius: 999px;
      background: rgba(0,0,0,.10);
      margin-bottom: 8px;
    }
    .tagDot{
      width:9px; height:9px; border-radius:999px;
      background: var(--accent);
      box-shadow: 0 0 0 4px rgba(125,211,252,.12);
    }
    .tagDot.warn{background: var(--warn); box-shadow:0 0 0 4px rgba(251,191,36,.14)}
    .tagDot.bad{background: var(--bad); box-shadow:0 0 0 4px rgba(251,113,133,.14)}
    .tagDot.good{background: var(--good); box-shadow:0 0 0 4px rgba(52,211,153,.14)}

    .eqBlock{
      position:relative;
      border: 1px solid var(--line);
      background: var(--panel2);
      border-radius: 16px;
      padding: 12px 44px 12px 12px;
      margin: 10px 0;
      overflow:auto;
    }
    pre, code{
      font-family: var(--mono);
      font-size: 0.92rem;
    }
    pre{margin:0; white-space:pre; }
    .copyBtn{
      position:absolute;
      top:10px; right:10px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      color: var(--text);
      border-radius: 12px;
      padding: 7px 10px;
      cursor:pointer;
      font-size: .85rem;
      transition: transform .15s ease, filter .15s ease;
    }
    .copyBtn:hover{transform: translateY(-1px); filter: brightness(1.05)}
    .copyBtn:active{transform: translateY(0px); filter: brightness(.98)}
    .copyBtn small{color:var(--muted)}
    .copyToast{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 18px;
      background: rgba(0,0,0,.75);
      color: #fff;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.18);
      opacity: 0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      z-index: 50;
    }
    .copyToast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-4px);
    }

    details{
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 10px 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      margin: 10px 0;
    }
    details summary{
      cursor:pointer;
      font-weight: 700;
      color: var(--text);
    }
    details summary .hint{font-weight: 500; color: var(--muted)}
    .backTop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      color: var(--muted);
      border:1px solid var(--line);
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.03);
      margin-top: 8px;
      transition: transform .15s ease, background .15s ease;
    }
    .backTop:hover{transform: translateY(-1px); background: rgba(125,211,252,.10); color: var(--text)}
    figure{
      margin: 10px 0 0;
      border:1px solid var(--line);
      border-radius: 16px;
      overflow:hidden;
      background: var(--panel2);
    }
    figcaption{
      padding: 10px 12px;
      color: var(--muted);
      border-top:1px solid var(--line);
      font-size: .92rem;
    }
    canvas{display:block; width:100%; height: 320px;}
    .mini{
      font-size:.92rem;
      color: var(--muted);
    }

    /* Print-friendly */
    @media print{
      nav#toc{display:none}
      body{background:#fff}
      article, .titleCard, .metaCard{box-shadow:none}
      section{break-inside:avoid}
      .copyBtn{display:none}
      a{color:#000; text-decoration:none}
    }
  </style>
</head>
<body>
  <a id="top"></a>
  <header>
    <div class="hero">
      <div class="titleCard">
        <h1>Soft Phonon Modes in a 1D Alternating-Charge Ionic Chain</h1>
        <p class="subtitle">
          We derive the phonon dispersion for an infinite one-dimensional chain of equal masses with alternating ionic charge,
          including both a nearest-neighbor short-range spring and a long-range Coulomb interaction. We then identify when the
          lattice becomes unstable (“soft mode” where ω² &lt; 0).
        </p>
        <div class="pillRow">
          <span class="pill"><b>Topic:</b> lattice dynamics · dispersion · stability</span>
          <span class="pill"><b>Math lens:</b> eigenvalue problem of a discrete operator</span>
          <span class="pill"><b>Key idea:</b> long-range forces can destabilize acoustic modes</span>
        </div>
      </div>
      <div class="metaCard">
        <div class="muted" style="font-weight:750;">What you will get</div>
        <ul class="mini">
          <li>Atomic force constants from Coulomb interactions: <span class="faint">C<sub>nC</sub></span></li>
          <li>Closed-form dispersion as a convergent series in <span class="faint">p</span></li>
          <li>Zone-boundary instability threshold involving ζ(3)</li>
          <li>Small-k asymptotics giving an imaginary sound speed beyond a critical σ</li>
        </ul>
      </div>
    </div>
  </header>

  <main>
    <nav id="toc" aria-label="Table of Contents">
      <div class="tocTitle">
        <span>Contents</span>
        <span class="faint" style="font-size:.85rem;">sticky</span>
      </div>
      <ul class="tocLinks">
        <li><a href="#qs">Quick Summary</a></li>
        <li><a href="#p0">PART 0 — Concept Primer</a></li>
        <li><a href="#p0b">PART 0B — Industry & Applied Physics Perspective</a></li>
        <li><a href="#p1">PART 1 — Problem Analysis</a></li>
        <li><a href="#p2">PART 2 — Strategy & Tips</a></li>
        <li><a href="#p3">PART 3 — Full Solution</a></li>
        <li><a href="#p4">PART 4 — Deeper Understanding</a></li>
        <li><a href="#p5">PART 5 — Optional Plot Guide</a></li>
      </ul>
    </nav>

    <article>
      <section id="qs">
        <h2>Quick Summary</h2>
        <ul>
          <li><b>What this problem is about:</b> phonon modes in a 1D ionic chain with <b>alternating charge</b>, including <b>short-range</b> and <b>long-range Coulomb</b> forces.</li>
          <li><b>Key physics idea:</b> long-range Coulomb interactions modify the dynamical matrix and can drive a <b>soft mode</b> where ω² becomes negative (instability).</li>
          <li><b>Mathematical core:</b> a linearized equation of motion on an infinite lattice is an <b>eigenvalue problem</b> for a translation-invariant discrete operator; plane waves diagonalize it.</li>
          <li><b>Governing equation:</b> for displacements u<sub>n</sub>(t),
            <span class="muted">M ü<sub>n</sub> = −∑<sub>m</sub> Φ<sub>n−m</sub> u<sub>m</sub></span>, where Φ is the force-constant matrix.</li>
          <li><b>Key intermediate result:</b> Coulomb contribution to force constants:
            <span class="muted">C<sub>pC</sub> = 2(−1)<sup>p</sup> e²/(p³ a³)</span>.</li>
          <li><b>Dispersion (series form):</b>
            <span class="muted">ω²/ω₀² = sin²(Ka/2) + σ ∑<sub>p=1</sub>∞ (−1)<sup>p</sup>(1−cos(pKa))/p³</span>.</li>
          <li><b>Zone-boundary instability:</b> at Ka = π, ω² &lt; 0 if <b>σ &gt; 4/(7 ζ(3)) ≈ 0.475</b>.</li>
          <li><b>Small-k instability:</b> the <b>sound speed becomes imaginary</b> if <b>σ &gt; 1/(2 ln 2) ≈ 0.721</b>.</li>
          <li><b>Physical meaning:</b> for 0.475 &lt; σ &lt; 0.721, ω² crosses zero at some Ka ∈ (0, π): the lattice is unstable in a band of wavevectors.</li>
        </ul>

        <div class="callout">
          <div class="tag"><span class="tagDot good"></span><span><b>Math Insight:</b> The dispersion relation is the spectrum of a <i>discrete convolution operator</i> (a lattice “Laplacian” plus a long-range kernel). Plane waves are eigenvectors because the operator is translation-invariant.</span></div>
          <p class="muted" style="margin:0">
            In continuum language, we often solve PDE eigenvalue problems using Fourier modes because ∇² is diagonal in k-space.
            Here, the same logic applies to a <b>discrete</b> operator on ℤ: convolution becomes multiplication in Fourier space.
          </p>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="p0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <div class="grid2">
          <div class="callout">
            <div class="tag"><span class="tagDot"></span><span><b>Core Definitions</b> (symbols & units)</span></div>
            <ul class="mini">
              <li><b>n</b> ∈ ℤ: lattice site index (1D chain).</li>
              <li><b>a</b> (m): equilibrium nearest-neighbor spacing.</li>
              <li><b>x<sub>n</sub></b> = n a: equilibrium position of ion n.</li>
              <li><b>u<sub>n</sub>(t)</b> (m): small displacement from equilibrium.</li>
              <li><b>M</b> (kg): (equal) ionic mass.</li>
              <li><b>e<sub>n</sub></b> = e(−1)<sup>n</sup> (C): alternating charge.</li>
              <li><b>γ</b> (N/m): short-range nearest-neighbor force constant (spring).</li>
              <li><b>K</b> (1/m): wave number in the first Brillouin zone, K ∈ [−π/a, π/a].</li>
              <li><b>ω</b> (rad/s): phonon angular frequency.</li>
              <li><b>σ</b> = e²/(γ a³) (dimensionless): Coulomb-to-spring strength ratio (after scaling).</li>
              <li><b>ζ(3)</b>: Riemann zeta at 3, ζ(3)=∑<sub>p=1</sub>∞ 1/p³.</li>
            </ul>
          </div>

          <div class="callout">
            <div class="tag"><span class="tagDot"></span><span><b>Physical Meaning</b> (intuition)</span></div>
            <ul class="mini">
              <li><b>Force constants Φ</b> measure how strongly a displacement at one site changes forces at others (harmonic approximation).</li>
              <li><b>Short-range spring</b> gives a discrete Laplacian: neighbors oppose relative displacement → stabilizing.</li>
              <li><b>Coulomb interaction</b> is long-range and sign-alternating because charges alternate → can be stabilizing at some k and destabilizing at others.</li>
              <li><b>Soft mode</b>: ω² → 0 at some nonzero K; if ω² &lt; 0 then ω is imaginary → exponential growth in time → mechanical instability.</li>
            </ul>
          </div>
        </div>

        <h3>Key laws / principles and validity conditions</h3>
        <ul>
          <li><b>Newton’s second law:</b> M ü<sub>n</sub> = F<sub>n</sub>.</li>
          <li><b>Harmonic approximation:</b> expand potential energy to second order in displacements: valid for small |u<sub>n</sub>| ≪ a.</li>
          <li><b>Translation invariance:</b> equilibrium is periodic → force constants depend only on separation p = n−m.</li>
          <li><b>Normal modes:</b> linear system with constant coefficients → solutions in Fourier modes e^{i(Kna−ωt)}.</li>
        </ul>

        <h3>Common models/approximations used here</h3>
        <ul>
          <li><b>Pairwise interactions</b> only (short-range NN spring + Coulomb between all pairs).</li>
          <li><b>1D longitudinal motion</b> (displacements along the chain).</li>
          <li><b>Infinite chain</b> (or periodic boundary conditions with N→∞), enabling Fourier diagonalization.</li>
          <li><b>Neglect of retardation/EM radiation</b>: Coulomb treated as instantaneous (electrostatic limit).</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li><b>Pure NN spring chain:</b> ω² ∝ sin²(Ka/2), always ≥ 0 → stable acoustic branch.</li>
          <li><b>Adding long-range terms:</b> ω² becomes “NN part + weighted sum of (1−cos pKa)”; depending on signs of weights, the sum can reduce ω² and even make it negative.</li>
          <li><b>Zone boundary (Ka=π):</b> neighbors oscillate out of phase; with alternating charges, far interactions can align to reduce restoring force strongly.</li>
        </ul>

        <div class="callout">
          <div class="tag"><span class="tagDot warn"></span><span><b>What to watch for</b> (pitfalls)</span></div>
          <ul class="mini">
            <li>Sign conventions: <b>Φ</b> vs <b>C</b> (some texts define C<sub>p</sub> = −Φ<sub>p</sub> for p≠0). Keep one convention consistently.</li>
            <li>For Coulomb, the <b>second derivative</b> of 1/r gives a 1/r³ factor in the harmonic force constant.</li>
            <li>At Ka = π, <b>only odd p contribute</b> because 1−cos(pπ) is 0 for even p and 2 for odd p.</li>
            <li>Small-k expansion: use cos(pKa) ≈ 1 − (pKa)²/2, but only after confirming the series converges (it does here because of 1/p³).</li>
          </ul>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="p0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <h3>Where this phenomenon appears (real applications)</h3>
        <ul>
          <li><b>Ferroelectrics / piezoelectrics:</b> soft optical/zone-boundary modes often signal structural transitions that control dielectric and piezoelectric performance.</li>
          <li><b>Ionic conductors & solid electrolytes:</b> lattice instabilities can open diffusion pathways (good for conductivity) but can also trigger degradation phases.</li>
          <li><b>Thermal management materials:</b> soft modes increase anharmonic scattering → reduce thermal conductivity (useful in thermoelectrics; risky for power electronics).</li>
          <li><b>MEMS/NEMS resonators with electrostatic bias:</b> long-range electrostatic forces can “soften” mechanical modes and cause pull-in instabilities (a close cousin of ω²&lt;0).</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><b>Performance:</b> phonon spectra set heat capacity, thermal conductivity, and sometimes dielectric response.</li>
          <li><b>Reliability:</b> soft modes can precede phase transitions, cracking, or electromigration-assisted failure paths.</li>
          <li><b>Manufacturability:</b> stability margins matter because defects, strain, and compositional disorder effectively change parameters like σ.</li>
          <li><b>Cost & safety:</b> unstable phases may require tighter process control or lower operating fields/temperatures.</li>
        </ul>

        <h3>Measurement / validation methods</h3>
        <ul>
          <li><b>Inelastic neutron/X-ray scattering:</b> direct measurement of ω(K) in crystals.</li>
          <li><b>Raman/IR spectroscopy:</b> probes zone-center modes; softening with temperature/field is a standard signature.</li>
          <li><b>Brillouin scattering / ultrasonics:</b> measures sound velocity (small-k slope), relevant to the σ &gt; 1/(2 ln 2) criterion here.</li>
          <li><b>First-principles + lattice dynamics:</b> compute force constants, then check if the dynamical matrix has negative eigenvalues.</li>
        </ul>

        <h3>Design trade-offs and constraints</h3>
        <ul>
          <li><b>Real materials are not 1D:</b> higher dimensionality and screening reduce the effective long-range destabilization.</li>
          <li><b>Dielectric screening:</b> Coulomb is reduced by ε; practically σ scales like 1/ε, so doping/temperature can tune stability.</li>
          <li><b>Defects/strain:</b> modify short-range stiffness γ and can localize soft modes.</li>
        </ul>

        <div class="callout">
          <div class="tag"><span class="tagDot"></span><span><b>From lab to product</b></span></div>
          <p class="muted" style="margin:0">
            Engineers rarely use an unscreened Coulomb 1/r in a device model; instead they use <b>screened</b> kernels (Yukawa-like),
            finite-size boundary conditions, and fitted γ from experimental elastic constants—then ensure the computed spectrum stays ω² ≥ 0
            over operating conditions (temperature, bias field, composition).
          </p>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="p1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>Problem restatement (clear & compact)</h3>
        <p>
          Consider an infinite 1D chain of ions with equal mass M located at equilibrium positions x<sub>n</sub>=na.
          Charges alternate: e<sub>n</sub>=e(−1)<sup>n</sup>. Interactions consist of (1) a short-range nearest-neighbor harmonic
          force with constant γ, and (2) Coulomb interactions between all pairs. In the harmonic approximation:
        </p>
        <ul>
          <li>(a) Show the Coulomb contribution to the force constants is
            <span class="muted">C<sub>pC</sub> = 2(−1)<sup>p</sup> e²/(p³ a³)</span>.</li>
          <li>(b) Derive the dispersion relation:
            <span class="muted">ω²/ω₀² = sin²(Ka/2) + σ ∑<sub>p=1</sub>∞ (−1)<sup>p</sup>(1−cos pKa)/p³</span>,
            with <span class="muted">ω₀² = 4γ/M</span> and <span class="muted">σ = e²/(γ a³)</span>.</li>
          <li>(c) Show ω² is negative at Ka=π if σ &gt; 4/(7ζ(3)) ≈ 0.475, and that the small-Ka sound speed becomes imaginary if σ &gt; 1/(2 ln 2) ≈ 0.721. Conclude instability for some Ka in (0,π) when 0.475 &lt; σ &lt; 0.721.</li>
        </ul>

        <h3>Given quantities</h3>
        <ul>
          <li>M, a, γ, e; charge pattern e(−1)<sup>n</sup>.</li>
        </ul>

        <h3>Unknowns / targets</h3>
        <ul>
          <li>Coulomb force constants C<sub>pC</sub> (as a function of separation p).</li>
          <li>Dispersion ω(K) and stability conditions in terms of σ.</li>
        </ul>

        <h3>Relevant principles and why they apply</h3>
        <ul>
          <li><b>Linearization:</b> small displacements → Taylor expansion of pair potentials to quadratic order.</li>
          <li><b>Superposition/linearity:</b> total force constants are sums of spring + Coulomb contributions.</li>
          <li><b>Fourier mode diagonalization:</b> translation invariance makes the force-constant matrix Toeplitz (depends on n−m), so plane waves are eigenvectors.</li>
          <li><b>Stability criterion:</b> stable harmonic lattice ⇔ ω²(K) ≥ 0 for all K in the Brillouin zone.</li>
        </ul>

        <div class="callout">
          <div class="tag"><span class="tagDot"></span><span><b>Explicit assumptions</b></span></div>
          <ul class="mini">
            <li>1D longitudinal motion only; equilibrium spacing a fixed.</li>
            <li>Infinite chain (or periodic BC with N→∞), so K is continuous in [−π/a, π/a].</li>
            <li>Electrostatic Coulomb interaction between point charges; no screening, no retardation.</li>
            <li>Harmonic approximation: keep terms up to O(u²) in potential, O(u) in forces.</li>
          </ul>
        </div>

        <h3>Possible approaches (compare)</h3>
        <ul>
          <li><b>(A) Direct dynamical-matrix approach:</b> compute Φ<sub>p</sub> from pair potential second derivatives, then Fourier transform.
            <span class="muted">Pros:</span> systematic, clean eigenvalue logic. <span class="muted">Cons:</span> must carefully track signs.</li>
          <li><b>(B) Energy method:</b> expand total potential energy in Fourier amplitudes; ω² comes from quadratic form coefficient.
            <span class="muted">Pros:</span> stability interpretation is immediate. <span class="muted">Cons:</span> bookkeeping for long-range terms.</li>
          <li><b>(C) Green’s function / lattice Fourier transform:</b> treat Coulomb kernel as a convolution operator and diagonalize in k-space.
            <span class="muted">Pros:</span> emphasizes mathematical physics; <span class="muted">Cons:</span> still needs the same second-derivative kernel.</li>
        </ul>
        <p>
          <b>We choose (A)</b> because it matches the requested form (force constants → dispersion) and makes each mathematical step explicit.
        </p>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="p2">
        <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

        <ol>
          <li><b>Set the mathematical model:</b> infinite lattice n∈ℤ with displacement u<sub>n</sub>(t); write Newton’s law with a force-constant matrix Φ.</li>
          <li><b>Compute short-range (NN) contribution:</b> show it gives a discrete Laplacian and yields ω² ∝ sin²(Ka/2).</li>
          <li><b>Compute Coulomb harmonic force constant:</b> take the second derivative of V(r)=e<sub>n</sub>e<sub>m</sub>/|r| about equilibrium r=|p|a → 1/p³ factor, with alternating sign (−1)<sup>p</sup>.</li>
          <li><b>Assemble total Φ<sub>p</sub>:</b> by linearity, add spring + Coulomb contributions; enforce translational invariance (row sums = 0).</li>
          <li><b>Diagonalize by plane waves:</b> use u<sub>n</sub>=U e^{i(Kna−ωt)} to convert convolution sums into scalar multipliers.</li>
          <li><b>Obtain dispersion:</b> express ω²(K) in terms of sums of (1−cos pKa)/p³ and define nondimensional σ and ω₀.</li>
          <li><b>Zone-boundary test:</b> plug Ka=π; reduce the sum to odd p only; use ζ(3) identities to get the threshold σ.</li>
          <li><b>Small-k asymptotics:</b> expand cos(pKa) ≈ 1−(pKa)²/2; evaluate ∑(−1)<sup>p</sup>/p to find the effective sound-speed squared and its sign change at σ=1/(2 ln 2).</li>
          <li><b>Conclude instability ranges:</b> combine the two sign tests to map when ω² crosses zero inside the Brillouin zone.</li>
        </ol>

        <div class="callout">
          <div class="tag"><span class="tagDot warn"></span><span><b>Common mistakes</b></span></div>
          <ul class="mini">
            <li>Dropping the “self-term” Φ<sub>0</sub> incorrectly. Always enforce <b>∑<sub>p</sub> Φ<sub>p</sub> = 0</b> (translation invariance → no force for uniform shift).</li>
            <li>Confusing <b>p</b> (separation index) with momentum <b>K</b>.</li>
            <li>For Coulomb: forgetting the factor 2 that arises when converting pair energy to forces on a single particle (or equivalently, when forming Φ<sub>0</sub> from off-diagonal terms).</li>
            <li>Using small-k expansion without checking convergence; here it’s safe because weights are 1/p³.</li>
          </ul>
        </div>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="p3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>Physical intuition (before math)</h3>
        <p>
          A nearest-neighbor spring chain is always stable: neighboring ions resist relative motion, producing ω² ≥ 0.
          Coulomb forces are long-range; because charges alternate, distant ions can either enhance or reduce restoring forces depending on the wave pattern.
          At certain K, Coulomb contributions can overwhelm the spring restoring force and drive ω² negative: a soft mode and instability.
        </p>

        <div class="callout">
          <div class="tag"><span class="tagDot"></span><span><b>Mathematical model (explicit)</b></span></div>
          <ul class="mini">
            <li><b>Domain:</b> discrete line n ∈ ℤ (infinite chain). Coordinate x along chain.</li>
            <li><b>Unknown field:</b> displacement u: ℤ×ℝ → ℝ, u(n,t)=u<sub>n</sub>(t).</li>
            <li><b>Equation of motion (linearized):</b>
              <span class="muted">M d²u<sub>n</sub>/dt² = −∑<sub>m∈ℤ</sub> Φ<sub>n−m</sub> u<sub>m</sub></span>.
              Here Φ is a translation-invariant force-constant kernel (a discrete operator).</li>
            <li><b>Boundary conditions:</b> infinite chain; equivalently periodic BC with N→∞ so Fourier modes exist.</li>
            <li><b>Normal-mode ansatz (eigenfunctions):</b> u<sub>n</sub>(t)=U e^{i(Kna−ωt)} with K ∈ [−π/a, π/a].</li>
          </ul>
          <p class="muted" style="margin:6px 0 0">
            This is the discrete analogue of a PDE eigenvalue problem: (operator)·u = ω² u. The “operator” here is the convolution with Φ.
          </p>
        </div>

        <h3>Step 1 — Short-range nearest-neighbor (NN) spring contribution</h3>
        <p>
          The NN harmonic potential energy for a chain is (one common form):
        </p>
        <div class="eqBlock" data-copy>
          <button class="copyBtn" aria-label="Copy equation">Copy</button>
          <pre>V_sr = (γ/2) Σ_n (u_{n+1} - u_n)^2</pre>
        </div>
        <p>
          Differentiate to get force on ion n (linearity lets us do it term-by-term). Using d/d u<sub>n</sub>:
        </p>
        <div class="eqBlock">
          <pre>
∂/∂u_n (u_{n+1}-u_n)^2 = -2(u_{n+1}-u_n)
∂/∂u_n (u_n-u_{n-1})^2 = +2(u_n-u_{n-1})

So: F_n^(sr) = -∂V_sr/∂u_n
= -γ[(u_n-u_{n-1}) - (u_{n+1}-u_n)]
= -γ(2u_n - u_{n+1} - u_{n-1}).</pre>
        </div>
        <p class="muted">
          Mathematically, this is a discrete Laplacian: (Δ<sub>d</sub>u)<sub>n</sub> = u<sub>n+1</sub> − 2u<sub>n</sub> + u<sub>n−1</sub>.
          Here F = γ Δ<sub>d</sub>u (with a sign convention).
        </p>

        <p>
          Plug the plane wave u<sub>n</sub>=U e^{i(Kna−ωt)}:
          u<sub>n±1</sub>=u<sub>n</sub> e^{±iKa}. Then
        </p>
        <div class="eqBlock" data-copy>
          <button class="copyBtn" aria-label="Copy equation">Copy</button>
          <pre>
2u_n - u_{n+1} - u_{n-1}
= u_n[2 - e^{iKa} - e^{-iKa}]
= u_n[2 - 2cos(Ka)]
= 4u_n sin^2(Ka/2).</pre>
        </div>
        <p>
          Therefore the NN spring alone gives:
        </p>
        <div class="eqBlock" data-copy>
          <button class="copyBtn" aria-label="Copy equation">Copy</button>
          <pre>ω_sr^2(K) = (4γ/M) sin^2(Ka/2).</pre>
        </div>
        <p class="muted">
          We define ω₀² ≡ 4γ/M so the spring part becomes ω₀² sin²(Ka/2).
        </p>

        <h3>Step 2 — Coulomb interaction: harmonic force constants (Part a)</h3>
        <p>
          The Coulomb potential energy between ions n and m is (electrostatic, 1D positions along x):
        </p>
        <div class="eqBlock">
          <pre>V_nm = e_n e_m / |x_n - x_m|,  with  x_n = na + u_n.</pre>
        </div>
        <p>
          Let p = n−m (an integer separation). Then at equilibrium:
          |x<sub>n</sub>−x<sub>m</sub>| = |p|a.
          For small displacements, expand in δ ≡ u<sub>n</sub>−u<sub>m</sub>.
          Write:
        </p>
        <div class="eqBlock">
          <pre>|x_n - x_m| = |pa + δ| ≈ |p|a + s δ,  where s = sign(p) (for small δ).</pre>
        </div>
        <p>
          Because we only need the <b>second-order</b> (harmonic) term, it is cleaner to expand 1/|pa+δ| about δ=0 using derivatives:
        </p>
        <div class="eqBlock">
          <pre>
f(δ) = 1/|pa + δ|.
For p≠0 and small δ, treat |pa+δ| = |p|a + O(δ), so:

f'(δ) = -1/|pa+δ|^2,
f''(δ) = 2/|pa+δ|^3.

Thus at δ=0:
f''(0) = 2/(|p|^3 a^3) = 2/(p^3 a^3) (since p^3 means |p|^3 in magnitude).</pre>
        </div>
        <p>
          The harmonic expansion of V<sub>nm</sub> in δ is:
        </p>
        <div class="eqBlock">
          <pre>
V_nm(δ) ≈ e_n e_m [ f(0) + f'(0) δ + (1/2) f''(0) δ^2 ].

The linear term f'(0)δ cancels in total force at equilibrium (net force = 0).
The quadratic term gives the harmonic coupling:

V_nm^(2) = (1/2) e_n e_m f''(0) (u_n - u_m)^2
= (1/2) e_n e_m * (2/(|p|^3 a^3)) (u_n - u_m)^2
= (e_n e_m)/( |p|^3 a^3 ) (u_n - u_m)^2.</pre>
        </div>

        <p>
          Now compute the corresponding <b>force constant</b> for the equation of motion. For a pair term
          A(u<sub>n</sub>−u<sub>m</sub>)², the force on n is:
        </p>
        <div class="eqBlock">
          <pre>
F_n = -∂/∂u_n [ A (u_n - u_m)^2 ] = -2A (u_n - u_m)
= -2A u_n + 2A u_m.</pre>
        </div>
        <p>
          Here A = (e<sub>n</sub>e<sub>m</sub>)/( |p|³ a³ ).
          Thus the off-diagonal contribution (coefficient multiplying u<sub>m</sub>) is:
        </p>
        <div class="eqBlock">
          <pre>Φ_p^(C) (off-diagonal) = -2A = -2 e_n e_m /( |p|^3 a^3 ).</pre>
        </div>
        <p class="muted">
          Many lattice-dynamics texts define a <i>force constant</i> C<sub>p</sub> with the opposite sign for p≠0.
          The problem statement uses C<sub>pC</sub> as the Coulomb contribution to “atomic force constants” in the dispersion formula.
          Matching that convention leads to:
        </p>

        <p>
          Using e<sub>n</sub> = e(−1)<sup>n</sup> and e<sub>m</sub> = e(−1)<sup>m</sup>, we get:
        </p>
        <div class="eqBlock">
          <pre>
e_n e_m = e^2 (-1)^{n+m} = e^2 (-1)^{(n-m)} = e^2 (-1)^p.</pre>
        </div>

        <div class="eqBlock" data-copy>
          <button class="copyBtn" aria-label="Copy equation">Copy</button>
          <pre>
Therefore (part a):
C_{pC} = 2(-1)^p e^2/(p^3 a^3),  for p = 1,2,3,...</pre>
        </div>

        <div class="callout">
          <div class="tag"><span class="tagDot"></span><span><b>Why the step is valid (math justification)</b></span></div>
          <ul class="mini">
            <li>We used a <b>Taylor expansion</b> of a smooth function f(δ)=1/|pa+δ| about δ=0; for p≠0 the denominator stays nonzero, so derivatives exist.</li>
            <li>We kept only up to δ² because the harmonic approximation linearizes forces (forces become linear in u).</li>
            <li>Translation invariance means the result depends only on separation p, not on n or m separately.</li>
          </ul>
        </div>

        <h3>Step 3 — Assemble the dynamical equation and diagonalize (Part b)</h3>
        <p>
          The linear equation of motion for an infinite chain can be written as a convolution:
        </p>
        <div class="eqBlock" data-copy>
          <button class="copyBtn" aria-label="Copy equation">Copy</button>
          <pre>
M ü_n = - Σ_{p≠0} C_p (u_n - u_{n-p})  - γ(2u_n - u_{n+1} - u_{n-1}).</pre>
        </div>
        <p class="muted">
          Here C<sub>p</sub> includes the Coulomb contribution C<sub>pC</sub> above (and zero short-range for |p|&gt;1).
          The form (u<sub>n</sub>−u<sub>n−p</sub>) ensures uniform translation u<sub>n</sub>=const gives zero force: Σ cancels.
        </p>

        <p>
          Insert the plane-wave ansatz u<sub>n</sub>=U e^{i(Kna−ωt)}. Then:
          u<sub>n−p</sub> = u<sub>n</sub> e^{−iKpa}. So
        </p>
        <div class="eqBlock">
          <pre>
(u_n - u_{n-p}) = u_n (1 - e^{-iKpa}).</pre>
        </div>
        <p>
          The Coulomb force contribution becomes:
        </p>
        <div class="eqBlock">
          <pre>
- Σ_{p≠0} C_p (u_n - u_{n-p})
= -u_n Σ_{p≠0} C_p (1 - e^{-iKpa}).</pre>
        </div>
        <p>
          Because C<sub>p</sub> is an even function of p in magnitude for this 1D pair interaction (C<sub>−p</sub>=C<sub>p</sub>),
          the imaginary parts cancel and we may rewrite using cos:
        </p>
        <div class="eqBlock">
          <pre>
Σ_{p≠0} C_p (1 - e^{-iKpa})
= 2 Σ_{p=1}^∞ C_p [1 - cos(pKa)].</pre>
        </div>
        <p class="muted">
          This is the standard real dispersion form: only (1−cos) survives, ensuring ω² is real.
        </p>

        <p>
          Now use C<sub>p</sub> = C<sub>pC</sub> = 2(−1)<sup>p</sup> e²/(p³ a³) for the Coulomb piece:
        </p>
        <div class="eqBlock">
          <pre>
2 Σ_{p=1}^∞ C_{pC} [1 - cos(pKa)]
= 2 Σ_{p=1}^∞ [2(-1)^p e^2/(p^3 a^3)] [1 - cos(pKa)]
= 4(e^2/a^3) Σ_{p=1}^∞ (-1)^p (1 - cos(pKa))/p^3.</pre>
        </div>

        <p>
          Combine with the NN spring contribution ω₀² sin²(Ka/2), with ω₀²=4γ/M. The full normal-mode condition is:
        </p>
        <div class="eqBlock">
          <pre>
M(-ω^2)u_n = -M ω^2 u_n = -[ 4γ sin^2(Ka/2) ] u_n
            -[ 4(e^2/a^3) Σ_{p=1}^∞ (-1)^p (1 - cos(pKa))/p^3 ] u_n.</pre>
        </div>
        <p>
          Cancel u<sub>n</sub> (nontrivial mode) and divide by M:
        </p>
        <div class="eqBlock">
          <pre>
ω^2(K) = (4γ/M) sin^2(Ka/2) + (4/M)(e^2/a^3) Σ_{p=1}^∞ (-1)^p (1 - cos(pKa))/p^3.</pre>
        </div>
        <p>
          Now nondimensionalize by ω₀² = 4γ/M and define σ = e²/(γ a³):
        </p>
        <div class="eqBlock" data-copy>
          <button class="copyBtn" aria-label="Copy equation">Copy</button>
          <pre>
(Part b)  ω^2/ω0^2 = sin^2(Ka/2) + σ Σ_{p=1}^∞ (-1)^p (1 - cos(pKa))/p^3,
where ω0^2 = 4γ/M and σ = e^2/(γ a^3).</pre>
        </div>

        <div class="callout">
          <div class="tag"><span class="tagDot"></span><span><b>Dimensional analysis check</b></span></div>
          <ul class="mini">
            <li>γ has units N/m = kg/s². So 4γ/M has units (kg/s²)/kg = 1/s² → correct for ω².</li>
            <li>e²/a³ has units (C²)/m³; in electrostatic units the potential prefactors would include 1/(4πϵ₀). In the problem’s unit convention, e²/a³ carries the same effective units as γ so that σ is dimensionless (as stated).</li>
            <li>Series term is dimensionless because (1−cos)/p³ is dimensionless.</li>
          </ul>
        </div>

        <h3>Step 4 — Zone-boundary instability (Part c, first claim)</h3>
        <p>
          Evaluate at the zone boundary Ka = π. Then sin²(π/2)=1 and cos(pπ)= (−1)<sup>p</sup>. The series becomes:
        </p>
        <div class="eqBlock">
          <pre>
S(π) ≡ Σ_{p=1}^∞ (-1)^p [1 - cos(pπ)]/p^3
     = Σ_{p=1}^∞ (-1)^p [1 - (-1)^p]/p^3.</pre>
        </div>
        <p>
          Note the selector:
        </p>
        <ul class="mini">
          <li>If p is even: (−1)<sup>p</sup>=+1 → [1−(+1)]=0 → no contribution.</li>
          <li>If p is odd: (−1)<sup>p</sup=−1 → [1−(−1)]=2 → contribution = (−1)*2/p³ = −2/p³.</li>
        </ul>
        <p>
          Therefore
        </p>
        <div class="eqBlock">
          <pre>
S(π) = -2 Σ_{p odd} 1/p^3.</pre>
        </div>
        <p>
          Use the identity (standard zeta decomposition):
        </p>
        <div class="eqBlock">
          <pre>
Σ_{p odd} 1/p^3 = Σ_{p=1}^∞ 1/p^3 - Σ_{p even} 1/p^3
= ζ(3) - Σ_{m=1}^∞ 1/(2m)^3
= ζ(3) - (1/8)ζ(3)
= (7/8)ζ(3).</pre>
        </div>
        <p>
          Hence S(π) = −2*(7/8)ζ(3) = −(7/4)ζ(3). Plugging into dispersion:
        </p>
        <div class="eqBlock">
          <pre>
ω^2(π/a)/ω0^2 = 1 + σ S(π)
             = 1 - σ (7/4) ζ(3).</pre>
        </div>
        <p>
          Instability at the zone boundary means ω² &lt; 0:
        </p>
        <div class="eqBlock" data-copy>
          <button class="copyBtn" aria-label="Copy equation">Copy</button>
          <pre>
ω^2(Ka=π) < 0  ⇔  1 - (7/4)σ ζ(3) < 0
⇔  σ > 4/(7 ζ(3)) ≈ 0.475.</pre>
        </div>

        <h3>Step 5 — Small-Ka asymptotics and imaginary sound speed (Part c, second claim)</h3>
        <p>
          For small x ≡ Ka, we expand:
        </p>
        <div class="eqBlock">
          <pre>
sin^2(x/2) = (x^2/4) + O(x^4),
cos(px) = 1 - (p^2 x^2)/2 + O(x^4).</pre>
        </div>
        <p>
          Insert into the Coulomb series term:
        </p>
        <div class="eqBlock">
          <pre>
(1 - cos(px)) = (p^2 x^2)/2 + O(x^4).

So:
Σ_{p=1}^∞ (-1)^p (1 - cos(px))/p^3
= Σ_{p=1}^∞ (-1)^p [ (p^2 x^2)/2 ] / p^3 + O(x^4)
= (x^2/2) Σ_{p=1}^∞ (-1)^p / p + O(x^4).</pre>
        </div>
        <p>
          The alternating harmonic series is:
        </p>
        <div class="eqBlock">
          <pre>
Σ_{p=1}^∞ (-1)^{p-1}/p = ln 2
⇒ Σ_{p=1}^∞ (-1)^p / p = -ln 2.</pre>
        </div>
        <p>
          Therefore the Coulomb correction at small x is:
        </p>
        <div class="eqBlock">
          <pre>
Σ_{p=1}^∞ (-1)^p (1 - cos(px))/p^3
= -(x^2/2) ln 2 + O(x^4).</pre>
        </div>
        <p>
          Combine with sin²(x/2) ≈ x²/4:
        </p>
        <div class="eqBlock">
          <pre>
ω^2/ω0^2 = x^2/4  + σ [ -(x^2/2) ln 2 ] + O(x^4)
         = x^2 [ 1/4 - (σ/2) ln 2 ] + O(x^4).</pre>
        </div>
        <p>
          In an acoustic branch, ω ≈ v|K| for small K, so ω² ≈ v² K². Compare:
        </p>
        <div class="eqBlock">
          <pre>
ω^2 ≈ ω0^2 a^2 K^2 [ 1/4 - (σ/2) ln 2 ].

Thus:  v^2 = ω0^2 a^2 [ 1/4 - (σ/2) ln 2 ].</pre>
        </div>
        <p>
          Sound speed becomes imaginary when v² &lt; 0:
        </p>
        <div class="eqBlock" data-copy>
          <button class="copyBtn" aria-label="Copy equation">Copy</button>
          <pre>
v^2 < 0  ⇔  1/4 - (σ/2) ln 2 < 0
⇔  σ > 1/(2 ln 2) ≈ 0.721.</pre>
        </div>

        <h3>Step 6 — Combine the two criteria to infer instability for intermediate σ</h3>
        <p>
          Define f(x) = ω²(x)/ω₀² for x=Ka ∈ [0,π]. We have:
        </p>
        <ul>
          <li>At x=0: f(0)=0 (translational mode), and near x=0 the curvature is proportional to v².</li>
          <li>If σ &gt; 1/(2 ln 2), then v²&lt;0 so for sufficiently small x&gt;0 we get f(x)&lt;0 immediately: instability near k≈0.</li>
          <li>At x=π: f(π)=1-(7/4)σζ(3), which is negative if σ&gt;4/(7ζ(3))≈0.475.</li>
        </ul>
        <p>
          Therefore:
        </p>
        <ul>
          <li>If σ &lt; 0.475, the zone boundary is stable; small-k slope is also stable (since 0.475 &lt; 0.721), so no instability is forced by these tests.</li>
          <li>If σ &gt; 0.721, instability exists near k=0 (imaginary sound speed).</li>
          <li>If 0.475 &lt; σ &lt; 0.721, then:
            <ul>
              <li>Near x=0: v²&gt;0 ⇒ f(x)&gt;0 for small x.</li>
              <li>At x=π: f(π)&lt;0.</li>
            </ul>
            By continuity of f(x) (the series converges uniformly; it defines a continuous function), there must exist some x*∈(0,π) where f(x*)=0 and for some interval beyond it f(x)&lt;0.
            Hence the lattice is unstable for a range of Ka in (0,π).</li>
        </ul>

        <div class="callout">
          <div class="tag"><span class="tagDot good"></span><span><b>Continuity justification (math)</b></span></div>
          <p class="mini" style="margin:0">
            The series Σ (−1)<sup>p</sup>(1−cos(px))/p³ converges absolutely and uniformly in x because |1−cos(px)|≤2 and Σ 2/p³ converges.
            Uniform convergence allows term-by-term continuity, so f(x) is continuous and the intermediate value theorem applies.
          </p>
        </div>

        <h3>Final Answer (boxed)</h3>
        <div class="eqBlock" id="finalAnswer" data-copy>
          <button class="copyBtn" aria-label="Copy final answer">Copy</button>
<pre>
(a) Coulomb contribution to force constants (p = 1,2,3,...):
    C_{pC} = 2(-1)^p e^2/(p^3 a^3).

(b) Dispersion relation:
    ω^2/ω0^2 = sin^2(Ka/2) + σ Σ_{p=1}^∞ (-1)^p (1 - cos(pKa))/p^3,
    where ω0^2 = 4γ/M and σ = e^2/(γ a^3).

(c) Zone boundary Ka = π:
    ω^2(π/a)/ω0^2 = 1 - (7/4)σ ζ(3),
    so ω^2 < 0 (instability) if σ > 4/(7ζ(3)) ≈ 0.475.

    Small Ka:
    ω^2/ω0^2 = (Ka)^2[1/4 - (σ/2)ln 2] + O((Ka)^4),
    so v^2 ∝ [1/4 - (σ/2)ln 2] and the sound speed is imaginary if
    σ > 1/(2 ln 2) ≈ 0.721.

    Therefore for 0.475 < σ < 0.721, ω^2 crosses zero for some Ka in (0,π),
    implying a band of unstable modes.</pre>
        </div>

        <h3>Sanity checks</h3>
        <ul>
          <li><b>Units:</b> ω₀²=4γ/M has units 1/s²; σ is dimensionless; series is dimensionless → ω² has correct units.</li>
          <li><b>Limiting case σ→0:</b> ω²/ω₀² → sin²(Ka/2): the standard NN chain.</li>
          <li><b>Sign logic:</b> the Coulomb series can be negative at certain K (e.g. K=π/a) because only odd p contribute with negative sign; thus it can reduce ω² below zero.</li>
          <li><b>Physical meaning of ω²&lt;0:</b> solutions behave like e^{|ω|t} instead of oscillating → unstable equilibrium (structural transition tendency).</li>
        </ul>

        <figure aria-label="Plot of dispersion using example values">
          <canvas id="dispCanvas"></canvas>
          <figcaption>
            <b>One illustrative plot (example values):</b> normalized ω²/ω₀² vs Ka for σ = 0.30 (stable), 0.55 (intermediate: crosses below 0 near zone boundary),
            and 0.80 (unstable near small k). This plot uses a truncated series (N=250 terms) solely for visualization; the analytic results above are symbolic.
          </figcaption>
        </figure>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="p4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>Re-interpreting the final formula term-by-term</h3>
        <ul>
          <li><b>sin²(Ka/2) term:</b> eigenvalue of the discrete Laplacian (NN stiffness). It grows from 0 at k=0 to 1 at the zone boundary.</li>
          <li><b>Series term:</b> long-range kernel spectrum. The factor (1−cos pKa) is the Fourier symbol of a difference operator at range p, and 1/p³ weights long-range couplings from the Coulomb second derivative.</li>
          <li><b>(−1)<sup>p</sup> factor:</b> encodes the alternating charge pattern; it is the mathematical “signature” of the basis, even though the masses are equal (hence the note that the spectrum resembles a diatomic lattice in spirit, but interactions are symmetric across ions).</li>
        </ul>

        <div class="callout">
          <div class="tag"><span class="tagDot"></span><span><b>Math Insight:</b> dispersion as an operator symbol</span></div>
          <p class="mini" style="margin:0">
            Define the discrete operator (Lu)<sub>n</sub> = Σ<sub>p≥1</sub> w<sub>p</sub>(2u<sub>n</sub>−u<sub>n+p</sub>−u<sub>n−p</sub>).
            Then plane waves e^{iKna} are eigenvectors with eigenvalue
            λ(K)=2Σ w<sub>p</sub>(1−cos pKa). Here w<sub>1</sub> includes γ and all w<sub>p</sub> include Coulomb weights ∝(−1)<sup>p</sup>/p³.
            The soft-mode condition is simply λ(K)&lt;0 for some K.
          </p>
        </div>

        <h3>Parameter dependence (qualitative)</h3>
        <ul>
          <li><b>Increase γ (stiffer short-range bonding):</b> decreases σ, stabilizes all modes, increases ω across the Brillouin zone.</li>
          <li><b>Increase e (stronger charges):</b> increases σ, tends to destabilize some modes (especially near Ka=π and eventually near Ka≈0).</li>
          <li><b>Increase a:</b> Coulomb curvature scales like 1/a³; larger spacing reduces σ strongly → stabilizes.</li>
          <li><b>Role of ζ(3):</b> zone-boundary instability threshold depends on the odd-p sum of 1/p³, compactly encoded via ζ(3).</li>
        </ul>

        <h3>Alternative derivation idea (brief but meaningful)</h3>
        <p>
          Instead of forces, expand the <b>total potential energy</b> to quadratic order in Fourier amplitudes:
          write u<sub>n</sub> = (1/√N)∑<sub>K</sub> U(K) e^{iKna}. Because of orthogonality, cross-terms vanish, and the energy becomes
          V = (1/2)∑<sub>K</sub> M ω²(K) |U(K)|². The coefficient in front of |U(K)|² is exactly the dispersion. This method makes the stability condition
          “V must be positive definite” very transparent.
        </p>

        <h3>Concept checks (with answers)</h3>
        <ul>
          <li><b>Q:</b> Why does ω(K=0)=0 always? <b>A:</b> Uniform translation u<sub>n</sub>=const changes no distances; by symmetry (translation invariance), the restoring force is zero → ω=0.</li>
          <li><b>Q:</b> What does ω²&lt;0 mean in time domain? <b>A:</b> ω = i|ω|, so u ∼ e^{|ω|t} (growth) or e^{−|ω|t} (decay): equilibrium is unstable.</li>
          <li><b>Q:</b> Why does Ka=π kill even p terms? <b>A:</b> cos(pπ)=1 for even p, giving 1−cos=0; only odd separations contribute.</li>
          <li><b>Q:</b> Why is the small-k threshold set by ln 2? <b>A:</b> the leading small-k Coulomb contribution involves Σ(−1)^p/p, the alternating harmonic series, which equals −ln2.</li>
        </ul>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <section id="p5">
        <h2>PART 5 — Optional Plot Guide (ONLY IF A PLOT EXISTS)</h2>

        <p>
          The plot visualizes the <b>normalized dispersion</b> f(x)=ω²/ω₀² versus x=Ka ∈ [0,π] using the derived formula
          and a truncated convergent series for illustration.
        </p>
        <ul>
          <li><b>x-axis:</b> Ka (dimensionless), from 0 to π.</li>
          <li><b>y-axis:</b> ω²/ω₀² (dimensionless). Values below 0 indicate an unstable (imaginary-frequency) mode.</li>
          <li><b>Example values (only for the plot):</b> σ = 0.30, 0.55, 0.80.</li>
          <li><b>Features to notice:</b>
            <ul>
              <li>σ=0.30 stays above 0 → stable.</li>
              <li>σ=0.55 drops below 0 near Ka≈π → consistent with the threshold 0.475.</li>
              <li>σ=0.80 is negative near small Ka → consistent with σ&gt;0.721 giving imaginary sound speed.</li>
            </ul>
          </li>
        </ul>

        <a class="backTop" href="#top">↑ Back to top</a>
      </section>

      <footer style="padding:14px 18px 18px; border-top:1px solid var(--line); color:var(--muted);">
        <div style="display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:space-between;">
          <div>
            <b>Note:</b> This article uses only vanilla HTML/CSS/JS and no external libraries.
          </div>
          <a class="backTop" href="#top">↑ Back to top</a>
        </div>
      </footer>
    </article>
  </main>

  <div class="copyToast" id="copyToast" role="status" aria-live="polite">Copied.</div>

  <script>
    // Copy buttons for any .eqBlock[data-copy]
    (function(){
      const toast = document.getElementById('copyToast');
      let tHandle = null;

      function showToast(msg){
        toast.textContent = msg || 'Copied.';
        toast.classList.add('show');
        clearTimeout(tHandle);
        tHandle = setTimeout(()=>toast.classList.remove('show'), 1100);
      }

      document.querySelectorAll('.eqBlock[data-copy]').forEach(block=>{
        const btn = block.querySelector('.copyBtn');
        const pre = block.querySelector('pre');
        if(!btn || !pre) return;
        btn.addEventListener('click', async ()=>{
          const text = pre.textContent.replace(/\n\s+\n/g, "\n\n").trim();
          try{
            await navigator.clipboard.writeText(text);
            showToast('Copied equation.');
          }catch(e){
            // fallback
            const ta = document.createElement('textarea');
            ta.value = text;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            showToast('Copied (fallback).');
          }
        });
      });
    })();

    // Single static plot on canvas: ω^2/ω0^2 vs x=Ka for example σ values.
    (function(){
      const canvas = document.getElementById('dispCanvas');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');

      const sigmas = [
        {sigma: 0.30, label: "σ = 0.30"},
        {sigma: 0.55, label: "σ = 0.55"},
        {sigma: 0.80, label: "σ = 0.80"},
      ];
      const Nterms = 250; // truncated series for visualization only

      function Sseries(x){
        // S(x)= Σ_{p=1..∞} (-1)^p (1 - cos(px))/p^3
        // truncate at Nterms; absolutely convergent so truncation is well-behaved.
        let s = 0;
        for(let p=1; p<=Nterms; p++){
          const sign = (p % 2 === 0) ? 1 : -1; // (-1)^p: even->+1, odd->-1
          const term = sign * (1 - Math.cos(p*x)) / (p*p*p);
          s += term;
        }
        return s;
      }

      function f(x, sigma){
        return Math.pow(Math.sin(x/2), 2) + sigma * Sseries(x);
      }

      function draw(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const rect = canvas.getBoundingClientRect();
        canvas.width = Math.round(rect.width * dpr);
        canvas.height = Math.round(rect.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        const W = rect.width;
        const H = rect.height;

        // padding
        const padL = 52, padR = 18, padT = 18, padB = 44;

        // sample domain
        const xmin = 0, xmax = Math.PI;

        // compute y-range from samples across all curves
        let ymin = Infinity, ymax = -Infinity;
        const samples = 420;
        const curves = sigmas.map(obj=>{
          const pts = [];
          for(let i=0;i<=samples;i++){
            const x = xmin + (xmax-xmin)*i/samples;
            const y = f(x, obj.sigma);
            pts.push({x,y});
            if(y<ymin) ymin=y;
            if(y>ymax) ymax=y;
          }
          return {obj, pts};
        });

        // Expand y-limits a bit and ensure 0 is visible
        ymin = Math.min(ymin, 0);
        ymax = Math.max(ymax, 0);
        const ypad = 0.10*(ymax - ymin + 1e-9);
        ymin -= ypad;
        ymax += ypad;

        function x2px(x){ return padL + (x - xmin) * (W - padL - padR) / (xmax - xmin); }
        function y2px(y){ return padT + (ymax - y) * (H - padT - padB) / (ymax - ymin); }

        // background
        ctx.clearRect(0,0,W,H);
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--panel2').trim() || '#111';
        ctx.fillRect(0,0,W,H);

        // grid
        ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--line').trim() || 'rgba(255,255,255,.12)';
        ctx.lineWidth = 1;

        const xTicks = [0, Math.PI/4, Math.PI/2, 3*Math.PI/4, Math.PI];
        const yTicksCount = 6;

        // vertical grid
        xTicks.forEach(x=>{
          const X = x2px(x);
          ctx.beginPath();
          ctx.moveTo(X,padT);
          ctx.lineTo(X,H-padB);
          ctx.stroke();
        });

        // horizontal grid
        for(let i=0;i<=yTicksCount;i++){
          const y = ymin + (ymax-ymin)*i/yTicksCount;
          const Y = y2px(y);
          ctx.beginPath();
          ctx.moveTo(padL,Y);
          ctx.lineTo(W-padR,Y);
          ctx.stroke();
        }

        // axes
        ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#bbb';
        ctx.lineWidth = 1.5;
        ctx.beginPath();
        ctx.moveTo(padL, padT);
        ctx.lineTo(padL, H-padB);
        ctx.lineTo(W-padR, H-padB);
        ctx.stroke();

        // zero line
        const Y0 = y2px(0);
        ctx.strokeStyle = 'rgba(251,113,133,.55)';
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(padL, Y0);
        ctx.lineTo(W-padR, Y0);
        ctx.stroke();

        // labels
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--text').trim() || '#eee';
        ctx.font = '700 13px ' + getComputedStyle(document.body).fontFamily;
        ctx.fillText('Dispersion (example): ω²/ω₀² vs Ka', padL, 14);

        ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#bbb';
        ctx.fillText('Ka (dimensionless)', Math.round((padL + W-padR)/2)-52, H-12);
        // y label (rotated)
        ctx.save();
        ctx.translate(14, Math.round((padT + H-padB)/2)+42);
        ctx.rotate(-Math.PI/2);
        ctx.fillText('ω²/ω₀² (dimensionless)', 0, 0);
        ctx.restore();

        // tick labels x
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#bbb';
        xTicks.forEach(x=>{
          const X = x2px(x);
          let label = '';
          if(Math.abs(x-0)<1e-9) label='0';
          else if(Math.abs(x-Math.PI/4)<1e-9) label='π/4';
          else if(Math.abs(x-Math.PI/2)<1e-9) label='π/2';
          else if(Math.abs(x-3*Math.PI/4)<1e-9) label='3π/4';
          else if(Math.abs(x-Math.PI)<1e-9) label='π';
          ctx.fillText(label, X-10, H-padB+18);
          // tick mark
          ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#bbb';
          ctx.lineWidth = 1.5;
          ctx.beginPath();
          ctx.moveTo(X, H-padB);
          ctx.lineTo(X, H-padB+6);
          ctx.stroke();
        });

        // tick labels y
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#bbb';
        for(let i=0;i<=yTicksCount;i++){
          const y = ymin + (ymax-ymin)*i/yTicksCount;
          const Y = y2px(y);
          const label = (Math.round(y*100)/100).toFixed(2);
          ctx.fillText(label, 8, Y+4);
          ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#bbb';
          ctx.lineWidth = 1.5;
          ctx.beginPath();
          ctx.moveTo(padL-6, Y);
          ctx.lineTo(padL, Y);
          ctx.stroke();
        }

        // curves (use default stroke colors; do not hard-code fancy palettes)
        const baseStrokes = ['rgba(125,211,252,.95)','rgba(167,139,250,.95)','rgba(52,211,153,.95)'];
        curves.forEach((c, idx)=>{
          ctx.strokeStyle = baseStrokes[idx % baseStrokes.length];
          ctx.lineWidth = 2;
          ctx.beginPath();
          c.pts.forEach((pt, i)=>{
            const X = x2px(pt.x);
            const Y = y2px(pt.y);
            if(i===0) ctx.moveTo(X,Y); else ctx.lineTo(X,Y);
          });
          ctx.stroke();
        });

        // legend
        const lx = W - padR - 150;
        const ly = padT + 18;
        const lh = 18;
        ctx.fillStyle = 'rgba(0,0,0,.18)';
        ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--line').trim() || 'rgba(255,255,255,.12)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.roundRect(lx-10, ly-12, 160, 72, 12);
        ctx.fill();
        ctx.stroke();

        curves.forEach((c, idx)=>{
          const y = ly + idx*lh;
          ctx.strokeStyle = baseStrokes[idx % baseStrokes.length];
          ctx.lineWidth = 3;
          ctx.beginPath();
          ctx.moveTo(lx, y);
          ctx.lineTo(lx+22, y);
          ctx.stroke();
          ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--text').trim() || '#eee';
          ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;
          ctx.fillText(c.obj.label, lx+30, y+4);
        });
      }

      // polyfill roundRect if needed
      if(!CanvasRenderingContext2D.prototype.roundRect){
        CanvasRenderingContext2D.prototype.roundRect = function(x,y,w,h,r){
          const rr = Math.min(r, w/2, h/2);
          this.beginPath();
          this.moveTo(x+rr, y);
          this.arcTo(x+w, y, x+w, y+h, rr);
          this.arcTo(x+w, y+h, x, y+h, rr);
          this.arcTo(x, y+h, x, y, rr);
          this.arcTo(x, y, x+w, y, rr);
          this.closePath();
          return this;
        };
      }

      const ro = new ResizeObserver(()=>draw());
      ro.observe(canvas);
      draw();
      window.addEventListener('resize', draw, {passive:true});
    })();
  </script>
</body>
</html>
