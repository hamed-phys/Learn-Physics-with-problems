<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#0b1020" />
  <title>Monatomic Linear Lattice: Energy of a Traveling Wave (with Mathematical Physics Depth)</title>
  <style>
    :root{
      --bg:#070a12;
      --panel:#0c1224;
      --panel2:#0b142b;
      --text:#e9eefc;
      --muted:#b8c2e6;
      --faint:#8d98c7;
      --brand:#7aa2ff;
      --brand2:#7af0c6;
      --warn:#ffcc66;
      --ok:#8bffb0;
      --bad:#ff7a9a;
      --line:rgba(255,255,255,.10);
      --shadow: 0 12px 34px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:24px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --maxw: 1100px;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8ff;
        --panel:#ffffff;
        --panel2:#f3f6ff;
        --text:#121a33;
        --muted:#2a355a;
        --faint:#5b6791;
        --line:rgba(10,20,40,.12);
        --shadow: 0 12px 34px rgba(10,20,40,.12);
      }
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 600px at 15% 10%, rgba(122,162,255,.18), transparent 55%),
                  radial-gradient(900px 500px at 90% 0%, rgba(122,240,198,.14), transparent 52%),
                  radial-gradient(900px 500px at 10% 90%, rgba(255,204,102,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.65;
    }

    a{color:var(--brand); text-decoration:none}
    a:hover{text-decoration:underline}
    code,kbd,pre{font-family:var(--mono)}
    .wrap{
      width:min(var(--maxw), calc(100% - 28px));
      margin:0 auto;
      padding:24px 0 70px;
    }

    header.hero{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius: calc(var(--radius2) + 6px);
      box-shadow: var(--shadow);
      padding:26px 22px 18px;
      position:relative;
      overflow:hidden;
    }
    header.hero:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(600px 180px at 30% 0%, rgba(122,162,255,.22), transparent 65%),
                  radial-gradient(450px 200px at 80% 10%, rgba(122,240,198,.18), transparent 60%);
      pointer-events:none;
      opacity:.9;
    }
    header.hero > *{position:relative}
    .title{
      display:flex;
      gap:14px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:12px;
      letter-spacing:.02em;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color:var(--muted);
      white-space:nowrap;
      transform: translateY(2px);
    }
    .badge .dot{
      width:9px; height:9px; border-radius:999px;
      background: linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: 0 0 0 3px rgba(122,162,255,.18);
    }
    h1{
      font-size: clamp(22px, 2.8vw, 34px);
      margin:0;
      letter-spacing:-.02em;
      line-height:1.2;
    }
    .subtitle{
      margin:10px 0 0;
      color:var(--muted);
      max-width: 90ch;
      font-size: 14.5px;
    }
    .meta{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin-top:14px;
      color:var(--faint);
      font-size:12.5px;
    }
    .meta span{
      padding:6px 10px;
      border:1px dashed var(--line);
      border-radius:999px;
      background: rgba(255,255,255,.03);
    }

    .grid{
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:18px;
      margin-top:18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns: 1fr}
    }

    nav.toc{
      position:sticky;
      top:14px;
      background: rgba(255,255,255,.04);
      border:1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding:14px 14px 12px;
      backdrop-filter: blur(10px);
    }
    nav.toc h2{
      font-size:13px;
      margin:0 0 10px;
      color:var(--muted);
      letter-spacing:.04em;
      text-transform:uppercase;
    }
    .toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      color:var(--text);
      border:1px solid transparent;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      font-size:13.5px;
    }
    .toc a:hover{
      background: rgba(122,162,255,.10);
      border-color: rgba(122,162,255,.24);
      transform: translateX(2px);
      text-decoration:none;
    }
    .toc small{color:var(--faint)}
    .toc .toplink{
      margin-top:10px;
      padding-top:10px;
      border-top:1px solid var(--line);
    }

    main{
      display:flex;
      flex-direction:column;
      gap:16px;
    }
    section.card{
      background: rgba(255,255,255,.04);
      border:1px solid var(--line);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding:18px 18px 16px;
      overflow:hidden;
    }
    section.card h2{
      margin:0 0 10px;
      font-size:18px;
      letter-spacing:-.01em;
    }
    section.card h3{
      margin:16px 0 8px;
      font-size:15px;
      color:var(--muted);
    }
    p{margin:8px 0}
    ul{margin:8px 0 8px 18px}
    li{margin:6px 0}
    .hr{
      height:1px;
      background: var(--line);
      margin:14px 0;
    }

    .callouts{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:12px;
      margin-top:10px;
    }
    .callout{
      grid-column: span 12;
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      padding:12px 12px 10px;
      position:relative;
      overflow:hidden;
    }
    .callout:before{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(480px 160px at 20% 0%, rgba(122,162,255,.12), transparent 60%);
      opacity:.8;
      pointer-events:none;
    }
    .callout > *{position:relative}
    .callout .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:12px;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      color:var(--muted);
      margin-bottom:8px;
      white-space:nowrap;
    }
    .tag .pill{
      width:10px;height:10px;border-radius:999px;background:var(--brand);
      box-shadow:0 0 0 3px rgba(122,162,255,.18);
    }
    .callout.assumptions .pill{background: var(--warn); box-shadow:0 0 0 3px rgba(255,204,102,.18)}
    .callout.mistakes .pill{background: var(--bad); box-shadow:0 0 0 3px rgba(255,122,154,.18)}
    .callout.final .pill{background: var(--ok); box-shadow:0 0 0 3px rgba(139,255,176,.18)}
    .callout.mathinsight .pill{background: var(--brand2); box-shadow:0 0 0 3px rgba(122,240,198,.18)}

    .eqbox{
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(0,0,0,.18);
      padding:10px 10px 8px;
      margin:10px 0;
      overflow:auto;
    }
    @media (prefers-color-scheme: light){
      .eqbox{background: rgba(10,20,40,.04)}
    }
    pre.eq{
      margin:0;
      white-space:pre-wrap;
      word-break:break-word;
      font-size: 13.5px;
      line-height:1.55;
    }
    .eqrow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin:0 0 8px;
    }
    .eqrow .label{
      font-size:12px;
      color:var(--faint);
      text-transform:uppercase;
      letter-spacing:.06em;
    }
    button.copy{
      border:1px solid var(--line);
      background: rgba(255,255,255,.05);
      color:var(--text);
      padding:7px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-size:12.5px;
      transition: transform .12s ease, background .12s ease;
      white-space:nowrap;
    }
    button.copy:hover{background: rgba(122,162,255,.12); transform: translateY(-1px)}
    button.copy:active{transform: translateY(0px)}
    .copied{
      color: var(--ok);
      font-size: 12px;
      margin-left: 8px;
      opacity: 0;
      transform: translateY(2px);
      transition: opacity .18s ease, transform .18s ease;
    }
    .copied.show{opacity:1; transform: translateY(0px)}

    details{
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(255,255,255,.03);
      padding:10px 12px;
      margin:10px 0;
    }
    details summary{
      cursor:pointer;
      color:var(--muted);
      font-weight:600;
      list-style:none;
      display:flex;
      align-items:center;
      gap:8px;
    }
    details summary::-webkit-details-marker{display:none}
    details summary:before{
      content:"▸";
      display:inline-block;
      transform: translateY(-1px);
      transition: transform .15s ease;
      color: var(--brand);
    }
    details[open] summary:before{transform: rotate(90deg) translateX(1px)}

    figure.plot{
      margin:12px 0 0;
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.03);
      padding:12px;
      overflow:hidden;
    }
    figure.plot figcaption{
      margin-top:8px;
      color:var(--muted);
      font-size:13px;
    }
    canvas{max-width:100%; height:auto; display:block; border-radius:14px}

    .twoCol{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 820px){
      .twoCol{grid-template-columns:1fr}
    }

    .kpi{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:12px;
      margin-top:10px;
    }
    .kpi .box{
      grid-column: span 6;
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(255,255,255,.03);
      padding:12px;
    }
    @media (max-width: 820px){
      .kpi .box{grid-column: span 12}
    }
    .box h4{margin:0 0 6px; font-size:13.5px; color:var(--muted)}
    .box p{margin:0; color:var(--text); font-size:13.5px}

    footer{
      margin-top:18px;
      color:var(--faint);
      font-size:12.5px;
      text-align:center;
    }

    @media print{
      body{background:#fff; color:#000}
      header.hero, section.card, nav.toc{box-shadow:none}
      nav.toc{position:static}
      button.copy, .copied{display:none !important}
      a{text-decoration:underline; color:#000}
      .wrap{width:100%; margin:0; padding:0}
      section.card{break-inside:avoid; page-break-inside:avoid}
    }
  </style>
</head>
<body>
  <a id="top"></a>
  <div class="wrap">
    <header class="hero">
      <div class="title">
        <div class="badge"><span class="dot"></span> Phonons • Crystal Vibrations • Monatomic Chain</div>
        <h1>Energy of a Longitudinal Traveling Wave in a Monatomic Linear Lattice</h1>
      </div>
      <p class="subtitle">
        We build the discrete mathematical model (a lattice of masses and springs), derive the total energy expression from first principles,
        then substitute a plane-wave solution and compute the <em>time-averaged energy per atom</em>. Along the way, we connect the result to
        eigenmodes of the discrete Laplacian and the dispersion relation.
      </p>
      <div class="meta">
        <span>Model: discrete 1D chain</span>
        <span>Key outcome: ⟨E⟩/atom</span>
        <span>Math focus: operator/eigenvalue structure</span>
      </div>
    </header>

    <div class="grid">
      <nav class="toc" aria-label="Table of contents">
        <h2>Contents</h2>
        <a href="#qs">Quick Summary</a>
        <a href="#p0">PART 0 — Concept Primer</a>
        <a href="#p0b">PART 0B — Industry &amp; Applied Physics</a>
        <a href="#p1">PART 1 — Problem Analysis</a>
        <a href="#p2">PART 2 — Strategy &amp; Tips</a>
        <a href="#p3">PART 3 — Full Solution</a>
        <a href="#p4">PART 4 — Deeper Understanding</a>
        <a href="#p5">PART 5 — Optional Plot Guide</a>
        <div class="toplink">
          <a href="#top">↑ Back to top</a>
          <p style="margin:8px 0 0; font-size:12.5px; color:var(--faint)"><small>Sticky on desktop for fast navigation.</small></p>
        </div>
      </nav>

      <main>
        <section id="qs" class="card">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What it’s about:</strong> A longitudinal wave traveling through a 1D monatomic lattice (masses <code>M</code>, spacing <code>a</code>, spring constant <code>C</code>).</li>
            <li><strong>Key physics idea:</strong> Total energy = kinetic energy of atoms + elastic potential energy in nearest-neighbor “springs”.</li>
            <li><strong>Mathematical model:</strong> Discrete field <code>u_s(t)</code> on integer sites <code>s</code>; dynamics from a discrete second-difference operator (a discrete Laplacian).</li>
            <li><strong>Governing equation:</strong> <code>M d²u_s/dt² = C(u_{s+1} - 2u_s + u_{s-1})</code> (linear, translation-invariant ODE system).</li>
            <li><strong>Wave ansatz:</strong> <code>u_s(t)=u cos(ω t − s K a)</code>; it is an eigenmode of the discrete Laplacian.</li>
            <li><strong>Result type:</strong> Symbolic. We compute the <strong>time-averaged total energy per atom</strong>, ⟨E⟩/N.</li>
            <li><strong>Main result:</strong> <code>⟨E⟩/atom = (1/4) M ω² u² + (1/2) C(1 − cos Ka) u² = (1/2) M ω² u²</code> (using dispersion).</li>
            <li><strong>Physical meaning:</strong> On average, energy splits between kinetic and potential; dispersion links spring energy to kinetic energy.</li>
          </ul>
        </section>

        <section id="p0" class="card">
          <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

          <h3>0.1 Core definitions (symbols + SI units)</h3>
          <div class="kpi">
            <div class="box">
              <h4>Lattice and kinematics</h4>
              <p>
                <strong>s</strong> = integer site index (dimensionless), site position <strong>x_s</strong>= s a (m),<br/>
                <strong>u_s(t)</strong> = longitudinal displacement from equilibrium (m),<br/>
                <strong>v_s(t)=du_s/dt</strong> = velocity (m·s⁻¹).
              </p>
            </div>
            <div class="box">
              <h4>Material parameters</h4>
              <p>
                <strong>M</strong> = atomic mass (kg), <strong>a</strong> = spacing (m),<br/>
                <strong>C</strong> = nearest-neighbor spring constant (N·m⁻¹ = kg·s⁻²).
              </p>
            </div>
            <div class="box">
              <h4>Wave parameters</h4>
              <p>
                <strong>K</strong> = wavevector (m⁻¹), <strong>ω</strong> = angular frequency (s⁻¹),<br/>
                <strong>u</strong> = displacement amplitude (m), phase <strong>φ_s = ω t − s K a</strong>.
              </p>
            </div>
            <div class="box">
              <h4>Energy</h4>
              <p>
                Kinetic per atom: <strong>(1/2) M v_s²</strong> (J),<br/>
                Spring energy per bond: <strong>(1/2) C (u_{s+1}−u_s)²</strong> (J).
              </p>
            </div>
          </div>

          <h3>0.2 Physical meaning (intuition)</h3>
          <p>
            A monatomic chain acts like a discretized elastic medium: each mass stores kinetic energy when moving,
            and each bond stores potential energy when stretched/compressed. A traveling wave continuously converts
            between these two forms—just like a continuous string—but with lattice-specific dispersion due to discreteness.
          </p>

          <h3>0.3 Key laws/principles and validity conditions</h3>
          <div class="callouts">
            <div class="callout assumptions">
              <div class="tag"><span class="pill"></span><strong>Assumptions / regime</strong></div>
              <ul>
                <li><strong>Small displacements</strong>: harmonic approximation → force linear in extension (Hooke’s law).</li>
                <li><strong>Nearest-neighbor coupling only</strong>: each atom interacts only with s±1 via springs constant C.</li>
                <li><strong>Longitudinal, 1D, monatomic</strong>: one degree of freedom per site.</li>
                <li><strong>Ideal lattice</strong>: identical masses, identical springs, no damping, no defects → energy conservation.</li>
              </ul>
            </div>
          </div>

          <h3>0.4 Common models/approximations and why used</h3>
          <ul>
            <li><strong>Harmonic lattice model</strong>: Replace real interatomic potential by quadratic expansion about equilibrium; yields linear equations and tractable normal modes (phonons).</li>
            <li><strong>Periodic boundary conditions (PBC)</strong>: For N atoms in a ring, u_{s+N}=u_s. This enforces translational symmetry and discretizes allowed K.</li>
            <li><strong>Continuum limit</strong> (optional): For long wavelengths Ka≪1, discrete differences become derivatives; you recover the wave equation for sound.</li>
          </ul>

          <h3>0.5 Mini intuition examples (no heavy algebra)</h3>
          <ul>
            <li><strong>Uniform translation</strong> (K=0): all atoms move together → no spring stretching → potential energy ~ 0, ω=0.</li>
            <li><strong>Zone boundary pattern</strong> (Ka=π): neighbors move opposite → maximal stretching/compression; ω reaches its maximum.</li>
            <li><strong>Long wavelength</strong> (Ka small): looks like ordinary sound; ω≈v_s|K| with sound speed v_s ≈ a√(C/M).</li>
          </ul>

          <h3>0.6 What to watch for (pitfalls)</h3>
          <ul>
            <li>Double-counting spring energy: each bond should be counted once (e.g., sum over s of (u_s−u_{s+1})²).</li>
            <li>Confusing amplitude <code>u</code> with site displacement <code>u_s(t)</code>.</li>
            <li>For time averages: ⟨cos²⟩=⟨sin²⟩=1/2 over a period; ⟨sin cos⟩=0.</li>
            <li>Remember <code>K</code> has units m⁻¹ but <code>Ka</code> is dimensionless (the natural lattice parameter).</li>
          </ul>

          <div class="callouts">
            <div class="callout mathinsight">
              <div class="tag"><span class="pill"></span><strong>Math Insight</strong> (core equation as a mathematical object)</div>
              <p style="margin:6px 0 0">
                The lattice dynamics are a <strong>linear ODE system</strong> on a discrete spatial domain:
                <code>u(t) ∈ ℝ^N</code>. The operator
                <code>(Δ_d u)_s = u_{s+1} − 2u_s + u_{s−1}</code> is the <strong>discrete Laplacian</strong>.
                Normal modes solve an <strong>eigenvalue problem</strong> for Δ_d. Plane waves are eigenvectors because of
                translation symmetry, and the eigenvalues generate the <strong>dispersion relation</strong>.
              </p>
            </div>
          </div>
        </section>

        <section id="p0b" class="card">
          <h2>PART 0B — Industry &amp; Applied Physics Perspective</h2>

          <h3>Why engineers care (industrial relevance)</h3>
          <ul>
            <li><strong>Thermal management &amp; reliability</strong>: Phonons carry heat in insulators/semiconductors. Understanding energy per mode helps predict thermal conductivity and failure risks from hotspots.</li>
            <li><strong>MEMS/NEMS resonators</strong>: Micro/nano resonators behave like coupled mass-spring lattices. Mode energies relate to vibration amplitudes, Q-factor budgeting, and fatigue.</li>
            <li><strong>Acoustic metamaterials</strong>: Periodic structures (mass-spring analogs) create bandgaps. Dispersion and energy partition are central to vibration isolation and noise control.</li>
          </ul>

          <h3>Where this appears in real systems (3+ concrete areas)</h3>
          <ul>
            <li>Crystalline solids: phonon spectra → heat capacity, thermal expansion, sound speeds.</li>
            <li>Polymer/chain-like materials and latticed structures: simplified 1D models guide intuition and design rules.</li>
            <li>Granular chains and impact mitigators: discrete wave propagation and energy localization.</li>
            <li>Photonic/phononic crystals: discrete periodicity → engineered dispersion and bandgaps.</li>
          </ul>

          <h3>Typical measurement/validation methods</h3>
          <ul>
            <li><strong>Brillouin/Raman scattering</strong>: measures phonon frequencies (dispersion near zone center or optical branches in more complex lattices).</li>
            <li><strong>Ultrasonic testing</strong>: extracts sound velocity (long-wavelength limit of dispersion).</li>
            <li><strong>Laser Doppler vibrometry</strong> (MEMS): measures mode shapes/amplitudes; energy inferred from amplitude and effective mass.</li>
          </ul>

          <h3>Design trade-offs and constraints</h3>
          <ul>
            <li>Real materials have <strong>anharmonicity</strong> (nonlinear springs), <strong>damping</strong>, <strong>defects</strong>, and <strong>finite size</strong>. These broaden resonances and break perfect energy conservation.</li>
            <li>Manufacturing tolerances produce mass/spring disorder → scattering/localization; the ideal plane-wave picture becomes approximate.</li>
            <li>Engineers often tune periodicity <code>a</code> and stiffness <code>C</code> to shape dispersion (e.g., push bandgaps into problematic frequency ranges).</li>
          </ul>

          <details>
            <summary>From lab to product: adapting the ideal model</summary>
            <p>
              In products, you rarely have perfectly identical atoms/springs. A practical workflow is:
              (1) start with the harmonic periodic model to get baseline dispersion/energy scaling;
              (2) add damping (Rayleigh/viscoelastic), disorder, and boundary constraints;
              (3) validate against modal testing/scattering measurements; and
              (4) use the refined model to set tolerances, predict fatigue hot spots, and optimize for cost/performance.
            </p>
          </details>
        </section>

        <section id="p1" class="card">
          <h2>PART 1 — Problem Analysis (no solving yet)</h2>

          <h3>1.1 Rewrite the problem (in plain words)</h3>
          <p>
            A longitudinal wave travels through a monatomic 1D lattice:
            <code>u_s(t)=u cos(ω t − s K a)</code>.
            The chain has atoms of mass <code>M</code>, lattice spacing <code>a</code>, and nearest-neighbor spring constant <code>C</code>.
          </p>
          <p>
            (a) Show the total energy of the wave can be written as kinetic plus spring potential:
            <code>E = (1/2)M Σ_s (du_s/dt)² + (1/2)C Σ_s (u_s − u_{s+1})²</code>.
            <br/>
            (b) Substitute the traveling wave and show the <em>time-averaged</em> total energy per atom equals
            <code>(1/4)M ω² u² + (1/2)C(1 − cos Ka)u²</code>, and then use the dispersion relation to show it equals
            <code>(1/2)M ω² u²</code>.
          </p>

          <h3>1.2 Given quantities</h3>
          <ul>
            <li><code>u_s(t)=u cos(ω t − s K a)</code></li>
            <li>Mass <code>M</code>, spacing <code>a</code>, nearest-neighbor constant <code>C</code></li>
            <li>Dispersion relation for this monatomic chain:
              <code>ω² = (4C/M) sin²(Ka/2) = (2C/M)(1 − cos Ka)</code>
            </li>
          </ul>

          <h3>1.3 Unknowns / what must be shown</h3>
          <ul>
            <li>Derive total energy expression <code>E</code> in the stated summed form.</li>
            <li>Compute time average ⟨E⟩ and then ⟨E⟩/atom.</li>
            <li>Use dispersion relation to simplify final expression.</li>
          </ul>

          <h3>1.4 Mathematical model (explicit)</h3>
          <div class="callouts">
            <div class="callout">
              <div class="tag"><span class="pill"></span><strong>Discrete field model</strong></div>
              <ul>
                <li><strong>Domain:</strong> sites <code>s ∈ ℤ</code> (infinite chain) or <code>s=0,…,N−1</code> (finite chain).</li>
                <li><strong>Coordinate system:</strong> 1D along chain axis <code>x</code>, with equilibrium positions <code>x_s = s a</code>.</li>
                <li><strong>State variable:</strong> displacement <code>u_s(t)</code> for each site.</li>
                <li><strong>Boundary conditions (typical):</strong> periodic <code>u_{s+N}(t)=u_s(t)</code> for normal modes; or fixed/free ends in other contexts.</li>
                <li><strong>Initial conditions (for dynamics):</strong> <code>u_s(0)</code>, <code>du_s/dt(0)</code>. Here, the wave form already encodes a specific solution.</li>
              </ul>
            </div>
          </div>

          <h3>1.5 Relevant principles and why they apply</h3>
          <ul>
            <li><strong>Energy in conservative systems:</strong> For masses + springs with no damping, total energy is conserved and equals kinetic + potential.</li>
            <li><strong>Hookean potential energy:</strong> A spring with extension <code>δ</code> stores <code>(1/2)C δ²</code>.</li>
            <li><strong>Linearity and symmetry:</strong> Translation invariance makes plane waves eigenmodes; time averaging uses periodicity.</li>
          </ul>

          <h3>1.6 Approaches (compare 2–3)</h3>
          <div class="twoCol">
            <div class="callout">
              <div class="tag"><span class="pill"></span><strong>Approach A: Energy by inspection</strong></div>
              <p>
                Write <code>T=(1/2)M Σ v_s²</code> and <code>V=(1/2)C Σ (u_{s+1}-u_s)²</code> directly.
                <br/><strong>Pros:</strong> fast, transparent. <strong>Cons:</strong> must avoid double-counting.
              </p>
            </div>
            <div class="callout">
              <div class="tag"><span class="pill"></span><strong>Approach B: Lagrangian/Hamiltonian</strong></div>
              <p>
                Use <code>L=T−V</code>, then energy from time-translation symmetry.
                <br/><strong>Pros:</strong> rigorous, general. <strong>Cons:</strong> longer.
              </p>
            </div>
          </div>
          <p><strong>Chosen approach:</strong> A + B/C: physical clarity plus mathematical rigor and dispersion connection.</p>
        </section>

        <section id="p2" class="card">
          <h2>PART 2 — Strategy &amp; Tips (roadmap only)</h2>
          <ol>
            <li>Write <code>E=T+V</code> from masses and springs.</li>
            <li>Differentiate the wave to get <code>v_s</code>.</li>
            <li>Compute time averages using ⟨sin²⟩=⟨cos²⟩=1/2.</li>
            <li>Simplify <code>u_s−u_{s+1}</code> with trig identities.</li>
            <li>Get ⟨E⟩/atom via translation invariance.</li>
            <li>Use dispersion to reduce to <code>(1/2)Mω²u²</code>.</li>
            <li>Do unit and limiting-case checks.</li>
          </ol>
          <div class="callouts">
            <div class="callout mistakes">
              <div class="tag"><span class="pill"></span><strong>Common mistakes</strong></div>
              <ul>
                <li>Double-counting bonds in <code>V</code>.</li>
                <li>Forgetting the factor 1/2 from time averaging.</li>
                <li>Mixing up <code>K</code> (m⁻¹) and <code>Ka</code> (dimensionless).</li>
              </ul>
            </div>
          </div>
        </section>

        <section id="p3" class="card">
          <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

          <h3>3.1 Physical intuition first</h3>
          <p>
            The chain is a conservative set of coupled harmonic oscillators. So the total energy is the sum of kinetic energies
            of all masses and potential energies of all springs. A traveling normal mode exchanges energy between kinetic and
            potential, but the time average is constant and becomes especially simple once the dispersion relation links
            inertia and stiffness.
          </p>

          <div class="hr"></div>

          <h3>3.2 Part (a): Total energy expression</h3>

          <p><strong>Kinetic energy.</strong> Each mass has kinetic energy <code>(1/2)M(du_s/dt)²</code>. Summing over atoms:</p>
          <div class="eqbox">
            <div class="eqrow">
              <div class="label">Kinetic</div>
              <div>
                <button class="copy" data-copy-target="eqA1">Copy</button><span class="copied" id="ok-eqA1">Copied</span>
              </div>
            </div>
            <pre class="eq" id="eqA1">T = (1/2) M Σ_s (du_s/dt)^2</pre>
          </div>

          <p><strong>Potential energy.</strong> Bond (s,s+1) extension is <code>u_{s+1}−u_s</code>, so spring energy is <code>(1/2)C(u_{s+1}−u_s)²</code>.
            Sum once per bond:</p>
          <div class="eqbox">
            <div class="eqrow">
              <div class="label">Potential</div>
              <div>
                <button class="copy" data-copy-target="eqA3">Copy</button><span class="copied" id="ok-eqA3">Copied</span>
              </div>
            </div>
            <pre class="eq" id="eqA3">V = (1/2) C Σ_s (u_s − u_{s+1})^2</pre>
          </div>

          <p><strong>Total energy.</strong> Therefore:</p>
          <div class="eqbox">
            <div class="eqrow">
              <div class="label">Total (shown)</div>
              <div>
                <button class="copy" data-copy-target="eqA4">Copy</button><span class="copied" id="ok-eqA4">Copied</span>
              </div>
            </div>
            <pre class="eq" id="eqA4">E = T + V = (1/2) M Σ_s (du_s/dt)^2 + (1/2) C Σ_s (u_s − u_{s+1})^2</pre>
          </div>

          <details>
            <summary>Operator / mathematical physics note</summary>
            <p>
              Let <code>u(t)</code> be the vector of displacements. Define the discrete Laplacian
              <code>(Δ_d u)_s = u_{s+1} − 2u_s + u_{s−1}</code>.
              Equations of motion are <code>M d²u/dt² = C Δ_d u</code>.
              With periodic BCs, <code>Δ_d</code> is circulant and diagonalized by Fourier modes
              <code>e^{i(ωt−sKa)}</code>.
            </p>
          </details>

          <div class="hr"></div>

          <h3>3.3 Part (b): Time-averaged energy per atom</h3>

          <p><strong>Given:</strong> <code>u_s(t)=u cos(ω t − sKa)</code>.</p>

          <h4>Kinetic term</h4>
          <p>Differentiate:</p>
          <div class="eqbox">
            <div class="eqrow">
              <div class="label">Velocity</div>
              <div>
                <button class="copy" data-copy-target="eqB1">Copy</button><span class="copied" id="ok-eqB1">Copied</span>
              </div>
            </div>
            <pre class="eq" id="eqB1">du_s/dt = -u ω sin(ω t − sKa)</pre>
          </div>
          <p>Square and time-average using ⟨sin²⟩=1/2:</p>
          <div class="eqbox">
            <div class="eqrow">
              <div class="label">⟨Kinetic⟩ per atom</div>
              <div>
                <button class="copy" data-copy-target="eqB3">Copy</button><span class="copied" id="ok-eqB3">Copied</span>
              </div>
            </div>
            <pre class="eq" id="eqB3">⟨T⟩/atom = (1/2)M ⟨(du_s/dt)^2⟩
         = (1/2)M (u^2 ω^2)⟨sin^2⟩
         = (1/2)M (u^2 ω^2)(1/2)
         = (1/4) M ω^2 u^2</pre>
          </div>

          <h4>Potential term</h4>
          <p>
            Let <code>A = ω t − sKa</code>. Then:
            <code>u_s − u_{s+1} = u[cos(A) − cos(A − Ka)]</code>.
            Use <code>cos x − cos y = −2 sin((x+y)/2) sin((x−y)/2)</code>:
          </p>
          <div class="eqbox">
            <div class="eqrow">
              <div class="label">Difference simplified</div>
              <div>
                <button class="copy" data-copy-target="eqB5">Copy</button><span class="copied" id="ok-eqB5">Copied</span>
              </div>
            </div>
            <pre class="eq" id="eqB5">u_s − u_{s+1} = -2u sin(A − Ka/2) sin(Ka/2)</pre>
          </div>
          <p>Square and average (⟨sin²⟩=1/2):</p>
          <div class="eqbox">
            <div class="eqrow">
              <div class="label">⟨Potential⟩ per atom</div>
              <div>
                <button class="copy" data-copy-target="eqB8">Copy</button><span class="copied" id="ok-eqB8">Copied</span>
              </div>
            </div>
            <pre class="eq" id="eqB8">⟨V⟩/atom = (1/2)C ⟨(u_s − u_{s+1})^2⟩
         = (1/2)C [4u^2 sin^2(Ka/2)]⟨sin^2(A − Ka/2)⟩
         = (1/2)C [4u^2 sin^2(Ka/2)](1/2)
         = C u^2 sin^2(Ka/2)
         = (1/2)C (1 − cos Ka) u^2</pre>
          </div>

          <h4>Total time-averaged energy per atom</h4>
          <div class="eqbox">
            <div class="eqrow">
              <div class="label">⟨Total⟩ per atom</div>
              <div>
                <button class="copy" data-copy-target="eqB9">Copy</button><span class="copied" id="ok-eqB9">Copied</span>
              </div>
            </div>
            <pre class="eq" id="eqB9">⟨E⟩/atom = (1/4) M ω^2 u^2 + (1/2) C (1 − cos Ka) u^2</pre>
          </div>

          <p>
            Use the dispersion relation for a monatomic nearest-neighbor chain:
            <code>ω^2 = (4C/M) sin^2(Ka/2) = (2C/M)(1 − cos Ka)</code>.
            Hence <code>(1/2)C(1−cosKa) = (1/4)Mω²</code>. Substitute:
          </p>

          <div class="eqbox">
            <div class="eqrow">
              <div class="label">Final simplification</div>
              <div>
                <button class="copy" data-copy-target="finalText">Copy</button><span class="copied" id="ok-finalText">Copied</span>
              </div>
            </div>
            <pre class="eq" id="finalText">⟨E⟩/atom = (1/4) M ω^2 u^2 + (1/2) C (1 − cos Ka) u^2
Using ω^2 = (2C/M)(1 − cos Ka) ⇒ (1/2)C(1−cosKa) = (1/4)Mω^2
Therefore ⟨E⟩/atom = (1/4)Mω^2u^2 + (1/4)Mω^2u^2 = (1/2)Mω^2u^2</pre>
          </div>

          <div class="callouts">
            <div class="callout final">
              <div class="tag"><span class="pill"></span><strong>FINAL ANSWER (boxed)</strong></div>
              <p style="margin:6px 0 0">
                <code>⟨E⟩/atom = (1/4) M ω² u² + (1/2) C(1 − cos Ka) u² = (1/2) M ω² u²</code>.
              </p>
            </div>
          </div>

          <h3>3.4 Sanity checks</h3>
          <ul>
            <li><strong>Units:</strong> <code>Mω²u²</code> → J; <code>Cu²</code> → J.</li>
            <li><strong>Ka→0:</strong> <code>1−cosKa≈(Ka)²/2</code>, small energy (near rigid motion).</li>
            <li><strong>Ka=π:</strong> <code>ω²=4C/M</code>, maximum frequency/energy for given u.</li>
            <li><strong>Positivity:</strong> both ⟨T⟩ and ⟨V⟩ are ≥ 0.</li>
          </ul>

          <details>
            <summary>Optional: continuum-limit connection (PDE idea)</summary>
            <p>
              If <code>Ka ≪ 1</code>, then the discrete second difference satisfies
              <code>u_{s+1} − 2u_s + u_{s−1} ≈ a² ∂²u/∂x²</code>.
              The lattice ODE system approaches the wave equation
              <code>∂²u/∂t² = v_s² ∂²u/∂x²</code> with <code>v_s = a√(C/M)</code>.
              The plane wave becomes a PDE eigenmode, and the same energy-splitting logic holds.
            </p>
          </details>
        </section>

        <section id="p4" class="card">
          <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

          <h3>4.1 Interpreting the terms</h3>
          <p>
            The elastic factor <code>(1 − cos Ka)</code> is the discrete analog of <code>(Ka)²/2</code> at long wavelengths.
            It measures how much neighboring atoms separate: larger <code>K</code> means more relative motion and higher spring energy.
          </p>

          <h3>4.2 Parameter dependence</h3>
          <ul>
            <li><strong>u:</strong> energy ∝ <code>u²</code>.</li>
            <li><strong>C:</strong> stiffer coupling → higher ω and higher stored elastic energy.</li>
            <li><strong>M:</strong> heavier atoms → lower ω; at fixed ω and u, energy scales with M.</li>
            <li><strong>K:</strong> controls dispersion and energy via <code>sin²(Ka/2)</code>.</li>
          </ul>

          <div class="callouts">
            <div class="callout mathinsight">
              <div class="tag"><span class="pill"></span><strong>Math Insight</strong></div>
              <p style="margin:6px 0 0">
                The discrete Laplacian <code>Δ_d</code> is a symmetric (self-adjoint) operator under the standard inner product
                <code>⟨u,v⟩=Σ_s u_s v_s</code> (with periodic BCs). Hence its eigenvectors form an orthogonal basis, enabling
                modal energy decomposition—central in both phonon theory and vibration engineering.
              </p>
            </div>
          </div>

          <h3>4.3 Concept check (Q&amp;A)</h3>
          <ul>
            <li><strong>Q:</strong> Why does ⟨sin²(ωt − sKa)⟩ equal 1/2 for all s? <strong>A:</strong> A phase shift in time does not change the period average.</li>
            <li><strong>Q:</strong> What does <code>K=0</code> represent? <strong>A:</strong> Rigid translation; no restoring force; ω=0.</li>
            <li><strong>Q:</strong> Why can we use the dispersion relation here? <strong>A:</strong> The wave form is a normal mode; ω and K are linked by the eigenvalue condition of the discrete operator.</li>
          </ul>
        </section>

        <section id="p5" class="card">
          <h2>PART 5 — Optional Plot Guide (ONLY IF A PLOT EXISTS)</h2>

          <figure class="plot">
            <canvas id="dispersionPlot" width="980" height="520" aria-label="Dispersion plot"></canvas>
            <figcaption>
              Normalized dispersion: <code>ω/ωmax = |sin(Ka/2)|</code> with <code>ωmax = 2√(C/M)</code>.
              Example values for plotting only: <code>C/M = 1</code>.
            </figcaption>
          </figure>

          <ul>
            <li><strong>Axes:</strong> x = <code>Ka</code> (dimensionless), y = <code>ω/ωmax</code> (dimensionless).</li>
            <li><strong>Why useful:</strong> visualizes lattice dispersion; explains why energy depends on <code>1−cosKa</code>.</li>
            <li><strong>What to notice:</strong> linear near 0 (sound), flattening toward π (reduced group velocity).</li>
          </ul>
        </section>

        <footer>
          <p>Self-contained article: discrete modeling → energy → averaging → dispersion → final result.</p>
          <p><a href="#top">Back to top</a></p>
        </footer>
      </main>
    </div>
  </div>

  <script>
    (function(){
      const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      // Smooth scroll
      document.querySelectorAll('a[href^="#"]').forEach(a=>{
        a.addEventListener('click', (e)=>{
          const id = a.getAttribute('href');
          if(!id || id === '#') return;
          const el = document.querySelector(id);
          if(!el) return;
          e.preventDefault();
          el.scrollIntoView({behavior: reduce ? 'auto' : 'smooth', block: 'start'});
          history.replaceState(null, '', id);
        });
      });

      // Copy buttons
      function setCopied(id){
        const el = document.getElementById(id);
        if(!el) return;
        el.classList.add('show');
        setTimeout(()=>el.classList.remove('show'), 900);
      }
      async function copyText(txt){
        try{
          await navigator.clipboard.writeText(txt);
          return true;
        }catch(err){
          const ta = document.createElement('textarea');
          ta.value = txt;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          ta.style.top = '0';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          let ok = false;
          try{ ok = document.execCommand('copy'); }catch(e){ ok = false; }
          document.body.removeChild(ta);
          return ok;
        }
      }
      document.querySelectorAll('button.copy').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const targetId = btn.getAttribute('data-copy-target');
          const target = document.getElementById(targetId);
          if(!target) return;
          const text = target.innerText.replace(/\u00A0/g,' ').trim();
          const ok = await copyText(text);
          if(ok) setCopied('ok-' + targetId);
        });
      });

      // Single static plot: normalized dispersion ω/ωmax = |sin(Ka/2)| for Ka in [0, π]
      const canvas = document.getElementById('dispersionPlot');
      const ctx = canvas.getContext('2d');

      function draw(){
        const parent = canvas.parentElement;
        const cssWidth = parent ? Math.min(parent.clientWidth - 2, 980) : 980;
        const cssHeight = Math.round(cssWidth * 0.53);
        const dpr = Math.max(1, window.devicePixelRatio || 1);

        canvas.style.width = cssWidth + 'px';
        canvas.style.height = cssHeight + 'px';
        canvas.width = Math.floor(cssWidth * dpr);
        canvas.height = Math.floor(cssHeight * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);

        const W = cssWidth, H = cssHeight;
        const padL = 66, padR = 18, padT = 44, padB = 56;
        const plotW = W - padL - padR;
        const plotH = H - padT - padB;

        ctx.clearRect(0,0,W,H);
        const panel2 = getComputedStyle(document.documentElement).getPropertyValue('--panel2').trim() || 'rgba(255,255,255,0.03)';
        ctx.fillStyle = panel2;
        ctx.fillRect(0,0,W,H);

        const text = getComputedStyle(document.documentElement).getPropertyValue('--text').trim() || '#eee';
        const muted = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#b8c2e6';
        const faint = getComputedStyle(document.documentElement).getPropertyValue('--faint').trim() || '#8d98c7';
        const line = getComputedStyle(document.documentElement).getPropertyValue('--line').trim() || 'rgba(255,255,255,.12)';
        const brand = getComputedStyle(document.documentElement).getPropertyValue('--brand').trim() || '#7aa2ff';

        ctx.fillStyle = text;
        ctx.font = '600 14px ' + getComputedStyle(document.body).fontFamily;
        ctx.fillText('Monatomic Chain Dispersion (Normalized): ω/ωmax = |sin(Ka/2)|', padL, 22);

        function xMap(Ka){ return padL + (Ka / Math.PI) * plotW; }
        function yMap(y){ return padT + (1 - y) * plotH; }

        // Grid
        ctx.strokeStyle = line;
        ctx.lineWidth = 1;

        const xTicks = 6;
        for(let i=0;i<=xTicks;i++){
          const Ka = (Math.PI * i)/xTicks;
          const x = xMap(Ka);
          ctx.beginPath();
          ctx.moveTo(x, padT);
          ctx.lineTo(x, padT + plotH);
          ctx.stroke();
        }
        const yTicks = 5;
        for(let j=0;j<=yTicks;j++){
          const y = j/yTicks;
          const yy = yMap(y);
          ctx.beginPath();
          ctx.moveTo(padL, yy);
          ctx.lineTo(padL + plotW, yy);
          ctx.stroke();
        }

        // Axes
        ctx.strokeStyle = faint;
        ctx.lineWidth = 1.2;
        ctx.beginPath();
        ctx.moveTo(padL, padT);
        ctx.lineTo(padL, padT + plotH);
        ctx.lineTo(padL + plotW, padT + plotH);
        ctx.stroke();

        // Tick labels
        ctx.fillStyle = muted;
        ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;

        for(let i=0;i<=xTicks;i++){
          const Ka = (Math.PI * i)/xTicks;
          const x = xMap(Ka);
          let label;
          if(i===0) label = '0';
          else if(i===xTicks) label = 'π';
          else if(i===xTicks/2) label = 'π/2';
          else label = i + 'π/' + xTicks;
          ctx.textAlign = 'center';
          ctx.textBaseline = 'top';
          ctx.fillText(label, x, padT + plotH + 10);
        }

        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        for(let j=0;j<=yTicks;j++){
          const y = j/yTicks;
          const yy = yMap(y);
          ctx.fillText(y.toFixed(1), padL - 10, yy);
        }

        // Axis labels
        ctx.fillStyle = muted;
        ctx.font = '600 12px ' + getComputedStyle(document.body).fontFamily;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        ctx.fillText('Ka (dimensionless)', padL + plotW/2, H - 24);

        ctx.save();
        ctx.translate(18, padT + plotH/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        ctx.fillText('ω / ωmax', 0, 0);
        ctx.restore();

        // Curve
        ctx.strokeStyle = brand;
        ctx.lineWidth = 2.4;
        ctx.beginPath();
        const N = 400;
        for(let i=0;i<=N;i++){
          const Ka = Math.PI * i / N;
          const y = Math.abs(Math.sin(Ka/2));
          const x = xMap(Ka);
          const yy = yMap(y);
          if(i===0) ctx.moveTo(x, yy);
          else ctx.lineTo(x, yy);
        }
        ctx.stroke();

        // Legend
        ctx.fillStyle = muted;
        ctx.font = '12px ' + getComputedStyle(document.body).fontFamily;
        const lx = padL + plotW - 170;
        const ly = padT + 10;
        ctx.fillText('Curve: ω/ωmax = |sin(Ka/2)|', lx + 18, ly);
        ctx.strokeStyle = brand;
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(lx, ly + 5);
        ctx.lineTo(lx + 14, ly + 5);
        ctx.stroke();
      }

      const ro = new ResizeObserver(()=>draw());
      ro.observe(canvas.parentElement);
      draw();
      window.addEventListener('orientationchange', draw);
    })();
  </script>
</body>
</html>
