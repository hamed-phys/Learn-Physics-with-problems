<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <meta name="theme-color" content="#0b0c10" />
  <title>Kohn Anomaly from Oscillatory Interplanar Force Constants (1D Lattice)</title>
  <style>
    :root{
      --bg:#0b0c10;
      --panel:#11131a;
      --panel2:#0f1117;
      --text:#e8ecf2;
      --muted:#a9b2c3;
      --faint:#7f889a;
      --line:#242835;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --shadow: 0 14px 40px rgba(0,0,0,.35);
      --radius:16px;
      --radius2:22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
      --serif: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
    }

    *{ box-sizing:border-box; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1000px 600px at 10% 0%, rgba(125,211,252,.10), transparent 55%),
                  radial-gradient(900px 550px at 90% 10%, rgba(167,139,250,.10), transparent 50%),
                  linear-gradient(180deg, var(--bg), #07080c 85%);
      color:var(--text);
      line-height:1.6;
    }

    a{ color:var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }
    code, pre{ font-family:var(--mono); }
    pre{
      background: #0a0c12;
      border:1px solid var(--line);
      border-radius:14px;
      padding:14px 14px;
      overflow:auto;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
    }

    header{
      position:relative;
      padding: clamp(18px, 3.5vw, 34px) clamp(16px, 4vw, 40px);
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(17,19,26,.85), rgba(17,19,26,.60));
      backdrop-filter: blur(8px);
    }
    header .top{
      display:grid;
      grid-template-columns: 1.4fr 1fr;
      gap:18px;
      align-items:end;
      max-width: 1200px;
      margin:0 auto;
    }
    @media (max-width: 920px){
      header .top{ grid-template-columns:1fr; align-items:start; }
    }

    h1{
      margin:0 0 6px 0;
      font-size: clamp(22px, 3vw, 36px);
      letter-spacing:-.02em;
      line-height:1.15;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      max-width: 70ch;
      font-size: clamp(14px, 1.5vw, 16px);
    }
    .meta{
      justify-self:end;
      text-align:right;
      color:var(--faint);
      font-size: 13px;
    }
    @media (max-width: 920px){
      .meta{ justify-self:start; text-align:left; }
    }

    main{
      max-width: 1200px;
      margin:0 auto;
      padding: 18px clamp(16px, 4vw, 40px) 56px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
      align-items:start;
    }
    @media (max-width: 980px){
      main{ grid-template-columns:1fr; }
    }

    nav#toc{
      position: sticky;
      top: 12px;
      align-self:start;
      background: linear-gradient(180deg, rgba(17,19,26,.85), rgba(17,19,26,.65));
      border:1px solid var(--line);
      border-radius: var(--radius2);
      padding: 14px 14px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    nav#toc::before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(700px 250px at 30% 0%, rgba(125,211,252,.09), transparent 55%),
                  radial-gradient(650px 220px at 70% 10%, rgba(167,139,250,.08), transparent 55%);
      pointer-events:none;
      opacity:.9;
    }
    nav#toc > *{ position:relative; }
    .toc-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    .toc-title h2{
      font-size: 14px;
      margin:0;
      letter-spacing:.08em;
      text-transform:uppercase;
      color: var(--muted);
    }
    .toc-mini{
      font-size:12px;
      color:var(--faint);
    }
    #toc a{
      display:block;
      padding:8px 10px;
      border-radius:12px;
      color: var(--text);
      border:1px solid transparent;
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
    }
    #toc a:hover{
      background: rgba(255,255,255,.04);
      border-color: rgba(125,211,252,.22);
      transform: translateX(1px);
      text-decoration:none;
    }
    #toc a.active{
      background: rgba(125,211,252,.10);
      border-color: rgba(125,211,252,.30);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
    }

    article{
      min-width:0;
    }

    section{
      background: linear-gradient(180deg, rgba(17,19,26,.80), rgba(15,17,23,.78));
      border:1px solid var(--line);
      border-radius: var(--radius2);
      padding: 16px 16px;
      margin-bottom: 16px;
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    section::before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(800px 260px at 12% 0%, rgba(125,211,252,.06), transparent 60%),
                  radial-gradient(700px 250px at 88% 10%, rgba(167,139,250,.06), transparent 60%);
      pointer-events:none;
      opacity:.85;
    }
    section > *{ position:relative; }

    h2{
      margin:0 0 10px 0;
      font-size: clamp(18px, 2.2vw, 24px);
      letter-spacing:-.01em;
    }
    h3{
      margin: 14px 0 8px;
      font-size: 16px;
      color: var(--text);
    }
    p{ margin: 10px 0; color: var(--text); }
    ul,ol{ margin: 10px 0 10px 20px; color: var(--text); }
    li{ margin: 6px 0; }
    .muted{ color:var(--muted); }
    .faint{ color:var(--faint); }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      align-items:start;
    }
    @media (max-width: 820px){
      .grid2{ grid-template-columns:1fr; }
    }

    .callout{
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 12px 12px;
      background: rgba(0,0,0,.18);
    }
    .callout strong{ color: var(--text); }
    .callout.assumptions{ border-color: rgba(251,191,36,.35); background: rgba(251,191,36,.06); }
    .callout.keyeq{ border-color: rgba(125,211,252,.35); background: rgba(125,211,252,.06); }
    .callout.mistakes{ border-color: rgba(251,113,133,.30); background: rgba(251,113,133,.06); }
    .callout.answer{ border-color: rgba(52,211,153,.35); background: rgba(52,211,153,.06); }

    .eqwrap{
      margin: 10px 0;
      border:1px solid var(--line);
      border-radius: 14px;
      overflow:hidden;
      background: rgba(10,12,18,.70);
    }
    .eqbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 10px 10px;
      border-bottom:1px solid var(--line);
      background: rgba(255,255,255,.03);
    }
    .eqtitle{
      font-size: 12px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color: var(--muted);
    }
    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      color: var(--text);
      border-radius: 12px;
      padding: 8px 10px;
      font-size: 12px;
      cursor:pointer;
      transition: transform .16s ease, background .16s ease, border-color .16s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.06);
      border-color: rgba(125,211,252,.25);
    }
    .btn:active{
      transform: translateY(0);
    }
    .eq{
      padding: 12px 12px;
      font-family: var(--mono);
      font-size: 13px;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    details{
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 10px 12px;
      background: rgba(0,0,0,.15);
      margin: 10px 0;
    }
    details > summary{
      cursor:pointer;
      color: var(--muted);
      font-weight: 600;
      outline:none;
    }
    details[open] > summary{
      color: var(--text);
    }

    figure{
      margin: 12px 0 0;
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(0,0,0,.18);
      overflow:hidden;
    }
    figure figcaption{
      padding: 10px 12px;
      border-top:1px solid var(--line);
      color: var(--muted);
      font-size: 13px;
    }
    .canvas-wrap{
      padding: 12px 12px 8px;
    }
    canvas{
      width:100%;
      height: 340px;
      display:block;
      border-radius: 14px;
      background: rgba(10,12,18,.65);
      border:1px solid rgba(255,255,255,.06);
    }

    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top: 12px;
      font-size: 13px;
      color: var(--muted);
    }
    .backtop:hover{ color: var(--text); text-decoration:none; }

    footer{
      max-width: 1200px;
      margin: 0 auto 40px;
      padding: 0 clamp(16px, 4vw, 40px);
      color: var(--faint);
      font-size: 13px;
    }

    /* Micro animation */
    @keyframes glow{
      0%,100%{ box-shadow: 0 0 0 rgba(125,211,252,0); }
      50%{ box-shadow: 0 0 18px rgba(125,211,252,.14); }
    }
    .pulse{
      animation: glow 3.6s ease-in-out infinite;
    }

    /* Print-friendly */
    @media print{
      body{ background:#fff; color:#000; }
      header, nav#toc{ display:none !important; }
      main{ display:block; padding:0; }
      section{
        background:#fff !important;
        color:#000 !important;
        border:1px solid #bbb;
        box-shadow:none;
        break-inside: avoid;
        page-break-inside: avoid;
      }
      a{ color:#000; text-decoration:underline; }
      .btn{ display:none !important; }
      canvas{ border:1px solid #bbb; background:#fff; }
      .eqwrap{ background:#fff; }
      .eq{ color:#000; }
      .callout{ background:#fff; }
    }
  </style>
</head>
<body>
  <header id="top">
    <div class="top">
      <div>
        <h1>Kohn Anomaly from Oscillatory Interplanar Force Constants</h1>
        <p class="subtitle">
          A mathematically explicit derivation of how long-ranged, oscillatory force constants in metals produce a
          non-analytic feature (a “kink” / vertical tangent) in the phonon dispersion at a special wavevector <span class="muted">K = k<sub>0</sub></span>.
        </p>
      </div>
      <div class="meta">
        <div><span class="muted">Topic:</span> Lattice dynamics · dispersion relations · Fourier series</div>
        <div><span class="muted">Lens:</span> applied physics + industrial engineering relevance</div>
        <div class="faint">All symbols defined inside; final results are symbolic.</div>
      </div>
    </div>
  </header>

  <main>
    <nav id="toc" aria-label="Table of contents" class="pulse">
      <div class="toc-title">
        <h2>Contents</h2>
        <div class="toc-mini"><span id="tocState">sticky</span></div>
      </div>
      <a href="#qs">Quick Summary</a>
      <a href="#p0">PART 0 — Concept Primer</a>
      <a href="#p0b">PART 0B — Industry & Applied Physics Perspective</a>
      <a href="#p1">PART 1 — Problem Analysis</a>
      <a href="#p2">PART 2 — Strategy & Tips</a>
      <a href="#p3">PART 3 — Full Solution</a>
      <a href="#p4">PART 4 — Deeper Understanding</a>
      <a href="#p5">PART 5 — Optional Plot Guide</a>
      <a href="#final">Copyable Final Answer</a>
    </nav>

    <article>
      <section id="qs">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this problem is about:</strong> deriving the phonon dispersion <span class="muted">ω(K)</span> when interplanar force constants decay as <span class="muted">1/p</span> and oscillate as <span class="muted">sin(pk<sub>0</sub>a)</span> (a metal-like “Kohn” form).</li>
          <li><strong>Key physics idea:</strong> oscillatory long-range coupling implies a <em>non-analytic</em> dependence of <span class="muted">ω</span> on wavevector—an anomaly at <span class="muted">K = k<sub>0</sub></span>.</li>
          <li><strong>Mathematical core:</strong> a discrete translation-invariant equation of motion reduced via a lattice Fourier mode <span class="muted">u<sub>s</sub>(t)=u e^{i(sKa-ωt)}</span>.</li>
          <li><strong>Governing dispersion relation:</strong> <span class="muted">ω²(K) = (2/M) ∑<sub>p</sub> C<sub>p</sub> (1 − cos(pKa))</span> (Eq. 16a form for a monatomic 1D chain / plane stack).</li>
          <li><strong>Series tool:</strong> the Fourier series identity <span class="muted">∑<sub>p≥1</sub> sin(px)/p = (π−x)/2</span> for <span class="muted">0&lt;x&lt;2π</span> (with periodic extension).</li>
          <li><strong>Result type:</strong> symbolic, piecewise (Heaviside-step–like) in the first Brillouin zone; it exhibits a <strong>kink/vertical tangent</strong> at <span class="muted">K=k<sub>0</sub></span>.</li>
          <li><strong>What “vertical tangent / kink” means:</strong> <span class="muted">dω²/dK</span> contains a distributional spike (Dirac delta) at <span class="muted">K=k<sub>0</sub></span> → “infinite slope” idealization of the Kohn anomaly.</li>
        </ul>

        <div class="callout keyeq">
          <strong>One-line takeaway:</strong> the given <span class="muted">C<sub>p</sub>∝sin(pk<sub>0</sub>a)/p</span> makes the lattice sum non-analytic at <span class="muted">K=k<sub>0</sub></span>, producing an idealized kink (vertical tangent) in <span class="muted">ω(K)</span>.
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="p0">
        <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

        <h3>0.1 Core definitions (symbols + SI units)</h3>
        <ul>
          <li><strong>a</strong> — plane spacing / lattice constant (m).</li>
          <li><strong>s</strong> — integer plane index (dimensionless), plane position <span class="muted">x = s a</span>.</li>
          <li><strong>p</strong> — integer separation between planes (<span class="muted">p∈ℤ</span>), plane pair <span class="muted">(s, s+p)</span>.</li>
          <li><strong>u<sub>s</sub>(t)</strong> — longitudinal displacement of plane <span class="muted">s</span> (m).</li>
          <li><strong>M</strong> — mass per plane (or per primitive cell in 1D model) (kg).</li>
          <li><strong>C<sub>p</sub></strong> — interplanar force constant between planes separated by <span class="muted">p a</span> (N/m).</li>
          <li><strong>K</strong> — phonon wavevector (rad/m). Often we use the dimensionless <span class="muted">β = Ka</span> (rad).</li>
          <li><strong>ω</strong> — angular frequency (rad/s).</li>
          <li><strong>k<sub>0</sub></strong> — special wavevector set by electronic structure (rad/m); often tied to <span class="muted">2k<sub>F</sub></span> in metals.</li>
          <li><strong>A</strong> — constant controlling coupling strength (units chosen so that <span class="muted">C<sub>p</sub></span> has N/m).</li>
        </ul>

        <h3>0.2 Physical meaning (intuition)</h3>
        <p>
          In a simple nearest-neighbor chain, forces are short-ranged and <span class="muted">ω(K)</span> is smooth.
          Metals are different: conduction electrons screen ionic motion, producing <em>oscillatory</em> effective interactions
          (Friedel-like oscillations). That oscillation can imprint a sharp feature in the phonon dispersion near a wavevector
          determined by electron scattering across the Fermi surface. That sharp feature is called a <strong>Kohn anomaly</strong>.
        </p>

        <h3>0.3 Mathematical model: discrete dynamics + Fourier modes</h3>
        <div class="callout keyeq">
          <strong>Discrete equation of motion (translation-invariant):</strong><br/>
          For small displacements (harmonic approximation), each plane feels linear restoring forces from all other planes.
          The discrete operator is a convolution in plane index, so Fourier modes diagonalize it.
        </div>

        <p class="muted">
          Operator notation note: this is a <strong>discrete</strong> analog of a PDE. Instead of the Laplacian <span class="muted">∇²</span>,
          the restoring force involves a <em>difference-convolution operator</em> acting on the sequence <span class="muted">{u<sub>s</sub>}</span>.
        </p>

        <h3>0.4 Validity conditions (assumptions/regime)</h3>
        <ul>
          <li><strong>Harmonic (linear) regime:</strong> potential energy expanded to second order in displacements → superposition holds.</li>
          <li><strong>Perfect periodicity:</strong> <span class="muted">C<sub>p</sub></span> depends only on separation <span class="muted">p</span>, not on <span class="muted">s</span>.</li>
          <li><strong>Infinite or very long chain:</strong> allows plane waves and Fourier series identities.</li>
          <li><strong>Longitudinal polarization:</strong> scalar displacement along the stacking direction.</li>
        </ul>

        <h3>0.5 Common approximations used in this topic</h3>
        <ul>
          <li><strong>Born–von Kármán periodic boundary conditions:</strong> treat the chain as periodic with large N to justify discrete Fourier transform.</li>
          <li><strong>Series regularization / distribution viewpoint:</strong> non-smooth results (kinks) often require interpreting derivatives in a generalized sense (Dirac delta spikes).</li>
        </ul>

        <h3>0.6 Mini intuition examples (minimal algebra)</h3>
        <ol>
          <li><strong>Nearest neighbor only:</strong> <span class="muted">ω² ∝ (1 − cos Ka)</span> → smooth sinusoidal dispersion.</li>
          <li><strong>Long-range but monotone:</strong> still typically smooth, just altered curvature and sound speed.</li>
          <li><strong>Long-range oscillatory (metal-like):</strong> sums of many oscillatory terms can cancel for some <span class="muted">K</span> and add for others, producing sharp features.</li>
        </ol>

        <h3>0.7 What to watch for (pitfalls)</h3>
        <ul>
          <li>Forces must satisfy <strong>translational invariance</strong>: uniform displacement should not produce a restoring force → ensures <span class="muted">ω(0)=0</span> for an acoustic branch (unless a gap is intentionally present).</li>
          <li>Fourier series identities are <strong>piecewise</strong> and have <strong>jumps</strong> → derivatives can be “infinite” at jump points.</li>
          <li>Be careful with summation over <span class="muted">p∈ℤ</span> vs <span class="muted">p≥1</span> and symmetry.</li>
        </ul>

        <div class="callout assumptions">
          <strong>Assumptions used later (explicit):</strong>
          <ul>
            <li>We work in the first Brillouin zone (1D): <span class="muted">K ∈ [−π/a, π/a]</span>.</li>
            <li>We take <span class="muted">0 &lt; k<sub>0</sub> &lt; π/a</span> so the anomaly lies inside the zone.</li>
            <li>We use the standard identity for <span class="muted">∑ sin(px)/p</span> valid for <span class="muted">0&lt;x&lt;2π</span> and extend periodically.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="p0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <h3>Why engineers and industry care</h3>
        <div class="grid2">
          <div class="callout">
            <strong>Applications where Kohn anomalies matter</strong>
            <ul>
              <li><strong>Thermal management</strong> in electronics: phonon dispersions shape thermal conductivity (heat spreading, hotspots).</li>
              <li><strong>Superconducting & cryogenic materials</strong>: electron–phonon coupling (often tied to anomalies) influences critical temperatures and stability.</li>
              <li><strong>Vibration & acoustic behavior</strong> of metallic microstructures: dispersion affects wave propagation, damping, and resonance in MEMS/precision devices.</li>
              <li><strong>Metallurgy & alloy design</strong>: anomalies can correlate with lattice instabilities and phase transitions.</li>
            </ul>
          </div>
          <div class="callout">
            <strong>Engineering trade-offs / constraints</strong>
            <ul>
              <li><strong>Performance vs. stability:</strong> strong electron–phonon coupling can enhance superconductivity but may promote soft modes and instabilities.</li>
              <li><strong>Manufacturability:</strong> defects, grain boundaries, and finite size smear sharp dispersion features.</li>
              <li><strong>Temperature dependence:</strong> thermal broadening of the Fermi surface weakens/shifts anomalies (important for reliability over operating ranges).</li>
              <li><strong>Model fidelity:</strong> idealized 1D sums predict “infinite slopes,” but real devices show rounded kinks due to damping and disorder.</li>
            </ul>
          </div>
        </div>

        <h3>Typical measurement / validation methods</h3>
        <ul>
          <li><strong>Inelastic neutron scattering</strong> and <strong>inelastic X-ray scattering</strong>: direct measurement of <span class="muted">ω(K)</span>.</li>
          <li><strong>Raman / Brillouin spectroscopy</strong>: probes zone-center or near-zone-center phonons; indirect constraints on dispersion curvature.</li>
          <li><strong>DFT/DFPT (density-functional perturbation theory)</strong>: predictive computation of phonon dispersions and electron–phonon coupling.</li>
        </ul>

        <h3>From lab to product (idealized → real)</h3>
        <p class="muted">
          The ideal 1D model captures the <em>mechanism</em> (non-analyticity from electron-mediated oscillatory forces).
          In real materials and industrial components, finite temperature, finite lifetime (damping), microstructure,
          and multi-branch phonon spectra smear the mathematical singularity into a measurable but finite “kink.”
          Engineers treat that smearing as a <strong>design margin</strong> problem: how sensitive is performance to changes in dispersion near the anomaly?
        </p>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="p1">
        <h2>PART 1 — Problem Analysis (No solving yet)</h2>

        <h3>1.1 Restating the problem in plain words</h3>
        <p>
          You are given interplanar force constants between plane <span class="muted">s</span> and plane <span class="muted">s+p</span>:
        </p>
        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Given force constants</div>
            <button class="btn copy-eq" data-copy="C_p = A * sin(p*k0*a) / (p*a),   p ∈ ℤ (p ≠ 0)">Copy</button>
          </div>
          <div class="eq">C_p = A * sin(p k0 a) / (p a),   where A and k0 are constants, and p runs over all integers.</div>
        </div>
        <p>
          Using the standard lattice-dynamics relation (Eq. 16a), you must:
        </p>
        <ul>
          <li>Find an expression for <span class="muted">ω²(K)</span>.</li>
          <li>Find <span class="muted">dω²/dK</span>.</li>
          <li>Prove that <span class="muted">dω²/dK</span> is infinite at <span class="muted">K = k<sub>0</sub></span>.</li>
          <li>Explain why this implies a <strong>kink / vertical tangent</strong> in <span class="muted">ω(K)</span>.</li>
        </ul>

        <h3>1.2 Given quantities</h3>
        <ul>
          <li><span class="muted">C<sub>p</sub> = A sin(p k<sub>0</sub> a)/(p a)</span></li>
          <li><span class="muted">A, k<sub>0</sub>, a</span> are constants</li>
          <li>Eq. (16a) (standard monatomic plane-wave dispersion sum)</li>
        </ul>

        <h3>1.3 Unknowns / targets</h3>
        <ul>
          <li><span class="muted">ω²(K)</span> in closed or piecewise form</li>
          <li><span class="muted">dω²/dK</span> and its behavior near <span class="muted">K=k<sub>0</sub></span></li>
        </ul>

        <h3>1.4 Relevant principles and why they apply</h3>
        <ul>
          <li><strong>Linearity (harmonic approximation):</strong> allows eigenmodes of the discrete operator; the system becomes an eigenvalue problem for <span class="muted">ω²</span>.</li>
          <li><strong>Discrete translational symmetry:</strong> makes the interaction a convolution in index <span class="muted">s</span> → diagonalized by discrete Fourier transform.</li>
          <li><strong>Fourier series mathematics:</strong> the specific <span class="muted">1/p</span> form implies sums that produce sawtooth / step behavior.</li>
        </ul>

        <div class="callout assumptions">
          <strong>Assumptions (stated explicitly here)</strong>
          <ul>
            <li>Infinite (or periodic) chain of planes so plane waves are valid eigenfunctions.</li>
            <li>We analyze <span class="muted">K</span> in the first Brillouin zone and take <span class="muted">0&lt;k<sub>0</sub>&lt;π/a</span>.</li>
            <li>We interpret “infinite derivative” in the mathematically correct sense: a jump in <span class="muted">ω²(K)</span> creates a Dirac delta in its derivative (distribution).</li>
          </ul>
        </div>

        <h3>1.5 Approaches (2–3) and comparison</h3>
        <ol>
          <li>
            <strong>Direct lattice sum + known Fourier series identities</strong> (best here):
            evaluate the sum analytically using <span class="muted">∑ sin(px)/p</span>.
            <span class="muted">Pros:</span> exact, transparent. <span class="muted">Cons:</span> requires careful piecewise handling.
          </li>
          <li>
            <strong>Complex analysis / polylogarithms</strong>:
            rewrite sums as imaginary parts of <span class="muted">−ln(1−e^{ix})</span>.
            <span class="muted">Pros:</span> elegant. <span class="muted">Cons:</span> can obscure physical meaning.
          </li>
          <li>
            <strong>Distribution / Fourier-transform viewpoint</strong>:
            interpret <span class="muted">C_p</span> as Fourier coefficients of a discontinuous function in <span class="muted">K</span>.
            <span class="muted">Pros:</span> directly explains the “infinite slope.” <span class="muted">Cons:</span> more abstract.
          </li>
        </ol>

        <h3>1.6 Chosen approach</h3>
        <p>
          We will use <strong>Approach 1</strong> (direct summation + Fourier identities), and then briefly connect the result to the
          <strong>distribution viewpoint</strong> to justify precisely what “infinite derivative” means.
        </p>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="p2">
        <h2>PART 2 — Strategy & Tips (Roadmap only)</h2>

        <ol>
          <li><strong>Write the discrete equation of motion</strong> for plane displacements using force constants <span class="muted">C_p</span>. (Goal: define the mathematical model.)</li>
          <li><strong>Insert a plane-wave ansatz</strong> <span class="muted">u_s(t)=u e^{i(sKa-ωt)}</span>. (Tool: separability/eigenmodes from translation invariance.)</li>
          <li><strong>Derive Eq. (16a)-type dispersion sum</strong> for <span class="muted">ω²(K)</span>. (Meaning: eigenvalue of a discrete convolution operator.)</li>
          <li><strong>Use symmetry</strong> of the given <span class="muted">C_p</span> to reduce <span class="muted">∑_{p∈ℤ}</span> to <span class="muted">2∑_{p≥1}</span>. (Validity: parity under <span class="muted">p→−p</span>.)</li>
          <li><strong>Evaluate the key series</strong> using <span class="muted">∑ sin(px)/p</span> and its periodic, piecewise form. (Goal: closed expression for <span class="muted">ω²(K)</span>.)</li>
          <li><strong>Differentiate carefully</strong>, noting the piecewise discontinuity. (Goal: show <span class="muted">dω²/dK</span> has an “infinite” spike at <span class="muted">K=k0</span>.)</li>
          <li><strong>Interpret physically</strong>: a discontinuity (or kink) in the dispersion corresponds to enhanced electron screening response at that wavevector (Kohn anomaly).</li>
          <li><strong>Sanity checks</strong>: units, <span class="muted">K→0</span> behavior, symmetry in the Brillouin zone.</li>
        </ol>

        <div class="callout mistakes">
          <strong>Common mistakes</strong>
          <ul>
            <li>Using <span class="muted">∑ sin(px)/p=(π−x)/2</span> without stating the domain and periodic extension (piecewise!).</li>
            <li>Forgetting that “infinite derivative” arises at the jump points of the Fourier series (distributional derivative).</li>
            <li>Mixing <span class="muted">K</span> (rad/m) with <span class="muted">Ka</span> (dimensionless radians) in derivatives.</li>
            <li>Dropping the factor of 2 when converting <span class="muted">p∈ℤ</span> to <span class="muted">p≥1</span>.</li>
          </ul>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="p3">
        <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

        <h3>3.1 Qualitative expectation (before calculating)</h3>
        <p>
          Because <span class="muted">C_p</span> decays only as <span class="muted">1/p</span>, the interaction is long-range.
          The oscillatory factor <span class="muted">sin(pk0a)</span> suggests constructive/destructive interference in the dispersion sum.
          Non-smooth (non-analytic) behavior at a special wavevector is therefore plausible.
          We will see that the model produces an <em>idealized</em> sharp anomaly at <span class="muted">K=k0</span>.
        </p>

        <h3>3.2 Mathematical model (variables, domain, boundary conditions)</h3>
        <p>
          Consider an infinite 1D stack of identical planes indexed by <span class="muted">s∈ℤ</span>, located at <span class="muted">x=sa</span>.
          Let <span class="muted">u_s(t)</span> be the (small) longitudinal displacement of plane <span class="muted">s</span>.
          The harmonic (linear) dynamics is:
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Discrete equation of motion</div>
            <button class="btn copy-eq" data-copy="M * d^2u_s/dt^2 = Σ_{p≠0} C_p * (u_{s+p} - u_s)">Copy</button>
          </div>
          <div class="eq">M * d^2u_s/dt^2 = Σ_{p≠0} C_p * (u_{s+p} - u_s)</div>
        </div>

        <p class="muted">
          Why this form is valid: linearity from the harmonic approximation implies force is proportional to displacement differences;
          translation invariance means coefficients depend only on separation <span class="muted">p</span>.
          This is the discrete analog of a linear PDE of the form <span class="muted">ρ u_tt = L u</span>,
          where <span class="muted">L</span> is a self-adjoint spatial operator (here, a discrete convolution-difference operator).
        </p>

        <p>
          <strong>Domain and boundary conditions:</strong> take an infinite chain (or periodic Born–von Kármán conditions on a large N-cell ring).
          This legitimizes Fourier modes:
          <span class="muted">u_s(t) = u e^{i(sKa - ωt)}</span> with <span class="muted">K</span> restricted to the first Brillouin zone <span class="muted">[−π/a, π/a]</span>.
        </p>

        <h3>3.3 Deriving the dispersion relation (Eq. 16a form)</h3>
        <p>
          Insert the plane-wave ansatz
          <span class="muted">u_{s+p}(t)=u e^{i((s+p)Ka-ωt)} = u_s(t) e^{ipKa}</span>.
          Then:
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Mode substitution step</div>
            <button class="btn copy-eq" data-copy="u_{s+p} - u_s = u_s (e^{ipKa} - 1)">Copy</button>
          </div>
          <div class="eq">u_{s+p} - u_s = u_s (e^{ipKa} - 1)</div>
        </div>

        <p>
          Plugging into the equation of motion and canceling the nonzero factor <span class="muted">u_s(t)</span>:
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Eigenvalue equation for ω²(K)</div>
            <button class="btn copy-eq" data-copy="−M ω^2 = Σ_{p≠0} C_p (e^{ipKa} − 1)">Copy</button>
          </div>
          <div class="eq">−M ω^2 = Σ_{p≠0} C_p (e^{ipKa} − 1)</div>
        </div>

        <p>
          Since physical force constants satisfy <span class="muted">C_{−p}=C_p</span> (same separation, same stiffness) and the dispersion must be real,
          we take the real part. Using <span class="muted">e^{ipKa}+e^{−ipKa}=2cos(pKa)</span> and combining ±p terms gives the standard real form:
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Eq. (16a) style dispersion sum</div>
            <button class="btn copy-eq" data-copy="ω^2(K) = (2/M) Σ_{p=1}^{∞} C_p [1 − cos(pKa)]  (equivalently (2/M) Σ_{p∈ℤ} C_p [1 − cos(pKa)] with p≠0)">Copy</button>
          </div>
          <div class="eq">ω^2(K) = (2/M) Σ_{p=1}^{∞} C_p [1 − cos(pKa)]
(Equivalently: ω^2(K) = (2/M) Σ_{p≠0} C_p [1 − cos(pKa)], since terms are even in p.)</div>
        </div>

        <p class="muted">
          Why each step is valid: (i) linearity allows superposition and mode decomposition;
          (ii) translation symmetry makes Fourier modes eigenfunctions of the discrete convolution operator;
          (iii) pairing ±p uses symmetry and enforces reality.
        </p>

        <h3>3.4 Substitute the given Kohn-form force constants</h3>
        <p>
          The problem gives (for all nonzero integers <span class="muted">p</span>):
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Given C_p</div>
            <button class="btn copy-eq" data-copy="C_p = A * sin(p k0 a) / (p a)">Copy</button>
          </div>
          <div class="eq">C_p = A * sin(p k0 a) / (p a)</div>
        </div>

        <p>
          Because <span class="muted">sin(−p k0 a)/(−p) = sin(p k0 a)/p</span>, we have <span class="muted">C_{−p}=C_p</span> (even),
          consistent with the derivation.
        </p>

        <p>
          Define dimensionless angles:
          <span class="muted">α = k0 a</span> and <span class="muted">β = K a</span>.
          Then:
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">ω² as a dimensionless series</div>
            <button class="btn copy-eq" data-copy="ω^2(K) = (2A/(M a)) * 2 Σ_{p=1}^{∞} [sin(pα)/p] * [1 − cos(pβ)]">Copy</button>
          </div>
          <div class="eq">ω^2(K) = (2/M) Σ_{p≠0} C_p [1 − cos(pβ)]
       = (2/M) Σ_{p≠0} (A/(a)) [sin(pα)/p] [1 − cos(pβ)]
       = (4A/(M a)) Σ_{p=1}^{∞} [sin(pα)/p] [1 − cos(pβ)]</div>
        </div>

        <h3>3.5 Evaluate the series using Fourier-series identities (no magic jumps)</h3>
        <p>
          Let
          <span class="muted">S(α,β) = Σ_{p=1}^{∞} (sin(pα)/p) (1 − cos(pβ))</span>.
          Then <span class="muted">ω²(K) = (4A/(Ma)) S(α,β)</span>.
        </p>

        <p>
          Split the sum:
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Series split</div>
            <button class="btn copy-eq" data-copy="S(α,β) = Σ sin(pα)/p  −  Σ [sin(pα) cos(pβ)]/p">Copy</button>
          </div>
          <div class="eq">S(α,β) = Σ_{p=1}^{∞} sin(pα)/p  −  Σ_{p=1}^{∞} [sin(pα) cos(pβ)]/p</div>
        </div>

        <p>
          Use the product-to-sum identity:
          <span class="muted">sin(pα)cos(pβ) = (1/2)[sin(p(α+β)) + sin(p(α−β))]</span>.
          Therefore:
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Reduce to the master sine series</div>
            <button class="btn copy-eq" data-copy="Σ [sin(pα)cos(pβ)]/p = (1/2)Σ sin(p(α+β))/p + (1/2)Σ sin(p(α−β))/p">Copy</button>
          </div>
          <div class="eq">Σ_{p=1}^{∞} [sin(pα)cos(pβ)]/p
= (1/2) Σ_{p=1}^{∞} sin(p(α+β))/p
+ (1/2) Σ_{p=1}^{∞} sin(p(α−β))/p</div>
        </div>

        <p>
          Now use the classic Fourier series (for <span class="muted">0 &lt; x &lt; 2π</span>):
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Key Fourier identity (piecewise!)</div>
            <button class="btn copy-eq" data-copy="F(x) = Σ_{p=1}^{∞} sin(px)/p = (π − x)/2  for 0<x<2π, extended periodically with period 2π">Copy</button>
          </div>
          <div class="eq">F(x) = Σ_{p=1}^{∞} sin(px)/p = (π − x)/2   for 0 &lt; x &lt; 2π
and F is extended periodically with period 2π (hence it has jump discontinuities).</div>
        </div>

        <p>
          With this definition <span class="muted">F</span>, we have:
        </p>
        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">S expressed via F</div>
            <button class="btn copy-eq" data-copy="S(α,β) = F(α) − (1/2)F(α+β) − (1/2)F(α−β)">Copy</button>
          </div>
          <div class="eq">S(α,β) = F(α) − (1/2)F(α+β) − (1/2)F(α−β)</div>
        </div>

        <p>
          <strong>Piecewise evaluation inside the first Brillouin zone.</strong>
          Take <span class="muted">0&lt;α&lt;π</span> (i.e., <span class="muted">0&lt;k0&lt;π/a</span>) and <span class="muted">0≤β≤π</span>.
          Then <span class="muted">α+β∈(0,2π)</span> always, but <span class="muted">α−β</span> changes sign at <span class="muted">β=α</span>.
        </p>

        <details>
          <summary>Optional deep note: why periodic extension matters</summary>
          <p class="muted">
            The formula <span class="muted">F(x)=(π−x)/2</span> is valid on <span class="muted">(0,2π)</span>.
            For negative <span class="muted">x</span>, one must use periodicity:
            <span class="muted">F(x)=F(x+2π)</span>.
            This is exactly where non-smoothness enters: at multiples of <span class="muted">2π</span>, <span class="muted">F</span> has jumps.
          </p>
        </details>

        <h4 class="muted" style="margin:10px 0 6px;">Case A: 0 ≤ β &lt; α  (i.e., 0 ≤ K &lt; k0)</h4>
        <p>
          Here <span class="muted">α−β&gt;0</span>, so all arguments are in <span class="muted">(0,2π)</span>.
          Use <span class="muted">F(x)=(π−x)/2</span> directly:
        </p>

        <pre>F(α)     = (π − α)/2
F(α+β)   = (π − (α+β))/2 = (π − α − β)/2
F(α−β)   = (π − (α−β))/2 = (π − α + β)/2</pre>

        <p>
          Substitute into <span class="muted">S = F(α) − (1/2)F(α+β) − (1/2)F(α−β)</span>:
        </p>

        <pre>S = (π−α)/2 − 1/2 * (π−α−β)/2 − 1/2 * (π−α+β)/2
  = (π−α)/2 − 1/4[(π−α−β) + (π−α+β)]
  = (π−α)/2 − 1/4[2π − 2α]
  = (π−α)/2 − (π−α)/2
  = 0</pre>

        <p class="muted">
          So, in this idealized model, <span class="muted">ω²(K)=0</span> for <span class="muted">0≤K&lt;k0</span>.
          (This is an extreme “sharp-screening” model; real materials smooth this behavior, but the non-analyticity at <span class="muted">K=k0</span> is the key point.)
        </p>

        <h4 class="muted" style="margin:10px 0 6px;">Case B: α &lt; β ≤ π  (i.e., k0 &lt; K ≤ π/a)</h4>
        <p>
          Now <span class="muted">α−β&lt;0</span>. Use periodicity: <span class="muted">F(α−β)=F(α−β+2π)</span>, where
          <span class="muted">α−β+2π ∈ (0,2π)</span>. Hence:
        </p>

        <pre>F(α−β) = (π − (α−β+2π))/2
       = (π − α + β − 2π)/2
       = (−π − α + β)/2</pre>

        <p>
          Also, as before:
        </p>
        <pre>F(α)   = (π − α)/2
F(α+β) = (π − α − β)/2</pre>

        <p>Substitute:</p>

        <pre>S = (π−α)/2 − 1/2*(π−α−β)/2 − 1/2*(−π−α+β)/2
  = (π−α)/2 − 1/4(π−α−β) + 1/4(π+α−β)
  = (π−α)/2 + 1/4[(π+α−β) − (π−α−β)]
  = (π−α)/2 + 1/4(2α)
  = (π−α)/2 + α/2
  = π/2</pre>

        <p>
          Therefore, for <span class="muted">K&gt;k0</span> in the first zone,
          <span class="muted">S = π/2</span>, giving a constant positive value for <span class="muted">ω²</span>.
        </p>

        <h3>3.6 Final expression for ω²(K) (piecewise, first Brillouin zone)</h3>

        <div class="callout answer">
          <strong>Result (0 ≤ K ≤ π/a, with 0&lt;k0&lt;π/a):</strong>
          <div class="eqwrap" style="margin-top:10px;">
            <div class="eqbar">
              <div class="eqtitle">Final ω²(K) in the first zone (idealized Kohn form)</div>
              <button class="btn copy-eq" data-copy="ω^2(K) = (4A/(M a)) * S, where S = 0 for 0≤K<k0, and S = π/2 for k0<K≤π/a. Hence: ω^2(K)=0 (K<k0), ω^2(K)=2πA/(M a) (K>k0).">Copy</button>
            </div>
            <div class="eq">ω^2(K) = (4A/(M a)) S(α,β),  α=k0 a, β=K a,

S(α,β) = 0              for 0 ≤ β < α   (i.e., 0 ≤ K < k0)
S(α,β) = π/2            for α < β ≤ π   (i.e., k0 < K ≤ π/a)

⇒ ω^2(K) = 0                         (0 ≤ K < k0)
⇒ ω^2(K) = (4A/(M a))*(π/2) = 2πA/(M a)   (k0 < K ≤ π/a)</div>
          </div>
        </div>

        <p class="muted">
          Symmetry extension: because <span class="muted">cos(pKa)</span> is even in <span class="muted">K</span>, the dispersion is even:
          <span class="muted">ω²(−K)=ω²(K)</span>.
          Thus the same jump occurs at <span class="muted">K=±k0</span> within <span class="muted">[−π/a,π/a]</span>.
        </p>

        <h3>3.7 Compute dω²/dK and show it is “infinite” at K = k0</h3>
        <p>
          For <span class="muted">K≠k0</span>, the piecewise result above is constant on each side, so the classical derivative is:
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Classical derivative away from the anomaly</div>
            <button class="btn copy-eq" data-copy="For K≠k0: dω^2/dK = 0 (since ω^2 is constant on each interval).">Copy</button>
          </div>
          <div class="eq">For K ≠ k0:  dω^2/dK = 0  (ω^2 is constant for K<k0 and for K>k0)</div>
        </div>

        <p>
          However, at <span class="muted">K=k0</span>, <span class="muted">ω²(K)</span> has a <strong>jump discontinuity</strong> of height
          <span class="muted">Δ = 2πA/(Ma)</span>. The mathematically correct statement is that the derivative is a <strong>distribution</strong>.
          Introduce the Heaviside step function <span class="muted">H(x)</span> (0 for x&lt;0, 1 for x&gt;0). Then, on <span class="muted">[0,π/a]</span>:
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Heaviside representation</div>
            <button class="btn copy-eq" data-copy="ω^2(K) = (2πA/(M a)) * H(K − k0)  (in 0≤K≤π/a idealization)">Copy</button>
          </div>
          <div class="eq">ω^2(K) = (2πA/(M a)) * H(K − k0)   (idealized, 0 ≤ K ≤ π/a)</div>
        </div>

        <p>
          Differentiate in the distribution sense, using <span class="muted">dH/dK = δ(K−k0)</span> (Dirac delta):
        </p>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Distributional derivative (the “infinite slope”)</div>
            <button class="btn copy-eq" data-copy="dω^2/dK = (2πA/(M a)) * δ(K − k0)">Copy</button>
          </div>
          <div class="eq">dω^2/dK = (2πA/(M a)) * δ(K − k0)</div>
        </div>

        <p class="muted">
          Interpretation: a delta function is “infinite at a point” but integrates to a finite jump.
          That is exactly what the problem means by <span class="muted">dω²/dK</span> being infinite at <span class="muted">K=k0</span>.
        </p>

        <h3>3.8 Why this implies a kink / vertical tangent in ω(K)</h3>
        <p>
          Since <span class="muted">ω(K) = √(ω²(K))</span>, any non-analyticity in <span class="muted">ω²</span> produces a non-smooth feature in <span class="muted">ω</span>.
          In this idealized model, <span class="muted">ω²</span> jumps, so <span class="muted">ω</span> also jumps (from 0 to a finite value).
          More physically realistic Kohn anomalies in higher-dimensional metals produce a <em>kink</em> (continuous <span class="muted">ω</span> but discontinuous slope).
          Mathematically, both are manifestations of the same mechanism: a non-analytic dependence on <span class="muted">K</span> generated by long-range oscillatory interactions.
        </p>

        <div class="callout keyeq">
          <strong>Math Insight (core equation as a mathematical object):</strong>
          <p class="muted" style="margin:8px 0 0;">
            The dispersion relation is an <em>eigenvalue</em> of a translation-invariant discrete operator (a convolution-difference operator).
            Fourier modes diagonalize it, and the eigenvalue is the Fourier transform of the kernel <span class="muted">C_p</span>.
            Because <span class="muted">C_p ~ 1/p</span>, its Fourier transform is not smooth: it is (piecewise) linear/sawtooth-like, hence the non-analyticity (kink/jump).
          </p>
        </div>

        <h3>3.9 Sanity checks</h3>
        <div class="grid2">
          <div class="callout">
            <strong>Units / dimensions</strong>
            <ul>
              <li><span class="muted">C_p</span> has units N/m.</li>
              <li><span class="muted">(2/M) C_p</span> has units (N/m)/kg = s<sup>−2</sup>.</li>
              <li>The sum is dimensionless → <span class="muted">ω²</span> has units s<sup>−2</sup>, correct.</li>
            </ul>
          </div>
          <div class="callout">
            <strong>Limiting and symmetry checks</strong>
            <ul>
              <li><span class="muted">ω²(−K)=ω²(K)</span> (even), because only <span class="muted">cos(pKa)</span> appears.</li>
              <li>At <span class="muted">K→0</span>, this idealized model yields <span class="muted">ω²=0</span> (acoustic-like), consistent with translation invariance.</li>
              <li>Non-smoothness at <span class="muted">K=k0</span> matches the expected “anomaly wavevector” concept.</li>
            </ul>
          </div>
        </div>

        <h3>3.10 One simple static plot (normalized) to visualize the anomaly</h3>
        <p class="muted">
          The plot below shows an <strong>example</strong> normalized dispersion <span class="muted">ω²/ω²<sub>0</sub></span> versus <span class="muted">Ka</span>,
          with <span class="muted">ω²<sub>0</sub>=2πA/(Ma)</span>, and an example <span class="muted">k0 a = 0.6π</span>.
          This is only to visualize the step/kink; the final result remains symbolic.
        </p>

        <figure>
          <div class="canvas-wrap">
            <canvas id="plot" aria-label="Normalized omega squared vs Ka"></canvas>
          </div>
          <figcaption>
            <strong>Figure:</strong> Example normalized <span class="muted">ω²/ω²₀</span> vs <span class="muted">Ka</span> (first zone).
            The vertical feature at <span class="muted">Ka = k0 a</span> represents the idealized Kohn anomaly (non-analyticity).
          </figcaption>
        </figure>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="p4">
        <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

        <h3>4.1 Re-interpreting the final formula</h3>
        <p>
          The dispersion eigenvalue is essentially the lattice Fourier transform of the kernel <span class="muted">C_p</span>.
          A <span class="muted">1/p</span> decay corresponds to a <strong>logarithm</strong> or <strong>sawtooth/step</strong>-type behavior in Fourier space,
          meaning you should expect non-smoothness in <span class="muted">K</span>.
        </p>

        <h3>4.2 Parameter dependence (qualitative)</h3>
        <ul>
          <li><strong>A</strong> sets the <em>scale</em> of the anomaly: <span class="muted">ω² ∝ A</span>.</li>
          <li><strong>M</strong> sets inertial scale: heavier planes → smaller <span class="muted">ω²</span> (inversely proportional).</li>
          <li><strong>a</strong> rescales wavevectors via <span class="muted">Ka</span> and <span class="muted">k0a</span> and appears in the prefactor <span class="muted">1/a</span>.</li>
          <li><strong>k0</strong> chooses the anomaly location <span class="muted">K=k0</span>.</li>
        </ul>

        <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
        <details>
          <summary>Alternative: complex-log method (polylog / ln)</summary>
          <p class="muted">
            Use <span class="muted">Σ_{p≥1} e^{ipx}/p = −ln(1−e^{ix})</span>.
            Taking imaginary parts gives <span class="muted">Σ sin(px)/p</span> as the argument of <span class="muted">1−e^{ix}</span>,
            which is piecewise linear in <span class="muted">x</span> with jumps at multiples of <span class="muted">2π</span>.
            Those branch cut jumps are the mathematical origin of the “infinite derivative.”
          </p>
        </details>

        <h3>4.4 Concept checks (self-test with answers)</h3>
        <ul>
          <li><strong>Q:</strong> Why do plane waves diagonalize the problem?<br/>
              <strong>A:</strong> Because the force operator is translation-invariant (a discrete convolution), whose eigenfunctions are complex exponentials.</li>
          <li><strong>Q:</strong> Where does non-analyticity enter mathematically?<br/>
              <strong>A:</strong> From the piecewise/periodic Fourier series for <span class="muted">Σ sin(px)/p</span>, which has jump discontinuities.</li>
          <li><strong>Q:</strong> What does “infinite derivative” mean rigorously?<br/>
              <strong>A:</strong> The derivative is a Dirac delta in the distribution sense at the jump point.</li>
          <li><strong>Q:</strong> Why is <span class="muted">ω²(K)</span> even in <span class="muted">K</span>?<br/>
              <strong>A:</strong> The dispersion depends on <span class="muted">cos(pKa)</span>, which is even in <span class="muted">K</span>.</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="p5">
        <h2>PART 5 — Optional Plot Guide</h2>

        <h3>What the plot shows and why it’s useful</h3>
        <ul>
          <li><strong>Y-axis:</strong> normalized <span class="muted">ω²/ω²₀</span>, where <span class="muted">ω²₀ = 2πA/(Ma)</span> (dimensionless).</li>
          <li><strong>X-axis:</strong> <span class="muted">Ka</span> from 0 to <span class="muted">π</span> (dimensionless radians).</li>
          <li><strong>Example value:</strong> <span class="muted">k0 a = 0.6π</span> (chosen only to visualize the location of the anomaly).</li>
          <li><strong>Feature to notice:</strong> the sharp vertical feature at <span class="muted">Ka=k0a</span>, representing the idealized Kohn anomaly. In real materials this becomes a rounded kink.</li>
        </ul>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>

      <section id="final">
        <h2>Copyable Final Answer</h2>

        <div class="eqwrap">
          <div class="eqbar">
            <div class="eqtitle">Final answer (plain text)</div>
            <button class="btn copy-eq" data-copy="Model: M ü_s = Σ_{p≠0} C_p (u_{s+p} − u_s), with C_p = A sin(p k0 a)/(p a). Plane-wave u_s=u e^{i(sKa−ωt)} gives ω^2(K) = (2/M) Σ_{p≠0} C_p [1 − cos(pKa)] = (4A/(M a)) Σ_{p=1}^∞ (sin(pα)/p)(1 − cos(pβ)), α=k0 a, β=K a. Using F(x)=Σ_{p=1}^∞ sin(px)/p=(π−x)/2 for 0<x<2π with 2π-periodic extension: S(α,β)=F(α)−½F(α+β)−½F(α−β). For 0<α<π and 0≤β≤π: S=0 for β<α and S=π/2 for β>α. Hence (0≤K≤π/a): ω^2(K)=0 for 0≤K<k0, and ω^2(K)=2πA/(M a) for k0<K≤π/a (even in K, so also a feature at K=−k0). Therefore ω^2(K)=(2πA/(M a)) H(K−k0) (idealized), so dω^2/dK=(2πA/(M a)) δ(K−k0), i.e., the derivative is infinite at K=k0. This non-analyticity produces a sharp anomaly (kink/vertical-tangent idealization) in the phonon dispersion ω(K).">Copy</button>
          </div>
          <div class="eq" id="finalText">Model: M ü_s = Σ_{p≠0} C_p (u_{s+p} − u_s), with C_p = A sin(p k0 a)/(p a).
Plane-wave u_s=u e^{i(sKa−ωt)} gives
ω^2(K) = (2/M) Σ_{p≠0} C_p [1 − cos(pKa)]
      = (4A/(M a)) Σ_{p=1}^∞ (sin(pα)/p)(1 − cos(pβ)), α=k0 a, β=K a.

Using F(x)=Σ_{p=1}^∞ sin(px)/p=(π−x)/2 for 0<x<2π with 2π-periodic extension:
S(α,β)=F(α)−½F(α+β)−½F(α−β).

For 0<α<π and 0≤β≤π:
S=0 for β<α and S=π/2 for β>α.

Hence (0≤K≤π/a):
ω^2(K)=0 for 0≤K<k0,
ω^2(K)=2πA/(M a) for k0<K≤π/a,
(and ω^2 is even in K, so the same feature occurs at K=−k0).

Therefore ω^2(K)=(2πA/(M a)) H(K−k0) (idealized),
so dω^2/dK=(2πA/(M a)) δ(K−k0), i.e. dω^2/dK is infinite at K=k0.
This non-analyticity is the (idealized) Kohn anomaly: a kink/vertical-tangent feature in ω(K).</div>
        </div>

        <a class="backtop" href="#top">↑ Back to top</a>
      </section>
    </article>
  </main>

  <footer>
    <p>
      <strong>Note:</strong> This exercise uses an idealized long-range kernel that produces a mathematically sharp non-analyticity.
      In real 3D metals, finite temperature, damping, and realistic electron response smooth the singularity into a measurable kink
      (a classic Kohn anomaly).
    </p>
  </footer>

  <script>
    // ---------- Copy buttons ----------
    function copyText(text){
      if (!navigator.clipboard) {
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        try { document.execCommand('copy'); } catch(e){}
        document.body.removeChild(ta);
        return;
      }
      navigator.clipboard.writeText(text);
    }

    document.querySelectorAll('.copy-eq').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const txt = btn.getAttribute('data-copy') || '';
        copyText(txt);
        const old = btn.textContent;
        btn.textContent = 'Copied!';
        setTimeout(()=>btn.textContent=old, 900);
      });
    });

    // ---------- TOC active highlighting ----------
    const tocLinks = Array.from(document.querySelectorAll('#toc a'));
    const sections = tocLinks.map(a => document.querySelector(a.getAttribute('href'))).filter(Boolean);

    const io = new IntersectionObserver((entries)=>{
      // pick most visible intersecting section
      const visible = entries
        .filter(e => e.isIntersecting)
        .sort((a,b)=> (b.intersectionRatio - a.intersectionRatio))[0];
      if (!visible) return;
      const id = '#' + visible.target.id;
      tocLinks.forEach(a => a.classList.toggle('active', a.getAttribute('href') === id));
    }, { rootMargin: '-20% 0px -65% 0px', threshold: [0.02, 0.08, 0.18, 0.30] });

    sections.forEach(sec => io.observe(sec));

    // ---------- One static plot (canvas), high-DPI crisp ----------
    const canvas = document.getElementById('plot');
    const ctx = canvas.getContext('2d');

    function draw(){
      const dpr = window.devicePixelRatio || 1;
      const rect = canvas.getBoundingClientRect();
      const W = Math.max(320, Math.floor(rect.width));
      const H = Math.max(240, Math.floor(rect.height));

      canvas.width = Math.floor(W * dpr);
      canvas.height = Math.floor(H * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);

      // Layout
      const padL = 58, padR = 16, padT = 28, padB = 46;
      const pw = W - padL - padR;
      const ph = H - padT - padB;

      // Axes ranges: x in [0, π], y in [0, 1.15]
      const xmin = 0, xmax = Math.PI;
      const ymin = 0, ymax = 1.15;

      function x2px(x){ return padL + (x - xmin) * pw / (xmax - xmin); }
      function y2px(y){ return padT + ph - (y - ymin) * ph / (ymax - ymin); }

      // Background
      ctx.clearRect(0,0,W,H);

      // Title
      ctx.fillStyle = 'rgba(232,236,242,.92)';
      ctx.font = '600 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';
      ctx.fillText('Example: normalized ω²/ω²₀ vs Ka (step-like Kohn anomaly)', padL, 18);

      // Gridlines
      ctx.lineWidth = 1;
      ctx.strokeStyle = 'rgba(255,255,255,.08)';
      const xticks = 6;
      for(let i=0;i<=xticks;i++){
        const x = xmin + i*(xmax-xmin)/xticks;
        const X = x2px(x);
        ctx.beginPath();
        ctx.moveTo(X, padT);
        ctx.lineTo(X, padT+ph);
        ctx.stroke();
      }
      const yticks = 5;
      for(let j=0;j<=yticks;j++){
        const y = ymin + j*(ymax-ymin)/yticks;
        const Y = y2px(y);
        ctx.beginPath();
        ctx.moveTo(padL, Y);
        ctx.lineTo(padL+pw, Y);
        ctx.stroke();
      }

      // Axes
      ctx.strokeStyle = 'rgba(255,255,255,.22)';
      ctx.lineWidth = 1.25;
      ctx.beginPath();
      ctx.moveTo(padL, padT);
      ctx.lineTo(padL, padT+ph);
      ctx.lineTo(padL+pw, padT+ph);
      ctx.stroke();

      // Tick labels
      ctx.fillStyle = 'rgba(169,178,195,.92)';
      ctx.font = '12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace';

      // x labels at 0, π/2, π
      const xMarks = [
        {x:0, label:'0'},
        {x:Math.PI/2, label:'π/2'},
        {x:Math.PI, label:'π'}
      ];
      xMarks.forEach(m=>{
        const X = x2px(m.x);
        const Y = padT+ph;
        ctx.beginPath();
        ctx.moveTo(X, Y);
        ctx.lineTo(X, Y+6);
        ctx.strokeStyle = 'rgba(255,255,255,.22)';
        ctx.stroke();
        ctx.fillText(m.label, X-8, Y+22);
      });

      // y labels 0, 0.5, 1.0
      const yMarks = [
        {y:0, label:'0'},
        {y:0.5, label:'0.5'},
        {y:1.0, label:'1.0'}
      ];
      yMarks.forEach(m=>{
        const X = padL;
        const Y = y2px(m.y);
        ctx.beginPath();
        ctx.moveTo(X-6, Y);
        ctx.lineTo(X, Y);
        ctx.strokeStyle = 'rgba(255,255,255,.22)';
        ctx.stroke();
        ctx.fillText(m.label, X-38, Y+4);
      });

      // Axis labels
      ctx.fillStyle = 'rgba(169,178,195,.95)';
      ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';
      ctx.fillText('Ka (rad)', padL + pw/2 - 22, padT + ph + 38);
      ctx.save();
      ctx.translate(18, padT + ph/2 + 28);
      ctx.rotate(-Math.PI/2);
      ctx.fillText('ω²/ω²₀ (dimensionless)', 0, 0);
      ctx.restore();

      // Data: step at k0a = 0.6π (example)
      const k0a = 0.6 * Math.PI;

      // Draw step function
      ctx.lineWidth = 2.2;
      ctx.strokeStyle = 'rgba(125,211,252,.9)';
      ctx.beginPath();
      // 0 up to k0a at y=0
      ctx.moveTo(x2px(0), y2px(0));
      ctx.lineTo(x2px(k0a), y2px(0));
      // jump
      ctx.lineTo(x2px(k0a), y2px(1.0));
      // constant to π
      ctx.lineTo(x2px(Math.PI), y2px(1.0));
      ctx.stroke();

      // Marker line at k0a
      ctx.lineWidth = 1.4;
      ctx.strokeStyle = 'rgba(251,191,36,.75)';
      ctx.setLineDash([6,6]);
      ctx.beginPath();
      ctx.moveTo(x2px(k0a), padT);
      ctx.lineTo(x2px(k0a), padT+ph);
      ctx.stroke();
      ctx.setLineDash([]);

      // Legend
      const lx = padL + 10, ly = padT + 10;
      ctx.fillStyle = 'rgba(0,0,0,.35)';
      ctx.strokeStyle = 'rgba(255,255,255,.12)';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.roundRect(lx, ly, 235, 56, 10);
      ctx.fill();
      ctx.stroke();

      ctx.font = '12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial';
      ctx.fillStyle = 'rgba(232,236,242,.92)';
      ctx.fillText('Example: k0 a = 0.6π', lx+12, ly+20);

      // line swatch
      ctx.strokeStyle = 'rgba(125,211,252,.9)';
      ctx.lineWidth = 2.2;
      ctx.beginPath();
      ctx.moveTo(lx+12, ly+38);
      ctx.lineTo(lx+52, ly+38);
      ctx.stroke();
      ctx.fillStyle = 'rgba(232,236,242,.88)';
      ctx.fillText('ω²/ω²₀', lx+62, ly+42);
    }

    // Polyfill: roundRect for older browsers
    if (!CanvasRenderingContext2D.prototype.roundRect) {
      CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
        r = Math.min(r, w/2, h/2);
        this.beginPath();
        this.moveTo(x + r, y);
        this.arcTo(x + w, y, x + w, y + h, r);
        this.arcTo(x + w, y + h, x, y + h, r);
        this.arcTo(x, y + h, x, y, r);
        this.arcTo(x, y, x + w, y, r);
        this.closePath();
        return this;
      };
    }

    window.addEventListener('resize', draw, {passive:true});
    draw();
  </script>
</body>
</html>
