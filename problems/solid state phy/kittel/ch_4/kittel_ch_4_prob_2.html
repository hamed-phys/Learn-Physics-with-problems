<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="color-scheme" content="light dark"/>
  <meta name="theme-color" content="#0b1020"/>
  <title>Continuum Wave Equation from a Discrete Chain (Long-Wavelength Limit)</title>
  <style>
    :root{
      --bg: #0b1020;
      --panel:#0f1733;
      --card:#101a3d;
      --text:#e8ecff;
      --muted:#b6c0ff;
      --faint:#93a0ff;
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line: rgba(255,255,255,.12);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8ff;
        --panel:#ffffff;
        --card:#ffffff;
        --text:#12162a;
        --muted:#334155;
        --faint:#475569;
        --accent:#0284c7;
        --accent2:#6d28d9;
        --line: rgba(2,6,23,.12);
        --shadow: 0 10px 30px rgba(2,6,23,.10);
      }
    }

    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family: var(--sans);
      background: radial-gradient(1200px 800px at 20% -10%, rgba(110,231,255,.18), transparent 55%),
                  radial-gradient(1000px 800px at 110% 10%, rgba(167,139,250,.18), transparent 55%),
                  var(--bg);
      color: var(--text);
      line-height: 1.55;
    }

    header{
      padding: 34px 16px 18px;
      border-bottom: 1px solid var(--line);
      position: relative;
      overflow: hidden;
    }

    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 0 14px;
    }

    .hero{
      display:grid;
      grid-template-columns: 1.45fr .85fr;
      gap: 16px;
      align-items: start;
    }

    @media (max-width: 980px){
      .hero{ grid-template-columns: 1fr; }
    }

    h1{
      margin: 0 0 8px;
      font-size: clamp(1.55rem, 1.2rem + 1.6vw, 2.5rem);
      letter-spacing: .2px;
    }
    .subtitle{
      margin: 0 0 16px;
      color: var(--muted);
      font-size: 1.02rem;
    }

    .metaCard{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 14px 14px 12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      animation: floatIn .6s ease-out both;
    }
    @keyframes floatIn{
      from{ transform: translateY(10px); opacity: 0; }
      to{ transform: translateY(0); opacity: 1; }
    }
    .metaCard strong{ color: var(--text); }
    .chips{
      display:flex; flex-wrap: wrap; gap: 8px;
      margin-top: 10px;
    }
    .chip{
      font-size: .86rem;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      white-space: nowrap;
    }

    main{
      padding: 18px 16px 70px;
    }

    .layout{
      display:grid;
      grid-template-columns: 320px 1fr;
      gap: 16px;
      align-items: start;
    }
    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; }
    }

    nav.toc{
      position: sticky;
      top: 12px;
      align-self: start;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 12px;
      max-height: calc(100vh - 24px);
      overflow: auto;
    }
    nav.toc h2{
      margin: 0 0 10px;
      font-size: 1.02rem;
      letter-spacing: .2px;
    }
    nav.toc a{
      display:block;
      padding: 7px 10px;
      border-radius: 12px;
      text-decoration:none;
      color: var(--muted);
      border: 1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size: .95rem;
    }
    nav.toc a:hover{
      background: rgba(110,231,255,.10);
      border-color: rgba(110,231,255,.22);
      color: var(--text);
      transform: translateX(2px);
    }

    section, article{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      margin-bottom: 14px;
      overflow: hidden;
    }

    h2{
      margin: 0 0 10px;
      font-size: clamp(1.15rem, 1.05rem + .6vw, 1.55rem);
    }
    h3{
      margin: 18px 0 8px;
      font-size: 1.05rem;
      color: var(--text);
    }
    p{ margin: 10px 0; color: var(--muted); }
    ul{ margin: 10px 0 0; color: var(--muted); }
    li{ margin: 7px 0; }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 820px){
      .grid2{ grid-template-columns: 1fr; }
    }

    .callout{
      border-radius: 16px;
      padding: 12px 12px 10px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
    }
    .callout .tag{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      font-weight: 700;
      font-size: .9rem;
      color: var(--text);
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      margin-bottom: 8px;
    }
    .tag i{
      width: 10px; height:10px; border-radius: 99px; display:inline-block;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(110,231,255,.18);
    }
    .callout.warn .tag i{ background: var(--warn); box-shadow: 0 0 0 3px rgba(251,191,36,.18); }
    .callout.good .tag i{ background: var(--good); box-shadow: 0 0 0 3px rgba(52,211,153,.18); }
    .callout.bad .tag i{ background: var(--bad); box-shadow: 0 0 0 3px rgba(251,113,133,.18); }
    .callout .content{ color: var(--muted); }

    .eq{
      font-family: var(--mono);
      color: var(--text);
      background: rgba(0,0,0,.22);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px 12px;
      overflow-x: auto;
      position: relative;
      white-space: pre-wrap;
    }
    @media (prefers-color-scheme: light){
      .eq{ background: rgba(2,6,23,.05); }
    }

    .btnRow{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    button.copy{
      appearance:none;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding: 9px 11px;
      border-radius: 14px;
      cursor:pointer;
      font-weight: 650;
      font-size: .92rem;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    button.copy:hover{
      transform: translateY(-1px);
      background: rgba(110,231,255,.10);
      border-color: rgba(110,231,255,.22);
    }
    .toast{
      position: fixed;
      bottom: 16px;
      right: 16px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(15,23,51,.90);
      box-shadow: var(--shadow);
      color: var(--text);
      opacity: 0;
      transform: translateY(10px);
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      font-weight: 650;
      z-index: 9999;
    }
    .toast.show{
      opacity: 1;
      transform: translateY(0);
    }

    details{
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 10px 12px;
      background: rgba(255,255,255,.03);
      margin: 10px 0;
    }
    summary{
      cursor:pointer;
      font-weight: 750;
      color: var(--text);
      list-style: none;
    }
    summary::-webkit-details-marker{ display:none; }
    summary:after{
      content:"▾";
      float:right;
      color: var(--faint);
      transition: transform .15s ease;
    }
    details[open] summary:after{ transform: rotate(180deg); }

    .backTop{
      display:inline-block;
      margin-top: 10px;
      text-decoration:none;
      color: var(--accent);
      font-weight: 700;
      border-bottom: 1px dashed rgba(110,231,255,.5);
      padding-bottom: 2px;
    }

    figure{
      margin: 12px 0 0;
      padding: 12px;
      border-radius: 16px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.03);
    }
    figcaption{
      margin-top: 8px;
      color: var(--muted);
      font-size: .92rem;
    }
    canvas{
      width: 100%;
      height: 320px;
      display:block;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(0,0,0,.18);
    }
    @media (prefers-color-scheme: light){
      canvas{ background: rgba(2,6,23,.04); }
    }

    footer{
      border-top: 1px solid var(--line);
      padding: 22px 16px;
      color: var(--muted);
    }

    @media print{
      :root{ --shadow: none; }
      nav.toc{ display:none; }
      body{ background: #fff; color:#000; }
      section, article, header .metaCard{
        box-shadow:none;
        border: 1px solid #ccc;
        background:#fff;
      }
      .eq{ background:#f6f6f6; border-color:#ccc; color:#000; }
      button.copy{ display:none; }
      a{ color:#000; text-decoration:none; }
      header{ page-break-after: avoid; }
      section, article{ break-inside: avoid; page-break-inside: avoid; }
      figure{ break-inside: avoid; }
      .backTop{ display:none; }
    }
  </style>
</head>

<body>
  <div id="top"></div>

  <header>
    <div class="wrap hero">
      <div>
        <h1>Continuum Wave Equation from a Discrete Chain (Long-Wavelength Limit)</h1>
        <p class="subtitle">
          How a <span style="color:var(--accent);font-weight:800;">discrete</span> equation of motion becomes the
          familiar <span style="color:var(--accent2);font-weight:800;">continuum</span> elastic wave PDE when the
          wavelength is much larger than the lattice spacing.
        </p>
      </div>

      <aside class="metaCard">
        <div style="color:var(--muted);font-size:.95rem;">
          <strong>Goal:</strong> show that the discrete chain equation reduces to
          <span style="font-family:var(--mono);color:var(--text);">∂²u/∂t² = v² ∂²u/∂x²</span>
          for long wavelengths, and identify <strong>v</strong> (sound speed).
        </div>
        <div class="chips" aria-label="tags">
          <span class="chip">Mathematical physics (PDE limit)</span>
          <span class="chip">Dispersion relation</span>
          <span class="chip">Asymptotics: ka ≪ 1</span>
          <span class="chip">Industrial acoustics</span>
        </div>
      </aside>
    </div>
  </header>

  <main>
    <div class="wrap layout">
      <nav class="toc" aria-label="Table of contents">
        <h2>Table of Contents</h2>
        <a href="#quick">Quick Summary</a>
        <a href="#part0">PART 0 — Concept Primer</a>
        <a href="#part0b">PART 0B — Industry & Applied Physics Perspective</a>
        <a href="#part1">PART 1 — Problem Analysis</a>
        <a href="#part2">PART 2 — Strategy & Tips</a>
        <a href="#part3">PART 3 — Full Solution</a>
        <a href="#part4">PART 4 — Deeper Understanding</a>
        <a href="#part5">PART 5 — Optional Plot Guide</a>
      </nav>

      <div>
        <section id="quick">
          <h2>Quick Summary</h2>
          <ul>
            <li><strong>What this problem is about:</strong> taking the <em>discrete</em> equation of motion for a 1D mass–spring chain and deriving the <em>continuum</em> wave equation in the long-wavelength limit.</li>
            <li><strong>Key physics idea:</strong> for wavelengths λ much larger than the lattice spacing a, the displacement varies slowly from atom to atom, so finite differences become derivatives.</li>
            <li><strong>Mathematical tool:</strong> Taylor expansion (asymptotic expansion) of <span style="font-family:var(--mono)">u(x±a,t)</span> about <span style="font-family:var(--mono)">x</span>.</li>
            <li><strong>Governing discrete model (typical “Eq. (2)”):</strong> <span style="font-family:var(--mono)">m ü_n = K (u_{n+1} - 2u_n + u_{n-1})</span>.</li>
            <li><strong>Continuum PDE obtained:</strong> <span style="font-family:var(--mono)">∂²u/∂t² = v² ∂²u/∂x²</span> with <span style="font-family:var(--mono)">v = a √(K/m)</span>.</li>
            <li><strong>Long-wavelength condition:</strong> <span style="font-family:var(--mono)">ka ≪ 1</span> (equivalently <span style="font-family:var(--mono)">λ ≫ a</span>), where <span style="font-family:var(--mono)">k = 2π/λ</span>.</li>
            <li><strong>Dispersion viewpoint:</strong> discrete chain has <span style="font-family:var(--mono)">ω² = (4K/m) sin²(ka/2)</span>; for <span style="font-family:var(--mono)">ka≪1</span> it becomes <span style="font-family:var(--mono)">ω ≈ v k</span> (linear, nondispersive).</li>
            <li><strong>Result type:</strong> symbolic (sound speed expressed in terms of microscopic parameters), with a simple plot illustrating discrete vs continuum dispersion.</li>
          </ul>

          <div class="btnRow">
            <button class="copy" data-copy="eqKey">Copy key equations (plain text)</button>
            <button class="copy" data-copy="finalAns">Copy final answer (plain text)</button>
          </div>

          <div id="eqKey" class="eq" aria-label="Key equations">
m ü_n(t) = K [u_{n+1}(t) - 2u_n(t) + u_{n-1}(t)]
u(x±a,t) = u(x,t) ± a u_x + (a²/2) u_xx ± (a³/6) u_xxx + (a⁴/24) u_xxxx + …
⇒ u_{n+1} - 2u_n + u_{n-1} = a² u_xx + O(a⁴ u_xxxx)
⇒ u_tt = (K a² / m) u_xx  ≡ v² u_xx,  v = a √(K/m)
ω² = (4K/m) sin²(ka/2)  ≈ (K a² / m) k²  (for ka ≪ 1)
          </div>

          <div id="finalAns" class="eq" aria-label="Final answer">
For a 1D monatomic mass–spring chain with spacing a, mass m, spring constant K:
Long-wavelength (ka ≪ 1, i.e., λ ≫ a) ⇒ the discrete equation m ü_n = K(u_{n+1}-2u_n+u_{n-1})
reduces to the continuum wave equation u_tt = v² u_xx with sound speed v = a √(K/m).
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </section>

        <article id="part0">
          <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

          <div class="grid2">
            <div class="callout">
              <div class="tag"><i></i>Core definitions (symbols & SI units)</div>
              <div class="content">
                <ul>
                  <li><strong>n</strong> : integer lattice site index (dimensionless).</li>
                  <li><strong>a</strong> : lattice spacing (m).</li>
                  <li><strong>x</strong> : continuum coordinate, with mapping <span style="font-family:var(--mono)">x = n a</span> (m).</li>
                  <li><strong>u_n(t)</strong> : displacement of the nth mass from equilibrium (m).</li>
                  <li><strong>u(x,t)</strong> : continuum displacement field (m).</li>
                  <li><strong>m</strong> : mass per lattice site (kg).</li>
                  <li><strong>K</strong> : spring constant between nearest neighbors (N/m = kg/s²).</li>
                  <li><strong>v</strong> : wave/sound speed (m/s).</li>
                  <li><strong>k</strong> : wavenumber (rad/m), <span style="font-family:var(--mono)">k = 2π/λ</span>.</li>
                  <li><strong>ω</strong> : angular frequency (rad/s).</li>
                </ul>
              </div>
            </div>

            <div class="callout good">
              <div class="tag"><i></i>Physical meaning (intuition)</div>
              <div class="content">
                <ul>
                  <li>The term <span style="font-family:var(--mono)">u_{n+1} - 2u_n + u_{n-1}</span> is the <strong>discrete curvature</strong> (a second difference): it measures how “bent” the displacement profile is at site n.</li>
                  <li>Springs produce restoring forces proportional to relative extension; summing left/right spring forces yields a curvature-like term.</li>
                  <li>In the continuum, “curvature” becomes <span style="font-family:var(--mono)">∂²u/∂x²</span>, and Newton’s law becomes the wave PDE.</li>
                </ul>
              </div>
            </div>
          </div>

          <h3>Key law/principle and validity conditions</h3>
          <p>
            The discrete model comes from <strong>Newton’s 2nd law</strong> plus <strong>Hooke’s law</strong>, assuming:
            (i) small oscillations (linear springs), (ii) nearest-neighbor coupling only, (iii) identical masses and springs,
            and (iv) motion in one dimension. The continuum wave equation emerges when the displacement varies slowly across
            a spacing a: <strong>λ ≫ a</strong> (equivalently <strong>ka ≪ 1</strong>).
          </p>

          <div class="callout warn">
            <div class="tag"><i></i>Common models/approximations (and why)</div>
            <div class="content">
              <ul>
                <li><strong>Nearest-neighbor chain:</strong> simplest lattice capturing sound-like modes; leads to a clean dispersion relation.</li>
                <li><strong>Continuum approximation:</strong> replace finite differences by derivatives via Taylor expansion; valid when u changes little over a.</li>
                <li><strong>Long-wavelength asymptotics:</strong> treat <span style="font-family:var(--mono)">ε = ka</span> as a small parameter; keep leading-order terms.</li>
              </ul>
            </div>
          </div>

          <h3>Mini intuition examples (conceptual)</h3>
          <ul>
            <li>If the displacement is perfectly linear in x (a straight line), then curvature is zero: no net spring force → no acceleration. Both discrete second difference and continuum second derivative vanish.</li>
            <li>If the displacement profile is locally “concave up” (positive curvature), neighboring sites are higher than the center, pulling it upward → acceleration upward; sign matches <span style="font-family:var(--mono)">u_xx</span>.</li>
          </ul>

          <h3>What to watch for (pitfalls)</h3>
          <ul>
            <li><strong>Mixing up</strong> the small parameter: it is <span style="font-family:var(--mono)">ka</span>, not just k or a separately.</li>
            <li>Forgetting that <span style="font-family:var(--mono)">u_{n±1} = u(x±a,t)</span> must be Taylor-expanded about x.</li>
            <li>Dropping terms without stating order: you should explicitly say “neglect O(a⁴) terms” (or O((ka)⁴) in Fourier space).</li>
            <li>Units check: ensure <span style="font-family:var(--mono)">K a² / m</span> has units of (m/s)².</li>
          </ul>

          <a class="backTop" href="#top">Back to top ↑</a>
        </article>

        <article id="part0b">
          <h2>PART 0B — Industry & Applied Physics Perspective</h2>
          <p>
            The discrete-to-continuum step is not just a “math trick” — it’s how engineers justify using continuum
            acoustics/elasticity for real structures made of atoms, grains, or repeating microstructures.
          </p>

          <div class="grid2">
            <div class="callout">
              <div class="tag"><i></i>Where it appears (3+ concrete areas)</div>
              <div class="content">
                <ul>
                  <li><strong>Ultrasonics & NDT:</strong> predicting wave speeds and reflections in solids for crack detection.</li>
                  <li><strong>MEMS/NEMS resonators:</strong> lattice/beam microstructure modeled by PDEs when mode shapes vary slowly.</li>
                  <li><strong>Acoustic metamaterials & phononic crystals:</strong> knowing when continuum fails (short wavelengths) is crucial for bandgap design.</li>
                  <li><strong>Vibration of production equipment:</strong> machine frames modeled as continua; microstructure sets effective wave speeds/damping.</li>
                </ul>
              </div>
            </div>

            <div class="callout good">
              <div class="tag"><i></i>Why engineers care (performance, cost, safety)</div>
              <div class="content">
                <ul>
                  <li><strong>Performance:</strong> wave speed sets resonance frequencies and signal timing.</li>
                  <li><strong>Reliability:</strong> incorrect wave models can miss fatigue-driving vibration modes.</li>
                  <li><strong>Cost/efficiency:</strong> continuum PDEs are cheaper to simulate than atom-by-atom models.</li>
                  <li><strong>Manufacturability:</strong> microstructural variations (grain size, lattice spacing) influence when continuum assumptions hold.</li>
                </ul>
              </div>
            </div>
          </div>

          <h3>Measurement/validation methods (brief)</h3>
          <ul>
            <li><strong>Time-of-flight ultrasonics:</strong> measure v from travel time across a known distance.</li>
            <li><strong>Modal testing:</strong> extract wave speed from resonance frequencies and mode shapes.</li>
            <li><strong>Brillouin/Raman scattering (micro/nano):</strong> infer phonon dispersion at small scales.</li>
          </ul>

          <h3>Design trade-offs & constraints</h3>
          <ul>
            <li><strong>Continuum validity vs frequency:</strong> as frequency rises, λ decreases; eventually λ ~ a (or microstructural length) and continuum breaks down (dispersion becomes important).</li>
            <li><strong>Non-idealities:</strong> damping, defects, nonlinearity, and finite temperature add terms beyond the ideal wave equation.</li>
            <li><strong>Real boundary conditions:</strong> supports, joints, and interfaces cause reflections and mode conversion not captured by infinite-chain assumptions.</li>
          </ul>

          <details>
            <summary>From lab to product: how the ideal model is adapted</summary>
            <p>
              In practice, engineers often use a continuum PDE with <em>effective parameters</em> (effective density,
              effective modulus, effective damping) fitted from experiments or microstructure simulations. When λ becomes
              comparable to the microstructure, designers switch to dispersion-aware models (Bloch/Floquet analysis) or
              enriched continua (e.g., Cosserat, strain-gradient theories) to capture size effects.
            </p>
          </details>

          <a class="backTop" href="#top">Back to top ↑</a>
        </article>

        <article id="part1">
          <h2>PART 1 — Problem Analysis (no solving yet)</h2>

          <h3>Rewrite the problem (clear statement)</h3>
          <p>
            We are given a <strong>discrete equation of motion</strong> for a 1D chain (referred to as “equation (2)” in your source),
            and we must show that for <strong>long wavelengths</strong> it reduces to the <strong>continuum elastic wave equation</strong>
            <span style="font-family:var(--mono);color:var(--text);">∂²u/∂t² = v² ∂²u/∂x²</span>, where <strong>v</strong> is the sound speed.
          </p>

          <h3>Mathematical model (variables, domain, coordinates, IC/BC)</h3>
          <div class="callout">
            <div class="tag"><i></i>Model specification (mathematical physics)</div>
            <div class="content">
              <ul>
                <li><strong>Coordinate system:</strong> 1D line, discrete sites at <span style="font-family:var(--mono)">x_n = n a</span>.</li>
                <li><strong>Unknown field:</strong> discrete displacement <span style="font-family:var(--mono)">u_n(t)</span> (m).</li>
                <li><strong>Time domain:</strong> <span style="font-family:var(--mono)">t ≥ 0</span>.</li>
                <li><strong>Spatial domain options:</strong>
                  <ul>
                    <li>Infinite chain: <span style="font-family:var(--mono)">n ∈ ℤ</span> (no boundaries), or</li>
                    <li>Finite chain: <span style="font-family:var(--mono)">n = 1,…,N</span> with boundary conditions at ends.</li>
                  </ul>
                </li>
                <li><strong>Initial conditions (typical):</strong> <span style="font-family:var(--mono)">u_n(0) = f_n</span>, <span style="font-family:var(--mono)">u̇_n(0) = g_n</span>.</li>
                <li><strong>Continuum limit object:</strong> a smooth function <span style="font-family:var(--mono)">u(x,t)</span> defined for <span style="font-family:var(--mono)">x ∈ ℝ</span> (or an interval) such that <span style="font-family:var(--mono)">u(n a,t) ≈ u_n(t)</span>.</li>
              </ul>
            </div>
          </div>

          <h3>Given quantities</h3>
          <ul>
            <li>Implicitly: mass <strong>m</strong>, spring constant <strong>K</strong>, spacing <strong>a</strong> (standard mass–spring chain).</li>
            <li>Given target PDE: <span style="font-family:var(--mono)">u_tt = v² u_xx</span>.</li>
          </ul>

          <h3>Unknowns / What must be proved</h3>
          <ul>
            <li>Show the discrete equation reduces to the continuum wave equation when <strong>λ ≫ a</strong>.</li>
            <li>Identify <strong>v</strong> in terms of microscopic parameters (m, K, a).</li>
          </ul>

          <h3>Relevant principles/laws and why they apply</h3>
          <ul>
            <li><strong>Linearity:</strong> Hooke’s law (small oscillations) makes the equation linear, enabling Taylor expansion and superposition.</li>
            <li><strong>Translation symmetry:</strong> identical masses/springs implies the same equation at every n, allowing a uniform continuum limit.</li>
            <li><strong>Conservation form idea (brief):</strong> net force is difference of spring forces, analogous to divergence of stress in the continuum.</li>
          </ul>

          <div class="callout warn">
            <div class="tag"><i></i>Assumptions (explicit)</div>
            <div class="content">
              <ul>
                <li>Nearest-neighbor coupling only; no long-range forces.</li>
                <li>Small displacements (linear springs), so force ∝ extension.</li>
                <li>Long-wavelength/slow variation: <span style="font-family:var(--mono)">u(x,t)</span> is smooth on scale a and <span style="font-family:var(--mono)">ka ≪ 1</span>.</li>
                <li>We keep leading-order terms in a Taylor/asymptotic expansion and neglect higher-order corrections.</li>
              </ul>
            </div>
          </div>

          <h3>2–3 approaches (compare)</h3>
          <ul>
            <li><strong>(A) Taylor expansion in real space (best for PDE limit):</strong> Expand <span style="font-family:var(--mono)">u(x±a,t)</span> to convert second difference to <span style="font-family:var(--mono)">a² u_xx</span>. <em>Pros:</em> direct PDE derivation. <em>Cons:</em> needs smoothness assumption.</li>
            <li><strong>(B) Dispersion relation (Fourier/normal modes):</strong> Assume <span style="font-family:var(--mono)">u_n ∝ e^{i(kna-ωt)}</span>, derive ω(k), then expand for <span style="font-family:var(--mono)">ka≪1</span> to get ω≈vk. <em>Pros:</em> clean asymptotics; shows when dispersion matters. <em>Cons:</em> gives relation, then infer PDE.</li>
            <li><strong>(C) Conservation/stress analogy:</strong> write net force as discrete divergence of discrete stress, then pass to continuum. <em>Pros:</em> physically transparent. <em>Cons:</em> more setup.</li>
          </ul>

          <p>
            <strong>Choice:</strong> We will use <strong>(A)</strong> for the main proof (it directly produces the continuum wave equation),
            and we will use <strong>(B)</strong> as a rigorous cross-check that clarifies the “long wavelength” condition via <span style="font-family:var(--mono)">ka</span>.
          </p>

          <a class="backTop" href="#top">Back to top ↑</a>
        </article>

        <article id="part2">
          <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

          <ol style="color:var(--muted); margin-top:10px;">
            <li><strong>State the discrete equation</strong> (Newton + springs): identify the discrete second-difference operator.</li>
            <li><strong>Introduce the continuum field</strong> <span style="font-family:var(--mono)">u(x,t)</span> with <span style="font-family:var(--mono)">x = n a</span>.</li>
            <li><strong>Taylor expand</strong> <span style="font-family:var(--mono)">u(x±a,t)</span> about x to convert differences → derivatives.</li>
            <li><strong>Keep leading order</strong> in a (or in <span style="font-family:var(--mono)">ka</span>) and explicitly label neglected terms.</li>
            <li><strong>Divide by m</strong> to obtain a PDE of the form <span style="font-family:var(--mono)">u_tt = c² u_xx</span>.</li>
            <li><strong>Identify sound speed</strong> <span style="font-family:var(--mono)">v = √(K a² / m)</span>.</li>
            <li><strong>Sanity checks:</strong> units of v, and limiting-case interpretation (straight-line displacement gives zero acceleration).</li>
            <li><strong>Optional cross-check:</strong> derive dispersion ω(k) and expand for <span style="font-family:var(--mono)">ka≪1</span> to recover ω≈vk.</li>
          </ol>

          <div class="callout bad">
            <div class="tag"><i></i>Common mistakes</div>
            <div class="content">
              <ul>
                <li>Expanding only to first order: the second difference needs second derivatives (keep terms to O(a²) at least).</li>
                <li>Not stating the approximation: you must say “neglect O(a⁴)” (or higher) terms.</li>
                <li>Confusing phase velocity with group velocity in the discrete chain; in the long-wavelength limit both approach v.</li>
              </ul>
            </div>
          </div>

          <a class="backTop" href="#top">Back to top ↑</a>
        </article>

        <article id="part3">
          <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

          <h3>Physical intuition (before calculating)</h3>
          <p>
            If the displacement pattern changes very slowly from mass to mass (λ ≫ a), each mass “sees” almost the same
            displacement as its neighbors. Then the net spring force depends on how curved the displacement profile is,
            just like the continuum stress–strain picture. That suggests the acceleration should be proportional to the
            spatial curvature <span style="font-family:var(--mono)">u_xx</span>, which is exactly what the wave equation uses.
          </p>

          <h3>Step 1: Write the discrete equation of motion</h3>
          <p>
            Consider a 1D monatomic chain: identical masses m connected by identical springs K, spacing a.
            Let <span style="font-family:var(--mono)">u_n(t)</span> be the displacement of the nth mass from equilibrium.
          </p>

          <div class="callout">
            <div class="tag"><i></i>Key equation (discrete Newton + Hooke)</div>
            <div class="content">
              <div class="eq" id="eq_discrete">
m d²u_n/dt² = K[(u_{n+1}-u_n) - (u_n-u_{n-1})]
          = K(u_{n+1} - 2u_n + u_{n-1})
              </div>
              <p style="margin:10px 0 0;">
                Explanation: the right spring pulls with force <span style="font-family:var(--mono)">K(u_{n+1}-u_n)</span>,
                and the left spring pulls with force <span style="font-family:var(--mono)">-K(u_n-u_{n-1})</span>.
                Summing them gives the discrete second difference.
              </p>
            </div>
          </div>

          <h3>Step 2: Define the continuum field and the small parameter</h3>
          <p>
            Define a smooth function <span style="font-family:var(--mono)">u(x,t)</span> such that
            <span style="font-family:var(--mono)">u(n a,t) ≈ u_n(t)</span>. Here <span style="font-family:var(--mono)">x = n a</span>.
          </p>
          <p>
            The mathematical meaning of “long wavelength” is that typical spatial variation scale λ satisfies
            <span style="font-family:var(--mono)">λ ≫ a</span>.
            In Fourier terms, with wavenumber <span style="font-family:var(--mono)">k = 2π/λ</span>, this is:
          </p>
          <div class="eq" id="eq_smallparam">ε = k a ≪ 1</div>

          <details>
            <summary>Nondimensionalization / scaling (why ε=ka is the right small parameter)</summary>
            <p>
              Let U be a typical displacement amplitude and L a typical variation length (≈ λ). Then
              <span style="font-family:var(--mono)">u_x ~ U/L</span> and <span style="font-family:var(--mono)">u_xx ~ U/L²</span>.
              The second difference scales like:
              <span style="font-family:var(--mono)">u(x+a)-2u(x)+u(x-a) ~ a² (U/L²)</span>.
              So the ratio of neglected next term (∝ a⁴ u_xxxx ~ a⁴ U/L⁴) to the kept term (∝ a² U/L²) is
              <span style="font-family:var(--mono)">(a²/L²) ~ (a/λ)² ~ (ka)²</span>.
              Hence ε = ka controls the approximation.
            </p>
          </details>

          <h3>Step 3: Taylor-expand u(x±a,t) about x</h3>
          <p>
            Because u is assumed smooth on scale a, we can expand using Taylor’s theorem (in x, holding t fixed):
          </p>
          <div class="eq" id="eq_taylor">
u(x+a,t) = u(x,t) + a u_x(x,t) + (a²/2) u_xx(x,t) + (a³/6) u_xxx(x,t) + (a⁴/24) u_xxxx(x,t) + O(a⁵)
u(x-a,t) = u(x,t) - a u_x(x,t) + (a²/2) u_xx(x,t) - (a³/6) u_xxx(x,t) + (a⁴/24) u_xxxx(x,t) + O(a⁵)
          </div>

          <p>
            Here <span style="font-family:var(--mono)">u_x</span> means <span style="font-family:var(--mono)">∂u/∂x</span>,
            <span style="font-family:var(--mono)">u_xx</span> means <span style="font-family:var(--mono)">∂²u/∂x²</span>, etc.
            (Operator notation: in 1D, the Laplacian is <span style="font-family:var(--mono)">∇²u = ∂²u/∂x²</span>.)
          </p>

          <h3>Step 4: Convert the discrete second difference to a second derivative</h3>
          <p>
            Substitute the expansions into the discrete curvature:
            <span style="font-family:var(--mono)">u(x+a,t) - 2u(x,t) + u(x-a,t)</span>.
          </p>

          <div class="eq" id="eq_difference">
u(x+a) - 2u(x) + u(x-a)
= [u + a u_x + (a²/2)u_xx + (a³/6)u_xxx + (a⁴/24)u_xxxx + …]
  -2u
  +[u - a u_x + (a²/2)u_xx - (a³/6)u_xxx + (a⁴/24)u_xxxx + …]

= (a u_x - a u_x) + (a³/6 u_xxx - a³/6 u_xxx) + [(a²/2)+(a²/2)]u_xx + [(a⁴/24)+(a⁴/24)]u_xxxx + …
= a² u_xx + (a⁴/12) u_xxxx + O(a⁶)
          </div>

          <p>
            Notice how odd-derivative terms cancel by symmetry (because we add u(x+a) and u(x−a)).
            This cancellation is a key mathematical reason the leading term is <span style="font-family:var(--mono)">a² u_xx</span>.
          </p>

          <div class="callout warn">
            <div class="tag"><i></i>Approximation statement (what is neglected)</div>
            <div class="content">
              <p>
                In the long-wavelength regime, <span style="font-family:var(--mono)">ε = ka ≪ 1</span>, higher spatial derivatives are smaller.
                Keeping only the leading term means we neglect <span style="font-family:var(--mono)">O(a⁴ u_xxxx)</span>,
                which is smaller than <span style="font-family:var(--mono)">a² u_xx</span> by a factor ~ <span style="font-family:var(--mono)">(a/λ)² = (ka)²</span>.
              </p>
            </div>
          </div>

          <h3>Step 5: Substitute into the discrete equation and take the continuum limit</h3>
          <p>
            Replace <span style="font-family:var(--mono)">u_{n±1}(t)</span> by <span style="font-family:var(--mono)">u(x±a,t)</span>,
            and <span style="font-family:var(--mono)">u_n(t)</span> by <span style="font-family:var(--mono)">u(x,t)</span>.
            Then the discrete equation becomes:
          </p>

          <div class="eq" id="eq_substitute">
m u_tt(x,t) = K [u(x+a,t) - 2u(x,t) + u(x-a,t)]
          ≈ K [a² u_xx(x,t)]   (dropping O(a⁴ u_xxxx))
          </div>

          <p>
            Divide both sides by m:
          </p>

          <div class="eq" id="eq_pde">
u_tt(x,t) = (K a² / m) u_xx(x,t)
          </div>

          <p>
            This has the standard 1D wave-equation form:
          </p>

          <div class="callout good">
            <div class="tag"><i></i>Final result (boxed)</div>
            <div class="content">
              <div class="eq" id="eq_final">
∂²u/∂t² = v² ∂²u/∂x²,
v² = K a² / m,
v = a √(K/m)
              </div>
            </div>
          </div>

          <h3>Sanity checks</h3>
          <div class="grid2">
            <div class="callout">
              <div class="tag"><i></i>Units / dimensional analysis</div>
              <div class="content">
                <p>
                  <span style="font-family:var(--mono)">K</span> has units N/m = kg/s².
                  Then <span style="font-family:var(--mono)">K a² / m</span> has units
                  <span style="font-family:var(--mono)">(kg/s²)·m² / kg = m²/s²</span>.
                  So <span style="font-family:var(--mono)">v</span> has units m/s, as required.
                </p>
              </div>
            </div>
            <div class="callout">
              <div class="tag"><i></i>Limiting case / physical interpretation</div>
              <div class="content">
                <p>
                  If <span style="font-family:var(--mono)">u(x,t)</span> is linear in x (straight line), then
                  <span style="font-family:var(--mono)">u_xx = 0</span> ⇒ <span style="font-family:var(--mono)">u_tt = 0</span>.
                  That matches the discrete picture: a straight-line profile has zero second difference, so no net spring force.
                </p>
              </div>
            </div>
          </div>

          <h3>Cross-check via dispersion relation (Fourier/normal-mode method)</h3>
          <p>
            Because the system is linear and translation-invariant, we can use a plane-wave ansatz
            (a discrete Fourier mode):
          </p>
          <div class="eq" id="eq_ansatz">u_n(t) = U e^{i(k n a - ω t)}</div>

          <p>
            Substitute into the discrete equation:
          </p>
          <div class="eq" id="eq_dispersion_steps">
Left: m ü_n = m(-ω²) U e^{i(kna-ωt)}
Right: K(U e^{ik(n+1)a} - 2U e^{ikna} + U e^{ik(n-1)a}) e^{-iωt}
     = K U e^{i(kna-ωt)}(e^{ika} - 2 + e^{-ika})
     = K U e^{i(kna-ωt)}(2cos(ka) - 2)
     = -4K U e^{i(kna-ωt)} sin²(ka/2)
          </div>

          <p>
            Cancel the common factor <span style="font-family:var(--mono)">U e^{i(kna-ωt)}</span> (valid because we consider nontrivial modes U≠0):
          </p>
          <div class="eq" id="eq_dispersion">
m ω² = 4K sin²(ka/2)
⇒ ω²(k) = (4K/m) sin²(ka/2)
          </div>

          <p>
            Now apply the long-wavelength asymptotic expansion <span style="font-family:var(--mono)">sin(ka/2) ≈ (ka/2)</span> for <span style="font-family:var(--mono)">ka ≪ 1</span>:
          </p>
          <div class="eq" id="eq_dispersion_expand">
ω² ≈ (4K/m) ( (ka/2)² ) = (K a² / m) k²
⇒ ω ≈ v k,  v = a √(K/m)
          </div>

          <p>
            This matches the continuum wave equation, whose plane-wave solutions satisfy <span style="font-family:var(--mono)">ω = v k</span>.
          </p>

          <div class="callout">
            <div class="tag"><i></i>Math Insight (core equation as a mathematical object)</div>
            <div class="content">
              <p>
                The continuum wave equation
                <span style="font-family:var(--mono)">u_tt = v² u_xx</span>
                is a <strong>linear, second-order, hyperbolic PDE</strong>. It supports finite-speed propagation,
                has conserved energy (in the ideal lossless case), and admits separation of variables and Fourier analysis.
                Mathematically, it is the continuum limit of a discrete second-difference operator:
                <span style="font-family:var(--mono)">Δ_d u_n = u_{n+1}-2u_n+u_{n-1}</span>,
                which approximates <span style="font-family:var(--mono)">a² ∂²u/∂x²</span> as <span style="font-family:var(--mono)">a→0</span> for smooth u.
              </p>
            </div>
          </div>

          <figure>
            <canvas id="dispersionPlot" aria-label="Dispersion relation plot"></canvas>
            <figcaption>
              A single static plot comparing the <strong>discrete dispersion</strong> (exact) to the <strong>continuum</strong> approximation (long-wavelength).
              (Uses example values only for visualization; the final result remains symbolic.)
            </figcaption>
          </figure>

          <a class="backTop" href="#top">Back to top ↑</a>
        </article>

        <article id="part4">
          <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

          <h3>Interpret the final formula</h3>
          <p>
            The wave speed <span style="font-family:var(--mono)">v = a √(K/m)</span> increases if springs are stiffer (larger K)
            and decreases if masses are heavier (larger m). The spacing a converts “per-site stiffness” into a continuum speed.
          </p>

          <div class="grid2">
            <div class="callout">
              <div class="tag"><i></i>Parameter dependence</div>
              <div class="content">
                <ul>
                  <li><strong>K ↑</strong> ⇒ <span style="font-family:var(--mono)">v ∝ √K</span> increases (faster propagation).</li>
                  <li><strong>m ↑</strong> ⇒ <span style="font-family:var(--mono)">v ∝ 1/√m</span> decreases (more inertia).</li>
                  <li><strong>a ↑</strong> ⇒ <span style="font-family:var(--mono)">v ∝ a</span> increases (for fixed K, m per site).</li>
                </ul>
              </div>
            </div>
            <div class="callout warn">
              <div class="tag"><i></i>Where continuum starts to fail</div>
              <div class="content">
                <p>
                  When <span style="font-family:var(--mono)">ka</span> is not small (λ comparable to a), the next term
                  <span style="font-family:var(--mono)">(a⁴/12)u_xxxx</span> is not negligible. Then the system becomes
                  <strong>dispersive</strong>: different wavelengths travel at different speeds.
                </p>
              </div>
            </div>
          </div>

          <h3>Alternative derivation idea (brief but meaningful)</h3>
          <p>
            A “continuum mechanics” route: define a discrete strain
            <span style="font-family:var(--mono)">ε_n ≈ (u_{n+1}-u_n)/a</span>
            and a discrete stress (spring force per area; in 1D, just force)
            <span style="font-family:var(--mono)">σ_n ≈ K (u_{n+1}-u_n)</span>.
            The net force on mass n is the discrete divergence of stress:
            <span style="font-family:var(--mono)">F_n = σ_n - σ_{n-1}</span>.
            Passing to the continuum gives
            <span style="font-family:var(--mono)">m u_tt ≈ ∂σ/∂x</span>,
            and with <span style="font-family:var(--mono)">σ ∝ ∂u/∂x</span> you obtain the wave equation.
          </p>

          <h3>Concept check (self-test with answers)</h3>
          <ul>
            <li><strong>Q:</strong> What is the precise “long wavelength” condition? <strong>A:</strong> <span style="font-family:var(--mono)">ka ≪ 1</span> (equivalently <span style="font-family:var(--mono)">λ ≫ a</span>).</li>
            <li><strong>Q:</strong> Why do odd derivatives cancel in the second difference? <strong>A:</strong> symmetry: adding expansions at <span style="font-family:var(--mono)">x±a</span> cancels odd terms.</li>
            <li><strong>Q:</strong> What mathematical type is the wave equation? <strong>A:</strong> linear hyperbolic PDE.</li>
            <li><strong>Q:</strong> What physical feature appears when λ ~ a? <strong>A:</strong> dispersion (ω not linear in k).</li>
            <li><strong>Q:</strong> What is the sound speed in terms of microscopic parameters? <strong>A:</strong> <span style="font-family:var(--mono)">v = a √(K/m)</span>.</li>
          </ul>

          <a class="backTop" href="#top">Back to top ↑</a>
        </article>

        <article id="part5">
          <h2>PART 5 — Optional Plot Guide (ONLY IF A PLOT EXISTS)</h2>
          <p>
            This plot shows why the continuum wave equation is a <strong>long-wavelength approximation</strong>.
            The discrete chain has the exact dispersion relation
            <span style="font-family:var(--mono)">ω² = (4K/m) sin²(ka/2)</span>,
            while the continuum wave equation predicts the linear relation
            <span style="font-family:var(--mono)">ω = v k</span>.
          </p>

          <div class="callout">
            <div class="tag"><i></i>Axes, units, and example values</div>
            <div class="content">
              <ul>
                <li><strong>x-axis:</strong> wavenumber k (rad/m). The plot uses the normalized form <span style="font-family:var(--mono)">ka</span> for clarity.</li>
                <li><strong>y-axis:</strong> angular frequency ω (rad/s), plotted in normalized form <span style="font-family:var(--mono)">ω / √(K/m)</span>.</li>
                <li><strong>Example values:</strong> The normalization implicitly sets <span style="font-family:var(--mono)">√(K/m)=1</span> and uses <span style="font-family:var(--mono)">a=1</span> for plotting only. This does not change the symbolic derivation.</li>
              </ul>
            </div>
          </div>

          <h3>What to notice</h3>
          <ul>
            <li>Near <span style="font-family:var(--mono)">ka = 0</span>, the discrete curve is nearly a straight line: <span style="font-family:var(--mono)">ω ≈ v k</span> (continuum works).</li>
            <li>As <span style="font-family:var(--mono)">ka</span> approaches π (short wavelengths ~ 2a), the curve bends strongly: dispersion becomes significant and continuum fails.</li>
            <li>The linear line is the tangent at the origin—exactly what the asymptotic expansion captures.</li>
          </ul>

          <a class="backTop" href="#top">Back to top ↑</a>
        </article>
      </div>
    </div>
  </main>

  <footer>
    <div class="wrap">
      <div style="display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;">
        <div>
          <strong style="color:var(--text);">Continuum limit takeaway:</strong>
          <span style="color:var(--muted);">Finite differences → derivatives when λ ≫ a.</span>
        </div>
        <div style="color:var(--muted);font-size:.95rem;">
          Copy buttons use plain-text equations for easy notes and reports.
        </div>
      </div>
    </div>
  </footer>

  <div class="toast" id="toast" role="status" aria-live="polite">Copied!</div>

  <script>
    // ---------- Copy buttons ----------
    (function(){
      const toast = document.getElementById('toast');
      let toastTimer = null;

      function showToast(msg){
        toast.textContent = msg || "Copied!";
        toast.classList.add('show');
        clearTimeout(toastTimer);
        toastTimer = setTimeout(()=> toast.classList.remove('show'), 1200);
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          showToast("Copied to clipboard");
        }catch(e){
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          ta.style.top = '0';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          try{
            document.execCommand('copy');
            showToast("Copied to clipboard");
          }catch(err){
            showToast("Copy failed");
          }
          document.body.removeChild(ta);
        }
      }

      document.querySelectorAll('button.copy').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.getAttribute('data-copy');
          const el = document.getElementById(id);
          if(!el) return;
          const text = el.textContent.replace(/\n{3,}/g,"\n\n").trim();
          copyText(text);
        });
      });
    })();

    // ---------- Single static plot (canvas): discrete vs continuum dispersion ----------
    (function(){
      const canvas = document.getElementById('dispersionPlot');
      const ctx = canvas.getContext('2d');

      function resizeCanvas(){
        const dpr = Math.max(1, window.devicePixelRatio || 1);
        const rect = canvas.getBoundingClientRect();
        canvas.width = Math.round(rect.width * dpr);
        canvas.height = Math.round(rect.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
        drawPlot(rect.width, rect.height);
      }

      function drawPlot(w, h){
        ctx.clearRect(0,0,w,h);

        const padL = 54, padR = 18, padT = 34, padB = 44;
        const x0 = padL, y0 = h - padB;
        const x1 = w - padR, y1 = padT;
        const plotW = x1 - x0, plotH = y0 - y1;

        const xmin = 0, xmax = Math.PI;
        const ymin = 0, ymax = 2.1;

        function X(x){ return x0 + (x - xmin)/(xmax - xmin) * plotW; }
        function Y(y){ return y0 - (y - ymin)/(ymax - ymin) * plotH; }

        ctx.save();
        ctx.globalAlpha = 0.9;
        ctx.lineWidth = 1;

        ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--line').trim() || 'rgba(255,255,255,.12)';
        ctx.strokeRect(x0, y1, plotW, plotH);

        const gridColor = 'rgba(255,255,255,.10)';
        const gridColorLight = 'rgba(2,6,23,.10)';
        const isLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
        ctx.strokeStyle = isLight ? gridColorLight : gridColor;

        const xticks = [0, Math.PI/4, Math.PI/2, 3*Math.PI/4, Math.PI];
        ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#b6c0ff';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';

        xticks.forEach(t=>{
          const xx = X(t);
          ctx.beginPath();
          ctx.moveTo(xx, y1);
          ctx.lineTo(xx, y0);
          ctx.stroke();

          ctx.strokeStyle = isLight ? 'rgba(2,6,23,.25)' : 'rgba(255,255,255,.25)';
          ctx.beginPath();
          ctx.moveTo(xx, y0);
          ctx.lineTo(xx, y0+6);
          ctx.stroke();
          ctx.strokeStyle = isLight ? gridColorLight : gridColor;

          let lab = '';
          const eps = 1e-9;
          if(Math.abs(t-0)<eps) lab = '0';
          else if(Math.abs(t-Math.PI)<eps) lab = 'π';
          else if(Math.abs(t-Math.PI/2)<eps) lab = 'π/2';
          else if(Math.abs(t-Math.PI/4)<eps) lab = 'π/4';
          else lab = '3π/4';
          ctx.fillText(lab, xx, y0+10);
        });

        const yticks = [0,0.5,1,1.5,2];
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';
        yticks.forEach(t=>{
          const yy = Y(t);
          ctx.beginPath();
          ctx.moveTo(x0, yy);
          ctx.lineTo(x1, yy);
          ctx.stroke();

          ctx.strokeStyle = isLight ? 'rgba(2,6,23,.25)' : 'rgba(255,255,255,.25)';
          ctx.beginPath();
          ctx.moveTo(x0-6, yy);
          ctx.lineTo(x0, yy);
          ctx.stroke();
          ctx.strokeStyle = isLight ? gridColorLight : gridColor;

          ctx.fillText(String(t.toFixed(1)), x0-10, yy);
        });

        ctx.restore();

        ctx.save();
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--text').trim() || '#e8ecff';
        ctx.font = '700 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.textAlign = 'left';
        ctx.textBaseline = 'top';
        ctx.fillText('Dispersion: discrete chain vs continuum (normalized)', x0, 10);
        ctx.restore();

        ctx.save();
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() || '#b6c0ff';
        ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'bottom';
        ctx.fillText('x = k a (dimensionless)', (x0+x1)/2, h-10);

        ctx.translate(14, (y0+y1)/2);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        ctx.fillText('y = ω / √(K/m) (dimensionless)', 0, 0);
        ctx.restore();

        const accent = getComputedStyle(document.documentElement).getPropertyValue('--accent').trim() || '#6ee7ff';
        const accent2 = getComputedStyle(document.documentElement).getPropertyValue('--accent2').trim() || '#a78bfa';

        ctx.save();
        ctx.strokeStyle = accent;
        ctx.lineWidth = 2;
        ctx.beginPath();
        const N = 240;
        for(let i=0;i<=N;i++){
          const x = xmin + (xmax-xmin)*i/N;
          const y = 2*Math.sin(x/2);
          const px = X(x), py = Y(y);
          if(i===0) ctx.moveTo(px,py);
          else ctx.lineTo(px,py);
        }
        ctx.stroke();
        ctx.restore();

        ctx.save();
        ctx.strokeStyle = accent2;
        ctx.lineWidth = 2;
        ctx.setLineDash([6,6]);
        ctx.beginPath();
        for(let i=0;i<=N;i++){
          const x = xmin + (xmax-xmin)*i/N;
          const y = Math.min(ymax, x);
          const px = X(x), py = Y(y);
          if(i===0) ctx.moveTo(px,py);
          else ctx.lineTo(px,py);
        }
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.restore();

        ctx.save();
        const lx = x0 + 10, ly = y1 + 10;
        const boxW = 250, boxH = 58;
        ctx.fillStyle = (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) ? 'rgba(255,255,255,.75)' : 'rgba(15,23,51,.55)';
        ctx.strokeStyle = (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) ? 'rgba(2,6,23,.15)' : 'rgba(255,255,255,.12)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        roundRect(ctx, lx, ly, boxW, boxH, 12);
        ctx.fill();
        ctx.stroke();

        ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
        ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--text').trim() || '#e8ecff';
        ctx.textAlign = 'left';
        ctx.textBaseline = 'middle';

        ctx.strokeStyle = accent;
        ctx.lineWidth = 2;
        ctx.beginPath(); ctx.moveTo(lx+12, ly+18); ctx.lineTo(lx+44, ly+18); ctx.stroke();
        ctx.fillText('Discrete:  y = 2 sin(x/2)', lx+52, ly+18);

        ctx.strokeStyle = accent2;
        ctx.setLineDash([6,6]);
        ctx.beginPath(); ctx.moveTo(lx+12, ly+40); ctx.lineTo(lx+44, ly+40); ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillText('Continuum: y = x  (ka ≪ 1)', lx+52, ly+40);

        ctx.restore();

        function roundRect(c, x, y, w, h, r){
          const rr = Math.min(r, w/2, h/2);
          c.moveTo(x+rr, y);
          c.arcTo(x+w, y, x+w, y+h, rr);
          c.arcTo(x+w, y+h, x, y+h, rr);
          c.arcTo(x, y+h, x, y, rr);
          c.arcTo(x, y, x+w, y, rr);
          c.closePath();
        }
      }

      let raf = null;
      function onResize(){
        cancelAnimationFrame(raf);
        raf = requestAnimationFrame(resizeCanvas);
      }

      window.addEventListener('resize', onResize, {passive:true});
      resizeCanvas();
    })();
  </script>
</body>
</html>
