<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>Diatomic Chain with Alternating Force Constants: Normal Modes & Dispersion</title>
  <style>
    :root{
      --bg:#0b0d12; --panel:#101522; --panel2:#0f1320;
      --text:#e9ecf2; --muted:#aab3c5; --faint:#7f8aa3;
      --accent:#7bdcff; --accent2:#a78bfa; --ok:#6ee7b7; --warn:#fbbf24;
      --line:rgba(255,255,255,.10); --line2:rgba(255,255,255,.16);
      --shadow: 0 18px 40px rgba(0,0,0,.45);
      --radius: 16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f7fb; --panel:#ffffff; --panel2:#fbfbff;
        --text:#111827; --muted:#4b5563; --faint:#6b7280;
        --line:rgba(17,24,39,.10); --line2:rgba(17,24,39,.16);
        --shadow: 0 14px 30px rgba(17,24,39,.10);
      }
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(900px 500px at 15% 10%, rgba(123,220,255,.12), transparent 60%),
                  radial-gradient(700px 420px at 85% 20%, rgba(167,139,250,.12), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    header{
      padding:28px 18px 18px;
      max-width:1180px;
      margin:0 auto;
    }
    .hero{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .hero{grid-template-columns:1fr}
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0)) , var(--panel);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .hero .card{padding:18px 18px 16px}
    h1{
      font-size: clamp(1.35rem, 2.2vw, 2.1rem);
      line-height:1.15;
      margin:0 0 10px;
      letter-spacing:-0.02em;
    }
    .subtitle{
      color:var(--muted);
      margin:0 0 8px;
      font-size:0.98rem;
    }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:12px;
      color:var(--faint);
      font-size:.92rem;
    }
    .pill{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:7px 10px;
      border-radius:999px;
      background: rgba(123,220,255,.10);
      border:1px solid rgba(123,220,255,.20);
    }
    .pill b{color:var(--text); font-weight:600}
    main{
      max-width:1180px;
      margin:0 auto;
      padding:0 18px 56px;
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:16px;
    }
    @media (max-width: 980px){
      main{grid-template-columns:1fr}
    }
    nav.toc{
      position:sticky;
      top:12px;
      align-self:start;
      padding:14px;
      border-radius:var(--radius);
      background: var(--panel2);
      border:1px solid var(--line);
      box-shadow: 0 10px 24px rgba(0,0,0,.20);
    }
    nav.toc h2{
      margin:0 0 10px;
      font-size:1rem;
      letter-spacing:-0.01em;
    }
    nav.toc a{
      display:block;
      color:var(--muted);
      text-decoration:none;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid transparent;
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
      font-size:.95rem;
    }
    nav.toc a:hover{
      color:var(--text);
      background: rgba(255,255,255,.05);
      border-color: var(--line2);
      transform: translateY(-1px);
    }
    .content{
      display:flex;
      flex-direction:column;
      gap:14px;
    }
    section{
      padding:18px;
    }
    section.card{scroll-margin-top:72px}
    h2{
      margin:0 0 12px;
      font-size:1.22rem;
      letter-spacing:-0.01em;
    }
    h3{
      margin:18px 0 10px;
      font-size:1.06rem;
    }
    p{margin:10px 0}
    ul{margin:10px 0 10px 18px}
    li{margin:6px 0}
    .grid2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    @media (max-width: 820px){
      .grid2{grid-template-columns:1fr}
    }
    .callout{
      border:1px solid var(--line2);
      background: rgba(255,255,255,.03);
      border-radius:14px;
      padding:12px 12px 10px;
      margin:12px 0;
    }
    .callout .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-weight:700;
      font-size:.85rem;
      letter-spacing:.02em;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line2);
      background: rgba(255,255,255,.04);
      margin-bottom:8px;
    }
    .tag.assum{border-color: rgba(110,231,183,.30); background: rgba(110,231,183,.08)}
    .tag.keyeq{border-color: rgba(123,220,255,.32); background: rgba(123,220,255,.09)}
    .tag.warn{border-color: rgba(251,191,36,.35); background: rgba(251,191,36,.10)}
    .tag.final{border-color: rgba(167,139,250,.38); background: rgba(167,139,250,.10)}
    .tag.math{border-color: rgba(123,220,255,.32); background: rgba(123,220,255,.09)}
    .eqwrap{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:10px;
      align-items:start;
      margin:10px 0 0;
    }
    pre.eq{
      margin:0;
      padding:12px 12px;
      border-radius:12px;
      background: rgba(0,0,0,.22);
      border:1px solid var(--line);
      font-family:var(--mono);
      font-size:.92rem;
      overflow:auto;
      white-space:pre;
    }
    .btn{
      user-select:none;
      cursor:pointer;
      border:1px solid var(--line2);
      background: rgba(255,255,255,.05);
      color:var(--text);
      padding:9px 10px;
      border-radius:12px;
      font-size:.9rem;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      min-width:120px;
      text-align:center;
      white-space:nowrap;
    }
    .btn:hover{transform: translateY(-1px); border-color: rgba(123,220,255,.35); background: rgba(123,220,255,.08)}
    .btn:active{transform: translateY(0px)}
    details{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      background: rgba(255,255,255,.02);
      margin:10px 0;
    }
    details > summary{
      cursor:pointer;
      font-weight:650;
      color:var(--text);
      list-style:none;
      display:flex;
      align-items:center;
      gap:8px;
    }
    details > summary::-webkit-details-marker{display:none}
    details > summary:before{
      content:"▸";
      color:var(--accent);
      font-weight:900;
      transform: translateY(-1px);
    }
    details[open] > summary:before{content:"▾"}
    figure{
      margin:12px 0 0;
      border:1px solid var(--line);
      border-radius:14px;
      background: rgba(255,255,255,.02);
      overflow:hidden;
    }
    figcaption{
      padding:10px 12px;
      color:var(--muted);
      border-top:1px solid var(--line);
      font-size:.92rem;
    }
    canvas{display:block; width:100%; height:auto}
    .backtop{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:14px;
      color:var(--muted);
      text-decoration:none;
      border:1px solid transparent;
      padding:8px 10px;
      border-radius:12px;
      transition: background .15s ease, border-color .15s ease, transform .15s ease;
    }
    .backtop:hover{color:var(--text); background: rgba(255,255,255,.05); border-color: var(--line2); transform: translateY(-1px)}
    footer{
      max-width:1180px;
      margin:0 auto;
      padding:18px 18px 44px;
      color:var(--faint);
      font-size:.92rem;
    }
    .hr{height:1px; background:var(--line); margin:14px 0}
    .mini{
      font-size:.92rem; color:var(--muted);
    }
    .kpi{
      display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;
    }
    .kpi .box{
      flex:1 1 180px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius:14px;
      padding:10px 12px;
    }
    .kpi .box .t{color:var(--faint); font-size:.85rem}
    .kpi .box .v{font-weight:800; font-size:1.05rem; margin-top:2px}
    .print-note{display:none}
    @media print{
      nav.toc{display:none}
      main{grid-template-columns:1fr}
      body{background:#fff}
      .card{box-shadow:none}
      .btn{display:none}
      details{break-inside:avoid}
      section{break-inside:avoid; page-break-inside:avoid}
      .print-note{display:block; color:#111827}
      a{color:#111827; text-decoration:none}
    }
  </style>
</head>

<body>
<a id="top"></a>
<header>
  <div class="hero">
    <div class="card">
      <h1>Diatomic Chain (Equal Masses) with Alternating Force Constants: ω(K) at Zone Center & Boundary</h1>
      <p class="subtitle">
        Normal-mode analysis of a 1D lattice where nearest-neighbor “springs” alternate between <b>C</b> and <b>10C</b>,
        with equal masses and spacing <b>a/2</b>. We derive the full dispersion and then evaluate it at <b>K=0</b> and <b>K=π/a</b>.
      </p>
      <div class="meta">
        <span class="pill"><b>Model</b> Linear lattice dynamics</span>
        <span class="pill"><b>Math</b> Bloch ansatz + 2×2 eigenvalue problem</span>
        <span class="pill"><b>Output</b> Symbolic ω(K), key points, sketch</span>
      </div>
      <div class="kpi">
        <div class="box">
          <div class="t">Acoustic at K=0</div>
          <div class="v">ω = 0</div>
        </div>
        <div class="box">
          <div class="t">Optical at K=0</div>
          <div class="v">ω = √(22C/m)</div>
        </div>
        <div class="box">
          <div class="t">At K=π/a</div>
          <div class="v">ω = √(2C/m), √(20C/m)</div>
        </div>
      </div>
      <p class="mini print-note">Print tip: the page is formatted to break cleanly between sections.</p>
    </div>

    <div class="card">
      <section style="padding:18px">
        <h2 style="margin-top:0">Quick Summary</h2>
        <ul>
          <li><b>What:</b> Find lattice vibration frequencies for a 1D <b>diatomic</b> (two-atom basis) chain with alternating spring constants.</li>
          <li><b>Key physics:</b> Two atoms per unit cell ⇒ <b>two branches</b>: acoustic (in-phase) and optical (out-of-phase).</li>
          <li><b>Governing equations:</b> Discrete Newton’s law with Hooke forces; leads to an <b>eigenvalue problem</b> for ω².</li>
          <li><b>Dispersion form:</b> ω(K) comes from det(D(K) − ω²I)=0 where D(K) is the <b>dynamic matrix</b>.</li>
          <li><b>Results requested:</b> ω at <b>K=0</b> and <b>K=π/a</b> + qualitative sketch of both branches.</li>
          <li><b>Zone-center:</b> ω<sub>ac</sub>(0)=0 (translation symmetry), ω<sub>op</sub>(0)=√(2(C+10C)/m)=√(22C/m).</li>
          <li><b>Zone-boundary:</b> ω(π/a)=√(2C/m) and √(2·10C/m)=√(20C/m) (splitting set by spring contrast).</li>
          <li><b>Industrial relevance:</b> Alternating stiffness is a <b>phononic crystal</b> idea—band gaps, vibration filtering, thermal transport control.</li>
        </ul>
      </section>
    </div>
  </div>
</header>

<main>
  <nav class="toc" aria-label="Table of contents">
    <h2>Table of Contents</h2>
    <a href="#p0">PART 0 — Concept Primer</a>
    <a href="#p0b">PART 0B — Industry Perspective</a>
    <a href="#p1">PART 1 — Problem Analysis</a>
    <a href="#p2">PART 2 — Strategy & Tips</a>
    <a href="#p3">PART 3 — Full Solution</a>
    <a href="#p4">PART 4 — Deeper Understanding</a>
    <a href="#p5">PART 5 — Optional Plot Guide</a>
    <a href="#final">Copy: Final Answer</a>
  </nav>

  <div class="content">

    <section id="p0" class="card">
      <h2>PART 0 — Concept Primer (Theory Before Solving)</h2>

      <h3>0.1 Core definitions (symbols + SI units)</h3>
      <div class="grid2">
        <div class="callout">
          <div class="tag keyeq">Key symbols</div>
          <ul>
            <li><b>m</b> — mass of each atom (kg)</li>
            <li><b>C</b>, <b>10C</b> — spring (force) constants (N/m)</li>
            <li><b>a/2</b> — nearest-neighbor spacing (m)</li>
            <li><b>a</b> — lattice constant of the <b>two-atom unit cell</b> (m)</li>
            <li><b>K</b> — crystal wave number (1/m), first Brillouin zone: K ∈ [−π/a, π/a]</li>
            <li><b>ω</b> — angular frequency (rad/s)</li>
            <li><b>u<sub>n</sub></b>, <b>v<sub>n</sub></b> — displacements (m) of the two sublattice atoms in cell n</li>
          </ul>
        </div>
        <div class="callout">
          <div class="tag assum">Validity conditions</div>
          <ul>
            <li><b>Small oscillations</b> ⇒ Hooke’s law linear forces.</li>
            <li><b>Nearest-neighbor coupling</b> only.</li>
            <li><b>Perfect periodicity</b> ⇒ Bloch/plane-wave solutions exist.</li>
            <li><b>No damping</b> ⇒ real ω (conservative system).</li>
          </ul>
        </div>
      </div>

      <h3>0.2 Physical meaning of key quantities</h3>
      <ul>
        <li><b>Acoustic branch:</b> long-wavelength motion where neighboring atoms move nearly together; ω→0 as K→0 because uniform translation costs no spring energy.</li>
        <li><b>Optical branch:</b> two atoms in the unit cell move against each other; finite ω at K=0 because springs stretch/compress even at infinite wavelength.</li>
        <li><b>Alternating stiffness:</b> breaks the “single-spring” uniformity and typically <b>opens a band gap</b> between branches near the zone boundary.</li>
      </ul>

      <h3>0.3 Key laws/principles</h3>
      <div class="callout">
        <div class="tag keyeq">Governing principle</div>
        <p>
          Each atom obeys Newton’s second law (ODE in time) with linear restoring forces from springs:
          force = −k × (relative extension).
        </p>
        <div class="eqwrap">
          <pre class="eq" data-copy="Newton+Hooke (discrete):
m d^2x_j/dt^2 = sum_over_neighbors [ -k (x_j - x_neighbor) ]">Newton+Hooke (discrete):
m d^2x_j/dt^2 = Σ_neighbors [ -k (x_j - x_neighbor) ]</pre>
          <button class="btn" data-copy-btn>Copy equation</button>
        </div>
      </div>

      <h3>0.4 Common models/approximations (and why)</h3>
      <ul>
        <li><b>Harmonic approximation:</b> Keep only terms linear in displacement; mathematically makes the system linear ⇒ superposition and eigenmodes.</li>
        <li><b>Bloch ansatz:</b> Periodic coefficients ⇒ solutions separable in space/time as plane waves times periodic basis; reduces infinite ODE system to a finite eigenproblem per K.</li>
        <li><b>Two-DOF unit cell:</b> Because springs alternate, a minimal repeating pattern needs two atoms (basis size 2).</li>
      </ul>

      <h3>0.5 Mini intuition examples (quick)</h3>
      <ul>
        <li>If all springs were equal (k), you’d get one acoustic branch (monatomic) in the reduced zone scheme; with two atoms per cell you’d see folding into two branches.</li>
        <li>If one spring is extremely stiff (k₂≫k₁), the optical frequency gets pushed up (hard to compress stiff bonds), and the gap near K=π/a becomes large.</li>
      </ul>

      <h3>0.6 What to watch for (pitfalls)</h3>
      <ul>
        <li><b>Unit cell choice:</b> Nearest-neighbor spacing is a/2, but Bloch phase uses the unit cell period a.</li>
        <li><b>Sign conventions:</b> Force depends on (displacement difference). A wrong sign flips phases and breaks symmetry.</li>
        <li><b>Complex exponentials:</b> Physical displacements are real; take Re{…}. Eigenvalue condition uses magnitudes (cos terms) after multiplying complex conjugates.</li>
      </ul>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="p0b" class="card">
      <h2>PART 0B — Industry & Applied Physics Perspective</h2>

      <h3>Where this appears (concrete applications)</h3>
      <ul>
        <li><b>Phononic crystals / vibration filters:</b> Alternating stiffness creates stop-bands (band gaps) that block vibrations at targeted frequencies.</li>
        <li><b>MEMS/NEMS resonators:</b> Micro-fabricated beams with periodic stiffness modulation control mode shapes and suppress unwanted spurious modes.</li>
        <li><b>Thermal transport engineering:</b> Phonon dispersion controls group velocity and scattering phase space; stiffness modulation can reduce thermal conductivity (thermoelectrics) or manage heat flow.</li>
        <li><b>Composite/laminated structures:</b> Alternating layer stiffness in 1D approximations behaves like alternating-spring models for longitudinal waves.</li>
      </ul>

      <h3>Why engineers care</h3>
      <ul>
        <li><b>Performance:</b> Tune resonant frequencies and band gaps to avoid harmful excitation.</li>
        <li><b>Reliability & safety:</b> Keep operating vibration away from fatigue-driving modes.</li>
        <li><b>Cost & manufacturability:</b> Periodic designs can be easier to mass-produce (repeatable cells), but require tolerance control on stiffness.</li>
      </ul>

      <h3>Measurement/validation in practice (brief)</h3>
      <ul>
        <li><b>Laser Doppler vibrometry</b> to map mode shapes and extract ω(K) indirectly (or modal frequencies at finite size).</li>
        <li><b>Brillouin / Raman scattering</b> for phonon dispersion in crystals (optical probes of vibrational modes).</li>
        <li><b>Dynamic mechanical analysis</b> (DMA) and frequency response testing for engineered periodic structures.</li>
      </ul>

      <h3>Design trade-offs & constraints</h3>
      <ul>
        <li><b>Non-idealities:</b> Damping, disorder, and finite-size boundaries smear sharp band edges.</li>
        <li><b>Tolerances:</b> Variations in stiffness reduce band gap depth and shift frequencies.</li>
        <li><b>Coupling to environment:</b> Mounting and packaging introduce extra springs/masses that modify dispersion.</li>
      </ul>

      <div class="callout">
        <div class="tag assum">From lab to product</div>
        <p>
          The ideal infinite chain becomes a finite structure with boundary conditions (fixed/free), damping, and
          parameter spread. Engineers often use the same <b>dynamic matrix</b> idea but with finite-element (FE)
          discretization: the continuum/structure is converted into a large eigenvalue problem
          (K<sub>struct</sub> − ω²M)q=0, directly mirroring the lattice derivation below.
        </p>
      </div>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="p1" class="card">
      <h2>PART 1 — Problem Analysis (No Solving Yet)</h2>

      <h3>1.1 Problem restatement (in plain words)</h3>
      <p>
        We have a 1D chain of equal masses connected by nearest-neighbor springs.
        The spring constants alternate: one bond has stiffness <b>C</b>, the next has stiffness <b>10C</b>, repeating.
        The nearest-neighbor spacing is <b>a/2</b>, so the repeating pattern length (unit cell) is <b>a</b>.
        Find the normal-mode angular frequency <b>ω(K)</b> at the special wave numbers <b>K=0</b> and <b>K=π/a</b>,
        and sketch the dispersion relation ω(K).
      </p>

      <h3>1.2 Given, unknowns, and targets</h3>
      <div class="grid2">
        <div class="callout">
          <div class="tag keyeq">Given</div>
          <ul>
            <li>Alternating spring constants: k₁ = C, k₂ = 10C</li>
            <li>Equal masses: m (same for all atoms)</li>
            <li>Nearest-neighbor separation: a/2</li>
          </ul>
        </div>
        <div class="callout">
          <div class="tag keyeq">Unknowns / required</div>
          <ul>
            <li>Dispersion relation ω(K) (two branches)</li>
            <li>Values at K=0 and K=π/a</li>
            <li>Qualitative sketch of ω vs K</li>
          </ul>
        </div>
      </div>

      <h3>1.3 Relevant principles (and why they apply)</h3>
      <ul>
        <li><b>Linearity:</b> Harmonic springs ⇒ linear ODEs ⇒ normal modes exist.</li>
        <li><b>Periodicity:</b> Alternation repeats every a ⇒ Bloch theorem applies ⇒ solutions labeled by K.</li>
        <li><b>Energy conservation:</b> No damping ⇒ ω² eigenvalues are real and nonnegative (stable modes).</li>
      </ul>

      <h3>1.4 Mathematical model (explicit)</h3>
      <div class="callout">
        <div class="tag math">Mathematical Physics Model</div>
        <ul>
          <li><b>Coordinates:</b> 1D chain along x. Unit cell index n ∈ ℤ.</li>
          <li><b>Geometry:</b> Atom A in cell n at x = n a; atom B in cell n at x = n a + a/2.</li>
          <li><b>Fields/variables:</b> Displacements uₙ(t) for A, vₙ(t) for B (both scalar, along x).</li>
          <li><b>Domain:</b> Infinite periodic lattice (or very large with periodic boundary conditions).</li>
          <li><b>Boundary conditions (for Bloch analysis):</b> Bloch-periodic:
            uₙ(t) ~ e^{i n K a}, vₙ(t) ~ e^{i n K a}.</li>
          <li><b>Initial conditions:</b> Not needed for eigenfrequencies; normal modes solve the homogeneous system.</li>
        </ul>
      </div>

      <h3>1.5 Assumptions (explicit)</h3>
      <div class="callout">
        <div class="tag assum">Assumptions</div>
        <ul>
          <li>Small displacements ⇒ spring force linear in relative displacement (harmonic approximation).</li>
          <li>Only nearest-neighbor interactions.</li>
          <li>All masses equal; springs alternate exactly C and 10C with perfect periodicity.</li>
          <li>No damping, no external forcing.</li>
        </ul>
      </div>

      <h3>1.6 Possible approaches (compare 2–3)</h3>
      <ul>
        <li><b>(A) Direct Newton + Bloch ansatz (best here):</b> Build 2×2 dynamic matrix per K; solve det=0. Fast and transparent.</li>
        <li><b>(B) Energy/Lagrangian method:</b> Write kinetic and potential energies for the unit cell; derive Euler–Lagrange equations; yields same eigenproblem with good symmetry insight.</li>
        <li><b>(C) Transfer-matrix / recursion:</b> Useful for finite chains and defects; heavier than needed for K=0, π/a.</li>
      </ul>
      <p><b>Chosen:</b> (A) because it gives ω(K) in one clean eigenvalue step and makes the K=0, π/a limits immediate.</p>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="p2" class="card">
      <h2>PART 2 — Strategy & Tips (Roadmap Only)</h2>

      <ol>
        <li><b>Define the unit cell</b> (two atoms A,B) and label displacements uₙ(t), vₙ(t).</li>
        <li><b>Write Newton’s equations</b> for uₙ and vₙ using Hooke forces from the two neighboring springs (k₁, k₂).</li>
        <li><b>Insert the Bloch/plane-wave form</b> uₙ=U e^{i(nKa−ωt)}, vₙ=V e^{i(nKa−ωt)} to separate n and t.</li>
        <li><b>Collect terms</b> to obtain a 2×2 linear system (dynamic matrix) for amplitudes (U,V).</li>
        <li><b>Set determinant to zero</b> for nontrivial solutions; solve for ω²(K) (two branches).</li>
        <li><b>Evaluate at K=0</b> (cos=1) and K=π/a (cos=−1) to get requested values.</li>
        <li><b>Sanity checks</b>: dimensions, limiting cases (k₂→k₁, k₂≫k₁), physical interpretation (acoustic vs optical).</li>
        <li><b>Sketch</b> acoustic rising from 0 and optical starting high; show splitting at zone boundary.</li>
      </ol>

      <div class="callout">
        <div class="tag warn">Common mistakes</div>
        <ul>
          <li>Using the wrong phase factor: the Bloch factor is e^{iKa} between unit cells (length a), not a/2.</li>
          <li>Forgetting that the determinant uses (k₁ + k₂ e^{-iKa})(k₁ + k₂ e^{iKa}) = k₁² + k₂² + 2k₁k₂ cos(Ka).</li>
          <li>Mixing up which spring is “left” vs “right”—it doesn’t matter if you stay consistent; the final dispersion uses cos(Ka) and is symmetric.</li>
        </ul>
      </div>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="p3" class="card">
      <h2>PART 3 — Full Solution (Detailed + Teaching)</h2>

      <h3>3.1 Qualitative expectation (before math)</h3>
      <ul>
        <li>Because the lattice has two atoms per unit cell, we expect <b>two normal-mode branches</b>.</li>
        <li>At <b>K→0</b>, one mode must have ω→0 (uniform translation: no restoring force) ⇒ acoustic branch.</li>
        <li>The other mode at K=0 should be finite because A and B can oscillate against each other, stretching springs ⇒ optical branch.</li>
        <li>At <b>K=π/a</b> (zone boundary), alternating stiffness typically maximizes branch splitting: one branch tied to the soft spring, one to the stiff spring.</li>
      </ul>

      <h3>3.2 Step 1 — Define the unit cell and spring layout</h3>
      <p>
        Let unit cell index be n ∈ ℤ. Put atom <b>A</b> at x = n a with displacement uₙ(t), and atom <b>B</b> at x = n a + a/2 with displacement vₙ(t).
        Springs connect nearest neighbors:
      </p>
      <ul>
        <li>Between Aₙ and Bₙ: spring constant k₁ = C</li>
        <li>Between Bₙ and Aₙ₊₁: spring constant k₂ = 10C</li>
      </ul>
      <p>
        (Any consistent alternation convention leads to the same dispersion; only k₁ and k₂ matter.)
      </p>

      <h3>3.3 Step 2 — Write Newton’s equations (discrete ODEs)</h3>
      <p>
        Hooke force from a spring connecting two masses is proportional to the relative displacement. For atom Aₙ,
        the two neighbors are Bₙ (right) and Bₙ₋₁ (left). The force contributions are:
      </p>

      <div class="callout">
        <div class="tag keyeq">Forces & equations of motion</div>
        <div class="eqwrap">
          <pre class="eq" data-copy="Equations of motion:
m d^2u_n/dt^2 = -k1(u_n - v_n) - k2(u_n - v_{n-1})
m d^2v_n/dt^2 = -k1(v_n - u_n) - k2(v_n - u_{n+1})">Equations of motion:
m d²uₙ/dt² = −k₁(uₙ − vₙ) − k₂(uₙ − vₙ₋₁)
m d²vₙ/dt² = −k₁(vₙ − uₙ) − k₂(vₙ − uₙ₊₁)</pre>
          <button class="btn" data-copy-btn>Copy equations</button>
        </div>
        <p class="mini">
          Why valid: linear springs ⇒ forces are linear in u,v (superposition holds).
          Nearest-neighbor assumption limits the sum to two terms.
        </p>
      </div>

      <details>
        <summary>Optional note: symmetry and conservation insight</summary>
        <p>
          The system is invariant under uniform translation uₙ→uₙ+const, vₙ→vₙ+const.
          This symmetry implies a zero-frequency mode at K=0 (a discrete analog of a Goldstone mode).
        </p>
      </details>

      <h3>3.4 Step 3 — Bloch ansatz (separability in n and t)</h3>
      <p>
        Because coefficients repeat every unit cell (period a), we seek normal modes with Bloch form:
      </p>
      <div class="callout">
        <div class="tag keyeq">Bloch/plane-wave form</div>
        <div class="eqwrap">
          <pre class="eq" data-copy="Bloch ansatz:
u_n(t)=U e^{i(nKa-ωt)}
v_n(t)=V e^{i(nKa-ωt)}
with K in [-π/a, π/a]">Bloch ansatz:
uₙ(t) = U · e^{i(nKa − ωt)}
vₙ(t) = V · e^{i(nKa − ωt)}
K ∈ [−π/a, π/a]</pre>
          <button class="btn" data-copy-btn>Copy equation</button>
        </div>
        <p class="mini">
          Why valid: periodic lattice ⇒ solutions can be chosen as simultaneous eigenfunctions of discrete translation by a.
          Time dependence e^{−iωt} comes from linear constant-coefficient ODEs after Bloch reduction.
        </p>
      </div>

      <p>
        We also need shifted terms:
        vₙ₋₁ = V e^{i((n−1)Ka − ωt)} = V e^{-iKa} e^{i(nKa − ωt)},
        uₙ₊₁ = U e^{i((n+1)Ka − ωt)} = U e^{iKa} e^{i(nKa − ωt)}.
      </p>

      <h3>3.5 Step 4 — Reduce to a 2×2 eigenvalue problem</h3>
      <p>
        Substitute the Bloch forms into the equations of motion and factor out the common exponential e^{i(nKa − ωt)}.
        Also note d²/dt² gives (−ω²).
      </p>

      <details open>
        <summary>Show the algebra (no magic jumps)</summary>
        <p><b>First equation:</b></p>
        <p>
          m(−ω²)U = −k₁(U − V) − k₂(U − V e^{-iKa})
        </p>
        <p>Multiply both sides by −1 and expand:</p>
        <p>
          mω²U = k₁(U − V) + k₂(U − V e^{-iKa})
        </p>
        <p>
          mω²U = (k₁+k₂)U − (k₁ + k₂ e^{-iKa})V
        </p>

        <p><b>Second equation:</b></p>
        <p>
          m(−ω²)V = −k₁(V − U) − k₂(V − U e^{iKa})
        </p>
        <p>Multiply by −1 and expand:</p>
        <p>
          mω²V = (k₁+k₂)V − (k₁ + k₂ e^{iKa})U
        </p>
      </details>

      <p>
        Write this as a matrix equation (dynamic matrix form):
      </p>

      <div class="callout">
        <div class="tag math">Eigenvalue problem</div>
        <div class="eqwrap">
          <pre class="eq" data-copy="Dynamic matrix system:
[(k1+k2)-mω^2      -(k1+k2 e^{-iKa})] [U] = [0]
[ -(k1+k2 e^{ iKa}) (k1+k2)-mω^2     ] [V]   [0]">Dynamic matrix system:
[ (k₁+k₂) − mω²        −(k₁ + k₂ e^{-iKa}) ] [U] = [0]
[ −(k₁ + k₂ e^{ iKa})   (k₁+k₂) − mω²      ] [V]   [0]</pre>
          <button class="btn" data-copy-btn>Copy equation</button>
        </div>
        <p class="mini">
          This is a finite-dimensional eigenvalue problem at each K. Nontrivial (U,V) exist only if det=0.
          The matrix is Hermitian for real K because the off-diagonals are complex conjugates.
        </p>
      </div>

      <h3>3.6 Step 5 — Determinant condition ⇒ dispersion relation</h3>
      <p>
        Set determinant to zero:
      </p>
      <p style="font-family:var(--mono)">
        ((k₁+k₂)−mω²)² − (k₁ + k₂ e^{-iKa})(k₁ + k₂ e^{iKa}) = 0
      </p>
      <p>
        Multiply the complex conjugate pair:
      </p>
      <p style="font-family:var(--mono)">
        (k₁ + k₂ e^{-iKa})(k₁ + k₂ e^{iKa})
        = k₁² + k₂² + k₁k₂(e^{iKa}+e^{-iKa})
        = k₁² + k₂² + 2k₁k₂ cos(Ka)
      </p>
      <p>
        Therefore:
      </p>

      <div class="callout">
        <div class="tag keyeq">General dispersion (two branches)</div>
        <div class="eqwrap">
          <pre class="eq" data-copy="Dispersion (equal masses, alternating springs):
mω^2(K) = (k1+k2) ± sqrt(k1^2 + k2^2 + 2 k1 k2 cos(Ka))
(acoustic: minus; optical: plus)">mω²(K) = (k₁ + k₂) ± √(k₁² + k₂² + 2k₁k₂ cos(Ka))
(acoustic: “−”, optical: “+”)</pre>
          <button class="btn" data-copy-btn>Copy equation</button>
        </div>
      </div>

      <h3>3.7 Dimensional analysis check</h3>
      <ul>
        <li>k has units N/m = kg/s².</li>
        <li>(k₁+k₂)/m has units (kg/s²)/kg = 1/s² ⇒ ω².</li>
        <li>Square-root term is also stiffness ⇒ same units. So ω has units rad/s (consistent).</li>
      </ul>

      <h3>3.8 Evaluate at the requested K values</h3>

      <div class="callout">
        <div class="tag final">At K = 0</div>
        <p>
          cos(0)=1 ⇒ √(k₁² + k₂² + 2k₁k₂) = √((k₁+k₂)²) = (k₁+k₂) (positive).
        </p>
        <div class="eqwrap">
          <pre class="eq" data-copy="K=0:
mω^2 = (k1+k2) ± (k1+k2)
=> ω_ac(0)=0
   ω_op(0)=sqrt(2(k1+k2)/m)">K=0:
mω² = (k₁+k₂) ± (k₁+k₂)
⇒ ω_ac(0)=0
   ω_op(0)= √(2(k₁+k₂)/m)</pre>
          <button class="btn" data-copy-btn>Copy result</button>
        </div>
        <p>
          With k₁=C, k₂=10C:
          <b>ω_ac(0)=0</b>, and <b>ω_op(0)= √(2·11C/m) = √(22C/m)</b>.
        </p>
      </div>

      <div class="callout">
        <div class="tag final">At K = π/a</div>
        <p>
          cos(π)=−1 ⇒ √(k₁² + k₂² − 2k₁k₂) = √((k₂−k₁)²) = |k₂−k₁|.
          Here k₂>k₁, so |k₂−k₁| = k₂−k₁.
        </p>
        <div class="eqwrap">
          <pre class="eq" data-copy="K=π/a:
mω^2 = (k1+k2) ± (k2-k1)
=> ω_low = sqrt(2k1/m)
   ω_high= sqrt(2k2/m)">K=π/a:
mω² = (k₁+k₂) ± (k₂−k₁)
⇒ ω_low  = √(2k₁/m)
   ω_high = √(2k₂/m)</pre>
          <button class="btn" data-copy-btn>Copy result</button>
        </div>
        <p>
          With k₁=C, k₂=10C:
          <b>ω_low(π/a)= √(2C/m)</b>,
          <b>ω_high(π/a)= √(20C/m)</b>.
        </p>
      </div>

      <h3>3.9 Limiting-case asymptotics (useful intuition)</h3>
      <details>
        <summary>Small-K expansion (acoustic slope)</summary>
        <p>
          For small K, cos(Ka) ≈ 1 − (Ka)²/2. Let S=k₁+k₂ and P=k₁k₂.
          The square-root becomes:
        </p>
        <p style="font-family:var(--mono)">
          √(k₁²+k₂²+2k₁k₂ cos(Ka))
          = √(S² − P(Ka)² + O(K⁴))
          ≈ S [1 − (P/(2S²))(Ka)²]
          = S − (P/(2S))(Ka)²
        </p>
        <p>
          Acoustic branch uses “minus”:
        </p>
        <p style="font-family:var(--mono)">
          mω_ac² ≈ S − [S − (P/(2S))(Ka)²] = (P/(2S))(Ka)²
          ⇒ ω_ac ≈ |K| a √( P / (2mS) )
        </p>
        <p>
          This shows ω_ac ∝ |K| at small K (sound-like), with effective sound speed
          v_s = a √( P / (2mS) ).
        </p>
      </details>

      <div class="callout">
        <div class="tag math">Math Insight</div>
        <p>
          The core object is the <b>dynamic matrix</b> D(K), and the problem is a parameterized
          <b>eigenvalue problem</b>:
        </p>
        <p style="font-family:var(--mono)">
          D(K) q = ω²(K) q,   q = (U,V)ᵀ
        </p>
        <p>
          Because D(K) is Hermitian (for real K), its eigenvalues ω² are real and its eigenvectors form an orthogonal basis.
          Mathematically, this is a discrete, translation-invariant analog of a <b>Sturm–Liouville</b>-type spectral problem.
        </p>
      </div>

      <h3>3.10 One static sketch (computed from the derived formula)</h3>
      <figure>
        <canvas id="dispersion" width="980" height="520" aria-label="Dispersion plot ω vs K"></canvas>
        <figcaption>
          Dispersion ω(K) for the alternating-spring diatomic chain (example values for plotting only: C=1, m=1, a=1).
          Acoustic branch uses “−”, optical uses “+”. The final answers remain symbolic.
        </figcaption>
      </figure>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="p4" class="card">
      <h2>PART 4 — Deeper Understanding (Theory Around the Result)</h2>

      <h3>4.1 Re-interpret the final formula</h3>
      <p>
        The dispersion
        <span style="font-family:var(--mono)">mω² = (k₁+k₂) ± √(k₁²+k₂²+2k₁k₂ cos(Ka))</span>
        has two clear control knobs:
      </p>
      <ul>
        <li><b>Average stiffness (k₁+k₂):</b> sets the overall frequency scale (especially optical branch).</li>
        <li><b>Contrast and coupling (k₁k₂ and cos(Ka)):</b> controls how strongly the two sublattice DOFs mix versus K, creating splitting and curvature.</li>
      </ul>

      <h3>4.2 Parameter dependence (qualitative)</h3>
      <ul>
        <li>Increasing <b>both</b> k₁ and k₂ scales ω up roughly like √k.</li>
        <li>Increasing stiffness contrast (k₂/k₁) increases the <b>gap</b> near K=π/a because ω_low(π/a)=√(2k₁/m) while ω_high(π/a)=√(2k₂/m).</li>
        <li>Increasing mass m lowers all frequencies like 1/√m.</li>
      </ul>

      <h3>4.3 Alternative derivation idea (brief but meaningful)</h3>
      <p>
        A Lagrangian approach: write kinetic energy
        <span style="font-family:var(--mono)">T = (m/2) Σₙ (u̇ₙ² + v̇ₙ²)</span>
        and potential energy from spring extensions
        <span style="font-family:var(--mono)">V = (k₁/2)Σₙ(uₙ−vₙ)² + (k₂/2)Σₙ(vₙ−uₙ₊₁)²</span>.
        Then Euler–Lagrange equations give the same ODEs. Substituting Bloch forms reduces to the same dynamic matrix.
        This route highlights conservation (Noether) and symmetry (translation invariance ⇒ ω=0 acoustic mode at K=0).
      </p>

      <h3>4.4 Concept check (self-test with answers)</h3>
      <ul>
        <li><b>Q:</b> Why must ω_ac(0)=0? <b>A:</b> Uniform translation doesn’t change any spring lengths ⇒ zero restoring force ⇒ zero frequency mode.</li>
        <li><b>Q:</b> Why are there two branches? <b>A:</b> Two degrees of freedom per unit cell (U,V) ⇒ two eigenvalues ω² for each K.</li>
        <li><b>Q:</b> What sets ω at K=π/a? <b>A:</b> Neighboring cells are out of phase; modes localize energy alternately, yielding ω² = 2k₁/m and 2k₂/m.</li>
        <li><b>Q:</b> If k₁=k₂, what happens? <b>A:</b> The gap closes; the result reduces to the folded monatomic dispersion (two branches touch appropriately).</li>
      </ul>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="p5" class="card">
      <h2>PART 5 — Optional Plot Guide</h2>

      <p>
        The plot shows both branches ω(K) for K from 0 to π/a (first Brillouin zone edge), computed directly from the derived formula.
      </p>
      <ul>
        <li><b>x-axis:</b> K (1/a units shown as K·a/π from 0 to 1)</li>
        <li><b>y-axis:</b> ω in units of √(C/m) (because example values use C=1, m=1)</li>
        <li><b>Example values:</b> C=1, k₂=10, m=1, a=1 (used only to draw a numeric curve)</li>
        <li><b>Features to notice:</b>
          <ul>
            <li>Acoustic branch starts at 0 and rises.</li>
            <li>Optical branch starts high at K=0 with ω(0)=√(22).</li>
            <li>At K=π/a, branch endpoints are √(2) and √(20), illustrating strong splitting from stiffness contrast.</li>
          </ul>
        </li>
      </ul>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

    <section id="final" class="card">
      <h2>Final Answer (Copy-Friendly)</h2>

      <div class="callout">
        <div class="tag final">Final boxed results</div>
        <div class="eqwrap">
          <pre class="eq" id="finalText" data-copy="Let k1=C, k2=10C, masses m, lattice period a (nearest-neighbor spacing a/2).

General dispersion (two branches):
m ω^2(K) = (k1+k2) ± sqrt(k1^2 + k2^2 + 2 k1 k2 cos(Ka))

At K=0:
ω_ac(0)=0
ω_op(0)=sqrt(2(k1+k2)/m)=sqrt(22C/m)

At K=π/a:
ω_low(π/a)=sqrt(2k1/m)=sqrt(2C/m)
ω_high(π/a)=sqrt(2k2/m)=sqrt(20C/m)

Sketch: acoustic branch rises from 0 at K=0 to sqrt(2C/m) at K=π/a; optical branch decreases from sqrt(22C/m) at K=0 to sqrt(20C/m) at K=π/a, leaving a gap between sqrt(2C/m) and sqrt(20C/m) at the zone edge.">Let k1=C, k2=10C, masses m, lattice period a (nearest-neighbor spacing a/2).

General dispersion (two branches):
m ω^2(K) = (k1+k2) ± sqrt(k1^2 + k2^2 + 2 k1 k2 cos(Ka))

At K=0:
ω_ac(0)=0
ω_op(0)=sqrt(2(k1+k2)/m)=sqrt(22C/m)

At K=π/a:
ω_low(π/a)=sqrt(2k1/m)=sqrt(2C/m)
ω_high(π/a)=sqrt(2k2/m)=sqrt(20C/m)

Sketch: acoustic branch rises from 0 at K=0 to sqrt(2C/m) at K=π/a; optical branch decreases from sqrt(22C/m) at K=0 to sqrt(20C/m) at K=π/a, leaving a gap between sqrt(2C/m) and sqrt(20C/m) at the zone edge.</pre>
          <button class="btn" data-copy-btn>Copy final answer</button>
        </div>
      </div>

      <a class="backtop" href="#top">↑ Back to top</a>
    </section>

  </div>
</main>

<footer>
  <div class="hr"></div>
  <p>
    Built as a self-contained learning article (vanilla HTML/CSS/JS). Equations are plain text for easy copying.
  </p>
</footer>

<script>
(function(){
  // Copy buttons for any <pre class="eq" data-copy="...">
  function copyText(text){
    if(!text) return;
    navigator.clipboard.writeText(text).catch(()=>{});
  }
  document.querySelectorAll('[data-copy-btn]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const wrap = btn.closest('.eqwrap');
      const pre = wrap ? wrap.querySelector('pre[data-copy]') : null;
      if(!pre) return;
      copyText(pre.getAttribute('data-copy') || pre.innerText);
      const old = btn.textContent;
      btn.textContent = 'Copied ✓';
      setTimeout(()=>btn.textContent = old, 900);
    });
  });

  // Dispersion plot (single static plot) — example values only
  const canvas = document.getElementById('dispersion');
  const ctx = canvas.getContext('2d');

  function draw(){
    const dpr = window.devicePixelRatio || 1;
    const cssW = canvas.clientWidth;
    const cssH = Math.round(cssW * (520/980));
    canvas.style.height = cssH + 'px';
    canvas.width = Math.floor(cssW * dpr);
    canvas.height = Math.floor(cssH * dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);

    const W = cssW, H = cssH;
    ctx.clearRect(0,0,W,H);

    // Example parameters for plotting ONLY
    const C = 1, m = 1, a = 1;
    const k1 = C, k2 = 10*C;

    // Plot ranges
    const Kmin = 0, Kmax = Math.PI/a;
    // compute max omega on range
    let wMax = 0;
    const N = 400;
    for(let i=0;i<=N;i++){
      const K = Kmin + (Kmax-Kmin)*(i/N);
      const S = k1+k2;
      const rad = Math.sqrt(k1*k1 + k2*k2 + 2*k1*k2*Math.cos(K*a));
      const w2p = (S + rad)/m;
      const w2m = (S - rad)/m;
      const wp = Math.sqrt(Math.max(0,w2p));
      const wm = Math.sqrt(Math.max(0,w2m));
      wMax = Math.max(wMax, wp, wm);
    }
    wMax *= 1.08;

    // Layout
    const padL=58, padR=18, padT=34, padB=54;
    const x0=padL, y0=padT, x1=W-padR, y1=H-padB;
    const PW=x1-x0, PH=y1-y0;

    function xMap(K){
      return x0 + (K-Kmin)/(Kmax-Kmin)*PW;
    }
    function yMap(w){
      return y1 - (w-0)/(wMax-0)*PH;
    }

    // Background grid
    ctx.lineWidth = 1;
    ctx.strokeStyle = 'rgba(127,138,163,0.18)';
    const gx = 6, gy = 6;
    for(let i=0;i<=gx;i++){
      const x = x0 + i*(PW/gx);
      ctx.beginPath(); ctx.moveTo(x,y0); ctx.lineTo(x,y1); ctx.stroke();
    }
    for(let j=0;j<=gy;j++){
      const y = y0 + j*(PH/gy);
      ctx.beginPath(); ctx.moveTo(x0,y); ctx.lineTo(x1,y); ctx.stroke();
    }

    // Axes
    ctx.strokeStyle = 'rgba(255,255,255,0.55)';
    ctx.lineWidth = 1.2;
    ctx.beginPath();
    ctx.moveTo(x0,y1); ctx.lineTo(x1,y1);
    ctx.moveTo(x0,y0); ctx.lineTo(x0,y1);
    ctx.stroke();

    // Title
    ctx.fillStyle = 'rgba(233,236,242,0.95)';
    ctx.font = '600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
    ctx.fillText('Dispersion ω(K) for alternating springs (example values: C=1, m=1, a=1)', x0, 18);

    // Axis labels
    ctx.fillStyle = 'rgba(170,179,197,0.95)';
    ctx.font = '12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
    ctx.fillText('K·a/π (from 0 to 1)', x0 + PW/2 - 58, H-18);

    ctx.save();
    ctx.translate(18, y0 + PH/2 + 48);
    ctx.rotate(-Math.PI/2);
    ctx.fillText('ω  (units of √(C/m))', 0, 0);
    ctx.restore();

    // Ticks and tick labels
    ctx.fillStyle = 'rgba(170,179,197,0.95)';
    ctx.font = '11px ' + getComputedStyle(document.body).fontFamily;
    // x ticks: K a / pi = 0..1
    for(let i=0;i<=5;i++){
      const frac = i/5;
      const K = Kmin + frac*(Kmax-Kmin);
      const x = xMap(K);
      ctx.strokeStyle='rgba(255,255,255,0.40)';
      ctx.beginPath(); ctx.moveTo(x,y1); ctx.lineTo(x,y1+6); ctx.stroke();
      const lab = (frac).toFixed(1);
      ctx.fillText(lab, x-7, y1+20);
    }
    // y ticks
    for(let j=0;j<=5;j++){
      const frac = j/5;
      const w = frac*wMax;
      const y = yMap(w);
      ctx.strokeStyle='rgba(255,255,255,0.40)';
      ctx.beginPath(); ctx.moveTo(x0-6,y); ctx.lineTo(x0,y); ctx.stroke();
      ctx.fillText(w.toFixed(2), 8, y+4);
    }

    // Curves: acoustic and optical
    function drawCurve(sign){
      ctx.beginPath();
      for(let i=0;i<=N;i++){
        const K = Kmin + (Kmax-Kmin)*(i/N);
        const S = k1+k2;
        const rad = Math.sqrt(k1*k1 + k2*k2 + 2*k1*k2*Math.cos(K*a));
        const w2 = (S + sign*rad)/m;
        const w = Math.sqrt(Math.max(0,w2));
        const x = xMap(K);
        const y = yMap(w);
        if(i===0) ctx.moveTo(x,y);
        else ctx.lineTo(x,y);
      }
      ctx.lineWidth = 2.2;
      // Keep default stroke color (no explicit colors requested) -> use slightly different alpha by sign
      ctx.strokeStyle = sign<0 ? 'rgba(123,220,255,0.95)' : 'rgba(167,139,250,0.95)';
      ctx.stroke();
    }
    drawCurve(-1); // acoustic
    drawCurve(+1); // optical

    // Legend
    const lx = x1 - 240, ly = y0 + 12;
    ctx.fillStyle = 'rgba(255,255,255,0.06)';
    ctx.strokeStyle = 'rgba(255,255,255,0.18)';
    ctx.lineWidth=1;
    roundRect(ctx, lx, ly, 222, 56, 10, true, true);

    ctx.lineWidth=3;
    ctx.strokeStyle='rgba(123,220,255,0.95)';
    ctx.beginPath(); ctx.moveTo(lx+12, ly+18); ctx.lineTo(lx+44, ly+18); ctx.stroke();
    ctx.fillStyle='rgba(233,236,242,0.95)';
    ctx.font='12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
    ctx.fillText('Acoustic (−)', lx+52, ly+22);

    ctx.strokeStyle='rgba(167,139,250,0.95)';
    ctx.beginPath(); ctx.moveTo(lx+12, ly+40); ctx.lineTo(lx+44, ly+40); ctx.stroke();
    ctx.fillText('Optical (+)', lx+52, ly+44);
  }

  function roundRect(ctx, x, y, w, h, r, fill, stroke){
    const rr = Math.min(r, w/2, h/2);
    ctx.beginPath();
    ctx.moveTo(x+rr, y);
    ctx.arcTo(x+w, y, x+w, y+h, rr);
    ctx.arcTo(x+w, y+h, x, y+h, rr);
    ctx.arcTo(x, y+h, x, y, rr);
    ctx.arcTo(x, y, x+w, y, rr);
    ctx.closePath();
    if(fill) ctx.fill();
    if(stroke) ctx.stroke();
  }

  // Resize redraw
  let raf = null;
  function request(){
    if(raf) cancelAnimationFrame(raf);
    raf = requestAnimationFrame(draw);
  }
  window.addEventListener('resize', request, {passive:true});
  request();
})();
</script>
</body>
</html>
