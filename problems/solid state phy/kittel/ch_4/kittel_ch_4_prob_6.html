<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>Atomic Vibrations in a Metal (Jellium Model): Ion Oscillation Frequency & Sound Speed</title>
  <style>
    :root{
      --bg:#0b0e12;
      --panel:#101622;
      --panel2:#0f141e;
      --text:#e9eef7;
      --muted:#b8c2d6;
      --faint:#7f8aa3;
      --accent:#7dd3fc;
      --accent2:#a78bfa;
      --ok:#34d399;
      --warn:#fbbf24;
      --bad:#fb7185;
      --line:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
      --maxw: 1100px;
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f7fb;
        --panel:#ffffff;
        --panel2:#fbfcff;
        --text:#0b1220;
        --muted:#334155;
        --faint:#64748b;
        --line:rgba(15,23,42,.10);
        --shadow: 0 10px 30px rgba(2,6,23,.10);
      }
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 600px at 20% 10%, rgba(125,211,252,.10), transparent 55%),
                  radial-gradient(900px 550px at 90% 15%, rgba(167,139,250,.12), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }

    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    code, pre{font-family:var(--mono)}
    .wrap{
      max-width:var(--maxw);
      margin:0 auto;
      padding:28px 18px 70px;
    }

    header{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:18px;
      align-items:stretch;
      margin-bottom:16px;
    }
    @media (max-width: 980px){
      header{grid-template-columns:1fr; }
    }

    .hero{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:22px 20px;
      position:relative;
      overflow:hidden;
    }
    .hero:before{
      content:"";
      position:absolute;
      inset:-60px -60px auto auto;
      width:220px; height:220px;
      background: radial-gradient(circle at 30% 30%, rgba(125,211,252,.25), transparent 60%);
      transform:rotate(12deg);
      opacity:.9;
      pointer-events:none;
    }
    .kicker{
      color:var(--muted);
      font-size:.95rem;
      letter-spacing:.3px;
      margin:0 0 8px;
    }
    h1{
      font-size: clamp(1.35rem, 2.2vw, 2.05rem);
      line-height:1.18;
      margin:.15rem 0 .6rem;
    }
    .sub{
      color:var(--muted);
      margin:0;
      font-size:1.02rem;
      max-width:65ch;
    }

    .toc{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px 14px;
      position:sticky;
      top:14px;
      align-self:start;
      max-height: calc(100dvh - 28px);
      overflow:auto;
    }
    .toc h2{
      font-size:1.0rem;
      margin:4px 6px 10px;
      color:var(--text);
    }
    .toc ol{
      margin:0;
      padding:0 0 0 18px;
      color:var(--muted);
    }
    .toc li{margin:8px 0}
    .toc a{color:var(--muted)}
    .toc a:hover{color:var(--accent)}
    .toc .mini{
      font-size:.86rem;
      color:var(--faint);
      margin:10px 6px 0;
    }

    main{
      display:grid;
      grid-template-columns: 1fr;
      gap:16px;
    }

    section, article{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px 18px;
      scroll-margin-top:90px;
    }

    h2{
      margin:0 0 12px;
      font-size:1.25rem;
    }
    h3{
      margin:16px 0 8px;
      font-size:1.05rem;
      color:var(--text);
    }
    p{margin:10px 0}
    ul{margin:10px 0 10px 20px}
    li{margin:6px 0}
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 900px){ .grid2{grid-template-columns:1fr} }

    .callouts{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    @media (max-width: 900px){ .callouts{grid-template-columns:1fr} }

    .box{
      background: linear-gradient(180deg, rgba(16,22,34,.55), rgba(16,22,34,.18));
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px 12px;
      position:relative;
      overflow:hidden;
      transform: translateZ(0);
      transition: transform .18s ease, border-color .18s ease;
    }
    .box:hover{transform: translateY(-2px); border-color: rgba(125,211,252,.35)}
    .box h4{
      margin:0 0 8px;
      font-size:.98rem;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .pill{
      font-size:.75rem;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      color:var(--muted);
      background: rgba(255,255,255,.03);
    }
    .assump h4{color: var(--accent)}
    .mistakes h4{color: var(--warn)}
    .keyeq h4{color: var(--accent2)}
    .final h4{color: var(--ok)}
    .mathinsight h4{color: var(--accent2)}
    .box p, .box li{color:var(--muted)}
    .box code{color:var(--text)}

    .eq{
      background: rgba(0,0,0,.18);
      border:1px dashed rgba(255,255,255,.14);
      border-radius:12px;
      padding:10px 10px;
      margin:10px 0;
      overflow:auto;
      position:relative;
    }
    .eq pre{
      margin:0;
      white-space:pre-wrap;
      word-break:break-word;
      font-size:.95rem;
      color:var(--text);
    }

    .btnrow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:8px;
    }
    button.copy{
      appearance:none;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      color:var(--text);
      border-radius:12px;
      padding:8px 10px;
      cursor:pointer;
      font-size:.9rem;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    button.copy:hover{transform: translateY(-1px); border-color: rgba(125,211,252,.35); background: rgba(125,211,252,.08)}
    button.copy:active{transform: translateY(0px)}
    .copymsg{
      font-size:.86rem;
      color:var(--faint);
      margin-left:6px;
      min-height:1.1em;
      display:inline-block;
      vertical-align:middle;
    }

    details{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      background: rgba(255,255,255,.02);
      margin:12px 0;
    }
    summary{
      cursor:pointer;
      color:var(--text);
      font-weight:600;
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    details[open] summary{margin-bottom:8px}
    .muted{color:var(--muted)}
    .faint{color:var(--faint)}

    .backtop{
      display:flex;
      justify-content:flex-end;
      margin-top:10px;
      font-size:.95rem;
    }

    .tagline{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
      color:var(--muted);
      font-size:.92rem;
    }
    .tagline span{
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      border-radius:999px;
      padding:4px 10px;
    }

    footer{
      margin-top:18px;
      color:var(--faint);
      font-size:.92rem;
      text-align:center;
    }

    @media print{
      :root{ --bg:#ffffff; --text:#000000; --muted:#111827; --faint:#374151; --line:#d1d5db; --shadow:none; }
      body{background:#fff}
      .toc{display:none}
      header{grid-template-columns:1fr}
      section, article, .hero{box-shadow:none}
      a{color:#000; text-decoration:underline}
      .box:hover{transform:none}
      .backtop{display:none}
      button.copy{display:none}
      details{break-inside:avoid}
      section, article{page-break-inside:avoid}
      h2{page-break-after:avoid}
    }
  </style>
</head>

<body id="top">
  <div class="wrap">
    <header>
      <div class="hero">
        <p class="kicker">Solid-state physics • jellium model • lattice vibrations</p>
        <h1>Atomic Vibrations in a Metal: Single-Ion Oscillation Frequency and Sound-Speed Scale</h1>
        <p class="sub">
          We model a metal as point ions of mass <code>M</code> and charge <code>+e</code> embedded in a uniform “sea”
          of conduction electrons. Displacing one ion by a small distance produces an electrostatic restoring force
          from the uncompensated charge in the surrounding sphere, leading to harmonic motion and an estimate of
          the sound-speed order of magnitude.
        </p>
        <div class="tagline">
          <span>Physics intuition</span>
          <span>Mathematical model (Gauss/Poisson)</span>
          <span>Engineering relevance</span>
        </div>
      </div>

      <nav class="toc" aria-label="Table of Contents">
        <h2>Table of Contents</h2>
        <ol>
          <li><a href="#qs">Quick Summary</a></li>
          <li><a href="#p0">PART 0 — Concept Primer</a></li>
          <li><a href="#p0b">PART 0B — Industry & Applied Physics Perspective</a></li>
          <li><a href="#p1">PART 1 — Problem Analysis</a></li>
          <li><a href="#p2">PART 2 — Strategy & Tips</a></li>
          <li><a href="#p3">PART 3 — Full Solution</a></li>
          <li><a href="#p4">PART 4 — Deeper Understanding</a></li>
          <li><a href="#p5">PART 5 — Optional Plot Guide</a></li>
        </ol>
        <p class="mini">Sticky TOC • Click to jump • Print-friendly layout</p>
      </nav>
    </header>

    <main>
      <section id="qs">
        <h2>Quick Summary</h2>
        <ul>
          <li><strong>What this is:</strong> An electrostatic (jellium) model for <em>atomic vibrations</em> in a metal when one ion is displaced slightly.</li>
          <li><strong>Key idea:</strong> Displacing the ion leaves behind uncompensated electron charge in a sphere of radius <code>r</code>, creating a restoring electric field.</li>
          <li><strong>Governing field law:</strong> Gauss’s law <code>∇·E = ρ/ε0</code> (SI) or <code>∇·E = 4πρ</code> (Gaussian), with spherical symmetry.</li>
          <li><strong>Governing motion:</strong> Newton’s law <code>M d²r/dt² = F(r)</code> reduces to a harmonic-oscillator ODE <code>d²r/dt² + ω² r = 0</code>.</li>
          <li><strong>Density parameter:</strong> Ion (electron) number density <code>n = 3/(4πR³)</code> defines a typical interparticle length scale <code>R</code>.</li>
          <li><strong>Result (symbolic):</strong> The problem’s target frequency is
            <code>ω = (e²/(M R³))^(1/2)</code> (in the unit convention where Coulomb’s constant is 1).
          </li>
          <li><strong>Result (practical SI form):</strong> <code>ω ≈ sqrt( n e² / (3 ε0 M) )</code>, equivalently <code>ω ≈ sqrt( e²/(4π ε0 M R³) )</code>.</li>
          <li><strong>Numerical scale for sodium (rough):</strong> <code>ω ~ 10¹³ s⁻¹</code> (THz range), consistent with typical phonon frequencies.</li>
          <li><strong>Sound-speed estimate:</strong> Using <code>v_s ~ ω a</code> with lattice spacing <code>a ~ (few)×R</code> gives <code>v_s</code> of order <code>10³–10⁴ m/s</code>.</li>
        </ul>
      </section>

      <article id="p0">
        <h2>PART 0 — Concept Primer (THEORY BEFORE SOLVING)</h2>

        <div class="grid2">
          <div>
            <h3>Core definitions (symbols + SI units)</h3>
            <ul>
              <li><code>M</code> — ion mass (kg)</li>
              <li><code>e</code> — elementary charge magnitude (C)</li>
              <li><code>n</code> — number density of ions/electrons (m<sup>−3</sup>)</li>
              <li><code>R</code> — density length scale defined by <code>n = 3/(4πR³)</code> (m)</li>
              <li><code>r(t)</code> — small displacement of a chosen ion from equilibrium (m)</li>
              <li><code>ρ</code> — charge density (C·m<sup>−3</sup>)</li>
              <li><code>E</code> — electric field (V·m<sup>−1</sup>)</li>
              <li><code>ε0</code> — permittivity of free space (F·m<sup>−1</sup>)</li>
              <li><code>ω</code> — angular frequency (rad·s<sup>−1</sup>)</li>
            </ul>
          </div>

          <div>
            <h3>Physical meaning (intuition)</h3>
            <ul>
              <li><strong>Jellium picture:</strong> Positive ion cores are embedded in a nearly uniform negative electron background.</li>
              <li><strong>Restoring mechanism:</strong> When one ion moves, local neutrality is broken; the resulting electric field pulls it back.</li>
              <li><strong>Why “sphere of radius r” shows up:</strong> With small displacement, symmetry suggests the net imbalance acts like a uniform charge density inside the sphere centered at the original lattice site, giving a field proportional to <code>r</code>.</li>
              <li><strong>Outcome:</strong> A linear restoring force <code>F ≈ −k r</code> implies simple harmonic motion.</li>
            </ul>
          </div>
        </div>

        <h3>Key laws/principles and validity conditions</h3>
        <div class="callouts">
          <div class="box keyeq">
            <h4>Key field law <span class="pill">Maxwell</span></h4>
            <p class="muted">Electrostatics (no time-varying magnetic effects):</p>
            <div class="eq" data-copy="∇·E = ρ/ε0,   ∇×E = 0,   E = -∇φ,   ∇²φ = -ρ/ε0">
              <pre>∇·E = ρ/ε0,   ∇×E = 0
E = -∇φ,      ∇²φ = -ρ/ε0   (Poisson)</pre>
            </div>
            <div class="btnrow">
              <button class="copy" data-copy-btn>Copy key equations</button>
              <span class="copymsg" aria-live="polite"></span>
            </div>
          </div>

          <div class="box assump">
            <h4>Validity conditions <span class="pill">Model assumptions</span></h4>
            <ul>
              <li><strong>Small displacement:</strong> <code>|r|</code> is much smaller than interionic spacing ⇒ linearization is valid.</li>
              <li><strong>Uniform electron sea:</strong> treat conduction electrons as a stationary uniform background on the ion timescale (crude but good for scaling).</li>
              <li><strong>Electrostatic limit:</strong> neglect magnetic forces and radiation (frequencies are high, but velocities are small).</li>
              <li><strong>Single-ion (Einstein-like) picture:</strong> surrounding lattice provides an effective harmonic potential.</li>
            </ul>
          </div>
        </div>

        <h3>Common models/approximations used here (and why)</h3>
        <ul>
          <li><strong>Linear response / harmonic approximation:</strong> Expand force to first order: <code>F(r) ≈ F(0) + (dF/dr)|0 · r</code>. Stability implies <code>F(0)=0</code> and <code>(dF/dr)|0 &lt; 0</code>.</li>
          <li><strong>Spherical symmetry argument:</strong> For a uniform charge density, the electric field inside depends only on radius and is linear in <code>r</code>. This is what makes the restoring force proportional to <code>r</code>.</li>
          <li><strong>Continuum charge density:</strong> Replace discrete electrons by a smooth density <code>ρ = -e n</code> to get a clean analytic estimate.</li>
        </ul>

        <h3>Mini intuition examples (minimal algebra)</h3>
        <ul>
          <li><strong>Uniformly charged sphere:</strong> Inside, <code>E ∝ r</code> ⇒ any test charge experiences a harmonic-type force.</li>
          <li><strong>Mass effect:</strong> Heavier ions vibrate more slowly: <code>ω ∝ 1/√M</code>.</li>
          <li><strong>Density effect:</strong> Denser packing means stronger restoring field: <code>ω ∝ √n</code> (equivalently <code>∝ 1/R^(3/2)</code>).</li>
        </ul>

        <div class="box mistakes">
          <h4>What to watch for <span class="pill">Pitfalls</span></h4>
          <ul>
            <li><strong>Unit system:</strong> The problem’s expression <code>ω = (e²/(MR³))^(1/2)</code> implicitly uses a convention where the Coulomb constant is 1 (Gaussian-like). In SI you must include <code>1/(4π ε0)</code>.</li>
            <li><strong>Why “sphere of radius r” works:</strong> It’s a symmetry/linearization argument, not a literal hard boundary in the metal.</li>
            <li><strong>Don’t confuse:</strong> This is not the electron plasma frequency; the mass here is the ion mass <code>M</code>, so the frequency is much lower.</li>
          </ul>
        </div>

        <div class="backtop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="p0b">
        <h2>PART 0B — Industry & Applied Physics Perspective</h2>

        <h3>Where this appears in industry (3+ concrete application areas)</h3>
        <ul>
          <li><strong>Thermal management & packaging:</strong> Phonon spectra set heat capacity and thermal conductivity, crucial for electronics cooling and reliability.</li>
          <li><strong>Ultrasonics & NDE (non-destructive evaluation):</strong> Sound speed and elastic wave propagation underpin inspection of welds, pipes, rails, aerospace parts.</li>
          <li><strong>MEMS resonators & precision timing:</strong> Mechanical resonance frequencies depend on elastic moduli ultimately rooted in interatomic restoring forces.</li>
          <li><strong>Materials processing:</strong> Annealing, cold work, and grain size affect phonon scattering and thus thermal/electrical performance (process-structure-property link).</li>
        </ul>

        <h3>Why engineers care</h3>
        <ul>
          <li><strong>Performance:</strong> Predict heat flow and acoustic wave speeds for device design.</li>
          <li><strong>Safety & reliability:</strong> Acoustic properties relate to crack detection sensitivity; thermal properties impact fatigue and thermal runaway margins.</li>
          <li><strong>Cost & manufacturability:</strong> Choosing alloys often balances thermal conductivity, stiffness, density, and processing constraints.</li>
        </ul>

        <h3>Typical measurement/validation methods</h3>
        <ul>
          <li><strong>Sound speed:</strong> pulse-echo ultrasonics, resonance methods, Brillouin scattering.</li>
          <li><strong>Phonon frequencies:</strong> Raman/IR spectroscopy (optical modes), inelastic neutron/x-ray scattering (dispersion curves).</li>
          <li><strong>Elastic moduli:</strong> tensile tests, nanoindentation, dynamic mechanical analysis (DMA).</li>
        </ul>

        <h3>Design trade-offs and real constraints</h3>
        <ul>
          <li><strong>Non-idealities:</strong> impurities, dislocations, grain boundaries and temperature all modify effective restoring forces and damping.</li>
          <li><strong>Electron screening:</strong> Real metals screen electrostatics strongly (Thomas–Fermi screening), so the “uniform sea” model is a scaling tool, not a high-precision predictor.</li>
          <li><strong>Anisotropy:</strong> Real crystals have direction-dependent sound speeds; our estimate is an isotropic order-of-magnitude.</li>
        </ul>

        <details>
          <summary>From lab to product: how the idealized model is adapted</summary>
          <div class="muted">
            In product-grade modeling, the restoring force is not computed from bare electrostatics; instead one uses
            measured or computed elastic constants (C<sub>ij</sub>) and phonon dispersion from density functional theory (DFT),
            then includes scattering and damping via microstructure-dependent parameters. The jellium result is still
            valuable because it anchors the scale: typical atomic vibration frequencies are THz, and typical sound
            speeds are km/s.
          </div>
        </details>

        <div class="backtop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="p1">
        <h2>PART 1 — Problem Analysis (no solving yet)</h2>

        <h3>Problem rewritten clearly</h3>
        <p class="muted">
          A metal is modeled as point ions (mass M, charge +e) sitting at stable lattice points in a uniform
          conduction-electron background. If one ion is displaced by a small distance r from equilibrium, the main restoring force
          comes from the net electric charge inside a sphere of radius r centered at the original equilibrium point.
          The ion/electron number density is n = 3/(4πR³).
        </p>
        <p class="muted">
          (a) Show the oscillation frequency for that single ion is ω = (e²/(M R³))^(1/2) (in the problem’s unit convention).
          (b) Estimate ω for sodium.
          (c) Use (a), (b), plus common sense to estimate the order of magnitude of the sound speed in the metal.
        </p>

        <div class="grid2">
          <div>
            <h3>Given quantities</h3>
            <ul>
              <li>M (ion mass)</li>
              <li>e (ion charge magnitude)</li>
              <li>n = 3/(4πR³) (number density; defines R)</li>
            </ul>
          </div>
          <div>
            <h3>Unknowns / required results</h3>
            <ul>
              <li>(a) Derive ω in terms of e, M, R (or n)</li>
              <li>(b) Numerical scale for sodium (rough)</li>
              <li>(c) Order-of-magnitude sound speed v<sub>s</sub></li>
            </ul>
          </div>
        </div>

        <h3>Relevant principles (and why they apply)</h3>
        <ul>
          <li><strong>Gauss’s law / Poisson equation:</strong> determines field from charge imbalance; spherical symmetry yields E ∝ r.</li>
          <li><strong>Newton’s second law:</strong> converts restoring force into an ODE for r(t).</li>
          <li><strong>Harmonic approximation:</strong> small displacements allow linearization.</li>
          <li><strong>“Common sense” for sound:</strong> acoustic waves are collective versions of these oscillations; speed ~ frequency × spacing.</li>
        </ul>

        <div class="box assump">
          <h4>Assumptions made explicit <span class="pill">Geometry • linearity</span></h4>
          <ul>
            <li>Small displacement: r ≪ R (or r ≪ a).</li>
            <li>Electron density is uniform and fixed (no dynamical screening response; scaling estimate).</li>
            <li>Electrostatic restoring force dominates (ignore detailed short-range ion-ion potentials).</li>
            <li>Isotropic medium for estimating sound speed.</li>
          </ul>
        </div>

        <h3>2–3 approaches (pros/cons)</h3>
        <ul>
          <li><strong>(A) Gauss-law inside a uniformly charged sphere (best):</strong> fast symmetry-based derivation.</li>
          <li><strong>(B) Poisson equation in spherical symmetry:</strong> highlights ∇² operator + boundary conditions.</li>
          <li><strong>(C) Energy method:</strong> expand potential energy to quadratic order to read off k.</li>
        </ul>

        <p class="muted"><strong>Chosen approach:</strong> Gauss + Newton with Poisson cross-check.</p>

        <div class="backtop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="p2">
        <h2>PART 2 — Strategy & Tips (roadmap only)</h2>

        <ol>
          <li><strong>Model charge density:</strong> ρ<sub>e</sub> = −e n (uniform background).</li>
          <li><strong>Compute enclosed charge:</strong> Q<sub>enc</sub>(r) = ρ<sub>e</sub> (4/3)πr³ for the sphere of radius r.</li>
          <li><strong>Apply Gauss:</strong> ∮E·dA = Q<sub>enc</sub>/ε0 ⇒ E(r) ∝ r.</li>
          <li><strong>Force:</strong> F = eE ⇒ F = −kr, identify k.</li>
          <li><strong>Equation of motion:</strong> M r¨ + k r = 0 ⇒ ω² = k/M.</li>
          <li><strong>Replace n by R:</strong> n = 3/(4πR³) to match requested form.</li>
          <li><strong>Numbers for Na:</strong> n from density and molar mass; M ≈ 23u; compute ω.</li>
          <li><strong>Sound speed:</strong> v<sub>s</sub> ~ ωa with a ~ few Å.</li>
        </ol>

        <div class="box mistakes">
          <h4>Common mistakes <span class="pill">Quick tips</span></h4>
          <ul>
            <li>Forgetting 1/(4π ε0) when using SI.</li>
            <li>Using electron mass instead of ion mass.</li>
            <li>Confusing R with the lattice constant; it’s a density length scale of similar order.</li>
            <li>Skipping symmetry justification for E ∝ r.</li>
          </ul>
        </div>

        <div class="backtop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="p3">
        <h2>PART 3 — Full Solution (DETAILED + TEACHING)</h2>

        <h3>Physical intuition first</h3>
        <p class="muted">
          Displacing one positive ion breaks local neutrality near its original site. The remaining uniform negative
          background charge produces an inward electric field proportional to displacement, giving a harmonic restoring force.
        </p>

        <div class="box mathinsight">
          <h4>Math Insight <span class="pill">Core equation as an object</span></h4>
          <p class="muted">
            The derivation reduces Maxwell’s linear electrostatics plus symmetry to a linear restoring law F = −kr,
            yielding the harmonic oscillator ODE r¨ + ω²r = 0 (a linear constant-coefficient eigenvalue problem in time).
          </p>
        </div>

        <h3>Step 1 — Mathematical model</h3>
        <ul>
          <li><strong>Domain:</strong> x⃗ ∈ ℝ³, equilibrium site at origin.</li>
          <li><strong>Coordinates:</strong> spherical (r,θ,φ) for the field; displacement magnitude r(t).</li>
          <li><strong>Electrostatics:</strong> ∇×E⃗ = 0, ∇·E⃗ = ρ/ε0; E⃗ = −∇φ; ∇²φ = −ρ/ε0.</li>
          <li><strong>Motion:</strong> M d²r⃗/dt² = e E⃗(r⃗).</li>
          <li><strong>Regularity:</strong> finite field at r=0; symmetry implies E⃗(0)=0.</li>
        </ul>

        <h3>Step 2 — Charge density and enclosed charge</h3>
        <div class="eq" data-copy="ρ_e = -e n">
          <pre>ρ_e = − e n</pre>
        </div>
        <p class="muted">
          For a sphere of radius r centered at the original site, the ion has moved out, leaving only electron background charge:
        </p>
        <div class="eq" data-copy="Q_enc(r) = ∫_{|x|≤r} ρ_e dV = ρ_e (4/3)π r^3 = -(4/3)π e n r^3">
          <pre>Q_enc(r) = ∫_{|x⃗|≤r} ρ_e dV
         = ρ_e (4/3)π r³
         = −(4/3)π e n r³</pre>
        </div>

        <h3>Step 3 — Electric field via Gauss’s law</h3>
        <div class="eq" data-copy="∮_{∂S_r} E⃗·dA⃗ = Q_enc(r)/ε0">
          <pre>∮_{∂S_r} E⃗ · dA⃗ = Q_enc(r)/ε0</pre>
        </div>
        <p class="muted">
          By spherical symmetry, E⃗ = E(r) r̂ and E(r) is constant on the sphere, so:
        </p>
        <div class="eq" data-copy="E(r) (4π r^2) = Q_enc(r)/ε0">
          <pre>E(r) (4π r²) = Q_enc(r)/ε0</pre>
        </div>
        <p class="muted">Substitute Q<sub>enc</sub>(r):</p>
        <div class="eq" data-copy="E(r) = -(e n r)/(3 ε0)">
          <pre>E(r) = − (e n r)/(3 ε0)</pre>
        </div>

        <details>
          <summary>Poisson equation cross-check (operator form)</summary>
          <div class="muted">
            With φ = φ(r), ∇²φ = (1/r²) d/dr (r² dφ/dr). Poisson: (1/r²)d/dr(r² dφ/dr) = −ρ_e/ε0 = (e n)/ε0.
            Integrating with finiteness at r=0 gives dφ/dr = (e n r)/(3 ε0), hence E = −dφ/dr = −(e n r)/(3 ε0).
          </div>
        </details>

        <h3>Step 4 — Force and harmonic oscillator</h3>
        <div class="eq" data-copy="F(r) = eE(r) = -(e^2 n)/(3 ε0) r">
          <pre>F(r) = eE(r) = −(e² n)/(3 ε0) r</pre>
        </div>
        <p class="muted">Newton’s law:</p>
        <div class="eq" data-copy="M r¨ + (e^2 n)/(3 ε0) r = 0  ⇒  ω^2 = (e^2 n)/(3 ε0 M)">
          <pre>M r¨ + (e² n)/(3 ε0) r = 0
⇒ r¨ + ω² r = 0
with  ω² = (e² n)/(3 ε0 M)</pre>
        </div>

        <h3>Step 5 — Express in terms of R</h3>
        <p class="muted">Using n = 3/(4πR³):</p>
        <div class="eq" data-copy="ω^2 = e^2/(4π ε0 M R^3)  ⇒  ω = sqrt(e^2/(4π ε0 M R^3))">
          <pre>ω² = (e² n)/(3 ε0 M) = e²/(4π ε0 M R³)
⇒ ω = √( e²/(4π ε0 M R³) )</pre>
        </div>
        <p class="muted">
          In the problem’s unit convention (Coulomb constant = 1): 1/(4π ε0) → 1, hence:
        </p>

        <div class="box final">
          <h4>(a) Final result <span class="pill">boxed</span></h4>
          <div class="eq" data-copy="ω = √(e²/(M R³)) (problem convention).  SI: ω = √(e²/(4π ε0 M R³)) = √(n e²/(3 ε0 M)).">
            <pre>ω = √( e²/(M R³) )               (problem convention)

SI:
ω = √( e²/(4π ε0 M R³) ) = √( n e²/(3 ε0 M) )</pre>
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-btn>Copy</button>
            <span class="copymsg" aria-live="polite"></span>
          </div>
        </div>

        <h3>Sanity checks</h3>
        <ul>
          <li><strong>Units (SI):</strong> e²/(4π ε0) has units J·m, so ω² ~ (J·m)/(kg·m³) = 1/s².</li>
          <li><strong>Limits:</strong> M→∞ ⇒ ω→0; R→∞ ⇒ ω→0; higher density (smaller R) ⇒ larger ω.</li>
        </ul>

        <h3>(b) Rough estimate for sodium</h3>
        <p class="muted">Estimate number density n ≈ ρ N<sub>A</sub>/A:</p>
        <div class="eq" data-copy="ρ ≈ 970 kg/m^3, A ≈ 0.023 kg/mol ⇒ n ≈ (970/0.023)(6.02×10^23) ≈ 2.5×10^28 m^-3">
          <pre>ρ ≈ 970 kg/m³,  A ≈ 0.023 kg/mol
n ≈ (970/0.023)(6.02×10²³) ≈ 2.5×10²⁸ m⁻³</pre>
        </div>
        <p class="muted">Then R = (3/(4πn))^(1/3) ≈ 2.1 Å, and M ≈ 23u ≈ 3.8×10⁻²⁶ kg. Thus:</p>
        <div class="eq" data-copy="ω ≈ √(n e^2/(3 ε0 M)) ≈ 2.5×10^13 s^-1;  f = ω/(2π) ≈ 4×10^12 Hz">
          <pre>ω ≈ √( n e²/(3 ε0 M) ) ≈ 2.5×10¹³ s⁻¹
f = ω/(2π) ≈ 4×10¹² Hz</pre>
        </div>

        <div class="box final">
          <h4>(b) Sodium scale <span class="pill">answer</span></h4>
          <div class="eq" data-copy="For Na: ω ~ 10^13 s^-1 (rad/s), i.e. f ~ few×10^12 Hz (THz).">
            <pre>For Na: ω ~ 10¹³ s⁻¹ (rad/s), f ~ few×10¹² Hz (THz)</pre>
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-btn>Copy</button>
            <span class="copymsg" aria-live="polite"></span>
          </div>
        </div>

        <h3>(c) Sound speed order of magnitude</h3>
        <p class="muted">
          Acoustic waves satisfy ω(k) ≈ v<sub>s</sub>k for small k. Using k<sub>max</sub> ~ π/a and ω scale ~ ω gives v<sub>s</sub> ~ ωa/π ~ ωa.
          With a ~ few Å and ω ~ 10¹³ s⁻¹:
        </p>
        <div class="eq" data-copy="v_s ~ ω a ~ (10^13)(10^-10) ~ 10^3 m/s to 10^4 m/s">
          <pre>v_s ~ ω a ~ (10¹³)(10⁻¹⁰) ~ 10³–10⁴ m/s</pre>
        </div>

        <div class="box final" id="finalAnswerBox">
          <h4>Final answers (a)–(c) <span class="pill">plain text</span></h4>
          <div class="eq" data-copy="(a) ω = √(e²/(M R³)) (problem convention). In SI: ω = √(e²/(4π ε0 M R³)) = √(n e²/(3 ε0 M)).&#10;(b) For sodium: ω ~ 2.5×10^13 s^-1 (f ~ 4×10^12 Hz, THz).&#10;(c) Sound speed scale: v_s ~ ωa ~ 10^3–10^4 m/s.">
            <pre>(a) ω = √(e²/(M R³)) (problem convention).
    SI: ω = √(e²/(4π ε0 M R³)) = √(n e²/(3 ε0 M)).

(b) Sodium: ω ~ 2.5×10¹³ s⁻¹ (f ~ 4×10¹² Hz, THz).

(c) v_s ~ ωa ~ 10³–10⁴ m/s.</pre>
          </div>
          <div class="btnrow">
            <button class="copy" data-copy-btn>Copy final answer</button>
            <span class="copymsg" aria-live="polite"></span>
          </div>
        </div>

        <h3>Nondimensionalization (quick)</h3>
        <p class="muted">Let τ = ωt and y = r/R. Then r¨ + ω²r = 0 becomes:</p>
        <div class="eq" data-copy="d²y/dτ² + y = 0">
          <pre>d²y/dτ² + y = 0</pre>
        </div>

        <div class="backtop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="p4">
        <h2>PART 4 — Deeper Understanding (THEORY AROUND THE RESULT)</h2>

        <h3>Interpretation</h3>
        <ul>
          <li><strong>k = e²n/(3ε0):</strong> electrostatic “spring” stiffness from the background charge density.</li>
          <li><strong>ω = √(k/M):</strong> inertia vs stiffness sets timescale.</li>
          <li><strong>v<sub>s</sub> ~ ωa:</strong> wave speed arises from oscillator frequency times spacing (lattice-dynamics scaling).</li>
        </ul>

        <h3>Alternative derivation idea</h3>
        <p class="muted">
          Solve Poisson’s equation ∇²φ = −ρ/ε0 in spherical symmetry to get E(r) = −dφ/dr ∝ r, then integrate F = eE to obtain a quadratic potential V = (1/2)kr²,
          which identifies ω directly.
        </p>

        <h3>Concept checks (with answers)</h3>
        <ul>
          <li><strong>Q:</strong> Why E ∝ r? <strong>A:</strong> Uniform ρ and spherical symmetry + Gauss/Poisson imply linear interior field.</li>
          <li><strong>Q:</strong> What changes if density increases? <strong>A:</strong> ω increases as √n.</li>
          <li><strong>Q:</strong> Why isn’t this electron plasma frequency? <strong>A:</strong> The mass in ω is the ion mass M.</li>
        </ul>

        <div class="backtop"><a href="#top">Back to top ↑</a></div>
      </article>

      <article id="p5">
        <h2>PART 5 — Optional Plot Guide</h2>
        <p class="muted">
          No plot is needed: the outcome is a clean power-law scaling (ω ∝ √n, ω ∝ 1/√M) and a simple sound-speed estimate v<sub>s</sub> ~ ωa.
        </p>
        <div class="backtop"><a href="#top">Back to top ↑</a></div>
      </article>

      <footer>
        Built as a single self-contained HTML article (vanilla HTML/CSS/JS). Copy buttons provide plain-text equations and final results.
      </footer>
    </main>
  </div>

  <script>
    (function(){
      function getCopyText(fromNode){
        const custom = fromNode.getAttribute('data-copy');
        if(custom) return custom;
        const pre = fromNode.querySelector('pre');
        return pre ? pre.innerText : fromNode.innerText;
      }

      function flashMsg(btn, msg){
        const row = btn.parentElement;
        const m = row.querySelector('.copymsg');
        if(!m) return;
        m.textContent = msg;
        m.style.opacity = '1';
        setTimeout(()=>{ m.style.opacity = '0.9'; }, 600);
        setTimeout(()=>{ m.textContent = ''; m.style.opacity = '1'; }, 1600);
      }

      async function copyToClipboard(text){
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch(e){
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          ta.style.top = '0';
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          let ok = false;
          try{ ok = document.execCommand('copy'); }catch(err){ ok = false; }
          document.body.removeChild(ta);
          return ok;
        }
      }

      document.querySelectorAll('[data-copy-btn]').forEach(btn=>{
        btn.addEventListener('click', async ()=>{
          const container = btn.closest('.keyeq, .final, .box, article, section') || document;
          let eq = btn.parentElement.previousElementSibling;
          if(!(eq && eq.classList && eq.classList.contains('eq'))){
            eq = (btn.closest('.box') || container).querySelector('.eq');
          }
          if(!eq) return flashMsg(btn, 'Nothing to copy');
          const txt = getCopyText(eq).trim();
          const ok = await copyToClipboard(txt);
          flashMsg(btn, ok ? 'Copied!' : 'Copy failed');
        });
      });
    })();
  </script>
</body>
</html>
